!function(){function e(t,r,n){function i(o,s){if(!r[o]){if(!t[o]){var l="function"==typeof require&&require;if(!s&&l)return l(o,!0);if(a)return a(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[o]={exports:{}};t[o][0].call(c.exports,function(e){var r=t[o][1][e];return i(r||e)},c,c.exports,e,t,r,n)}return r[o].exports}for(var a="function"==typeof require&&require,o=0;o<n.length;o++)i(n[o]);return i}return e}()({1:[function(e,t,r){function n(){}var i=r.cache={};r.insert=function(e){if(i[e])return n;i[e]=!0;var t=document.createElement("style");return t.setAttribute("type","text/css"),"textContent"in t?t.textContent=e:t.styleSheet.cssText=e,document.getElementsByTagName("head")[0].appendChild(t),function(){document.getElementsByTagName("head")[0].removeChild(t),i[e]=!1}}},{}],2:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("constant"),a=n(i),o=e("store/application-state"),s=n(o),l=e("services/application"),u=n(l),c=e("components/InputG3W.vue"),d=n(c),f=e("components/InputG3WFormInputs.vue"),p=n(f),h=e("core/expression/inputservice"),v=n(h),g=e("components/FormBody.vue"),m=n(g),y=e("components/FormFooter.vue"),_=n(y),b=e("components/C3XYLine.vue"),w=n(b),x=e("store/catalog-layers"),S=n(x),L=e("services/data"),C=n(L),k=e("services/editing"),E=n(k),M=e("store/sessions"),T=n(M),I=e("services/iframe-plugin"),P=n(I),F=e("store/map-layers"),O=n(F),R=e("store/plugins"),A=n(R),j=e("store/projects"),N=n(j),D=e("services/relations"),G=n(D),V=e("services/tasks"),$=n(V),U=e("services/workflows"),q=n(U),B=e("services/api"),z=n(B),W=e("services/router"),H=n(W),K=e("services/gui"),Z=n(K),Y=e("mixins"),Q=n(Y),X=e("core/g3wobject"),J=e("core/utils/utils"),ee=e("core/utils/geo"),te=e("core/i18n/i18n.service"),re=e("core/errors/parser/servererrorparser"),ne=e("core/editing/session"),ie=e("core/editing/editor"),ae=e("core/utils/geo"),oe=e("core/utils/geo"),se=oe.Geometry,le=e("core/project/project"),ue=e("core/layers/layersstoresregistry"),ce=e("core/layers/layersstore"),de=e("core/layers/layer"),fe=e("core/layers/layerfactory"),pe=e("core/layers/tablelayer"),he=e("core/layers/vectorlayer"),ve=e("core/layers/imagelayer"),ge=e("core/layers/map/wmslayer"),me=e("core/layers/map/xyzlayer"),ye=e("core/layers/map/maplayer"),_e=e("core/layers/features/feature"),be=e("core/layers/features/featuresstore"),we=e("core/layers/features/olfeaturesstore"),xe=e("core/layers/filter/filter"),Se=e("core/layers/filter/expression"),Le=e("core/plugin/plugin"),Ce=e("core/plugin/pluginservice"),ke=e("core/workflow/task"),Ee=e("core/workflow/step"),Me=e("core/workflow/flow"),Te=e("core/workflow/workflow"),Ie=e("gui/panel"),Pe=e("gui/map/control/factory"),Fe=e("gui/component/componentsfactory"),Oe=e("gui/fields/fieldsservice"),Re=e("gui/component/component"),Ae=e("gui/metadata/vue/metadata"),je=e("gui/search/vue/search"),Ne=e("gui/search/vue/panel/searchpanel"),De=e("gui/print/vue/print"),Ge=e("gui/catalog/vue/catalog"),Ve=e("gui/map/vue/map"),$e=e("gui/tools/vue/tools"),Ue=e("gui/queryresults/vue/queryresults"),qe=e("gui/form/vue/form"),Be=e("gui/form/formservice"),ze=e("gui/inputs/inputs"),We=e("gui/charts/chartsfactory"),He=e("gui/fields/fields"),Ke=e("gui/search/vue/panel/searchservice"),Ze=e("g3w-ol/interactions/pickfeatureinteraction"),Ye=e("g3w-ol/interactions/pickcoordinatesinteraction"),Qe=e("g3w-ol/interactions/deletefeatureinteraction"),Xe=e("g3w-ol/interactions/areainteraction"),Je=e("g3w-ol/interactions/lengthinteraction"),et=e("core/utils/ol");t.exports={constant:a["default"],core:{G3WObject:X,utils:J,geoutils:ee,ApplicationService:u["default"],ApplicationState:s["default"],ApiService:z["default"],Router:H["default"],i18n:te,task:{TaskService:$["default"]},data:{DataRouterService:C["default"]},iframe:{IFrameRouterService:P["default"]},errors:{parsers:{Server:re}},editing:{Session:ne,SessionsRegistry:T["default"],Editor:ie,ChangesManager:E["default"]},geometry:{Geom:ae,Geometry:se},project:{ProjectsRegistry:N["default"],Project:le},map:{MapLayersStoreRegistry:O["default"]},catalog:{CatalogLayersStoresRegistry:S["default"]},layer:{LayersStoreRegistry:ue,LayersStore:ce,Layer:de,LayerFactory:fe,TableLayer:pe,VectorLayer:he,ImageLayer:ve,WmsLayer:ge,XYZLayer:me,MapLayer:ye,geometry:{Geometry:se,geom:ae},features:{Feature:_e,FeaturesStore:be,OlFeaturesStore:we},filter:{Filter:xe,Expression:Se}},relations:{RelationsService:G["default"]},interaction:{PickCoordinatesInteraction:Ye,PickFeatureInteraction:Ze},plugin:{Plugin:Le,PluginsRegistry:A["default"],PluginService:Ce},workflow:{Task:ke,Step:Ee,Flow:Me,Workflow:Te,WorkflowsStack:q["default"]},input:{inputService:v["default"]}},gui:{GUI:Z["default"],Panel:Ie,ControlFactory:Pe,ComponentsFactory:Fe,FieldsService:Oe,vue:{Component:Re,Panel:Ie,MetadataComponent:Ae,SearchComponent:je,SearchPanel:Ne,PrintComponent:De,CatalogComponent:Ge,MapComponent:Ve,ToolsComponent:$e,QueryResultsComponent:Ue,FormComponent:qe,FormComponents:{Body:m["default"],Footer:_["default"]},Inputs:{G3wFormInputs:p["default"],G3WInput:d["default"],InputsComponents:ze},Charts:{ChartsFactory:We,c3:{lineXY:w["default"]}},Fields:He,Mixins:Q["default"],services:{SearchPanel:Ke,FormService:Be}}},ol:{interactions:{PickFeatureInteraction:Ze,PickCoordinatesInteraction:Ye,DeleteFeatureInteraction:Qe,measure:{AreaInteraction:Xe,LengthInteraction:Je}},controls:{},utils:et},info:function(){$script("https://unpkg.com/platform@1.3.6/platform.js",function(){window.console.info(("\n[g3wsdk.info]\n\n- g3w-admin: __"+initConfig.version+"__\n- g3w-client: __"+a["default"].APP_VERSION+"__\n- browser: __"+platform.name+" "+platform.version+"__\n- operating system: __"+platform.os.toString()+"__\n").trim())})},version:a["default"].APP_VERSION}},{"components/C3XYLine.vue":195,"components/FormBody.vue":215,"components/FormFooter.vue":216,"components/InputG3W.vue":239,"components/InputG3WFormInputs.vue":240,constant:4,"core/editing/editor":6,"core/editing/session":8,"core/errors/parser/servererrorparser":9,"core/expression/inputservice":10,"core/g3wobject":12,"core/i18n/i18n.service":13,"core/layers/features/feature":26,"core/layers/features/featuresstore":27,"core/layers/features/olfeaturesstore":28,"core/layers/filter/expression":29,"core/layers/filter/filter":30,"core/layers/imagelayer":33,"core/layers/layer":34,"core/layers/layerfactory":35,"core/layers/layersstore":36,"core/layers/layersstoresregistry":37,"core/layers/map/maplayer":43,"core/layers/map/wmslayer":45,"core/layers/map/xyzlayer":47,"core/layers/tablelayer":56,"core/layers/vectorlayer":57,"core/plugin/plugin":58,"core/plugin/pluginservice":59,"core/project/project":61,"core/utils/geo":64,"core/utils/ol":66,"core/utils/utils":68,"core/workflow/flow":70,"core/workflow/step":72,"core/workflow/task":73,"core/workflow/workflow":74,"g3w-ol/interactions/areainteraction":101,"g3w-ol/interactions/deletefeatureinteraction":102,"g3w-ol/interactions/lengthinteraction":103,"g3w-ol/interactions/pickcoordinatesinteraction":105,"g3w-ol/interactions/pickfeatureinteraction":106,"gui/catalog/vue/catalog":113,"gui/charts/chartsfactory":116,"gui/component/component":117,"gui/component/componentsfactory":118,"gui/fields/fields":120,"gui/fields/fieldsservice":121,"gui/form/formservice":122,"gui/form/vue/form":123,"gui/inputs/inputs":132,"gui/map/control/factory":156,"gui/map/vue/map":158,"gui/metadata/vue/metadata":161,"gui/panel":162,"gui/print/vue/print":164,"gui/queryresults/vue/queryresults":172,"gui/search/vue/panel/searchpanel":177,"gui/search/vue/panel/searchservice":178,"gui/search/vue/search":179,"gui/tools/vue/tools":186,mixins:343,"services/api":350,"services/application":351,"services/data":358,"services/editing":359,"services/gui":361,"services/iframe-plugin":364,"services/relations":367,"services/router":368,"services/tasks":370,"services/workflows":372,"store/application-state":373,"store/catalog-layers":374,"store/map-layers":377,"store/plugins":378,"store/projects":379,"store/sessions":380}],3:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0}),r.utils=r.server=r.client=r._i18n=r.tools=r.plugins=void 0;var i=e("../locales"),a=n(i),o="G3W Client",s=["en","it"],l=r.plugins={},u=r.tools={tools:[]},c=r._i18n={resources:a["default"]},d=r.client={debug:!0,local:!1},f=r.server={urls:{baseurl:"/",ows:"ows",api:"api",initconfig:"api/initconfig",config:"api/config"}},p=r.utils={merge:function(e){}};r["default"]={apptitle:o,client:d,server:f,plugins:l,supportedLanguages:s,tools:u,_i18n:c,utils:p}},{"../locales":333}],4:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0}),r.LOGO_GIS3W=r.LOCAL_ITEM_IDS=r.FONT_AWESOME_ICONS=r.API_BASE_URLS=r.ZINDEXES=r.VIEWPORT=r.TOC_THEMES_INIT_STATUS=r.TOC_LAYERS_INIT_STATUS=r.TIMEOUT=r.SEARCH_RETURN_TYPES=r.SEARCH_ALLVALUE=r.QUERY_POINT_TOLERANCE=r.PRINT_SCALES=r.PRINT_RESOLUTIONS=r.PRINT_FORMATS=r.MAP_SETTINGS=r.LOCALSTORAGE_EXTERNALWMS_ITEM=r.LIST_OF_RELATIONS_ID=r.LIST_OF_RELATIONS_TITLE=r.GEOMETRY_TYPES=r.GEOMETRY_FIELDS=r.FILTER_EXPRESSION_OPERATORS=r.FILTER_OPERATORS=r.G3W_FID=r.EPSG=r.DOWNLOAD_FORMATS=r.DEFAULT_EDITING_CAPABILITIES=r.APP_VERSION=void 0;var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=e("../version"),o=n(a),s=r.APP_VERSION=o["default"],l=r.DEFAULT_EDITING_CAPABILITIES=["add_feature","change_feature","change_attr_feature","delete_feature"],u=r.DOWNLOAD_FORMATS={download:{format:"shapefile",url:"shp"},download_gpkg:{format:"gpkg",url:"gpkg"},download_gpx:{format:"gpx",url:"gpx"},download_csv:{format:"csv",url:"csv"},download_xls:{format:"xls",url:"xls"},download_raster:{format:"geotiff",url:"geotiff"}},c=(r.EPSG=["EPSG:3003","EPSG:3004","EPSG:3045","EPSG:3857","EPSG:4326","EPSG:6708","EPSG:23032","EPSG:23033","EPSG:25833","EPSG:32632","EPSG:32633"],r.G3W_FID="g3w_fid"),d=r.FILTER_OPERATORS={gte:">=",lte:"<=",NOT:"!=",eq:"=",gt:">",lt:"<",IN:"IN","NOT IN":"NOT IN",LIKE:"LIKE",ILIKE:"ILIKE",AND:"AND",OR:"OR"},f=r.FILTER_EXPRESSION_OPERATORS=i({lte:"<=",ltgt:"!=",ilike:"ILIKE",like:"LIKE"},d),p=r.GEOMETRY_FIELDS=["geometryProperty","boundedBy","geom","the_geom","geometry","bbox","GEOMETRY","geoemtria","geometria"],h=r.GEOMETRY_TYPES={POINT:"Point",POINTZ:"PointZ",POINTM:"PointM",POINTZM:"PointZM",POINT25D:"Point25D",MULTIPOINT:"MultiPoint",MULTIPOINTZ:"MultiPointZ",MULTIPOINTM:"MutliPointM",MULTIPOINTZM:"MultiPointZM",MULTIPOINT25D:"MultiPoint25D",LINESTRING:"LineString",LINESTRINGZ:"LineStringZ",LINESTRINGM:"LineStringM",LINESTRINGZM:"LineStringZM",LINESTRING25D:"LineString25D",LINE:"Line",LINEZ:"LineZ",LINEM:"LineM",LINEZM:"LineZM",LINE25D:"Line25D",MULTILINESTRING:"MultiLineString",MULTILINESTRINGZ:"MultiLineStringZ",MULTILINESTRINGM:"MultiLineStringM",MULTILINESTRINGZM:"MultiLineStringZM",MULTILINESTRING25D:"MultiLineString25D",MULTILINE:"MultiLine",MULTILINEZ:"MultiLineZ",MULTILINEM:"MultiLineM",MULTILINEZM:"MultiLineZM",MULTILINE25D:"MultiLine25D",POLYGON:"Polygon",POLYGONZ:"PolygonZ",POLYGONM:"PolygonM",POLYGONZM:"PolygonZM",POLYGON25D:"Polygon25D",MULTIPOLYGON:"MultiPolygon",MULTIPOLYGONZ:"MultiPolygonZ",MULTIPOLYGONM:"MultiPolygonM",MULTIPOLYGONZM:"MultiPolygonZM",MULTIPOLYGON25D:"MultiPolygon25D",GEOMETRYCOLLECTION:"GeometryCollection",GEOMETRYCOLLECTIONZ:"GeometryCollectionZ",GEOMETRYCOLLECTIONM:"GeometryCollectionM",GEOMETRYCOLLECTIONZM:"GeometryCollectionZM",GEOMETRYCOLLECTION25D:"GeometryCollection25D"},v=r.LIST_OF_RELATIONS_TITLE="info.list_of_relations",g=r.LIST_OF_RELATIONS_ID="__G3W_LIST_OF_RELATIONS_ID__",m=r.LOCALSTORAGE_EXTERNALWMS_ITEM="externalwms",y=r.MAP_SETTINGS={ZOOM:{maxScale:1e3},ANIMATION:{duration:2e3},LAYER_POSITIONS:{"default":"top",getPositions:function(){return["top","bottom"]}}},_=r.PRINT_FORMATS=[{value:"pdf",label:"PDF"},{value:"png",label:"PNG"}],b=r.PRINT_RESOLUTIONS=[150,300],w=r.PRINT_SCALES=[{value:100,label:"1:100"},{value:200,label:"1:200"},{value:500,label:"1:500"},{value:1e3,label:"1:1.000"},{value:2e3,label:"1:2.000"},{value:2500,label:"1:2.500"},{value:5e3,label:"1:5.000"},{value:1e4,label:"1:10.000"},{value:2e4,label:"1:20.000"},{value:25e3,label:"1:25.000"},{value:5e4,label:"1:50.000"},{value:1e5,label:"1:100.000"},{value:25e4,label:"1:250.000"},{value:5e5,label:"1:500.000"},{value:1e6,label:"1:1.000.000"},{value:25e5,label:"1:2.500.000"},{value:5e6,label:"1:5.000.000"},{value:1e7,label:"1:10.000.000"},{value:2e7,label:"1:20.000.000"},{value:5e7,label:"1:50.000.000"},{value:1e8,label:"1:100.000.000"},{value:25e7,label:"1:250.000.000"},{value:5e8,label:"1:500.000.000"}],x=r.QUERY_POINT_TOLERANCE={unit:"pixel",value:10},S=r.SEARCH_ALLVALUE="__G3W_ALL__",L=r.SEARCH_RETURN_TYPES=["data","search"],C=r.TIMEOUT=6e4,k=r.TOC_LAYERS_INIT_STATUS="not_collapsed",E=r.TOC_THEMES_INIT_STATUS="collapsed",M=r.VIEWPORT={resize:{map:{min:200},content:{min:200}}},T=r.ZINDEXES={usermessage:{tool:2}},I=r.API_BASE_URLS={ABOUT:{macrogroups:"/about/api/macrogroup/",nomacrogoups:"/about/api/group/nomacrogroup/",projects:"/about/api/group/__G3W_GROUP_ID__/projects/",group:"/about/api/group/"},CRS:"/crs/"},P=r.FONT_AWESOME_ICONS={"change-map":"fas fa-map-signs",map:"far fa-map",file:"fas fa-file-code",marker:"fas fa-map-marker-alt",relation:"fas fa-sitemap",tools:"fas fa-cogs",tool:"fas fa-cog",search:"fas fa-search",print:"fas fa-print",info:"fas fa-info-circle","info-circle":"fas fa-info-circle",globe:"fas fa-globe",mail:"fas fa-envelope",mobile:"fas fa-mobile",fax:"fas fa-fax",user:"fas fa-user",bars:"fas fa-bars",uncheck:"far fa-square",check:"far fa-check-square",filluncheck:"fas fa-square",table:"fas fa-table",trash:"fas fa-trash","trash-o":"far fa-trash-alt",pencil:"fas fa-pencil-alt","ellips-h":"fas fa-ellipsis-h","ellips-v":"fas fa-ellipsis-v","arrow-up":"fas fa-chevron-up","arrow-down":"fas fa-chevron-down","arrow-left":"fas fa-chevron-left","arrow-right":"fas fa-chevron-right","resize-h":"fas fa-arrows-alt-h","resize-v":"fas fa-arrows-alt-v","resize-default":"fas fa-compress","caret-up":"fas fa-caret-up","caret-down":"fas fa-caret-down","caret-left":"fas fa-caret-left","caret-right":"fas fa-caret-right","empty-circle":"far fa-circle","cloud-upload":"fas fa-cloud-upload-alt",spinner:"fas fa-spinner",minus:"fas fa-minus","minus-square":"far fa-minus-square",plus:"fas fa-plus","plus-circle":"fas fa-plus-circle","plus-square":"far fa-plus-square",grid:"fas fa-th",home:"fas fa-home",folder:"fas fa-folder","sign-out":"fas fa-sign-out-alt",close:"fas fa-times",time:"far fa-clock",calendar:"fas fa-calendar-alt",list:"fas fa-list-alt",link:"fas fa-link",unlink:"fas fa-unlink",eye:"far fa-eye","eye-close":"far fa-eye-slash",save:"far fa-save",pdf:"fas fa-file-pdf",image:"far fa-image",video:"far fa-file-video",unknow:"far fa-question-circle",zip:"far fa-file-archive",text:"far fa-file-alt",excel:"far fa-file-excel",xls:"far fa-file-excel",gpx:"fas fa-location-arrow",gpkg:"fas fa-box-open",shapefile:"fas fa-file-archive",csv:"fas fa-file-csv",geotiff:"fas fa-th",ppt:"far fa-file-powerpoint",circle:"fas fa-circle",calculator:"fas fa-calculator",picture:"far fa-image",keyboard:"far fa-keyboard","file-download":"fas fa-file-download",copy:"far fa-copy",draw:"fas fa-draw-polygon",chart:"fas fa-chart-bar","chart-line":"fas fa-chart-line","chart-area":"fas fa-chart-area","chart-pie":"fas fa-chart-pie",run:"fas fa-play",warning:"fas fa-exclamation-circle",alert:"fas fa-exclamation-triangle",crosshairs:"fas fa-crosshairs",success:"far fa-check-circle",back:"fas fa-chevron-circle-left","file-upload":"fas fa-file-upload",wifi:"fas fa-wifi",mouse:"fas fa-mouse","copy-paste":"far fa-copy","vector-square":"fas fa-vector-square",download:"fas fa-download",credits:"fas fa-euro-sign",filter:"fas fa-filter",plugin:"fas fa-plug",invert:"fas fa-exchange-alt",clear:"fas fa-broom",palette:"fas fa-palette",layers:"fas fa-layer-group","sign-in":"fas fa-sign-in-alt",language:"fas fa-language",target:"fas fa-bullseye",pin:"fas fa-map-pin",square:"far fa-square",move:"fas fa-arrows-alt",moon:"fas fa-moon",sun:"fas fa-sun",refresh:"fas fa-sync-alt",pause:"fas fa-pause","step-backward":"fas fa-step-backward","fast-backward":"fas fa-fast-backward","step-forward":"fas fa-step-forward","fast-forward":"fas fa-fast-forward",crop:"fas fa-crop-alt",exit:"fas fa-door-open",slider:"fas fa-sliders-h",bookmark:"fas fa-bookmark",reply:"fas fa-reply",share:"fas fa-share"},F=r.LOCAL_ITEM_IDS={MESSAGES:{id:"MESSAGES",value:{}},SPATIALBOOKMARKS:{id:"SPATIALBOOKMARKS",value:{}}},O=r.LOGO_GIS3W="images/logo_gis3w_156_85.png";r["default"]={APP_VERSION:s,API_BASE_URLS:I,DEFAULT_EDITING_CAPABILITIES:l,DOWNLOAD_FORMATS:u,FILTER_OPERATORS:d,FILTER_EXPRESSION_OPERATORS:f,FONT_AWESOME_ICONS:P,G3W_FID:c,GEOMETRY_FIELDS:p,GEOMETRY_TYPES:h,LIST_OF_RELATIONS_TITLE:v,LIST_OF_RELATIONS_ID:g,LOCAL_ITEM_IDS:F,LOCALSTORAGE_EXTERNALWMS_ITEM:m,LOGO_GIS3W:O,MAP_SETTINGS:y,PRINT_FORMATS:_,PRINT_RESOLUTIONS:b,PRINT_SCALES:w,QUERY_POINT_TOLERANCE:x,SEARCH_ALLVALUE:S,SEARCH_RETURN_TYPES:L,TIMEOUT:C,TOC_LAYERS_INIT_STATUS:k,TOC_THEMES_INIT_STATUS:E,VIEWPORT:M,ZINDEXES:T}},{"../version":381}],5:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(){var e=this;s["default"].onbefore("setCurrentProject",function(t){return e.project=t}),this.project=s["default"].getCurrentProject()}var o=e("store/projects"),s=n(o),l=e("services/gui"),u=n(l),c=e("core/utils/utils"),d=c.resolve,f=a.prototype;f.handleRequest=function(e){},f.handleResponse=function(){var e=i(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),f.getSelectedExternalLayers=function(e){var t=e.type,r=void 0===t?"vector":t;return u["default"].getService("catalog").getExternalSelectedLayers({type:r})},f.getEmptyRequest=function(){return d([])},f.hasExternalLayerSelected=function(e){var t=e.type,r=void 0===t?"vector":t;return this.getSelectedExternalLayers({type:r}).length>0},t.exports=a},{"core/utils/utils":68,"services/gui":361,"store/projects":379}],6:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.setters={save:function(){this._save()},addFeature:function(e){this._addFeature(e)},updateFeature:function(e){this._updateFeature(e)},deleteFeature:function(e){this._deleteFeature(e)},setFeatures:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this._setFeatures(e)},getFeatures:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._getFeatures(e)}},g(this),this._filter={bbox:null},this._allfeatures=!1,this._layer=e.layer,this._featuresstore=this._layer.getType()===b.LayerTypes.TABLE?new y:new _,this._started=!1,this._noteditablefileds=this._layer.getEditingNotEditableFields()||[]}var s=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=e("store/application-state"),u=n(l),c=e("services/editing"),d=n(c),f=e("store/sessions"),p=n(f),h=e("core/utils/utils"),v=h.inherit,g=h.base,m=e("core/g3wobject"),y=e("core/layers/features/featuresstore"),_=e("core/layers/features/olfeaturesstore"),b=e("core/layers/layer");v(o,m);var w=o.prototype;w._canDoGetFeaturesRequest=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!0;if(this._layer.getType()===b.LayerTypes.VECTOR){var r=e.filter||{},n=r.bbox;n&&(this._filter.bbox?ol.extent.containsExtent(this._filter.bbox,n)?t=!1:this._filter.bbox=ol.extent.extend(this._filter.bbox,n):this._filter.bbox=n)}return t},w.getEditingSource=function(){return this._featuresstore},w.getSource=function(){this._layer.getSource()},w._applyChanges=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];d["default"].execute(this._featuresstore,e,t)},w.setChanges=function(e,t){this._applyChanges(e,t)},w.getLayer=function(){return this._layer},w.setLayer=function(e){return this._layer=e,this._layer},w.removeNotEditablePropriertiesFromFeature=function(e){this._noteditablefileds.forEach(function(t){return e.unset([t])})},w._cloneFeatures=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map(function(e){return e.clone()})},w._addFeaturesFromServer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e=this._cloneFeatures(e),this._featuresstore.addFeatures(e)},w._doGetFeaturesRequest=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=u["default"].online&&!this._allfeatures;return t&&this._canDoGetFeaturesRequest(e)},w._getFeatures=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred(),n=this._doGetFeaturesRequest(t);return n?this._layer.getFeatures(t).then(function(n){n.then(function(n){return e._addFeaturesFromServer(n),e._allfeatures=!t.filter,r.resolve(n)}).fail(function(e){return r.reject(e)})}).fail(function(e){return r.reject(e)}):r.resolve(),r.promise()},w.revert=function(){var e=$.Deferred(),t=this._cloneFeatures(this._layer.readFeatures());return this._featuresstore.setFeatures(t),e.resolve(),e.promise()},w.rollback=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=$.Deferred();return this._applyChanges(e,!0),t.resolve(),t.promise()},w.applyChangesToNewRelationsAfterCommit=function(e){for(var t in e){var r=e[t],n=this.getLayerById(t),i=this.getEditingLayer(t).getEditingSource(),a=i.readFeatures();a.forEach(function(e){return e.clearState()}),n.getSource().setFeatures(a),n.applyCommitResponse({response:r,result:!0}),i.setFeatures(n.getSource().readFeatures())}},w.setFieldValueToRelationField=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.relationId,r=e.ids,n=e.field,i=e.values,a=void 0===i?[]:i,o=p["default"].getSession(t).getEditor().getEditingSource();r.forEach(function(e){var t=o.getFeatureById(e);if(t){var r=t.get(n);r==a[0]&&t.set(n,a[1])}})},w.applyCommitResponse=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(t&&t.result){var n=t.response,i=n["new"],a=n.new_lockids;i.forEach(function(t){var n=e._featuresstore.getFeatureById(t.clientid);n.setId(t.id),n.setProperties(t.properties),r.forEach(function(r){Object.entries(r).forEach(function(r){var i=s(r,2),a=i[0],o=i[1],l=n.get(o.fatherField);e.setFieldValueToRelationField({relationId:a,ids:o.ids,field:o.childField,values:[t.clientid,l]})})})});var o=this._featuresstore.readFeatures();o.forEach(function(e){return e.clearState()}),this._layer.setFeatures(o),this._layer.getSource().addLockIds(a)}},w.getLockIds=function(){return this._layer.getSource().getLockIds()},w.commit=function(e){var t=this,r=$.Deferred(),n=e.add.length?Object.keys(e.relations).map(function(r){var n=t._layer.getRelations().getRelationByFatherChildren(t._layer.getId(),r),o=e.relations[r].update.map(function(e){return e.id}),s=e.relations[r].add.map(function(e){return e.id});return i({},r,{ids:[].concat(a(s),a(o)),fatherField:n.getFatherField(),childField:n.getChildField()})}):[];return this._layer.commit(e).then(function(e){e.then(function(e){t.applyCommitResponse(e,n),r.resolve(e)}).fail(function(e){return r.reject(e)})}).fail(function(e){return r.reject(e)}),r.promise()},w.start=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred();return this.getFeatures(t).then(function(t){t.then(function(t){r.resolve(t),e._started=!0}).fail(function(e){return r.reject(e)})}).fail(function(e){return r.reject(e)}),r.promise()},w._addFeature=function(e){this._featuresstore.addFeature(e)},w._deleteFeature=function(e){this._featuresstore.deleteFeature(e)},w._updateFeature=function(e){this._featuresstore.updateFeature(e)},w._setFeatures=function(e){this._featuresstore.setFeatures(e)},w.readFeatures=function(){return this._layer.readFeatures()},w.readEditingFeatures=function(){return this._featuresstore.readFeatures()},w.stop=function(){var e=this,t=$.Deferred();return this._layer.unlock().then(function(r){e.clear(),t.resolve(r)}).fail(function(e){return t.reject(e)}),t.promise()},w._save=function(){this._layer.save()},w.isStarted=function(){return this._started},w.clear=function(){this._started=!1,this._filter.bbox=null,this._allfeatures=!1,this._featuresstore.clear(),this._layer.getFeaturesStore().clear(),this._layer.getType()===b.LayerTypes.VECTOR&&this._layer.resetEditingSource(this._featuresstore.getFeaturesCollection())},t.exports=o},{"core/g3wobject":12,"core/layers/features/featuresstore":27,"core/layers/features/olfeaturesstore":28,"core/layers/layer":34,"core/utils/utils":68,"services/editing":359,"store/application-state":373,"store/sessions":380}],7:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.id=e.id,o(this),this._maxSteps=10,this._states=[],this.state={commit:!1,undo:!1,redo:!1},this._current=null}var a=e("core/utils/utils"),o=a.base,s=a.inherit,l=e("core/g3wobject");s(n,l);var u=n.prototype;u.add=function(e,t){var r=this,n=$.Deferred();return null===this._current?this._states=[{id:e,items:t}]:(this._states.length&&this._current<this.getLastState().id&&(this._states=this._states.filter(function(e){return e.id<=r._current})),this._states.push({id:e,items:t})),this._current=e,this._setState(),n.resolve(e),n.promise()},u.getRelationStates=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(t.clear,[]),n=0;n<this._states.length;n++){var i=this._states[n],a=i.items.filter(function(t){var r=Array.isArray(t)?t[0].layerId:t.layerId;return r===e});a.length&&r.push({id:i.id,items:a})}return r},u.insertState=function(e){for(var t=e.id,r=this._states.length,n=0;n<this._states.length;n++){var i=this._states[n];if(i.id>t){r=n;break}i.id===t&&(r=-1);break}r>-1&&(this._current<t&&(this._current=t),this._states.splice(r,0,e))},u.removeState=function(e){var t=void 0;for(i=0;i<this._states.length;i++){var r=this._states[i];if(r.id===e){t=i;break}}this._current===e&&(this._current=this._states.length>1?this._states[t-1].id:null),this._states.splice(t,1)},u.removeStates=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=0;t<e.length;t++){var r=e[t];this.removeState(r)}},u.insertStates=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=0;t<e.length;t++)this.insertState(e[t]);this.canCommit()},u._setState=function(){this.canUndo(),this.canCommit(),this.canRedo()},u._checkItems=function(e,t){var r=this,n={own:[],dependencies:{}};return e.forEach(function(e){Array.isArray(e)&&(e=e[t]),r.id===e.layerId?n.own.push(e):(n.dependencies[e.layerId]||(n.dependencies[e.layerId]={own:[],dependencies:{}}),n.dependencies[e.layerId].own.push(e))}),n},u.undo=function(){var e=this,t=void 0;return this._current===this.getFirstState().id?(this._current=null,t=this._states[0].items):this._states.find(function(r,n){if(r.id===e._current)return t=e._states[n].items,e._current=e._states[n-1].id,!0}),t=this._checkItems(t,0),this._setState(),t},u.redo=function(){var e=this,t=void 0;return this._current?this._states.find(function(r,n){if(e._current===r.id)return e._current=e._states[n+1].id,t=e._states[n+1].items,!0}):(t=this._states[0].items,this._current=this._states[0].id),t=this._checkItems(t,1),this._setState(),t},u.setItemsFeatureIds=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach(function(t){var r=t.id,n=t.clientid;e._states.forEach(function(e){var t=e.items;t.forEach(function(e){var t=e.feature.getId()===n&&e.feature;t&&t.setId(r)})})})},u.clear=function(e){var t=this;e?this._states.forEach(function(r,n){e.indexOf(r.id)!==-1&&(t._current&&t._current===r.id()&&t.undo(),t._states.splice(n,1))}):this._clearAll()},u._clearAll=function(){this._states=[],this._current=null,this.state.commit=!1,this.state.redo=!1,this.state.undo=!1},u.getState=function(e){return this._states.find(function(t){return t.id===e})},u.getFirstState=function(){return this._states.length?this._states[0]:null},u.getLastState=function(){var e=this._states.length;return e?this._states[e-1]:null},u.getCurrentState=function(){var e=this,t=null;return this._current&&this._states.length&&(t=this._states.find(function(t){return e._current===t.id})),t},u.getCurrentStateIndex=function(){var e=this,t=null;return this._current&&this._states.length&&this._states.forEach(function(r,n){if(e._current===r.id)return t=n,!1}),t},u.canCommit=function(){var e=this.commit(),t=!1;for(var r in e){var n=e[r];t=t||!!n.length}return this.state.commit=t,this.state.commit},u.canUndo=function(){var e=this._states.length-1-this.getCurrentStateIndex();return this.state.undo=!_.isNull(this._current)&&this._maxSteps>e,this.state.undo},u.canRedo=function(){return this.state.redo=this.getLastState()&&this.getLastState().id!=this._current||_.isNull(this._current)&&this._states.length>0,this.state.redo},u._getStatesToCommit=function(){var e=this;return this._states.filter(function(t){return t.id<=e._current})},u.commit=function(){var e={},t=this._getStatesToCommit();return t.forEach(function(t){t.items.forEach(function(t){var r=!0;if(Array.isArray(t)&&(t=t[1]),e[t.layerId]&&e[t.layerId].forEach(function(n,i){if(n.getUid()===t.feature.getUid()){if(t.feature.isNew()&&!n.isDeleted()&&t.feature.isUpdated()){var a=t.feature.clone();a.add(),e[t.layerId][i]=a}else t.feature.isNew()&&t.feature.isDeleted()?e[t.layerId].splice(i,1):(t.feature.isUpdated()||t.feature.isDeleted())&&(e[t.layerId][i]=t.feature);return r=!1,!1}}),r){var n=t.feature,i=t.layerId;!n.isNew()&&n.isAdded()||(e[i]||(e[i]=[]),e[i].push(n))}})}),e},t.exports=n},{"core/g3wobject":12,"core/utils/utils":68}],8:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.setters={start:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._start(e)},getFeatures:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._getFeatures(e)},stop:function(){return this._stop()},saveChangesOnServer:function(e){}},d(this,e),this.state={id:e.id,started:!1,getfeatures:!1},this._editor=e.editor,this._history=new h({id:this.state.id}),this._temporarychanges=[],this.register()}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=e("store/sessions"),s=n(o),l=e("store/map-layers"),u=n(l),c=e("core/utils/utils"),d=c.base,f=c.inherit,p=e("core/g3wobject"),h=e("core/editing/history"),v=e("core/layers/layer"),g=e("core/utils/geo").Geometry.is3DGeometry;f(i,p);var m=i.prototype;m.getId=function(){return this.state.id;
},m.getLastHistoryState=function(){return this._history.getLastState()},m.getLastStateId=function(){return this._history.getLastState().id},m.deleteState=function(e){this._history.removeState(e)},m.register=function(){s["default"].register(this)},m.unregister=function(){s["default"].unregister(this.getId())},m._start=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred();return this._editor.start(t).then(function(t){e.state.started=!0,r.resolve(t)}).fail(function(e){r.reject(e)}),r.promise()},m._getFeatures=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred();return this._allfeatures?r.resolve([]):(this._allfeatures=!t.filter,this._editor.getFeatures(t).then(function(t){t.then(function(t){e.state.getfeatures=!0,r.resolve(t)}).fail(function(e){return r.reject(e)})})),r.promise()},m.isStarted=function(){return this.state.started},m.getEditor=function(){return this._editor},m.setEditor=function(e){this._editor=e},m.save=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred();if(this._temporarychanges.length){var n=t.id||Date.now();this._history.add(n,this._temporarychanges).then(function(){e._temporarychanges=[],r.resolve(n)})}else r.resolve(null);return r.promise()},m.updateTemporaryChanges=function(e){this._temporarychanges.forEach(function(t){t.feature.setProperties(e.getProperties())})},m.pushAdd=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];r&&this._editor.removeNotEditablePropriertiesFromFeature(t);var n=t.clone();return this.push({layerId:e,feature:n.add()}),n},m.pushDelete=function(e,t){return this.push({layerId:e,feature:t["delete"]()}),t},m.pushUpdate=function(e,t,r){if(t.isNew()){var n=this._temporarychanges.findIndex(function(r){return r.layerId===e&&r.feature.getId()===t.getId()});if(n!==-1){var i=t.clone();return i.add(),void(this._temporarychanges[n].feature=i)}}this.push({layerId:e,feature:t.update()},{layerId:e,feature:r.update()})},m.removeChangesFromHistory=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this._history.removeStates(e)},m.moveRelationStatesOwnSession=function(){var e={},t=this.getCommitItems(),r=t.relations;for(var n in r){var i=this._history.getRelationStates(n),a=s["default"].getSession(n);a._history.insertStates(i),e[n]=i.map(function(e){return e.id})}return e},m.push=function(e,t){var r=t?[t,e]:e;this._temporarychanges.push(r)},m.revert=function(){var e=this,t=$.Deferred();return this._editor.revert().then(function(){e._history.clear(),t.resolve()}),t.promise()},m._filterChanges=function(){var e=this.getId(),t={own:[],dependencies:{}};return this._temporarychanges.forEach(function(r){var n=Array.isArray(r)?r[0]:r;n.layerId===e?t.own.push(n):(t.dependencies[n.layerId]||(t.dependencies[n.layerId]=[]),t.dependencies[n.layerId].unshift(n))}),t},m.rollback=function(e){if(e)return this._editor.rollback(e);var t=$.Deferred(),r=this._filterChanges();return this._editor.rollback(r.own).then(function(){var e=r.dependencies;for(var n in e)s["default"].getSession(n).rollback(e[n]);t.resolve(e)}),this._temporarychanges=[],t.promise()},m.rollbackDependecies=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach(function(t){var r=[];e._temporarychanges=e._temporarychanges.filter(function(e){if(e.layerId===t)return r.push(e),!1}),r.length&&s["default"].getSession(t).rollback(r)})},m.undo=function(e){return e=e||this._history.undo(),this._editor.setChanges(e.own,!0),this._history.canCommit(),e.dependencies},m.redo=function(e){return e=e||this._history.redo(),this._editor.setChanges(e.own,!0),this._history.canCommit(),e.dependencies},m._serializeCommit=function(e){var t=this.getId(),r=void 0,n=void 0,i={add:[],update:[],"delete":[],relations:{}};for(var o in e){var l=!1,u=e[o];if(o!==t){l=!0;var c=s["default"].getSession(o),d=c?c.getEditor().getLockIds():[];i.relations[o]={lockids:d,add:[],update:[],"delete":[]},n=i.relations[o]}else n=i;u.forEach(function(e){r=e.getState();var t=new ol.format.GeoJSON;switch(r){case"delete":e.isNew()||n["delete"].push(e.getId());break;default:var i=t.writeFeatureObject(e),o=e.getProperties();for(var s in i.properties)i.properties[s]&&"object"===a(i.properties[s])&&i.properties[s].constructor===Object&&(i.properties[s]=i.properties[s].value),void 0===i.properties[s]&&o[s]&&(i.properties[s]=o[s]);var l=e.isNew()?"add":e.getState();n[l].push(i)}}),!l||n.add.length||n.update.length||n["delete"].length||delete i.relations[o]}return i},m.getCommitItems=function(){var e=this._history.commit();return this._serializeCommit(e)},m.set3DGeometryType=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.layerId,n=void 0===r?this.getId():r,i=t.commitItems,a=i.relations,o=u["default"].getLayerById(n).getEditingLayer();if(o&&o.getType()===v.LayerTypes.VECTOR){var s=o.getGeometryType();g(s)&&["add","update"].forEach(function(e){i[e].forEach(function(e){return e.geometry.type=s})})}Object.keys(a).forEach(function(t){return e.set3DGeometryType({layerId:t,commitItems:a[t]})})},m.commit=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.ids,n=void 0===r?null:r,i=t.items,a=t.relations,o=void 0===a||a,l=$.Deferred(),u=void 0;return n?(u=this._history.commit(n),this._history.clear(n)):(i?u=i:(u=this._history.commit(),u=this._serializeCommit(u)),o||(u.relations={}),this._editor.commit(u).then(function(t){if(t&&t.result){var r=t.response,n=r.new_relations,i=void 0===n?{}:n;for(var a in i){var o=s["default"].getSession(a);o.getEditor().applyCommitResponse({response:i[a],result:!0})}e._history.clear(),e.saveChangesOnServer(u),l.resolve(u,t)}else l.reject(t)}).fail(function(e){return l.reject(e)})),l.promise()},m._canStop=function(){return this.state.started||this.state.getfeatures},m._stop=function(){var e=this,t=$.Deferred();return this._canStop()?this._editor.stop().then(function(){e.clear(),t.resolve()}).fail(function(e){return t.reject(e)}):t.resolve(),t.promise()},m.clear=function(){this._allfeatures=!1,this.state.started=!1,this.state.getfeatures=!1,this.clearHistory(),this._editor.clear()},m.getHistory=function(){return this._history},m.clearHistory=function(){this._history.clear()},t.exports=i},{"core/editing/history":7,"core/g3wobject":12,"core/layers/layer":34,"core/utils/geo":64,"core/utils/utils":68,"store/map-layers":377,"store/sessions":380}],9:[function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=e("core/i18n/i18n.service"),o=a.t,s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._error=e.error},l=s.prototype;l.parse=function(){function e(t){var r=Object.entries(t),a=r.find(function(e){var t=i(e,2),r=t[0];t[1];return"fields"===r});if(a){var o=i(a,2),l=o[1];try{if("string"==typeof l){var u=r.find(function(e){var t=i(e,2),r=t[0];t[1];return"fields"!==r}),c=i(u,1),d=c[0];s="["+d+"] "+l}else s="",Object.entries(l).forEach(function(e){var t=i(e,2),r=t[0],n=t[1];s=""+s+r+" "+(Array.isArray(n)?n[0]:n)+" \n"})}catch(f){}return s.replace(/\:|\./g,"")}var p=i(r[0],2),h=p[1];if(!Array.isArray(h)&&"object"===("undefined"==typeof h?"undefined":n(h)))return e(h)}var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.type,a=void 0===r?"responseJSON":r,s="server_saver_error";if("responseJSON"===a){if(this._error&&this._error.responseJSON&&this._error.responseJSON.error.message)return this._error.responseJSON.error.message;if(this._error&&this._error.errors)return e(this._error.errors)}else if("String"===a)return"string"==typeof this._error?this._error:e(this._error);return o("server_saver_error")},t.exports=s},{"core/i18n/i18n.service":13}],10:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var a=e("services/data"),o=n(a),s=e("core/utils/geo"),l=s.convertFeatureToGEOJSON;r["default"]={handleFilterExpressionFormInput:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function r(){var e,t,n,i,a,s,u,c,d,f,p=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},h=p.field,v=p.feature,g=p.qgs_layer_id,m=p.parentData;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(e=h.input.options,t=e.key,n=e.value,i=e.layer_id,a=void 0===i?g:i,s=e.filter_expression,u=e.loading,s){r.next=3;break}return r.abrupt("return");case 3:return u.state="loading",r.prev=4,r.next=7,o["default"].getData("expression:expression",{inputs:{field_name:h.name,layer_id:a,qgs_layer_id:g,form_data:l(v),parent:m&&{form_data:l(m.feature),qgs_layer_id:m.qgs_layer_id,formatter:0},formatter:0,expression:s.expression},outputs:!1});case 7:if(c=r.sent,"select_autocomplete"===h.input.type){for(h.input.options.values=[],d=[],f=0;f<c.length;f++)d.push({key:c[f].properties[t],value:c[f].properties[n]});d.sort(function(e,t){var r=e.key,n=t.key;return"string"==typeof r&&(r=r.toLowerCase(),n=n.toLowerCase()),r<n?-1:r>n?1:0}),h.input.options.values=d}return r.abrupt("return",c);case 12:return r.prev=12,r.t0=r["catch"](4),r.abrupt("return",Promise.reject(r.t0));case 15:return r.prev=15,u.state="ready",r.finish(15);case 18:case"end":return r.stop()}},r,this,[[4,12,15,18]])}));return e}(),handleDefaultExpressionFormInput:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function r(){var e,t,n,i,a,s,u,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},d=c.field,f=c.feature,p=c.qgs_layer_id,h=c.parentData;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(e=d.input.options,t=e.layer_id,n=void 0===t?p:t,i=e.default_expression,a=e.loading,s=e["default"],i){r.next=3;break}return r.abrupt("return");case 3:return a.state="loading",r.prev=4,r.next=7,o["default"].getData("expression:expression_eval",{inputs:{field_name:d.name,layer_id:n,qgs_layer_id:p,form_data:l(f),formatter:0,expression:i.expression,parent:h&&{form_data:l(h.feature),qgs_layer_id:h.qgs_layer_id,formatter:0}},outputs:!1});case 7:return u=r.sent,d.value=u,r.abrupt("return",u);case 12:return r.prev=12,r.t0=r["catch"](4),"undefined"!=typeof s&&(d.value=s),r.abrupt("return",Promise.reject(r.t0));case 16:return r.prev=16,a.state="ready",r.finish(16);case 19:case"end":return r.stop()}},r,this,[[4,12,16,19]])}));return e}()}},{"core/utils/geo":64,"services/data":358}],11:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("services/data"),a=n(i),o=e("core/utils/geo"),s=o.getFormDataExpressionRequestFromFeature,l=o.convertFeatureToGEOJSON;r["default"]={getVisibility:function(e){var t=e.qgs_layer_id,r=e.expression,n=e.feature,i=void 0===n?{}:n,o=e.contenttype,u="query"===o?1:0,c="editing"===o?l(i):s(i);return a["default"].getData("expression:expression_eval",{inputs:{qgs_layer_id:t,form_data:c,expression:r,formatter:u},outputs:!1})}}},{"core/utils/geo":64,"services/data":358}],12:[function(e,t,r){var n=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=e("core/utils/utils"),a=i.inherit,o=i.noop,s=i.debounce,l=i.throttle,u=function(){this.setters&&this._setupListenersChain(this.setters),this.debounces&&this._setupDebounces(this.debounces),this.throttles&&this._setupThrottles(this.throttles)};a(u,EventEmitter);var c=u.prototype;c.onafter=function(e,t,r){return this._onsetter("after",e,t,!1,r)},c.onceafter=function(e,t,r){return this._onsetter("after",e,t,!1,r,!0)},c.onbefore=function(e,t,r){return this._onsetter("before",e,t,!1,r)},c.oncebefore=function(e,t,r){return this._onsetter("before",e,t,!1,r,!0)},c.onbeforeasync=function(e,t,r){return this._onsetter("before",e,t,!0,r)},c.un=function(e,t){Object.entries(this.settersListeners).forEach(function(r){var i=n(r,2),a=(i[0],i[1]);void 0===t?a[e].splice(0):a[e].forEach(function(r,n){r.key===t&&a[e].splice(n,1)})})},c._onsetter=function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=void 0;return"undefined"!=typeof this.settersListeners[e][t]&&(o=""+(Math.floor(1e6*Math.random())+Date.now()),this.settersListeners[e][t].push({key:o,fnc:r,async:n,priority:i,once:a}),this.settersListeners[e][t]=_.sortBy(this.settersListeners[e][t],function(e){return e.priority})),o},c._setupListenersChain=function(e){var t=this;this.settersListeners={after:{},before:{}};var r=function(r){var n=e[r],i=o,a=o;_.isFunction(n)?i=n:(i=n.fnc,a=n.fallback||o),t.settersListeners.after[r]=[],t.settersListeners.before[r]=[],t[r]=function(){for(var e=this,t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];var s=$.Deferred(),l=null,u=0,c=function(){l=i.apply(e,n),s.resolve(l);var t=[],a=e.settersListeners.after[r];a.forEach(function(r){r.fnc.apply(e,n),r.once&&t.push(r.key)}),t.forEach(function(t){return e.un(r,t)})},d=function(){a.apply(e,n),s.reject()},f=this.settersListeners.before[r];u=0;var p=function h(t){var i=!0;if(_.isBoolean(t)&&(i=t),i===!1)d.apply(e,n);else if(u===f.length){var a=c();void 0!==a&&a!==!0||e.emitEvent("set:"+r,n)}else if(i){var o=f[u],s=u;if(f[u].async)n.push(h),u+=1,o.fnc.apply(e,n);else{var l=o.fnc.apply(e,n);u+=1,h(l)}o.once&&f.splice(s,1)}};return p(),s.promise()}};for(var n in e)r(n);return this.settersListeners},c._setupDebounces=function(e){for(var t in e){var r=e[t].delay,n=e[t].fnc;this[t]=s(n,r)}},c._setupThrottles=function(e){for(var t in e){var r=e[t].delay,n=e[t].fnc;this[t]=l(n,r)}},c.get=function(e){return!this[e]||this[e]instanceof Function?null:this[e]},c.set=function(e,t){this[e]=t},t.exports=u},{"core/utils/utils":68}],13:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return e.appLanguages.forEach(function(e){s[e]={plugins:{}}}),i18next.use(i18nextXHRBackend).init({lng:e.language,ns:"app",fallbackLng:"en",resources:e.resources}),new Promise(function(e,t){jqueryI18next.init(i18next,$,{tName:"t",i18nName:"i18n",handleName:"localize",selectorAttr:"data-i18n",targetAttr:"data-i18n-target",optionsAttr:"data-i18n-options",useOptionsAttr:!1,parseDefaultValueFromContent:!0}),p(s),e()})}var a=e("services/application"),o=n(a),s={},l=function(){var e=o["default"].getConfig();return e.user.i18n||"en"},u=function(e){return i18next.t(e)},c=function(e){return i18next.t("plugins."+e)},d=function(e){return function(t){return i18next.t(e+"."+t)}},f=function(e){var t=e.name,r=e.config;for(var n in r){var i=s[n];i&&(i.plugins[t]=r[n])}p(s)},p=function(e){for(var t in e){var r=e[t];for(var n in r)i18next.addResource(t,"translation",n,r[n])}},h=function(e){i18next.changeLanguage(e)};t.exports={init:i,t:u,tPlugin:c,tPrefix:d,addI18n:p,addI18nPlugin:f,changeLanguage:h,getAppLanguage:l}},{"services/application":351}],14:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("services/iframe-plugin"),a=n(i);t.exports=a["default"]},{"services/iframe-plugin":364}],15:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};p(this),this.ready=!1,this.init=function(){}}var o=e("services/data"),s=n(o),l=e("store/projects"),u=n(l),c=e("services/gui"),d=n(c),f=e("core/utils/utils"),p=f.base,h=f.inherit,v=f.createFilterFormField,g=e("core/g3wobject");h(a,g);var m=a.prototype;m.mapService=d["default"].getComponent("map").getService(),m.project=u["default"].getCurrentProject(),m.layers=void 0,m.getQgsLayerId=function(e){var t=e.qgs_layer_id,r=e.noValue,n=void 0===r?this.layers.map(function(e){return e.id}):r;return t?Array.isArray(t)?t:[t]:n},m.searchFeature=function(){var e=i(regeneratorRuntime.mark(function t(e){var r,n,i,a,o,l,u=e.layer,c=e.feature;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.project.getSearchEndPoint(),n=c.field,i=c.value,e.next=4,s["default"].getData("search:features",{inputs:{layer:u,search_endpoint:r,filter:v({layer:u,search_endpoint:r,field:n,value:i})},outputs:!1});case 4:return a=e.sent,o=a.data,l=void 0===o?[]:o,e.abrupt("return",l);case 8:case"end":return e.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),m.findFeaturesWithGeometry=i(regeneratorRuntime.mark(function y(){var e,t,r,n,i,a,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=o.qgs_layer_id,l=void 0===s?[]:s,u=o.feature,c=o.zoom,d=void 0!==c&&c,f=o.highlight,p=void 0!==f&&f;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:e={found:!1,features:[],qgs_layer_id:null},t=l.length,r=0;case 3:if(e.found||!(r<t)){o.next=20;break}if(n=this.project.getLayerById(l[r]),o.prev=5,o.t0=n,!o.t0){o.next=11;break}return o.next=10,this.searchFeature({layer:n,feature:u});case 10:o.t0=o.sent;case 11:i=o.t0,i.length?(a=i[0].features,e.found=a.length>0&&!!a.find(function(e){return e.getGeometry()}),e.found?(e.features=a,e.qgs_layer_id=l[r],d&&this.mapService.zoomToFeatures(a,{highlight:p})):r++):r++,o.next=18;break;case 15:o.prev=15,o.t1=o["catch"](5),r++;case 18:o.next=3;break;case 20:return!e.found&&this.mapService.zoomToProjectInitExtent(),o.abrupt("return",e);case 22:case"end":return o.stop()}},y,this,[[5,15]])})),m.setLayers=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];m.layers=e},m.getLayers=function(){return m.layers},m.setReady=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.ready=e},m.getReady=function(){return this.ready},m.stop=i(regeneratorRuntime.mark(function _(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},_,this)})),m.clear=function(){},t.exports=a},{"core/g3wobject":12,"core/utils/utils":68,"services/data":358,"services/gui":361,"store/projects":379}],16:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("services/iframe-app"),a=n(i),o=e("services/iframe-editing"),s=n(o);t.exports={app:a["default"],editing:s["default"]}},{"services/iframe-app":362,"services/iframe-editing":363}],17:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(){u(this),this.pluginName,this.dependencyApi={},this.init=i(regeneratorRuntime.mark(function e(){var t,r=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=n.layers,o=void 0===a?{}:a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.layers=o,s["default"].isPluginInConfiguration(this.pluginName)&&(t=s["default"].getPlugin(this.pluginName),t?(this.setDependencyApi(t.getApi()),this.setReady(!0)):s["default"].onafter("registerPlugin",function(){var e=i(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.isReady();case 2:e.getName()===r.pluginName&&(r.setDependencyApi(e.getApi()),r.setReady(!0));case 3:case"end":return t.stop()}},t,r)}));return function(t){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}},e,this)})),this.clear=function(){}}var o=e("store/plugins"),s=n(o),l=e("core/utils/utils"),u=l.base,c=l.inherit,d=e("core/iframe/services/baseservice");c(a,d);var f=a.prototype;f.setDependencyApi=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.dependencyApi=e},f.getDependecyApi=function(){return this.dependencyApi},t.exports=a},{"core/iframe/services/baseservice":15,"core/utils/utils":68,"store/plugins":378}],18:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.config=e,a(this,e,t)}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("core/layers/baselayers/baselayer"),l=e("g3w-ol/layers/bases");o(n,s);var u=n.prototype;u._makeOlLayer=function(){var e=this.config,t=e.url,r=e.attributions,n=e.crs,i=this.getProjectionFromCrs(n),a=l.TMS.get({url:t,source_type:"arcgismapserver",projection:i,attributions:r});return a},t.exports=n},{"core/layers/baselayers/baselayer":19,"core/utils/utils":68,"g3w-ol/layers/bases":107}],19:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(a(this,e,t),this.isWMS()){var r={url:this.getWmsUrl(),id:this.state.id,tiled:this.state.tiled};this._mapLayer=new l(r),this._mapLayer.addLayer(this)}else this._mapLayer=this}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("g3w-ol/projection/projections"),l=e("core/layers/map/wmslayer"),u=e("core/layers/imagelayer");o(n,u);var c=n.prototype;c.getProjectionFromCrs=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.epsg=e.epsg?e.epsg:"EPSG:3857",s.get(e)},c._makeOlLayer=function(){},c._registerLoadingEvent=function(){var e=this;this._olLayer.getSource().on("imageloadstart",function(){e.emit("loadstart")}),this._olLayer.getSource().on("imageloadend",function(){e.emit("loadend")})},c.getSource=function(){return this.getOLLayer().getSource()},c.update=function(e,t){this._updateLayer(e,t)},c.getOLLayer=function(){var e=this._olLayer;return e||(e=this._olLayer=this._makeOlLayer(),this._registerLoadingEvent(),this._mapLayer.config.attributions&&this._olLayer.getSource().setAttributions(this._mapLayer.config.attributions),e.setVisible(this._mapLayer.state.visible)),e},c._updateLayer=function(e,t){this.isWMS()&&this._mapLayer.update(e,t)},c.setVisible=function(e){this.getOLLayer().setVisible(e)},c.getMapLayer=function(){return this._mapLayer},t.exports=n},{"core/layers/imagelayer":33,"core/layers/map/wmslayer":45,"core/utils/utils":68,"g3w-ol/projection/projections":111}],20:[function(e,t,r){var n={OSM:e("./osmlayer"),Bing:e("./binglayer"),TMS:e("./tmslayer"),ARCGISMAPSERVER:e("./arcgislayer"),WMTS:e("./wmtslayer"),WMS:e("./wmslayer")};t.exports=n},{"./arcgislayer":18,"./binglayer":21,"./osmlayer":22,"./tmslayer":23,"./wmslayer":24,"./wmtslayer":25}],21:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};l(this,e,t)}var a=e("store/application-state"),o=n(a),s=e("core/utils/utils"),l=s.base,u=s.inherit,c=e("core/layers/baselayers/baselayer"),d=e("g3w-ol/layers/bases");u(i,c);var f=i.prototype;f._makeOlLayer=function(){var e=void 0,t=o["default"].keys.vendorkeys.bing,r=this.config.source?this.config.source.subtype:null;switch(r){case"streets":e=d.BING.get({imagerySet:"Road",key:t});break;case"aerial":e=d.BING.get({imagerySet:"Aerial",key:t});break;case"aerialwithlabels":e=d.BING.get({imagerySet:"AerialWithLabels",key:t});break;default:e=d.BING.get({imagerySet:"Aerial",key:t})}return e},t.exports=i},{"core/layers/baselayers/baselayer":19,"core/utils/utils":68,"g3w-ol/layers/bases":107,"store/application-state":373}],22:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,e,t)}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("core/layers/baselayers/baselayer"),l=e("g3w-ol/layers/bases");a(n,s);var u=n.prototype;u._makeOlLayer=function(){var e=l.OSM.get({id:this.config.name,title:this.config.title,url:this.config.url});return e},t.exports=n},{"core/layers/baselayers/baselayer":19,"core/utils/utils":68,"g3w-ol/layers/bases":107}],23:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.config=e,a(this,e,t)}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("core/layers/baselayers/baselayer"),l=e("g3w-ol/layers/bases");o(n,s);var u=n.prototype;u._makeOlLayer=function(){var e=this.config,t=e.url,r=e.attributions,n=e.minZoom,i=e.maxZoom,a=e.crs,o=this.getProjectionFromCrs(a),s=l.TMS.get({url:t,minZoom:n,maxZoom:i,attributions:r,projection:o});return s},t.exports=n},{"core/layers/baselayers/baselayer":19,"core/utils/utils":68,"g3w-ol/layers/bases":107}],24:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.config=e,o(this,e,t)}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("core/layers/baselayers/baselayer"),l=e("g3w-ol/layers/bases");a(n,s);var u=n.prototype;u._makeOlLayer=function(){var e=this.config,t=e.url,r=e.layers,n=e.singleTile,i=e.attributions,a=e.crs,o=e.opacity,s=this.getProjectionFromCrs(a),u=l.WMS.get({url:t,layers:r,singleTile:n,attributions:i,projection:s,opacity:o});return u},t.exports=n},{"core/layers/baselayers/baselayer":19,"core/utils/utils":68,"g3w-ol/layers/bases":107}],25:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.config=e,a(this,e,t)}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("core/layers/baselayers/baselayer"),l=e("g3w-ol/layers/bases");o(n,s);var u=n.prototype;u._makeOlLayer=function(){var e=this.config,t=e.url,r=e.layer,n=e.attributions,i=e.matrixSet,a=e.format,o=e.style,s=e.requestEncoding,u=e.crs,c=this.getProjectionFromCrs(u),d=l.WMTS.get({url:t,layer:r,attributions:n,format:a,projection:c,requestEncoding:s,matrixSet:i,style:o});return d},t.exports=n},{"core/layers/baselayers/baselayer":19,"core/utils/utils":68,"g3w-ol/layers/bases":107}],26:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("app/constant"),a=n(i),o=e("core/utils/utils"),s=o.uniqueId,l=a["default"].GEOMETRY_FIELDS,u=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ol.Feature.call(this),this._uid=s(),this._newPrefix="_new_",this._geometry=!1;var r=t.feature,n=t.properties;if(r){n&&Array.isArray(n)?n.forEach(function(t){return e.set(t,r.get(t))}):this.setProperties(r.getProperties()),this.setId(r.getId()),this.setGeometryName(r.getGeometryName());var i=r.getGeometry();this._geometry=!!i,i&&this.setGeometry(i);var a=this.getStyle();a&&this.setStyle(a)}this.state={"new":!1,state:null,visible:!0}};ol.inherits(u,ol.Feature);var c=u.prototype;c.constructor="Feature",c.getUid=function(){return this._uid},c._setUid=function(e){this._uid=e},c.isGeometry=function(){return this._geometry},c.cloneNew=function(){var e=this.clone(),t=s();return e._setUid(t),e.setTemporaryId(),e},c.clone=function(){var e=ol.Feature.prototype.clone.call(this);e.setId(this.getId()),this.isGeometry()&&e.setGeometry(e.getGeometry().clone());var t=new u({feature:e}),r=this.getUid();return t._setUid(r),t.setState(this.getState()),this.isNew()&&t.setNew(),t},c.setTemporaryId=function(){var e=""+this._newPrefix+s();this.setId(e),this.setNew()},c.setNew=function(){this.state["new"]=!0},c["delete"]=function(){return this.state.state="delete",this},c.update=function(){return this.state.state="update",this},c.add=function(){return this.state.state="add",this},c.isNew=function(){return this.state["new"]},c.isAdded=function(){return"add"===this.state.state},c.isUpdated=function(){return"update"===this.state.state},c.isDeleted=function(){return"delete"===this.state.state},c.setFullState=function(e){this.state=e},c.getFullState=function(){return this.state},c.setState=function(e){this.state.state=e},c.getState=function(){return this.state.state},c.getAlphanumericProperties=function(){var e=this.getProperties(),t={};for(var r in e)l.indexOf(r)===-1&&(t[r]=e[r]);return t},c.clearState=function(){this.state.state=null,this.state["new"]=!1},c.isVisible=function(){return this.state.visible},c.setVisible=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.state.visible=e},t.exports=u},{"app/constant":4,"core/utils/utils":68}],27:[function(e,t,r){function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._features=e.features||[],this._provider=e.provider||null,this._loadedIds=[],this._lockIds=[],this.hasFeatureLockByOtherUser=!1,this.setters={addFeatures:function(e){var t=this;e.forEach(function(e){t._addFeature(e)})},addFeature:function(e){this._addFeature(e)},removeFeature:function(e){this._removeFeature(e)},updateFeature:function(e){this._updateFeature(e)},clear:function(){this._clearFeatures()},getFeatures:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._getFeatures(e)},commit:function(e,t){return this._commit(e,t)},featuresLockedByOtherUser:function(){this.hasFeatureLockByOtherUser=!0}},o(this)}var a=e("core/utils/utils"),o=a.base,s=a.inherit,l=e("core/g3wobject");s(i,l);var u=i.prototype;u.clone=function(){return _.cloneDeep(this)},u.setProvider=function(e){this._provider=e},u.getProvider=function(){return this._provider},u.unlock=function(){var e=this,t=$.Deferred();return this._provider.unlock().then(function(r){e.hasFeatureLockByOtherUser=!1,t.resolve(r)}).fail(function(e){return t.reject(e)}),t.promise()},u._getFeatures=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred();return this._provider?this._provider.getFeatures(t).then(function(t){var n=e._filterFeaturesResponse(t);e.addFeatures(n),r.resolve(n)}).fail(function(e){return r.reject(e)}):r.resolve(this._readFeatures()),r.promise()},u._filterFeaturesResponse=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.features,n=void 0===r?[]:r,i=t.featurelocks,a=void 0===i?[]:i,o=t.count,s=n.filter(function(t){var r=t.getId(),n=e._loadedIds.indexOf(r)!==-1;return n||e._loadedIds.push(r),!n});return this._filterLockIds(a),n.length<o&&!this.hasFeatureLockByOtherUser&&this.featuresLockedByOtherUser(),s},u._filterLockIds=function(e){var t=this._lockIds.map(function(e){return e.featureid}),r=e.filter(function(e){return t.indexOf(e.featureid)===-1});this._lockIds=[].concat(n(this._lockIds),n(r))},u.addLoadedIds=function(e){this._loadedIds.push(e)},u.getLockIds=function(){return this._lockIds},u.addLockIds=function(e){var t=this;this._lockIds=_.union(this._lockIds,e),this._lockIds.forEach(function(e){
return t._loadedIds.push(e.featureid)})},u._readFeatures=function(){return this._features},u._commit=function(e){var t=$.Deferred();return e&&this._provider?(e.lockids=this._lockIds,this._provider.commit(e).then(function(e){return t.resolve(e)}).fail(function(e){return t.reject(e)})):t.reject(),t.promise()},u.getFeatureById=function(e){return this._features.find(function(t){return t.getId()==e})},u.getFeatureByUid=function(e){return this._features.find(function(t){return t.getUid()===e})},u._addFeature=function(e){this._features.push(e)},u._updateFeature=function(e){var t=this;this._features.find(function(r,n){if(r.getUid()===e.getUid())return t._features[n]=e,!0})},u.setFeatures=function(e){this._features=e},u._removeFeature=function(e){this._features=this._features.filter(function(t){return e.getUid()!==t.getUid()})},u._clearFeatures=function(){this._features=null,this._features=[],this._lockIds=[],this._loadedIds=[]},u.getDataProvider=function(){return this._provider},u.readFeatures=function(){return this._features},t.exports=i},{"core/g3wobject":12,"core/utils/utils":68}],28:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this._features=e.features||new ol.Collection([])}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("core/layers/features/featuresstore");a(n,s);var l=n.prototype;l.getLength=function(){return this._features.getLength()},l.setFeatures=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach(function(t){return e._features.push(t)})},l.readFeatures=function(){return this._features.getArray()},l.getFeaturesCollection=function(){return this._features},l.getFeatureById=function(e){return this._features.getArray().find(function(t){return t.getId()==e})},l.getFeatureByUid=function(e){return this._features.getArray().find(function(t){return t.getUid()===e})},l._addFeature=function(e){this._features.push(e),this._features.dispatchEvent("change")},l._updateFeature=function(e){for(var t=-1,r=this._features.getArray(),n=0;r.length;n++){var i=r[n];if(i.getUid()===e.getUid()){t=n;break}}t>=0&&(this._features.removeAt(t),this._features.insertAt(t,e),this._features.dispatchEvent("change"))},l._removeFeature=function(e){for(var t=this._features.getArray(),r=0;r<t.length;r++){var n=t[r];if(e.getUid()===n.getUid()){this._features.removeAt(r);break}}this._features.dispatchEvent("change")},l._clearFeatures=function(){try{this._features.clear()}catch(e){}this._features=null,this._features=new ol.Collection([])},t.exports=n},{"core/layers/features/featuresstore":27,"core/utils/utils":68}],29:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._layerName=e.layerName;var t=e.filter;this._expression=t&&t||""}var i=e("app/constant"),a=n.prototype;a.and=function(e,t){return this._expression=this._expression?this._expression+" AND ":this._expression,e&&t&&this.eq(e,t),this},a.or=function(){return field&&value&&(this._expression=this._expression?this._expression+" OR ":this._expression,this.eq(field,value)),this},a.eq=function(e,t){return this._expression=this._expression+this._build("eq",e,t),this},a.like=function(e,t){return this._expression=this._expression+this._build("LIKE",e,t),this},a.ilike=function(e,t){return this._expression=this._expression+this._build("ILIKE",e,t),this},a.not=function(e,t){return this._expression=this._expression+this._build("NOT",e,t),this},a.gt=function(e,t){return this._expression=this._expression+this._build("gt",e,t),this},a.gte=function(e,t){return this._expression=this._expression+this._build("gte",e,t),this},a.lt=function(e,t){return this._expression=this._expression+this._build("lt",e,t),this},a.lte=function(e,t){return this._expression=this._expression+this._build("lte",e,t),this},a.clear=function(){return this._expression="",this},a.get=function(){return this._layerName?this._layerName+": "+this._expression:this._expression},a._build=function(e,t,r){return['"'+t+'"',i.FILTER_EXPRESSION_OPERATORS[e],""+r].join(" ")},a.createSingleExpressionElement=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.value,r=e.attribute,n=e.operator,a=e.logicop,o=void 0,s="LIKE"===n||"ILIKE"===n?"%":"",l=i.FILTER_EXPRESSION_OPERATORS[n],u=a&&" "+a+" "||"";if("IN"===n){var c=Array.isArray(t)?t:[t],d="( "+c.map(function(e){return"'"+e+"'"}).join(",").replace(/,/g," , ")+" )";o='"'+r+'" '+l+" "+d+u}else if(null!==t&&void 0!==t&&!Number.isNaN(t)&&t.toString().trim()){var f=Array.isArray(t)?t:"number"!=typeof t?t.split("'"):[];if(f.length>1){for(var p=[],h=0;h<f.length;h++){var v=f[h];if(v){var g=("%"+v+"%").trim(),m='"'+r+'" '+l+" '"+g+"'";p.push(m)}}o=""+p.join(" "+a+" ")+u}else o='"'+r+'" '+l+" '"+s+t+s+"'"+u}return o},a.createExpressionFromFilterObject=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=[],n=void 0;for(var a in t){n=i.FILTER_EXPRESSION_OPERATORS[a];var o=t[a];o.forEach(function(t){for(var n in t){var i=t[n];if(Array.isArray(i))e.createExpressionFromFilterObject(t);else{var a=t[n];for(var o in a){var s=a[o],l=e.createSingleExpressionElement({value:s,operator:n,attribute:o});r.push(l)}}}}),n=r.length>0&&r.join(" "+n+" ")}return n},a.createExpressionFromField=function(e){var t=e.layerName,r=e.field,n=e.value,i=e.operator,a=void 0===i?"eq":i,o=this.createSingleExpressionElement({attribute:r,value:n,operator:a});return this._expression=t+":"+o,this},a.createExpressionFromFilterArray=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r="",n=t.length?t.length-1:t.length;return t.forEach(function(t,i){var a=e.createSingleExpressionElement(t);r=""+r+(t.logicop&&i===n?a.substring(0,a.length-(t.logicop.length+1)):a)}),r||void 0},a.createExpressionFromFilter=function(e,t){var r=Array.isArray(e)?this.createExpressionFromFilterArray(e):this.createExpressionFromFilterObject(e);return r&&(this._expression=t+":"+r),this},t.exports=n},{"app/constant":4}],30:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._filter=null,this._type=null,this.config=e}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=n.prototype;a.getConfig=function(){return this.config},a.setConfig=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config=e},a.mergeConfig=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config=i({},this.config,e)},a.getAll=function(){this._type=n.TYPES.all,this._filter=null},a.setExpression=function(e){this._type=n.TYPES.expression,this._filter=e},a.setGeometry=function(e){return this._type=n.TYPES.geometry,this._filter=e,this},a.setBBOX=function(e){return this._type=n.TYPES.bbox,this._filter=e,this},a.setFids=function(e){return this._type=n.TYPES.fids,this._filter=e,this},a.serialize=function(){return JSON.stringify(this)},a.get=function(){return this._filter},a.getType=function(){return this._type},a.clear=function(){this._filter=null},n.TYPES={bbox:"bbox",geometry:"geometry",expression:"expression",fids:"fids",all:"all"},t.exports=n},{}],31:[function(e,t,r){function n(e,t){a(this,e,t),this.config.style=e.style,this.setup(e)}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("core/layers/vectorlayer"),l=e("core/layers/map/geojson");o(n,s);var u=n.prototype;u.getMapLayer=function(){if(this._mapLayer)return this._mapLayer;var e=this.get("source").url,t=this.getName(),r=this.getId(),n=this.get("style"),i=this.getProvider("data"),a={url:e,projection:this.getProjection().getCode(),id:r,name:t,style:n,provider:i};return this._mapLayer=new l(a),this._mapLayer},t.exports=n},{"core/layers/map/geojson":42,"core/layers/vectorlayer":57,"core/utils/utils":68}],32:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}}var a=e("services/gui"),o=n(a),s=e("services/application"),l=n(s),u=e("g3w-ol/projection/projections"),c=e("core/utils/ol"),d=c.getScaleFromResolution,f=e("core/utils/geo"),p=f.createFeatureFromFeatureObject,h=e("core/utils/utils"),v=h.XHR,g=h.sanitizeUrl,m={wms:["VERSION","REQUEST","BBOX","LAYERS","WIDTH","HEIGHT","DPI","FORMAT","CRS"]},y=i.prototype;y.setup=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.config){var r=t.project;this.config.map_crs=r.getProjection().getCode(),this.config.multilayerid=e.multilayer,this.legendCategories={},this.olSelectionFeatures={},_.extend(this.state,{geolayer:"NoGeometry"!==e.geometrytype,legend:{url:null,loading:!1,error:!1,show:!0,change:!1},external:e.source&&e.source.external||!1,bbox:e.bbox||null,visible:e.visible||!1,checked:e.visible||!1,epsg:e.crs.epsg,hidden:e.hidden||!1,scalebasedvisibility:e.scalebasedvisibility||!1,minscale:e.minscale,maxscale:e.maxscale,ows_method:e.ows_method,exclude_from_legend:"boolean"!=typeof e.exclude_from_legend||e.exclude_from_legend,categories:!1,expanded:e.expanded,opacity:e.opacity||100}),e.projection&&(this.config.projection=e.projection.getCode()===e.crs.epsg?e.projection:u.get(e.crs)),e.attributions&&(this.config.attributions=e.attributions),e.source&&e.source.url&&this._sanitizeSourceUrl()}},y.getLegendGraphic=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.all,r=void 0===t||t,n=l["default"].getConfig().layout?l["default"].getConfig().layout.legend:{},i=this.getLegendUrl(n,{categories:!0,all:r,format:"application/json"});return v.get({url:i})},y.setCategories=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.legendCategories[this.getCurrentStyle().name]=e,this.state.categories=e.length>0&&e.filter(function(e){return e.ruleKey}).length>0},y.getCategories=function(){return this.legendCategories[this.getCurrentStyle().name]},y.clearCategories=function(){this.legendCategories={},this.state.categories=!1},y.clearOlSelectionFeatures=function(){this.olSelectionFeatures=null},y.getOlSelectionFeature=function(e){return this.olSelectionFeatures[e]},y.updateOlSelectionFeature=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.feature,n=this.getOlSelectionFeature(t);if(n){n.feature=r;var i=o["default"].getService("map");i.setSelectionFeatures("update",{feature:r})}},y.deleteOlSelectionFeature=function(e){var t=this.olSelectionFeatures[e];t&&(mapService.setSelectionFeatures("remove",{feature:t.feature}),delete this.olSelectionFeatures[e])},y.getOlSelectionFeatures=function(){return this.olSelectionFeatures},y.addOlSelectionFeature=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.feature;return this.olSelectionFeatures[t]=this.olSelectionFeatures[t]||{feature:p({id:t,feature:r}),added:!1},this.olSelectionFeatures[t]},y.showAllOlSelectionFeatures=function(){var e=o["default"].getService("map");Object.values(this.olSelectionFeatures).forEach(function(t){!t.added&&e.setSelectionFeatures("add",{feature:t.feature}),t.added=!0})},y.setInversionOlSelectionFeatures=function(){var e=o["default"].getComponent("map").getService();Object.values(this.olSelectionFeatures).forEach(function(t){e.setSelectionFeatures(t.added?"remove":"add",{feature:t.feature}),t.added=!t.added})},y.setOlSelectionFeatureByFid=function(e,t){var r=this.olSelectionFeatures[e]&&this.olSelectionFeatures[e].feature;return r&&this.setOlSelectionFeatures({id:e,feature:r},t)},y.setOlSelectionFeatures=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"add",r=o["default"].getComponent("map").getService();if(e){var n=this.olSelectionFeatures[e.id]||this.addOlSelectionFeature(e);"add"===t?n.added||(n.feature.__layerId=this.getId(),r.setSelectionFeatures(t,{feature:n.feature}),n.added=!0):(r.setSelectionFeatures(t,{feature:n.feature}),n.added=!1)}else Object.values(this.olSelectionFeatures).forEach(function(e){e.added&&r.setSelectionFeatures("remove",{feature:e.feature}),e.added=!1});return!Object.values(this.olSelectionFeatures).find(function(e){return e.added})},y._sanitizeSourceUrl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"wms",t=g({url:this.config.source.url,reserverParameters:m[e]});this.config.source.url=t},y.isLayerCheckedAndAllParents=function(){var e=this.isChecked();if(e)for(var t=this.state.parentGroup;e&&t;)e=e&&t.checked,t=t.parentGroup;return e},y.setChecked=function(e){this.state.checked=e},y.isChecked=function(){return this.state.checked},y.setVisible=function(e){var t=this.state.visible;this.state.visible=e&&this.isChecked();var r=t!==this.state.visible;return r&&this.change(),this.state.visible},y.isVisible=function(){return this.state.visible},y.isDisabled=function(){return this.state.disabled},y.isPrintable=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.scale;return this.isLayerCheckedAndAllParents()&&(!this.state.scalebasedvisibility||t>=this.state.maxscale&&t<=this.state.minscale)},y.getStyles=function(){return this.config.source.external?this.config.source.styles:this.config.styles},y.getStyle=function(){return this.config.source.external?this.config.source.styles:this.config.styles?this.config.styles.find(function(e){return e.current}).name:""},y.getOpacity=function(){return this.state.opacity},y.setCurrentStyle=function(e){var t=!1;return this.config.styles.forEach(function(r){r.name===e&&(t=!r.current),r.current=r.name===e}),t},y.getCurrentStyle=function(){return this.config.styles.find(function(e){return e.current})},y.setDisabled=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"m";if(this.state.scalebasedvisibility){var r=d(e,t);this.state.disabled=!(r>=this.state.maxscale&&r<=this.state.minscale),this.state.disabled=0===this.state.minscale?!(r>=this.state.maxscale):this.state.disabled;for(var n=!0,i=this.state.parentGroup;i;)n=n&&i.checked,i=i.parentGroup;n&&this.setVisible(!this.state.disabled),this.isFilterable()&&this.setTocHighlightable(!this.state.disabled)}else this.state.disabled=!1},y.getMultiLayerId=function(){return this.config.multilayerid},y.getGeometryType=function(){return this.config.geometrytype},y.getOwsMethod=function(){return this.config.ows_method},y.setProjection=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config.projection=u.get(e)},y.getProjection=function(){return this.config.projection},y.getEpsg=function(){return this.config.crs.epsg},y.getCrs=function(){return this.config.projection&&this.config.projection.getCode()||null},y.getMapCrs=function(){return this.config.map_crs},y.isCached=function(){return this.config.cache_url&&""!==this.config.cache_url},y.getCacheUrl=function(){if(this.isCached())return this.config.cache_url},y.hasAxisInverted=function(){var e=this.getProjection(),t=e.getAxisOrientation?e.getAxisOrientation():"enu";return"ne"===t.substr(0,2)},y.getMapLayer=function(){},y.setMapProjection=function(e){this._mapProjection=e},y.getMapProjection=function(){return this._mapProjection},t.exports=i},{"core/utils/geo":64,"core/utils/ol":66,"core/utils/utils":68,"g3w-ol/projection/projections":111,"services/application":351,"services/gui":361}],33:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setters={change:function(){}},f(this,e,t),this.config.baselayer=e.baselayer||!1,this.type=v.LayerTypes.IMAGE,this.legendUrl=null,this.customParams={},this.setup(e,t)}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=e("store/projects"),l=n(s),u=e("services/application"),c=n(u),d=e("core/utils/utils"),f=d.base,p=d.inherit,h=d.mixin,v=e("core/layers/layer"),g=e("core/layers/vectorlayer"),m=e("core/layers/map/wmslayer"),y=e("core/layers/map/wmstlayer"),_=e("core/layers/map/arcgismapserverlayer"),b=e("core/layers/map/xyzlayer"),w=e("core/layers/legend/legendservice"),x=e("core/layers/geolayermixin");p(a,v),h(a,x);var S=a.prototype;S.getLayerForEditing=i(regeneratorRuntime.mark(function L(){var e,t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.force,a=void 0!==i&&i,o=n.vectorurl,s=n.project_type;n.project;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.isEditable()&&!a){n.next=16;break}return e=e||l["default"].getCurrentProject(),t=new g(this.config,{vectorurl:o,project_type:s,project:e}),n.prev=3,n.next=6,t.layerForEditing;case 6:return r=n.sent,this.setEditingLayer(r),n.abrupt("return",r);case 11:return n.prev=11,n.t0=n["catch"](3),n.abrupt("return",Promise.reject(n.t0));case 14:n.next=17;break;case 16:return n.abrupt("return",null);case 17:case"end":return n.stop()}},L,this,[[3,11]])})),S.isBaseLayer=function(){return this.config.baselayer},S.isWMS=function(){return a.WMSServerTypes.indexOf(this.config.servertype)>-1},S.isLayerProjectionASMapProjection=function(){return this.config.crs.epsg===this.config.map_crs},S.getCrs=function(){return this.config.crs.epsg},S.isExternalWMS=function(){return!!(this.config.source&&this.config.source.external&&this.config.source.url)},S.isArcgisMapserver=function(){return this.isExternalWMS()&&this.config.source.type===v.SourceTypes.ARCGISMAPSERVER},S._getBaseLayerName=function(){return this.isWmsUseLayerIds()?this.getId():this.getName()},S.getWMSLayerName=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=void 0===t?"map":t,n="map"!==r||this.isExternalWMS()&&this.isLayerProjectionASMapProjection(),i=this._getBaseLayerName();return n&&this.config.source&&("legend"===r||this.config.source.external)&&(this.config.source.layers||this.config.source.layer)&&(i=this.config.source.layers||this.config.source.layer),i},S.getWmsUrl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=void 0===t?"map":t,n="map"!==r||this.isExternalWMS()&&this.isLayerProjectionASMapProjection(),i=n&&this.config.source&&("legend"===r||this.config.source.external)&&("wms"===this.config.source.type||"wmst"===this.config.source.type)&&this.config.source.url?this.config.source.url:this.config.wmsUrl;return i},S.getWFSLayerName=function(){return this.getQueryLayerName().replace(/[/\s]/g,"_")},S.useProxy=function(){return this.isExternalWMS()&&this.isLayerProjectionASMapProjection()&&this.getInfoFormats()},S.getWMSInfoLayerName=function(){return this.isExternalWMS()&&this.isLayerProjectionASMapProjection()&&this.getInfoFormats()?this.getSource().layers:this._getBaseLayerName()},S.getPrintLayerName=function(){return this.isWmsUseLayerIds()?this.getId():this.getName()},S.getStringBBox=function(){var e=this.config.bbox;return e.minx+","+e.miny+","+e.maxx+","+e.maxy},S.isWfsActive=function(){return Array.isArray(this.config.ows)&&void 0!==this.config.ows.find(function(e){return"WFS"===e})},S.getFullWmsUrl=function(){var e=l["default"].getCurrentProject().getState().metadata.wms_url;return this.isExternalWMS()||!e?this.getWmsUrl():e},S.getCatalogWmsUrl=function(){var e=l["default"].getCurrentProject().getMetadata().wms_url,t=this.isExternalWMS()||!e?this.getWmsUrl()+"?service=WMS&version=1.3.0&request=GetCapabilities":e;return t},S.getCatalogWfsUrl=function(){return this.getWfsUrl()+"?service=WFS&version=1.1.0&request=GetCapabilities"},S.getWfsUrl=function(){return l["default"].getCurrentProject().getMetadata().wms_url||this.config.wmsUrl},S.getQueryUrl=function(){var e=f(this,"getQueryUrl");return this.getServerType()===v.ServerTypes.QGIS&&this.isExternalWMS()&&this.isLayerProjectionASMapProjection()&&(e=this.getInfoFormats()?this.getSource().url:e+"SOURCE="+this.config.source.type),e},S.getIconUrlFromLegend=function(){return this.getLegendUrl({layertitle:!1})},S.getLegendUrl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.legendUrl=w.get({layer:this,params:o({},e,this.customParams),options:t}),this.legendUrl},S.setMapParamstoLegendUrl=function(e){var t=e.bbox,r=e.crs;this.customParams=o({},this.customParams,{bbox:t,crs:r})},S.getWfsCapabilities=function(){return this.config.wfscapabilities||1===this.config.capabilities},S.getMapLayer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],r=c["default"].isIframe()&&!this.isExternalWMS();e.iframe_internal=r;var n=void 0,i=this.isExternalWMS()?"GET":this.getOwsMethod();return this.isCached()?(e.extent=this.config.bbox?[this.config.bbox.minx,this.config.bbox.miny,this.config.bbox.maxx,this.config.bbox.maxy]:null,n=new b(e,i)):this.isExternalWMS()&&this.config.source&&this.config.source.type===v.SourceTypes.ARCGISMAPSERVER?(e=o({},e,this.config.source),n=new _(e,t)):(e.url=e.url||this.getWmsUrl(),n=this.isExternalWMS()&&this.config.source&&this.config.source.type===v.SourceTypes.WMST?new y(e,t,i):new m(e,t,i)),n},a.WMSServerTypes=[v.ServerTypes.QGIS,v.ServerTypes.Mapserver,v.ServerTypes.Geoserver,v.ServerTypes.OGC],t.exports=a},{"core/layers/geolayermixin":32,"core/layers/layer":34,"core/layers/legend/legendservice":39,"core/layers/map/arcgismapserverlayer":41,"core/layers/map/wmslayer":45,"core/layers/map/wmstlayer":46,"core/layers/map/xyzlayer":47,"core/layers/vectorlayer":57,"core/utils/utils":68,"services/application":351,"store/projects":379}],34:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.config=e,e.id=e.id||"Layer",e.title=e.title||e.name,e.download=!!e.download,e.geolayer=!1,e.baselayer=!!e.baselayer,e.fields=e.fields||{},e.urls=s({query:e.infourl&&""!==e.infourl?e.infourl:e.wmsUrl},e.urls||{});var r=t.project,n=void 0===r?h["default"].getCurrentProject():r;if(this.config.search_endpoint=n.getSearchEndPoint(),this._relations=this._createRelations(n.getRelations()),!this.isBaseLayer()){var i=n.getType()+"/"+n.getId()+"/"+e.id+"/",o=n.getVectorUrl(),l=n.getRasterUrl();this.config.urls.filtertoken=o+"filtertoken/"+i,this.config.urls.data=o+"data/"+i,this.config.urls.shp=o+"shp/"+i,this.config.urls.csv=o+"csv/"+i,this.config.urls.xls=o+"xls/"+i,this.config.urls.gpx=o+"gpx/"+i,this.config.urls.gpkg=o+"gpkg/"+i,this.config.urls.geotiff=l+"geotiff/"+i,this.config.urls.editing=o+"editing/"+i,this.config.urls.commit=o+"commit/"+i,this.config.urls.config=o+"config/"+i,this.config.urls.unlock=o+"unlock/"+i,this.config.urls.widget={unique:o+"widget/unique/data/"+i},this.config.urls.featurecount=n.getUrl("featurecount"),this.config.searchParams={I:0,J:0}}var u=e.styles&&e.styles.find(function(e){return e.current}).name;this.state={id:e.id,title:e.title,selected:e.selected||!1,disabled:e.disabled||!1,metadata:e.metadata,metadata_querable:!this.isBaseLayer()&&this.isQueryable({onMap:!1}),openattributetable:!this.isBaseLayer()&&this.canShowTable(),removable:e.removable||!1,downloadable:this.isDownloadable(),source:e.source,styles:e.styles,defaultstyle:u,inediting:!1,infoformat:this.getInfoFormat(),infoformats:this.config.infoformats||[],projectLayer:!0,geolayer:!1,selection:{active:!1},filter:{active:!1},attributetable:{pageLength:null},visible:e.visible||!1,tochighlightable:!1,featurecount:e.featurecount,stylesfeaturecount:e.featurecount&&u&&a({},u,e.featurecount)},this.selectionFids=new Set,this._layersstore=e.layersstore||null;var c=this.config.servertype,d=this.config.source?this.config.source.type:null;c&&d&&(this.providers={query:M.build("query",c,d,{layer:this}),filter:M.build("filter",c,d,{layer:this}),filtertoken:M.build("filtertoken",c,d,{layer:this}),search:M.build("search",c,d,{layer:this}),data:M.build("data",c,d,{layer:this})}),this.proxyData={wms:null},w(this)}var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l=e("store/application-state"),u=n(l),c=e("app/constant"),d=e("services/data"),f=n(d),p=e("store/projects"),h=n(p),v=e("services/application"),g=n(v),m=e("core/i18n/i18n.service"),y=m.t,_=e("core/utils/utils"),b=_.inherit,w=_.base,x=_.XHR,S=e("core/g3wobject"),L=e("core/utils/geo"),C=L.geometryFields,k=L.parseAttributes,E=e("core/relations/relations"),M=e("core/layers/providers/providersfactory");b(o,S);var T=o.prototype;T.getProxyData=function(e){return e?this.proxyData[e]:this.proxyData},T.setProxyData=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.proxyData[e]=t},T.clearProxyData=function(e){this.proxyData[e]=null},T.getDataProxyFromServer=i(regeneratorRuntime.mark(function I(){var e,t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"wms",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,f["default"].getData("proxy:"+n,{inputs:i,outputs:!1});case 3:return e=a.sent,t=e.response,r=e.data,this.setProxyData(n,JSON.parse(r)),a.abrupt("return",t);case 10:return a.prev=10,a.t0=a["catch"](0),a.abrupt("return");case 13:case"end":return a.stop()}},I,this,[[0,10]])})),T.changeProxyDataAndReloadFromServer=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"wms",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(r).forEach(function(n){Object.keys(r[n]).forEach(function(i){e.proxyData[t][n][i]=r[n][i]})}),this.getDataProxyFromServer(t,this.proxyData[t])},T.isInEditing=function(){return this.state.inediting},T.setInEditing=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state.inediting=e},T.getSearchParams=function(){return this.config.searchParams},T.getSearchEndPoint=function(){return this.getType()!==o.LayerTypes.TABLE?this.config.search_endpoint:"api"},T._createRelations=function(e){var t=this.getId();return new E({relations:e.filter(function(e){return-1!==[e.referencedLayer,e.referencingLayer].indexOf(t)})})},T.getRelations=function(){return this._relations},T.getRelationById=function(e){return this._relations.getArray().find(function(t){return t.getId()===e})},T.getRelationAttributes=function(e){var t=this._relations.find(function(t){return t.name===e});return t?t.fields:[]},T.getRelationsAttributes=function(){var e={};return this.state.relations.forEach(function(t){return e[t.name]=t.fields}),e},T.isChild=function(){return!!this.getRelations()&&this._relations.isChild(this.getId())},T.isFather=function(){return!!this.getRelations()&&this._relations.isFather(this.getId())},T.getChildren=function(){return this.isFather()?this._relations.getChildren(this.getId()):[]},T.getFathers=function(){return this.isChild()?this._relations.getFathers(this.getId()):[]},T.hasChildren=function(){return!!this.hasRelations()&&this._relations.hasChildren(this.getId())},T.hasFathers=function(){return!!this.hasRelations()&&this._relations.hasFathers(this.getId())},T.hasRelations=function(){return!!this._relations},T.setAttributeTablePageLength=function(e){this.state.attributetable.pageLength=e},T.getAttributeTablePageLength=function(){return this.state.attributetable.pageLength},T.setFilter=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state.filter.active=e},T.getFilterActive=function(){return this.state.filter.active},T.toggleFilterToken=i(regeneratorRuntime.mark(function P(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.filter.active=!this.state.filter.active,e.next=3,this.activeFilterToken(this.state.filter.active);case 3:return e.abrupt("return",this.state.filter.active);case 4:case"end":return e.stop()}},P,this)})),T.activeFilterToken=function(){var e=i(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e;case 2:if(!t.sent){t.next=6;break}this.createFilterToken(),t.next=7;break;case 6:this.deleteFilterToken();case 7:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),T.deleteFilterToken=i(regeneratorRuntime.mark(function F(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.providers.filtertoken){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.providers.filtertoken.deleteFilterToken();case 5:g["default"].setFilterToken(null),this.emit("filtertokenchange",{layerId:this.getId()}),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0);case 12:case"end":return e.stop()}},F,this,[[0,9]])})),T.createFilterToken=i(regeneratorRuntime.mark(function O(){var e,t;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(e=null,r.prev=1,this.providers.filtertoken&&!(!this.selectionFids.size>0)){r.next=4;break}return r.abrupt("return");case 4:if(!this.selectionFids.has(o.SELECTION_STATE.ALL)){r.next=9;break}return r.next=7,this.providers.filtertoken.deleteFilterToken();case 7:r.next=14;break;case 9:return t={},this.selectionFids.has(o.SELECTION_STATE.EXCLUDE)?t.fidsout=Array.from(this.selectionFids).filter(function(e){return e!==o.SELECTION_STATE.EXCLUDE}).join(","):t.fidsin=Array.from(this.selectionFids).join(","),r.next=13,this.providers.filtertoken.getFilterToken(t);case 13:e=r.sent;case 14:g["default"].setFilterToken(e),this.emit("filtertokenchange",{layerId:this.getId()}),r.next=21;break;case 18:r.prev=18,r.t0=r["catch"](1);case 21:case"end":return r.stop()}},O,this,[[1,18]])})),T.setSelectionFidsAll=function(){this.selectionFids.clear(),this.selectionFids.add(o.SELECTION_STATE.ALL),this.isGeoLayer()&&this.showAllOlSelectionFeatures(),this.setSelection(!0),this.state.filter.active&&this.createFilterToken()},T.getSelectionFids=function(){return this.selectionFids},T.invertSelectionFids=function(){this.selectionFids.has(o.SELECTION_STATE.EXCLUDE)?this.selectionFids["delete"](o.SELECTION_STATE.EXCLUDE):this.selectionFids.has(o.SELECTION_STATE.ALL)?this.selectionFids["delete"](o.SELECTION_STATE.ALL):this.selectionFids.size>0&&this.selectionFids.add(o.SELECTION_STATE.EXCLUDE),this.isGeoLayer()&&this.setInversionOlSelectionFeatures(),this.state.filter.active&&this.createFilterToken(),this.setSelection(this.selectionFids.size>0)},T.hasSelectionFid=function(e){return!!this.selectionFids.has(o.SELECTION_STATE.ALL)||(this.selectionFids.has(o.SELECTION_STATE.EXCLUDE)?!this.selectionFids.has(e):this.selectionFids.has(e))},T.includeSelectionFid=function(){var e=i(regeneratorRuntime.mark(function t(e){var r,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.selectionFids.has(o.SELECTION_STATE.EXCLUDE)&&this.selectionFids.has(e),r&&this.selectionFids["delete"](e),r&&1===this.selectionFids.size&&this.setSelectionFidsAll(),r||this.selectionFids.add(e),r||this.isSelectionActive()||this.setSelection(!0),this.isGeoLayer()&&this.setOlSelectionFeatureByFid(e,"add"),!n||!this.state.filter.active){
t.next=9;break}return t.next=9,this.createFilterToken();case 9:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),T.includeSelectionFids=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach(function(t){return e.includeSelectionFid(t)})},T.excludeSelectionFid=function(){var e=i(regeneratorRuntime.mark(function t(e){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((this.selectionFids.has(o.SELECTION_STATE.ALL)||0===this.selectionFids.size)&&(this.selectionFids.clear(),this.selectionFids.add(o.SELECTION_STATE.EXCLUDE)),this.selectionFids[this.selectionFids.has(o.SELECTION_STATE.EXCLUDE)?"add":"delete"](e),1===this.selectionFids.size&&this.selectionFids.has(o.SELECTION_STATE.EXCLUDE)&&this.setselectionFidsAll(),r=this.isGeoLayer()&&this.setOlSelectionFeatureByFid(e,"remove"),t.t0=this.state.filter.active,!t.t0){t.next=8;break}return t.next=8,this.createFilterToken();case 8:(0===this.selectionFids.size||r)&&(this.selectionFids.clear(),this.setSelection(!1));case 9:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),T.excludeSelectionFids=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach(function(t){return e.excludeSelectionFid(t)})},T.clearSelectionFids=function(){this.selectionFids.clear(),this.isGeoLayer()&&this.setOlSelectionFeatures(),this.setSelection(!1)},T.getWMSLayerName=function(){return this.isWmsUseLayerIds()?this.getId():this.getName()},T.isWmsUseLayerIds=function(){return this.config.wms_use_layer_ids},T.getFilterToken=function(){return g["default"].getFilterToken()},T.getDownloadFilefromDownloadDataType=function(e,t){var r=t.data,n=void 0===r?{}:r,i=t.options;switch(n.filtertoken=this.getFilterToken(),e){case"shapefile":return this.getShp({data:n,options:i});case"xls":return this.getXls({data:n,options:i});case"csv":return this.getCsv({data:n,options:i});case"gpx":return this.getGpx({data:n,options:i});case"gpkg":return this.getGpkg({data:n,options:i});case"geotiff":return this.getGeoTIFF({data:n,options:i})}},T.getGeoTIFF=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data,r=void 0===t?{}:t;return r.filtertoken=this.getFilterToken(),x.fileDownload({url:this.getUrl("geotiff"),data:r,httpMethod:"POST"})},T.getXls=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data,r=void 0===t?{}:t;return r.filtertoken=this.getFilterToken(),x.fileDownload({url:this.getUrl("xls"),data:r,httpMethod:"POST"})},T.getShp=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data,r=void 0===t?{}:t;return r.filtertoken=this.getFilterToken(),x.fileDownload({url:this.getUrl("shp"),data:r,httpMethod:"POST"})},T.getGpx=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data,r=void 0===t?{}:t;return r.filtertoken=this.getFilterToken(),x.fileDownload({url:this.getUrl("gpx"),data:r,httpMethod:"POST"})},T.getGpkg=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data,r=void 0===t?{}:t;return r.filtertoken=this.getFilterToken(),x.fileDownload({url:this.getUrl("gpkg"),data:r,httpMethod:"POST"})},T.getCsv=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data,r=void 0===t?{}:t;return r.filtertoken=this.getFilterToken(),x.fileDownload({url:this.getUrl("csv"),data:r,httpMethod:"POST"})},T.getSourceType=function(){return this.config.source?this.config.source.type:null},T.isGeoLayer=function(){return this.state.geolayer},T.getDataTable=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.page,n=void 0===r?null:r,i=t.page_size,a=void 0===i?null:i,o=t.ordering,l=void 0===o?null:o,c=t.search,d=void 0===c?null:c,f=t.field,p=t.suggest,h=void 0===p?null:p,v=t.formatter,g=void 0===v?0:v,m=t.in_bbox,y=t.custom_params,_=void 0===y?{}:y,b=$.Deferred(),w=void 0,x=s({},_,{field:f,page:n,page_size:a,ordering:l,search:d,formatter:g,suggest:h,in_bbox:m,filtertoken:u["default"].tokens.filtertoken});return this.getProvider("filter")||this.getProvider("data")?(w=this.getProvider("data"),w.getFeatures({editing:!1},x).done(function(t){var r=t.data.features&&t.data.features||[];b.resolve({headers:k(e.getAttributes(),r.length?r[0].properties:[]),features:r,title:e.getTitle(),count:t.count})}).fail(function(e){return b.reject(e)})):b.reject(),b.promise()},T.getFeatureByFids=i(regeneratorRuntime.mark(function R(){var e,t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.fids,a=void 0===i?[]:i,o=n.formatter,s=void 0===o?0:o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e=this.getUrl("data"),t=void 0,n.prev=2,n.next=5,x.get({url:e,params:{fids:a.toString(),formatter:s}});case 5:r=n.sent,t=r&&r.result&&r.vector&&r.vector.data&&r.vector.data.features,n.next=11;break;case 9:n.prev=9,n.t0=n["catch"](2);case 11:return n.abrupt("return",t);case 12:case"end":return n.stop()}},R,this,[[2,9]])})),T.searchFeatures=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.search_endpoint,a=void 0===n?this.config.search_endpoint:n;return new Promise(function(){var n=i(regeneratorRuntime.mark(function o(n,i){var s,l,u,c,d,f,p;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:o.t0=a,o.next="ows"===o.t0?3:"api"===o.t0?5:18;break;case 3:return e.search(t,r).then(function(e){n({data:e})}).fail(function(e){return i(e)}),o.abrupt("break",18);case 5:return s=t.raw,l=void 0!==s&&s,u=t.filter,c=t.suggest,d=t.unique,f=t.queryUrl,p=t.ordering,o.prev=6,o.t1=n,o.next=10,e.getFilterData({queryUrl:f,raw:l,field:u,ordering:p,suggest:c,unique:d});case 10:o.t2=o.sent,(0,o.t1)(o.t2),o.next=17;break;case 14:o.prev=14,o.t3=o["catch"](6),i(o.t3);case 17:return o.abrupt("break",18);case 18:case"end":return o.stop()}},o,e,[[6,14]])}));return function(e,t){return n.apply(this,arguments)}}())},T.getFilterData=i(regeneratorRuntime.mark(function A(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.field,r=e.raw,n=void 0!==r&&r,i=e.suggest,a=e.unique,o=e.formatter,s=void 0===o?1:o,l=e.queryUrl,u=e.ordering;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getProvider("data").getFilterData({queryUrl:l,field:t,raw:n,ordering:u,suggest:i,formatter:s,unique:a});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},A,this)})),T.search=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.feature_count=e.feature_count||10,e=s({},e,this.config.searchParams,t);var r=$.Deferred(),n=this.getProvider("search");return n?n.query(e).done(function(e){return r.resolve(e)}).fail(function(e){return r.reject(e)}):r.reject(y("sdk.search.layer_not_searchable")),r.promise()},T.query=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=$.Deferred(),r=this.getProvider(e.filter?"filter":"query");return r?r.query(e).done(function(e){return t.resolve(e)}).fail(function(e){return t.reject(e)}):t.reject(y("sdk.search.layer_not_querable")),t.promise()},T.get=function(e){return this.config[e]?this.config[e]:this.state[e]},T.getFields=function(){return this.config.fields},T.getFieldByName=function(e){return this.getFields().find(function(t){return t.name===e})},T.getEditingFields=function(){return this.config.editing.fields},T.getTableFields=function(){return(this.config.fields||[]).filter(function(e){return e.show})},T.getTableHeaders=function(){return this.getTableFields().filter(function(e){return-1===C.indexOf(e.name)})},T.getProject=function(){return this.config.project},T.getConfig=function(){return this.config},T.getLayerEditingFormStructure=function(e){return this.config.editor_form_structure},T.getEditorFormStructure=function(){return this.getLayerEditingFormStructure()},T.getFieldsOutOfFormStructure=function(){return this.config.editor_form_structure?this.config.editor_form_structure.filter(function(e){return e.field_name}):[]},T.hasFormStructure=function(){return!!this.config.editor_form_structure},T.getCustomStyle=function(){return this.config.customstyle},T.getState=function(){return this.state},T.getSource=function(){return this.state.source},T.isDownloadable=function(){return this.isShpDownlodable()||this.isXlsDownlodable()||this.isGpxDownlodable()||this.isGpkgDownlodable()||this.isCsvDownlodable()},T.getDownloadableFormats=function(){var e=this;return Object.keys(c.DOWNLOAD_FORMATS).filter(function(t){return e.config[t]}).map(function(e){return c.DOWNLOAD_FORMATS[e].format})},T.getDownloadUrl=function(e){var t=Object.values(c.DOWNLOAD_FORMATS).find(function(t){return t.format===e});return t&&t.url},T.isGeoTIFFDownlodable=function(){return!this.isBaseLayer()&&this.config.download&&"gdal"===this.config.source.type},T.isShpDownlodable=function(){return!this.isBaseLayer()&&this.config.download&&"gdal"!==this.config.source.type},T.isXlsDownlodable=function(){return!this.isBaseLayer()&&this.config.download_xls},T.isGpxDownlodable=function(){return!this.isBaseLayer()&&this.config.download_gpx},T.isGpkgDownlodable=function(){return!this.isBaseLayer()&&this.config.download_gpkg},T.isCsvDownlodable=function(){return!this.isBaseLayer()&&this.config.download_csv},T.getEditingLayer=function(){return this._editingLayer},T.setEditingLayer=function(e){this._editingLayer=e},T.isHidden=function(){return this.state.hidden},T.setHidden=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.state.hidden=e},T.isModified=function(){return this.state.modified},T.getId=function(){return this.config.id},T.getMetadata=function(){return this.state.metadata},T.getTitle=function(){return this.config.title},T.getName=function(){return this.config.name},T.getOrigName=function(){return this.config.origname},T.getServerType=function(){return this.config.servertype&&""!==this.config.servertype?this.config.servertype:ServerTypes.QGIS},T.getType=function(){return this.type},T.isType=function(e){return this.getType()===e},T.setType=function(e){this.type=e},T.isSelected=function(){return this.state.selected},T.setSelected=function(e){this.state.selected=e},T.setSelection=i(regeneratorRuntime.mark(function j(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.state.selection.active=e,e){t.next=8;break}if(t.t0=this.state.filter.active,!t.t0){t.next=6;break}return t.next=6,this.deleteFilterToken();case 6:this.state.filter.active=e,this.emit("unselectionall",this.getId());case 8:case"end":return t.stop()}},j,this)})),T.isSelectionActive=function(){return this.state.selection.active},T.getSelection=function(){return this.state.selection},T.getFilter=function(){return this.state.filter},T.setDisabled=function(e){this.state.disabled=e},T.isDisabled=function(){return this.state.disabled},T.isVisible=function(){return this.state.visible},T.setVisible=function(e){this.state.visible=e},T.isQueryable=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{onMap:!1},t=e.onMap,r=!1,n=!!(this.config.capabilities&&this.config.capabilities&o.CAPABILITIES.QUERYABLE);return t?(n&&(r=this.isVisible()&&!this.isDisabled(),void 0!==this.config.infowhennotvisible&&this.config.infowhennotvisible===!0&&(r=!0)),r):n},T.getOws=function(){return this.config.ows},T.getTocHighlightable=function(){return this.state.tochighlightable},T.setTocHighlightable=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state.tochighlightable=e},T.isFilterable=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=!!(this.config.capabilities&&this.config.capabilities&o.CAPABILITIES.FILTERABLE);if(r&&t){var n=Object.keys(t).reduce(function(r,n){var i=e.get(n),a=t[n];return r&&Array.isArray(i)?i.indexOf(a)!==-1:a===i},!0);r=r&&n}return r},T.isQtimeseries=function(){return this.config.qtimeseries},T.isEditable=function(){return!!(this.config.capabilities&&this.config.capabilities&o.CAPABILITIES.EDITABLE)},T.isBaseLayer=function(){return this.config.baselayer},T.getUrl=function(e){return this.config.urls[e]},T.setUrl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=e.url;this.config.urls[t]=r},T.getUrls=function(){return this.config.urls},T.setEditingUrl=function(e){this.config.urls.editing=e||this.config.urls.editing},T.getQueryUrl=function(){return this.config.urls.query},T.setQueryUrl=function(e){this.config.urls.query=e},T.getQueryLayerName=function(){return this.config.infolayer&&""!==this.config.infolayer?this.config.infolayer:this.getName()},T.getQueryLayerOrigName=function(){return this.state.infolayer&&""!==this.config.infolayer?this.config.infolayer:this.config.origname},T.getInfoFormat=function(e){return this.config.qtimeseries===!0||"gdal"===this.getSourceType()?"application/json":this.config.infoformat&&""!==this.config.infoformat&&"wfs"!==e?this.config.infoformat:"application/vnd.ogc.gml"},T.getInfoFormats=function(){return this.state.infoformats},T.getInfoUrl=function(){return this.config.infourl},T.setInfoFormat=function(e){this.config.infoformat=e},T.getAttributes=function(){return this.config.fields},T.changeAttribute=function(e,t,r){var n=!0,i=!1,a=void 0;try{for(var o,s=this.config.fields[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=o.value;if(l.name===e){l.type=t,l.options=r;break}}}catch(u){i=!0,a=u}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}},T.getAttributeLabel=function(e){var t=this.getAttributes().find(function(t){return t.name===e});return t&&t.label},T.getProvider=function(e){return this.providers[e]},T.getProviders=function(){return this.providers},T.getLayersStore=function(){return this._layersstore},T.setLayersStore=function(e){this._layersstore=e},T.canShowTable=function(){return!this.config.not_show_attributes_table&&(this.getServerType()===o.ServerTypes.QGIS&&[o.SourceTypes.POSTGIS,o.SourceTypes.ORACLE,o.SourceTypes.WFS,o.SourceTypes.OGR,o.SourceTypes.MSSQL,o.SourceTypes.SPATIALITE].indexOf(this.config.source.type)>-1&&this.isQueryable()?this.getTableFields().length>0:this.getServerType()===o.ServerTypes.G3WSUITE&&"geojson"===this.get("source").type||!(this.getServerType()===o.ServerTypes.G3WSUITE||!this.isFilterable()))},T.changeFieldType=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,r=e.type,n=e.options,i=void 0===n?{}:n,a=e.reset,o=void 0!==a&&a,s=this.getFields().find(function(e){return e.name===t});return s&&o?(s.type=s._type,delete s._type,delete s[r+"options"],s.type):s&&!o?(s._type=s.type,s.type=r,s[r+"options"]=i,s._type):void 0},T.changeConfigFieldType=function(e){var t=e.name,r=e.type,n=e.options,i=void 0===n?{}:n,a=e.reset,o=void 0!==a&&a;return this.changeFieldType({name:t,type:r,options:i,reset:o})},T.resetConfigField=function(e){var t=e.name;this.changeConfigFieldType({name:t,reset:!0})},T.clear=function(){},T.isVector=function(){return this.getType()===o.LayerTypes.VECTOR},T.isTable=function(){return this.getType()===o.LayerTypes.TABLE},T.getFeatureCount=function(){return this.state.featurecount},T.getStyleFeatureCount=function(){var e=i(regeneratorRuntime.mark(function t(e){var r,n,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("undefined"!=typeof this.state.stylesfeaturecount[e]){t.next=13;break}return t.prev=1,t.next=4,x.post({url:""+this.config.urls.featurecount+this.getId()+"/",data:JSON.stringify({style:e}),contentType:"application/json"});case 4:r=t.sent,n=r.result,i=r.data,this.state.stylesfeaturecount[e]=!0===n?i:{},t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](1),this.state.stylesfeaturecount[e]={};case 13:return t.abrupt("return",this.state.stylesfeaturecount[e]);case 14:case"end":return t.stop()}},t,this,[[1,10]])}));return function(t){return e.apply(this,arguments)}}(),o.LayerTypes={TABLE:"table",IMAGE:"image",VECTOR:"vector"},o.ServerTypes={OGC:"OGC",QGIS:"QGIS",Mapserver:"Mapserver",Geoserver:"Geoserver",ARCGISMAPSERVER:"ARCGISMAPSERVER",OSM:"OSM",BING:"Bing",LOCAL:"Local",TMS:"TMS",WMS:"WMS",WMTS:"WMTS",G3WSUITE:"G3WSUITE"},o.SourceTypes={VIRTUAL:"virtual",POSTGIS:"postgres",SPATIALITE:"spatialite",ORACLE:"oracle",MSSQL:"mssql",CSV:"delimitedtext",OGR:"ogr",GDAL:"gdal",WMS:"wms",WMST:"wmst",WFS:"wfs",WCS:"wcs",MDAL:"mdal","VECTOR-TILE":"vector-tile",VECTORTILE:"vectortile",ARCGISMAPSERVER:"arcgismapserver",GEOJSON:"geojson"},o.CAPABILITIES={QUERYABLE:1,FILTERABLE:2,EDITABLE:4},o.EDITOPS={INSERT:1,UPDATE:2,DELETE:4},o.SELECTION_STATE={ALL:"__ALL__",EXCLUDE:"__EXCLUDE__"},t.exports=o},{"app/constant":4,"core/g3wobject":12,"core/i18n/i18n.service":13,"core/layers/providers/providersfactory":51,"core/relations/relations":63,"core/utils/geo":64,"core/utils/utils":68,"services/application":351,"services/data":358,"store/application-state":373,"store/projects":379}],35:[function(e,t,r){function n(){this.build=function(e,t){var r=this.get(e);return r?new r(e,t):null},this.get=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=void 0,r=e.servertype;switch(r){case i.ServerTypes.QGIS:e.source&&(e.geometrytype?[i.SourceTypes.VIRTUAL,i.SourceTypes.POSTGIS,i.SourceTypes.MSSQL,i.SourceTypes.SPATIALITE,i.SourceTypes.WFS,i.SourceTypes.CSV,i.SourceTypes.ORACLE,i.SourceTypes.OGR,i.SourceTypes.MDAL].find(function(t){return t===e.source.type})&&(t=e.geometrytype&&"NoGeometry"===e.geometrytype?a:s):[i.SourceTypes.WMST,i.SourceTypes.WCS,i.SourceTypes.WMS,i.SourceTypes.GDAL,i.SourceTypes.VECTORTILE,i.SourceTypes["VECTOR-TILE"],i.SourceTypes.MDAL,i.SourceTypes.ARCGISMAPSERVER].find(function(t){return t===e.source.type})&&(t=s));break;case i.ServerTypes.OGC:if(e.source){var n=e.source.type;switch(n){case i.SourceTypes.WMS:t=s;break;case i.SourceTypes.WFS:t=o}}break;case i.ServerTypes.LOCAL:t=o;break;case i.ServerTypes.OSM:case i.ServerTypes.BING:case i.ServerTypes.TMS:case i.ServerTypes.WMS:case i.ServerTypes.WMTS:case i.ServerTypes.ARCGISMAPSERVER:t=l[r];break;case i.ServerTypes.G3WSUITE:if(t=o,e.source)switch(e.source.type){case"geojson":t=u}}return t}}var i=e("core/layers/layer"),a=e("core/layers/tablelayer"),o=e("core/layers/vectorlayer"),s=e("core/layers/imagelayer"),l=e("core/layers/baselayers/baselayers"),u=e("core/layers/geojson");t.exports=new n},{"core/layers/baselayers/baselayers":20,"core/layers/geojson":31,"core/layers/imagelayer":33,"core/layers/layer":34,"core/layers/tablelayer":56,"core/layers/vectorlayer":57}],36:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config={id:e.id||Date.now(),projection:e.projection,extent:e.extent,initextent:e.initextent,wmsUrl:e.wmsUrl,catalog:!_.isBoolean(e.catalog)||e.catalog},this.state={layerstree:[],relations:null},this._isQueryable=!_.isBoolean(e.queryable)||e.queryable,this._layers=this.config.layers||{},this.setters={setLayerSelection:function(e){var t=e.layerId;e.selection,this.getLayerById(t)},setLayerSelected:function(e,t){this.getLayers().forEach(function(r){return r.state.selected=e===r.getId()&&t})},addLayers:function(e){var t=this;e.forEach(function(e){return t.addLayer(e)})},addLayer:function(e){this._addLayer(e)},removeLayer:function(e){this._removeLayer(e)}},s(this)}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=e("core/utils/utils"),s=o.base,l=o.inherit,u=o.uniqueId,c=e("core/g3wobject");l(n,c);var d=n.prototype;d.isQueryable=function(){return this._isQueryable},d.setQueryable=function(e){this._isQueryable=!!e},d.showOnCatalog=function(){return this.config.catalog},d.setOptions=function(e){this.config=e},d.getId=function(){return this.config.id},d._addLayer=function(e){this._layers[e.getId()]=e},d._removeLayer=function(e){var t=e.getId();delete this._layers[t]},d.removeLayers=function(){var e=this;Object.entries(this._layers).forEach(function(t){var r=a(t,2),n=(r[0],r[1]);e.removeLayer(n)})},d.getLayersDict=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return this._layers;var r=e.PRINTABLE,n=e.QUERYABLE,i=e.FILTERABLE,a=e.EDITABLE,o=e.VISIBLE,s=e.SELECTED,l=e.CACHED,u=e.SELECTED_OR_ALL,c=e.SERVERTYPE,d=e.BASELAYER,f=e.GEOLAYER,p=e.VECTORLAYER,h=e.HIDDEN,v=e.DISABLED,g=e.IDS;if(_.isUndefined(n)&&_.isUndefined(i)&&_.isUndefined(a)&&_.isUndefined(o)&&_.isUndefined(c)&&_.isUndefined(l)&&_.isUndefined(u)&&_.isUndefined(c)&&_.isUndefined(f)&&_.isUndefined(h)&&_.isUndefined(v)&&_.isUndefined(d)&&_.isUndefined(p)&&_.isUndefined(r)&&_.isUndefined(g))return this._layers;var m=[];for(var y in this._layers)m.push(this._layers[y]);if(g){var b=Array.isArray(g)?g:[g];m=m.filter(function(e){return b.indexOf(e.getId())!==-1})}if(u){var w=m;m=m.filter(function(e){return e.isSelected()}),m=m.length?m:w}return"boolean"!=typeof s||u||(m=m.filter(function(e){return s===e.isSelected()})),"boolean"==typeof n&&(m=m.filter(function(e){return n===e.isQueryable()})),"boolean"==typeof i&&(m=m.filter(function(e){return i===e.isFilterable(t.filtrable||null)})),"boolean"==typeof a&&(m=m.filter(function(e){return a===e.isEditable()})),"boolean"==typeof o&&(m=m.filter(function(e){return o===e.isVisible()})),"boolean"==typeof l&&(m=m.filter(function(e){return l===e.isCached()})),"boolean"==typeof d&&(m=m.filter(function(e){return d===e.isBaseLayer()})),"boolean"==typeof f&&(m=m.filter(function(e){return f===e.state.geolayer})),"boolean"==typeof p&&(m=m.filter(function(e){return p===e.isType("vector")})),"boolean"==typeof h&&(m=m.filter(function(e){return h==e.isHidden()})),"boolean"==typeof v&&(m=m.filter(function(e){return v===e.isDisabled()})),"string"==typeof c&&""!==c&&(m=m.filter(function(e){return c===e.getServerType()})),r&&(m=m.filter(function(e){return e.state.geolayer&&e.isPrintable({scale:r.scale})})),m},d.getLayers=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.values(this.getLayersDict(e,t))},d.getBaseLayers=function(){return this.getLayersDict({BASELAYER:!0})},d.getLayerById=function(e){return this.getLayersDict()[e]},d.getLayerByName=function(e){return this._layers.find(function(t){return t.getName()===e})},d.getLayerAttributes=function(e){return this.getLayerById(e).getAttributes()},d.getLayerAttributeLabel=function(e,t){return this.getLayerById(e).getAttributeLabel(t)},d.getGeoLayers=function(){return this.getLayers({GEOLAYER:!0})},d._getAllSiblingsChildrenLayersId=function(e){var t=[],r=function n(e){e.nodes.forEach(function(e){e.id?t.push(e.id):n(e)})};return r(e),t},d._getAllParentLayersId=function(e,t){var r=[],n=function(e){e.nodes.forEach(function(e){e.id&&r.push(e.id)})};return n({nodes:e.nodes.filter(function(e){return e!==t})}),r},d.selectLayer=function(e,t){this.setLayerSelected(e,t)},d.getProjection=function(){return this.config.projection},d.getExtent=function(){return this.config.extent},d.getInitExtent=function(){return this.config.initextent},d.getWmsUrl=function(){return this.config.wmsUrl},d.removeLayersTree=function(){this.state.layerstree.splice(0,this.state.layerstree.length)},d.getLayersTree=function(){return this.state.layerstree},d.setLayersTree=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.getInitExtent(),i=a(n,4),o=i[0],s=i[1],l=i[2],u=i[3],c={title:t||this.config.id,root:!0,parentGroup:null,expanded:r,disabled:!1,checked:!0,bbox:{minx:o,miny:s,maxx:l,maxy:u},nodes:e};e.length&&(this._traverseLayersTree(e,c),this.state.layerstree.splice(0,0,c))},d.createLayersTree=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{layerstree:null,expanded:!1,full:!1},r=[];if(t.layerstree&&!0===t.full)return this.state.layerstree;if(t.layerstree&&!0!==t.full){var n=this.getLayers({BASELAYER:!1}).map(function(e){return e.getId()});this._traverseLightLayersTree(t.layerstree,r,n)}t.layerstree||(r=this.getGeoLayers().map(function(e){return{id:e.getId(),name:e.getName(),title:e.getTitle(),visible:e.isVisible()||!1}})),this.setLayersTree(r,e,t.expanded)},d._traverseLightLayersTree=function(e,t,r){var n=this;e.forEach(function(e){var a=null;null!==e.id&&"undefined"!=typeof e.id&&r.find(function(t){return t===e.id})&&(a=i({},a,e)),null!==e.nodes&&"undefined"!=typeof e.nodes&&(a=i({},a,{title:e.name,groupId:u(),root:!1,nodes:[],checked:e.checked,mutually_exclusive:e["mutually-exclusive"]}),n._traverseLightLayersTree(e.nodes,a.nodes,r)),null!==a&&(a.expanded=e.expanded,t.push(a))})},d._traverseLayersTree=function(e,t){var r=this;e.forEach(function(n,i){"undefined"!=typeof n.id&&(e[i]=r.getLayerById(n.id).getState()),"undefined"!=typeof n.id&&(e[i]=r.getLayerById(n.id).getState(),"undefined"!=typeof e[i].bbox&&r._setLayersTreeGroupBBox(t,{bbox:e[i].bbox,epsg:e[i].epsg})),Array.isArray(n.nodes)&&(n.nodes.forEach(function(e){return e.parentGroup=t}),r._traverseLayersTree(n.nodes,n)),e[i].parentGroup=t})},d._setLayersTreeGroupBBox=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.bbox,n=t.epsg,i=this.getProjection().getCode();if(n!==i){var o=ol.proj.transformExtent([r.minx,r.miny,r.maxx,r.maxy],n,i),s=a(o,4),l=s[0],u=s[1],c=s[2],d=s[3];r={minx:l,miny:u,maxx:c,maxy:d}}void 0===e.bbox?e.bbox=r:e.bbox=ol.extent.extend([e.bbox.minx,e.bbox.miny,e.bbox.maxx,e.bbox.maxy],[r.minx,r.miny,r.maxx,r.maxy]).reduce(function(e,t,r){switch(r){case 0:e.minx=t;break;case 1:e.miny=t;break;case 2:e.maxx=t;break;case 3:e.maxy=t}return e},{minxx:null,miny:null,maxx:null,maxy:null}),e.parentGroup&&!1===e.parentGroup.root&&this._setLayersTreeGroupBBox(e.parentGroup,{bbox:e.bbox,epsg:i})},t.exports=n},{"core/g3wobject":12,"core/utils/utils":68}],37:[function(e,t,r){function n(){this.stores={},this.storesArray=[],this.setters={addLayersStore:this._addLayersStore.bind(this),removeLayersStore:this._removeLayersStore.bind(this),removeLayersStores:this._removeLayersStores.bind(this)},o(this)}var i=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=e("core/utils/utils"),o=a.base,s=a.inherit,l=e("core/g3wobject");s(n,l);var u=n.prototype;u.getLayerById=function(e){var t=void 0;for(var r in this.stores){var n=this.stores[r];if(t=n.getLayerById(e))break}return t},u.getLayers=function(e){var t=[];return Object.entries(this.stores).forEach(function(r){var n=i(r,2),a=(n[0],n[1]);t=t.concat(a.getLayers(e))}),t},u.getQuerableLayersStores=function(){return this.getLayersStores().filter(function(e){return e.isQueryable()})},u.getLayersStore=function(e){return this.stores[e]},u.getLayersStores=function(){var e=this,t=[];return this.storesArray.forEach(function(r){t.push(e.stores[r])}),t},u._addLayersStore=function(e,t){var r=e.getId();this.stores[r]=e,_.isNil(t)?this.storesArray.push(r):this.storesArray.splice(t,0,r)},u._removeLayersStore=function(e){if(e){var t=e.getId();this.storesArray=this.storesArray.filter(function(e){return e!=t}),delete this.stores[t]}},u._removeLayersStores=function(){this.storesArray=[],this.stores={}},t.exports=n},{"core/g3wobject":12,"core/utils/utils":68}],38:[function(e,t,r){function n(e){var t=e.layer,r=(e.params,t.getConfig().source),n=r.url,i=r.layer,a=n.replace("/rest/","/");return a+"/WMSServer?request=GetLegendGraphic&version=1.3.0&format=image/png&LAYER="+i}t.exports=n},{}],39:[function(e,t,r){var n={wms:e("./wmslegend"),arcgismapserver:e("./arcgismapserverlegend")},i={get:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,r=e.params,i=e.options,a=void 0===i?{}:i,o=t.isArcgisMapserver()?"arcgismapserver":"wms";return n[o]({layer:t,params:r,options:a})}};t.exports=i},{"./arcgismapserverlegend":38,"./wmslegend":40}],40:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){var t=e.layer,r=e.params,n=e.options,i=void 0===n?{}:n,a=r.width,s=r.height,u=r.color,c=void 0===u?"white":u,d=r.fontsize,f=void 0===d?10:d,p=r.transparent,h=void 0===p||p,v=r.boxspace,g=r.layerspace,m=r.layertitle,y=void 0===m||m,_=r.layertitlespace,b=r.symbolspace,w=r.iconlabelspace,x=r.symbolwidth,S=r.symbolheight,L=r.itemfontfamily,C=r.layerfontfamily,k=r.layerfontbold,E=r.itemfontbold,M=r.layerfontitalic,T=r.itemfontitalic,I=r.rulelabel,P=r.crs,F=r.bbox,O=r.sld_version,R=void 0===O?"1.1.0":O,A=i.categories,j=void 0!==A&&A,N=i.all,D=void 0!==N&&N,G=i.format,V=void 0===G?"image/png":G,$=t.getWMSLayerName({type:"legend"}),U=V,q=void 0,B=void 0,z=void 0,W=t.getWmsUrl({type:"legend"});if(D&&(F=null),j&&"application/json"===U&&(x=S=16,q=encodeURIComponent(t.getCurrentStyle().name)),j&&(o["default"].getCurrentProject().getContextBaseLegend()||"image/png"===U)){var H=l(t);B=H.LEGEND_ON,z=H.LEGEND_OFF}return[""+W+(W.indexOf("?")>-1?"&":"?")+"SERVICE=WMS&VERSION=1.3.0&REQUEST=GetLegendGraphic&SLD_VERSION="+R,""+(a?"&WIDTH="+a:""),""+(s?"&HEIGHT="+s:""),"&FORMAT="+U,"&TRANSPARENT="+h,"&ITEMFONTCOLOR="+c,"&LAYERFONTCOLOR="+c,"&LAYERTITLE="+y,"&ITEMFONTSIZE="+f,""+(P?"&CRS="+P:""),""+(F?"&BBOX="+F.join(","):""),""+(v?"&BOXSPACE="+v:""),""+(g?"&LAYERSPACE="+g:""),""+(_?"&LAYERTITLESPACE="+_:""),""+(b?"&SYMBOLSPACE="+b:""),""+(w?"&ICONLABELSPACE="+w:""),""+(x?"&SYMBOLWIDTH="+x:""),""+(S?"&SYMBOLHEIGHT="+S:""),""+(C?"&LAYERFONTFAMILY="+C:""),""+(L?"&ITEMFONTFAMILY="+L:""),""+(k?"&LAYERFONTBOLD="+k:""),""+(E?"&ITEMFONTBOLD="+E:""),""+(M?"&LAYERFONTITALIC="+M:""),""+(T?"&ITEMFONTITALIC="+T:""),""+(I?"&RULELABEL="+I:""),""+(B?"&LEGEND_ON="+B:""),""+(z?"&LEGEND_OFF="+z:""),""+(q?"&STYLES="+q:""),"&LAYER="+$].join("")}var a=e("store/projects"),o=n(a),s=e("core/utils/geo"),l=s.get_LEGEND_ON_LEGEND_OFF_Params;t.exports=i},{"core/utils/geo":64,"store/projects":379}],41:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,e,t)}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("core/layers/map/wmslayer"),l=e("g3w-ol/layers/rasters");a(n,s);var u=n.prototype;u._makeOlLayer=function(){var e=this,t={url:this.config.url,id:this.config.id,projection:this.config.projection,format:this.config.format},r=new l.TiledArgisMapServer(t);return r.getSource().on("imageloadstart",function(){e.emit("loadstart")}),r.getSource().on("imageloadend",function(){e.emit("loadend")}),r.getSource().on("imageloaderror",function(){e.emit("loaderror")}),r},t.exports=n},{"core/layers/map/wmslayer":45,"core/utils/utils":68,"g3w-ol/layers/rasters":108}],42:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.provider;this.setProvider(t),o(this,e),this.getFeatures({url:e.url,mapProjection:this.mapProjection})}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("core/layers/map/vectorlayer");a(n,s),t.exports=n},{"core/layers/map/vectorlayer":44,
"core/utils/utils":68}],43:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config=e,this.id=e.id,this.iframe_internal=e.iframe_internal||!1,this.extent=e.extent,this.projection=e.projection,this.layer=null,this.layers=e.layers||[],this.allLayers=[],this.showSpinnerWhenLoading=!0,a(this)}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("core/g3wobject");o(n,s);var l=n.prototype;l.getId=function(){return this.id},l.getOLLayer=function(){},l.update=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._updateLayers(e,t)},l.checkLayerDisabled=function(e,t,r){return e.setDisabled(t,r),e.isDisabled()},l.checkLayersDisabled=function(e,t){var r=this;this.allLayers.forEach(function(n){return r.checkLayerDisabled(n,e,t)})},l.setupCustomMapParamsToLegendUrl=function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}},t.exports=n},{"core/g3wobject":12,"core/utils/utils":68}],44:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.mapService=s["default"].getComponent("map").getService(),this.geometrytype=e.geometrytype||null,this.type=e.type||null,this.crs=e.crs||null,this.id=e.id,this.name=e.name||"",this.style=e.style,this.color=e.color,this.geometryType=e.geometryType,this.mapProjection=this.mapService.getProjection().getCode(),this.projection=e.projection||this.mapProjection,this.url=e.url,this.provider=e.provider,this._features=e.features||[],this._olLayer=e.olLayer||this.getOLLayer()}var a=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=e("services/gui"),s=n(o),l=e("core/utils/utils"),u=l.inherit,c=e("core/utils/geo"),d=c.createOlLayer,f=c.createLayerStyle,p=e("core/g3wobject");u(i,p),t.exports=i;var h=i.prototype;h.setProvider=function(e){this._provider=e},h.getProvider=function(){return this._provider},h.resetSource=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=new ol.source.Vector({features:e});this.setSource(t)},h._makeOlLayer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.style,r=this._makeStyle(t);this._olLayer=new ol.layer.Vector({name:this.name,id:this.id,style:r,source:new ol.source.Vector({})})},h._makeStyle=function(e){var t=void 0,r={};return e&&(Object.entries(e).forEach(function(e){var t=a(e,2),n=t[0],i=t[1];switch(n){case"point":i.icon&&(r.image=new ol.style.Icon({src:i.icon.url,imageSize:i.icon.width}));break;case"line":r.stroke=new ol.style.Stroke({color:i.color,width:i.width});break;case"polygon":r.fill=new ol.style.Fill({color:i.color})}}),t=new ol.style.Style(r)),t},h.getFeatures=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred();return this.provider.getFeatures(t).then(function(t){e.addFeatures(t),r.resolve(t)}).fail(function(e){return r.reject(e)}),r.promise()},h.addFeatures=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.getSource().addFeatures(e)},h.addFeature=function(e){e&&this.getSource().addFeature(e)},h.getOLLayer=function(){if(this._olLayer)return this._olLayer;var e=this.id,t=this.geometryType,r=this.color,n=this.style?f(this.style):null;return this._olLayer=d({id:e,geometryType:t,color:r,style:n,features:this._features}),this._olLayer},h.setOLLayer=function(e){this._olLayer=e},h.getSource=function(){return!this._olLayer&&this.getOLLayer(),this._olLayer.getSource()},h.setSource=function(e){this._olLayer.setSource(e)},h.setStyle=function(e){this._olLayer.setStyle(e)},h.getFeatureById=function(e){return e?this._olLayer.getSource().getFeatureById(e):null},h.isVisible=function(){return this._olLayer.getVisible()},h.setVisible=function(e){this._olLayer.setVisible(e)},h.clear=function(){this.getSource().clear()},h.addToMap=function(e){e.addLayer(this._olLayer)}},{"core/g3wobject":12,"core/utils/geo":64,"core/utils/utils":68,"services/gui":361}],45:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET";this.LAYERTYPE={LAYER:"layer",MULTILAYER:"multilayer"},this.extraParams=t,this._method=r,c(this,e)}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=e("store/application-state"),l=n(s),u=e("core/utils/utils"),c=u.base,d=u.inherit,f=e("core/layers/map/maplayer"),p=e("g3w-ol/layers/rasters");d(a,f);var h=a.prototype;h.getOLLayer=function(e){return this._olLayer||(this._olLayer=this._makeOlLayer(e)),this._olLayer},h.getSource=function(){return this.getOLLayer().getSource()},h.getInfoFormat=function(){return"application/vnd.ogc.gml"},h.getGetFeatureInfoUrl=function(e,t,r,n){return this.getOLLayer().getSource().getGetFeatureInfoUrl(e,t,r,n)},h.getLayerConfigs=function(){return this.layers},h.addLayer=function(e){this.allLayers.find(function(t){return e===t})||this.allLayers.push(e),this.layers.find(function(t){return e===t})||this.layers.push(e)},h.removeLayer=function(e){this.layers=this.layers.filter(function(t){return e!==t})},h.isVisible=function(){return this._getVisibleLayers().length>0},h.getQueryUrl=function(){var e=this.layers[0];return e.infourl&&""!==e.infourl?e.infourl:this.config.url},h.getQueryableLayers=function(){return this.layers.filter(function(e){return e.isQueryable()})},h._getVisibleLayers=function(){return this.layers.filter(function(e){return e.isVisible()})},h._makeOlLayer=function(e){var t=this,r=new p.WMSLayer({url:this.layers[0]&&this.layers[0].getWmsUrl?this.layers[0].getWmsUrl():this.config.url,id:this.config.id,projection:this.config.projection,iframe_internal:this.iframe_internal,layers:e?this.layers.map(function(e){return e.getWMSLayerName()}):this.layers,format:this.config.format},this.extraParams,this._method);return r.getSource().on("imageloadstart",function(){return t.emit("loadstart")}),r.getSource().on("imageloadend",function(){return t.emit("loadend")}),r.getSource().on("imageloaderror",function(){return t.emit("loaderror")}),r},h._updateLayers=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.force,a=void 0!==n&&n,s=i(r,["force"]);!a&&this.checkLayersDisabled(t.resolution,t.mapUnits);var u=this._getVisibleLayers(t)||[],c=e("core/utils/geo"),d=c.get_LEGEND_ON_LEGEND_OFF_Params;if(u.length>0){var f={},p=[],h=[];u.map(function(e){var t=e.getWMSLayerName();f[t]=o({},d(e)),p.push(e.getStyle()),h.push(parseInt(e.getOpacity()/100*255))});var v=void 0,g=void 0;Object.keys(f).forEach(function(e){f[e].LEGEND_OFF&&(g="undefined"==typeof g?f[e].LEGEND_OFF:g+";"+f[e].LEGEND_OFF),f[e].LEGEND_ON&&(v="undefined"==typeof v?f[e].LEGEND_ON:v+";"+f[e].LEGEND_ON)});var m=u[0].isArcgisMapserver()?"show:":"";s=o({},s,{filtertoken:l["default"].tokens.filtertoken,STYLES:p.join(","),OPACITIES:h.join(","),LEGEND_ON:v,LEGEND_OFF:g,LAYERS:""+m+u.map(function(e){return e.getWMSLayerName()}).join(",")}),this._olLayer.setVisible(!0),this._olLayer.getSource().updateParams(s)}else this._olLayer.setVisible(!1)},h.setupCustomMapParamsToLegendUrl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.layer?this.layer.setMapParamstoLegendUrl(e):this.layers.forEach(function(t){return t.setMapParamstoLegendUrl(e)})},t.exports=a},{"core/layers/map/maplayer":43,"core/utils/geo":64,"core/utils/utils":68,"g3w-ol/layers/rasters":108,"store/application-state":373}],46:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET";this.LAYERTYPE={LAYER:"layer",MULTILAYER:"multilayer"},this.extraParams=t,this._method=r,s(this,e)}var a=e("store/application-state"),o=(n(a),e("core/utils/utils")),s=o.base,l=o.inherit,u=e("core/layers/map/wmslayer"),c=e("g3w-ol/layers/rasters");l(i,u);var d=i.prototype;d._makeOlLayer=function(e){var t=this,r={url:this.config.url,id:this.config.id,projection:this.config.projection,iframe_internal:this.iframe_internal,layers:this.layers};e&&(r.layers=this.layers.map(function(e){return e.getWMSLayerName()}));var n=this.layers[0];n&&n.getWmsUrl&&(r.url=n.getWmsUrl());var i=new c.TiledWMSLayer(r,this.extraParams,this._method);return i.getSource().on("tileloadstart",function(){return t.emit("loadstart")}),i.getSource().on("tileloadend",function(){return t.emit("loadend")}),i.getSource().on("tileloaderror",function(){return t.emit("loaderror")}),i},t.exports=i},{"core/layers/map/wmslayer":45,"core/utils/utils":68,"g3w-ol/layers/rasters":108,"store/application-state":373}],47:[function(e,t,r){function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET";o(this,e),this._method=t}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("core/layers/map/maplayer"),l=e("g3w-ol/layers/rasters");a(n,s);var u=n.prototype;u.getOLLayer=function(){var e=this._olLayer;return e||(e=this._olLayer=this._makeOlLayer()),e},u.getSource=function(){return this.getOLLayer().getSource()},u.getLayerConfigs=function(){return this.layer},u.addLayer=function(e){this.layer=e,this.layers.push(e),this.allLayers.push(e)},u.update=function(e,t){this._updateLayer(e,t)},u.isVisible=function(){return layer.state.visible},u._makeOlLayer=function(){var e=this,t=this.projection?this.projection:this.layer.getProjection(),r={url:this.layer.getCacheUrl()+"/{z}/{x}/{y}.png",maxZoom:20,extent:this.config.extent,iframe_internal:this.iframe_internal};return r.projection=t,this._olLayer=new l.XYZLayer(r,this._method),this._olLayer.getSource().on("imageloadstart",function(){e.emit("loadstart")}),this._olLayer.getSource().on("imageloadend",function(){e.emit("loadend")}),this._olLayer.getSource().on("imageloaderror",function(){e.emit("loaderror")}),this._olLayer},u._updateLayer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.force,n=void 0!==r&&r;!n&&this.checkLayersDisabled(e.resolution,e.mapUnits),this._olLayer.setVisible(this.layer.isVisible())},t.exports=n},{"core/layers/map/maplayer":43,"core/utils/utils":68,"g3w-ol/layers/rasters":108}],48:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this._name="geojson",this.provider=e.provider}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("core/layers/providers/provider");a(n,s);var l=n.prototype;l.query=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},$.Deferred());return e.resolve([]),e.promise()},l.getFeatures=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=$.Deferred(),r=e.url||this.getLayer().get("source").url,n=e.data,i=e.projection||"EPSG:4326",a=e.mapProjection,o=function(e){var t=new ol.format.GeoJSON;return t.readFeatures(e,{featureProjection:a,dataProjection:i})};if(n){var s=o(n);t.resolve(s)}else $.get({url:r}).then(function(e){var r=o(e.results);t.resolve(r)}).fail(function(e){t.reject(e)});return t.promise()},l.getDataTable=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(t.page,$.Deferred());return this.getFeatures().then(function(){r.resolve(e._features)}).fail(function(e){r.reject(e)}),r.promise()},l.digestFeaturesForTable=function(){return{headers:[],features:[]}},t.exports=n},{"core/layers/providers/provider":50,"core/utils/utils":68}],49:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this._name="kml"}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("core/layers/providers/provider");a(n,s);var l=n.prototype;l.getData=function(){var e=$.Deferred();return e.promise()},t.exports=n},{"core/layers/providers/provider":50,"core/utils/utils":68}],50:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._isReady=!1,this._name="provider",this._layer=e.layer,this._hasFieldsStartWithNotPermittedKey,a(this)}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=i.getTimeoutPromise,l=e("core/g3wobject"),u=e("core/utils/geo"),c=u.handleQueryResponse,d=e("core/utils/parsers"),f=d.response;o(n,l);var p=n.prototype;p.getLayer=function(){return this._layer},p.setLayer=function(e){this._layer=e},p.getFeatures=function(){},p.query=function(){},p.setReady=function(e){this._isReady=e},p.isReady=function(){return this._isReady},p.error=function(){},p.isValid=function(){},p.getName=function(){return this._name},p.handleQueryResponseFromServer=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[this._layer],n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return c({response:e,projections:t,layers:r,wms:n})},p.getQueryResponseTimeoutKey=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.layers,r=void 0===t?[this._layer]:t,n=e.resolve,i=e.query;return s({resolve:n,data:{data:f.utils.getTimeoutData(r),query:i}})},t.exports=n},{"core/g3wobject":12,"core/utils/geo":64,"core/utils/parsers":67,"core/utils/utils":68}],51:[function(e,t,r){function n(){this.build=function(e,t,r,n){var i=this.get(e,t,r);return i?new i(n):null},this.get=function(e,t,r){return a[t][r][e]}}var i={geojson:e("./geojsonprovider"),kml:e("./kmlprovider"),xml:e("./xmlprovider"),qgis:e("./qgisprovider"),wms:e("./wmsprovider"),wfs:e("./wfsprovider")},a={QGIS:{virtual:{query:i.wms,filter:i.wfs,data:i.qgis,search:i.qgis,filtertoken:i.qgis},postgres:{query:i.wms,filter:i.wfs,data:i.qgis,search:i.qgis,filtertoken:i.qgis},oracle:{query:i.wms,filter:i.wfs,data:i.qgis,search:i.qgis,filtertoken:i.qgis},mssql:{query:i.wms,filter:i.wfs,data:i.qgis,search:i.qgis,filtertoken:i.qgis},spatialite:{query:i.wms,filter:i.wfs,data:i.qgis,search:i.qgis,filtertoken:i.qgis},ogr:{query:i.wms,filter:i.wfs,data:i.qgis,search:i.qgis,filtertoken:i.qgis},delimitedtext:{query:i.wms,filter:i.wfs,data:i.qgis,search:i.qgis,filtertoken:i.qgis},wmst:{query:i.wms,filter:i.wfs,data:null,search:null},wcs:{query:i.wms,filter:i.wfs,data:null,search:null},wms:{query:i.wms,filter:i.wfs,data:null,search:null},wfs:{query:i.wms,filter:i.wfs,data:i.qgis,search:i.qgis},gdal:{query:i.wms,filter:null,data:null,search:null},"vector-tile":{query:i.wms,filter:null,data:null,search:null},vectortile:{query:i.wms,filter:null,data:null,search:null},arcgismapserver:{query:i.wms,filter:null,data:null,search:null},mdal:{query:i.wms,filter:null,data:null,search:null}},OGC:{wms:{query:i.wms,filter:null,data:null,search:null}},G3WSUITE:{geojson:{query:i.geojson,filter:null,data:i.geojson,search:null}}};t.exports=new n},{"./geojsonprovider":48,"./kmlprovider":49,"./qgisprovider":52,"./wfsprovider":53,"./wmsprovider":54,"./xmlprovider":55}],52:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};f(this),this._name="qgis",this._layer=e.layer||{},this._projections={map:null,layer:null},this._queryUrl=this._layer.getUrl("query"),this._filtertokenUrl=this._layer.getUrl("filtertoken"),this._layerName=this._layer.getName()||null,this._infoFormat=this._layer.getInfoFormat()||"application/vnd.ogc.gml"}var o=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=e("store/application-state"),l=n(s),u=e("services/relations"),c=n(u),d=e("core/utils/utils"),f=d.base,p=d.inherit,h=d.XHR,v=e("core/i18n/i18n.service"),g=v.t,m=e("core/layers/providers/provider"),y=e("core/utils/parsers"),b=y.response,w=e("core/layers/features/feature"),x=e("core/utils/parsers"),S=function(e){return void 0!==e};p(a,m);var L=a.prototype;L.deleteFilterToken=i(regeneratorRuntime.mark(function C(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.get({url:this._filtertokenUrl,params:{mode:"delete"}});case 2:case"end":return e.stop()}},C,this)})),L.getFilterToken=i(regeneratorRuntime.mark(function k(){var e,t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,h.get({url:this._filtertokenUrl,params:n});case 3:return e=i.sent,t=e.data,r=void 0===t?{}:t,i.abrupt("return",r.filtertoken);case 9:return i.prev=9,i.t0=i["catch"](0),i.abrupt("return",Promise.reject(i.t0));case 12:case"end":return i.stop()}},k,this,[[0,9]])})),L.getFilterData=i(regeneratorRuntime.mark(function E(){var e,t,r,n,i,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=a.field,s=a.raw,u=void 0!==s&&s,c=a.suggest,d=a.unique,f=a.formatter,p=void 0===f?1:f,v=a.queryUrl,g=a.ordering;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(e=this._layer.getUrl("data"),t={field:o,suggest:c,ordering:g,formatter:p,unique:d,filtertoken:l["default"].tokens.filtertoken},a.prev=2,!o){a.next=9;break}return a.next=6,h.post({url:""+(v?v:e),data:JSON.stringify(t),contentType:"application/json"});case 6:a.t0=a.sent,a.next=12;break;case 9:return a.next=11,h.get({url:""+(v?v:e),params:t});case 11:a.t0=a.sent;case 12:return r=a.t0,n="table"!==this._layer.getType(),n&&this.setProjections(),i=u?r:r.result?d?r.data:{data:b.get("application/json")({layers:[this._layer],response:r.vector.data,projections:this._projections})}:Promise.reject(),a.abrupt("return",i);case 19:return a.prev=19,a.t1=a["catch"](2),a.abrupt("return",Promise.reject(a.t1));case 22:case"end":return a.stop()}},E,this,[[2,19]])})),L.setProjections=function(){this._projections.map=this._layer.getMapProjection()||this._projections.layer},L.query=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred(),n=t.feature_count||10,i=t.raw||!1,a=t.filter,o=void 0===a?null:a;o=o&&Array.isArray(o)?o:[o];var s="table"!==this._layer.getType();s&&this.setProjections();var u=s?this._projections.map.getCode():l["default"].map.epsg,c=t.queryUrl||this._queryUrl,d=t.I,f=t.J,p=t.layers,v=p?p.map(function(e){return e.getWMSLayerName()}).join(","):this._layer.getWMSLayerName();if(o){"geometry"!==o[0].getType()&&(this._projections.layer=null),o=o.map(function(e){return e.get()}).filter(function(e){return e});var g=c,m={SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetFeatureInfo",filtertoken:l["default"].tokens.filtertoken,LAYERS:v,QUERY_LAYERS:v,INFO_FORMAT:this._infoFormat,FEATURE_COUNT:n,CRS:u,I:d,J:f,FILTER:o&&o.length?o.join(";"):void 0,WITH_GEOMETRY:s};h.get({url:g,params:m}).then(function(t){var n=i?t:e.handleQueryResponseFromServer(t,e._projections,p);r.resolve(n)})["catch"](function(e){return r.reject(e)})}else r.reject();return r.promise()},L.getConfig=function(){var e=$.Deferred(),t=this._layer.getUrl("config");return t?($.get(t).then(function(t){return e.resolve(t)}).fail(function(t){return e.reject(t)}),e.promise()):void e.reject("not valid url")},L.getWidgetData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=e.fields,n=this._layer.getUrl("widget"),i=n[t];return $.get(i,{fields:r})},L.unlock=function(){var e=this._layer.getUrl("unlock"),t=$.Deferred();return $.post(e).then(function(e){return t.resolve(e)}).fail(function(e){return t.reject(e)}),t.promise()},L.commit=function(e){var t=$.Deferred(),r=this._layer.getUrl("commit"),n=JSON.stringify(e);return $.post({url:r,data:n,contentType:"application/json"}).then(function(e){return t.resolve(e)}).fail(function(e){return t.reject(e)}),t.promise()},L.getFeatures=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=$.Deferred();Object.entries(r).forEach(function(e){var t=o(e,2),n=t[0],i=t[1];null!==i&&void 0!==i||delete r[n]});var i=this._layer.getType(),a=void 0,s="application/json";if(t.editing){var u=void 0;if(a=this._layer.getUrl("editing"),!a)return void n.reject("Url not valid");var d=$.param(r);a+=d?"?"+d:"";var f=[],p=t.filter||null;if(p){if(S(p.bbox)){var v=p.bbox;p={in_bbox:v[0]+","+v[1]+","+v[2]+","+v[3],filtertoken:l["default"].tokens.filtertoken};var m=JSON.stringify(p);u=h.post({url:a,data:m,contentType:s})}else if(S(p.fid)){var y=p.fid;u=c["default"].getRelations(y)}else if(p.field){var _=JSON.stringify(p);u=h.post({url:a,data:_,contentType:s})}else if(S(p.fids))u=h.get({url:a,params:p});else if(S(p.nofeatures)){var b=JSON.stringify({field:(p.nofeatures_field||"id")+"|eq|__G3W__NO_FEATURES__"});u=h.post({url:a,data:b,contentType:s})}}else u=h.post({url:a,contentType:s});u.then(function(t){var r=t.vector,a=t.result,o=t.featurelocks;if(a){var s=r.data,l=r.geometrytype,u=r.count,c=x[i].get({type:"json"}),d="NoGeometry"!==l?{crs:e._layer.getCrs()}:{},p=o.map(function(e){return e.featureid});c(s,d).forEach(function(e){var t=""+e.getId();p.indexOf(t)>-1&&f.push(new w({feature:e}))}),n.resolve({count:u,features:f,featurelocks:o})}else n.reject({message:g("info.server_error")})})["catch"](function(e){return n.reject({message:g("info.server_error")})})}else{a=this._layer.getUrl("data");var L=$.param(r);a+=L?"?"+L:"",$.get({url:a,contentType:s}).then(function(e){var t=e.vector,r=t.data;n.resolve({data:r,count:t.count})}).fail(function(e){return n.reject(e)})}return n.promise()},L._loadLayerData=function(e,t){var r=this,n=arguments,i=$.Deferred();Obkect.entries(this._layers).forEach(function(e){var t=o(e,2),r=t[0],n=t[1];_.isNull(n.vector)&&noVectorlayerCodes.push(r)});var a=noVectorlayerCodes.map(function(e){return r._setupVectorLayer(e)});return this.emit("loadingvectorlayersstart"),$.when.apply(this,a).then(function(){var e=Array.prototype.slice.call(n);r.emit("loadingvectolayersdatastart"),r.loadAllVectorsData(e).then(function(){r._vectorLayersCodes=e,i.resolve(e),r.emit("loadingvectorlayersend"),r.setReady(!0)}).fail(function(){r._layers.forEach(function(e){return e.vector=null}),i.reject(),r.emit("errorloadingvectorlayersend"),r.setReady(!1)})}).fail(function(){r.setReady(!1),r.emit("errorloadingvectorlayersend"),i.reject()}),i.promise()},L.setVectorLayersCodes=function(e){this._vectorLayersCodes=e},L.getVectorLayersCodes=function(){return this._vectorLayersCodes},L.getLayers=function(){return this._layers},L.reloadVectorData=function(e){var t=this,r=$.Deferred(),n=this._mapService.state.bbox;return this._createVectorLayerFromConfig(e).then(function(e){t._getVectorLayerData(e,n).then(function(n){t.setVectorLayerData(e[t._editingApiField],n),e.setData(n.vector.data),r.resolve(e)})}),r.promise()},L.loadAllVectorsData=function(e){var t=this,r=$.Deferred(),n=this._layers,i=this._mapService.state.bbox,a=this._loadedExtent;if(a&&ol.extent.containsExtent(a,i))return resolvedValue();this._loadedExtent=a?ol.extent.extend(a,i):i,e&&(n=[],e.forEach(function(e){return n.push(t._layers[e])}));var o=n.map(function(e){return t._loadVectorData(e.vector,i)});return $.when.apply(this,o).then(function(){return r.resolve(e)}).fail(function(){return r.reject()}),r.promise()},L._setCustomUrlParameters=function(e){this._customUrlParameters=e},L._checkVectorGeometryTypeFromConfig=function(e){switch(e.geometrytype){case"Line":e.geometrytype="LineString";break;case"MultiLine":e.geometrytype="MultiLineString"}return e},L._createVectorLayerFromConfig=function(e){var t=this,r=this._layers[e],n=$.Deferred();return this._getVectorLayerConfig(r[this._editingApiField]).then(function(e){var i=e.vector;i=t._checkVectorGeometryTypeFromConfig(i);var a=r.crs||t._mapService.getProjection().getCode(),o=t._createVectorLayer({geometrytype:i.geometrytype,format:i.format,crs:t._mapService.getProjection().getCode(),crsLayer:a,id:r.id,name:r.name,editing:self._editingMode});o.setFields(i.fields),o.setCrs(a);var s=i.relations;s&&(o.lazyRelations=!0,o.setRelations(s)),r.style&&o.setStyle(r.style),n.resolve(o)}).fail(function(){return n.reject()}),n.promise()},L._setupVectorLayer=function(e){var t=this,r=$.Deferred();return this._createVectorLayerFromConfig(e).then(function(n){var i=t._layers[e];i.vector=n,r.resolve(e)}).fail(function(){return r.reject()}),r.promise()},L._loadVectorData=function(e,t){var r=this;return self._getVectorLayerData(e,t).then(function(t){if(r.setVectorLayerData(e[r._editingApiField],t),r._editingMode&&t.featurelocks&&r.setVectorFeaturesLock(e,t.featurelocks),e.setData(t.vector.data),r._)return t}).fail(function(){return!1})},L.getVectorLayerData=function(e){return this._vectorLayersData[e]},L.getVectorLayersData=function(){return this._vectorLayersData},L.setVectorLayerData=function(e,t){this._vectorLayersData[e]=t},L.setVectorFeaturesLock=function(e,t){var r=_.differenceBy(t,e.getFeatureLocks(),"featureid");r.forEach(function(t){e.addLockId(t)})},L.cleanVectorFeaturesLock=function(e){e.cleanFeatureLocks()},L.lockFeatures=function(e){var t=this,r=$.Deferred(),n=this._mapService.state.bbox,i=this._layers[e].vector;return $.get(this._baseUrl+e+"/?lock"+this._customUrlParameters+"&in_bbox="+n[0]+","+n[1]+","+n[2]+","+n[3]).done(function(e){t.setVectorFeaturesLock(i,e.featurelocks),r.resolve(e)}).fail(function(){return r.reject()}),r.promise()},L._getVectorLayerConfig=function(e){var t=$.Deferred();return $.get(this._baseUrl+e+"/?config"+this._customUrlParameters).done(function(e){return t.resolve(e)}).fail(function(){return t.reject()}),t.promise()},L._getVectorLayerData=function(e,t){var r=$.Deferred(),n="w"==this.getMode(),i=n?this._baseUrl+e[this._editingApiField]+"/?editing":this._baseUrl+e[this._editingApiField]+"/?";return $.get(i+this._customUrlParameters+"&in_bbox="+t[0]+","+t[1]+","+t[2]+","+t[3]).done(function(e){return r.resolve(e)}).fail(function(){return r.reject()}),r.promise()},L._createVectorLayer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new VectorLayer(e);return t},L.cleanUpLayers=function(){this._loadedExtent=null},t.exports=a},{"core/i18n/i18n.service":13,"core/layers/features/feature":26,"core/layers/providers/provider":50,"core/utils/parsers":67,"core/utils/utils":68,"services/relations":367,"store/application-state":373}],53:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this._name="wfs"}var i=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=e("core/utils/utils"),o=a.base,s=a.inherit,l=a.toRawType,u=e("core/layers/providers/provider"),c=e("core/layers/filter/filter");s(n,u);var d=n.prototype;d.getData=function(){var e=$.Deferred();return e.promise()},d.query=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.reproject,a=void 0!==n&&n,o=t.feature_count,s=void 0===o?10:o,u=t.filter;r.MAXFEATURES=s;var c=$.Deferred(),d=t.layers,f=void 0===d?[this._layer]:d,p={map:this._layer.getMapProjection(),layer:a?this._layer.getProjection():null},h=this.getQueryResponseTimeoutKey({layers:f,resolve:c.resolve,query:{}});return this._doRequest(u,r,f,a).then(function(t){var r=e.handleQueryResponseFromServer(t,p,f,wms=!1);r.forEach(function(e){var t=e.features,r=void 0===t?[]:t;r.forEach(function(e){Object.entries(e.getProperties()).forEach(function(t){var r=i(t,2),n=r[0],a=r[1];"Object"===l(a)&&a["xsi:nil"]&&e.set(n,"NULL")})})}),c.resolve({data:r})}).fail(function(e){return c.reject(e)}).always(function(){clearTimeout(h)}),c.promise()},d._post=function(e,t){e=e.match(/\/$/)?e:e+"/";var r=$.Deferred();return $.post(e,t).then(function(e){return r.resolve(e)}).fail(function(e){return r.reject(e)}),r.promise()},d._get=function(e,t){e=e.match(/\/$/)?e:e+"/";var r=$.Deferred(),n=$.param(t);return e=e+"?"+n,$.get(e).then(function(e){return r.resolve(e)}).fail(function(e){return r.reject(e)}),r.promise()},d._doRequest=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments[2],n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=$.Deferred();e=e||new c({});var a=r?r[0]:this._layer,o=a.getOwsMethod(),s=a.getQueryUrl(),l=a.getInfoFormat(),u=r?r.map(function(e){return e.getWFSLayerName()}).join(","):a.getWFSLayerName(),d=n?a.getProjection().getCode():this._layer.getMapProjection().getCode();if(t=Object.assign(t,{SERVICE:"WFS",VERSION:"1.1.0",REQUEST:"GetFeature",TYPENAME:u,OUTPUTFORMAT:l,SRSNAME:d}),e){var f=e.getType(),p=e.getConfig(),h=void 0,v=ol.format.filter;switch(e=e.get(),f){case"bbox":h=(new ol.format.WFS).writeGetFeature({featureTypes:[a],filter:v.bbox("the_geom",e)});break;case"geometry":var g=p.spatialMethod,m=void 0===g?"intersects":g;h=(new ol.format.WFS).writeGetFeature({featureTypes:[a],filter:v[m]("the_geom",e)});break;case"expression":h=(new ol.format.WFS).writeGetFeature({featureTypes:[a],filter:null});break;case"all":return request=this._post(s,t),request}t.FILTER=("("+h.children[0].innerHTML+")").repeat(r?r.length:1);var y="GET"===o&&"geometry"!==f?this._get(s,t):this._post(s,t);y.then(function(e){i.resolve(e)}).fail(function(e){200===e.status?i.resolve(e.responseText):i.reject(e)})}else i.reject();return i.promise()},t.exports=n},{"core/layers/filter/filter":30,"core/layers/providers/provider":50,"core/utils/utils":68}],54:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};c(this,e),this._name="wms",this._projections={map:null,layer:null}}var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("store/application-state"),s=n(o),l=e("constant"),u=e("core/utils/utils"),c=u.base,d=u.inherit,f=u.appendParams,p=u.XHR,h=e("core/utils/geo"),v=h.get_LEGEND_ON_LEGEND_OFF_Params,g=e("core/utils/ol"),m=e("core/layers/providers/provider"),y=[101,101],_=g.getDPI();d(i,m);var b=i.prototype;b._getRequestParameters=function(e){var t=e.layers,r=e.feature_count,n=e.coordinates,i=e.infoFormat,o=e.query_point_tolerance,u=void 0===o?l.QUERY_POINT_TOLERANCE:o,c=e.resolution,d=e.size,f=t?t.map(function(e){return e.getWMSInfoLayerName()}).join(","):this._layer.getWMSInfoLayerName(),p=g.getExtentForViewAndSize(n,c,0,d),h=Math.floor((n[0]-p[0])/c),m=Math.floor((p[3]-n[1])/c),y={},b=u.unit,w=u.value;if("map"===b){var x=ol.geom.Polygon.fromCircle(new ol.geom.Circle(n,w)),S=new ol.format.WKT;
y={FILTER_GEOM:S.writeGeometry(x)}}else y={FI_POINT_TOLERANCE:w,FI_LINE_TOLERANCE:w,FI_POLYGON_TOLERANCE:w,G3W_TOLERANCE:w*c,I:h,J:m};var L={LEGEND_ON:[],LEGEND_OFF:[]};t.forEach(function(e){if(e.getCategories()){var t=v(e),r=t.LEGEND_ON,n=t.LEGEND_OFF;r&&L.LEGEND_ON.push(r),n&&L.LEGEND_OFF.push(n)}});var C=a({SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetFeatureInfo",CRS:this._projections.map.getCode(),LAYERS:f,QUERY_LAYERS:f,filtertoken:s["default"].tokens.filtertoken,INFO_FORMAT:i,FEATURE_COUNT:r,WITH_GEOMETRY:!0,DPI:_},y,{WIDTH:d[0],HEIGHT:d[1],LEGEND_ON:L.LEGEND_ON.length?L.LEGEND_ON.join(";"):void 0,LEGEND_OFF:L.LEGEND_OFF.length?L.LEGEND_OFF.join(";"):void 0});"STYLES"in C||(C.STYLES="");var k="ne"===this._projections.map.getAxisOrientation().substr(0,2)?[p[1],p[0],p[3],p[2]]:p;return C.BBOX=k.join(","),C},b.query=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred(),n=this._layer.getInfoFormat()||"application/vnd.ogc.gml",i=this._layer.getProjection();this._projections.map=this._layer.getMapProjection()||i;var a=t.layers,o=void 0===a?[this._layer]:a,s=t.feature_count,l=void 0===s?10:s,u=t.size,c=void 0===u?y:u,d=t.coordinates,f=void 0===d?[]:d,p=t.resolution,h=t.query_point_tolerance,v=o[0],g=v.getQueryUrl(),m=v.isExternalWMS()||!/^\/ows/.test(g)?"GET":v.getOwsMethod(),_=this._getRequestParameters({layers:o,feature_count:l,coordinates:f,infoFormat:n,query_point_tolerance:h,resolution:p,size:c}),b={coordinates:f,resolution:p},w=this.getQueryResponseTimeoutKey({layers:o,resolve:r.resolve,query:b});return v.useProxy()?v.getDataProxyFromServer("wms",{url:g,params:_,method:m,headers:{"Content-Type":n}}).then(function(t){var n=e.handleQueryResponseFromServer(t,e._projections,o);r.resolve({data:n,query:b})}):this[m]({url:g,layers:o,params:_}).then(function(t){var n=e.handleQueryResponseFromServer(t,e._projections,o);r.resolve({data:n,query:b})})["catch"](function(e){return r.reject(e)})["finally"](function(){return clearTimeout(w)}),r.promise()},b.GET=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.params,n=t.split("SOURCE");return n.length&&(t=n[0],n=n.length>1?"&SOURCE"+n[1]:""),t=f(t,r),t=""+t+(n&&n),p.get({url:t})},b.POST=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.params;return p.post({url:t,data:r})},t.exports=i},{constant:4,"core/layers/providers/provider":50,"core/utils/geo":64,"core/utils/ol":66,"core/utils/utils":68,"store/application-state":373}],55:[function(e,t,r){function n(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this),this._name="xml"}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("core/layers/providers/provider");a(n,s);var l=n.prototype;l.getData=function(){var e=$.Deferred();return e.promise()},t.exports=n},{"core/layers/providers/provider":50,"core/utils/utils":68}],56:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setters={clearFeatures:function(){this._clearFeatures()},addFeature:function(e){this._addFeature(e)},deleteFeature:function(e){this._deleteFeature(e)},updateFeature:function(e){this._updateFeature(e)},setFeatures:function(e){this._setFeatures(e)},getFeatures:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred();return this._featuresstore.getFeatures(t).then(function(t){t.then(function(t){return e.emit("getFeatures",t),r.resolve(t)}).fail(function(e){return r.reject(e)})}).fail(function(e){return r.reject(e)}),r.promise()},commit:function(e){var t=this,r=$.Deferred();return this._featuresstore.commit(e).then(function(n){n.then(function(n){n&&n.result&&t.syncSelectionFilterFeatures(e),r.resolve(n)}).fail(function(e){return r.reject(e)})}).fail(function(e){r.reject(e)}),r.promise()},setColor:function(e){this._setColor(e)}},this.type=v.LayerTypes.TABLE,this._color=null,r.project=r.project||d["default"].getCurrentProject(),this.layerId=t.id,t.urls=t.urls||{},t.editing={fields:[]},p(this,t,r),this._editatbleLayer,this.isEditable()&&(this.layerForEditing=new Promise(function(t,r){e.getEditingConfig().then(function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.vector,i=r.constraints,a=void 0===i?{}:i,o=r.capabilities,l=void 0===o?s.DEFAULT_EDITING_CAPABILITIES:o;e.config.editing.fields=n.fields,e.config.editing.format=n.format,e.config.editing.constraints=a,e.config.editing.capabilities=l,e.config.editing.style=n.style,e.config.editing.form={perc:null},e._setOtherConfigParameters(n),n.style&&e.setColor(n.style.color),e._editor=new g({layer:e}),t(e),e.setReady(!0)}).fail(function(t){r(e),e.setReady(!1)})}),this.state=o({},this.state,{editing:{started:!1,modified:!1,ready:!1}})),this._featuresstore=new m({provider:this.providers.data})}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=e("app/constant"),l=e("store/catalog-layers"),u=n(l),c=e("store/projects"),d=n(c),f=e("core/utils/utils"),p=f.base,h=f.inherit,v=e("core/layers/layer"),g=e("core/editing/editor"),m=e("core/layers/features/featuresstore"),y=e("core/layers/features/feature");h(a,v);var b=a.prototype;b.syncSelectionFilterFeatures=function(e){try{var t=u["default"].getLayerById(this.getId());t.isGeoLayer()&&e.update.forEach(function(e){var r=e.id,n=e.geometry;t.getOlSelectionFeature(r)&&t.updateOlSelectionFeature({id:r,geometry:n})}),e["delete"].forEach(function(e){t.hasSelectionFid(e)&&t.excludeSelectionFid(e)})}catch(r){}},b.setFormPercentage=function(e){this.config.editing.form.perc=e},b.getFormPercentage=function(){return this.config.editing.form.perc},b.clone=function(){return _.cloneDeep(this)},b.cloneFeatures=function(){return this._featuresstore.clone()},b.setVectorUrl=function(e){this.vectorUrl=e},b.setProjectType=function(e){this.projectType=e},b._setColor=function(e){this._color=e},b.getColor=function(){return this._color},b.readFeatures=function(){return this._featuresstore.readFeatures()},b.getLayerForEditing=i(regeneratorRuntime.mark(function w(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.vectorurl,n=t.project_type;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r&&this.setVectorUrl(r),n&&this.setProjectType(n),this.setEditingUrl(),e=this.clone(),t.prev=4,t.next=7,e.layerForEditing;case 7:return t.abrupt("return",t.sent);case 10:return t.prev=10,t.t0=t["catch"](4),t.abrupt("return",t.t0);case 13:case"end":return t.stop()}},w,this,[[4,10]])})),b.getEditingSource=function(){return this._editor.getEditingSource()},b.readEditingFeatures=function(){return this._editor.readEditingFeatures()},b.getEditingLayer=function(){return this},b.isEditingLayer=function(){return!!this.config.editing},b.getEditingStyle=function(){return this.config.editing.style},b.setEditingStyle=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config.editing.style=e},b.getEditingConstrains=function(){return this.config.editing.constraints},b.getEditingCapabilities=function(){return this.config.editing.capabilities},b.isFieldRequired=function(e){var t=!1;return this.getEditingFields().forEach(function(r){if(e===r.name)return t=!!r.validate.required,!1}),t},b.unlock=function(){var e=$.Deferred();return this._featuresstore.unlock().then(function(){return e.resolve()}).fail(function(t){return e.reject(t)}),e.promise()},b._setOtherConfigParameters=function(e){},b.getEditingFields=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.config.editing.fields.length?this.config.editing.fields:this.config.fields;return e&&(t=t.filter(function(e){return e.editable})),t},b.isPkField=function(e){var t=this.getEditingFields().find(function(t){return t.name===e});return t&&t.pk},b.isEditingFieldEditable=function(e){var t=this.getEditingFields().find(function(t){return t.name===e});return!!t&&t.editable},b.getEditingNotEditableFields=function(){return this.config.editing.fields.filter(function(e){return!e.editable}).map(function(e){return e.name})},b.getEditingMediaFields=function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.config.editing.fields.filter(function(e){return"media"===e.input.type}).map(function(e){return e.name})},b.getFieldsLabel=function(){var e=[];return this.getEditingFields().forEach(function(t){return e.push(t.label)}),e},b.getDataFormat=function(){return this.config.editing.format},b.getEditingFormat=function(){return this.config.editing.format},b.isReady=function(){return this.state.editing.ready},b.setReady=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state.editing.ready=e},b.getEditingConfig=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=$.Deferred(),r=this.getProvider("data");return r.getConfig(e).then(function(e){return t.resolve(e)}).fail(function(e){return t.reject(e)}),t.promise()},b.addEditingConfigFieldOption=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.field,r=e.key,n=e.value,i=t.input.options;return i[r]=n,i[r]},b.getWidgetData=function(e){var t=this.getProvider("data"),r=$.Deferred();return t.getWidgetData(e).then(function(e){return r.resolve(e)}).fail(function(e){return r.reject(e)}),r.promise()},b.getCommitUrl=function(){return this.config.urls.commit},b.setCommitUrl=function(e){this.config.urls.commit=e},b.getEditingUrl=function(){return this.config.urls.editing},b.getUnlockUrl=function(){return this.config.url.unlock},b.setUnlockUrl=function(e){this.config.urls.unlock=e},b.getWidgetUrl=function(){return this.config.urls.widget},b.setDataUrl=function(e){this.config.urls.data=e},b.getDataUrl=function(){return this.config.urls.data},b.getConfigUrl=function(){return this.config.urls.config},b.setConfigUrl=function(e){this.config.urls.index=e},b.getEditor=function(){return this._editor},b.isStarted=function(){return this.getEditor().isStarted()},b.setEditor=function(e){this._editor=e},b.getFeaturesStore=function(){return this._featuresstore},b.setFeaturesStore=function(e){this._featuresstore=e},b.setSource=function(e){this.setFeaturesStore(e)},b.getSource=function(){return this._featuresstore},b.getEditingStyle=function(){return this.config.editing.style},b._setFeatures=function(e){this._featuresstore.setFeatures(e)},b.addFeatures=function(e){var t=this;e.forEach(function(e){return t.addFeature(e)})},b._addFeature=function(e){this._featuresstore.addFeature(e)},b._deleteFeature=function(e){return e.getId()},b._updateFeature=function(e){},b._clearFeatures=function(){this._featuresstore.clearFeatures()},b.addLockIds=function(e){this._featuresstore.addLockIds(e)},b.setFieldsWithValues=function(e,t){var r=function i(e){var t={};return e.forEach(function(e){"child"===e.type?t[e.name]=i(e.fields):"null"===e.value&&(e.value=null),t[e.name]=e.value}),t},n=r(t);return e.setProperties(n),n},b.getFieldsWithValues=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.exclude,i=void 0===n?[]:n,a=r.get_default_value,o=void 0===a||a,s=JSON.parse(JSON.stringify(this.getEditingFields())),l=void 0;if(e instanceof y)l=e;else if(e instanceof ol.Feature)l=new y({feature:e});else{if(!e)return s;l=this.getFeatureById(e)}var u=l.getProperties();return s.forEach(function(e){if(e.value=u[e.name],e._value=u[e.name],e.update=!1,e.input){var r=t.getEditingFields().find(function(t){return t.name===e.name}).input.options;e.input.options.loading=r.loading||{state:null},e.input.options.values=r.values}e.visible=i.indexOf(e.name)===-1,void 0===e.validate&&(e.validate={}),e.forceNull=!1,e.validate.valid=!0,e.validate._valid=!0,e.value_from_default_value=!1,e.get_default_value=o,e.validate.unique=e.validate.unique||!1,e.validate.exclude_values=new Set,e.validate.required=e.validate.required||!1,e.validate.mutually_valid=!0,e.validate.empty=!e.validate.required,e.validate.message=null}),s},b.createNewFeature=function(){var e=new ol.Feature,t={};return this.getEditingFields().forEach(function(e){return t[e.name]=null}),e.setProperties(t),e=new y({feature:e}),e.setNew(),e},t.exports=a},{"app/constant":4,"core/editing/editor":6,"core/layers/features/feature":26,"core/layers/features/featuresstore":27,"core/layers/layer":34,"core/utils/utils":68,"store/catalog-layers":374,"store/projects":379}],57:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];a(this,e,t),this._mapLayer=null,this.type=l.LayerTypes.VECTOR,this.setup(e,t),this.onafter("setColor",function(e){})}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=i.mixin,l=e("core/layers/layer"),u=e("core/layers/tablelayer"),c=e("core/layers/geolayermixin"),d=e("core/layers/map/vectorlayer");o(n,u),s(n,c);var f=n.prototype;f.getEditingLayer=function(){return this.getMapLayer().getOLLayer()},f.resetEditingSource=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.getMapLayer().resetSource(e)},f._setOtherConfigParameters=function(e){this.config.editing.geometrytype=e.geometrytype},f.getEditingGeometryType=function(){return this.config.editing.geometrytype},f.getMapLayer=function(){if(this._mapLayer)return this._mapLayer;var e=this.getId(),t=this.getGeometryType(),r=this.getColor(),n=this.isEditingLayer()?this.getEditingStyle():this.getCustomStyle(),i=this.getProvider("data");return this._mapLayer=new d({id:e,geometryType:t,color:r,style:n,provider:i,features:this._editor&&this._editor.getEditingSource().getFeaturesCollection()}),this._mapLayer},t.exports=n},{"core/layers/geolayermixin":32,"core/layers/layer":34,"core/layers/map/vectorlayer":44,"core/layers/tablelayer":56,"core/utils/utils":68}],58:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("store/plugins"),s=n(o),l=e("store/projects"),u=n(l),c=e("services/application"),d=n(c),f=e("services/gui"),p=n(f),h=e("core/utils/utils"),v=h.base,g=h.inherit,m=h.toRawType,y=e("core/g3wobject"),_=e("gui/component/componentsfactory"),b=e("core/i18n/i18n.service"),w=b.addI18nPlugin,x=1e4,S=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.name,n=void 0===r?null:r,i=t.config,a=void 0===i?s["default"].getPluginConfig(n):i,o=t.service,l=void 0===o?null:o,u=t.dependencies,c=void 0===u?[]:u,d=t.i18n,f=void 0===d?null:d,h=t.fontClasses,g=void 0===h?[]:h,m=t.api,y=void 0===m?{}:m;v(this),this.setName(n),this.setConfig(a),this.setLocale(f),this.setService(l),this.setDependencies(c),this.addFontClasses(g),this.setApi(y),this.setHookService(null),this._ready=!1,this.hookservices={search:p["default"].getService("search"),tools:p["default"].getService("tools")},this._timeout=setTimeout(function(){s["default"].removeLoadingPlugin(e.name,e._ready),e.removeLayout()},x)};g(S,y);var L=S.prototype;L.setName=function(e){this.name=e},L.getName=function(){return this.name},L.setConfig=function(e){this.config="Object"===m(e)?e:null},L.getConfig=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.name;return this.config||s["default"].getPluginConfig(e)},L.setLocale=function(e){e&&this.name&&w({name:this.name,config:e})},L.setService=function(e){this.service=e,e&&e.setPlugin(this)},L.getService=function(){return this.service},L.setDependencies=function(e){this.dependencies=e},L.setApi=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._api=e,e.getConfig=this._api.getConfig},L.getApi=function(){return this._api},L.setHookService=function(e){this._hook=e},L.getHookService=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"tools";return this.hookservices[e]},L.setLayout=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d["default"].cloneLayout("app");d["default"].setLayout(this.name,e)},L.setCurrentLayout=function(){d["default"].setCurrentLayout(this.name)},L.removeLayout=function(){d["default"].removeLayout(this.name)},L.setReady=function(e){var t=this;this._ready=e,this._ready&&this.setLayout(),this.emit("set-ready",e,this.name),setTimeout(function(){clearTimeout(t._timeout),s["default"].removeLoadingPlugin(t.name,t._ready)},0)},L.isReady=function(){var e=this;return new Promise(function(t){e._ready?t(e._ready):e.once("set-ready",function(r){e._ready=r,t(e._ready)})})},L.isCurrentProjectCompatible=function(e){return e===u["default"].getCurrentProject().getGid()},L.registerPlugin=function(e){var t=this.isCurrentProjectCompatible(e);return t?s["default"].registerPlugin(this):(s["default"].removeLoadingPlugin(this.name,!1),clearTimeout(this._timeout)),t},L.getDependencyPlugins=function(e){var t=this;return this.dependencies=e||this.dependencies,Promise.all(this.dependencies.map(function(e){return t.getDependencyPlugin(e)}))},L.getDependencyPluginsObject=function(){var e=i(regeneratorRuntime.mark(function t(e){var r,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={},t.next=3,this.getDependencyPlugins(e);case 3:return n=t.sent,this.dependencies.forEach(function(e,t){return r[e]=n[t]}),t.abrupt("return",r);case 6:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),L.getDependencyPlugin=function(e){return s["default"].isTherePlugin(e)?new Promise(function(t){var r=s["default"].getPlugin(e);r&&r.isReady().then(function(){return t(r.getApi())})||s["default"].onafter("registerPlugin",function(r){r.name===e&&r.isReady().then(function(){t(r.getApi())})})}):Promise.reject({error:"no plugin"})},L.setHookLoading=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.hook,r=void 0===t?"tools":t,n=e.loading,i=void 0!==n&&n;this.getHookService(r).setLoading(i)},L.addToolGroup=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.hook,r=void 0===t?"tools":t,n=e.position,i=e.title;this.getHookService(r).addToolGroup(n,i)},L.removeToolGroup=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.hook,r=e.group;this.getHookService(t).removeToolGroup(r.title)},L.addTools=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.hook,n=void 0===r?"tools":r,i=t.action,a=t.html,o=t.offline,s=void 0===o||o,l=t.icon,u=t.name,c=t.type,d=t.options,f=void 0===d?{}:d,p=t.loading,h=void 0!==p&&p,v=t.disabled,g=void 0!==v&&v,m=t.state,y=void 0===m?{type:null,message:null}:m,_=arguments[1];if(i||c){this.setHookService(n);var b=(this.config.configs||[this.config]).map(function(t){return{icon:l,type:c,name:t.name||u,html:a,loading:h,disabled:g,options:f,offline:s,action:i&&i.bind(e,t),state:y}});return this.getHookService(n).addTools(b,_),b}return this.removeToolGroup({hook:n,group:_}),[]},L.setToolState=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.state,n=void 0===r?{type:null,message:null}:r;this.hookservices[this._hook].setToolState({id:t,state:n})},L.removeTools=function(){this.hookservices[this._hook].removeTools()},L.createSideBarComponent=function(e){var t,r,n,i,o,s,l,u,c,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t={},id=t.id,title=t.title,r=t.open,open=void 0!==r&&r,n=t.collapsible,collapsible=void 0===n||n,i=t.mobile,mobile=void 0===i||i,o=t.isolate,isolate=void 0!==o&&o,s=t.closewhenshowviewportcontent,closewhenshowviewportcontent=void 0===s||s,l=t.iconConfig,iconConfig=void 0===l?{}:l,u=t.events,events=void 0===u?{}:u,c=t.sidebarOptions,sidebarOptions=void 0===c?{position:1}:c,t),f=a({},d,{iconColor:d.iconConfig.color,icon:p["default"].getFontClass(d.iconConfig.icon)});delete f.iconConfig;var h=_.build({vueComponentObject:e},f);return p["default"].addComponent(h,"sidebar",d.sidebarOptions),this.once("unload",function(){return p["default"].removeComponent(id,"sidebar",d.sidebarOptions)}),h},L.unload=function(){this.service&&this.service.clearAllEvents(),this.emit("unload")},L.load=function(){},L.getProject=function(){return u["default"].getCurrentProject()},L.addDependency=function(e){this.dependencies.push(e)},L.addFontClass=function(e){var t=e.name,r=e.className;Vue.prototype.g3wtemplate.addFontClass({name:t,className:r})},L.addFontClasses=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach(function(t){return e.addFontClass(t)})},t.exports=S},{"core/g3wobject":12,"core/i18n/i18n.service":13,"core/utils/utils":68,"gui/component/componentsfactory":118,"services/application":351,"services/gui":361,"store/plugins":378,"store/projects":379}],59:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};c(this,t),this.plugin,this._api={own:null,dependencies:{}},this._pluginEvents={},this._appEvents=[],this.currentLayout=l["default"].getCurrentLayoutName(),this.vm=new Vue,this.unwatch=this.vm.$watch(function(){return o["default"].gui.layout.__current},function(t){return e.currentLayout=t!==e.getPlugin().getName()?t:e.currentLayout})}var a=e("store/application-state"),o=n(a),s=e("services/application"),l=n(s),u=e("core/utils/utils"),c=u.base,d=u.inherit,f=e("core/g3wobject");d(i,f);var p=i.prototype;p.init=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config=e},p.setCurrentLayout=function(){l["default"].setCurrentLayout(this.getPlugin().getName())},p.resetCurrentLayout=function(){l["default"].setCurrentLayout(this.currentLayout)},p.setPlugin=function(e){this.plugin=e},p.getPlugin=function(){return this.plugin},p.isIframe=function(){return l["default"].isIframe()},p.getCurrentProject=function(){return l["default"].getCurrentProject()},p.getGid=function(){var e=this.config.gid;return e&&e.split(":")[1]},p.getConfig=function(){return this.config},p.setConfig=function(e){this.config=e},p.setApi=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dependency,r=e.api;t?this._api.dependencies[t]=r:this._api.own=r},p.getApi=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dependency;return t&&this._api.dependencies[t]||this._api.own},p.initEvents=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];for(var t in e){var r=e[t];this._pluginEvents[r]={}}},p.registerWindowEvent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.evt,r=e.cb;l["default"].registerWindowEvent({evt:t,cb:r})},p.unregisterWindowEvent=function(e){var t=e.evt,r=e.cb;l["default"].unregisterWindowEvent({evt:t,cb:r})},p.subscribeEvent=function(e){var t=e.name,r=e.once,n=void 0!==r&&r,i=e.owner,a=e.listener;this._pluginEvents[t]=this._pluginEvents[t]?this._pluginEvents[t]:{},this._pluginEvents[t][i]=a,n?this.once(t,a):this.on(t,a)},p.triggerEvent=function(e){var t=e.name,r=e.params,n=void 0===r?{}:r;this.emit(t,n)},p.unsubscribeEvent=function(e){var t=e.name,r=e.owner,n=this._pluginEvents[t][r];this.removeEvent(t,n),delete this._pluginEvents[t][r]},p.unsubscribeAllEvents=function(){for(var e in this._pluginEvents)this.removeEvent(e),delete this._pluginEvents[e]},p.clearAllEvents=function(){this.unsubscribeAllEvents(),this.unwatch(),this.vm=null,this._pluginEvents=null},p.loadPlugin=function(){return!0},p.clear=function(){},t.exports=i},{"core/g3wobject":12,"core/utils/utils":68,"services/application":351,"store/application-state":373}],60:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=this;arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._currentLayerStore=u["default"].getCurrentProject().getLayersStore(),u["default"].onbefore("setCurrentProject",function(t){return e._currentLayerStore=t.getLayersStore()}),d(this)}var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("store/application-state"),s=n(o),l=e("store/projects"),u=n(l),c=e("core/utils/utils"),d=c.base,f=c.inherit,p=c.convertObjectToUrlParams,h=e("core/g3wobject"),v={pdf:"application/pdf",jpg:"image/jpeg"},g={SERVICE:"WMS",VERSION:"1.3.0"},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.field,r=e.values,n=e.template,i=e.download,o=void 0!==i&&i,l=r.length>1,u=""+t+(l?" IN (":"=")+r.map(function(e){return"'"+e+"'"}).join()+(l?")":""),c=a({},g,{REQUEST:"GetPrintAtlas",EXP_FILTER:u,TEMPLATE:n,filtertoken:s["default"].tokens.filtertoken});return o&&(c.DOWNLOAD=1),c},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.rotation,n=t.dpi,i=t.format,o=t.crs,l=t.template,u=t.maps,c=void 0===u?[]:u,d=t.labels,f=void 0===d?[]:d,p=t.is_maps_preset_theme,h=e.map(function(e){return e.getPrintLayerName()}).join(),v=e.map(function(e){return e.getStyle()}).join(","),m=a({},g,{REQUEST:"GetPrint",TEMPLATE:l,DPI:n,STYLES:v,FORMAT:i,CRS:o,filtertoken:s["default"].tokens.filtertoken});return p||(m.LAYERS=h),c.forEach(function(e){var t=e.name,n=e.scale,i=e.extent,a=e.preset_theme;m[t+":SCALE"]=n,m[t+":EXTENT"]=i,m[t+":ROTATION"]=r,p&&void 0===a&&(m[t+":LAYERS"]=h)}),f.forEach(function(e){return m[e.id]=e.text}),m},_=function(e){var t=e.url,r=e.params,n=e.mime_type;return new Promise(function(e,i){t=t+"?"+p(r),e({url:t,layers:!0,mime_type:n})})},b=function(e){var t=e.url,r=e.params,n=e.mime_type;return new Promise(function(e,i){var a=new XMLHttpRequest;a.open("POST",t,!0),a.responseType="blob",a.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),a.onload=function(){if(200===a.status)try{window.URL=window.URL||window.webkitURL;var t=window.URL.createObjectURL(a.response);e({url:t,layers:!0,mime_type:n})}catch(r){i(r)}else 500===a.status&&i()},a.onerror=function(){i()},a.send(p(r))})};f(i,h);var w=i.prototype;w.POST=b,w.GET=_,w._getAtlasParamsFromOptions=m,w._getParamsFromOptions=y,w.getUrl=function(){return this._currentLayerStore.getWmsUrl()},w.printAtlas=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",r=this.getUrl(),n=this._getAtlasParamsFromOptions(e);return this[t]({url:r,params:n,mime_type:v.pdf})},w.print=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",r=this.getUrl(),n=this._currentLayerStore.getLayers({PRINTABLE:{scale:e.scale},SERVERTYPE:"QGIS"}).reverse();if(n.length){e.crs=this._currentLayerStore.getProjection().getCode();var i=this._getParamsFromOptions(n,e),a=v[i.FORMAT];return this[t]({url:r,params:i,mime_type:a})}return Promise.resolve({layers:!1})},t.exports=i},{"core/g3wobject":12,"core/utils/utils":68,"store/application-state":373,"store/projects":379}],61:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.catalog_tab=e.toc_tab_default||e._catalog_tab||"layers",e.ows_method=e.ows_method||"GET",e.toc_layers_init_status=e.toc_layers_init_status||s.TOC_LAYERS_INIT_STATUS,e.toc_themes_init_status=e.toc_themes_init_status||s.TOC_THEMES_INIT_STATUS,e.query_point_tolerance=e.query_point_tolerance||s.QUERY_POINT_TOLERANCE,this.state=e;var t=this.getType(),r=this.getId(),n=this.getVectorUrl();this.urls={map_themes:"/"+t+"/api/prjtheme/"+r+"/",expression_eval:"/api/expression_eval/"+r+"/",vector_data:n+"data/"+t+"/"+r+"/",featurecount:n+"featurecount/"+t+"/"+r+"/"},this._processLayers(),this.state.crs=m(this.state.crs),this._projection=w.get(this.state.crs),this._layersStore=this._buildLayersStore(),this.setters={setBaseLayer:function(e){var t=this;this.state.baselayers.forEach(function(r){t._layersStore.getLayerById(r.id).setVisible(r.id===e),r.visible=r.id===e})}},this.setSearchEndPoint(),p(this)}var s=e("app/constant"),l=e("store/application-state"),u=n(l),c=e("services/application"),d=n(c),f=e("core/utils/utils"),p=f.base,h=f.inherit,v=f.XHR,g=e("core/utils/geo"),m=g.crsToCrsObject,y=e("core/g3wobject"),_=e("core/layers/layerfactory"),b=e("core/layers/layersstore"),w=e("g3w-ol/projection/projections");h(o,y);var x=o.prototype;x.getSearchEndPoint=function(){return this.state.search_endpoint},x.setSearchEndPoint=function(){var e=this;(this.state.search||[]).forEach(function(t){return t.search_endpoint=e.state.search_endpoint})},x.getAliasUrl=function(){return this.state.aliasUrl},x.getActiveCatalogTab=function(){return this.state.catalog_tab},x.setActiveCatalogTab=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"layers";this.state.catalog_tab=e},x.isWmsUseLayerIds=function(){return this.state.wms_use_layer_ids},x.getContextBaseLegend=function(){return this.state.context_base_legend},x.getQueryPointTolerance=function(){return this.state.query_point_tolerance},x.getQueryFeatureCount=function(){return this.state.feature_count||5},x.isQueryMultiLayers=function(e){return this.state.querymultilayers&&-1!==this.state.querymultilayers.indexOf(e)},x.getRelations=function(){return this.state.relations},x.getRelationById=function(e){return this.state.relations.find(function(t){return t.id===e})},x.getRelationsByLayerId=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layerId,r=e.type;return this.state.relations.filter(function(e){return e.referencedLayer===t&&(!r||e.type===r)})},x.getOwsMethod=function(){return this.state.ows_method},x._processLayers=function(){var e=this,t=function o(t){for(var r=function(r){var n=t[r],i=void 0;void 0!==n.id&&e.state.layers.forEach(function(t){if(i=t.name,n.id===t.id)return n.name=t.name,t.wmsUrl=e.getWmsUrl(),t.project=e,n[r]=Object.assign(t,n),!1}),Array.isArray(n.nodes)&&(n.title=n.name,o(n.nodes))},n=0;n<t.length;n++)r(n)};t(this.state.layerstree);var r=d["default"].getBaseLayerId();this.state.baselayers=this.state.baselayers.filter(function(e){return"Bing"!==e.servertype||u["default"].keys.vendorkeys.bing});for(var n=0;n<this.state.baselayers.length;n++){var i=this.state.baselayers[n],a=null!==r?r:this.state.initbaselayer;i.visible=a&&i.id===a||!!i.fixed,i.baselayer=!0}},x._buildLayersStore=function(){var e=this,t=new b,r=this.state.overviewprojectgid?this.state.overviewprojectgid.gid:null;t.setOptions({id:this.state.gid,projection:this._projection,extent:this.state.extent,initextent:this.state.initextent,wmsUrl:this.state.WMSUrl,catalog:this.state.gid!==r});var n=this.getLayers();return n.forEach(function(r){r.crs=m(r.crs),r.projection=r.crs?w.get(r.crs):e._projection,r.ows_method=e.getOwsMethod(),r.wms_use_layer_ids=e.state.wms_use_layer_ids;
var n=_.build(r,{project:e});n&&t.addLayer(n)}),t.createLayersTree(this.state.name,{layerstree:this.state.layerstree,expanded:"not_collapsed"===this.state.toc_layers_init_status}),t},x.getLayerById=function(e){return this._layersStore.getLayerById(e)},x.getLayers=function(){return[].concat(a(this.state.layers),a(this.state.baselayers))},x.getBaseLayers=function(){return this.state.baselayers},x.getConfigLayers=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.key;return t?this.state.layers.filter(function(e){return void 0!==e[t]}):this.state.layers},x.setLegendPosition=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"tab";this.state.legend_position=e},x.getLegendPosition=function(){return this.state.legend_position},x.getThumbnail=function(){return this.state.thumbnail},x.getMetadata=function(){return this.state.metadata||{}},x.getState=function(){return this.state},x.getPrint=function(){return this.state.print||[]},x.getSearches=function(){return this.state.search||[]},x.getVectorUrl=function(){return this.state.vectorurl},x.getRasterUrl=function(){return this.state.rasterurl},x.getId=function(){return this.state.id},x.getType=function(){return this.state.type},x.getGid=function(){return this.state.gid},x.getName=function(){return this.state.name},x.getOverviewProjectGid=function(){return this.state.overviewprojectgid?this.state.overviewprojectgid.gid:null},x.getCrs=function(){return this._projection.getCode()},x.getQgisVersion=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=["major","minor","patch"].indexOf(t);return-1===r?this.state.qgis_version:+this.state.qgis_version.split(".")[r]},x.getProjection=function(){return this._projection},x.getWmsUrl=function(){return this.state.WMSUrl},x.getInfoFormat=function(){return"application/vnd.ogc.gml"},x.getLayersStore=function(){return this._layersStore},x.setLayersTreePropertiesFromMapTheme=function(){var e=i(regeneratorRuntime.mark(function t(e){var r,n,i,a,o,s,l=this,u=e.map_theme,c=e.layerstree,d=void 0===c?this.state.layerstree:c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMapThemeFromThemeName(u);case 2:return r=e.sent,n=r.layerstree,i={layers:{}},a=[],o=[],s=function t(e,n,s){e.forEach(function(e,u){if(e.nodes)o.push({node:e,group:n[u]}),t(e.nodes,n[u].nodes,s&&e.checked);else if(e.style=r.styles[e.id],n[u].checked!==e.visible&&(i.layers[e.id]={visibility:!0,style:!1}),n[u].checked=e.visible,e.style){var c=new Promise(function(t,r){var n=function(e){void 0===i.layers[e.id]&&(i.layers[e.id]={visibility:!1,style:!1}),i.layers[e.id].style=l.getLayerById(e.id).setCurrentStyle(e.style),t()};l.getLayersStore()&&n(e)});a.push(c)}})},s(n,d),e.next=11,Promise.allSettled(a);case 11:return o.forEach(function(e){var t=e.group,r=e.node,n=r.checked,i=r.expanded;t.checked=n,t.expanded=i}),e.abrupt("return",i);case 13:case"end":return e.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),x.getMapThemeFromThemeName=function(){var e=i(regeneratorRuntime.mark(function t(e){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.state.map_themes.find(function(t){return t.theme===e}),!r||void 0!==r.layerstree){t.next=5;break}return t.next=4,this.getMapThemeConfiguration(e);case 4:r.layerstree=t.sent;case 5:return t.abrupt("return",r);case 6:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),x.getMapThemeConfiguration=function(){var e=i(regeneratorRuntime.mark(function t(e){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,v.get({url:""+this.urls.map_themes+e+"/"});case 3:if(r=t.sent,!r.result){t.next=6;break}return t.abrupt("return",r.data);case 6:t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0);case 11:case"end":return t.stop()}},t,this,[[0,8]])}));return function(t){return e.apply(this,arguments)}}(),x.getUrl=function(e){return this.urls[e]},x.getSpatialBookmarks=function(){return this.state.bookmarks||[]},x.getMessages=function(){return this.state.messages},t.exports=o},{"app/constant":4,"core/g3wobject":12,"core/layers/layerfactory":35,"core/layers/layersstore":36,"core/utils/geo":64,"core/utils/utils":68,"g3w-ol/projection/projections":111,"services/application":351,"store/application-state":373}],62:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Date.now(),r=e.id||"id_"+t,n=e.name||"name_"+t,i=e.origname||"origname_"+t;this.state={id:r,name:n,origname:i,father:e.referencedLayer,child:e.referencingLayer,fatherField:e.fieldRef.referencedField,childField:e.fieldRef.referencingField,type:e.type,loading:!1},a(this)}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("core/g3wobject");o(n,s);var l=n.prototype;l.getId=function(){return this.state.id},l.setId=function(e){this.state.id=e},l.getName=function(){return this.state.name},l.setName=function(e){this.state.name=e},l.getTitle=function(){return this.state.title},l.setTitle=function(e){return this.state.title=e},l.getChild=function(){return this.state.child},l.getFather=function(){return this.state.father},l.getState=function(){return this.state},l.getType=function(){return this.state.type},l.getFields=function(){return{father:this.state.fatherField,child:this.state.childField}},l.getFatherField=function(){return this.state.fatherField},l.getChildField=function(){return this.state.childField},l.setLoading=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state.loading=e},l.isLoading=function(){return this.state.loading},t.exports=n},{"core/g3wobject":12,"core/utils/utils":68}],63:[function(e,t,r){function n(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.relations;this._relations={},this._length=r?r.length:0,this._relationsInfo={children:{},fathers:{},father_child:{}};var n=void 0;r.forEach(function(t){n=new u(t),e._relations[n.getId()]=n}),this._createRelationsInfo(),o(this)}var i=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=e("core/utils/utils"),o=a.base,s=a.inherit,l=e("core/g3wobject"),u=e("core/relations/relation");s(n,l);var c=n.prototype;c._createRelationsInfo=function(){var e=this,t=void 0,r=void 0;Object.entries(this._relations).forEach(function(n){var a=i(n,2),o=a[0],s=a[1];t=s.getFather(),r=s.getChild(),e._relationsInfo.father_child[t+r]=o,e._relationsInfo.fathers[t]||(e._relationsInfo.fathers[t]=[]),e._relationsInfo.children[r]||(e._relationsInfo.children[r]=[]),e._relationsInfo.fathers[t].push(r),e._relationsInfo.children[r].push(t)})},c._clearRelationsInfo=function(){this._relationsInfo={children:{},fathers:{},father_children:{}}},c._reloadRelationsInfo=function(){this._clearRelationsInfo(),this._createRelationsInfo()},c.getLength=function(){return this._length},c.getRelations=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=void 0===t?null:t;if(r){if(["ONE","MANY"].indexOf(r)!==-1){var n={};for(var i in this._relations){var a=this._relations[i];a.getType()===r&&(n[i]=a)}return n}return{}}return this._relations},c.getArray=function(){var e=[];return Object.entries(this._relations).forEach(function(t){var r=i(t,2),n=(r[0],r[1]);e.push(n)}),e},c.setRelations=function(e){this._relations=Array.isArray(e)?e:[]},c.getRelationById=function(e){return this._relations[e]},c.getRelationByFatherChildren=function(e,t){var r=this._relationsInfo.father_child[e+t];return this.getRelationById(r)},c.addRelation=function(e){e instanceof u&&(this._relations[e.getId()]=e,this._reloadRelationsInfo())},c.removeRelation=function(e){var t=void 0;e instanceof u&&(t=e.getId(),delete this._relations[t],this._reloadRelationsInfo())},c.hasChildren=function(e){var t=this.getChildren(e);return!!t&&!!t.length},c.hasFathers=function(e){var t=this.getFathers(e);return!!t&&!!t.length},c.getChildren=function(e){return this.isFather(e)?this._relationsInfo.fathers[e]:null},c.getFathers=function(e){return this.isChild(e)?this._relationsInfo.children[e]:null},c.isChild=function(e){return!!this._relationsInfo.children[e]},c.isFather=function(e){return!!this._relationsInfo.fathers[e]},t.exports=n},{"core/g3wobject":12,"core/relations/relation":62,"core/utils/utils":68}],64:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=e("app/constant"),u=n(l),c=e("store/map-layers"),d=n(c),f=e("services/gui"),p=n(f),h=e("core/utils/utils"),v=h.toRawType,g=h.uniqueId,m=e("core/layers/map/wmslayer"),y=e("core/layers/filter/filter"),b=e("core/utils/parsers"),w=b.response,x=u["default"].GEOMETRY_FIELDS,S=u["default"].QUERY_POINT_TOLERANCE,L=u["default"].G3W_FID,C=u["default"].GEOMETRY_TYPES,k={GeometryTypes:C,removeZValueToOLFeatureGeometry:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.feature,r=t.getGeometry();if(r){var n=r.getType(),i=r.getCoordinates();switch(n){case C.POINT:3===i.length&&(i.splice(2),t.getGeometry().setCoordinates(i));break;case C.MULTIPOINT:case C.LINESTRING:case C.LINE:i.forEach(function(e){return e.splice(2)}),t.getGeometry().setCoordinates(i);break;case C.MULTILINESTRING:case C.MULTILINE:i.forEach(function(e){e.forEach(function(e){return e.splice(2)})}),t.getGeometry().setCoordinates(i);break;case C.POLYGON:i[0].forEach(function(e){return e.splice(2)}),t.getGeometry().setCoordinates(i);break;case C.MULTIPOLYGON:i.forEach(function(e){e[0].forEach(function(e){return e.splice(2)})}),t.getGeometry().setCoordinates(i)}}return t},addZValueToOLFeatureGeometry:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.feature,r=e.geometryType,n=t.getGeometry();r=r||n.getType();var i=n.getCoordinates();switch(r){case C.POINTZ:case C.POINTM:case C.POINTZM:case C.POINT25D:i.push(0),t.getGeometry().setCoordinates(i);break;case C.MULTIPOINTZ:case C.MULTIPOINTM:case C.MULTIPOINTZM:case C.MULTIPOINT25D:case C.LINESTRINGZ:case C.LINESTRINGM:case C.LINESTRINGZM:case C.LINESTRING25D:case C.LINEZ:case C.LINEM:case C.LINEZM:case C.LINE25D:i.forEach(function(e){return e.push(0)}),t.getGeometry().setCoordinates(i);break;case C.MULTILINESTRINGZ:case C.MULTILINESTRINGM:case C.MULTILINESTRINGZM:case C.MULTILINESTRING25D:case C.MULTILINEZ:case C.MULTILINEM:case C.MULTILINEZM:case C.MULTILINE25D:i.forEach(function(e){e.forEach(function(e){return e.push(0)})}),t.getGeometry().setCoordinates(i);break;case C.POLYGONZ:case C.POLYGONM:case C.POLYGONZM:case C.POLYGON25D:i[0].forEach(function(e){return e.push(0)}),t.getGeometry().setCoordinates(i);break;case C.MULTIPOLYGONZ:case C.MULTIPOLYGONM:case C.MULTIPOLYGOZM:case C.MULTIPOLYGON25D:i.forEach(function(e){e[0].forEach(function(e){return e.push(0)})}),t.getGeometry().setCoordinates(i)}return t},getOLGeometry:function(e){switch(e){case C.LINESTRINGZ:case C.LINESTRINGM:case C.LINESTRINGZM:case C.LINESTRING25D:case C.LINE:case C.LINEZ:case C.LINEM:case C.LINEZM:case C.LINE25D:e="LineString";break;case C.MULTILINESTRINGZ:case C.MULTILINESTRINGM:case C.MULTILINESTRINGZM:case C.MULTILINESTRING25D:case C.MULTILINE:case C.MULTILINEZ:case C.MULTILINEM:case C.MULTILINEZM:case C.MULTILINE25D:e="MultiLineString";break;case C.POINTZ:case C.POINTM:case C.POINTZM:case C.POINT25D:e="Point";break;case C.MULTIPOINTZ:case C.MULTIPOINTM:case C.MULTIPOINTZM:case C.MULTIPOINT25D:e="MultiPoint";break;case C.POLYGONZ:case C.POLYGONM:case C.POLYGONZM:case C.POLYGON25D:e="Polygon";break;case C.MULTIPOLYGONZ:case C.MULTIPOLYGONM:case C.MULTIPOLYGONZM:case C.MULTIPOLYGON25D:e="MultiPolygon"}return e},isMultiGeometry:function(e){return[C.MULTIPOINT,C.MULTIPOINTZ,C.MULTIPOINTZM,C.MULTIPOINTM,C.MULTIPOINT25D,C.MULTILINESTRING,C.MULTILINESTRINGZ,C.MULTILINESTRINGM,C.MULTILINESTRINGZM,C.MULTILINESTRING25D,C.MULTILINE,C.MULTILINEZ,C.MULTILINEM,C.MULTILINEZM,C.MULTILINE25D,C.MULTIPOLYGON,C.MULTIPOLYGONZ,C.MULTIPOLYGONM,C.MULTIPOLYGONZM,C.MULTIPOLYGON25D].indexOf(e)!==-1},getAllPointGeometryTypes:function(){return[C.POINT,C.POINTZ,C.POINTM,C.POINTZM,C.POINT25D,C.MULTIPOINT,C.MULTIPOINTZ,C.MULTIPOINTM,C.MULTIPOINTZM,C.MULTIPOINT25D]},isPointGeometryType:function(e){return k.getAllPointGeometryTypes().indexOf(e)!==-1},getAllLineGeometryTypes:function(){return[C.LINESTRING,C.LINESTRINGZ,C.LINESTRINGM,C.LINESTRINGZM,C.LINESTRING25D,C.MULTILINESTRING,C.MULTILINESTRINGZ,C.MULTILINESTRINGM,C.MULTILINESTRINGZM,C.MULTILINESTRING25D,C.LINE,C.LINEZ,C.LINEM,C.LINEZM,C.LINE25D,C.MULTILINE,C.MULTILINEZ,C.MULTILINEM,C.MULTILINEZM,C.MULTILINE25D]},isLineGeometryType:function(e){return k.getAllLineGeometryTypes().indexOf(e)!==-1},getAllPolygonGeometryTypes:function(){return[C.POLYGON,C.POLYGONZ,C.POLYGONM,C.POLYGONZM,C.POLYGON25D,C.MULTIPOLYGON,C.MULTIPOLYGONZ,C.MULTIPOLYGONM,C.MULTIPOLYGONZM,C.MULTIPOLYGON25D]},isPolygonGeometryType:function(e){return k.getAllPolygonGeometryTypes().indexOf(e)!==-1},is3DGeometry:function(e){return[C.POINTZ,C.POINTM,C.POINTZM,C.POINT25D,C.LINESTRINGZ,C.LINESTRINGM,C.LINESTRINGZM,C.LINESTRING25D,C.MULTILINESTRINGZ,C.MULTILINESTRINGM,C.MULTILINESTRINGZM,C.MULTILINESTRING25D,C.LINEZ,C.LINEM,C.LINEZM,C.LINE25D,C.MULTILINEZ,C.MULTILINEM,C.MULTILINEZM,C.MULTILINE25D,C.POLYGONZ,C.POLYGONM,C.POLYGONZM,C.POLYGON25D,C.MULTIPOLYGONZ,C.MULTIPOLYGONM,C.MULTIPOLYGONZM,C.MULTIPOLYGON25D].find(function(t){return t===e})}},E={geometryFields:x,coordinatesToGeometry:function(e,t){var r=void 0;switch(e){case C.POLYGON:case C.POLYGONZ:case C.POLYGONM:case C.POLYGONZM:case C.POLYGON25D:r=ol.geom.Polygon;break;case C.MULTIPOLYGON:case C.MULTIPOLYGONZ:case C.MULTIPOLYGONM:case C.MULTIPOLYGONZM:case C.MULTIPOLYGON25D:r=ol.geom.MultiPolygon;break;case C.LINESTRING:case C.LINESTRINGZ:case C.LINESTRINGM:case C.LINESTRINGZM:case C.LINESTRING25D:case C.LINE:case C.LINEZ:case C.LINEM:case C.LINEZM:case C.LINE25D:r=ol.geom.LineString;break;case C.MULTILINE:case C.MULTILINEZ:case C.MULTILINEM:case C.MULTILINEZM:case C.MULTILINE25D:case C.MULTILINESTRING:case C.MULTILINESTRINGZ:case C.MULTILINESTRINGM:case C.MULTILINESTRINGZM:case C.MULTILINESTRING25D:r=ol.geom.MultiLineString;break;case C.POINT:case C.POINTZ:case C.POINTM:case C.POINTZM:case C.POINT25D:r=ol.geom.Point;break;case C.MULTIPOINT:case C.MULTIPOINTZ:case C.MULTIPOINTM:case C.MULTIPOINTZM:case C.MULTIPOINT25D:r=ol.geom.MultiPoint;break;default:r=ol.geom.Point}var n=new r(t);return n},getDefaultLayerStyle:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.color;switch(e){case C.LINESTRINGZ:case C.LINESTRINGM:case C.LINESTRINGZM:case C.LINESTRING25D:case C.LINE:case C.LINEZ:case C.LINEM:case C.LINEZM:case C.LINE25D:e="LineString";break;case C.MULTILINESTRINGZ:case C.MULTILINESTRINGM:case C.MULTILINESTRINGZM:case C.MULTILINESTRING25D:case C.MULTILINE:case C.MULTILINEZ:case C.MULTILINEM:case C.MULTILINEZM:case C.MULTILINE25D:e="MultiLineString";break;case C.POINTZ:case C.POINTM:case C.POINTZM:case C.POINT25D:e="Point";break;case C.MULTIPOINTZ:case C.MULTIPOINTM:case C.MULTIPOINTZM:case C.MULTIPOINT25D:e="MultiPoint";break;case C.POLYGONZ:case C.POLYGONM:case C.POLYGONZM:case C.POLYGON25D:e="Polygon";break;case C.MULTIPOLYGONZ:case C.MULTIPOLYGONM:case C.MULTIPOLYGONZM:case C.MULTIPOLYGON25D:e="MultiPolygon"}var n={Point:new ol.style.Style({image:new ol.style.Circle({fill:new ol.style.Fill({color:r}),radius:5,stroke:new ol.style.Stroke({color:r,width:1})})}),LineString:new ol.style.Style({stroke:new ol.style.Stroke({color:r,width:3})}),Polygon:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255,255,255,0.5)"}),stroke:new ol.style.Stroke({color:r,width:3})}),MultiPoint:new ol.style.Style({image:new ol.style.Circle({fill:new ol.style.Fill({color:r}),radius:5,stroke:new ol.style.Stroke({color:r,width:1})})}),MultiLineString:new ol.style.Style({stroke:new ol.style.Stroke({color:r,width:3})}),MultiPolygon:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255,255,255,0.5)"}),stroke:new ol.style.Stroke({color:r,width:3})})};return n[e]},createLayerStyle:function(e){var t=void 0,r={};return e&&(Object.entries(e).forEach(function(e){var t=s(e,2),n=t[0],i=t[1];switch(n){case"point":i.icon&&(r.image=new ol.style.Icon({src:i.icon.url,imageSize:i.icon.width}));break;case"line":r.stroke=new ol.style.Stroke({color:i.color,width:i.width});break;case"polygon":r.fill=new ol.style.Fill({color:i.color})}}),t=new ol.style.Style(r)),t},createFeatureFromCoordinates:function(e){var t=void 0;if(Array.isArray(e)&&2===e.length){var r=new ol.geom.Point(e);t=new ol.Feature(r)}return t},createFeatureFromBBOX:function(e){var t=void 0;if(Array.isArray(e)&&4===e.length){var r=ol.geom.Polygon.fromExtent(e);t=new ol.Feature(r)}return t},createFeatureFromGeometry:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.geometry;if(r){var n=new ol.Feature(r);return n.setId(t),n}},createFeatureFromFeatureObject:function(e){var t=e.id,r=e.feature,n=void 0===r?{}:r,i=n,a=i.geometry,o=i.attributes;return n=E.createFeatureFromGeometry({id:t,geometry:a}),Object.keys(o).forEach(function(e){return n.set(e,o[e])}),n},createOlLayer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.features,n=e.geometryType,i=e.color,a=e.style,o=e.source||new ol.source.Vector({features:r||new ol.Collection}),s=new ol.layer.Vector({id:t,source:o});if(!a)switch(n){case C.POINT:case C.POINTZ:case C.POINTM:case C.POINTZM:case C.POINT25D:case C.MULTIPOINT:case C.MULTIPOINTZ:case C.MULTIPOINTM:case C.MULTIPOINTZM:case C.MULTIPOINT25D:a=new ol.style.Style({image:new ol.style.Circle({radius:5,fill:new ol.style.Fill({color:i})})});break;case C.LINESTRING:case C.LINESTRINGZ:case C.LINESTRINGM:case C.LINESTRINGZM:case C.LINESTRING25D:case C.MULTILINESTRING:case C.MULTILINESTRINGZ:case C.MULTILINESTRINGM:case C.MULTILINESTRINGZM:case C.MULTILINESTRING25D:case C.LINE:case C.LINEZ:case C.LINEM:case C.LINEZM:case C.LINE25D:case C.MULTILINE:case C.MULTILINEZ:case C.MULTILINEM:case C.MULTILINEZM:case C.MULTILINE25D:a=new ol.style.Style({stroke:new ol.style.Stroke({width:3,color:i})});break;case C.POLYGON:case C.POLYGONZ:case C.POLYGONM:case C.POLYGONZM:case C.POLYGON25D:case C.MULTIPOLYGON:case C.MULTIPOLYGONZ:case C.MULTIPOLYGONM:case C.MULTIPOLYGONZM:case C.MULTIPOLYGON25D:a=new ol.style.Style({stroke:new ol.style.Stroke({color:"#000000",width:1}),fill:new ol.style.Fill({color:i})}),s.setOpacity(.6)}return s.setStyle(a),s},createWMSLayer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.name,n=e.projection,i=e.layers,a=void 0===i?[]:i,o=r||g();r=r||o;var s=new m({id:o,layers:a,projection:n,url:t}),l=s.getOLLayer();return l.set("id",o),l.set("name",r),{wmslayer:s,olLayer:l}},createVectorLayerFromGeometry:function(e){var t=new ol.Feature(e);return E.createVectorLayerFromFeatures(t)},createVectorLayerFromFeatures:function(e){return new ol.layer.Vector({source:new ol.source.Vector({features:Array.isArray(e)?e:[e]})})},createVectorLayerFromFile:function(){function e(){return t.apply(this,arguments)}var t=a(regeneratorRuntime.mark(function r(){var e,t,n,i,o,s,l,u,c,d,f,h,v,m=this,y=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_=y.name,b=y.type,w=y.crs,S=y.mapCrs,L=y.data,C=y.style;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:e=void 0,t=void 0,n=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:w,n=void 0,i=e.readFeatures(t,{dataProjection:r,featureProjection:S||r});if(i.length){e instanceof ol.format.KML&&i.forEach(function(e){return e.unset("styleUrl")});var a=new ol.source.Vector({features:i});n=new ol.layer.Vector({source:a,name:_,_fields:Object.keys(i[0].getProperties()).filter(function(e){return x.indexOf(e)<0}),id:g()}),C&&n.setStyle(C)}return n},r.t0=b,r.next="gpx"===r.t0?6:"gml"===r.t0?9:"geojson"===r.t0?12:"kml"===r.t0?15:"csv"===r.t0?18:"kmz"===r.t0?28:"zip"===r.t0?39:50;break;case 6:return e=new ol.format.GPX,t=n(e,L),r.abrupt("break",50);case 9:return e=new ol.format.WMSGetFeatureInfo,t=n(e,L),r.abrupt("break",50);case 12:return e=new ol.format.GeoJSON,t=n(e,L),r.abrupt("break",50);case 15:return e=new ol.format.KML({extractStyles:!1}),t=n(e,L,"EPSG:4326"),r.abrupt("break",50);case 18:if(i=L,o=i.headers,s=i.separator,l=i.values,u=i.x,c=i.y,d=[],f=[],l.forEach(function(e,t){var r={},n=e.split(s);if(n.length===o.length){var i=[];if(n.forEach(function(e,t){var n=o[t];n===u&&(i[0]=1*e),n===c&&(i[1]=1*e),r[n]=e}),void 0===i.find(function(e){return Number.isNaN(e)})){var a=new ol.geom.Point(i);w!==S&&a.transform(w,S);var p=new ol.Feature(a);p.setId(t),p.setProperties(r),d.push(p)}}else f.push({row:t+1,value:l[t]})}),d.length){r.next=24;break}return r.abrupt("return",Promise.reject());case 24:return f.length&&p["default"].showUserMessage({type:"warning",message:"sdk.mapcontrols.addlayer.messages.csv.warning",hooks:{footer:{template:'<select v-select2="errorrows[0].value" class="skin-color" :search="false" style="width:100%">\n                    <option v-for="errorrow in errorrows" :key="errorrow.row" :value="errorrow.value">[{{ errorrow.row}}] {{errorrow.value}}</option>\n                </select>',data:function(){return{errorrows:f}}}},autoclose:!1}),t=new ol.layer.Vector({source:new ol.source.Vector({features:d}),name:_,_fields:o,id:g()}),C&&t.setStyle(C),r.abrupt("break",50);case 28:return h=new Promise(function(){var e=a(regeneratorRuntime.mark(function t(e,r){var i,a,o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=new JSZip,t.next=3,L.arrayBuffer(L);case 3:a=t.sent,i.load(a),o=i.file(/.kml$/i),s=o[o.length-1],s?(L=s.asText(),e(n(new ol.format.KML({extractStyles:!1}),L,"EPSG:4326"))):r();case 8:case"end":return t.stop()}},t,m)}));return function(t,r){return e.apply(this,arguments)}}()),r.prev=29,r.next=32,h;case 32:return r.abrupt("return",r.sent);case 35:return r.prev=35,r.t1=r["catch"](29),r.abrupt("return",Promise.reject());case 38:return r.abrupt("break",50);case 39:return v=new Promise(function(){var t=a(regeneratorRuntime.mark(function r(t,i){var a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,L.arrayBuffer(L);case 2:a=r.sent,shp(a).then(function(r){var i=JSON.stringify(r);e=new ol.format.GeoJSON({}),t(n(e,i,"EPSG:4326"))})["catch"](function(e){return i(e)});case 4:case"end":return r.stop()}},r,m)}));return function(e,r){return t.apply(this,arguments)}}()),r.prev=40,r.next=43,v;case 43:return r.abrupt("return",r.sent);case 46:return r.prev=46,r.t2=r["catch"](40),r.abrupt("return",Promise.reject());case 49:return r.abrupt("break",50);case 50:return r.abrupt("return",t);case 51:case"end":return r.stop()}},r,this,[[29,35],[40,46]])}));return e}(),createStyleFunctionToVectorLayer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=function(t,r){var n=e.color,i=e.field;n=n.rgba?"rgba("+n.rgba.r+","+n.rgba.g+","+n.rgba.b+","+n.rgba.a+")":n;var a=t.getGeometry().getType(),o=E.getDefaultLayerStyle(a,{color:n});return i&&o.setText(new ol.style.Text({text:""+t.get(i),font:"bold",scale:2,offsetY:15,fill:new ol.style.Fill({color:n}),stroke:new ol.style.Stroke({color:"#FFFFFF",width:2})})),o};return t._g3w_options=e,t},createSelectedStyle:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.geometryType,r=e.color,n=void 0===r?"rgb(255,255,0)":r,i=e.fill,a=void 0===i||i,o=null;if("LineString"===t||"MultiLineString"===t)o=new ol.style.Style({stroke:new ol.style.Stroke({color:n,width:4})});else if("Point"===t||"MultiPoint"===t)o=new ol.style.Style({image:new ol.style.Circle({radius:6,stroke:!a&&new ol.style.Stroke({color:n,width:4}),fill:a&&new ol.style.Fill({color:n})}),zIndex:1/0});else if("MultiPolygon"===t||"Polygon"===t){var s=ol.color.asArray(n);s.splice(3,1,.5),o=new ol.style.Style({stroke:new ol.style.Stroke({color:n,width:4}),fill:a&&new ol.style.Fill({color:ol.color.asString(s)})})}return o},getAlphanumericPropertiesFromFeature:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e=Array.isArray(e)?e:Object.keys(e),e.filter(function(e){return x.indexOf(e)===-1})},getFormDataExpressionRequestFromFeature:function(e){delete e.attributes.geometry;var t=new ol.Feature(e.geometry),r={};return E.getAlphanumericPropertiesFromFeature(e.attributes).forEach(function(t){t!==L&&(r[t]=e.attributes[t])}),t.setProperties(r),t.setId(e.attributes[L]),E.convertFeatureToGEOJSON(t)},convertFeatureToGEOJSON:function(e){var t=new ol.format.GeoJSON;return t.writeFeatureObject(e)},getQueryLayersPromisesByBBOX:function(e,t){var r=t.bbox,n=t.filterConfig,i=void 0===n?{}:n,a=t.feature_count,o=void 0===a?10:a,s=t.multilayers,l=void 0!==s&&s,u=void 0,c=ol.geom.Polygon.fromExtent(r),d=p["default"].getComponent("map").getService().getMap(),f=d.getView().getProjection();if(l)u=E.getQueryLayersPromisesByGeometry(e,{geometry:c,feature_count:o,filterConfig:i,multilayers:l,projection:f});else{var h=$.Deferred(),v=f.getCode();u=h.promise();var g=[],m=[],_=e.length;e.forEach(function(t){var r=new y(i),n=t.getProjection().getCode();r.setGeometry(v===n?c:c.clone().transform(v,n)),t.query({filter:r,feature_count:o}).then(function(e){g.push(e)}).fail(function(e){return m.push(e)}).always(function(){_-=1,0===_&&(m.length===e.length?h.reject(m):h.resolve(g))})})}return u},getQueryLayersPromisesByGeometry:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.multilayers,n=void 0!==r&&r,i=t.geometry,a=t.filterConfig,o=void 0===a?{}:a,s=t.projection,l=t.feature_count,u=void 0===l?10:l,c=$.Deferred(),d=[],f=[],p=s.getCode(),h=new y(o);if(n)!function(){e.length||c.resolve([]);var t=_.groupBy(e,function(e){return e.getMultiLayerId()+"_"+e.getProjection().getCode()}),r=Object.keys(t).length,n=r;for(var a in t){var o=t[a],s=o,l=t[a][0],v=l.getProvider("filter"),g=l.getProjection().getCode();h.setGeometry(p===g?i:i.clone().transform(p,g)),v.query({filter:h,layers:s,feature_count:u}).then(function(e){return d.push(e)}).fail(function(e){return f.push(e)}).always(function(){n-=1,0===n&&(f.length===r?c.reject(f):c.resolve(d))})}}();else if(0===e.length)c.resolve([]);else{var v=e.length;e.forEach(function(t){var r=t.getProjection().getCode();h.setGeometry(p===r?i:i.clone().transform(p,r)),t.query({filter:h,filterConfig:o,feature_count:u}).then(function(e){return d.push(e)}).fail(function(e){return f.push(e)}).always(function(){v-=1,0===v&&(f.length===e.length?c.reject(f):c.resolve(d))})})}return c.promise()},getQueryLayersPromisesByCoordinates:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.coordinates,n=t.feature_count,i=void 0===n?10:n,a=t.query_point_tolerance,o=void 0===a?S:a,s=t.multilayers,l=void 0!==s&&s,u=t.reproject,c=void 0===u||u,d=$.Deferred();if(!e.length)return d.resolve(e);var f=p["default"].getComponent("map").getService().getMap(),h=f.getSize(),v=[],g=[],m=f.getView().getProjection(),y=f.getView().getResolution();if(l)!function(){var t={};e.forEach(function(e){var r=e.getInfoFormat()+":"+e.getInfoUrl()+":"+e.getMultiLayerId();t[r]?t[r].push(e):t[r]=[e]});var n=Object.keys(t).length,a=n;for(var s in t){var l=t[s],u=l,f=t[s][0],p=f.getProvider("query");p.query({feature_count:i,coordinates:r,query_point_tolerance:o,mapProjection:m,reproject:c,resolution:y,size:h,layers:u}).then(function(e){return v.push(e)}).fail(function(e){return g.push(e)}).always(function(){a-=1,0===a&&(g.length===n?d.reject(g):d.resolve(v))})}}();else{var _=e.length,b=0;e.forEach(function(t){t.query({feature_count:i,coordinates:r,query_point_tolerance:o,mapProjection:m,size:h,resolution:y}).then(function(e){v.push(e)}).fail(function(e){b+=1,g.push(e)}).always(function(){_-=1,0===_&&(b<e.length?d.resolve(v):d.reject(g))})})}return d.promise()},transformBBOX:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.bbox,r=e.sourceCrs,n=e.destinationCrs,a=new ol.geom.Point([t[0],t[1]]),o=new ol.geom.Point([t[2],t[3]]);return a.transform(r,n),o.transform(r,n),[].concat(i(a.getCoordinates()),i(o.getCoordinates()))},parseQueryLayersPromiseResponses:function(e){var t={query:e[0]?e[0].query:null,data:[]};return e.forEach(function(e){e.data&&e.data.forEach(function(e){t.data.push(e)})}),t},getMapLayerById:function(e){return d["default"].getLayerById(e)},getMapLayersByFilter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=o({GEOLAYER:!0},e);var r=[];return d["default"].getQuerableLayersStores().forEach(function(n){r=n.getLayers(e,t)}),r||[]},areCoordinatesEqual:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e[0]===t[0]&&e[1]===t[1]},getFeaturesFromResponseVectorApi:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.type,n=void 0===r?"vector":r;if(!e.result)return null;var i=e.vector.data.features||[];switch(n){case"result":return E.covertVectorFeaturesToResultFeatures(i);case"vector":default:return i}},covertVectorFeaturesToResultFeatures:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map(function(e){var t=e.id,r=e.properties,n=e.geometry;return r[L]=t,{geometry:n,attributes:r,id:t}})},splitGeometryLine:function(e,t){var r=void 0!==t.getCoordinates()[0][2],n=!1,a=[],o=new jsts.io.WKTReader,s=new ol.format.WKT,l=new jsts.io.OL3Parser,u=o.read(s.writeGeometry(e)),c=s.writeGeometry(t);r&&(c=c.replace(" Z",""));for(var d=o.read(c),f=d.getCoordinates(),p=f.length,h=new jsts.geom.GeometryFactory,v=[],g=void 0,m=void 0,y=0;y<p-1;y++){m=f[y],g=f[y+1],r&&(m.z=t.getCoordinates()[y][2],g.z=t.getCoordinates()[y+1][2]);var _=h.createLineString([m,g]),b=_.intersection(u).getCoordinates();b.length?(n=!0,b.forEach(function(e){if(r&&(e.z=m.z),v.length){var t=l.write(h.createLineString(v.concat([m,e])));if(r){var n=t.getCoordinates();t.setCoordinates([[].concat(i(n[0]),[m.z]),[].concat(i(n[1]),[e.z])])}a.push(t),v=[]}else{var o=l.write(h.createLineString([m,e]));if(r){var s=o.getCoordinates();o.setCoordinates([[].concat(i(s[0]),[m.z]),[].concat(i(s[1]),[e.z])])}a.push(o)}m=e}),v=v.concat([m,g])):v=v.concat([m,g])}var w=l.write(h.createLineString(v));if(r){var x=[];v.forEach(function(e,t){var r=w.getCoordinates()[t];r.push(e.z),x.push(r)}),w.setCoordinates(x)}return a.push(w),n&&a||[]},splitFeatures:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.features,r=void 0===t?[]:t,n=e.splitfeature,i=[];
return r.forEach(function(e){var t=E.splitFeature({feature:e,splitfeature:n});t.length>1&&i.push({uid:e.getUid(),geometries:t})}),i},splitFeature:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.feature,r=e.splitfeature,n={feature:t.getGeometry(),split:r.getGeometry()},i=n.split.getType(),a=n.feature.getType(),o=[],s=new jsts.io.OL3Parser;switch(i){case"LineString":if(a.indexOf("Polygon")!==-1){var l=a.indexOf("Multi")!==-1,u=l?n.feature.getPolygons():n.feature;if(Array.isArray(u))u.forEach(function(e){E.splitFeature({splitfeature:r,feature:new ol.Feature({geometry:e})}).forEach(function(e){e&&o.push(new ol.geom.MultiPolygon([e.getCoordinates()]))})});else{var c=void 0!==u.getCoordinates()[0][0][2],d=s.read(u),f=s.read(u.getLinearRing(0)),p=s.read(n.split),h=void 0;if(u.getLinearRingCount()>1){for(var v=void 0,g=1;g<u.getLinearRingCount();g++){var m=s.read(u.getLinearRing(g));v=void 0===v?m:v.union(m)}h=new jsts.operation.polygonize.Polygonizer,h.add(v);var y=void 0;h.getPolygons().toArray().forEach(function(e){y=void 0===y?e:y.union(e)}),h=y}c&&(u.getCoordinates()[0].forEach(function(e,t){f.getCoordinates()[t].z=e[2]}),p.getCoordinates().forEach(function(e){return e.z=0}));var _=f.union(p),b=new jsts.operation.polygonize.Polygonizer;b.add(_);var w=b.getPolygons().toArray();w.length>1&&w.forEach(function(e){if(h&&(e=e.difference(h)),d.intersects(e.getInteriorPoint())){var t=s.write(e),r=e.getCoordinates();if(c&&r.forEach(function(e,t){e.z=void 0===e.z?r[0===t?t+1:t-1].z:e.z}),c){var n=[];t.getCoordinates()[0].forEach(function(e,t){e.push(r[t].z),n.push(e)}),t.setCoordinates([n])}var i=t.getType();l?o.push(new ol.geom.MultiPolygon("Polygon"===i?[t.getCoordinates()]:t.getCoordinates())):"Polygon"===i?o.push(t):t.getCoordinates().forEach(function(e){o.push(new ol.geom.Polygon(e))})}})}}else if(a.indexOf("LineString")!==-1){var x=a.indexOf("Multi")!==-1,S=x?n.feature.getLineStrings():n.feature;if(!Array.isArray(S))return E.splitGeometryLine(n.split,n.feature);S.forEach(function(e){E.splitFeature({splitfeature:r,feature:new ol.Feature({geometry:e})}).forEach(function(e){e&&o.push(new ol.geom.MultiLineString([e.getCoordinates()]))})})}}return o},getPointFeaturesfromGeometryVertex:function(e){var t=[];switch(e.getType()){case C.MULTIPOLYGON:e.getCoordinates().forEach(function(e){e.forEach(function(e){e.pop(),e.forEach(function(e){var r=new ol.Feature(new ol.geom.Point(e));t.push(r)})})});break;case C.POLYGON:e.getCoordinates().forEach(function(e){e.pop(),e.forEach(function(e){var r=new ol.Feature(new ol.geom.Point(e));t.push(r)})});break;case C.MULTILINESTRING:e.getCoordinates().forEach(function(e){e.forEach(function(e){var r=new ol.Feature(new ol.geom.Point(e));t.push(r)})});break;case C.LINESTRING:e.getCoordinates().forEach(function(e){e.forEach(function(e){var r=new ol.Feature(new ol.geom.Point(e));t.push(r)})});break;case C.MULTIPOINT:e.getCoordinates().forEach(function(e){var r=new ol.Feature(new ol.geom.Point(e));t.push(r)});break;case C.POINT:var r=e.getCoordinates(),n=new ol.geom.Point(r);t.push(n)}return t},getVertexLength:function(e){var t=0;switch(e.getType()){case C.MULTIPOLYGON:e.getCoordinates().forEach(function(e){e.forEach(function(e){e.pop(),e.forEach(function(){return t+=1})})});break;case C.POLYGON:e.getCoordinates().forEach(function(e){e.pop(),e.forEach(function(){return t+=1})})}return t},isSameBaseGeometryType:function(e,t){return e=e.replace("Multi",""),t=t.replace("Multi",""),e===t},isSingleGeometry:function(e){return!k.isMultiGeometry(e.getType())},singleGeometriesToMultiGeometry:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e[0]&&e[0].getType();return t&&new ol.geom["Multi"+t](e.map(function(e){return e.getCoordinates()}))},multiGeometryToSingleGeometries:function(e){var t=e.getType(),r=[];switch(t){case C.MULTIPOLYGON:r=e.getPolygons();break;case C.MULTILINE:case C.MULTILINESTRING:r=e.getLineStrings();break;case C.MULTIPOINT:r=e.getPoints()}return r},convertSingleMultiGeometry:function(e,t){var r=e.getType();if(t&&r!==t){var n=k.isMultiGeometry(r),i=k.isMultiGeometry(t);if(n&&!i)return E.multiGeometryToSingleGeometries(e);if(!n&&i)return E.singleGeometriesToMultiGeometry([e])}return e},dissolve:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.features,r=void 0===t?[]:t,n=e.index,i=void 0===n?0:n,a=e.clone,o=void 0!==a&&a,s=new jsts.io.OL3Parser,l=r.length,u=void 0,c=void 0;switch(l){case 0:u=null;break;case 1:u=r[0];break;default:var d=u=o?r[i].clone():r[i],f=d.getGeometry(),p=f.getType();if("LineString"===p){for(var h=new jsts.operation.linemerge.LineMerger,v=0;v<l;v++){var g=r[v],m=s.read(g.getGeometry()).getCoordinates(),y=(new jsts.geom.GeometryFactory).createLineString(m);h.addLineString(y)}var _=h.getMergedLineStrings();c=1===_.size()?_.toArray()[0]:null}else{c=s.read(f);for(var b=0;b<l;b++)if(i!==b){var w=r[b];c=c.union(s.read(w.getGeometry()))}}if(c){var x=s.write(c),S=x.getType(),L=S===p?x.getCoordinates():p.indexOf("Multi")!==-1&&S===p.replace("Multi","")?[x.getCoordinates()]:null;L?d.getGeometry().setCoordinates(L):u=null}else u=null}return u},within:function(e,t){var r=new jsts.io.OL3Parser,n=r.read(e),i=r.read(t);return i.within(n)},intersects:function(e,t){var r=new jsts.io.OL3Parser,n=r.read(e),i=r.read(t);return n.intersects(i)},findSelfIntersects:function(e){var t=new jsts.io.OL3Parser,r=t.read(e),n=new jsts.operation.IsSimpleOp(r);if(n.isSimpleLinearGeometry(r))return!1;var i=new jsts.geomgraph.GeometryGraph(0,r),a=new jsts.operation.valid.ConsistentAreaTester(i),o=a.isNodeConsistentArea();return!o||void 0},normalizeEpsg:function(e){return"number"==typeof e?"EPSG:"+e:(e=e.replace(/[^\d\.\-]/g,""),""!==e?"EPSG:"+parseInt(e):void 0)},crsToCrsObject:function(e){return null===e||void 0===e?e:("Object"===v(e)&&e.epsg?e.epsg=E.normalizeEpsg(e.epsg):e={epsg:E.normalizeEpsg(e),proj4:"",axisinverted:!1,geographic:!1},e)},ConvertDMToDEG:function(e){var t=e.dms,r=e.type,n=void 0===r?"Array":r,i="Array"===n?t:t.split(/[^\d\w\.]+/),a=1*i[0],o=1*i[1],s=(Number(a)+Number(o)/60).toFixed(6);return 1*s},ConvertDEGToDM:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.deg,r=e.output,n=void 0===r?"Array":r,i=Math.abs(t),a=Math.floor(i),o=60*(i-a);switch(n){case"Array":return[a,o];case"Object":return{degrees:a,minutes:o};case"Text":default:return a+"°"+o+"'"}},ConvertDMSToDEG:function(e){var t=e.dms,r=e.type,n=void 0===r?"Array":r,i="Array"===n?t:t.split(/[^\d\w\.]+/),a=1*i[0],o=1*i[1],s=1*i[2],l=i[3],u=(Number(a)+Number(o)/60+Number(s)/3600).toFixed(6);return"S"!=l&&"W"!=l||(u*=-1),1*u},ConvertDEGToDMS:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.deg,r=e.lat,n=e.lon,i=e.output,a=void 0===i?"Array":i,o=Math.abs(t),s=Math.floor(o),l=60*(o-s),u=Math.floor(l),c=(60*(l-u)).toFixed(2),d=void 0;switch(r&&(d=t>=0?"N":"S"),n&&(d=t>=0?"E":"W"),a){case"Array":return[s,u,c,d];case"Object":return{degrees:s,minutes:u,seconds:c,direction:d};case"Text":default:return s+"°"+u+"'"+c+'"'+d}},getGeoTIFFfromServer:function(){function e(){return t.apply(this,arguments)}var t=a(regeneratorRuntime.mark(function r(){var e,t,n,i,a,o,s,l,u,c,d=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=d.url,t=d.params,n=t.image,i=t.csrfmiddlewaretoken,a=t.bbox,o=d.method,s=void 0===o?"POST":o,l=new FormData,l.append("image",n),l.append("csrfmiddlewaretoken",i),l.append("bbox",a),r.next=7,fetch(e,{method:s,body:l});case 7:return u=r.sent,r.next=10,u.blob();case 10:return c=r.sent,r.abrupt("return",c);case 12:case"end":return r.stop()}},r,this)}));return e}(),createOlFeatureFromApiResponseFeature:function(e){var t=e.properties,r=void 0===t?{}:t,n=e.geometry,i=e.id;r[L]=i;var a=new ol.Feature(n&&new ol.geom[n.type](n.coordinates));return a.setProperties(r),a.setId(i),a},sanitizeFidFeature:function(e){return"String"===v(e)&&Number.isNaN(1*e)&&(e=e.split("."),e=2===e.length?e[1]:e[0]),e},parseAttributes:function(e,t){var r=Object.keys(t).filter(function(e){return x.indexOf(e)===-1});if(e&&e.length){var n=Object.keys(t);return e.filter(function(e){return n.indexOf(e.name)>-1})}return r.map(function(e){return{name:e,label:e}})},handleQueryResponse:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.response,r=e.projections,n=e.layers,i=e.wms,a=void 0===i||i;n=n?n:[this._layer];var o=n[0],s=o.getInfoFormat();return t=w.get(s)({response:t,projections:r,layers:n,wms:a})},distance:function(e,t){return Math.sqrt(geom.squaredDistance(e,t))},squaredDistance:function(e,t){var r=e[0],n=e[1],i=t[0],a=t[1],o=i-r,s=a-n;return o*o+s*s},closestOnSegment:function(e,t){var r=e[0],n=e[1],i=t[0],a=t[1],o=i[0],s=i[1],l=a[0],u=a[1],c=l-o,d=u-s,f=0===c&&0===d?0:(c*(r-o)+d*(n-s))/(c*c+d*d||0),p=void 0,h=void 0;return f<=0?(p=o,h=s):f>=1?(p=l,h=u):(p=o+f*c,h=s+f*d),[p,h]},get_LEGEND_ON_LEGEND_OFF_Params:function(e){var t=void 0,r=void 0;return e.getCategories()&&e.getCategories().forEach(function(n){var i=n.checked,a=n._checked,o=n.ruleKey;i!==a&&(i?("undefined"==typeof t?t=e.getWMSLayerName()+":":t+=",",t=""+t+o):("undefined"==typeof r?r=e.getWMSLayerName()+":":r+=",",r=""+r+o))}),{LEGEND_ON:t,LEGEND_OFF:r}},Geometry:k};t.exports=E},{"app/constant":4,"core/layers/filter/filter":30,"core/layers/map/wmslayer":45,"core/utils/parsers":67,"core/utils/utils":68,"services/gui":361,"store/map-layers":377}],65:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("services/gui"),a=n(i),o=35;r["default"]={layout:function(e){e.map,e.position,e.element},changeLayoutBottomControl:function(e){var t=e.map,r=e.position,n=e.element,i=e.isMobile,a=void 0!==i&&i,s=t.getViewport(),l=(r.top?"t":"b")+(r.left?"l":"r"),u=$(s).find(".ol-control-"+l+":visible");if(u.length){var c=void 0;if(u.each(function(e,t){return t!=n[0]&&void(c=$(t))}),c&&"br"===l)if(a){var d=c.width(),f=d<10?130:d+20;n.css("right",f+"px"),n.css("bottom","15px")}else{var p=c.position().top,h=n.position().top;if(p-h!=o){var v=p-o;n.css("top",v+"px")}}}},createControlUserMessageTool:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{hooks:{body:{template:'<div>\n                <div >\n                  <input type="radio" name="radio" id="g3w-map_theme-0" class="magic-radio" value="view1">\n                  <label  for="g3w-map_theme-0" style="display: flex; justify-content: space-between;">\n                    <span>Intersect</span>\n                  </label>\n                </div>\n                <div>\n                  <input  type="radio" name="radio" id="_cotains" class="magic-radio" value="view2">\n                  <label  for="g3w-map_theme-1" style="display: flex; justify-content: space-between;">\n                    <span>view2</span>\n                  </label>\n                </div>\n              </div>'}},title:"Scelgli il tipo di operazione"};a["default"].showUserMessage({type:"tool",message:e.message,size:e.size||"small",title:e.title||"",hooks:e.hooks})}}},{"services/gui":361}],66:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("store/application-state"),s=n(o),l={m:39.37,degrees:4374754},u=96,c={merge:function(e,t){var r=a({},e,t);return r},getExtentForViewAndSize:function(e,t,r,n){var i=t*n[0]/2,a=t*n[1]/2,o=Math.cos(r),s=Math.sin(r),l=i*o,u=i*s,c=a*o,d=a*s,f=e[0],p=e[1],h=f-l+d,v=f-l-d,g=f+l-d,m=f+l+d,y=p-u-c,_=p-u+c,b=p+u+c,w=p+u-c;return[Math.min(h,v,g,m),Math.min(y,_,b,w),Math.max(h,v,g,m),Math.max(y,_,b,w)]},createPolygonLayerFromBBox:function(e){var t=new ol.Feature(new ol.geom.Polygon.fromExtent(e)),r=new ol.source.Vector({features:[t]}),n=new ol.layer.Vector({source:r});return n},reverseGeometry:function(e){var t=function n(e){e.find(function(t){if(!Array.isArray(t)){var r=i(e,2),a=r[0],o=r[1];return e[0]=o,e[1]=a,!0}n(t)})},r=e.getCoordinates();return t(r),e.setCoordinates(r),e},getScaleFromResolution:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"m";return Math.round(e*l[t]*u)},getResolutionFromScale:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"m",r=e>=1?1/e:e;return 1/(r*l[t]*u)},getDPI:function(){return u},getMetersFromDegrees:function(e){return e*ol.proj.Units.METERS_PER_UNIT.degrees},needUseSphereMethods:function(e){return"EPSG:3857"===e.getCode()||"degrees"===e.getUnits()},getLengthMessageText:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.unit,n=t.projection,i=t.geometry,a=e("core/utils/geo"),o=a.Geometry,s=i.getType(),l=this.needUseSphereMethods(n),u=l?ol.sphere.getLength(i,{projection:n.getCode()}):o.isMultiGeometry(s)?i.getLineStrings().reduce(function(e,t){return e+=t.getLength()},0):i.getLength(),c=void 0;switch(r){case"nautical":c=this.transformMeterLength(u,r)+" nm";break;case"metric":default:c=u>1e3?(Math.round(u/1e3*100)/100).toFixed(3)+" km":(Math.round(100*u)/100).toFixed(2)+" m"}return c},getAreaMessageText:function(e){var t=e.unit,r=e.geometry,n=e.projection,i=e.segments,a=void 0===i?[]:i,o=this.needUseSphereMethods(n),s=Math.round(o?ol.sphere.getArea(r,{projection:n.getCode()}):r.getArea()),l=void 0,u="",c=a.length;switch(c>2&&(u+=this.getLengthMessageText({unit:t,projection:n,geometry:new ol.geom.LineString(a)})+" <br>"),t){case"nautical":l=this.transformMeterArea(s,t)+"  nmi²";break;case"metric":default:l=s>1e6?(Math.round(s/1e6*100)/100).toFixed(6)+" km<sup>2</sup>":(Math.round(100*s)/100).toFixed(3)+" m<sup>2</sup>"}return u&&(l="Area: "+l+' <br><div style="width: 100%; padding: 3px; border-bottom: 2px solid #ffffff"></div> '+u),l},formatMeasure:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.geometry,n=t.projection,i=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e("core/utils/geo")),a=i.Geometry,o=i.multiGeometryToSingleGeometries,s=r.getType(),l=this.getCurrentMapUnit();if(a.isLineGeometryType(s))return this.getLengthMessageText({unit:l,projection:n,geometry:r});if(a.isPolygonGeometryType(s)){var u=void 0;return a.isMultiGeometry(s)?(u=[],o(r).forEach(function(e){e.getLinearRing().getCoordinates().forEach(function(e){return u.push(e)})})):u=r.getLinearRing().getCoordinates(),this.getAreaMessageText({unit:l,geometry:r,projection:n,segments:u})}},createMeasureTooltip:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.map,r=e.feature,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=document.createElement("div");i.className="mtooltip mtooltip-measure";var a=new ol.Overlay({element:i,offset:[0,-15],positioning:"bottom-center"});t.addOverlay(a);var o=r.getGeometry().on("change",function(e){var r=void 0,o=e.target;o instanceof ol.geom.Polygon?r=o.getInteriorPoint().getCoordinates():o instanceof ol.geom.MultiPolygon?r=o.getInteriorPoints().getCoordinates()[0]:o instanceof ol.geom.LineString?r=o.getLastCoordinate():o instanceof ol.geom.MultiLineString&&(r=o.getLastCoordinate());var s=c.formatMeasure({geometry:o,projection:t.getView().getProjection()},n);i.innerHTML=s,a.setPosition(r)});return{tooltip:a,unbyKey:o}},getCurrentMapUnit:function(){return s["default"].map.unit},transformMeterLength:function(e,t){switch(t){case"nautical":e=.0005399568*e}return e},transformMeterArea:function(e,t){switch(t){case"nautical":e=2.9155334959812285e-7*e}return e},removeMeasureTooltip:function(e){var t=e.map,r=e.tooltip,n=e.unbyKey;t.removeOverlay(r),ol.Observable.unByKey(n)},setMeasureTooltipStatic:function(e){var t=e.getElement();t.className="mtooltip mtooltip-static",e.setOffset([0,-7])}};t.exports=c},{"core/utils/geo":64,"store/application-state":373}],67:[function(e,t,r){function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=e("app/constant"),o=e("core/utils/utils"),s=o.toRawType,l=e("core/layers/features/feature"),u=e("core/i18n/i18n.service"),c=u.t,d=e("core/utils/ol"),f="GIS3W_ESCAPE_NUMERIC_FIELD_",p={getHandledResponsesFromResponse:function(e){var t=this,r=e.response,n=e.layers,a=e.projections,o=e.id,s=void 0!==o&&o,l=!1,u=new X2JS,c=u.xml_str2json(r);if(!c)return[{layer:n[0],features:[]}];var d=c.FeatureCollection,f=[];if(d.featureMember)for(var p=Array.isArray(d.featureMember)?d.featureMember:[d.featureMember],h=function(e){var r=n[e],o=s?r.getId():"layer"+e,u={features:null,__prefix:null};if(c.FeatureCollection.featureMember=p.filter(function(e){var t=e[o];if(t)return t.g3w_fid={__prefix:e.__prefix,__text:t._fid&&t._fid.split(".")[1]},!Array.isArray(t)||(u.features=t,u.__prefix=e.__prefix,!1)}),u.features){var d=u.__prefix,h=t.groupFeaturesByFields(u.features);Object.keys(h).length>1?(l=!0,t.handleWMSMultiLayersResponseFromQGISSERVER({groupFeatures:h,prefix:d,handledResponses:f,jsonresponse:c,layer:r,projections:a})):u.features.forEach(function(e){var t;c.FeatureCollection.featureMember.push((t={},i(t,o,e),i(t,"__prefix",d),t))})}if(!l){var v=t.parseLayerFeatureCollection({jsonresponse:c,layer:r,projections:a});v&&f.unshift(v[0])}},v=0;v<n.length;v++)h(v);return f},transformFeatures:function(e,t){if(e.length&&e[0].getGeometry()){var r=t.layer?t.layer:t.map,n="ne"===r.getAxisOrientation().substr(0,2);t.layer&&t.layer.getCode()!==t.map.getCode()&&e.forEach(function(e){var r=e.getGeometry();e.setGeometry(r.transform(t.layer.getCode(),t.map.getCode()))}),n&&(e=this.reverseFeaturesCoordinates(e))}return e},parseLayerFeatureCollection:function(t){var r=this,n=t.jsonresponse,i=t.layer,a=t.projections,o=e("core/utils/geo"),s=o.Geometry,l=s.is3DGeometry,u=s.removeZValueToOLFeatureGeometry,c=new X2JS,d=c.json2xml_str(n),p=new ol.format.WMSGetFeatureInfo,h=this.transformFeatures(p.readFeatures(d),a);if(i.isGeoLayer()){var v=i.getGeometryType();l(v)||h.forEach(function(e){return u({feature:e})})}if(h.length&&this.hasFieldsStartWithNotPermittedKey){var g=Object.keys(h[0].getProperties()),m=g.filter(function(e){return e.indexOf(f)!==-1});h.forEach(function(e){m.forEach(function(t){var n=e.get(t),i=t.replace(f,"");e.set(r.hasFieldsStartWithNotPermittedKey[i],Array.isArray(n)?n[0]:n),e.unset(t)})})}return[{layer:i,features:h}]},reverseFeaturesCoordinates:function(e){return e.forEach(function(e){var t=e.getGeometry();e.setGeometry(d.reverseGeometry(t))}),e},handleXMLStringResponseBeforeConvertToJSON:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.response,i=t.layers,a=t.wms;if(r){"string"==typeof r||r instanceof String||(r=(new XMLSerializer).serializeToString(r));for(var o=0;o<i.length;o++){var s=i[o],l=a&&s.isWmsUseLayerIds()?s.getId():s.getName(),u=a?l.replace(/[/\s]/g,""):l.replace(/[/\s]/g,"_");u=u.replace(/(\'+)/,""),u=u.replace(/(\)+)/,""),u=u.replace(/(\(+)/,"");var c=new RegExp("qgs:"+u,"g");r=r.replace(c,"qgs:layer"+o)}var d=[].concat(n(r.matchAll(/qgs:(\d+(?:\.\d+)?)(\w+)/g)),n(r.matchAll(/qgs:(\w+):(\w+)/g)));d.forEach(function(t,n){if(n%2===0){e.hasFieldsStartWithNotPermittedKey||(e.hasFieldsStartWithNotPermittedKey={});var i=t[0].replace("qgs:","");e.hasFieldsStartWithNotPermittedKey[""+t[1]+t[2]]=i;var a=new RegExp(""+t[0],"g");r=r.replace(a,"qgs:"+f+t[1]+t[2])}});var p=new RegExp(""+String.fromCharCode(0),"g");return r=r.replace(p,"0")}},groupFeaturesByFields:function(e){return _.groupBy(e,function(e){return Object.keys(e)})},handleWMSMultiLayersResponseFromQGISSERVER:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.groupFeatures,n=t.prefix,a=t.handledResponses,o=t.jsonresponse,s=t.layer,l=t.projections;Object.keys(r).forEach(function(t,u){var c=r[t];c.forEach(function(t,r){var c;o.FeatureCollection.featureMember=(c={},i(c,"layer"+u+"_"+r,t),i(c,"__prefix",n),c);var d=e.parseLayerFeatureCollection({jsonresponse:o,layer:s,projections:l});if(d){var f=d[0];f.layer=s,a.unshift(f)}})})}},h={"application/json":function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.layers,n=void 0===r?[]:r,i=t.response,o=t.projections,s=t.wms,l=void 0===s||s,u=e("core/utils/geo"),c=u.sanitizeFidFeature,d=[],f=n.map(function(e){return d.push({layer:e,features:[]}),l?e.getWMSLayerName():e.getWFSLayerName()}),p=i,h=function(){var e=o.layer||o.map,t=new ol.format.GeoJSON({defaultDataProjection:e,geometryName:"geometry"});return t.readFeatures(p)},v=p&&h();return v.filter(function(e){var t=e.getId(),r=c(t),n=t==r?0:f.indexOf(t);if(n!==-1){var i=d[n].layer.getFields().filter(function(e){return e.show}),o=e.getProperties();e.set(a.G3W_FID,r),i.forEach(function(t){void 0===o[t.name]&&void 0!==o[t.label]&&e.set(t.name,o[t.label])}),d[n].features.push(e)}}),d},"application/geojson":function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layers,r=(e.projections,e.response),n=[],i=m.vector.get({type:"geojson"});return r&&t.forEach(function(e){n.push({layer:e,features:i(r,{})})}),n},"text/html":function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layers,r=e.response,n=[];return t.forEach(function(e){n.push({layer:e,rawdata:r})}),n},"text/plain":function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layers,r=e.response,n=[];return t.forEach(function(e){n.push({layer:e,rawdata:r})}),n},"text/gml":function(e){var t=e.layers,r=e.response,n=m.vector.get({type:"gml"}),i=n({data:r,layer:t[0]});return t.map(function(e){return{layer:e,features:i}})},"application/vnd.ogc.gml":function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.response,r=e.projections,n=e.layers,i=e.wms,a=void 0===i||i;return p.getHandledResponsesFromResponse({response:p.handleXMLStringResponseBeforeConvertToJSON({layers:n,response:t,wms:a}),layers:n,projections:r})},not_supported_format:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layers,r=void 0===t?[]:t;return r.map(function(e){return{layer:e,rawdata:c("warning.not_supported_format")}})}},v=function(){this.get=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=void 0;switch(t){case"geojson":case"json":r=this._parseLayerGeoJSON;break;case"gml":r=this._parseLayermsGMLOutput;break;default:r=this._parseLayerGeoJSON}return r},this._parseLayermsGMLOutput=function(e){var t=e.data,r=e.layer;try{var n=void 0;if("--"!==t.substr(0,2))n=t;else{var i=new RegExp("<([^ ]*)FeatureCollection"),a=new RegExp("<([^ ]*)msGMLOutput"),o="\r\n--",s=t.split(new RegExp(o));s.forEach(function(e){var t=e.search(i)>-1||e.search(a)>-1;t&&(n=e.substr(e.indexOf("<?xml")))})}var l=r.getQueryLayerOrigName(),u=new ol.format.WMSGetFeatureInfo({layers:l});return u.readFeatures(n)}catch(c){return[]}},this._parseLayerGeoJSON=function(e,t){try{e="String"===s(e)?JSON.parse(e):e;var r=t.crs,n=t.mapCrs,i=new ol.format.GeoJSON({dataProjection:r,featureProjection:n||r,geometryName:"geometry"});return i.readFeatures(e)}catch(a){return[]}}},g=function(){this.get=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=void 0;switch(t){case"json":r=this._parserJSON.bind(this);break;default:r=this._parserJSON.bind(this)}return r},this._parserJSON=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.features,r=void 0===t?[]:t;return r.map(function(e){var t=e.id,r=e.properties,n=new l;return n.setProperties(r),n.setId(t),n})}},m={vector:new v,table:new g,response:{get:function(e){return h[e]||h.not_supported_format},utils:{getTimeoutData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map(function(e){return{layer:e,rawdata:"timeout"}})}}}};t.exports=m},{"app/constant":4,"core/i18n/i18n.service":13,"core/layers/features/feature":26,"core/utils/geo":64,"core/utils/ol":66,"core/utils/utils":68}],68:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function i(e,t,r){return"undefined"==typeof r||0===+r?Math[e](t):(t=+t,r=+r,isNaN(t)||"number"!=typeof r||r%1!==0?NaN:(t=t.toString().split("e"),t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-r:-r))),t=t.toString().split("e"),+(t[0]+"e"+(t[1]?+t[1]+r:r))))}var a=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=e("app/constant"),s=e("core/layers/filter/filter"),l=e("core/layers/filter/expression");Math.round10||(Math.round10=function(e,t){return i("round",e,t)}),Math.floor10||(Math.floor10=function(e,t){return i("floor",e,t)}),Math.ceil10||(Math.ceil10=function(e,t){return i("ceil",e,t)}),String.prototype.hashCode=function(){var e=0,t=void 0,r=void 0,n=void 0;if(0===this.length)return e;for(t=0,n=this.length;t<n;t++)r=this.charCodeAt(t),e=(e<<5)-e+r,e|=0;return e};var u={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t="",r=void 0,n=void 0,i=void 0,a=void 0,o=void 0,s=void 0,l=void 0,c=0;for(e=u._utf8_encode(e);c<e.length;)r=e.charCodeAt(c++),n=e.charCodeAt(c++),i=e.charCodeAt(c++),a=r>>2,o=(3&r)<<4|n>>4,s=(15&n)<<2|i>>6,l=63&i,isNaN(n)?s=l=64:isNaN(i)&&(l=64),t=t+this._keyStr.charAt(a)+this._keyStr.charAt(o)+this._keyStr.charAt(s)+this._keyStr.charAt(l);return t},decode:function(e){var t="",r=void 0,n=void 0,i=void 0,a=void 0,o=void 0,s=void 0,l=void 0,c=0;for(e=e.replace(/[^A-Za-z0-9+/=]/g,"");c<e.length;)a=this._keyStr.indexOf(e.charAt(c++)),o=this._keyStr.indexOf(e.charAt(c++)),s=this._keyStr.indexOf(e.charAt(c++)),l=this._keyStr.indexOf(e.charAt(c++)),r=a<<2|o>>4,n=(15&o)<<4|s>>2,i=(3&s)<<6|l,t+=String.fromCharCode(r),64!=s&&(t+=String.fromCharCode(n)),64!=l&&(t+=String.fromCharCode(i));return t=u._utf8_decode(t)},_utf8_encode:function(e){e=e.replace(/rn/g,"n");for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t},_utf8_decode:function(e){for(var t="",r=0,n=c1=c2=0;r<e.length;)n=e.charCodeAt(r),n<128?(t+=String.fromCharCode(n),r++):n>191&&n<224?(c2=e.charCodeAt(r+1),t+=String.fromCharCode((31&n)<<6|63&c2),r+=2):(c2=e.charCodeAt(r+1),c3=e.charCodeAt(r+2),t+=String.fromCharCode((15&n)<<12|(63&c2)<<6|63&c3),r+=3);return t}},c=0,d={getUniqueDomId:function(){return c+=1,c+"_"+Date.now()},uniqueId:function(){return d.getUniqueDomId()},basemixin:function(e,t){return d.merge(e.prototype,t)},mixin:function(e,t){var r=new t;d.merge(e,r),d.merge(e.prototype,t.prototype)},merge:function(e,t){var r=void 0;for(r in t)d.hasOwn(t,r)&&(e[r]=t[r])},hasOwn:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},inherit:function(e,t){function r(){}r.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new r,e.prototype.constructor=e},base:function(e,t,r){var n=arguments.callee.caller;if(n.superClass_)return n.superClass_.constructor.apply(e,Array.prototype.slice.call(arguments,1));for(var i=Array.prototype.slice.call(arguments,2),a=!1,o=e.constructor;o;o=o.superClass_&&o.superClass_.constructor)if(o.prototype[t]===n)a=!0;else if(a)return o.prototype[t].apply(e,i);if(e[t]===n)return e.constructor.prototype[t].apply(e,i);throw Error("base called from a method of one name to a method of a different name")},noop:function(){},truefnc:function(){return!0},falsefnc:function(){return!0},resolve:function(e){var t=$.Deferred();return t.resolve(e),t.promise()},reject:function(e){var t=$.Deferred();return t.reject(e),t.promise()},getValueFromG3WObjectEvent:function(){},getAjaxResponses:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.length,r=$.Deferred(),n=[],i=[];return e.forEach(function(e){e.then(function(e){n.push(e)}).fail(function(e){i.push(e)}).always(function(){t=t>0?t-1:t,0===t&&r.resolve({done:n,fail:i})})}),r.promise()},trimValue:function(e){return e.replace(/ /g,"")},isURL:function(e){return e&&e.match(/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g)},sanitizeUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.reserverParameters,n=void 0===r?[]:r,i=new URL(t);return n.forEach(function(e){for(var r=[e.toUpperCase(),e.toLowerCase()],n=0;n<2;n++){var a=r[n],o=i.searchParams.get(a);if(o){t=t.replace(a+"="+o,"");break}}}),t},convertObjectToUrlParams:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return $.param(e)},appendParams:function(e,t){var r=[];Object.keys(t).forEach(function(e){null!==t[e]&&void 0!==t[e]&&r.push(e+"="+encodeURIComponent(t[e]))});var n=r.join("&");return e=e.replace(/[?&]$/,""),e=e.indexOf("?")===-1?e+"?":e+"&",e+n},imageToDataURL:function(e){var t=e.src,r=e.type,n=void 0===r?"image/jpeg":r,i=e.callback,a=void 0===i?function(){}:i,o=new Image;o.onload=function(){var e=document.createElement("canvas"),t=e.getContext("2d");e.height=this.naturalHeight,e.width=this.naturalWidth,t.drawImage(this,0,0);var r=e.toDataURL(n);a(r)},o.src=t},capitalize_first_letter:function(e){return""+e[0].toUpperCase()+e.slice(1)},Base64:u,toRawType:function(e){var t=Object.prototype.toString;return t.call(e).slice(8,-1)},isEmptyObject:function(e){return"{}"===JSON.stringify(e)},throttle:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,r=void 0;return function(){var n=r;r=Date.now(),(void 0===n||r-n>t)&&e.apply(void 0,arguments)}},debounce:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,r=void 0;return function(){for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];clearTimeout(r),r=setTimeout(function(){e.apply(void 0,i)},t)}},getRandomColor:function(){return"#"+((1<<24)*Math.random()|0).toString(16)},copyUrl:function(e){var t=document.createElement("input");document.body.appendChild(t),t.value=e,t.select(),document.execCommand("copy"),document.body.removeChild(t)},downloadFile:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.filename,i=t.content,a=t.url,o=t.mime_type,s=void 0===o?"text/plain":o,l=function(e){var t=document.createElement("a");t.setAttribute("href",window.URL.createObjectURL(e)),t.setAttribute("download",r),t.dataset.downloadurl=[s,t.download,t.href].join(":"),t.click(),t=null};return new Promise(function(t,o){if(i){var u=new Blob([i],{type:s});l(u),t()}else a&&fetch(a).then(function(){var t=n(regeneratorRuntime.mark(function i(t){var n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(200!==t.status){e.next=6;break}return s=s||t.headers.get("content-type"),r=r||t.headers.get("content-disposition").split("filename=").length?t.headers.get("content-disposition").split("filename=")[1]:"g3w_download_file",e.abrupt("return",t.blob());
case 6:if(400!==t.status&&500!==t.status){e.next=12;break}return e.next=9,t.json();case 9:return n=e.sent,a=n.message,e.abrupt("return",Promise.reject(a));case 12:case"end":return e.stop()}},i,e)}));return function(e){return t.apply(this,arguments)}}()).then(function(e){l(e),t()})["catch"](function(e){o(e)})})},downloadCSVLayerFeatures:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.layer,n=t.alias,i=void 0===n||n,a=e("core/utils/geo"),o=a.getAlphanumericPropertiesFromFeature,s=Object.keys(r.features[0].attributes),l=o(s),u=i?l.map(function(e){var t=r.attributes.find(function(t){return t.name===e});return t?t.label:e}):l,c=r.features.map(function(e){var t=e.attributes,r={};return l.forEach(function(e,n){var a=!i&&e||u[n];r[a]=t[e]}),r});d.downloadCSV({filename:r.id,items:c})},downloadCSV:function(){function e(e){for(var t="",r=0;r<e.length;r++){var n="";for(var i in e[r])""!==n&&(n+=";"),n+=e[r][i];t+=n+"\r\n"}return t}var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.filename,n=void 0===r?d.getUniqueDomId():r,i=t.items,a=void 0===i?[]:i,o=n+".csv",s=e(a),l=new Blob([s],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob)navigator.msSaveBlob(l,o);else{var u=document.createElement("a");if(void 0!==u.download){var c=URL.createObjectURL(l);u.setAttribute("href",c),u.setAttribute("download",o),u.style.visibility="hidden",u.click()}}},getTimeoutPromise:function(e){var t=e.timeout,r=void 0===t?o.TIMEOUT:t,n=e.resolve,i=e.data,a=setTimeout(function(){n(i)},r);return a},XHR:{get:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.params,n=void 0===r?{}:r;return new Promise(function(e,r){t?$.get(t,n).then(function(t){e(t)}).fail(function(e){return r(e)}):r("No url")})},post:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.data,n=e.formdata,i=void 0!==n&&n,a=e.contentType,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise(function(e,n){if(i){var s=new FormData;for(var l in r)s.append(l,r[l]);$.ajax({type:"POST",url:t,data:s,processData:!1,contentType:!1}).then(function(t,r,n){e(o?{data:t,status:r,request:n}:t)}).fail(function(e){n(e)})}else a?$.ajax({type:"POST",url:t,data:r,processData:!1,contentType:a||!1}).then(function(t,r,n){e(o?{data:t,status:r,request:n}:t)}).fail(function(e){n(e)}):$.post(t,r).then(function(t,r,n){e(o?{data:t,status:r,request:n}:t)}).fail(function(e){n(e)})})},htmlescape:function(e){return e=e.replace("&","&amp;"),e=e.replace("<","&lt;"),e=e.replace(">","&gt;"),e=e.replace('"',"&quot;")},fileDownload:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.data,n=e.httpMethod,i=void 0===n?"POST":n,a=void 0;return new Promise(function(e,n){var s=$.fileDownload(t,{httpMethod:i,data:r});a=setTimeout(function(){n("Timeout"),s.abort()},o.TIMEOUT),s.done(function(){return e()}).fail(function(){return n()}).always(function(){clearTimeout(a)})})}},createSingleFieldParameter:function(e){var t=e.layer,r=e.field,n=e.value,i=e.operator,a=void 0===i?"eq":i,s=e.logicop,l=void 0===s?"OR":s,u=e.search_endpoint,c=void 0===u?"api":u;if("api"===c&&Array.isArray(n)){var f="",p=n.length;return n.forEach(function(e,t){f+=r+"|"+a.toLowerCase()+"|"+encodeURIComponent(e)+(t<p-1?"|"+l+",":"")}),f}if("api"===c)return r+"|"+a.toLowerCase()+"|"+encodeURIComponent(n)+(l?"|"+l:"");var h="";if(Array.isArray(n)){var v=n.length;n.forEach(function(e,t){h+='"'+r+'" '+o.FILTER_EXPRESSION_OPERATORS[a]+" '"+encodeURIComponent(e)+"' "+(t<v-1?l+" ":"")})}else h='"'+r+'" '+o.FILTER_EXPRESSION_OPERATORS[a]+" '"+encodeURIComponent(n)+"'";return d.createFilterFromString({layer:t,search_endpoint:c,filter:h})},createFilterFromString:function(e){var t=e.layer,r=e.search_endpoint,n=void 0===r?"ows":r,i=e.filter,u=void 0===i?"":i,c=u;switch(n){case"ows":var d=t.getWMSLayerName(),f=new l({layerName:d,filter:c});u=new s,u.setExpression(f.get());break;case"api":Object.values(o.FILTER_EXPRESSION_OPERATORS).forEach(function(e){var t=new RegExp("\\s+"+e+"\\s+","g");c=c.replace(t,""+e);var r=new RegExp("'"+e,"g");c=c.replace(r,""+e),r=new RegExp(e+"'","g"),c=c.replace(r,""+e)}),c=c.replace(/'$/g,""),u=c.replace(/"/g,""),Object.entries(o.FILTER_EXPRESSION_OPERATORS).forEach(function(e){var t=a(e,2),r=t[0],n=t[1],i=new RegExp(n,"g"),o="AND"===n||"OR"===n?"|"+r+",":"|"+r+"|";u=u.replace(i,o)}),u=u.split("|").map(function(e,t){return(t+1)%3===0?encodeURIComponent(e):e}).join("|")}return u},createFilterFormInputs:function(e){var t=e.layer,r=e.search_endpoint,n=void 0===r?"ows":r,i=e.inputs,a=void 0===i?[]:i,o=Array.isArray(t),u=void 0,c=[];switch(n){case"ows":if(o)t.forEach(function(e){var t=new l;t.createExpressionFromFilter(a,e.getWMSLayerName()),u=new s,u.setExpression(t.get()),c.push(u)});else{var f=new l;f.createExpressionFromFilter(a,t.getWMSLayerName()),u=new s,u.setExpression(f.get())}break;case"api":var p=a.length,h=a.map(function(e,t){if(Array.isArray(e.attribute)){var r=e.attribute.length;return e.attribute.reduce(function(n,i,a){return n+d.createSingleFieldParameter({field:i,value:e.value[a],operator:e.operator,logicop:null})+(a<r-1?"|AND,":t<p-1?"|"+e.logicop:"")},"")}return d.createSingleFieldParameter({field:e.attribute,value:e.value,operator:e.operator,logicop:e.logicop})});u=h.length?h.join():void 0,o&&t.forEach(function(){return c.push(u)})}return o?c:u},createFilterFormField:function(e){var t=e.layer,r=e.search_endpoint,n=void 0===r?"ows":r,i=e.field,a=e.value,o=e.operator,u=void 0===o?"eq":o,c=void 0;switch(n){case"ows":var f=new l,p=t.getWMSLayerName();f.createExpressionFromField({layerName:p,field:i,value:a,operator:u}),c=new s,c.setExpression(f.get());break;case"api":c=d.createSingleFieldParameter({field:i,value:a,operator:u})}return c},splitContextAndMethod:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.split(":"),r=a(t,2),n=r[0],i=r[1];return{context:n,method:i}},colorHEXToRGB:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#FFFFFF",t=parseInt(e.substr(1,2),16),r=parseInt(e.substr(3,2),16),n=parseInt(e.substr(5,2),16);return[t,r,n]},convertQGISDateTimeFormatToMoment:function(e){e=e.replace(/y/g,"Y");var t=e.match(/d/g);return t&&t.length<3&&(e=e.replace(/d/g,"D")),e},sortAlphabeticallyArray:function(e){return e.sort(function(e,t){return e.localeCompare(t,void 0,{sensitivity:"base"})})},sortNumericArray:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.sort(function(e,r){return t?e-r:r-e})},sameOrigin:function(e,t){try{return new URL(e).origin===new URL(t).origin}catch(r){return!1}}};t.exports=d},{"app/constant":4,"core/layers/filter/expression":29,"core/layers/filter/filter":30,"core/utils/geo":64}],69:[function(e,t,r){var n=e("core/utils/utils"),i=n.truefnc,a={validators:{"float":function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=e,this.validate=function(e){var t=Number(1*e);return!Number.isNaN(t)}},integer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=e,this.validate=function(e){var t=1*e;return!_.isNaN(t)&&(Number.isSafeInteger(t)&&t<=2147483647)}},checkbox:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=e,this.validate=function(e){var t=this.options.values||[];return t.indexOf(e)!==-1}},datetimepicker:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=e,this.validate=function(e,t){var r=t.fielddatetimeformat;return moment(e,r,!0).isValid()}},text:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=e,this.validate=i},string:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=e,this.validate=i},radio:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=e,this.validate=i},"default":function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=e,this.validate=i},range:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.min,r=e.max;this.validate=function(e){return e=1*e,e>=t&&e<=r}}},get:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.validators[e]||this.validators["default"];return new r(t)}};t.exports=a},{"core/utils/utils":68}],70:[function(e,t,r){function n(){var e=[],t=void 0,r=0,n=null,i=void 0,o=void 0;this.queques={end:new l,micro:new l},this.start=function(r){return i=$.Deferred(),o=r,t=r.getInputs(),n=r.getContext(),e=r.getSteps(),e&&e.length&&this.runStep(e[0],t,n),i.promise()},this.runStep=function(e,t){var r=this;o.setMessages({help:e.state.help});var i=this.queques.micro.getLength();e.run(t,n,this.queques).then(function(e){i&&r.queques.micro.run(),r.onDone(e)}).fail(function(e){return r.onError(e)})},this.onDone=function(t){return r++,r===e.length?(r=0,void i.resolve(t)):void this.runStep(e[r],t)},this.onError=function(e){r=0,this.clearQueques(),i.reject(e)},this.stop=function(){var t=$.Deferred();return e[r].isRunning()?e[r].stop():null,this.clearQueques(),r>0?(r=0,t.reject()):t.resolve(),t.promise()},a(this)}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("core/g3wobject"),l=e("core/workflow/queque");o(n,s);var u=n.prototype;u.clearQueques=function(){this.queques.micro.clear(),this.queques.end.clear()},t.exports=n},{"core/g3wobject":12,"core/utils/utils":68,"core/workflow/queque":71}],71:[function(e,t,r){function n(){this.tasks=[]}var i=n.prototype;i.addTask=function(e){this.tasks.push(e)},i.run=function(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.tasks.length;){var t=e?this.tasks.pop():this.tasks.shift();t()}},i.flush=function(){return this.tasks.splice(0)},i.getLength=function(){return this.tasks.length},i.clear=function(){this.run(),this.tasks=[]},t.exports=n},{}],72:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this);var t=e.inputs,r=void 0===t?null:t,n=e.context,i=void 0===n?null:n,o=e.task,s=void 0===o?null:o,l=e.outputs,u=void 0===l?null:l,c=e.escKeyPressEventHandler;this._inputs=r,this._context=i,this._task=s,this._outputs=u,this.state={id:e.id||null,name:e.name||null,help:e.help||null,running:!1,error:null,message:e.message||null},c&&this.registerEscKeyEvent(c)}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("core/g3wobject");o(n,s);var l=n.prototype;l.escKeyUpHandler=function(e){var t=e.data,r=t.task,n=t.callback;"Escape"===e.key&&n({task:r})},l.unbindEscKeyUp=function(){$(document).unbind("keyup",this.escKeyUpHandler)},l.bindEscKeyUp=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};$(document).on("keyup",{callback:e,task:this.getTask()},this.escKeyUpHandler)},l.registerEscKeyEvent=function(e){var t=this;this.on("run",function(){return t.bindEscKeyUp(e)}),this.on("stop",function(){return t.unbindEscKeyUp()})},l.run=function(e,t,r){var n=this;this.emit("run",{inputs:e,context:t});var i=$.Deferred();if(this._task)try{this.state.running=!0,this._task.setInputs(e),this._task.setContext(t),this._task.run(e,t,r).then(function(e){n.stop(),i.resolve(e)}).fail(function(e){n.stop(),i.reject(e)})}catch(a){this.state.error=a,this.state.error="Problem ..",this.stop(),i.reject(a)}return i.promise()},l.stop=function(){this._task.stop(this._inputs,this._context),this.state.running=!1,this.emit("stop"),this._task.setInputs(null),this._task.setContext(null)},l.revert=function(){this._task&&this._task.revert&&this._task.revert()},l.panic=function(){this._task&&this._task.panic&&this._task.panic()},l.getId=function(){return this.state.id},l.getName=function(){return this.state.name},l.getHelp=function(){return this.state.help},l.getError=function(){return this.state.error},l.getMessage=function(){return this.state.message},l.isRunning=function(){return this.state.running},l.setInputs=function(e){this._inputs=e},l.getInputs=function(){return this._inputs},l.setTask=function(e){this._task=e},l.getTask=function(){return this._task},l.setOutputs=function(e){this._outputs=e},l.getOutputs=function(){return this._outputs},n.MESSAGES={help:null},t.exports=n},{"core/g3wobject":12,"core/utils/utils":68}],73:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.state={usermessagesteps:{}}}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("core/g3wobject");o(n,s);var l=n.prototype;l.setInputs=function(e){this.inputs=e},l.getInputs=function(){return this.inputs},l.setContext=function(e){return this.context=e},l.getContext=function(){return this.context},l.revert=function(){},l.panic=function(){},l.stop=function(){},l.run=function(){},l.setRoot=function(e){this.state.root=e},l.getUserMessageSteps=function(){return this.state.usermessagesteps},l.setUserMessageSteps=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state.usermessagesteps=e},l.setUserMessageStepDone=function(e){e&&(this.state.usermessagesteps[e].done=!0)},t.exports=n},{"core/g3wobject":12,"core/utils/utils":68}],74:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.inputs,r=void 0===t?null:t,n=e.context,i=void 0===n?null:n,o=e.flow,s=void 0===o?new v:o,l=e.steps,u=void 0===l?[]:l,c=e.runOnce,f=void 0!==c&&c;d(this),this._promise=null,this._inputs=r,this._context=i,this._flow=s,this._steps=u,this._child=null,this._stackIndex=null,this.runOnce=f,this._messages=m,this._userMessageSteps=this._steps.reduce(function(e,t){var r=t.getTask().getUserMessageSteps();return r&&a({},e,r)||e},{})}var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("services/workflows"),s=n(o),l=e("services/gui"),u=n(l),c=e("core/utils/utils"),d=c.base,f=c.inherit,p=c.resolve,h=e("core/g3wobject"),v=e("core/workflow/flow"),g=e("core/workflow/step"),m=g.MESSAGES,y=e("gui/workflow/createUserMessageStepsFactory");f(i,h);var _=i.prototype;_.getContextService=function(){var e=this.getContext();return e.service},_.setContextService=function(e){var t=this.getContext();t.service=e},_.getStackIndex=function(){return this._stackIndex},_.addChild=function(e){this._child?this._child.addChild(e):this._child=e},_.removeChild=function(){if(this._child){var e=this._child.getStackIndex();s["default"].removeAt(e)}this._child=null},_.setInput=function(e){var t=e.key,r=e.value;this._inputs[t]=r},_._setInputs=function(e){this._inputs=e},_.getInputs=function(){return this._inputs},_.setContext=function(e){this._context=e},_.getContext=function(){return this._context},_.getFlow=function(){return this._flow},_.setFlow=function(e){this._flow=e},_.addStep=function(e){this._steps.push(e)},_.setSteps=function(e){this._steps=e},_.getSteps=function(){return this._steps},_.getStep=function(e){return this._steps[e]},_.setMessages=function(e){Object.assign(this._messages,e)},_.getMessages=function(){return this._messages},_.clearMessages=function(){this._messages.help=null,this._isThereUserMessaggeSteps()&&this.clearUserMessagesSteps()},_.getLastStep=function(){var e=this._steps.length;return e?this._steps[e-1]:null},_.getRunningStep=function(){return this._steps.find(function(e){return e.isRunning()})},_._stopChild=function(){return this._child?this._child.stop():p()},_._isThereUserMessaggeSteps=function(){return Object.keys(this._userMessageSteps).length},_.reject=function(){this._promise&&this._promise.reject()},_.resolve=function(){this._promise&&this._promise.resolve()},_.start=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred();this._promise=r,this._inputs=t.inputs,this._context=t.context||{};var n=this._context.isChild||!1;s["default"].getLength()&&s["default"].getCurrent()!==this&&!n&&s["default"].getCurrent().addChild(this),this._stackIndex=s["default"].push(this),this._flow=t.flow||this._flow,this._steps=t.steps||this._steps;var i=this._isThereUserMessaggeSteps();if(i){var a=y({steps:this._userMessageSteps});u["default"].showUserMessage({title:"sdk.workflow.steps.title",type:"tool",position:"left",size:"small",closable:!1,hooks:{body:a}})}return this._flow.start(this).then(function(t){i&&setTimeout(function(){e.clearUserMessagesSteps(),r.resolve(t)},500)||r.resolve(t)}).fail(function(t){i&&e.clearUserMessagesSteps(),r.reject(t)}).always(function(){e.runOnce&&e.stop()}),this.emit("start"),r.promise()},_.stop=function(){var e=this;this._promise=null;var t=$.Deferred();return this._stopChild().always(function(){e.removeChild(),s["default"].removeAt(e.getStackIndex()),e._flow.stop().then(function(){return t.resolve()}).fail(function(e){return t.reject(e)}).always(function(){return e.clearMessages()})}),this.emit("stop"),t.promise()},_.clearUserMessagesSteps=function(){this._resetUserMessaggeStepsDone(),u["default"].closeUserMessage()},_._resetUserMessaggeStepsDone=function(){var e=this;Object.keys(this._userMessageSteps).forEach(function(t){var r=e._userMessageSteps[t];r.done=!1,r.buttonnext&&(r.buttonnext.disabled=!0)})},t.exports=i},{"core/g3wobject":12,"core/utils/utils":68,"core/workflow/flow":70,"core/workflow/step":72,"gui/workflow/createUserMessageStepsFactory":193,"services/gui":361,"services/workflows":372}],75:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});r.SPATIALMETHODS=["intersects","within"],r.VM=new Vue},{}],76:[function(e,t,r){function n(){var e={name:"addlayer",tipLabel:"sdk.mapcontrols.addlayer.tooltip",label:""};i.call(this,e),this._layerstore=null}var i=e("g3w-ol/controls/control");ol.inherits(n,i);var a=n.prototype;a.setMap=function(e){var t=this;i.prototype.setMap.call(this,e),$(this.element).on("click",function(){return t.dispatchEvent("addlayer")})},a.layout=function(e){i.prototype.layout.call(this,e)},a.getLayersSore=function(){return this._layerstore},a.setLayersStore=function(e){this._layerstore=e},t.exports=n},{"g3w-ol/controls/control":79}],77:[function(e,t,r){var n=e("core/utils/ol"),i=e("g3w-ol/interactions/areainteraction"),a=e("g3w-ol/controls/measurecontrol"),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={tipLabel:"sdk.mapcontrols.measures.area.tooltip",label:"",clickmap:!0,interactionClass:i};e=n.merge(e,t),a.call(this,e)};ol.inherits(o,a),t.exports=o},{"core/utils/ol":66,"g3w-ol/controls/measurecontrol":85,"g3w-ol/interactions/areainteraction":101}],78:[function(e,t,r){var n=e("g3w-ol/constants"),i=e("g3w-ol/controls/interactioncontrol"),a=e("core/utils/ol"),o=a.merge,s=e("core/utils/geo"),l=s.Geometry,u=l.getAllPolygonGeometryTypes(),c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e,r=t.spatialMethod,a=void 0===r?n.SPATIALMETHODS[0]:r,s=t.onSelectlayer,l=t.interactionClass,c={offline:!1,onSelectlayer:s,clickmap:!0,interactionClass:l,spatialMethod:a,toggledTool:{type:"spatialMethod",how:"toggled"},onhover:!0};e=o(e,c),e.geometryTypes=u,i.call(this,e)};ol.inherits(c,i),t.exports=c},{"core/utils/geo":64,"core/utils/ol":66,"g3w-ol/constants":75,"g3w-ol/controls/interactioncontrol":83}],79:[function(e,t,r){function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var i=e("g3w-ol/controls/utils"),a=i.layout,o=function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,r=void 0===t?"":t,i=e.visible,a=void 0===i||i,o=e.enabled,s=void 0!==o&&o;if(this._enabled=s,this.offline=void 0===e.offline||e.offline,this.name=r.split(" ").join("-").toLowerCase(),this.id=this.name+"_"+Math.floor(1e6*Math.random()),this.eventKeys={},this.positionCode=e.position||"tl",this.priority=e.priority||0,!e.element){var u="ol-"+this.name.split(" ").join("-").toLowerCase(),c=e.customClass,d=e.tipLabel||this.name,f=e.label||"",p=Vue.extend({functional:!0,render:function(e){var t;return e("div",{"class":(t={},n(t,u,!!u),n(t,"ol-unselectable",!0),n(t,"ol-control",!0),t)},[e("button",{attrs:{type:"button"},directives:[{name:"t-tooltip",value:d}]},[f,e("i",{"class":n({},c,!!c)})])])}}),h=(new p).$mount().$el;e.element=h}var v=e.buttonClickHandler||l.prototype._handleClick.bind(this);$(e.element).on("click",v),ol.control.Control.call(this,e),this.setVisible(a),this._postRender()};ol.inherits(o,ol.control.Control);var s=o.prototype;s.isClickMap=function(){return this.clickmap},s.isToggled=function(){return this._toggled},s.setEventKey=function(e){var t=e.eventType,r=e.eventKey;this.eventKeys[t]={eventKey:r,originalHandler:r.listener}},s.resetOriginalHandlerEvent=function(e){this.eventKeys[e]&&this.eventKeys[e].eventKey&&(ol.Observable.unByKey(this.eventKeys[e].eventKey),this.eventKeys[e].eventKey=this.on(e,this.eventKeys[e].originalHandler))},s.overwriteEventHandler=function(e){var t=e.eventType,r=e.handler;this.eventKeys[t]&&this.eventKeys[t].eventKey&&(ol.Observable.unByKey(this.eventKeys[t].eventKey),this.eventKeys[t].eventKey=this.on(t,r))},s.getPosition=function(e){e=e||this.positionCode;var t={};return t.top=e.indexOf("t")>-1,t.left=e.indexOf("l")>-1,t.bottom=e.indexOf("b")>-1,t.right=e.indexOf("r")>-1,t},s._handleClick=function(e){var t=this;e.preventDefault();var r=this.getMap(),n=null,i=r.getControls();this._toggled&&i.forEach(function(e){e.id&&e.toggle&&e.id!==t.id&&(e.toggle(!1),"reset"===e.name&&(n=e))}),!this._toggled&&n&&n.toggle(!0),this.dispatchEvent("controlclick")},s.shiftPosition=function(e){$(this.element).css(hWhere,e+"px")},s.layout=function(e){if(e){var t=this.getPosition(),r=$(this.element);a({map:e,position:t,element:r})}},s.changelayout=function(e){},s.setMap=function(e){e&&(this.layout(e),ol.control.Control.prototype.setMap.call(this,e))},s.showControl=function(){$(this.element).show()},s.hideControl=function(){var e=$(this.element).position().left,t=$(this.element).outerWidth(),r=e,n=$(this.element).siblings(".ol-control-tl");n.each(function(){$(this).position().left>e&&(r=$(this).position().left,t>$(this).outerWidth()&&(e+=t-$(this).outerWidth()),$(this).css("left",e+"px"),e=r,t=$(this).outerWidth())}),$(this.element).hide()},s.setEnable=function(e){$(this.element).find("button").first().toggleClass("g3w-ol-disabled",!e),!e&&this._interaction&&this._interaction.setActive(!1),this._enabled=e},s.getEnable=function(){return this._enabled},s.setVisible=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._visible=e,$(this.element)[e?"show":"hide"]()},s.isVisible=function(){return this._visible},s._postRender=function(){},t.exports=o},{"g3w-ol/controls/utils":97}],80:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options={provider:"osm",placeholder:e.placeholder||"Città, indirizzo ... ",noresults:e.noresults||"Nessun risultato ",notresponseserver:e.notresponseserver||"Il server non risponde",lang:f["default"].language||"it-IT",limit:e.limit||5,keepOpen:!0,preventDefault:!1,autoComplete:!1,autoCompleteMinLength:4,debug:!1,viewbox:e.bbox,bounded:1,mapCrs:e.mapCrs,fontIcon:h["default"].getFontClass("search")};var t=this.options,r=t.placeholder,n=t.fontIcon,o=t.mapCrs,s=t.viewbox;this.providers=[new S({mapCrs:o,viewbox:s}),new x({mapCrs:o,viewbox:s})],this.layer=new ol.layer.Vector({source:new ol.source.Vector,style:new ol.style.Style({text:new ol.style.Text({offsetY:-15,text:"",font:'900 3em "Font Awesome 5 Free"',stroke:new ol.style.Stroke({color:"red",width:3}),fill:new ol.style.Fill({color:"rgba(255, 0,0, 0.7)"})})})}),this.projection;var u=b.namespace+" "+b.inputText.container,c=this,d=Vue.extend({functional:!0,render:function(e){return e("div",{"class":a({},u,!0)},[e("div",{"class":a({},b.inputText.control,!0)},[e("input",{attrs:{type:"text",id:b.inputQueryId,autocomplete:"off"},"class":a({},b.inputText.input,!0),directives:[{name:"t-placeholder",value:r}]}),e("button",{attrs:{type:"button",id:"search_nominatim"},"class":{btn:!0},on:{click:function(){var e=$("input."+b.inputText.input).val();c.query(e)}}},[e("i",{attrs:{"aria-hidden":!0},style:{color:"#ffffff"},"class":a({},n,!0)})]),e("button",{attrs:{type:"button",id:b.inputResetId},"class":a({},b.inputText.reset+"  "+b.hidden,!0)})]),e("ul",{"class":a({},b.inputText.result,!0)})])}});this.container=(new d).$mount().$el,this.lastQuery="",this.registeredListeners={mapClick:!1},this.showMarker=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{transform:!0},r=t.transform;this.hideMarker(),e=r?ol.proj.transform(e,"EPSG:4326",this.getMap().getView().getProjection()):e;var n=new ol.geom.Point(e),i=new ol.Feature(n);this.layer.getSource().addFeature(i),this.getMap().addLayer(this.layer),h["default"].getService("map").zoomToGeometry(n)},this.hideMarker=function(){this.layer.getSource().clear(),this.getMap().removeLayer(this.layer)},this.createControl=function(){var e=this,t=void 0,r=void 0;this.control=w.find("."+b.inputText.control,this.container),this.input=w.find("."+b.inputText.input,this.container),this.reset=w.find("."+b.inputText.reset,this.container),this.result=w.find("."+b.inputText.result,this.container);var n=function(t){var r=t.target.value.trim(),n=t.key?"Enter"===t.key:t.which?13===t.which:!!t.keyCode&&13===t.keyCode;n&&(t.preventDefault(),e.query(r))},i=function(){e.input.focus(),e.input.value="",e.lastQuery="",w.addClass(e.reset,b.hidden),e.clearResults()},a=function(n){var i=n.target.value.trim();i.length?w.removeClass(e.reset,b.hidden):w.addClass(e.reset,b.hidden),e.options.autoComplete&&i!==r&&(r=i,t&&clearTimeout(t),t=setTimeout(function(){return i.length>=e.options.autoCompleteMinLength&&e.query(i)},200))};this.input.addEventListener("keyup",n,!1),this.input.addEventListener("input",a,!1),this.reset.addEventListener("click",i,!1)},this.query=function(e){var t=this;return this.hideMarker(),new Promise(function(){var r=i(regeneratorRuntime.mark(function n(r,i){var a,o,s,u,c,d,f,p,h,v,g;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a=function(e){return"Number"===m(e)&&!Number.isNaN(e)},o=null,s=!1,e){u=e.split(","),c=l(u,3),d=c[0],f=c[1],p=c[2],o=a(1*d)&&a(1*f)?[1*d,1*f]:null;try{p&&_.get("EPSG:"+p.trim())&&(o=ol.proj.transform(o,_.get("EPSG:"+p.trim()),"EPSG:4326"),s=!0)}catch(i){}}if(!o){n.next=9;break}t.showMarker(o,{transform:s}),r(o),n.next=19;break;case 9:if(t.lastQuery!==e||!t.result.firstChild){n.next=11;break}return n.abrupt("return");case 11:return h=[],v=t.providers.filter(function(e){return e.active}),v.forEach(function(r){var n=r.getParameters({query:e,lang:t.options.lang,countrycodes:t.options.countrycodes,limit:t.options.limit}),i=n.url,a=n.params;t.lastQuery=e,t.clearResults(),w.addClass(t.reset,b.spin),h.push(y.get({url:i,params:a}))}),n.next=16,Promise.allSettled(h);case 16:g=n.sent,g.forEach(function(e,r){var n=e.status,i=e.value;if("fulfilled"===n){var a=v[r].handleResponse(i),o=a.header,s=a.results;v[r].active&&t.createList({header:o,results:s})}}),w.removeClass(t.reset,b.spin);case 19:case"end":return n.stop()}},n,t)}));return function(e,t){return r.apply(this,arguments)}}())},this.createList=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.header,n=t.results,i=void 0===n?{}:n,a=this.result;if(a.appendChild(this.createHeaderProviderResults(r)),i.length)i.forEach(function(t){var r=e.addressTemplate(t.address),n=['<a href="#">',r,"</a>"].join(""),i=w.createElement("li",n);i.addEventListener("click",function(n){n.preventDefault(),e.chosen(t,r,t.address,t.original)},!1),a.appendChild(i)});else{var o=this.options.noresults,s=Vue.extend({functional:!0,render:function(e){return e("li",{"class":{"nominatim-noresult":!0},directives:[{name:"t",value:o}]})}}),l=(new s).$mount().$el;a.appendChild(l)}},this.chosen=function(e,t,r,n){var i=[parseFloat(e.lon),parseFloat(e.lat)];this.options.keepOpen===!1&&this.clearResults(!0),this.showMarker(i)},this.createHeaderProviderResults=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t='\n      <div style="display: flex; justify-content: space-between; padding: 5px">\n        <span  style="color: #FFFFFF; font-weight: bold">'+e.title+"</span>\n      </div>",r=w.createElement("li",t);return r.classList.add("skin-background-color"),r},this.addressTemplate=function(e){var t=[];return e.name&&t.push(['<div class="',b.road,'">{name}</div>'].join("")),(e.road||e.building||e.house_number)&&t.push(['<div class="',b.road,'">{building} {road} {house_number}</div>'].join("")),(e.city||e.town||e.village)&&t.push(['<div class="',b.city,'">{postcode} {city} {town} {village}</div>'].join("")),(e.state||e.country)&&t.push(['<div class="',b.country,'">{state} {country}</div>'].join("")),w.template(t.join("<br>"),e)},this.expand=function(){var e=this;w.removeClass(this.input,b.spin),w.addClass(this.control,b.glass.expanded),setTimeout(function(){return e.input.focus()},100)},this.collapse=function(){this.input.value="",this.input.blur(),w.addClass(this.reset,b.hidden),this.clearResults()},this.clearResults=function(){w.removeAllChildren(this.result),this.hideMarker()},this.getSource=function(){return this.layer.getSource()},this.addLayer=function(){var e=this,t=this.getMap(),r=t.getLayers().find(function(t){return t===e.layer});!r&&t.addLayer(this.layer)},this.createControl(),v.call(this,{element:this.container,name:"nominatim",offline:!1})}var l=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d=e("store/application-state"),f=n(d),p=e("services/gui"),h=n(p),v=e("./control"),g=e("core/utils/utils"),m=g.toRawType,y=g.XHR,_=e("g3w-ol/projection/projections"),b={namespace:"ol-geocoder",spin:"gcd-pseudo-rotate",hidden:"gcd-hidden",inputQueryId:"gcd-input-query",inputResetId:"gcd-input-reset",country:"gcd-country",city:"gcd-city",road:"gcd-road",olControl:"ol-control",inputText:{container:"gcd-txt-container",control:"gcd-txt-control",input:"gcd-txt-input",reset:"gcd-txt-reset",result:"gcd-txt-result"}},w={isNumeric:function(e){return/^\d+$/.test(e)},classRegex:function(e){return new RegExp("(^|\\s+) "+e+" (\\s+|$)")},addClass:function(e,t,r){var n=this;if(Array.isArray(e))return void e.forEach(function(e){return n.addClass(e,t)});for(var i=Array.isArray(t)?t:t.split(/\s+/),a=i.length;a--;)this.hasClass(e,i[a])||this._addClass(e,i[a],r)},_addClass:function(e,t,r){var n=this;e.classList?e.classList.add(t):e.className=(e.className+" "+t).trim(),r&&this.isNumeric(r)&&setTimeout(function(){return n._removeClass(e,t)},r)},removeClass:function(e,t,r){var n=this;if(Array.isArray(e))return void e.forEach(function(e){
return n.removeClass(e,t,r)});for(var i=Array.isArray(t)?t:t.split(/\s+/),a=i.length;a--;)this.hasClass(e,i[a])&&this._removeClass(e,i[a],r)},_removeClass:function(e,t,r){var n=this;e.classList?e.classList.remove(t):e.className=e.className.replace(this.classRegex(t)," ").trim(),r&&this.isNumeric(r)&&setTimeout(function(){return n._addClass(e,t)},r)},hasClass:function(e,t){return e.classList?e.classList.contains(t):this.classRegex(t).test(e.className)},toggleClass:function(e,t){var r=this;return Array.isArray(e)?void e.forEach(function(e){return r.toggleClass(e,t)}):void(e.classList?e.classList.toggle(t):this.hasClass(e,t)?this._removeClass(e,t):this._addClass(e,t))},find:function(e,t,r){void 0===t&&(t=window.document);var n=/^(#?[\w-]+|\.[\w-.]+)$/,i=/\./g,a=Array.prototype.slice,o=[];if(n.test(e))switch(e[0]){case"#":o=[this.$(e.substr(1))];break;case".":o=a.call(t.getElementsByClassName(e.substr(1).replace(i," ")));break;default:o=a.call(t.getElementsByTagName(e))}else o=a.call(t.querySelectorAll(e));return r?o:o[0]},$:function(e){return e="#"===e[0]?e.substr(1,e.length):e,document.getElementById(e)},isElement:function(e){return"HTMLElement"in window?!!e&&e instanceof HTMLElement:!!e&&"object"===("undefined"==typeof e?"undefined":c(e))&&1===e.nodeType&&!!e.nodeName},getAllChildren:function(e,t){return[].slice.call(e.getElementsByTagName(t))},isEmpty:function(e){return!e||0===e.length},emptyArray:function(e){for(;e.length;)e.pop()},anyMatchInArray:function(e,t){return e.some(function(e){return t.indexOf(e)>=0})},everyMatchInArrayy:function(e,t){return t.every(function(t){return e.indexOf(t)>=0})},anyItemHasValue:function(e,t){var r=this;void 0===t&&(t=!1);var n=Object.keys(e);return n.forEach(function(n){r.isEmpty(e[n])||(t=!0)}),t},removeAllChildren:function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},removeAll:function(e){for(var t=void 0;t=e[0];)t.parentNode.removeChild(t)},getChildren:function(e,t){return[].filter.call(e.childNodes,function(e){return t?1===e.nodeType&&e.tagName.toLowerCase()===t:1===e.nodeType})},template:function(e,t){var r=this;return e.replace(/\{ *([\w_-]+) *\}/g,function(e,n){var i=void 0===t[n]?"":t[n];return r.htmlEscape(i)})},htmlEscape:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},createElement:function(e,t){var r=void 0;if(Array.isArray(e)){if(r=document.createElement(e[0]),e[1].id&&(r.id=e[1].id),e[1].classname&&(r.className=e[1].classname),e[1].attr){var n=e[1].attr;if(Array.isArray(n))for(var i=-1;++i<n.length;)r.setAttribute(n[i].name,n[i].value);else r.setAttribute(n.name,n.value)}}else r=document.createElement(e);r.innerHTML=t;for(var a=document.createDocumentFragment();r.childNodes[0];)a.appendChild(r.childNodes[0]);return r.appendChild(a),r}},x=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this.id="Nominatim (OSM)",this.active=!0;var r=ol.proj.transformExtent(t.viewbox,t.mapCrs,"EPSG:4326");this.settings={url:"https://nominatim.openstreetmap.org/search",params:{q:"",format:"json",addressdetails:1,limit:10},extent:r,viewbox:r.join(",")}}return u(e,[{key:"getParameters",value:function(e){var t=this.settings,r=t.url,n=t.viewbox,i=t.params.limit;return{url:r,params:{q:e.query,format:"json",addressdetails:1,limit:e.limit||i,viewbox:n,bounded:1}}}},{key:"handleResponse",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=t.filter(function(t){return ol.extent.containsXY(e.settings.extent,t.lon,t.lat)}).map(function(e){return{lon:e.lon,lat:e.lat,address:{name:e.address.neighbourhood||"",road:e.address.road||"",postcode:e.address.postcode,city:e.address.city||e.address.town,state:e.address.state,country:e.address.country},original:{formatted:e.display_name,details:e.address}}});return{results:r,header:{title:this.id}}}}]),e}(),S=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this.id="Google",this.active=void 0!==f["default"].keys.vendorkeys.google;var r=ol.proj.transformExtent(t.viewbox,t.mapCrs,"EPSG:4326");this.settings={url:"https://maps.googleapis.com/maps/api/geocode/json",extent:r,viewbox:r[1]+","+r[0]+"|"+r[3]+","+r[2]}}return u(e,[{key:"getParameters",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.lang,r=this.settings,n=r.url,i=r.viewbox,a={address:e.query,key:f["default"].keys.vendorkeys.google,bounds:i,language:t};return{url:n,params:a}}},{key:"handleResponse",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=[];return"OK"===t.status?r=t.results.filter(function(t){return ol.extent.containsXY(e.settings.extent,t.geometry.location.lng,t.geometry.location.lat)}).map(function(e){var t=void 0,r=void 0,n=void 0,i=void 0,a=void 0;return e.address_components.forEach(function(e){var r=e.types,i=(e.short_name,e.long_name);r.find(function(e){return"route"===e})?t=i:r.find(function(e){return"locality"===e})?n=i:r.find(function(e){return"country"===e})&&(a=i)}),{lon:e.geometry.location.lng,lat:e.geometry.location.lat,address:{name:t,road:r,postcode:"",city:n,state:i,country:a},original:{formatted:e.display_name,details:e.address}}}):"REQUEST_DENIED"===t.status&&(this.active=!1),{results:r,header:{title:this.id}}}}]),e}();ol.inherits(s,v),t.exports=s},{"./control":79,"core/utils/utils":68,"g3w-ol/projection/projections":111,"services/gui":361,"store/application-state":373}],81:[function(e,t,r){function n(){var e={visible:!1,offline:!1,name:"geolocation",tipLabel:"sdk.mapcontrols.geolocation.tooltip",label:""};this._layer=new ol.layer.Vector({source:new ol.source.Vector,style:new ol.style.Style({text:new ol.style.Text({offsetY:-15,text:"",font:'900 3em "Font Awesome 5 Free"',fill:new ol.style.Fill({color:"red"})})})}),i.call(this,e)}var i=e("g3w-ol/controls/interactioncontrol");ol.inherits(n,i);var a=n.prototype;a._showMarker=function(e){var t=e.map,r=e.coordinates,n=e.show,i=void 0===n||n;if(this._layer)if(this._layer.getSource().clear(),i){t.getView().setCenter(r);var a=new ol.Feature({geometry:new ol.geom.Point(r)});this._layer.getSource().addFeature(a),t.addLayer(this._layer)}else t.removeLayer(this._layer)},a.getMap=function(){return i.prototype.getMap.call(this)},a.setMap=function(e){var t=this,r=void 0;i.prototype.setMap.call(this,e);var n=new ol.Geolocation({projection:e.getView().getProjection(),tracking:!0,trackingOptions:{enableHighAccuracy:!0}});n.on("change:position",function(){var r=n.getPosition();r?(t.isVisible()||(t.setVisible(!0),$(t.element).removeClass("g3w-ol-disabled"),n.dispatchEvent("authorized")),t._showMarker({map:e,coordinates:r,show:t.isToggled()})):t.hideControl()}),n.once("error",function(e){t.hideControl(),t._layer=null,1!==e.code&&t.dispatchEvent("error"),ol.Observable.unByKey(r),r=null}),n.once("authorized",function(){r=t.on("toggled",function(){var r=n.getPosition();t._showMarker({map:e,coordinates:r,show:t.isToggled()})})})},t.exports=n},{"g3w-ol/controls/interactioncontrol":83}],82:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a.call(this,i({name:"maptoimagegeo",tipLabel:"Geo Screenshot",label:""},e))}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=e("g3w-ol/controls/screenshotcontrol");ol.inherits(n,a),t.exports=n},{"g3w-ol/controls/screenshotcontrol":95}],83:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("g3w-ol/constants"),a=e("services/gui"),o=n(a),s=e("store/map-controls"),l=n(s),u=e("core/i18n/i18n.service"),c=u.t,d=e("g3w-ol/controls/control"),f=function h(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.visible,n=void 0===r||r,i=t.enabled,a=void 0===i||i,o=t.toggled,s=void 0!==o&&o,l=t.clickmap,u=void 0!==l&&l,c=t.interactionClass,f=void 0===c?null:c,p=t.autountoggle,v=void 0!==p&&p,g=t.geometryTypes,m=void 0===g?[]:g,y=t.onhover,_=void 0!==y&&y,b=t.help,w=void 0===b?null:b,x=t.toggledTool,S=t.interactionClassOptions,L=void 0===S?{}:S,C=t.layers,k=void 0===C?[]:C,E=t.spatialMethod;this.layers=k,this.unwatches=[],this.listenLayersVisibilityChange(),this._visible=n,this._toggled=!1,this.clickmap=u,this._interactionClass=f,this._interaction=null,this._autountoggle=v,this._geometryTypes=m,this._onhover=_,this._help=w,this._helpButton,this._toolButton,this.spatialMethod=E,this.toggledTool,this._interactionClassOptions=L,t.buttonClickHandler=h.prototype._handleClick.bind(this),d.call(this,t),!0===s&&this.on("setMap",function(){return e.toggle(s)}),this._help&&this._createModalHelp(),x&&this.createControlTool(x),this.setEnable(a),this.spatialMethod&&this.handleChangeSpatialMethod(this.spatialMethod)};ol.inherits(f,d);var p=f.prototype;p.onSelectLayer=function(){},p.runSpatialQuery=function(){},p.clear=function(){},p.onAddExternalLayer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.layer,e.unWatches},p.onRemoveExternalLayer=function(e){},p.handleSelectedLayer=function(e){},p.handleExternalSelectedLayer=function(e){},p.checkVisibile=function(e){return!0},p.checkVisibile=function(e){return!0},p.listenLayersVisibilityChange=function(){},p.change=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.layers=e;var t=this.checkVisibile(e);this.setVisible(t),this.setEnable(!1),this.listenLayersVisibilityChange()},p.isClickMap=function(){return this.clickmap},p.enable=function(){$(this.element).removeClass("g3w-disabled")},p.disable=function(){$(this.element).addClass("g3w-disabled")},p.createControlTool=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.type,n=t.component,a=t.how,s=void 0===a?"toggled":a;switch(r){case"spatialMethod":var l=this.getSpatialMethod();this.toggledTool={data:function(){return this.methods=i.SPATIALMETHODS,{method:l}},template:'\n          <div style="width: 100%; padding: 5px;">\n            <select ref="select" style="width: 100%"  :search="false" v-select2="\'method\'">\n              <option v-for="method in methods">{{method}}</option>\n            </select>\n          </div>',watch:{method:function(t){return e.setSpatialMethod(t)}},created:function(){o["default"].setCloseUserMessageBeforeSetContent(!1)},beforeDestroy:function(){o["default"].setCloseUserMessageBeforeSetContent(!0)}};break;case"custom":this.toggledTool=n}switch(s){case"hover":this._createToolOnHoverButton()}},p._createToolOnHoverButton=function(){var e=this;this._onhover&&(this._toolButton=$('<span style="display:none" class="tool_mapcontrol_button"><i class="'+o["default"].getFontClass("tool")+'"></i></span>'),$(this.element).prepend(this._toolButton),this._toolButton.on("click",function(t){t.stopPropagation(),e.showToggledTool(!0)}),$(this.element).hover(function(){return e._toggled&&e._toolButton.show()}),$(this.element).mouseleave(function(){return e._toolButton.hide()}))},p.showToggledTool=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e?o["default"].showUserMessage({title:"",type:"tool",size:"small",closable:!!this._toolButton,hooks:{body:this.toggledTool}}):o["default"].closeUserMessage()},p._showModalHelp=function(){o["default"].showModalDialog({title:c(this._help.title),message:c(this._help.message)})},p._createModalHelp=function(){var e=this;this._onhover&&(this._helpButton=$('<span style="display:none" class="info_mapcontrol_button">i</span>'),$(this.element).prepend(this._helpButton),this._helpButton.on("click",function(t){t.stopPropagation(),e._showModalHelp()}),$(this.element).hover(function(){return e._helpButton.show()}),$(this.element).mouseleave(function(){return e._helpButton.hide()}))},p.getGeometryTypes=function(){return this._geometryTypes},p.isToggled=function(){return this._toggled},p.getControlBottom=function(){return $(this.element).find("button").first()},p.addClassToControlBottom=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.getControlBottom();t.addClass(e)},p.removeClassToControlBottom=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.getControlBottom();t.removeClass(e)},p.toggle=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this._toggled;this._toggled!==e&&(this._toggled=e,e?(this._interaction&&this._interaction.setActive(!0),this.addClassToControlBottom("g3w-ol-toggled"),this._toolButton&&this._toolButton.show()):(this._help&&this._helpButton.hide(),this._interaction&&this._interaction.setActive(!1),this.removeClassToControlBottom("g3w-ol-toggled"),this._toolButton&&this._toolButton.hide(),this.toggledTool&&this.showToggledTool(!1)),void 0===this._toolButton&&this.toggledTool&&this.showToggledTool(this._toggled),this.dispatchEvent({type:"toggled",toggled:e}))},p.getGeometryTypes=function(){return this._geometryTypes},p.setGeometryTypes=function(e){this._geometryTypes=e},p.setMap=function(e){d.prototype.setMap.call(this,e),!this._interaction&&this._interactionClass&&(this._interaction=new this._interactionClass(this._interactionClassOptions),e.addInteraction(this._interaction),this._interaction.setActive(!1)),this.dispatchEvent({type:"setMap",map:e})},p._handleClick=function(e){this._enabled&&(this.toggle(),d.prototype._handleClick.call(this,e))},p.getInteraction=function(){return this._interaction},p.setSpatialMethod=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"intersects";this.spatialMethod=e,this.dispatchEvent({type:"change-spatial-method",spatialMethod:this.spatialMethod})},p.getSpatialMethod=function(){return this.spatialMethod},p.setLayers=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.layers=e},p.setSelectedLayer=function(e){l["default"].setSelectedLayer(e)},p.getSelectedLayer=function(){return l["default"].getSelectedLayer()},p.getExternalLayers=function(){return l["default"].getExternalLayers()},p.handleChangeSpatialMethod=function(e){var t=this,r=null,n=function(){ol.Observable.unByKey(r),r=null};this.on("toggled",function(i){var a=i.toggled;!0===a?r=t.on("change-spatial-method",t.runSpatialQuery):null!==r&&(n(),t.setSpatialMethod(e),t.clear())})},p.watchLayer=function(e,t){return i.VM.$watch(e,t)},p.isSelectedLayerVisible=function(){return"function"==typeof this.getSelectedLayer().isVisible?this.getSelectedLayer().isVisible():this.getSelectedLayer().visible},p.hasVisibleProjectLayer=function(){return!!(this.layers.length>0&&this.layers.find(function(e){return e.isVisible()}))},p.hasVisibleExternalLayer=function(){var e=this;return!!this.getExternalLayers().find(function(t){return t!==e.layer&&!0===t.visible})},p.hasVisibleLayers=function(){return!(!this.hasVisibleProjectLayer()&&!this.hasVisibleExternalLayer())},p.addExternalLayerToResult=function(){var e=this;return null===this.getSelectedLayer()||"undefined"!=typeof this.getExternalLayers().find(function(t){return t===e.getSelectedLayer()})},p.isExternalLayerSelected=function(){var e=this;return null!==this.getSelectedLayer()&&"undefined"!=typeof this.getExternalLayers().find(function(t){return t===e.getSelectedLayer()})},t.exports=f},{"core/i18n/i18n.service":13,"g3w-ol/constants":75,"g3w-ol/controls/control":79,"services/gui":361,"store/map-controls":376}],84:[function(e,t,r){var n=e("core/utils/ol"),i=e("g3w-ol/interactions/lengthinteraction"),a=e("g3w-ol/controls/measurecontrol"),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={tipLabel:"sdk.mapcontrols.measures.length.tooltip",label:"",clickmap:!0,interactionClass:i};e=n.merge(e,t),a.call(this,e)};ol.inherits(o,a),t.exports=o},{"core/utils/ol":66,"g3w-ol/controls/measurecontrol":85,"g3w-ol/interactions/lengthinteraction":103}],85:[function(e,t,r){var n=e("g3w-ol/controls/interactioncontrol"),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._map=null,n.call(this,e)};ol.inherits(i,n);var a=i.prototype;a.setMap=function(e){n.prototype.setMap.call(this,e)},a.toggle=function(e){n.prototype.toggle.call(this,e),!this.isToggled()&&this.getInteraction()&&this.getInteraction().clear()},t.exports=i},{"g3w-ol/controls/interactioncontrol":83}],86:[function(e,t,r){var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.target=e.target||"mouse-position-control",ol.control.MousePosition.call(this,e)};ol.inherits(n,ol.control.MousePosition),t.exports=n;var i=n.prototype;i.offline=!0,i.setEnable=function(e){e?$(this.element):$(this.element)},i.setMap=function(e){e&&($(this.element).removeClass("ol-control"),ol.control.MousePosition.prototype.setMap.call(this,e))}},{}],87:[function(e,t,r){var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};switch(this._control=null,this.positionCode=e.position||"tl",e.type){case"zoom":this._control=new ol.control.Zoom(e);break;case"zoomtoextent":this._control=new ol.control.ZoomToExtent(e);break;case"scaleline":this._control=new ol.control.ScaleLine(e);break;case"overview":this._control=new ol.control.OverviewMap(e)}$(this._control.element).addClass("ol-control-"+this.positionCode),ol.control.Control.call(this,{element:this._control.element})};ol.inherits(n,ol.control.Control),t.exports=n;var i=n.prototype;i.offline=!0,i.getOlControl=function(){return this._control},i.getPosition=function(e){e=e||this.positionCode;var t={};return t.top=e.indexOf("t")>-1,t.left=e.indexOf("l")>-1,t},i.layout=function(e){if(e){var t=this.getPosition(),r=e.getViewport(),n=$(r).find(".ol-control-"+this.positionCode);if(n.length){previusControl=n.last();var i=t.left?previusControl.position().left:previusControl.position().right,a=t.left?"left":"right",o=previusControl[0].offsetWidth,s=$(this.element).position()[a]+i+o+2;$(this.element).css(a,s+"px")}}},i.changelayout=function(){},i.showHide=function(){$(this.element).toggle()},i.setMap=function(e){this.layout(e),this._control.setMap(e)}},{}],88:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._originalonlick=null,this._onclick=e.onclick,a.call(this,e)}var a=e("g3w-ol/controls/control");ol.inherits(i,a);var o=i.prototype;o.overwriteOnClickEvent=function(e){this._originalonlick=this._originalonlick||this._onclick,this._onclick=e},o.resetOriginalOnClickEvent=function(){this._onclick=this._originalonlick||this._onclick,this._originalonlick=null},o.setMap=function(e){var t=this;a.prototype.setMap.call(this,e);var r=$(this.element),i=r.children("button"),o=!1;r.on("click",n(regeneratorRuntime.mark(function s(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=9;break}if(o=!0,i.addClass("g3w-ol-disabled"),e.t0=t._onclick,!e.t0){e.next=7;break}return e.next=7,t._onclick();case 7:i.removeClass("g3w-ol-disabled"),o=!1;case 9:case"end":return e.stop()}},s,t)})))},t.exports=i},{"g3w-ol/controls/control":79}],89:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("g3w-ol/constants"),s=e("services/gui"),l=n(s),u=e("services/data"),c=n(u),d=e("store/projects"),f=n(d),p=e("core/utils/utils"),h=p.throttle,v=e("g3w-ol/controls/interactioncontrol"),g={SELECTED_OR_ALL:!0,FILTERABLE:!0,VISIBLE:!0},m={filtrable:{ows:"WFS"}},y=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.spatialMethod,n=void 0===r?o.SPATIALMETHODS[0]:r;this._startCoordinate=null,this.unwatches=[];var i=l["default"].getService("map").filterableLayersAvailable(m)||[];i.forEach(function(e){return e.setTocHighlightable(!0)});var s=a({},t,{layers:i,offline:!1,name:"querybbox",tipLabel:"sdk.mapcontrols.querybybbox.tooltip",label:t.label||"",clickmap:!0,interactionClass:ol.interaction.DragBox,onhover:!0,toggledTool:{type:"spatialMethod",how:"toggled"},spatialMethod:n,help:{title:"sdk.mapcontrols.querybybbox.help.title",message:"sdk.mapcontrols.querybybbox.help.message"}});v.call(this,s),this.setEnable(this.hasVisibleLayers()),this.bbox=null,this.on("toggled",function(t){var r=t.toggled;e.getExternalLayers().forEach(function(e){return e.tochighlightable=r})})};ol.inherits(y,v);var _=y.prototype;_.change=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.layers=e,this.setEnable(this.hasVisibleLayers()),this.listenLayersVisibilityChange()},_.checkVisible=function(){return this.layers.length>0||this.getExternalLayers().length>0},_.setMap=function(e){var t=this;v.prototype.setMap.call(this,e),this._interaction.on("boxstart",function(e){return t._startCoordinate=e.coordinate}),this._interaction.on("boxend",h(function(e){t.bbox=ol.extent.boundingExtent([t._startCoordinate,e.coordinate]),t.dispatchEvent({type:"bboxend",extent:t.bbox}),t._startCoordinate=null,t._autountoggle&&t.toggle()})),this.setEventKey({eventType:"bboxend",eventKey:this.on("bboxend",this.runSpatialQuery)})},_.onSelectLayer=function(e){if(e){var t=this.layers.find(function(t){return t===e});this.setEnable(!!t&&t.isVisible())}else this.setEnable(this.hasVisibleLayers());this.toggle(this.isToggled()&&this.getEnable())},_.listenLayersVisibilityChange=function(){var e=this;this.unwatches.forEach(function(e){return e()}),this.unwatches.splice(0),this.layers.forEach(function(t){e.unwatches.push(e.watchLayer(function(){return t.state.visible},function(r){!0===t.state.selected?e.setEnable(r):e.setEnable(e.hasVisibleLayers()),e.toggle(e.isToggled()&&e.getEnable())}))})},_.runSpatialQuery=i(regeneratorRuntime.mark(function b(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this.bbox){e.next=2;break}return e.abrupt("return");case 2:return l["default"].closeOpenSideBarComponent(),e.prev=3,e.next=6,c["default"].getData("query:bbox",{inputs:{bbox:this.bbox,feature_count:f["default"].getCurrentProject().getQueryFeatureCount(),addExternal:this.addExternalLayerToResult(),layersFilterObject:g,filterConfig:{spatialMethod:this.getSpatialMethod()},condition:m,multilayers:f["default"].getCurrentProject().isQueryMultiLayers(this.name)}});case 6:e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](3);case 11:case"end":return e.stop()}},b,this,[[3,8]])})),_.onAddExternalLayer=function(e){var t=this,r=e.layer,n=e.unWatches;r.tochighlightable=this.isToggled()&&this.getEnable(),n.push(this.watchLayer(function(){return r.selected},function(e){t.setEnable(!0===e?r.visible:t.hasVisibleLayers()),t.toggle(t.isToggled()&&t.getEnable())})),n.push(this.watchLayer(function(){return r.visible},function(){t.setEnable(t.hasVisibleLayers()),t.toggle(t.isToggled()&&t.getEnable())})),this.setEnable(this.hasVisibleLayers())},_.onRemoveExternalLayer=function(){this.setEnable(this.isThereVisibleLayerNotSelected())},_.clear=function(){this.bbox=null},t.exports=y},{"core/utils/utils":68,"g3w-ol/constants":75,"g3w-ol/controls/interactioncontrol":83,"services/data":358,"services/gui":361,"store/projects":379}],90:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("services/gui"),s=n(o),l=e("services/data"),u=n(l),c=e("store/projects"),d=n(c),f=e("core/utils/utils"),p=f.throttle,h=e("g3w-ol/controls/basequerypolygoncontrol"),v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=s["default"].getService("map").filterableLayersAvailable({filtrable:{ows:"WFS"}})||[],r=a({},e,{name:"querybydrawpolygon",tipLabel:"sdk.mapcontrols.querybydrawpolygon.tooltip",customClass:s["default"].getFontClass("draw"),clickmap:!0,interactionClass:ol.interaction.Draw,interactionClassOptions:{type:"Polygon"},layers:t,help:{title:"sdk.mapcontrols.querybybbox.help.title",message:"sdk.mapcontrols.querybybbox.help.message"}});h.call(this,r),this.setEnable(this.hasVisibleLayers()),this.feature=null};ol.inherits(v,h);var g=v.prototype;g.setMap=function(e){var t=this;h.prototype.setMap.call(this,e),this._interaction.on("drawend",p(function(e){t.feature=e.feature,t.dispatchEvent({type:"drawend",feature:t.feature}),t._autountoggle&&t.toggle()})),this.setEventKey({eventType:"drawend",eventKey:this.on("drawend",this.runSpatialQuery)})},g.onSelectLayer=function(e){if(e){var t=this.layers.find(function(t){return t===e});this.setEnable(!!t&&t.isVisible())}else this.setEnable(this.hasVisibleLayers());this.toggle(this.isToggled()&&this.getEnable())},g.listenLayersVisibilityChange=function(){var e=this;this.unwatches.forEach(function(e){return e()}),this.unwatches.splice(0),this.layers.forEach(function(t){e.unwatches.push(e.watchLayer(function(){return t.state.visible},function(t){null===e.getSelectedLayer()?e.setEnable(e.hasVisibleLayers()):e.setEnable(e.isSelectedLayerVisible()),e.toggle(e.isToggled()&&e.getEnable())}))})},g.onAddExternalLayer=function(e){var t=this,r=e.layer,n=e.unWatches;n.push(this.watchLayer(function(){return r.selected},function(e){t.setEnable(!0===e?r.visible:t.hasVisibleLayers()),t.toggle(t.isToggled()&&t.getEnable())})),n.push(this.watchLayer(function(){return r.visible},function(e){t.setEnable(!0===r.selected?e:t.hasVisibleLayers()),t.toggle(t.isToggled()&&t.getEnable())})),this.setEnable(this.hasVisibleLayers())},g.onRemoveExternalLayer=function(){this.setEnable(this.hasVisibleLayers())},g.runSpatialQuery=i(regeneratorRuntime.mark(function m(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s["default"].closeOpenSideBarComponent(),e.prev=1,e.next=4,u["default"].getData("query:polygon",{inputs:{layerName:"Draw",feature:this.feature,excludeSelected:null===this.getSelectedLayer(),external:{add:this.addExternalLayerToResult(),filter:{SELECTED:this.isExternalLayerSelected()}},filterConfig:{spatialMethod:this.getSpatialMethod()},multilayers:d["default"].getCurrentProject().isQueryMultiLayers(this.name)},outputs:{show:function(e){var t=e.error,r=void 0!==t&&t;return!r}}});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](1);case 9:case"end":return e.stop()}},m,this,[[1,6]])})),g.clear=function(){this.feature=null},t.exports=v},{"core/utils/utils":68,"g3w-ol/controls/basequerypolygoncontrol":78,"services/data":358,"services/gui":361,"store/projects":379}],91:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=e("services/gui"),l=n(s),u=e("services/data"),c=n(u),d=e("store/projects"),f=n(d),p=e("core/utils/utils"),h=p.throttle,v=e("core/utils/geo"),g=v.getMapLayersByFilter,m=v.Geometry,y=e("g3w-ol/controls/basequerypolygoncontrol"),_=e("g3w-ol/interactions/pickcoordinatesinteraction"),b=m.getAllPolygonGeometryTypes(),w={filtrable:{ows:"WFS"}},x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=g({QUERYABLE:!0,SELECTED_OR_ALL:!0}),r=l["default"].getService("map").filterableLayersAvailable(w),n=o({},e,{offline:!1,enabled:!1,name:"querybypolygon",tipLabel:"sdk.mapcontrols.querybypolygon.tooltip",label:e.label||"",interactionClass:_,layers:r.length?[].concat(a(new Set([].concat(a(r),a(t))))):[],help:{title:"sdk.mapcontrols.querybypolygon.help.title",message:"sdk.mapcontrols.querybypolygon.help.message"}});y.call(this,n),this.data={layer:null,feature:null,coordinates:null}};ol.inherits(x,y);var S=x.prototype;S.change=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.layers=e,this.setEnable(!1),this.listenLayersVisibilityChange()},S.checkVisibile=function(e){if(!e.length||1===e.length)return!1;var t=e.filter(function(e){return e.isFilterable()}),r=e.filter(function(e){return-1!==b.indexOf(e.getGeometryType())});return 1===r.length&&1===t.length?t[0]!==r[0]:r.length>0&&t.length>0},S.setMap=function(e){var t=this;y.prototype.setMap.call(this,e),this._interaction.on("picked",h(function(){var e=i(regeneratorRuntime.mark(function r(e){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:t.data.coordinates=e.coordinate,t.dispatchEvent({type:"picked",coordinates:t.data.coordinates}),t._autountoggle&&t.toggle();case 3:case"end":return r.stop()}},r,t)}));return function(t){return e.apply(this,arguments)}}())),this.setEventKey({eventType:"picked",eventKey:this.on("picked",this.getPolygonFeatureFromCoordinates)}),this.setEnable(!1)},S.onSelectLayer=function(e){e&&e.isQueryable()&&-1!==this.getGeometryTypes().indexOf(e.getGeometryType())?(this.setEnable(this.isThereVisibleLayerNotSelected()),this.toggle(this.isToggled()&&this.getEnable())):(this.setEnable(!1),this.toggle(!1))},S.listenLayersVisibilityChange=function(){var e=this;this.unwatches.forEach(function(e){return e()}),this.unwatches.splice(0),this.layers.forEach(function(t){e.unwatches.push(e.watchLayer(function(){return t.state.visible},function(r){t===e.getSelectedLayer()?e.setEnable(r&&e.isThereVisibleLayerNotSelected()):e.setEnable(e.isThereVisibleLayerNotSelected()),e.toggle(e.isToggled()&&e.getEnable())}))})},S.getPolygonFeatureFromCoordinates=i(regeneratorRuntime.mark(function L(){var e,t,r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return l["default"].closeOpenSideBarComponent(),n.prev=1,n.next=4,c["default"].getData("query:coordinates",{inputs:{feature_count:f["default"].getCurrentProject().getQueryFeatureCount(),coordinates:this.data.coordinates},outputs:{show:function i(e){var t=e.data,r=void 0===t?[]:t,n=e.query,i=0===r.length;return n.coordinates=i?n.coordinates:null,i}}});case 4:e=n.sent,t=e.data,r=void 0===t?[]:t,r.length&&r[0].features.length&&(this.data.feature=r[0].features[0],this.data.layer=r[0].layer,this.runSpatialQuery()),n.next=13;break;case 10:n.prev=10,n.t0=n["catch"](1);case 13:case"end":return n.stop()}},L,this,[[1,10]])})),S.isThereVisibleLayerNotSelected=function(){var e=this;return!(!this.getSelectedLayer()||!this.isSelectedLayerVisible()||!this.layers.find(function(t){return t!==e.getSelectedLayer()&&t.isVisible()&&t.isFilterable(w.filtrable)})&&!this.getExternalLayers().find(function(t){return t!==e.getSelectedLayer()&&!0===t.visible}))},S.listenPolygonLayersChange=function(){this.listenLayersVisibilityChange()},S.onAddExternalLayer=function(e){var t=this,r=e.layer,n=e.unWatches;m.isPolygonGeometryType(r.geometryType)&&(n.push(this.watchLayer(function(){return r.selected},function(e){!0===e?t.setEnable(r.visible&&t.isThereVisibleLayerNotSelected()):t.setEnable(!1),
t.toggle(t.isToggled()&&t.getEnable())})),n.push(this.watchLayer(function(){return r.visible},function(e){r.selected?t.setEnable(e&&t.isThereVisibleLayerNotSelected()):t.setEnable(t.isThereVisibleLayerNotSelected()),t.toggle(t.isToggled()&&t.getEnable())}))),this.setEnable(this.isThereVisibleLayerNotSelected())},S.onRemoveExternalLayer=function(){this.setEnable(this.isThereVisibleLayerNotSelected())},S.runSpatialQuery=i(regeneratorRuntime.mark(function C(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this.data.coordinates&&null!==this.data.feature&&null!==this.data.layer){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,c["default"].getData("query:polygon",{inputs:{layerName:this.data.layer.getName?this.data.layer.getName():this.data.layer.get("name"),excludeSelected:!0,feature:this.data.feature,external:{add:!0,filter:{SELECTED:!1}},filterConfig:{spatialMethod:this.getSpatialMethod()},multilayers:f["default"].getCurrentProject().isQueryMultiLayers(this.name)},outputs:{show:function(e){var t=e.error,r=void 0!==t&&t;return!r}}});case 4:case"end":return e.stop()}},C,this)})),S.clear=function(){this.data.layer=this.data.feature=this.data.coordinates=null},t.exports=x},{"core/utils/geo":64,"core/utils/utils":68,"g3w-ol/controls/basequerypolygoncontrol":78,"g3w-ol/interactions/pickcoordinatesinteraction":105,"services/data":358,"services/gui":361,"store/projects":379}],92:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}var a=e("services/gui"),o=n(a),s=e("store/projects"),l=n(s),u=e("services/data"),c=n(u),d=e("core/utils/utils"),f=d.throttle,p=e("core/utils/ol"),h=e("g3w-ol/controls/interactioncontrol"),v=e("g3w-ol/interactions/pickcoordinatesinteraction"),g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={offline:!1,name:"querylayer",tipLabel:"sdk.mapcontrols.query.tooltip",label:e.label||"",clickmap:!0,interactionClass:v};e=p.merge(e,t),h.call(this,e)};ol.inherits(g,h);var m=g.prototype;m.setMap=function(e){var t=this,r=null;this.on("toggled",function(n){var i=n.toggled;!0!==i?(ol.Observable.unByKey(r),r=null):null===r&&e&&(r=e.on("singleclick",f(function(e){return t.dispatchEvent({type:"picked",coordinates:e.coordinate})})))}),this.setEventKey({eventType:"picked",eventKey:this.on("picked",this.runQuery)}),h.prototype.setMap.call(this,e)},m.runQuery=function(){var e=i(regeneratorRuntime.mark(function t(e){var r,n=e.coordinates;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o["default"].closeOpenSideBarComponent(),e.prev=1,r=l["default"].getCurrentProject(),e.next=5,c["default"].getData("query:coordinates",{inputs:{coordinates:n,feature_count:r.getQueryFeatureCount(),query_point_tolerance:r.getQueryPointTolerance(),multilayers:r.isQueryMultiLayers(this.name)}});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](1);case 10:case"end":return e.stop()}},t,this,[[1,7]])}));return function(t){return e.apply(this,arguments)}}(),t.exports=g},{"core/utils/ol":66,"core/utils/utils":68,"g3w-ol/controls/interactioncontrol":83,"g3w-ol/interactions/pickcoordinatesinteraction":105,"services/data":358,"services/gui":361,"store/projects":379}],93:[function(e,t,r){var n=e("core/utils/ol"),i=e("g3w-ol/controls/interactioncontrol"),a=function(e){this._toggled=!0,this._startCoordinate=null;var t={name:"reset",tipLabel:"Pan",label:""};e=n.merge(e,t),i.call(this,e)};ol.inherits(a,i),t.exports=a;var o=a.prototype;o._postRender=function(){this.toggle(!0)}},{"core/utils/ol":66,"g3w-ol/controls/interactioncontrol":83}],94:[function(e,t,r){var n=e("app/constant"),i=e("core/i18n/i18n.service"),a=i.t,o=e("core/utils/ol"),s=o.getResolutionFromScale,l=o.getScaleFromResolution,u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.isMobile=e.isMobile||!1,e.target="scale-control",ol.control.Control.call(this,e)};ol.inherits(u,ol.control.Control),t.exports=u;var c=u.prototype;c.offline=!0,c.changelayout=function(e){this.position,$(this.element)},c.layout=function(e){function t(){c.find("option").each(function(e,t){return n.scales.indexOf(1*t.value)===-1&&$(t).remove()})}function r(e){if(c.find("option[value='"+e.id+"']").length)c.val(e.id).trigger("change");else{t();var r=new Option(e.text,e.id,(!0),(!0));c.append(r).trigger("change")}}var n=this,i=!1,o=!1,u=$(this.element),c=u.children("select").select2({tags:!0,dropdownParent:$(e.getTargetElement()),width:"120px",height:"20px",language:{noResults:function(e){return a("sdk.mapcontrols.scale.no_valid_scale")}},minimumResultsForSearch:this.isMobile?-1:0,createTag:function(e){var r=null,i=void 0;return e.term.indexOf("1:")!==-1?i=e.term.split("1:")[1]:Number.isInteger(Number(e.term))&&Number(e.term)>0&&(i=Number(e.term),1*i<=n.scales[0]&&(r={id:i,text:"1:"+e.term,"new":!0},t())),r}});e.on("change:size",function(){return c.select2("close")}),e.on("moveend",function(){if(i){var e=this.getView(),t=e.getResolution(),n=e.getProjection().getUnits(),a=parseInt(l(t,n)),s={id:a,text:"1:"+a,"new":!0};r(s),i=!1}else o=!1});var d=function(){e.getView().on("change:resolution",function(){return i=!o})};d(),e.on("change:view",function(){return d()}),c.on("select2:select",function(n){o=!0;var i=n.params.data;i["new"]&&(t(),r(i));var a=e.getView().getProjection().getUnits(),l=1*i.id,u=s(l,a);e.getView().setResolution(u)})},c._setScales=function(e){var t=e.getView().getProjection().getUnits(),r=e.getView().getResolution(),i=parseInt(l(r,t));this.scales=n.PRINT_SCALES.map(function(e){return e.value}).filter(function(e){return e<i}),this.scales.unshift(i),this._createControl()},c._createControl=function(){var e=document.createElement("div"),t=document.createElement("select"),r=document.createElement("optgroup");if(r.label="",this.scales.forEach(function(e,t){var n=document.createElement("option");n.value=e,n.text="1:"+e,n.selected=0===t,r.appendChild(n)}),t.appendChild(r),!this.isMobile){var n=document.createElement("optgroup");n.label="Custom",t.appendChild(n)}e.appendChild(t),this.element=e,$(this.element).css("height","20px")},c.setMap=function(e){e&&(this._setScales(e),this.layout(e),ol.control.Control.prototype.setMap.call(this,e))}},{"app/constant":4,"core/i18n/i18n.service":13,"core/utils/ol":66}],95:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e=c({name:"maptoimage",tipLabel:"Screenshot",label:"",toggled:!1,visible:!0,layers:[]},e),this.layers=e.layers,v.call(this,e),this.setVisible(this.checkVisible(this.layers)),this.isVisible()&&(f["default"].getService("map").onafter("loadExternalLayer",this._addLayer.bind(this)),f["default"].getService("map").onafter("unloadExternalLayer",this._removeLayer.bind(this)))}function a(e){var t=void 0;return!o(e)&&!s(e)&&(l(e)?(t=e.getSource().getUrl(),t&&!h(t,location)):!!u(e)&&(t=e.getConfig().source.url,t&&!h(t,location)))}function o(e){return e.getVisible&&!e.getVisible()}function s(e){return e instanceof ol.layer.Vector}function l(e){return e instanceof ol.layer.Tile||e instanceof ol.layer.Image}function u(e){return e.getConfig().source&&e.getConfig().source.external}var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},d=e("services/gui"),f=n(d),p=e("core/utils/utils"),h=p.sameOrigin,v=e("g3w-ol/controls/onclickcontrol");ol.inherits(i,v);var g=i.prototype;g._addLayer=function(e){var t=this;this.layers.push(e),this.change(this.layers),e.on("change:visible",function(){return t.change(t.layers)})},g._removeLayer=function(e){this.layers=this.layers.filter(function(t){return t!==e}),this.change(this.layers)},g.change=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.setVisible(this.checkVisible(e))},g.checkVisible=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.isVisible()&&!e.some(a)},t.exports=i},{"core/utils/utils":68,"g3w-ol/controls/onclickcontrol":88,"services/gui":361}],96:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=e("store/application-state"),o=n(a),s=e("services/gui"),l=n(s),u=e("core/utils/utils"),c=u.XHR,d=e("core/utils/ol"),f=e("gui/streetview/vue/streetview"),p=e("g3w-ol/controls/interactioncontrol"),h=e("g3w-ol/interactions/pickcoordinatesinteraction"),v="https://maps.googleapis.com/maps/api/",g=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r={offline:!1,visible:!0,name:"streetview",tipLabel:"StreetView",clickmap:!0,label:"",interactionClass:h};this.key=o["default"].keys.vendorkeys.google,this.keyError,this.key&&c.get({url:v+"streetview?location=0,0&size=456x456&key="+this.key})["catch"](function(t){return e.keyError=t.responseText}),$script(v+"js?"+(this.key?"key="+this.key:"")),this._sv=null,this._panorama=null,this._map=null,this._projection=null,this._lastposition=null,this._streetViewFeature=new ol.Feature;var n=new ol.source.Vector({features:[]});this.active=!1,this._layer=new ol.layer.Vector({source:n,style:function(e){var t=e.getGeometry().getCoordinates();this._lastposition=this._lastposition?this._lastposition:t;var r=t[0]-this._lastposition[0],n=t[1]-this._lastposition[1],i=-Math.atan2(n,r),a=[new ol.style.Style({text:new ol.style.Text({text:"",font:"bold 18px icomoon",fill:new ol.style.Fill({color:"#ffffff"})})}),new ol.style.Style({image:new ol.style.Icon({src:"/static/client/images/streetviewarrow.png",rotation:i})})];return this._lastposition=t,a}}),t=d.merge(t,r),p.call(this,t)};ol.inherits(g,p);var m=g.prototype;m.setProjection=function(e){this._projection=e},m.setPosition=function(e){var t=this,r=this;this.active=!0;var n=void 0;this._sv||(this._sv=new google.maps.StreetViewService),this._sv.getPanorama({location:e},function(e,t){r._panorama=new google.maps.StreetViewPanorama(document.getElementById("streetview"),{imageDateControl:!0}),r._panorama.addListener("position_changed",function(){if(r.isToggled()){var e=ol.proj.transform([this.getPosition().lng(),this.getPosition().lat()],"EPSG:4326",r._projection.getCode());r._streetViewFeature.setGeometry(new ol.geom.Point(e)),n=r._map.getPixelFromCoordinate(e),(n[0]+15>r._map.getSize()[0]||n[1]+15>r._map.getSize()[1]||n[0]<15||n[1]<15)&&r._map.getView().setCenter(e)}}),e&&e.location&&(r._panorama.setPov({pitch:0,heading:0}),r._panorama.setPosition(e.location.latLng))}).then(function(e){void 0===e&&l["default"].closeContent()})["catch"](function(){return t.toggle()})},m.setMap=function(e){var t=this;this._map=e,p.prototype.setMap.call(this,e),this.setProjection(this._map.getView().getProjection()),this._map.addLayer(this._layer),this._interaction.on("picked",function(e){var r=e.coordinate;t.showStreetView(r),t._autountoggle&&t.toggle()})},m.showStreetView=function(e){var t=ol.proj.transform(e,this._map.getView().getProjection().getCode(),"EPSG:4326"),r=i(t,2),n=r[0],a=r[1];this.key?(l["default"].setContent({content:new f({keyError:this.keyError}),title:"StreetView"}),!this.keyError&&this.setPosition({lng:n,lat:a})):(this._streetViewFeature.setGeometry(new ol.geom.Point(e)),window.open("https://www.google.com/maps/@?api=1&map_action=pano&viewpoint="+a+","+n))},m.clearMarker=function(){this._streetViewFeature.setGeometry(null)},m.clear=function(){this._layer.getSource().clear(),this._streetViewFeature.setGeometry(null),this.clearMarker(),this._panorama=null,this.active&&l["default"].closeContent(),this.active=!1},m.toggle=function(e){p.prototype.toggle.call(this,e),this.isToggled()?this._layer.getSource().addFeatures([this._streetViewFeature]):this.clear()},t.exports=g},{"core/utils/ol":66,"core/utils/utils":68,"g3w-ol/controls/interactioncontrol":83,"g3w-ol/interactions/pickcoordinatesinteraction":105,"gui/streetview/vue/streetview":182,"services/gui":361,"store/application-state":373}],97:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("core/utils/ol.controls"),a=n(i);t.exports=a["default"]},{"core/utils/ol.controls":65}],98:[function(e,t,r){var n=e("g3w-ol/controls/interactioncontrol"),i=function(e){this._startCoordinate=null;var t={name:"zoombox",tipLabel:"Zoom to box",label:"",interactionClass:ol.interaction.DragBox};e=Object.assign({},e,t),n.call(this,e)};ol.inherits(i,n),t.exports=i;var a=i.prototype;a.setMap=function(e){var t=this;n.prototype.setMap.call(this,e),this._interaction.on("boxstart",function(e){return t._startCoordinate=e.coordinate}),this._interaction.on("boxend",function(e){var r=t._startCoordinate,n=e.coordinate,i=ol.extent.boundingExtent([r,n]);t.dispatchEvent({type:"zoomend",extent:i}),t._startCoordinate=null,t._autountoggle&&t.toggle()})}},{"g3w-ol/controls/interactioncontrol":83}],99:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=Vue.extend(o["default"]);s.call(this,{name:"zoomhistory",tipLabel:"sdk.mapcontrols.addlayer.tooltip",element:(new e).$mount().$el})}var a=e("components/MapControlZoomHistory.vue"),o=n(a),s=e("g3w-ol/controls/control");ol.inherits(i,s);var l=i.prototype;l.setMap=function(e){s.prototype.setMap.call(this,e)},l.layout=function(e){s.prototype.layout.call(this,e)},t.exports=i},{"components/MapControlZoomHistory.vue":256,"g3w-ol/controls/control":79}],100:[function(e,t,r){var n=e("core/utils/ol"),i=e("g3w-ol/map/maphelpers"),a=n.merge({},i);t.exports={helpers:a}},{"core/utils/ol":66,"g3w-ol/map/maphelpers":109}],101:[function(e,t,r){var n=e("g3w-ol/interactions/measureinteraction"),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.geometryType="Polygon",n.call(this,e)};ol.inherits(i,n),t.exports=i},{"g3w-ol/interactions/measureinteraction":104}],102:[function(e,t,r){var n=function(e,t,r,n){this.type=e,this.features=r,this.coordinate=n},i=function a(e){ol.interaction.Pointer.call(this,{handleDownEvent:a.handleDownEvent_,handleMoveEvent:a.handleMoveEvent_,handleUpEvent:a.handleUpEvent_,handleEvent:a.handleEvent_}),this.previousCursor_=void 0,this.startCursor_=void 0,this.lastCoordinate_=null,this.features_=void 0!==e.features?e.features:null,this.layer_=void 0!==e.layer?e.layer:null,this.map_=null};ol.inherits(i,ol.interaction.Pointer),i.handleEvent_=function(e){return"keydown"!=e.type?ol.interaction.Pointer.handleEvent.call(this,e):this.features_.getArray().length&&46==e.originalEvent.keyCode?(this.dispatchEvent(new n("deleteend",this.layer_,this.features_,event.coordinate)),!0):void 0},i.handleDownEvent_=function(e){return this.lastFeature_=this.featuresAtPixel_(e.pixel,e.map),!!this.lastFeature_&&(i.handleMoveEvent_.call(this,e),this.dispatchEvent(new n("deleteend",this.layer_,this.features_,e.coordinate)),!0)},i.handleMoveEvent_=function(e){var t=this;this.map_=e.map;var r=this.map_.getTargetElement();void 0===this.startCursor_&&(this.startCursor_=r.style.cursor);var n=this.map_.forEachFeatureAtPixel(e.pixel,function(e,r){return e=r==t.layer_?e:null});n?(this.previousCursor_=r.style.cursor,r.style.cursor="pointer"):(r.style.cursor=void 0!==this.previousCursor_?this.previousCursor_:"",this.previousCursor_=void 0)},i.prototype.featuresAtPixel_=function(e,t){var r=null,n=t.forEachFeatureAtPixel(e,function(e){return e});return this.features_&&_.includes(this.features_.getArray(),n)&&(r=n),r},i.prototype.clear=function(){var e=void 0;this.map_&&(e=this.map_.getTargetElement(),e.style.cursor=this.startCursor_)},t.exports=i},{}],103:[function(e,t,r){var n=e("g3w-ol/interactions/measureinteraction"),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.geometryType="LineString",n.call(this,e)};ol.inherits(i,n),t.exports=i},{"g3w-ol/interactions/measureinteraction":104}],104:[function(e,t,r){var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=e("core/i18n/i18n.service"),a=i.t,o=e("core/utils/ol"),s=o.createMeasureTooltip,l=o.setMeasureTooltipStatic,u=o.removeMeasureTooltip,c=o.needUseSphereMethods,d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._helpTooltip,this._measureTooltipElement,this._measureTooltip,this._featureGeometryChangelistener,this._poinOnMapMoveListener,this.testTooltip,this._helpMsg=e.help,this._projection=e.projection,this.feature=e.feature;var t=e.drawColor||"rgba(0, 0, 0, 0.5)",r=(c(this._projection),new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ol.style.Stroke({color:t,lineDash:[10,10],width:3}),image:new ol.style.Circle({radius:5,stroke:new ol.style.Stroke({color:"rgba(0, 0, 0, 0.7)"}),fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"})})})),n=e.geometryType||"LineString",i=new ol.source.Vector;this._helpTooltipElement,this._map=null,this._feature=null,this._layer=new ol.layer.Vector({source:i,style:function(){var e=[new ol.style.Style({stroke:new ol.style.Stroke({lineDash:[10,10],width:3}),fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"})})];return e}}),ol.interaction.Draw.call(this,{source:i,type:n,style:r}),this.set("beforeRemove",this.clear),this.set("layer",this._layer),this.on("drawstart",this._drawStart),this.on("drawend",this._drawEnd)};ol.inherits(d,ol.interaction.Draw);var f=d.prototype;f.setDrawMessage=function(e){this._helpMsg=e},f.clear=function(){this._layer.getSource().clear(),this._clearMessagesAndListeners(),this._map&&(u(n({map:this._map},this.measureTooltip)),this.measureTooltip=null,this._map.removeLayer(this._layer))},f._clearMessagesAndListeners=function(){this._feature=null,this._map&&(this._measureTooltipElement=null,this._helpTooltipElement.innerHTML="",this._helpTooltipElement.classList.add("hidden"),ol.Observable.unByKey(this._featureGeometryChangelistener),ol.Observable.unByKey(this._poinOnMapMoveListener),$(document).off("keydown",this._keyDownEventHandler))},f._removeLastPoint=function(e){var t=this._feature.getGeometry();46===e.keyCode&&(t instanceof ol.geom.Polygon&&t.getCoordinates()[0].length>2?this.removeLastPoint():t instanceof ol.geom.LineString&&t.getCoordinates().length>1&&this.removeLastPoint())},f._drawStart=function(e){var t=this;this._map=this.getMap(),this._map.removeLayer(this._layer),this._feature=e.feature,this.feature&&this._feature.setGeometry(this.feature.getGeometry()),this._keyDownEventHandler=this._removeLastPoint.bind(this),$(document).on("keydown",this._keyDownEventHandler),this._layer.getSource().clear(),this._poinOnMapMoveListener=this._map.on("pointermove",function(e){if(!e.dragging&&t._feature&&t._helpMsg){var r=a(t._helpMsg);t._helpTooltipElement.innerHTML=r,t._helpTooltip.setPosition(e.coordinate),t._helpTooltipElement.classList.remove("hidden")}}),this._createHelpTooltip(),this._createMeasureTooltip()},f._drawEnd=function(){var e=this.measureTooltip.tooltip;l(e),this._clearMessagesAndListeners(),this._map.addLayer(this._layer)},f._createHelpTooltip=function(){this._helpTooltipElement&&this._helpTooltipElement.parentNode.removeChild(this._helpTooltipElement),this._helpTooltip&&this._map.removeOverlay(this._helpTooltip),this._helpTooltipElement=document.createElement("div"),this._helpTooltipElement.className="mtooltip hidden",this._helpTooltip=new ol.Overlay({element:this._helpTooltipElement,offset:[15,0],positioning:"center-left"}),this._map.addOverlay(this._helpTooltip)},f._createMeasureTooltip=function(){this.measureTooltip&&u(n({},this.measureTooltip,{map:this._map})),this.measureTooltip=s({map:this._map,feature:this._feature})},t.exports=d},{"core/i18n/i18n.service":13,"core/utils/ol":66}],105:[function(e,t,r){var n={PICKED:"picked"},i=function(e,t){this.type=e,this.coordinate=t},a=function o(e){this.previousCursor_=null,this._centerMap=null,ol.interaction.Pointer.call(this,{handleDownEvent:o.handleDownEvent_,handleUpEvent:o.handleUpEvent_,handleMoveEvent:o.handleMoveEvent_})};ol.inherits(a,ol.interaction.Pointer),a.handleDownEvent_=function(e){var t=this;return this._centerMap=e.map.getView().getCenter(),setTimeout(function(){t._centerMap===e.map.getView().getCenter()&&a.handleUpEvent_.call(t,e)},300),!1},a.handleUpEvent_=function(e){return this.dispatchEvent(new i(n.PICKED,e.coordinate)),!1},a.handleMoveEvent_=function(e){var t=e.map.getTargetElement();return t.style.cursor="pointer",!0},a.prototype.shouldStopEvent=function(){return!1},a.prototype.setActive=function(e){var t=this.getMap();if(t){var r=t.getTargetElement();r.style.cursor=""}ol.interaction.Pointer.prototype.setActive.call(this,e)},a.prototype.setMap=function(e){if(!e){var t=this.getMap().getTargetElement();t.style.cursor=""}ol.interaction.Pointer.prototype.setMap.call(this,e)},t.exports=a},{}],106:[function(e,t,r){var n={PICKED:"picked"},i=function(e,t,r,n){this.type=e,this.feature=n,this.coordinate=t,this.layer=r},a=function o(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ol.interaction.Pointer.call(this,{handleDownEvent:o.handleDownEvent_,handleUpEvent:o.handleUpEvent_,handleMoveEvent:o.handleMoveEvent_});var r=t.features;this.features_=Array.isArray(r)&&r.length&&r||null,this.layers_=t.layers||null,this.pickedFeature_=null,this.pickedLayer_=null,this.layerFilter_=function(t){var r=_.includes(e.layers_,t);return e.pickedLayer_=r&&t,r}};ol.inherits(a,ol.interaction.Pointer),a.handleDownEvent_=function(e){return this.pickedFeature_=this.featuresAtPixel_(e.pixel,e.map),this.pickedFeature_},a.handleUpEvent_=function(e){return this.pickedFeature_&&this.dispatchEvent(new i(n.PICKED,e.coordinate,this.pickedLayer_,this.pickedFeature_)),!0},a.handleMoveEvent_=function(e){var t=e.map.getTargetElement(),r=this.featuresAtPixel_(e.pixel,e.map);t.style.cursor=r?"pointer":""},a.prototype.featuresAtPixel_=function(e,t){var r=this,n=null,i=t.forEachFeatureAtPixel(e,function(e){return r.features_?r.features_.indexOf(e)>-1?e:null:e},{layerFilter:this.layerFilter_,hitTolerance:isMobile&&isMobile.any?10:0});return i&&(n=i),n},a.prototype.shouldStopEvent=function(){return!1},a.prototype.setMap=function(e){if(!e){var t=this.getMap().getTargetElement();t.style.cursor=""}ol.interaction.Pointer.prototype.setMap.call(this,e)},t.exports=a},{}],107:[function(e,t,r){var n=e("g3w-ol/layers/rasters"),i={};i.OSM={},i.OSM.get=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.title,r=e.id,n=e.url;return new ol.layer.Tile({source:new ol.source.OSM({url:n}),id:r||"osm",title:t||"OSM",basemap:!0})},i.TMS={get:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.visible,r=void 0!==t&&t,i=e.url,a=void 0===i?null:i,o=e.source_type,s=void 0===o?"xyz":o,l=e.minZoom,u=e.maxZoom,c=e.projection,d=e.attributions,f=e.crossOrigin,p=void 0===f?"anonymous":f,h=void 0;switch(s){case"xyz":h=n.XYZLayer({url:a,visible:r,minZoom:l,maxZoom:u,attributions:d,projection:c,crossOrigin:p});break;case"arcgismapserver":h=n.TiledArgisMapServer({url:a,visible:r,projection:c,attributions:d})}return h}},i.WMS={get:function(e){var t=e.url,r=e.projection,i=e.attributions,a=e.layers,o=e.singleTile,s=void 0!==o&&o,l=e.opacity,u=void 0===l?1:l;return n.WMSLayer({url:t,projection:r,attributions:i,layers:a,tiled:s,opacity:u})}},i.WMTS={get:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.layer,n=(e.visible,e.attributions),i=e.matrixSet,a=e.projection,o=e.requestEncoding,s=e.style,l=void 0===s?"default":s,u=e.format,c=void 0===u?"image/png":u,d=e.opacity,f=void 0===d?.7:d,p=a.getExtent(),h=new Array(14),v=ol.extent.getWidth(p)/256,g=new Array(14),m=0;m<14;++m)h[m]=v/Math.pow(2,m),g[m]=m;return new ol.layer.Tile({opacity:f,source:new ol.source.WMTS({url:t,projection:a,layer:r,matrixSet:i,requestEncoding:o,format:c,attributions:n,tileGrid:new ol.tilegrid.WMTS({origin:ol.extent.getTopLeft(p),resolutions:h,matrixIds:g}),style:l})})}},i.BING={},i.BING.get=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.imagerySet||"Aerial";return new ol.layer.Tile({name:t,visible:!1,preload:1/0,source:new ol.source.BingMaps({imagerySet:t,key:e.key}),basemap:!0})},t.exports=i},{"g3w-ol/layers/rasters":108}],108:[function(e,t,r){var n=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=e("core/utils/ol").getDPI(),a={},o=function(e){var t=e.method,r=void 0===t?"GET":t,i=e.type,a=void 0===i?"image":i,o=e.sourceOptions,s=void 0===o?{}:o;window.URL=window.URL||window.webkitURL,s[a+"LoadFunction"]=function(e,t){var i=new XMLHttpRequest,a=t.split("?"),o=n(a,2),s=o[0],l=o[1];i.open(r,"POST"===r&&s||t),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),i.responseType="blob",i.onload=function(){var t=this.response;void 0!==t?e.getImage().src=window.URL.createObjectURL(t):e.setState(ol.TileState.ERROR)},i.onerror=function(){image.setState(ol.TileState.ERROR)},i.send("POST"===r&&l)}};a.TiledWMSLayer=function(e,t){var r={layerObj:e,extraParams:t||{},tiled:!0};return a._WMSLayer(r)},a.WMSLayer=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET",n={layerObj:e,extraParams:t,method:r};return a._WMSLayer(n)},a.WMTSLayer=function(e,t){ol.source.WMTS.optionsFromCapabilities;return new ol.layer.Tile({opacity:1,source:new ol.source.WMTS(options)})},a.ImageArgisMapServer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new ol.layer.Image({source:new ol.source.ImageArcGISRest({ratio:e.ratio,params:{FORMAT:e.format},url:e.url})})},a.TiledArgisMapServer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.visible,n=void 0===r||r,i=e.extent,a=e.projection,o=e.attributions,s=e.crossOrigin,l=new ol.source.TileArcGISRest({url:t,projection:a,attributions:o,crossOrigin:s});return new ol.layer.Tile({extent:i,visible:n,source:l})},a._WMSLayer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layerObj,r=e.method,n=void 0===r?"GET":r,a=e.extraParams,s=e.tiled,l=void 0!==s&&s,u=t.iframe_internal,c=void 0!==u&&u,d=t.layers,f=void 0===d?"":d,p=t.version,h=void 0===p?"1.3.0":p,v=t.sld_version,g=void 0===v?"1.1.0":v,m=t.id,y=t.name,_=t.opacity,b=void 0===_?1:_,w=t.visible,x=t.extent,S=t.maxResolution,L=t.format,C={LAYERS:f,VERSION:h,TRANSPARENT:!0,SLD_VERSION:g,DPI:i};"undefined"!=typeof L&&(C.FORMAT=L);var k={url:t.url,params:Object.assign({},C,a),ratio:1,projection:t.projection?t.projection.getCode():null};(c||"POST"===n)&&o({method:n,sourceOptions:k,type:"image"});var E={id:m,name:y,opacity:b,visible:w,extent:x,maxResolution:S};return l?(E.source=new ol.source.TileWMS(k),new ol.layer.Tile(E)):(E.source=new ol.source.ImageWMS(k),new ol.layer.Image(E))},a.XYZLayer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",r=e.iframe_internal||!1,n=e.url,i=e.projection,a=e.maxZoom,s=e.minZoom,l=e.visible,u=void 0===l||l,c=e.crossOrigin;if(n){var d={url:n,maxZoom:a,minZoom:s,projection:i,crossOrigin:c};if(r&&o({method:t,type:"tile",sourceOptions:d}),"degrees"===i.getUnits()){var f=i.getExtent(),p=ol.tilegrid.createXYZ({extent:f,maxZoom:a}).getResolutions();p.splice(0,1),d.tileGrid=new ol.tilegrid.TileGrid({extent:f,resolutions:p})}var h=new ol.source.XYZ(d);return new ol.layer.Tile({visible:u,projection:i,source:h})}},t.exports=a},{"core/utils/ol":66}],109:[function(e,t,r){var n=e("../layers/bases"),i={createViewer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new a(e)}},a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=ol.control.defaults({attribution:!1,zoom:!1}),r=ol.interaction.defaults().extend([new ol.interaction.DragRotate]);r.removeAt(1);var n=e.view instanceof ol.View?e.view:new ol.View(e.view),i={controls:t,interactions:r,ol3Logo:!1,view:n,keyboardEventTarget:document};i.target=e.id;var a=new ol.Map(i);this.map=a};a.prototype.destroy=function(){this.map&&(this.map.dispose(),this.map=null)},a.prototype.getView=function(){return this.map.getView()},a.prototype.updateMap=function(e){},a.prototype.updateView=function(){},a.prototype.getMap=function(){return this.map},a.prototype.setTarget=function(e){this.map.setTarget(e)},a.prototype.zoomTo=function(e,t){var r=this.map.getView();r.setCenter(e),r.setZoom(t)},a.prototype.goTo=function(e,t){t=t||{};var r=t.animate||!0,n=t.zoom||!1,i=this.map.getView(),a=void 0,o=300,s=void 0;r?(a={duration:o,center:e},s=n?{duration:o,zoom:n}:{duration:o,resolution:i.getResolution()},i.animate(a,s)):(i.setCenter(e),n&&i.setZoom(n))},a.prototype.goToRes=function(e,t){t=t||{};var r=t.animate||!0,n=this.map.getView(),i=t.resolution||n.getResolution(),a=void 0,o=void 0;r?(a={duration:200,center:e},o={duration:200,resolution:i},n.animate(a,o)):(n.setCenter(e),n.setResolution(i))},a.prototype.fit=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.map.getView(),n=t.animate||!0,i=void 0,a=void 0,o=200;n&&(i=r.animate({duration:o,center:r.getCenter()}),a=r.animate({duration:o,resolution:r.getResolution()})),t.animate&&delete t.animate,t.constrainResolution=void 0===t.constrainResolution&&!0||t.constrainResolution,t.size=this.map.getSize(),r.fit(e,t)},a.prototype.getZoom=function(){var e=this.map.getView();return e.getZoom()},a.prototype.getResolution=function(){var e=this.map.getView();return e.getResolution()},a.prototype.getCenter=function(){var e=this.map.getView();return e.getCenter()},a.prototype.getBBOX=function(){return this.map.getView().calculateExtent(this.map.getSize())},a.prototype.getLayerByName=function(e){for(var t=this.map.getLayers(),r=t.getLength(),n=0;n<r;n++)if(e===t.item(n).get("name"))return t.item(n);return null},a.prototype.removeLayerByName=function(e){var t=this.getLayerByName(e);t&&(this.map.removeLayer(t),t=void 0)},a.prototype.getActiveLayers=function(){var e=[];return this.map.getLayers().forEach(function(t){var r=t.getProperties();r.basemap!==!0&&r.visible&&e.push(t)}),e},a.prototype.removeLayers=function(){this.map.getLayers().clear()},a.prototype.getLayersNoBase=function(){var e=[];return this.map.getLayers().forEach(function(t){var r=t.getProperties();1!=r.basemap&&e.push(t)}),e},a.prototype.addBaseLayer=function(e){var t=void 0;t=e?n[e]:n.BING.Aerial,this.map.addLayer(t)},a.prototype.changeBaseLayer=function(e){var t=this.getLayerByName(layername),r=this.map.getLayers();r.insertAt(0,t)},t.exports=i},{"../layers/bases":107}],110:[function(e,t,r){var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e.crs)return null;var t=e.crs,r=t.epsg,n=t.proj4,i=t.geographic,a=void 0!==i&&i,o=t.axisinverted,s=void 0!==o&&o,l=t.extent;n&&proj4.defs(r,n),this._axisOrientation=s?"neu":"enu";var u=a;ol.proj.Projection.call(this,{code:r,extent:l,axisOrientation:this._axisOrientation,
units:u?"degrees":"m"})};ol.inherits(n,ol.proj.Projection);var i=n.prototype;i.getAxisOrientation=function(){return this._axisOrientation},i.isInvertedAxisOrientation=function(){return"neu"===this._axisOrientation},i.getOlProjection=function(){},t.exports=n},{}],111:[function(e,t,r){var n=e("constant"),i=e("./projection"),a=e("core/utils/utils"),o=a.XHR,s=e("core/utils/geo"),l=s.normalizeEpsg,u={isRegistered:function(e){return ol.proj.get(e)},get:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.isRegistered(e.epsg);if(t)return t;var r=new i({crs:e});return ol.proj.addProjection(r),ol.proj.proj4.register(proj4),r},registerProjection:function(e){var t=this;return new Promise(function(r,i){var a=t.isRegistered(e);a?r(a):o.get({url:""+n.API_BASE_URLS.CRS+e.split(":")[1]}).then(function(e){var n=e.result,i=e.data;n&&(i.epsg=l(i.epsg),a=t.get(i),ol.proj.proj4.register(proj4),r(a))})["catch"](function(e){return i(e)})})}};t.exports=u},{"./projection":110,constant:4,"core/utils/geo":64,"core/utils/utils":68}],112:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(){var e=this;this.state={prstate:u["default"].state,highlightlayers:!1,external:{wms:[],vector:[]},layerstrees:[],layersgroups:[]},this.setters={addExternalLayer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,r=e.type,n=void 0===r?"vector":r;t.removable=!0,this.state.external[n].push(t)},removeExternalLayer:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.name,n=t.type,i=void 0===n?"vector":n;this.state.external[i].filter(function(t,n){if(t.name===r)return e.state.external[i].splice(n,1),!0})},setSelectedExternalLayer:function(e){var t=e.layer,r=e.type,n=e.selected;this.state.external[r].forEach(function(e){"undefined"!=typeof e.selected&&(e.selected=t===e&&n)})}},p(this);var t=s["default"].getLayersStores();t.forEach(function(t){return e.addLayersStoreToLayersTrees(t)}),s["default"].onafter("addLayersStore",function(t){e.addLayersStoreToLayersTrees(t)}),s["default"].onafter("removeLayersStore",function(t){e.state.layerstrees.find(function(r,n){if(r.storeid===t.getId())return e.state.layerstrees.splice(n,1),!0})}),s["default"].onafter("removeLayersStores",function(){e.state.layerstrees.forEach(function(t,r){e.state.layerstrees.splice(r,1)})})}var o=e("store/catalog-layers"),s=n(o),l=e("store/projects"),u=n(l),c=e("services/application"),d=n(c),f=e("core/utils/utils"),p=f.base,h=f.inherit,v=e("core/g3wobject");h(a,v);var g=a.prototype;g.createLayersGroup=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.title,r=void 0===t?"Layers Group":t,n=e.layers,i=void 0===n?[]:n,a=[];return i.forEach(function(e){return a.push(e)}),{title:r,nodes:a}},g.getMajorQgisVersion=function(){return u["default"].getCurrentProject().getQgisVersion({type:"major"})},g.addLayersGroup=function(e){this.state.layersgroups.push(e)},g.addLayersStoreToLayersTrees=function(e){this.state.layerstrees.push({tree:e.getLayersTree(),storeid:e.getId()})},g.changeMapTheme=function(){var e=i(regeneratorRuntime.mark(function t(e){var r,n,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return d["default"].changeProjectView(!0),r=this.state.prstate.currentProject,n=this.state.layerstrees[0],n.checked=!0,i=n.tree[0].nodes,t.next=7,r.setLayersTreePropertiesFromMapTheme({map_theme:e,layerstree:i,rootNode:n});case 7:return a=t.sent,d["default"].changeProjectView(!1),t.abrupt("return",a);case 10:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),g.getExternalLayers=function(e){var t=e.type,r=void 0===t?"vector":t;return this.state.external[r]},g.getExternalSelectedLayers=function(e){var t=e.type,r=void 0===t?"vector":t;return this.getExternalLayers({type:r}).filter(function(e){return e.selected})},g.getExternalLayerById=function(e){var t=e.id,r=e.type,n=void 0===r?"vector":r;return this.state.external[n].find(function(e){return e.id===t})},g.isExternalLayerSelected=function(e){var t=e.id,r=e.type,n=this.getExternalLayerById({id:t,type:r});return n&&n.selected},t.exports=a},{"core/g3wobject":12,"core/utils/utils":68,"services/application":351,"store/catalog-layers":374,"store/projects":379}],113:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function a(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.resizable=!0,x(this,t);var r=t.config.legend;this.title="catalog",this.mapComponentId=t.mapcomponentid;var n=t.service||new L;this.setService(n),this.setInternalComponent(new C({service:n,legend:r})),this.internalComponent.state=this.getService().state;var i=function(t){var r=t.getService();e.state.visible=!r.state.hidden,r.onafter("setHidden",function(t){e.state.visible=!r.state.hidden,e.state.expanded=!0})};if(this.mapComponentId){var a=_["default"].getComponent(this.mapComponentId);!a&&m["default"].on("componentregistered",function(t){return t.getId()===e.mapComponentId&&i(t)})||i(a)}}var o=e("components/Catalog.vue"),s=i(o),l=e("components/CatalogLayersGroup.vue"),u=i(l),c=e("components/CatalogTristateTree.vue"),d=i(c),f=e("components/CatalogLayersLegend.vue"),p=i(f),h=e("components/CatalogLayersLegendItems.vue"),v=i(h),g=e("store/components"),m=n(g),y=e("services/gui"),_=n(y),b=e("core/utils/utils"),w=b.inherit,x=b.base,S=e("gui/component/component"),L=e("gui/catalog/catalogservice"),C=Vue.extend(s);Vue.component("g3w-catalog",s),Vue.component("layers-group",u),Vue.component("tristate-tree",d),Vue.component("layerslegend",p),Vue.component("layerslegend-items",v),w(a,S),t.exports=a},{"components/Catalog.vue":196,"components/CatalogLayersGroup.vue":200,"components/CatalogLayersLegend.vue":201,"components/CatalogLayersLegendItems.vue":202,"components/CatalogTristateTree.vue":203,"core/utils/utils":68,"gui/catalog/catalogservice":112,"gui/component/component":117,"services/gui":361,"store/components":375}],114:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=new Vue;r["default"]=n},{}],115:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.id="changemapmenu",l(this,e),this.state.visible=!0,c(this,e),this.internalComponent=new f}var a=e("components/ChangeMapMenu.vue"),o=n(a),s=e("core/utils/utils"),l=s.base,u=s.inherit,c=s.merge,d=e("gui/component/component"),f=Vue.extend(o);u(i,d),t.exports=i},{"components/ChangeMapMenu.vue":204,"core/utils/utils":68,"gui/component/component":117}],116:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=e("components/C3XYLine.vue"),o=n(a),s={CHARTS:{c3:{lineXY:o["default"]}},build:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=e.hooks,n=void 0===r?{}:r,a=t.split(":"),o=i(a,2),s=o[0],l=void 0===s?"c3":s,u=o[1],c=void 0===u?"lineXY":u,d=this.CHARTS[l][c];return Object.assign(n,d)}};t.exports=s},{"components/C3XYLine.vue":195}],117:[function(e,t,r){var n=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=e("core/utils/utils"),a=i.base,o=i.inherit,s=i.merge,l=i.noop,u=i.capitalize_first_letter,c=i.resolve,d=e("core/g3wobject"),f=["methods","computed","data","components"],p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._firstLayout=!0,this.internalComponent=null,this._components=[];var t=e.id,r=void 0===t?1e3*Math.random():t,n=e.title,i=void 0===n?"":n,o=e.visible,l=void 0===o||o,u=e.open,c=void 0!==u&&u,d=e.resizable,f=void 0!==d&&d,p=e.info,h=void 0===p?null:p,v=e.loading,g=void 0!==v&&v,m=e.disabled,y=void 0!==m&&m,_=e.closewhenshowviewportcontent,b=void 0===_||_;this.id=r,this.title=i,this.state={visible:l,open:c,resizable:f,info:h,loading:g,disabled:y,closewhenshowviewportcontent:b,sizes:{width:0,height:0}},this.setters={setOpen:function(e){this.state.open=e,this._setOpen(e)},setVisible:function(e){this.state.visible=e,this._setVisible(e)},setLoading:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state.loading=e},setDisabled:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state.disabled=e},reload:function(){this._reload()}},s(this,e),a(this),this.events=e.events,this.events&&this.handleEventsComponent()};o(p,d);var h=p.prototype;h.init=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.vueComponent=this.createVueComponent(e.vueComponentObject),this._components=e.components||[];var t=e.service||l,r=e.template,n=e.propsData;this.setService(t),this._service.init?this._service.init(e):null,r&&this.setInternalComponentTemplate(r),this.setInternalComponent=function(){var e=Vue.extend(this.vueComponent);this.internalComponent=new e({service:this._service,template:r,propsData:n}),this.internalComponent.state=this.getService().state},this.setInternalComponent()},h.getId=function(){return this.id},h.setId=function(e){this.id=e},h.getOpen=function(){return this.state.open},h.closeWhenViewportContentIsOpen=function(){return this.getOpen()&&this.state.closewhenshowviewportcontent},h.getVisible=function(){return this.state.visible},h.getTitle=function(){return this.state.title},h.setTitle=function(e){this.state.title=e},h.getService=function(){return this._service},h.setService=function(e){this._service=e},h.handleEventsComponent=function(){var e=this.events,t=e.open;e.visible;if(t){var r=t.when,n=void 0===r?"after":r,i=t.cb,a=void 0===i?function(){}:i;t.guiEvents;this["on"+n]("setOpen",function(e){return a(e)})}},h.insertComponentAt=function(e,t){this._components.splice(e,0,t)},h.removeCompomentAt=function(e){this._components.splice(e,1)},h.addComponent=function(e){this._components.push(e)},h.popComponent=function(){return this._components.pop()},h.removeComponent=function(e){var t=this;this._components.forEach(function(r,n){if(r===e)return t.splice(n,1),!1})},h.setComponents=function(e){this._components=Array.isArray(e)?e:[]},h.exendComponents=function(e){_.merge(this._components,e)},h.getInternalComponent=function(){return this.internalComponent},h.setInternalComponent=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!e&&this.internalComponentClass?this.internalComponent=new this.internalComponentClass:this.internalComponent=e;var n=r.events,i=void 0===n?[]:n;i.forEach(function(e){var r=e.name,n=e.handler;t.internalComponent.$on(r,function(e){return n&&n(e)||t["set"+u(r)](e)})})},h.createVueComponent=function(e){return _.cloneDeep(e)},h.addInternalComponentData=function(e){_.merge(this.internalComponent,e)},h.overwriteServiceMethod=function(e,t){this._service[e]=t},h.overwriteServiceMethods=function(e){var t=this;Object.entries(e).forEach(function(e){var r=n(e,2),i=r[0],a=r[1];return t.overwriteServiceMethod(i,a)})},h.extendService=function(e){this._service&&s(this._service,e)},h.extendInternalComponent=function(e){var t=this;this.vueComponent?Object.entries(e).forEach(function(e){var r=n(e,2),i=r[0],a=r[1];if(f.indexOf(i)>-1)switch(i){case"methods":t.extendInternalComponentMethods(a);break;case"components":t.extendInternalComponentComponents(a);break;default:s(t.vueComponent[i],a)}}):this.vueComponent=e},h.extendInternalComponentComponents=function(e){e&&s(this.vueComponent.components,e)},h.extendComponents=function(e){this.extendInternalComponentComponents(e)},h.addComponent=function(e){e&&(this.vueComponent.components[e.key]=e.value)},h.extendInternalComponentMethods=function(e){e&&(Object.entries(e).forEach.forEach(function(t){var r=n(t,2),i=r[0],a=r[1];return!(a instanceof Function)&&delete e[i]}),s(this.vueComponent.methods,e))},h.extendInternalComponentComputed=function(e){e&&(Object.entries(e).forEach(function(t){var r=n(t,2),i=r[0],a=r[1];return!(a instanceof Function)&&delete e[i]}),s(this.vueComponent.computed,e))},h.setInternalComponentTemplate=function(e){e&&(this.vueComponent.template=e)},h.getInternalTemplate=function(){return this.vueComponent.template},h.destroy=function(){},h.click=function(){},h.show=function(){},h._setOpen=function(e){},h._setVisible=function(){},h._reload=function(){},h.mount=function(e,t){var r=this,n=$.Deferred();if(this.internalComponent||this.setInternalComponent(),t){var i=this.internalComponent.$mount();$(e).append(i.$el)}else this.internalComponent.$mount(e);return this.internalComponent.$nextTick(function(){$(e).localize(),r.emit("ready"),n.resolve(!0)}),this.emit("mount"),n.promise()},h.unmount=function(){return this.internalComponent?(this.state.resizable&&this.internalComponent.$off("resize-component",this.internalComponent.layout),this.state.open=!1,this.internalComponent.$destroy(!0),$(this.internalComponent.$el).remove(),this.internalComponent=null,this.emit("unmount"),c()):c()},h.ismount=function(){return this.internalComponent&&this.internalComponent.$el},h.layout=function(e,t){var r=this;this.state.resizable&&this._firstLayout&&(this.internalComponent.$on("resize-component",this.internalComponent.layout),this._firstLayout=!1),this.internalComponent.$nextTick(function(){r.internalComponent.$emit("resize-component",{width:e,height:t})}),this.emit("layout")},t.exports=p},{"core/g3wobject":12,"core/utils/utils":68}],118:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("services/gui"),a=n(i),o=e("gui/component/component"),s={build:function(e){var t=e.vueComponentObject,r=e.service,n=e.propsData,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new o(i);return a.init({vueComponentObject:t,service:r,propsData:n}),a},buildSidebar:function(e){var t=e.vueComponentObject,r=(e.service,e.propsData,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),n=r.id,i=r.title,o=r.open,s=void 0!==o&&o,l=r.collapsible,u=void 0===l||l,c=r.isolate,d=void 0!==c&&c,f=r.mobile,p=void 0===f||f,h=r.iconConfig,v=void 0===h?{}:h,g=r.events,m=void 0===g?{}:g,y=r.sidebarOptions,_=void 0===y?{position:1}:y,b=this.build({vueComponentObject:t},{id:n,title:i,open:s,collapsible:u,isolate:d,iconColor:v.color&&v.color,icon:v.icon&&a["default"].getFontClass(v.icon),mobile:p,events:m});return a["default"].addComponent(b,"sidebar",_),b}};t.exports=s},{"gui/component/component":117,"services/gui":361}],119:[function(e,t,r){var n=e("core/i18n/i18n.service"),i=n.t;t.exports={matcher:function(e,t){var r=e.term?e.term.toLowerCase():e.term;if(""===$.trim(r))return t;if("undefined"==typeof t.text)return null;if(t.text.toLowerCase().indexOf(r)>-1){var n=$.extend({},t,!0);return n}return null},language:{noResults:function(){return i("sdk.search.no_results")},errorLoading:function(){return i("sdk.search.error_loading")},searching:function(){return i("sdk.search.searching")},inputTooShort:function(e){var t=e.minimum-e.input.length;return i("sdk.search.autocomplete.inputshort.pre")+" "+t+" "+i("sdk.search.autocomplete.inputshort.post")}}}},{"core/i18n/i18n.service":13}],120:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("components/FieldText.vue"),a=n(i),o=e("components/FieldLink.vue"),s=n(o),l=e("components/FieldImage.vue"),u=n(l),c=e("components/FieldGeo.vue"),d=n(c),f=e("components/FieldMedia.vue"),p=n(f),h=e("components/FieldVue.vue"),v=n(h),g={simple_field:a["default"],text_field:a["default"],link_field:s["default"],image_field:u["default"],geo_field:d["default"],photo_field:u["default"],media_field:p["default"],vue_field:v["default"]};t.exports=g},{"components/FieldGeo.vue":207,"components/FieldImage.vue":208,"components/FieldLink.vue":209,"components/FieldMedia.vue":210,"components/FieldText.vue":211,"components/FieldVue.vue":212}],121:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=e("store/catalog-layers"),o=n(a),s=e("./fields"),l=e("core/utils/utils"),u=l.toRawType,c=/^(https?:\/\/[^\s]+)/g,d=/[^\s]+.(png|jpg|jpeg|gif)$/g,f={SIMPLE:"simple",GEO:"geo",LINK:"link",PHOTO:"photo",PHOTOLINK:"photolink",IMAGE:"image",POINTLINK:"pointlink",ROUTE:"route",VUE:"vue"};t.exports={getType:function(e){var t=e.type;if("vue"!==t){var r=e.value,n=!r||"Object"!==u(r)||r.coordinates||r.vue?r:r.value;n?n&&"object"==("undefined"==typeof n?"undefined":i(n))?n.coordinates?t=f.GEO:n.vue&&(t=f.VUE):t=n&&Array.isArray(n)?n.length&&n[0].photo?f.PHOTO:f.SIMPLE:n.toString().toLowerCase().match(d)?f.PHOTO:n.toString().match(c)?f.LINK:f.SIMPLE:t=f.SIMPLE}return t+"_field"},isSimple:function(e){return this.getType(e)===f.SIMPLE+"_field"},isLink:function(e){return this.getType(e)===f.LINK+"_field"},isImage:function(e){return this.getType(e)===f.IMAGE+"_field"},isPhoto:function(e){return this.getType(e)===f.PHOTO+"_field"},isVue:function(e){return this.getType(e)===f.VUE+"_field"},add:function(e){var t=e.type,r=e.field;s[t]=r},remove:function(e){delete s[e]},changeConfigFieldType:function(e){var t=e.layerId,r=e.field,n=void 0===r?{}:r,i=o["default"].getLayerById(t);i.changeConfigFieldType(n)},resetConfigFieldType:function(e){var t=e.layerId,r=e.field,n=void 0===r?{}:r,i=o["default"].getLayerById(t);i.resetConfigField(n)}}},{"./fields":120,"core/utils/utils":68,"store/catalog-layers":374}],122:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(){var e=this;this.state=null,this.eventBus=new Vue,this.force={update:!1,valid:!1},this.layer,this.setters={setInitForm:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setInitForm(e)},setFormStructure:function(e){this.state.formstructure=e},setFormFields:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.state.fields=e,this.handleFieldsWithExpression(e)},setupFields:function(){this._setupFields()},setFormData:function(e){this.setFormFields(e)},setField:function(e){},setState:function(e){this._setState(e)},addActionsForForm:function(e){},postRender:function(e){}},d(this),this.init=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setInitForm(e)},this._setInitForm=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.fields,r=e.feature,n=e.parentData,i=e.layer,a=e.title,o=void 0===a?"Form":a,s=e.formId,l=e.name,u=e.buttons,c=void 0===u?{}:u,d=e.context_inputs,f=e.isnew,p=e.footer,h=void 0===p?{}:p,v=e.headerComponent;this.layer=i,this.feature=r.clone(),this.title=o,this.formId=s,this.name=l,this.buttons=c,this.context_inputs=d,this.parentData=n,this.headerComponent=v,this.state={layerid:i.getId(),loading:!1,components:[],disabledcomponents:[],component:null,headers:[],currentheaderid:null,fields:null,buttons:this.buttons,disabled:!1,isnew:f,valid:!0,update:r.isNew(),tovalidate:{},feature:r,componentstovalidate:{},footer:h,ready:!1},this.force.update=r.isNew(),this.filter_expression_fields_dependencies={},this.default_expression_fields_dependencies={},this.default_expression_fields_on_update=[],this.listenChangeInput=!0,this.setFormFields(t),this.layer&&e.formStructure&&this.setFormStructure(this.layer.getLayerEditingFormStructure(t))},this.eventBus.$on("set-loading-form",function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e.state.loading=t})}var s=e("core/expression/inputservice"),l=n(s),u=e("core/utils/utils"),c=u.inherit,d=u.base,f=e("core/g3wobject");c(o,f);var p=o.prototype;p.setReady=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state.ready=e},p.changeInput=function(e){!0===this.listenChangeInput&&(this.evaluateFilterExpressionFields(e),this.evaluateDefaultExpressionFields(e),this.isValid(e),this.isUpdated(e))},p.isUpdated=function(e){this.state.update=this.force.update||(this.state.update?!!this.state.fields.find(function(e){return e.update}):e.update)},p.setUpdate=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.force,n=void 0!==r&&r;this.force.update=n,this.state.update=this.force.update||e,!1===this.state.update&&this.state.fields.forEach(function(e){e._value=e.value})},p.evaluateDefaultExpressionFields=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=this.default_expression_fields_dependencies[t.name];r&&(this.feature.set(t.name,t.value),r.forEach(function(t){l["default"].handleDefaultExpressionFormInput({parentData:e.parentData,qgs_layer_id:e.layer.getId(),field:e._getField(t),feature:e.feature})}))},p.evaluateFilterExpressionFields=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=this.filter_expression_fields_dependencies[t.name];if(r){var n=this._getField(t.name);n&&this.feature.set(n.name,n.value),r.forEach(function(t){l["default"].handleFilterExpressionFormInput({parentData:e.parentData,qgs_layer_id:e.layer.getId(),field:e._getField(t),feature:e.feature})})}},p._handleFieldWithFilterExpression=function(e,t){var r=this;if(t){var n=t.referencing_fields,i=void 0===n?[]:n,o=t.referenced_columns,s=void 0===o?[]:o,u=new Set;[].concat(a(s),a(i)).forEach(function(e){return u.add(e)}),u.forEach(function(t){void 0===r.filter_expression_fields_dependencies[t]&&(r.filter_expression_fields_dependencies[t]=[]),r.filter_expression_fields_dependencies[t].push(e.name)}),l["default"].handleFilterExpressionFormInput({parentData:this.parentData,qgs_layer_id:this.layer.getId(),field:e,feature:this.feature})}},p._handleFieldWithDefaultExpression=function(e,t){var r=this;if(t){var n=t.referencing_fields,i=void 0===n?[]:n,o=t.referenced_columns,s=void 0===o?[]:o,u=t.apply_on_update,c=void 0!==u&&u;if(!c&&!this.state.isnew)return;var d=new Set;[].concat(a(s),a(i)).forEach(function(e){return d.add(e)}),c&&(this.default_expression_fields_on_update.push(e),d.forEach(function(t){void 0===r.default_expression_fields_dependencies[t]&&(r.default_expression_fields_dependencies[t]=[]),r.default_expression_fields_dependencies[t].push(e.name)})),this.state.isnew&&l["default"].handleDefaultExpressionFormInput({field:e,feature:this.feature,qgs_layer_id:this.layer.getId(),parentData:this.parentData})}},p.handleFieldsWithExpression=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach(function(t){var r=t.input.options,n=void 0===r?{}:r;e._handleFieldWithFilterExpression(t,n.filter_expression),e._handleFieldWithDefaultExpression(t,n.default_expression)}),Object.keys(this.filter_expression_fields_dependencies).forEach(function(t){e.evaluateFilterExpressionFields({name:t})})},p.setCurrentFormPercentage=function(e){this.layer.setFormPercentage(e)},p.setLoading=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state.loading=e},p.setValidComponent=function(e){var t=e.id,r=e.valid;this.state.componentstovalidate[t]=r,this.isValid()},p.getValidComponent=function(e){return this.state.componentstovalidate[e]},p.isValid=function(e){var t=this;if(e){if(!e.validate.mutually||e.validate.required||e.validate.empty||(e.validate._valid=e.validate.valid,e.validate.mutually_valid=e.validate.mutually.reduce(function(e,r){return e&&t.state.tovalidate[r].validate.empty},!0),e.validate.valid=e.validate.mutually_valid&&e.validate.valid),e.validate.mutually&&!e.validate.required&&e.validate.empty){e.value=null,e.validate.mutually_valid=!0,e.validate.valid=!0,e.validate._valid=!0;for(var r=[],n=e.validate.mutually.length;n--;){var i=e.validate.mutually[n];this.state.tovalidate[i].validate.empty||r.push(i)}r.length<2&&r.forEach(function(e){t.state.tovalidate[e].validate.mutually_valid=!0,t.state.tovalidate[e].validate.valid=!0,setTimeout(function(){t.state.tovalidate[e].validate.valid=t.state.tovalidate[e].validate._valid,t.state.valid=t.state.valid&&t.state.tovalidate[e].validate.valid})})}if(!e.validate.mutually&&!e.validate.empty&&(e.validate.min_field||e.validate.max_field)){var a=e.validate.min_field||e.validate.max_field;e.validate.valid=e.validate.min_field?this.state.tovalidate[e.validate.min_field].validate.empty||1*e.value>1*this.state.tovalidate[e.validate.min_field].value:this.state.tovalidate[e.validate.max_field].validate.empty||1*e.value<1*this.state.tovalidate[e.validate.max_field].value,e.validate.valid&&(this.state.tovalidate[a].validate.valid=!0)}}this.state.valid=Object.values(this.state.tovalidate).reduce(function(e,t){return e&&t.validate.valid},!0)&&Object.values(this.state.componentstovalidate).reduce(function(e,t){return e&&t},!0)},p.addComponents=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=!0,r=!1,n=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;this.addComponent(o)}}catch(s){r=!0,n=s}finally{try{!t&&a["return"]&&a["return"]()}finally{if(r)throw n}}},p.addComponent=function(e){var t=e.id,r=e.title,n=e.name,i=e.icon,a=e.valid,o=e.headerComponent,s=e.header,l=void 0===s||s;void 0!==a&&(this.state.componentstovalidate[t]=a,this.state.valid=this.state.valid&&a,this.eventBus.$emit("add-component-validate",{id:t,valid:a})),l&&(this.state.headers.push({title:r,name:n,id:t,icon:i,component:o}),this.state.currentheaderid=this.state.currentheaderid||t),this.state.components.push(e)},p.replaceComponent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.component,n=this.state.components.findIndex(function(e){return e.id===t});this.state.components.splice(n,1,r)},p.disableComponent=function(e){var t=e.id,r=e.disabled;r?this.state.disabledcomponents.push(t):this.state.disabledcomponents=this.state.disabledcomponents.filter(function(e){return disabledId!==t})},p.setCurrentComponentById=function(e){if(this.state.disabledcomponents.indexOf(e)===-1)return this.setIdHeader(e),this.state.component=this.state.components.find(function(t){return t.id===e}).component,this.state.component},p.setRootComponent=function(){this.state.component=this.state.components.find(function(e){return e.root}).component},p.getRootComponent=function(){return this.state.components.find(function(e){return e.root}).component},p.isRootComponent=function(e){return this.getRootComponent()==e},p.getComponentById=function(e){return this.state.components.find(function(t){return t.id===e})},p.setComponent=function(e){this.state.component=e},p.addedComponentTo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"body";this.state.addedcomponentto[e]=!0},p.addToValidate=function(e){this.state.tovalidate[e.name]=e,this.state.ready&&this.isValid(e)},p.removeToValidate=function(e){delete this.state.tovalidate[e.name],this.isValid()},p.getState=function(){return this.state},p._setState=function(e){this.state=e},p.getFields=function(){return this.state.fields},p._getField=function(e){return this.state.fields.find(function(t){return t.name===e})},p.getEventBus=function(){return this.eventBus},p.setIdHeader=function(e){this.state.currentheaderid=e},p.getContext=function(){return this.context_inputs.context},p.getSession=function(){return this.getContext().session},p.getInputs=function(){return this.context_inputs.inputs},p.handleRelation=function(e){e.relationId,e.feature},p.clearAll=function(){this.eventBus.$off("addtovalidate"),this.eventBus.$off("set-main-component"),this.eventBus.$off("set-loading-form"),this.eventBus.$off("component-validation"),this.eventBus.$off("disable-component")},p.saveDefaultExpressionFieldsNotDependencies=i(regeneratorRuntime.mark(function h(){var e,t,r,n,i=this;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(0!==this.default_expression_fields_on_update.length){a.next=2;break}return a.abrupt("return");case 2:this.listenChangeInput=!1,e=[],t=[],r=regeneratorRuntime.mark(function o(t){var r,n,a,s;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:r=Object.keys(i.default_expression_fields_dependencies).filter(function(e){return i.default_expression_fields_on_update.find(function(t){var r=t.name;return r===e})&&i.default_expression_fields_dependencies[e].find(function(e){return e===i.default_expression_fields_on_update[t].name})}),n=regeneratorRuntime.mark(function u(t){var n;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if("undefined"==typeof e.find(function(e){return e===r[t]})){a.next=2;break}return a.abrupt("return","continue");case 2:return a.prev=2,a.next=5,l["default"].handleDefaultExpressionFormInput({field:i._getField(r[t]),feature:i.feature,qgs_layer_id:i.layer.getId(),parentData:i.parentData});case 5:n=a.sent,i.feature.set(r[t],n),e.push(r[t]),a.next=13;break;case 10:a.prev=10,a.t0=a["catch"](2);case 13:case"end":return a.stop()}},u,i,[[2,10]])}),a=0;case 3:if(!(a<r.length)){o.next=11;break}return o.delegateYield(n(a),"t0",5);case 5:if(s=o.t0,"continue"!==s){o.next=8;break}return o.abrupt("continue",8);case 8:a++,o.next=3;break;case 11:case"end":return o.stop()}},o,i)}),n=0;case 7:if(!(n<this.default_expression_fields_on_update.length)){a.next=12;break}return a.delegateYield(r(n),"t0",9);case 9:n++,a.next=7;break;case 12:return this.default_expression_fields_on_update.forEach(function(r){"undefined"==typeof e.find(function(e){return e===r.name})&&t.push(l["default"].handleDefaultExpressionFormInput({field:r,feature:i.feature,qgs_layer_id:i.layer.getId(),parentData:i.parentData}))}),a.prev=13,a.next=16,Promise.allSettled(t);case 16:a.next=21;break;case 18:a.prev=18,a.t1=a["catch"](13);case 21:this.listenChangeInput=!0;case 22:case"end":return a.stop()}},h,this,[[13,18]])})),t.exports=o},{"core/expression/inputservice":10,"core/g3wobject":12,"core/utils/utils":68}],123:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=void 0===t?"form":t,n=e.name,i=e.title,a=e.headerComponent;p(this,e),e.service=e.service?new e.service:new g,e.vueComponentObject=e.vueComponentObject||s;var o=e.components||[{id:r,title:i,name:n,root:!0,component:u["default"],headerComponent:a
}];e.perc=null!==e.layer.getFormPercentage()?e.layer.getFormPercentage():e.perc,this.init(e),this.getService().addComponents(o),this.getService().setComponent(o[0].component),this.addBodyFormComponent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.component,r=e.where,n=void 0===r?"after":r;this.getInternalComponent().body.components[n].push(t)},this.addBodyFormComponents=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.components,n=void 0===r?[]:r,i=t.where,a=void 0===i?"after":i;n.forEach(function(t){return e.addBodyFormComponent({component:t,where:a})})},this.addFormComponents=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.getService().addComponents(e)},this.addFormComponent=function(e){e&&this.getService().addComponent(e)},this.addDependecyComponents=function(e){this.getService().addDependecyComponents(e)},this.addComponentBeforeBody=function(e){},this.addComponentAfterBody=function(e){},this.addComponentBeforeFooter=function(){},this.addComponentAfterFooter=function(e){},this.mount=function(e,t){return p(this,"mount",e,t).then(function(){d["default"].setModal(!0)})},this.layout=function(){this.internalComponent.reloadLayout()}}var o=e("components/Form.vue"),s=i(o),l=e("components/FormBody.vue"),u=n(l),c=e("services/gui"),d=n(c),f=e("core/utils/utils"),p=f.base,h=f.inherit,v=e("gui/component/component"),g=e("gui/form/formservice");h(a,v),t.exports=a},{"components/Form.vue":214,"components/FormBody.vue":215,"core/utils/utils":68,"gui/component/component":117,"gui/form/formservice":122,"services/gui":361}],124:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.state.input.options.values.find(function(e){return e.checked===!1});e.validatorOptions={values:e.state.input.options.values.map(function(e){return e})},null!==e.state.value||e.state.forceNull||(e.state.value=t.value),o(this,e)}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("gui/inputs/service");a(n,s);var l=n.prototype;l.convertCheckedToValue=function(e){e=null!==e&&void 0!==e&&e;var t=this.state.input.options.values.find(function(t){return t.checked===e});return this.state.value=t.value,this.state.value},l.convertValueToChecked=function(){var e=this.state.value;if(null===e||void 0===e)return!1;var t=this.state.input.options.values.find(function(t){return t.value==e});return void 0===t&&(t=this.state.input.options.values.find(function(e){return e.checked===!1}),this.state.value=t.value),t.checked},t.exports=n},{"core/utils/utils":68,"gui/inputs/service":147}],125:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputCheckbox.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputCheckbox.vue":235}],126:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputColor.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputColor.vue":236}],127:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.validatorOptions={},u(this,e)}var a=e("services/application"),o=n(a),s=e("core/utils/utils"),l=s.inherit,u=s.base,c=s.convertQGISDateTimeFormatToMoment,d=e("gui/inputs/service");l(i,d);var f=i.prototype;f.getLocale=function(){var e=o["default"].getConfig();return e.user.i18n?e.user.i18n:"en"},f.convertQGISDateTimeFormatToMoment=function(e){return c(e)},f.setValidatorOptions=function(e){this.validatorOptions=e},t.exports=i},{"core/utils/utils":68,"gui/inputs/service":147,"services/application":351}],128:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputDateTimePicker.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputDateTimePicker.vue":237}],129:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e)}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("gui/inputs/service");o(n,s),t.exports=n},{"core/utils/utils":68,"gui/inputs/service":147}],130:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputFloat.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputFloat.vue":238}],131:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("store/application-state"),a=n(i),o=e("components/InputBase.vue"),s=n(o),l=e("mixins"),u=e("./services"),c={props:["state"],mixins:[l.baseInputMixin],components:{baseinput:s["default"]},watch:{notvalid:function(e){e&&this.service.setErrorMessage(this.state)},"state.value":function(){var e=this;"undefined"!=typeof this.state.input.options.default_expression&&setTimeout(function(){return e.change()})}},created:function(){var e=this;this.service=new u[this.state.input.type]({state:this.state}),this.$watch(function(){return a["default"].language},function(){return e.service.setErrorMessage(e.state)}),this.state.editable&&this.state.validate.required&&this.service.validate(),this.$emit("addinput",this.state),this.state.value_from_default_value&&this.$emit("changeinput",this.state)},destroyed:function(){this.$emit("removeinput",this.state)}};t.exports=c},{"./services":148,"components/InputBase.vue":234,mixins:343,"store/application-state":373}],132:[function(e,t,r){var n={text_input:e("./text/vue/text"),texthtml_input:e("./texthtml/vue/texthtml"),textarea_input:e("./textarea/vue/textarea"),integer_input:e("./integer/vue/integer"),string_input:e("./text/vue/text"),float_input:e("./float/vue/float"),radio_input:e("./radio/vue/radio"),check_input:e("./checkbox/vue/checkbox"),range_input:e("./range/vue/range"),datetimepicker_input:e("./datetimepicker/vue/datetimepicker"),unique_input:e("./unique/vue/unique"),select_input:e("./select/vue/select"),media_input:e("./media/vue/media"),select_autocomplete_input:e("./select/vue/select"),picklayer_input:e("./picklayer/vue/picklayer"),color_input:e("./color/vue/color"),slider_input:e("./sliderrange/vue/sliderrange"),lonlat_input:e("./lonlat/vue/lonlat")};t.exports=n},{"./checkbox/vue/checkbox":125,"./color/vue/color":126,"./datetimepicker/vue/datetimepicker":128,"./float/vue/float":130,"./integer/vue/integer":134,"./lonlat/vue/lonlat":136,"./media/vue/media":138,"./picklayer/vue/picklayer":140,"./radio/vue/radio":142,"./range/vue/range":144,"./select/vue/select":146,"./sliderrange/vue/sliderrange":150,"./text/vue/text":151,"./textarea/vue/textarea":152,"./texthtml/vue/texthtml":153,"./unique/vue/unique":155}],133:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e)}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("gui/inputs/service");o(n,s),t.exports=n},{"core/utils/utils":68,"gui/inputs/service":147}],134:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputInteger.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputInteger.vue":241}],135:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u(this,t),this.coordinatebutton,this.mapService=s["default"].getComponent("map").getService(),this.mapEpsg=this.mapService.getCrs(),this.mapControlToggleEventHandler=function(t){t.target.isToggled()&&t.target.isClickMap()&&e.coordinatebutton.active&&e.toggleGetCoordinate()},this.map=s["default"].getComponent("map").getService().getMap(),this.outputEpsg=this.state.epsg||this.mapEpsg,this.eventMapKey}var a=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=e("services/gui"),s=n(o),l=e("core/utils/utils"),u=l.base,c=l.inherit,d=e("gui/inputs/service");c(i,d);var f=i.prototype;f.setCoordinateButtonReactiveObject=function(e){this.coordinatebutton=e},f.validate=function(){this.state.values.lon<-180?this.state.values.lon=-180:this.state.values.lon>180&&(this.state.values.lon=180),this.state.values.lat<-90?this.state.values.lon=-90:this.state.values.lat>90&&(this.state.values.lon=90),this.state.validate.valid=!Number.isNaN(1*this.state.values.lon)},f.toggleGetCoordinate=function(){this.coordinatebutton.active=!this.coordinatebutton.active,this.coordinatebutton.active?this.startToGetCoordinates():this.stopToGetCoordinates()},f.startToGetCoordinates=function(){var e=this;this.mapService.deactiveMapControls(),this.mapService.on("mapcontrol:toggled",this.mapControlToggleEventHandler),this.eventMapKey=this.map.on("click",function(t){t.originalEvent.stopPropagation(),t.preventDefault();var r=e.mapEpsg!==e.outputEpsg?ol.proj.transform(t.coordinate,e.mapEpsg,e.outputEpsg):t.coordinate;e.state.value=[r];var n=a(r,2),i=n[0],o=n[1];e.state.values.lon=i,e.state.values.lat=o})},f.stopToGetCoordinates=function(){ol.Observable.unByKey(this.eventMapKey),this.mapService.off("mapcontrol:toggled",this.mapControlToggleEventHandler)},f.clear=function(){this.stopToGetCoordinates()},t.exports=i},{"core/utils/utils":68,"gui/inputs/service":147,"services/gui":361}],136:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputLonLat.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputLonLat.vue":242}],137:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e)}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("gui/inputs/service");a(n,s),t.exports=n},{"core/utils/utils":68,"gui/inputs/service":147}],138:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputMedia.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputMedia.vue":243}],139:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pick_type=e.pick_type||"wms",this.ispicked=!1,this.fields=e.fields||[e.value],this.layerId=e.layer_id,this.mapService=l["default"].getService("map"),this.interaction="map"===this.pick_type?new u({layers:[this.mapService.getLayerById(this.layerId)]}):new c}var a=e("store/map-layers"),o=n(a),s=e("services/gui"),l=n(s),u=e("g3w-ol/interactions/pickfeatureinteraction"),c=e("g3w-ol/interactions/pickcoordinatesinteraction"),d=e("core/utils/geo"),f=d.getQueryLayersPromisesByCoordinates,p=i.prototype;p.isPicked=function(){return this.ispicked},p.escKeyUpHandler=function(e){var t=e.keyCode,r=e.data.owner;27===t&&r.unpick()},p.unbindEscKeyUp=function(){$(document).unbind("keyup",this.escKeyUpHandler)},p.bindEscKeyUp=function(){$(document).on("keyup",{owner:this},this.escKeyUpHandler)},p.pick=function(){var e=this;return new Promise(function(t,r){e.bindEscKeyUp();var n={};e.ispicked=!0;var i=function(i){if(i){var a=i.getProperties();e.fields.forEach(function(e){n[e]=a[e]}),t(n)}else r();e.ispicked=!1,e.unpick()};l["default"].setModal(!1),e.mapService.addInteraction(e.interaction),e.interaction.once("picked",function(t){if("map"===e.pick_type){var r=t.feature;i(r)}else if("wms"===e.pick_type){var n=o["default"].getLayerById(e.layerId);n&&f([n],{map:e.mapService.getMap(),feature_count:1,coordinates:t.coordinate}).then(function(e){var t=e[0].data,r=void 0===t?[]:t,n=r.length&&r[0].features[0]||null;i(n)})}})})},p.unpick=function(){this.mapService.removeInteraction(this.interaction),l["default"].setModal(!0),this.unbindEscKeyUp(),this.ispicked=!1},p.clear=function(){this.isPicked()&&this.unpick(),this.mapService=this.interaction=this.field=null},t.exports=i},{"core/utils/geo":64,"g3w-ol/interactions/pickcoordinatesinteraction":105,"g3w-ol/interactions/pickfeatureinteraction":106,"services/gui":361,"store/map-layers":377}],140:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputPickLayer.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputPickLayer.vue":244}],141:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e)}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("gui/inputs/service");a(n,s),t.exports=n},{"core/utils/utils":68,"gui/inputs/service":147}],142:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputRadio.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputRadio.vue":245}],143:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.state.input.options.values[0],r=t.min,n=t.max;e.state.info="[MIN: "+r+" - MAX: "+n+"]",o(this,e);var i=l.get("range",{min:1*r,max:1*n});this.setValidator(i)}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("gui/inputs/service"),l=e("core/utils/validators");a(n,s);var u=s.prototype;u.isValueInRange=function(e,t,r){return e<=r&&e>=t},t.exports=n},{"core/utils/utils":68,"core/utils/validators":69,"gui/inputs/service":147}],144:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputRange.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputRange.vue":246}],145:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};c(this,e),this.layer=null}var a=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=e("store/catalog-layers"),s=n(o),l=e("core/utils/utils"),u=l.inherit,c=l.base,d=e("gui/inputs/service");u(i,d);var f=i.prototype;f._getLayerById=function(e){return s["default"].getLayerById(e)},f.addValue=function(e){this.state.input.options.values.push(e)},f.getKeyByValue=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.search,n=this.state.input.options,i=n.value,o=n.key;this.getData({key:i,value:o,search:r}).then(function(t){var r=a(t,1),n=r[0],i=n.$value,o=n.text;e.addValue({key:i,value:o})})["catch"](function(e){})},f.getData=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.layer_id,n=void 0===r?this.state.input.options.layer_id:r,i=t.key,a=void 0===i?this.state.input.options.key:i,o=t.value,s=void 0===o?this.state.input.options.value:o,l=t.search,u=(a+"|"+l).trim();return new Promise(function(t,r){e._layer||(e._layer=e._getLayerById(n)),e._layer.getDataTable({suggest:u,ordering:a}).then(function(e){for(var r=[],n=e.features,i=0;i<n.length;i++)r.push({text:n[i].properties[a],id:i,$value:n[i].properties[s]});t(r)}).fail(function(e){return r(e)})})},t.exports=i},{"core/utils/utils":68,"gui/inputs/service":147,"store/catalog-layers":374}],146:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputSelect.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputSelect.vue":247}],147:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state=e.state||{},this.setValue(this.state.value),this.setEmpty(this.state.value);var t=this.state.type,r=e.validatorOptions||this.state.input.options||{};this._validator=i.get(t,r),this.setErrorMessage(e.state)}var i=e("core/utils/validators"),a=e("core/utils/utils"),o=a.toRawType,s=e("core/i18n/i18n.service"),l=s.t,u=n.prototype;u.getState=function(){return this.state},u.getValue=function(){return this.state.value},u.setValue=function(e){if(null===e||"undefined"==typeof e){var t=this.state.input.options,r=t["default"];Array.isArray(t)&&(t[0]["default"]?r=t[0]["default"]:Array.isArray(t.values)&&t.values.length>0&&(r=t.values[0]&&(t.values[0].value||t.values[0])));var n=this.state.get_default_value&&void 0!==r&&null!==r;n&&void 0===t.default_expression&&(this.state.value=r),this.state.value_from_default_value=n}},u.addValueToValues=function(e){this.state.input.options.values.unshift(e)},u._getValidatorType=function(){return this.state.type},u.setState=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state=_.isObject(e)?e:{}},u.getValidator=function(){return this._validator},u.setValidator=function(e){this._validator=e},u.setEmpty=function(){this.state.validate.empty=!(Array.isArray(this.state.value)&&this.state.value.length||!_.isEmpty(_.trim(this.state.value)))},u.validate=function(){return this.state.validate.empty?(this.state.validate.empty=!0,this.state.value=null,this.state.validate.unique=!0,this.state.validate.valid=!this.state.validate.required&&this._validator.validate(this.state.value)):("integer"!==this.state.input.type&&"float"!==this.state.input.type||(+this.state.value<0?(this.state.value=null,this.state.validate.empty=!0,this.state.validate.valid=!this.state.validate.required):this.state.validate.valid=this._validator.validate(this.state.value)),this.state.validate.exclude_values&&this.state.validate.exclude_values.size?this.state.validate.valid=!this.state.validate.exclude_values.has(this.state.value):this.state.validate.valid=this._validator.validate(this.state.value)),this.state.validate.valid},u.setErrorMessage=function(e){var t=void 0;e.validate.mutually&&!e.validate.mutually_valid?this.state.validate.message=l("sdk.form.inputs.input_validation_mutually_exclusive")+" ( "+e.validate.mutually.join(",")+" )":e.validate.max_field?this.state.validate.message=l("sdk.form.inputs.input_validation_max_field")+" ("+e.validate.max_field+")":e.validate.min_field?this.state.validate.message=l("sdk.form.inputs.input_validation_min_field")+" ("+e.validate.min_field+")":e.validate.unique&&e.validate.exclude_values&&e.validate.exclude_values.size?this.state.validate.message=""+l("sdk.form.inputs.input_validation_exclude_values"):e.validate.required?(t=l("sdk.form.inputs.input_validation_error")+" ( "+l("sdk.form.inputs."+e.type)+" )",this.state.info&&(t=t+"\n                 <div>\n                  <b>"+this.state.info+"</b>\n                 </div>         \n      "),this.state.validate.message=this.state.info||t):this.state.validate.message=this.state.info},u.setUpdate=function(){var e=this.state,t=e.value,r=e._value;"media"===this.state.input.type&&"Object"!==o(t)&&"Object"!==o(r)?this.state.update=t.value!=r.value:"datetimepicker"===this.state.input.type?this.state.update=(null!==t?t.toUpperCase():t)!=(r?r.toUpperCase():r):this.state.update=t!=r},t.exports=n},{"core/i18n/i18n.service":13,"core/utils/utils":68,"core/utils/validators":69}],148:[function(e,t,r){var n={text:e("./service"),textarea:e("./service"),texthtml:e("./service"),integer:e("./integer/service"),string:e("./service"),"float":e("./float/service"),radio:e("./radio/service"),check:e("./checkbox/service"),range:e("./range/service"),datetimepicker:e("./datetimepicker/service"),unique:e("./unique/service"),select:e("./select/service"),media:e("./media/service"),select_autocomplete:e("./select/service"),picklayer:e("./service"),color:e("./service"),slider:e("./sliderrange/service"),lonlat:e("./lonlat/service")};t.exports=n},{"./checkbox/service":124,"./datetimepicker/service":127,"./float/service":129,"./integer/service":133,"./lonlat/service":135,"./media/service":137,"./radio/service":141,"./range/service":143,"./select/service":145,"./service":147,"./sliderrange/service":149,"./unique/service":154}],149:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.state;e.state.info="[MIN: "+t.input.options.min+" - MAX: "+t.input.options.max+"]",a(this,e);var r=l.get("range",{min:1*t.input.options.min,max:1*t.input.options.max});this.setValidator(r),this.validate=function(){this.state.value=1*this.state.value,this.state.validate.valid=this.state.value>=this.state.input.options.min||this.state.value<=this.state.input.options.max}}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("gui/inputs/service"),l=e("core/utils/validators");o(n,s);var u=n.prototype;u.changeInfoMessage=function(){this.state.info="[MIN: "+this.state.input.options.min+" - MAX: "+this.state.input.options.max+"]"},t.exports=n},{"core/utils/utils":68,"core/utils/validators":69,"gui/inputs/service":147}],150:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputSliderRange.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputSliderRange.vue":248}],151:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputText.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputText.vue":249}],152:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputTextArea.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputTextArea.vue":250}],153:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputTextHtml.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputTextHtml.vue":251}],154:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e)}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("gui/inputs/service");a(n,s),t.exports=n},{"core/utils/utils":68,"gui/inputs/service":147}],155:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputUnique.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputUnique.vue":252}],156:[function(e,t,r){var n=e("g3w-ol/controls/resetcontrol"),i=e("g3w-ol/controls/querycontrol"),a=e("g3w-ol/controls/zoomboxcontrol"),o=e("g3w-ol/controls/querybboxcontrol"),s=e("g3w-ol/controls/querybypolygoncontrol"),l=e("g3w-ol/controls/geolocationcontrol"),u=e("g3w-ol/controls/streetviewcontrol"),c=e("g3w-ol/controls/addlayers"),d=e("g3w-ol/controls/lengthcontrol"),f=e("g3w-ol/controls/areacontrol"),p=e("g3w-ol/controls/olcontrol"),h=e("g3w-ol/controls/geocodingcontrol"),v=e("g3w-ol/controls/mousepositioncontrol"),g=e("g3w-ol/controls/scalecontrol"),m=e("g3w-ol/controls/onclickcontrol"),y=e("g3w-ol/controls/screenshotcontrol"),_=e("g3w-ol/controls/geoscreenshotcontrol"),b=e("g3w-ol/controls/zoomhistorycontrol"),w=e("g3w-ol/controls/querybydrawpolygoncontrol"),x=e("g3w-ol/controls/interactioncontrol"),S={create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=S.CONTROLS[e.type];if(t)return new t(e)}};S.CONTROLS={reset:n,zoombox:a,zoomtoextent:p,query:i,querybbox:o,querybypolygon:s,geolocation:l,streetview:u,zoom:p,scaleline:p,overview:p,geocoding:h,addlayers:c,length:d,area:f,mouseposition:v,scale:g,onclick:m,ontoggle:x,screenshot:y,geoscreenshot:_,querybydrawpolygon:w,zoomhistory:b,nominatim:h},t.exports=S},{"g3w-ol/controls/addlayers":76,"g3w-ol/controls/areacontrol":77,"g3w-ol/controls/geocodingcontrol":80,"g3w-ol/controls/geolocationcontrol":81,"g3w-ol/controls/geoscreenshotcontrol":82,"g3w-ol/controls/interactioncontrol":83,"g3w-ol/controls/lengthcontrol":84,"g3w-ol/controls/mousepositioncontrol":86,"g3w-ol/controls/olcontrol":87,"g3w-ol/controls/onclickcontrol":88,"g3w-ol/controls/querybboxcontrol":89,"g3w-ol/controls/querybydrawpolygoncontrol":90,"g3w-ol/controls/querybypolygoncontrol":91,"g3w-ol/controls/querycontrol":92,"g3w-ol/controls/resetcontrol":93,"g3w-ol/controls/scalecontrol":94,"g3w-ol/controls/screenshotcontrol":95,"g3w-ol/controls/streetviewcontrol":96,"g3w-ol/controls/zoomboxcontrol":98,"g3w-ol/controls/zoomhistorycontrol":99}],157:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.state={mapUnits:"m",bbox:[],hidemaps:[],resolution:null,center:null,loading:!1,hidden:!0,scale:0,mapcontrolsalignement:"rv",mapcontrolDOM:null,mapcontrolready:!1,mapcontrolSizes:{height:47,width:47,minWidth:47,minHeight:47},mapControl:{grid:[],length:0,currentIndex:0,update:!0,disabled:!1},map_info:{info:null,style:null},mapunits:["metric"]},this.id="MapService",this._ready=new Promise(function(t,r){e.once("viewerset",function(){h["default"].getLayersStores().forEach(e._setUpEventsKeysToLayersStore.bind(e)),h["default"].onafter("addLayersStore",e._setUpEventsKeysToLayersStore.bind(e)),h["default"].onafter("removeLayersStore",e._removeEventsKeysToLayersStore.bind(e)),t()})}),this.viewer=null,this.target=t.target||null,this.layersCount=0,this.maps_container=t.maps_container||null,this._layersStoresEventKeys={},this._keyEvents={ol:[],g3wobject:[],eventemitter:[]},this.project=null,this._mapControls=[],this._changeMapMapControls=[],this._mapLayers=[],this._externalMapLayers=[],this._externalLayers=[],this._externalInteractions=[],this.mapBaseLayers={},this.defaultsLayers={_style:{highlightLayer:{color:void 0},selectionLayer:{color:"red"}},highlightLayer:new ol.layer.Vector({source:new ol.source.Vector,style:function i(t){var r=[],n=t.getGeometry().getType(),i=N({geometryType:n,color:e.defaultsLayers._style.highlightLayer.color,fill:!1});return r.push(i),r}}),selectionLayer:new ol.layer.Vector({source:new ol.source.Vector,style:function a(t){var r=[],n=t.getGeometry().getType(),a=N({geometryType:n,color:e.defaultsLayers._style.selectionLayer.color,fill:!1});return r.push(a),r}})},this.layersExtraParams={},this._greyListenerKey=null,this._drawShadow={type:"coordinate",outer:[],inner:[],scale:null,rotation:null},this.config=t.config||y["default"].getConfig(),this._howManyAreLoading=0,this._layersLoadingError=!1,this._incrementLoaders=function(){0===e._howManyAreLoading&&(e.emit("loadstart"),S["default"].showSpinner({container:$("#map-spinner"),id:"maploadspinner",style:"transparent"})),e._howManyAreLoading+=1},this._decrementLoaders=function(){e._howManyAreLoading-=1,0===e._howManyAreLoading&&(e.emit("loadend"),S["default"].hideSpinner("maploadspinner"))},this._mapLayerLoadError=function(){e._layersLoadingError||(S["default"].notify.warning("sdk.errors.layers.load"),e._layersLoadingError=!0),e._decrementLoaders()},t.project)this.project=t.project;else{this.project=g["default"].getCurrentProject();var r=g["default"].onafter("setCurrentProject",function(t){e.removeLayers(),e._removeListeners();var r=e.project.getId()===t.getId();e.project=t;var n=function(){e._resetView(),e._setupAllLayers(),e._checkMapControls(),e.setUpMapOlEvents(),e.setupCustomMapParamsToLegendUrl()};y["default"].isIframe()&&n(),r?n():e.getMap().once("change:size",n)});this._keyEvents.g3wobject.push({who:g["default"],setter:"setCurrentProject",key:r})}this._setupListeners(),this._marker=null,this._bboxLayer=new ol.layer.Vector({source:new ol.source.Vector({})}),this.debounces={setupCustomMapParamsToLegendUrl:{fnc:function(){e._setupCustomMapParamsToLegendUrl.apply(e,arguments)},delay:1e3}},this.setters={setupControls:function(){return this._setupControls()},addHideMap:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(e.ratio,e.layers,e.mainview,e.switchable),r=void 0!==t&&t,n="hidemap_"+Date.now(),i={id:n,map:null,switchable:r};return this.state.hidemaps.push(i),i},updateMapView:function(e,t,r){this.state.bbox=e,this.state.resolution=t,this.state.center=r,this.updateMapLayers()},setHidden:function(e){this.state.hidden=e},setupViewer:function(e,t){0!==e&&0!==t&&(this.viewer&&(this.viewer.destroy(),this.viewer=null),this._setupViewer(e,t),this.state.bbox=this.viewer.getBBOX(),this.state.resolution=this.viewer.getResolution(),this.state.center=this.viewer.getCenter(),this._setupAllLayers(),this.setUpMapOlEvents(),this.emit("viewerset"))},controlClick:function(e){arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}},loadExternalLayer:function(e){},unloadExternalLayer:function(e){}},this._onCatalogSelectLayer=function(e){w["default"].catalogSelectedLayer(e)},this.on("cataloglayerselected",this._onCatalogSelectLayer),this._keyEvents.eventemitter.push({event:"cataloglayerselected",listener:this._onCatalogSelectLayer});var n=function(t,r){r&&e.getMapLayers().forEach(function(r){return r.update(e.state,t)})};this.on("extraParamsSet",n),this._keyEvents.eventemitter.push({event:"extraParamsSet",listener:n}),E(this)}var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=e("app/constant"),c=e("gui/wms/vue/wms"),d=(n(c),e("services/data")),f=n(d),p=e("store/map-layers"),h=n(p),v=e("store/projects"),g=n(v),m=e("services/application"),y=n(m),b=e("store/map-controls"),w=n(b),x=e("services/gui"),S=n(x),L=e("core/i18n/i18n.service"),C=(L.t,e("core/utils/utils")),k=C.inherit,E=C.base,M=C.copyUrl,T=C.uniqueId,I=C.throttle,P=C.toRawType,F=C.createFilterFromString,O=e("core/g3wobject"),R=e("core/utils/geo"),A=R.createVectorLayerFromFile,j=R.createWMSLayer,N=R.createSelectedStyle,D=R.getMapLayersByFilter,G=R.getGeoTIFFfromServer,V=e("core/layers/providers/wfsprovider"),U=e("g3w-ol/g3w.ol").helpers,q=e("core/utils/ol"),B=q.getScaleFromResolution,z=q.getResolutionFromScale,W=e("gui/map/control/factory"),H=e("core/layers/vectorlayer");k(o,O);var K=o.prototype;K.isReady=function(){return this._ready},K.setUpMapOlEvents=function(){var e=this,t=this.project.getContextBaseLegend();this._keyEvents.ol.forEach(function(e){
return ol.Observable.unByKey(e)});var r=this.viewer.map.getView().on("change:resolution",function(r){e._updateMapView(),t&&e.setupCustomMapParamsToLegendUrl()});if(this._keyEvents.ol.push(r),t){var n=this.viewer.map.on("moveend",function(t){return e.setupCustomMapParamsToLegendUrl()});this._keyEvents.ol.push(n)}else this.setupCustomMapParamsToLegendUrl()},K.clear=function(){var e=this;Object.keys(this._keyEvents).forEach(function(t){switch(t){case"ol":e._keyEvents[t].forEach(function(e){return ol.Observable.unByKey(e)});break;case"g3wobject":e._keyEvents[t].forEach(function(e){var t=e.who,r=e.setter,n=e.key;t.un(r,n)});break;case"eventemitter":e._keyEvents[t].forEach(function(t){var r=t.event,n=t.listener;e.removeListener(r,n)})}}),this._keyEvents=null,h["default"].getLayersStores().forEach(this._removeEventsKeysToLayersStore.bind(this))},K.showMapSpinner=function(){S["default"].showSpinner({container:$("#map-spinner"),id:"maploadspinner",style:"transparent"})},K.hideMapSpinner=function(){S["default"].hideSpinner("maploadspinner")},K.getScaleFromExtent=function(e){var t=this.getMap().getView().getResolutionForExtent(e,this.getMap().getSize()),r=B(t,this.getMapUnits());return r},K._addHideMap=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.ratio,r=e.layers,n=void 0===r?[]:r,i=e.mainview,a=void 0!==i&&i,o=this.state.hidemaps[this.state.hidemaps.length-1],s=this.getMap().getView(),u={projection:s.getProjection(),center:s.getCenter(),resolution:this.getResolution()},c=U.createViewer({id:o.id,view:a?s:u});if(o.map=c.getMap(),t){var d=o.map.getSize(),f=l(d,2),p=f[0];f[1];o.map.setSize([p,p*t])}for(var h=0;h<n.length;h++){var v=n[h];o.map.addLayer(v)}return o.map},K.removeHideMap=function(e){for(var t=void 0,r=0;r<this.state.hidemaps.length;r++)if(e===this.state.hidemaps[r].id){t=r;break}void 0!==t&&this.state.hidemaps.splice(t,1)},K._showHideMapElement=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.map,r=e.show,n=void 0!==r&&r;n?$(t.getTargetElement()).addClass("show"):$(t.getTargetElement()).removeClass("show")},K.createMapImage=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.map;t.background;return new Promise(function(t,n){try{var i=e.getMapCanvas(r);navigator.msSaveBlob?t(i.msToBlob()):i.toBlob(function(e){return t(e)})}catch(a){n(a)}})},K.getApplicationAttribution=function(){var e=this.config.group,t=e.header_terms_of_use_link,r=e.header_terms_of_use_text;return!!r&&(t?'<a href="'+t+'">'+r+"</a>":'<span class="skin-color" style="font-weight: bold">'+r+"</span>")},K.slaveOf=function(e,t){t=t||!1},K.setLayersExtraParams=function(e,t){this.layersExtraParams=_.assign(this.layersExtraParams,e),this.emit("extraParamsSet",e,t)},K.getProject=function(){return this.project},K.getMap=function(){try{return this.viewer.map}catch(e){}},K.getMapCanvas=function(e){var t=e?e.getViewport():$("#"+this.maps_container+" .g3w-map").last().children(".ol-viewport")[0];return $(t).children("canvas")[0]},K.getProjection=function(){return this.project.getProjection()},K.isMapHidden=function(){return this.state.hidden},K.isAxisOrientationInverted=function(){return"neu"===this.getProjection().getAxisOrientation()},K.getCrs=function(){return this.getProjection().getCode()},K.getViewerElement=function(){return this.viewer.map.getTargetElement()},K.getViewport=function(){return this.viewer.map.getViewport()},K.getResolution=function(){return this.viewer.map.getView().getResolution()},K.getEpsg=function(){return this.viewer.map.getView().getProjection().getCode()},K.getGetFeatureInfoUrlForLayer=function(e,t,r,n,i){var a=this.getMapLayerForLayer(e);return a.getGetFeatureInfoUrl(t,r,n,i)},K.showMarker=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this._marker.setPosition(e),setTimeout(function(){return t._marker.setPosition()},r)},K.getLayerByName=function(e){return this.getMap().getLayers().getArray().find(function(t){return t.get("name")===e})},K.getLayerById=function(e){return this.getMap().getLayers().getArray().find(function(t){return t.get("id")===e})},K.getVectorLayerFeaturesFromCoordinates=function(e,t){var r=void 0,n=[],i=this.getMap(),a=this.getLayerById(e);if(Array.isArray(t)){if(2===t.length){var o=i.getPixelFromCoordinate(t);i.forEachFeatureAtPixel(o,function(e){return n.push(e)},{layerFilter:function(e){return e===a}})}else if(4===t.length)switch(r=ol.geom.Polygon.fromExtent(t),a.constructor){case H:n=a.getIntersectedFeatures(r);break;case ol.layer.Vector:a.getSource().getFeatures().forEach(function(e){r.intersectsExtent(e.getGeometry().getExtent())&&n.push(e)})}}else if(t instanceof ol.geom.Polygon||t instanceof ol.geom.MultiPolygon)switch(r=t,a.constructor){case H:n=a.getIntersectedFeatures(r);break;case ol.layer.Vector:a.getSource().getFeatures().forEach(function(e){r.intersectsExtent(e.getGeometry().getExtent())&&n.push(e)})}return n},K.getQueryLayerByCoordinates=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,r=e.coordinates,n=this.getProjection(),i=this.getResolution();return new Promise(function(e,a){t.query({coordinates:r,mapProjection:n,resolution:i}).then(function(t){return e(t)}).fail(function(e){return a(e)})})},K.getQueryLayerPromiseByCoordinates=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.layer,n=t.coordinates;return new Promise(function(t,i){var a=e.getProjection(),o=e.getResolution();r.query({coordinates:n,mapProjection:a,resolution:o}).then(function(e){t(e)}).fail(function(e){i(e)})})},K.activeMapControl=function(e){var t=this._mapControls.find(function(t){return t.type===e}),r=t.control;r.isToggled()?null:r.toggle()},K.createMapControl=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.id,n=t.add,i=void 0===n||n,a=t.toggled,o=void 0!==a&&a,l=t.visible,u=t.options,c=void 0===u?{}:u,d=W.create(s({type:e,toggled:o},c));return l=void 0===l?!d.isVisible||d.isVisible():l,d&&this.addControl(r||e,e,d,i,l),d},K.addScaleLineUnits=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach(function(t){return e.state.mapunits.push(t)})},K.changeScaleLineUnit=function(e){var t=this.getMapControlByType({type:"scaleline"});t&&t.getOlControl().setUnits(e)},K.showAddLayerModal=function(){this.emit("addexternallayer")},K._checkMapControls=function(){this._changeMapMapControls.forEach(function(e){var t=e.control,r=e.getLayers;t.change(r())})},K._setupControls=function(){var e=this,t=D({BASELAYER:!0});if(this.getMapLayers().forEach(function(t){return t.getSource().setAttributions(e.getApplicationAttribution())}),this.getApplicationAttribution()||t.length){var r=new ol.control.Attribution({collapsible:!1,target:"map_footer_left"});this.getMap().addControl(r)}if(this.config&&this.config.mapcontrols){var n=this.config.mapcontrols,i="intersects";return n.forEach(function(t){var r=void 0,n="String"===P(t)?t:t.name;switch(n){case"reset":isMobile.any||(r=W.create({type:n})),e.addControl(n,r,!1);break;case"zoom":r=e.createMapControl(n,{options:{zoomInLabel:"",zoomOutLabel:""}});break;case"zoombox":isMobile.any||(r=e.createMapControl(n,{}),r.on("zoomend",function(t){e.viewer.fit(t.extent)}));break;case"zoomtoextent":r=e.createMapControl(n,{options:{label:"",extent:e.project.state.initextent}});break;case"mouseposition":if(!isMobile.any){var o="m"===e.getProjection().getUnits()?["X","Y"]:["Lng","Lat"],s=e.getCrs();if(r=e.createMapControl(n,{add:!1,options:{coordinateFormat:function(e){return ol.coordinate.format(e," "+o[0]+": {x}, "+o[1]+": {y}   ["+s+"] ",4)},undefinedHTML:!1,projection:e.getCrs()}}),"EPSG:4326"!==e.getEpsg()){var l=e.getEpsg(),u=["Lng","Lat"],c=e.getCrs();r=e.createMapControl(n,{add:!1,options:{target:"mouse-position-control-epsg-4326",coordinateFormat:function(e){return e=ol.proj.transform(e,l,"EPSG:4326"),ol.coordinate.format(e," "+u[0]+": {x}, "+u[1]+": {y}   ["+c+"] ",4)},undefinedHTML:!1,projection:e.getCrs()}})}}break;case"screenshot":case"geoscreenshot":isMobile.any||(r=e.createMapControl(n,{options:{layers:[].concat(a(h["default"].getLayers()),a(e._externalLayers)),onclick:e._handlePrint.bind(e,n)}}));break;case"scale":r=e.createMapControl(n,{add:!1,options:{coordinateFormat:ol.coordinate.createStringXY(4),projection:e.getCrs(),isMobile:isMobile.any}});break;case"query":r=e.createMapControl(n,{add:!0,toggled:!0});break;case"querybypolygon":isMobile.any||(r=e.createMapControl(n,{options:{spatialMethod:i}}));break;case"querybbox":isMobile.any||(r=e.createMapControl(n,{options:{spatialMethod:i}}));break;case"querybydrawpolygon":isMobile.any||(r=e.createMapControl(n,{options:{spatialMethod:i}}));break;case"streetview":r=e.createMapControl(n,{});break;case"scaleline":r=e.createMapControl(n,{add:!1,options:{position:"br"}});break;case"overview":if(!isMobile.any){if(!e.config.overviewproject)return;var d=e.config.overviewproject.gid;d&&g["default"].getProject(d).then(function(t){var i=e.getOverviewMapLayers(t),a=e._calculateViewOptions({width:200,height:150,project:t}),o=new ol.View(a),s=e.getMap().getView();o.on("change:center",function(){var e=this.getCenter(),t=s.constrainCenter(e);t[0]!==e[0]||t[1]!==e[1]&&o.setCenter(t)}),r=e.createMapControl(n,{add:!1,options:{position:"bl",className:"ol-overviewmap ol-custom-overviewmap",collapseLabel:$('<span class="'+S["default"].getFontClass("arrow-left")+'"></span>')[0],label:$('<span class="'+S["default"].getFontClass("arrow-right")+'"></span>')[0],collapsed:!1,layers:i,view:o}})})}break;case"geocoding":case"nominatim":var f=e.project.state,p=f.extent,v=f.crs.epsg;r=e.createMapControl(n,{add:!1,options:{isMobile:isMobile.any,bbox:p,mapCrs:v,placeholder:"mapcontrols.nominatim.placeholder",noresults:"mapcontrols.nominatim.noresults",notresponseserver:"mapcontrols.nominatim.notresponseserver"}});break;case"geolocation":r=e.createMapControl(n),r.on("click",I(function(t){return e.showMarker(t.coordinates)})),r.on("error",function(e){S["default"].showUserMessage({type:"warning",message:"mapcontrols.geolocations.error",autoclose:!0})});break;case"addlayers":isMobile.any||(r=e.createMapControl(n,{}),r.on("addlayer",function(){return e.emit("addexternallayer")}));break;case"length":isMobile.any||(r=e.createMapControl(n,{options:{tipLabel:"sdk.mapcontrols.measures.length.tooltip",interactionClassOptions:{projection:e.getProjection(),help:"sdk.mapcontrols.measures.length.help"}}}));break;case"area":isMobile.any||(r=e.createMapControl(n,{options:{tipLabel:"sdk.mapcontrols.measures.area.tooltip",interactionClassOptions:{projection:e.getProjection(),help:"sdk.mapcontrols.measures.area.help"}}}));break;case"zoomhistory":r=e.createMapControl(n,{add:!1}),e._addControlToMapControlsLeftBottom(r)}}),this.getMapControls()}},K.setZIndexLayer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,r=e.zindex,n=void 0===r?this.getMap().getLayers().getLength():r;t&&t.setZIndex(n)},K.getLayerZindex=function(e){return e&&e.getZIndex()},K.getCenter=function(){var e=this.getMap();return e.getView().getCenter()},K.zoomToFid=i(regeneratorRuntime.mark(function Y(){var e,t,r,n,i,a,o,s,u,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"|";return regeneratorRuntime.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(e=c.split(d),t=l(e,2),r=t[0],n=t[1],void 0===r||void 0===n){p.next=10;break}return i=this.project.getLayerById(r),p.next=5,f["default"].getData("search:fids",{inputs:{layer:i,fids:[n]},outputs:{show:{loading:!1,condition:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data,r=void 0===t?[]:t;return r[0]&&r[0].features.length>0}}}});case 5:a=p.sent,o=a.data,s=void 0===o?[]:o,u=s[0]&&s[0].features[0],u&&this.zoomToFeatures([u]);case 10:case"end":return p.stop()}},Y,this)})),K.handleZoomToFeaturesUrlParameter=i(regeneratorRuntime.mark(function Q(){var e,t,r,n,i,a,o,s,u,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},d=c.zoom_to_features,p=void 0===d?"":d,h=c.search_endpoint,v=void 0===h?"api":h;return regeneratorRuntime.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(c.prev=0,e=p.split(":"),t=l(e,2),r=t[0],n=t[1],!r||!n){c.next=12;break}if(i=this.project.getLayers().find(function(e){return e.id===r||e.name===r||e.origname===r}),!i){c.next=12;break}return a=this.project.getLayerById(i.id),o=F({layer:a,search_endpoint:v,filter:n}),c.next=9,f["default"].getData("search:features",{inputs:{layer:a,filter:o,search_endpoint:v},outputs:{show:{loading:!1}}});case 9:s=c.sent,u=s.data,u&&u[0]&&u[0].features&&this.zoomToFeatures(u[0].features);case 12:c.next=17;break;case 14:c.prev=14,c.t0=c["catch"](0);case 17:case"end":return c.stop()}},Q,this,[[0,14]])})),K.getMapExtent=function(){var e=this.getMap();return e.getView().calculateExtent(e.getSize())},K.addMapExtentUrlParameterToUrl=function(e,t){return e=new URL(e),e.searchParams.set("map_extent",(void 0!==t&&this.getEpsg()!==t?ol.proj.transformExtent(this.getMapExtent(),this.getEpsg(),t):this.getMapExtent()).toString()),e.toString()},K.getMapExtentUrl=function(){var e=new URL(location.href),t=this.getMapExtent().toString();return e.searchParams.set("map_extent",t),e.toString()},K.createCopyMapExtentUrl=function(){var e=this.getMapExtentUrl();M(e)},K._setMapControlsGrid=function(e){var t=this.state.mapControl.grid;if(e<2){var r=t[t.length-1];return void t.push({rows:2*r.rows,columns:2})}if(2===e)if(t.length){var n=t[t.length-1];t.push({rows:n.columns,columns:n.rows})}else t.push({rows:1,columns:2});else if(3===e){var i=t[t.length-1];t.push({rows:2*i.rows,columns:e})}else{t.push({rows:t.length+1+(Number.isInteger(e)?0:1),columns:Number.isInteger(e)?e:parseInt(e)+1});var a=Number.isInteger(e)?e:parseInt(e);this._setMapControlsGrid(a/2)}},K._setMapControlsInsideContainerLenght=function(){var e=this;this.state.mapControl.length=1,this._mapControls.forEach(function(t){var r=e.getMap();e.state.mapControl.length+=t.mapcontrol?"zoom"===t.id?2:1:0,t.control.changelayout?t.control.changelayout(r):null}),this.state.mapControl.length+=this.state.mapControl.length%2,this.state.mapControl.grid=[],this._setMapControlsGrid(this.state.mapControl.length)},K.filterableLayersAvailable=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=D({FILTERABLE:!0,SELECTED_OR_ALL:!0},e);return t.filter(function(e){return e.getProvider("filter")instanceof V})},K.setMapControlsAlignement=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"rv";this.state.mapcontrolsalignement=e},K.getMapControlsAlignement=function(){return this.state.mapcontrolsalignement},K.isMapControlsVerticalAlignement=function(){return this.state.mapcontrolsalignement.indexOf("v")!==-1},K.setMapControlsVerticalAlignement=function(){this.state.mapcontrolsalignement=this.state.mapcontrolsalignement[0]+"v"},K.setMapControlsHorizontalAlignement=function(){this.state.mapcontrolsalignement=this.state.mapcontrolsalignement[0]+"h"},K.flipControlsHorizontally=function(){this.state.mapcontrolsalignement="r"===this.state.mapcontrolsalignement[0]?"l"+this.state.mapcontrolsalignement[1]:"r"+this.state.mapcontrolsalignement[1]},K.flipMapControlsVertically=function(){this.state.mapcontrolsalignment="v"===this.state.mapcontrolsalignement[1]?this.state.mapcontrolsalignement[0]+"h":this.state.mapcontrolsalignement[0]+"v"},K.setMapControlsContainer=function(e){this.state.mapcontrolDOM=e},K._updateMapControlsLayout=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.width,n=t.height;if(0==r||0==n?this.state.mapcontrolDOM.css("z-index",0):this.state.mapcontrolDOM.css("z-index",1),this.state.mapcontrolready&&this.state.mapControl.update){var i={changed:!1,space:!1};if(this._mapControls.forEach(function(t){var r=e.getMap();t.control.changelayout?t.control.changelayout(r):null}),this.isMapControlsVerticalAlignement()){var a=function o(){var t=e.state.mapControl.grid[e.state.mapControl.currentIndex].columns*e.state.mapcontrolSizes.minWidth,r=$(".ol-control-b"+e.getMapControlsAlignement()[0]),a=r.length?$(r[r.length-1]).position().top:n,s=a>0?a-t:n-t;if(s<10)e.state.mapControl.currentIndex=e.state.mapControl.currentIndex===e.state.mapControl.grid.length-1?e.state.mapControl.currentIndex:e.state.mapControl.currentIndex+1,i.changed=!0;else{var l=15+(e.state.mapControl.currentIndex>0?e.state.mapControl.grid[e.state.mapControl.currentIndex-1].columns*e.state.mapcontrolSizes.minWidth-t:t);s>l&&(i.changed=!0,i.space=!0,e.state.mapControl.currentIndex=0===e.state.mapControl.currentIndex?e.state.mapControl.currentIndex:e.state.mapControl.currentIndex-1)}if(i.changed){var u=e.state.mapControl.grid[e.state.mapControl.currentIndex].columns*e.state.mapcontrolSizes.minWidth,c=e.state.mapControl.grid[e.state.mapControl.currentIndex].rows*e.state.mapcontrolSizes.minWidth;e.state.mapcontrolDOM.css("height",u+"px"),e.state.mapcontrolDOM.css("width",c+"px"),i.changed=!1,i.space&&setTimeout(function(){return o()})}};a()}else isMobile.any&&this.setMapControlsAlignement("rv")}},K._setMapControlVisible=function(e){var t=e.control,r=e.visible,n=void 0===r||r;t&&t.setVisible(n)},K._addControlToMapControls=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.element;t||(e.element.style.display="none"),$(".g3w-map-controls").append(r)},K._addControlToMapControlsLeftBottom=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t||(e.element.style.display="none"),$(".g3w-map-controls-left-bottom").append(e.element)},K.getMapControlByType=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=this._mapControls.find(function(e){return t===e.type});return r&&r.control},K.addControl=function(e,t,r){var n=this,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.state.mapcontrolready=!1,this.viewer.map.addControl(r),r.on("toggled",function(e){return n.emit("mapcontrol:toggled",e)}),this._mapControls.push({id:e,type:t,control:r,visible:a,mapcontrol:i&&a}),r.on("controlclick",function(e){var t=e.target,r=t.isClickMap&&t.isClickMap()||!1;r&&n._externalInteractions.forEach(function(e){return e.setActive(!1)}),n.controlClick(t,{clickmap:r})});var o=$(r.element).find("button");if(o.tooltip({placement:"bottom",trigger:S["default"].isMobile()?"click":"hover"}),S["default"].isMobile()&&o.on("shown.bs.tooltip",function(){var e=this;setTimeout(function(){return $(e).tooltip("hide")},600)}),i)this._addControlToMapControls(r,a);else{var s=$("#"+this.getMap().getTarget());this._updateMapControlsLayout({width:s.width(),height:s.height()})}w["default"].registerControl(t,r),this._setMapControlsInsideContainerLenght(),this.state.mapcontrolready=!0},K.showControl=function(e){this.showControls([e])},K.hideControl=function(e){this.hideControls([e])},K.showControls=function(e){this.toggleControls(!0,e)},K.hideControls=function(e){this.toggleControls(!1,e)},K.showAllControls=function(){this.toggleControls(!0)},K.hideAllControls=function(){this.toggleControls(!1)},K.toggleControls=function(e,t){this._removeControls(),this._mapControls.forEach(function(r){t?t.indexOf(r.type)>-1&&(r.visible=e):r.visible=e}),this._layoutControls()},K._layoutControls=function(){var e=this;this._mapControls.forEach(function(t){t.visible&&e.viewer.map.addControl(t.control)})},K.getMapControls=function(){return this._mapControls},K.removeControlById=function(e){var t=this;this._mapControls.find(function(r,n){if(e===r.id){t._mapControls.splice(n,1);var i=r.control;return t.viewer.map.removeControl(i),i.hideControl&&i.hideControl(),!0}})},K.removeControl=function(e){var t=this;this._mapControls.find(function(r,n){if(e===r.type){t._mapControls.splice(n,1);var i=r.control;return t.viewer.map.removeControl(i),i.hideControl&&i.hideControl(),!0}})},K._removeControls=function(){var e=this;this._mapControls.forEach(function(t){return e.viewer.map.removeControl(t.control)})},K._unToggleControls=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.close,r=void 0===t||t;this._mapControls.forEach(function(e){e.control.isToggled&&e.control.isToggled()&&(e.control.toggle(!1),r&&S["default"].closeContent())})},K.deactiveMapControls=function(){this._unToggleControls({close:!1})},K.disableClickMapControls=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._mapControls.forEach(function(t){var r=t.control,n=!!r.isClickMap&&r.isClickMap();n&&(r.isToggled()&&r.toggle(),r[e?"disable":"enable"]())})},K.addMapLayers=function(e){var t=this;e.reverse().forEach(function(e){return t.addMapLayer(e)})},K._setupCustomMapParamsToLegendUrl=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(e){var t=this.getMap(),r=t&&t.getSize().filter(function(e){return e>0})||null,n=r&&2===r.length?t.getView().calculateExtent(r):this.project.state.initextent;n="neu"===t.getView().getProjection().getAxisOrientation()?[n[1],n[0],n[3],n[2]]:n;var i=this.getEpsg();this.getMapLayers().forEach(function(e){e.setupCustomMapParamsToLegendUrl&&e.setupCustomMapParamsToLegendUrl({crs:i,bbox:n})}),this.emit("change-map-legend-params")}},K.addMapLayer=function(e){this._mapLayers.push(e),this.addLayerToMap(e)},K.getMapLayerByLayerId=function(e){return this.getMapLayers().find(function(t){return t.getLayerConfigs().find(function(t){return t.getId()===e})})},K.getMapLayers=function(){return this._mapLayers},K.getBaseLayers=function(){return this.mapBaseLayers},K.getMapLayerForLayer=function(e){var t="layer_"+e.getMultiLayerId(),r=this.getMapLayers(),n=r.find(function(e){return e.getId()===t});return n},K.getProjectLayer=function(e){return h["default"].getLayerById(e)},K._setSettings=function(){var e=u.MAP_SETTINGS.ZOOM,t=this.getScaleFromExtent(this.project.state.initextent);e.maxScale=e.maxScale>t?t:e.maxScale},K._resetView=function(){var e=this.viewer.map.getSize(),t=l(e,2),r=t[0],n=t[1],i=this.project.state.extent,a=ol.extent.getWidth(i)/r,o=ol.extent.getHeight(i)/n,s=Math.max(a,o)>this.viewer.map.getView().getMaxResolution()?Math.max(a,o):this.viewer.map.getView().getMaxResolution(),u=new ol.View({extent:i,projection:this.viewer.map.getView().getProjection(),center:this.viewer.map.getView().getCenter(),resolution:this.viewer.map.getView().getResolution(),maxResolution:s});this._setSettings(),this.viewer.map.setView(u)},K._calculateViewOptions=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.project,n=t.width,i=t.height,a=new URLSearchParams(location.search),o=a.get("map_extent"),s=a.get("zoom_to_fid"),l=a.get("ztf"),u=a.get("lat")&&a.get("lon")&&{lat:1*a.get("lat"),lon:1*a.get("lon")},c=a.get("x")&&a.get("y")&&{x:1*a.get("x"),y:1*a.get("y")};s?this.zoomToFid(s):l?this.handleZoomToFeaturesUrlParameter({zoom_to_features:l}):!u||Number.isNaN(u.lat)||Number.isNaN(u.lon)?!c||Number.isNaN(c.x)||Number.isNaN(c.y)||setTimeout(function(){var t=new ol.geom.Point([c.x,c.y]);e.zoomToGeometry(t)}):setTimeout(function(){var t=new ol.geom.Point(ol.proj.transform([u.lon,u.lat],"EPSG:4326",e.getEpsg()));t.getExtent()&&e.zoomToGeometry(t)});var d=o?o.split(",").map(function(e){return 1*e}):r.state.initextent,f=this.getProjection(),p=r.state.extent,h=ol.extent.getWidth(p)/n,v=ol.extent.getHeight(p)/i,g=Math.max(h,v),m=ol.extent.getWidth(d)/n,y=ol.extent.getHeight(d)/i,_=Math.max(m,y),b=ol.extent.getCenter(d);return{projection:f,center:b,extent:p,maxResolution:g,resolution:_}},K._setupViewer=function(e,t){var r=this;this.viewer=U.createViewer({id:this.target,view:this._calculateViewOptions({width:e,height:t,project:this.project})}),this._setSettings(),this.state.size=this.viewer.map.getSize(),this.state.mapUnits=this.viewer.map.getView().getProjection().getUnits(),this.config.background_color&&$("#"+this.target).css("background-color",this.config.background_color),$(this.viewer.map.getViewport()).prepend('<div id="map-spinner" style="position:absolute; top: 50%; right: 50%"></div>'),this.viewer.map.getInteractions().forEach(function(e){return r._watchInteraction(e)}),this.viewer.map.getInteractions().on("add",function(e){return r._watchInteraction(e.element)}),this.viewer.map.getInteractions().on("remove",function(e){}),this._marker=new ol.Overlay({position:null,positioning:"center-center",element:document.getElementById("marker"),stopEvent:!1}),this.viewer.map.addOverlay(this._marker),this.viewer.map.getLayers().on("add",function(e){var t=e.element,n=t.get("basemap"),i=t.get("position"),a=n&&0;i&&"bottom"===i&&(a=0),a=r.setLayerZIndex({layer:t,zindex:a}),r.moveDefaultLayersOnTop(a)}),this.viewer.map.getLayers().on("remove",function(e){var t=e.element,n=t.getZIndex();n===r.layersCount&&(r.layersCount-=1)})},K.getMapUnits=function(){return this.state.mapUnits},K._removeListeners=function(){this._setBaseLayerListenerKey&&this.project.un("setBaseLayer",this._setBaseLayerListenerKey)},K._removeEventsKeysToLayersStore=function(e){var t=e.getId();this._layersStoresEventKeys[t]&&(this._layersStoresEventKeys[t].forEach(function(t){Object.entries(t).forEach(function(t){var r=l(t,2),n=r[0],i=r[1];return e.un(n,i)})}),delete this._layersStoresEventKeys[t])},K._setUpEventsKeysToLayersStore=function(e){var t=this,r=e.getId();this._layersStoresEventKeys[r]=[],this._layersStoresEventKeys[r].push({addLayer:e.onafter("addLayer",function(e){"vector"===e.getType()&&t.addLayerToMap(e.getMapLayer())})}),this._layersStoresEventKeys[r].push({removeLayer:e.onafter("removeLayer",function(e){"vector"===e.getType()&&t.viewer.map.removeLayer(e.getOLLayer())})})},K._setupListeners=function(){var e=this;this._setBaseLayerListenerKey=this.project.onafter("setBaseLayer",function(){e.updateMapLayers()})},K._setupAllLayers=function(){this._setupBaseLayers(),this._setupMapLayers(),this._setupVectorLayers(),this._setUpDefaultLayers()},K._setupBaseLayers=function(){var e=this,t=D({BASELAYER:!0});if(t.length){t.forEach(function(t){var r=t.getMapLayer();e.registerMapLayerListeners(r),e.mapBaseLayers[t.getId()]=r});var r=Object.values(this.mapBaseLayers).reverse();r.forEach(function(t){t.update(e.state,e.layersExtraParams),e.addLayerToMap(t)})}},K._setupMapLayers=function(){var e=this,t=D({BASELAYER:!1,VECTORLAYER:!1});this._setMapProjectionToLayers(t);var r={},n=_.groupBy(t,function(e){var t=e.getMultiLayerId();return e.isQtimeseries()?(r[t]=void 0===r[t]?0:r[t]+1,t=t+"_"+r[t]):t=void 0===r[t]?t:t+"_"+(r[t]+1),t});r=null;var i=[];return Object.entries(n).forEach(function(t){var r=l(t,2),n=r[0],a=r[1],o="layer_"+n,s=void 0,u=a[0]||[];1===a.length?(s=u.getMapLayer({id:o,projection:e.getProjection(),format:u.getSource()&&u.getSource().format},{}),s.addLayer(u),i.push(s)):(s=u.getMapLayer({id:o,projection:e.getProjection()},e.layersExtraParams),a.reverse().forEach(function(e){return s.addLayer(e)}),i.push(s)),e.registerMapLayerListeners(s)}),this.addMapLayers(i),this.updateMapLayers(),i},K._setupVectorLayers=function(){var e=this,t=D({VECTORLAYER:!0});this._setMapProjectionToLayers(t),t.forEach(function(t){var r=t.getMapLayer();e.addLayerToMap(r)})},K._setUpDefaultLayers=function(){this.getMap().addLayer(this.defaultsLayers.highlightLayer),this.getMap().addLayer(this.defaultsLayers.selectionLayer)},K.moveDefaultLayersOnTop=function(e){this.setZIndexLayer({layer:this.defaultsLayers.highlightLayer,zindex:e+1}),this.setZIndexLayer({layer:this.defaultsLayers.selectionLayer,zindex:e+2})},K.removeDefaultLayers=function(){this.defaultsLayers.highlightLayer.getSource().clear(),this.defaultsLayers.selectionLayer.getSource().clear(),this.getMap().removeLayer(this.defaultsLayers.highlightLayer),this.getMap().removeLayer(this.defaultsLayers.selectionLayer)},K.setDefaultLayerStyle=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e&&this.defaultsLayers[e]&&(this.defaultsLayers._style[e]=t)},K.resetDefaultLayerStyle=function(e){arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e&&this.defaultsLayers[e]&&(this.defaultsLayers._style[e]={color:"highlightLayer"===e?void 0:"red"})},K.removeLayers=function(){this._removeBaseLayers(),this._removeMapLayers(),this.removeExternalLayers(),this.removeDefaultLayers()},K.removeAllLayers=function(){this.viewer.removeLayers()},K.setLayerZIndex=function(e){var t=e.layer,r=e.zindex,n=void 0===r?this.layersCount+=1:r;return t.setZIndex(n),n},K.addLayerToMap=function(e){var t=e.getOLLayer();t&&this.getMap().addLayer(t)},K._setMapProjectionToLayers=function(e){var t=this;e.forEach(function(e){return e.setMapProjection(t.getProjection())})},K.createMapLayer=function(e){e.setMapProjection(this.getProjection());var t="layer_"+e.getMultiLayerId(),r=e.getMapLayer({id:t,projection:this.getProjection()},this.layersExtraParams);return r.addLayer(e),r},K.getOverviewMapLayers=function(t){var r=e("core/layers/map/wmslayer"),n=t.getLayersStore().getLayers({GEOLAYER:!0,BASELAYER:!1}),i=_.groupBy(n,function(e){return e.getMultiLayerId()}),a=[];return Object.entries(i).forEach(function(e){var n=l(e,2),i=n[0],o=n[1],s="overview_layer_"+i,u=o[0].state.tiled,c={url:t.getWmsUrl(),id:s,tiled:u},d=new r(c);o.reverse().forEach(function(e){return d.addLayer(e)}),a.push(d.getOLLayer(!0))}),a.reverse()},K.updateMapLayer=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{force:!1},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.showSpinner,i=void 0===n||n;return t.force&&(t.g3w_time=Date.now()),i!==e.showSpinnerWhenLoading&&(e.showSpinnerWhenLoading=i,this[i?"registerMapLayerLoadingEvents":"unregisterMapLayerLoadingEvents"](e)),e.update(this.state,t),e},K.updateMapLayers=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.getMapLayers().forEach(function(r){return e.updateMapLayer(r,t)});var r=this.getBaseLayers();Object.values(r).forEach(function(t){return t.update(e.state,e.layersExtraParams)})},K.registerMapLayerListeners=function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.registerMapLayerLoadingEvents(e),r&&e.layers&&Array.isArray(e.layers)&&e.layers.forEach(function(r){r.onbefore("change",function(){return t.updateMapLayer(e,{force:!0})}),r.on("filtertokenchange",function(){return t.updateMapLayer(e,{force:!0})})})},K.registerMapLayerLoadingEvents=function(e){e.on("loadstart",this._incrementLoaders),e.on("loadend",this._decrementLoaders),e.on("loaderror",this._mapLayerLoadError)},K.unregisterMapLayerLoadingEvents=function(e){e.off("loadstart",this._incrementLoaders),e.off("loadend",this._decrementLoaders),e.off("loaderror",this._mapLayerLoadError)},K.unregisterMapLayerListeners=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.unregisterMapLayerLoadingEvents(e),t&&e.layers&&Array.isArray(e.layers)&&e.layers.forEach(function(e){e.un("change"),e.removeEvent("filtertokenchange")})},K.setTarget=function(e){this.target=e},K.getCurrentToggledMapControl=function(){var e=this._mapControls.find(function(e){var t=e.control;return t&&t.isToggled&&t.isToggled()});return e&&e.control},K.addInteraction=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{active:!0,close:!0},r=t.active,n=void 0===r||r,i=this.getCurrentToggledMapControl(),a=i&&i.isToggled&&i.isToggled()||!1,o=!i||!i.isClickMap||i.isClickMap();return o&&n&&this._unToggleControls(t),this.getMap().addInteraction(e),e.setActive(n),this._externalInteractions.push(e),{control:i,toggled:a}},K.removeInteraction=function(e){e&&e.setActive(!1),this.viewer.map.removeInteraction(e),this._externalInteractions=this._externalInteractions.filter(function(t){return e!==t})},K._watchInteraction=function(e){var t=this;e.on("change:active",function(e){e.target instanceof ol.interaction.Pointer&&e.target.getActive()&&t.emit("mapcontrol:active",e.target)})},K.showMapInfo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.info,r=e.style;
this.state.map_info.info=t,this.state.map_info.style=r||this.state.map_info.style},K.hideMapInfo=function(){this.state.map_info.info=null,this.state.map_info.style=null},K.zoomTo=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;this.viewer.zoomTo(e,t)},K.goTo=function(e,t){var r={zoom:t||6};this.viewer.goTo(e,r)},K.goToRes=function(e,t){this.viewer.goToRes(e,{resolution:t})},K.getGeometryAndExtentFromFeatures=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=void 0,r=void 0,n=void 0,i=void 0,o=[],s=0;s<e.length;s++){var l=e[s],u=l.getGeometry?l.getGeometry():l.geometry;if(u){if(u instanceof ol.geom.Geometry){var c=[].concat(a(u.getExtent()));t=t?ol.extent.extend(t,c):c,r=r?r:u.getType(),i=u.getCoordinates(),r.includes("Multi")?o=[].concat(a(o),a(i)):o.push(i)}else{var d=l.bbox;t=t?ol.extent.extend(t,d):d,r=u.type,i=u.coordinates}r.includes("Multi")?o=[].concat(a(o),a(i)):o.push(i)}}try{var f=r.includes("Multi")?r:"Multi"+r;n=new ol.geom[f](o),void 0===t&&(t=n.getExtent())}catch(p){}return{extent:t,geometry:n}},K.highlightFeatures=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.getGeometryAndExtentFromFeatures(e),n=r.geometry;t.zoom=!1,this.highlightGeometry(n,t)},K.zoomToGeometry=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{highlight:!1},r=e&&e.getExtent(),n=t.highlight;n&&r&&(t.highLightGeometry=e),r&&this.zoomToExtent(r,t)},K.zoomToFeatures=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{highlight:!1},r=this.getGeometryAndExtentFromFeatures(e),n=r.geometry,i=r.extent,a=t.highlight;return a&&i&&(t.highLightGeometry=n),i&&this.zoomToExtent(i,t)||Promise.resolve()},K.zoomToExtent=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.goToRes(ol.extent.getCenter(e),this.getResolutionForZoomToExtent(e,{force:t.force||!1})),t.highLightGeometry?this.highlightGeometry(t.highLightGeometry,{zoom:!1,duration:t.duration}):Promise.resolve()},K.zoomToProjectInitExtent=function(){this.zoomToExtent(this.project.state.initextent)},K.compareExtentWithProjectMaxExtent=function(e){var t=this.project.state.extent,r=ol.extent.containsExtent(t,e);return r?e:t},K.getResolutionForZoomToExtent=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{force:!1},r=this.getMap();if(!1===ol.extent.containsExtent(this.project.state.extent,e))return r.getView().getResolutionForExtent(this.project.state.extent,r.getSize());var n=r.getView().getResolutionForExtent(e,r.getSize());if(!0===t.force)return n;var i=void 0,a=r.getView().getResolution(),o=z(u.MAP_SETTINGS.ZOOM.maxScale,this.getMapUnits());return i=n>o?n:o,i=a<i&&a>n?a:i},K.goToBBox=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getEpsg();e=t===this.getEpsg()?e:ol.proj.transformExtent(e,t,this.getEpsg()),this.viewer.fit(this.compareExtentWithProjectMaxExtent(e))},K.goToWGS84=function(e,t){e=ol.proj.transform(e,"EPSG:4326",this.project.state.crs.epsg),this.goTo(e,t)},K.extentToWGS84=function(e){return ol.proj.transformExtent(e,this.project.state.crs.epsg,"EPSG:4326")},K.getResolutionForMeters=function(e){var t=this.viewer.map.getViewport();return e/Math.max(t.clientWidth,t.clientHeight)};var Z=!1;K.setSelectionFeatures=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"add",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.feature,n=t.color;n&&this.setDefaultLayerStyle("selectionLayer",{color:n});var i=this.defaultsLayers.selectionLayer.getSource();switch(e){case"add":i.addFeature(r);break;case"remove":i.removeFeature(r);break;case"update":var a=r.getId(),o=i.getFeatureById(a);o.setGeometry(r.getGeometry());break;case"clear":i.clear()}},K.clearSelectionFeatures=function(){this.defaultsLayers.selectionLayer.getSource().clear()},K.seSelectionLayerVisible=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.defaultsLayers.selectionLayer.setVisible(e)},K.highlightGeometry=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(n,i){var a=r.color;t.clearHighlightGeometry(),t.setDefaultLayerStyle("highlightLayer",{color:a});var o="boolean"!=typeof r.zoom||r.zoom,s=r.hide;s&&(s="function"==typeof s?s:null);var l=r.style,c=function(e){var t=[],r=e.getGeometry().getType(),n=N({geometryType:r,color:a,fill:!1});return t.push(n),t},d=u.MAP_SETTINGS.ANIMATION,f="boolean"!=typeof r.highlight||r.highlight,p=r.duration||d.duration,h=void 0;if(e instanceof ol.geom.Geometry)h=e;else{var v=new ol.format.GeoJSON;h=v.readGeometry(e)}if(o){var g=h.getExtent();t.zoomToExtent(g)}if(f){var m=new ol.Feature({geometry:h}),y=t.defaultsLayers.highlightLayer;if(l&&y.setStyle(l),y.getSource().addFeature(m),s){var _=function(){y.getSource().clear(),l&&y.setStyle(c),n()};s(_)}else p&&p!==1/0&&(Z=!0,setTimeout(function(){y.getSource().clear(),l&&y.setStyle(c),Z=!1,n()},p))}else n()})},K.clearHighlightGeometry=function(){!Z&&this.defaultsLayers.highlightLayer.getSource().clear(),this.resetDefaultLayerStyle("highlightLayer")},K.refreshMap=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{force:!0};this.updateMapLayers(e)},K.layout=function(e){var t=e.width,r=e.height,n=t<=0||r<=0;this.viewer?n||(this.getMap().updateSize(),this.state.hidemaps.forEach(function(e){return e.map.updateSize()}),this._updateMapView()):(this.setupViewer(t,r),this.viewer&&(this.setupControls(),this.emit("ready"))),this.setHidden(n),this._mapControls.length&&this._updateMapControlsLayout({width:t,height:r})},K._removeBaseLayers=function(){var e=this;Object.keys(this.mapBaseLayers).forEach(function(t){e.viewer.map.removeLayer(e.mapBaseLayers[t].getOLLayer())})},K._removeMapLayers=function(){var e=this;this.getMapLayers().forEach(function(t){e.unregisterMapLayerListeners(t),e.viewer.map.removeLayer(t.getOLLayer())}),this._mapLayers=[]},K.getMapBBOX=function(){return this.viewer.getBBOX()},K._updateMapView=function(){var e=this.viewer.getBBOX(),t=this.viewer.getResolution(),r=this.viewer.getCenter(),n=this.getMap().getSize();this.updateMapView(e,t,r,n)},K.getMapSize=function(){var e=this.viewer.map;return e.getSize()},K.setInnerGreyCoverScale=function(e){this._drawShadow.scale=e},K._resetDrawShadowInner=function(){this._drawShadow={type:"coordinate",outer:[],inner:[],scale:null,rotation:null}},K.setInnerGreyCoverBBox=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.viewer.map,r=e.type||"coordinate",n=e.inner||null,i=e.rotation,a=e.scale,o=void 0,s=void 0;if(n){switch(r){case"coordinate":o=t.getPixelFromCoordinate([n[0],n[1]]),s=t.getPixelFromCoordinate([n[2],n[3]]);break;case"pixel":o=[n[0],n[1]],s=[n[2],n[3]]}var l=o[1]*ol.has.DEVICE_PIXEL_RATIO,u=o[0]*ol.has.DEVICE_PIXEL_RATIO,c=s[1]*ol.has.DEVICE_PIXEL_RATIO,d=s[0]*ol.has.DEVICE_PIXEL_RATIO;this._drawShadow.inner[0]=u,this._drawShadow.inner[1]=l,this._drawShadow.inner[2]=d,this._drawShadow.inner[3]=c}_.isNil(a)?this._drawShadow.scale=this._drawShadow.scale||1:this._drawShadow.scale=a,_.isNil(i)?this._drawShadow.rotation=this._drawShadow.rotation||0:this._drawShadow.rotation=i,this._drawShadow.outer&&t.render()},K.startDrawGreyCover=function(e){var t=this,r=this.viewer.map,n=void 0,i=void 0,a=void 0,o=void 0,s=void 0,l=void 0;this.stopDrawGreyCover();var u=function(r){var u=r.context,c=t.getMap().getSize(),d=c[1]*ol.has.DEVICE_PIXEL_RATIO,f=c[0]*ol.has.DEVICE_PIXEL_RATIO;if(t._drawShadow.outer=[0,0,f,d],u.restore(),u.beginPath(),u.moveTo(0,0),u.lineTo(f,0),u.lineTo(f,d),u.lineTo(0,d),u.lineTo(0,0),u.closePath(),t._drawShadow.inner.length&&(u.save(),n=t._drawShadow.inner[0],a=t._drawShadow.inner[3],i=t._drawShadow.inner[2],o=t._drawShadow.inner[1],s=t._drawShadow.rotation,l=t._drawShadow.scale,u.translate((i+n)/2,(o+a)/2),u.rotate(s*Math.PI/180),u.moveTo(-((i-n)/2),(o-a)/2),u.lineTo((i-n)/2,(o-a)/2),u.lineTo((i-n)/2,-((o-a)/2)),u.lineTo(-((i-n)/2),-((o-a)/2)),u.lineTo(-((i-n)/2),(o-a)/2),u.closePath()),u.fillStyle="rgba(0, 5, 25, 0.40)",u.fill(),e){u.font="bold 25px Arial",u.fillStyle="#ffffff",u.textAlign="center";for(var p=e.split("\n"),h=0;h<p.length;h++)u.fillText(p[h],f/2,d/2+30*h)}u.restore()};this._greyListenerKey=r.on("postcompose",u)},K.stopDrawGreyCover=function(){var e=this.getMap();this._greyListenerKey&&(ol.Observable.unByKey(this._greyListenerKey),this._greyListenerKey=null,this._drawShadow.inner.length&&this._resetDrawShadowInner()),e.render()},K.removeExternalLayers=function(){var e=this;this._externalLayers.forEach(function(t){e.removeExternalLayer(t.get("name"))}),this._externalLayers=[]},K.changeLayerVisibility=function(e){var t=e.id,r=(e.external,e.visible),n=this.getLayerById(t);n&&(n.setVisible(r),this.emit("change-layer-visibility",{id:t,visible:r}))},K.changeLayerOpacity=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.opacity,n=void 0===r?1:r,i=this.getLayerById(t);i&&i.setOpacity(n),this.emit("change-layer-opacity",{id:t,opacity:n})},K.changeLayerMapPosition=function(e){var t=e.id,r=e.position,n=void 0===r?u.MAP_SETTINGS.LAYER_POSITIONS["default"]:r,i=this.getLayerById(t);switch(n){case"top":i.setZIndex(this.layersCount);break;case"bottom":i.setZIndex(0)}this.emit("change-layer-position-map",{id:t,position:n})},K.removeExternalLayer=function(e){var t=this,r=this.getLayerByName(e);S["default"].getService("queryresults").unregisterVectorLayer(r),this.viewer.map.removeLayer(r);var n=r._type||"vector";S["default"].getService("catalog").removeExternalLayer({name:e,type:n}),"wms"==n&&(this._externalMapLayers=this._externalMapLayers.filter(function(e){var n=e.getId()===r.id;return n&&t.unregisterMapLayerListeners(e,r.projectLayer),!n})),this._externalLayers=this._externalLayers.filter(function(e){return e.get("id")!==r.get("id")}),this.unloadExternalLayer(r),this.emit("remove-external-layer",e)},K.addExternalWMSLayer=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.url,n=t.layers,i=t.name,a=t.epsg,o=void 0===a?this.getEpsg():a,s=t.position,l=void 0===s?u.MAP_SETTINGS.LAYER_POSITIONS["default"]:s,c=t.opacity,d=t.visible,f=void 0===d||d,p=ol.proj.get(o);return new Promise(function(t,a){var o=j({name:i,url:r,layers:n,projection:p}),s=o.wmslayer,u=o.olLayer;s.once("loadend",function(){t(s)}),s.once("loaderror",function(e){a(e)}),e.addExternalLayer(u,{position:l,opacity:c,visible:f}),e.addExternalMapLayer(s,!1)})},K.getExternalLayers=function(){return this._externalLayers},K.addExternalMapLayer=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._externalMapLayers.push(e),this.registerMapLayerListeners(e,t)},K.addExternalLayer=function(){var e=i(regeneratorRuntime.mark(function t(e){var r,n,i,a,o,s,l,c,d,f,p,h,v,g,m,y,_,b,w,x,L=this,C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=void 0,n=void 0,i=void 0,a=void 0,o=void 0,s=void 0,l=void 0,c=C.position,d=void 0===c?u.MAP_SETTINGS.LAYER_POSITIONS["default"]:c,f=C.opacity,p=void 0===f?1:f,h=C.visible,v=void 0===h||h,g=this.viewer.map,m=S["default"].getService("catalog"),y=S["default"].getService("queryresults"),e instanceof ol.layer.Vector){_=void 0,void 0===e.get("id")&&e.set("id",T()),r=e,r.filter={active:!1},r.selection={active:!1,features:[]};try{b=e.getStyle(),_=b._g3w_options?b._g3w_options.color:"blue"}catch(k){_="blue"}n=r.get("name")||r.get("id"),s="vector",e={id:e.get("id"),name:n,projectLayer:!1,title:n,removable:!0,external:!0,crs:C.crs,type:C.type,_type:s,download:C.download||!1,downloadUrl:C.downloadUrl,visible:v,checked:!0,position:d,opacity:p,color:_,filter:r.filter,selection:r.selection,tochighlightable:!1}}else e instanceof ol.layer.Image?(s="wms",n=e.get("name"),e.id=e.get("id"),e.removable=!0,e.projectLayer=!1,e.name=n,e.title=n,e._type=s,e.opacity=p,e.position=d,e.external=!0,e.checked=v):(n=e.name,s=e.type,l=e.crs,i=e.data,a=e.color);if(w=function(t,r){if(!t)return Promise.reject();var n=void 0;if("vector"===r){var i=t.getSource().getFeatures();if(i.length){var a=0;i.forEach(function(e){e.setId(a++)}),e.geometryType=i[0].getGeometry().getType(),e.selected=!1}n=t.getSource().getExtent(),e.bbox={minx:n[0],miny:n[1],maxx:n[2],maxy:n[3]}}return t.set("position",d),t.setOpacity(p),t.setVisible(v),g.addLayer(t),L._externalLayers.push(t),y.registerVectorLayer(t),m.addExternalLayer({layer:e,type:r}),n&&g.getView().fit(n),L.loadExternalLayer(t),Promise.resolve(t)},x=this.getLayerByName(n)){t.next=20;break}t.t0=s,t.next="vector"===t.t0?12:"wms"===t.t0?13:14;break;case 12:return t.abrupt("return",w(r,s));case 13:return t.abrupt("return",w(e,s));case 14:return t.next=16,A({name:n,type:s,crs:l,mapCrs:mapCrs,data:i,style:o});case 16:return r=t.sent,t.abrupt("return",w(r));case 18:t.next=21;break;case 20:S["default"].notify.warning("layer_is_added",!1);case 21:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),K.setExternalLayerStyle=function(e,t){e=e.rgba,e="rgba("+e.r+","+e.g+","+e.b+","+e.a+")";var r={Point:new ol.style.Style({image:new ol.style.Circle({fill:new ol.style.Fill({color:e}),radius:5,stroke:new ol.style.Stroke({color:e,width:1})})}),LineString:new ol.style.Style({stroke:new ol.style.Stroke({color:e,width:3})}),Polygon:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255,255,255,0.5)"}),stroke:new ol.style.Stroke({color:e,width:3})}),MultiPoint:new ol.style.Style({image:new ol.style.Circle({fill:new ol.style.Fill({color:e}),radius:5,stroke:new ol.style.Stroke({color:e,width:1})})}),MultiLineString:new ol.style.Style({stroke:new ol.style.Stroke({color:e,width:3})}),MultiPolygon:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255,255,255,0.5)"}),stroke:new ol.style.Stroke({color:e,width:3})})},n=function(e,t){var n=e.getStyleFunction();return n?n.call(e,t):r[e.getGeometry().getType()]};return n},K._handlePrint=function(){var e=i(regeneratorRuntime.mark(function t(e){var r,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=y["default"].setDownload(!0),t.prev=1,t.next=4,this.createMapImage();case 4:if(n=t.sent,"screenshot"!==e){t.next=9;break}saveAs(n,"map_"+Date.now()+".png"),t.next=15;break;case 9:return t.t0=saveAs,t.next=12,G({url:"/"+this.project.getType()+"/api/asgeotiff/"+this.project.getId()+"/",method:"POST",params:{image:n,csrfmiddlewaretoken:this.getCookie("csrftoken"),bbox:this.getMapBBOX().toString()}});case 12:t.t1=t.sent,t.t2="map_"+Date.now()+".tif",(0,t.t0)(t.t1,t.t2);case 15:t.next=20;break;case 17:t.prev=17,t.t3=t["catch"](1),S["default"].showUserMessage({type:"SecurityError"===t.t3.name?"warning":"alert",message:"SecurityError"===t.t3.name?"mapcontrols.screenshot.securityError":"mapcontrols.screenshot.error",autoclose:!1});case 20:return y["default"].setDownload(!1,r),t.abrupt("return",!0);case 22:case"end":return t.stop()}},t,this,[[1,17]])}));return function(t){return e.apply(this,arguments)}}(),t.exports=o},{"app/constant":4,"core/g3wobject":12,"core/i18n/i18n.service":13,"core/layers/map/wmslayer":45,"core/layers/providers/wfsprovider":53,"core/layers/vectorlayer":57,"core/utils/geo":64,"core/utils/ol":66,"core/utils/utils":68,"g3w-ol/g3w.ol":100,"gui/map/control/factory":156,"gui/wms/vue/wms":192,"services/application":351,"services/data":358,"services/gui":361,"store/map-controls":376,"store/map-layers":377,"store/projects":379}],158:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l(this,e),this.id="map-component",this.title="Map Component";var t=e.target||"map",r=e.maps_container||"g3w-maps";e.target=t,e.maps_container=r;var n=new f(e);this.setService(n),u(this,e),this.internalComponent=new p({service:n,target:t,maps_container:r}),n.getCookie=this.internalComponent.$cookie.get}var a=e("components/Map.vue"),o=n(a),s=e("core/utils/utils"),l=s.base,u=s.merge,c=s.inherit,d=e("gui/component/component"),f=e("gui/map/mapservice"),p=Vue.extend(o);Vue.component("g3w-map",o),c(i,d);var h=i.prototype;h.layout=function(e,t){$("#"+this.target).height(t),$("#"+this.target).width(e),this._service.layout({width:e,height:t})},t.exports=i},{"components/Map.vue":254,"core/utils/utils":68,"gui/component/component":117,"gui/map/mapservice":157}],159:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){this.content=null,this.show=!1,this.state={name:"",groups:{}},this._buildProjectGroupMetadata()}var a=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=e("store/projects"),s=n(o),l=e("services/gui"),u=n(l),c=e("core/utils/utils"),d=c.inherit,f=e("core/g3wobject"),p=e("gui/metadata/vue/components/project/project"),h={general:["title","name","description","abstract","keywords","fees","accessconstraints","contactinformation","wms_url"],spatial:["crs","extent"],layers:["layers"]};d(i,f);var v=i.prototype;v._buildProjectGroupMetadata=function(){var e=s["default"].getCurrentProject().getState();this.state.name=e.title;var t={};Object.entries(h).forEach(function(r){var n=a(r,2),i=n[0],o=n[1];t[i]={},o.forEach(function(r){var n=e.metadata&&e.metadata[r]?e.metadata[r]:e[r];n&&(t[i][r]={label:["sdk","metadata","groups",i,"fields",r].join("."),value:n})})}),this.state.groups=t},v.getProjectMetadata=function(){return this.state},v.getLayersMetadata=function(){return this.state.groups.layers},v.getLayerMetadata=function(e){var t=this.state.groups.layers.filter(function(t){return t.id===e});return t[0]},v.showMetadata=function(e){this.show=e,this.show?(this.content=new p({state:this.getProjectMetadata(),service:this}),u["default"].setContent({content:this.content,title:"sdk.metadata.title",perc:100}),this.show=!0):u["default"].closeContent()},v.reload=function(){this.emit("reload"),this._buildProjectGroupMetadata()},t.exports=i},{"core/g3wobject":12,"core/utils/utils":68,"gui/metadata/vue/components/project/project":160,"services/gui":361,"store/projects":379}],160:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.state,r=void 0===t?{}:t,n=e.service;u(this);var i=Vue.extend(o["default"]);this.setService(n),this.internalComponent=new i({state:r}),this.layout=function(){}}var a=e("components/MetadataProject.vue"),o=n(a),s=e("core/utils/utils"),l=s.inherit,u=s.base,c=e("gui/component/component");l(i,c),t.exports=i},{"components/MetadataProject.vue":262,"core/utils/utils":68,"gui/component/component":117}],161:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var a=e("components/Metadata.vue"),o=i(a),s=e("services/gui"),l=n(s),u=e("core/utils/utils"),c=u.inherit,d=u.base,f=e("gui/component/component"),p=e("gui/metadata/metadataservice"),h=Vue.extend(o),v=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};d(this,t),this.title="sdk.metadata.title";var r=t.service||new p(t);this.setService(r),this._service.on("reload",function(){e.setOpen(!1)}),this.setInternalComponent=function(){return this.internalComponent=new h({service:r}),this.internalComponent.state=r.state,this.internalComponent},this._setOpen=function(e){this._service.showMetadata(e)},l["default"].on("closecontent",function(){e.state.open=!1})};c(v,f),t.exports=v},{"components/Metadata.vue":260,"core/utils/utils":68,"gui/component/component":117,"gui/metadata/metadataservice":159,"services/gui":361}],162:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("services/gui"),a=n(i),o=e("core/utils/utils"),s=o.inherit,l=o.resolve,u=e("core/g3wobject"),c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.id=e.id||null,this.title=e.title||"",this.internalPanel=e.panel||null,this.service=e.service};s(c,u);var d=c.prototype;d.getId=function(){return this.id},d.getTitle=function(){return this.title},d.getService=function(){return this.service},d.setService=function(e){this.service=e},d.getInternalPanel=function(){return this.internalPanel},d.setInternalPanel=function(e){this.internalPanel=e},d.show=function(){a["default"].showPanel(this)},d.close=function(){a["default"].closePanel()},d.mount=function(e){var t=this.internalPanel,r=t.$mount();return $(e).append(r.$el),r.$nextTick(function(){$(e).localize(),t.onShow&&t.onShow()}),l(!0)},d.unmount=function(){var e=this.internalPanel,t=$.Deferred();return e.$destroy(!0),$(e.$el).remove(),e.onClose&&e.onClose(),this.internalComponent=null,t.resolve(),t.promise()},d.onResize=function(e,t){},t.exports=c},{"core/g3wobject":12,"core/utils/utils":68,"services/gui":361}],163:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function a(){v(this),this.printService=new x,this._initialized=!1,this.state={loading:!1},this._moveMapKeyEvent=null,this._page=null,this._mapService=null,this._map=null,this._mapUnits,this._scalesResolutions={},this.init=function(){this._project=l["default"].getCurrentProject(),this.state.print=this._project.getPrint()||[],this.state.visible=this.state.print.length>0,this.state.isShow=!1,this.state.url=null,this.state.output={url:null,method:this._project.getOwsMethod(),layers:!0,format:null,loading:!1,type:null},this.state.printextent={minx:[0,0],miny:[0,0],maxx:[0,0],maxy:[0,0]},this.state.visible&&this.setInitState()}}var o=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=e("store/projects"),l=n(s),u=e("services/application"),c=n(u),d=e("app/constant"),f=e("services/gui"),p=n(f),h=e("core/utils/utils"),v=h.base,g=h.inherit,m=h.downloadFile,y=e("core/i18n/i18n.service"),b=y.t,w=e("core/g3wobject"),x=e("core/print/printservice"),S=e("core/utils/ol"),L=S.getScaleFromResolution,C=S.getResolutionFromScale,k=S.getMetersFromDegrees,E=e("gui/print/vue/printpage");g(a,w);var M=a.prototype;M.setInitState=function(){this.state.template=this.state.print[0].name,this.state.atlas=this.state.print[0].atlas,this.state.atlasValues=[],this.state.rotation=0,this.state.inner=[0,0,0,0],this.state.center=null,this.state.size=null,this.state.scale=d.PRINT_SCALES,this.state.scala=null,this.state.dpis=d.PRINT_RESOLUTIONS,this.state.dpi=d.PRINT_RESOLUTIONS[0],this.state.formats=d.PRINT_FORMATS,this.state.output.format=d.PRINT_FORMATS[0].value,this.state.maps=this.state.print[0].maps,this.state.labels=this.state.print[0].labels},M.changeTemplate=function(){var e=this;if(this.state.template){var t=this.state.atlas,r=this.state.print.find(function(t){return t.name===e.state.template}),n=r.atlas,i=r.maps,a=r.labels;this.state.maps=i,this.state.atlas=n,this.state.labels=a,this.state.atlasValues=[],this.state.atlas?this._clearPrint():t?this.showPrintArea(!0):this._setPrintArea()}},M.changeScale=function(){this.state.scala&&this._setPrintArea()},M.changeRotation=function(){this._mapService.setInnerGreyCoverBBox({rotation:this.state.rotation})},M._getPrintExtent=function(){var e=[].concat(i(this.state.printextent.lowerleft),i(this.state.printextent.upperright)),t=e[0],r=e[1],n=e[2],a=e[3],o=this._mapService.isAxisOrientationInverted()?[r,t,a,n]:[t,r,n,a];return o.join()},M.getOverviewExtent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.xmin,r=e.xmax,n=e.ymin,i=e.ymax,a=this._mapService.isAxisOrientationInverted()?[n,t,i,r]:[t,n,r,i];return a.join()},M._getOptionsPrint=function(){var e=this,t=!1,r=this.state.maps.map(function(r){return t=t||void 0!==r.preset_theme,{name:r.name,preset_theme:r.preset_theme,scale:r.overview?r.scale:e.state.scala,extent:r.overview?e.getOverviewExtent(r.extent):e._getPrintExtent()}}),n={rotation:this.state.rotation,dpi:this.state.dpi,template:this.state.template,maps:r,scale:this.state.scala,format:this.state.output.format,labels:this.state.labels,is_maps_preset_theme:t};return n},M.setPrintAreaAfterCloseContent=function(){this._map.once("postrender",this._setPrintArea.bind(this)),this.stopLoading()},M.print=function(){var e=this;return new Promise(function(t,r){if(p["default"].disableSideBar(!0),e.state.atlas){var n=c["default"].setDownload(!0);e.state.loading=!0,e.printService.printAtlas({template:e.state.template,field:e.state.atlas.field_name||"$id",values:e.state.atlasValues,download:!0}).then(function(i){var a=i.url;m({url:a,filename:e.state.template,mime_type:"application/pdf"}).then(function(){t()})["catch"](function(t){e.showError(t),r()})["finally"](function(){e.state.loading=!1,c["default"].setDownload(!1,n),p["default"].disableSideBar(!1)})})}else{e.state.output.url=null,e.state.output.layers=!0,e._page=new E({service:e}),p["default"].setContent({content:e._page,title:"print",perc:100});var i=e._getOptionsPrint();e.printService.print(i,method=e.state.output.method).then(function(r){e.state.output.url=r.url,e.state.output.layers=r.layers,e.state.output.mime_type=r.mime_type,t()})["catch"](function(t){e.showError(),r(t)})["finally"](function(){!e.state.output.layers&&p["default"].disableSideBar(!1)})}})},M.startLoading=function(){this.state.output.loading=!0},M.stopLoading=function(){this.state.output.loading=!1},M.showError=function(e){p["default"].notify.error(e||b("info.server_error")),p["default"].closeContent()},M._calculateInternalPrintExtent=function(){var e=this._map.getView().getResolution(),t=parseFloat(this.state.scala),r=this.state.maps.find(function(e){return!e.overview}),n=r.h,i=r.w,a="m"===this._mapService.getMapUnits()?e:k(e),o=i/1e3*t/a,s=n/1e3*t/a,l=[this.state.size[0]/2,this.state.size[1]/2],u=l[0]-o/2,c=l[1]-s/2,d=l[0]+o/2,f=l[1]+s/2;this.state.printextent.lowerleft=this._map.getCoordinateFromPixel([u,f])?this._map.getCoordinateFromPixel([u,f]):this.state.printextent.lowerleft,this.state.printextent.upperright=this._map.getCoordinateFromPixel([d,c])?this._map.getCoordinateFromPixel([d,c]):this.state.printextent.upperright,this.state.inner=[u,f,d,c]},M._setPrintArea=function(){this.state.size=this._map.getSize();var e=this._map.getView().getResolution();this.state.currentScala=L(e,this._mapUnits),this.state.center=this._map.getView().getCenter(),this._calculateInternalPrintExtent(),this._mapService.setInnerGreyCoverBBox({type:"pixel",inner:this.state.inner,rotation:this.state.rotation})},M._clearPrint=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];ol.Observable.unByKey(this._moveMapKeyEvent),this._moveMapKeyEvent=null,this._mapService.stopDrawGreyCover()},M._setAllScalesBasedOnMaxResolution=function(e){var t=this,r=e,n=L(r,this._mapUnits),i=_.orderBy(this.state.scale,["value"],["desc"]),a=[],o=!1,s=function(e){a.push(e),r=C(e.value,t._mapUnits),t._scalesResolutions[e.value]=r,r/=2};i.forEach(function(e,t){if(n>e.value){if(!o){var r=i[t-1];s(r),o=!0}s(e)}}),this.state.scale=a},M._setInitialScalaSelect=function(){this.state.scala=this.state.scale[0].value,$("#scala").val(this.state.scala)},M._setCurrentScala=function(e){var t=this;Object.entries(this._scalesResolutions).find(function(r){var n=o(r,2),i=n[0],a=n[1];if(e<=a)return t.state.scala=i,!0})},M._setMoveendMapEvent=function(){this._moveMapKeyEvent=this._map.on("moveend",this._setPrintArea.bind(this))},M._showPrintArea=function(){void 0===this.state.atlas&&(this._setPrintArea(),this._mapService.startDrawGreyCover())},M._initPrintConfig=function(){if(!this._initialized){var e=this._map.getView().getMaxResolution();this._setAllScalesBasedOnMaxResolution(e),this._initialized=!0}var t=this._map.getView().getResolution();this._setCurrentScala(t)},M.showPrintArea=function(e){var t=this;this.state.isShow=e,p["default"].closeContent().then(function(r){setTimeout(function(){t._mapService=r.getService(),t._mapUnits=t._mapService.getMapUnits(),t._mapService.getMap().once("postrender",function(r){t._map=r.map,e?(t._setMoveendMapEvent(),t._initPrintConfig(),t._showPrintArea()):t._clearPrint()}),t._mapService.getMap().renderSync()})})},M.reload=function(){var e=this;this._project=l["default"].getCurrentProject(),this._mapService=p["default"].getService("map"),this._map=this._mapService.viewer.map,this.state.print=this._project.state.print||[],this.state.visible=this.state.print.length>0,this.state.visible?(this.state.template=this.state.print[0].name,!this._initialized&&this.init(),this._initPrintConfig(),this._mapService.on("changeviewaftercurrentproject",function(){var t=e._map.getView().getMaxResolution();e.state.scale=d.PRINT_SCALES,e._setAllScalesBasedOnMaxResolution(t)})):this._clearPrint()},t.exports=a},{"app/constant":4,"core/g3wobject":12,"core/i18n/i18n.service":13,"core/print/printservice":60,"core/utils/ol":66,"core/utils/utils":68,"gui/print/vue/printpage":165,"services/application":351,"services/gui":361,"store/projects":379}],164:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u(this,e),this.title="print",this.vueComponent=o,this.internalComponent=null;var t=e.service||new d;this.setService(t),this._service.init(),this.setInternalComponent=function(){var e=Vue.extend(this.vueComponent);return this.internalComponent=new e({service:t}),this.state.visible=t.state.visible,this.internalComponent.state=t.state,this.internalComponent},this._reload=function(){var e=this.getService();e.reload(),this.state.visible=e.state.visible},this._setOpen=function(e){this._service.showPrintArea(e)}}var a=e("components/Print.vue"),o=n(a),s=e("core/utils/utils"),l=s.inherit,u=s.base,c=e("gui/component/component"),d=e("gui/print/printservice");l(i,c),t.exports=i},{"components/Print.vue":271,"core/utils/utils":68,"gui/component/component":117,"gui/print/printservice":163}],165:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/PrintPage.vue"),a=n(i),o=e("core/utils/utils"),s=o.inherit,l=o.base,u=e("gui/component/component"),c=Vue.extend(a),d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l(this);var t=e.service;this.setService(t);var r=new c({service:t});this.setInternalComponent(r),this.internalComponent.state=t.state.output,this.unmount=function(){return this.getService().setPrintAreaAfterCloseContent(),l(this,"unmount")}};s(d,u),t.exports=d},{"components/PrintPage.vue":273,"core/utils/utils":68,"gui/component/component":117}],166:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l(this,e),this.title=e.title||"menu",this.state.visible=!0,this.state.menuitems=e.menuitems;var t=e.host;c(this,e),
this.internalComponent=new f({service:this,host:t}),this.internalComponent.state=this.state}var a=e("components/ProjectsMenu.vue"),o=n(a),s=e("core/utils/utils"),l=s.base,u=s.inherit,c=s.merge,d=e("gui/component/component"),f=Vue.extend(o);u(i,d);var p=i.prototype;p.trigger=function(e){},t.exports=i},{"components/ProjectsMenu.vue":275,"core/utils/utils":68,"gui/component/component":117}],167:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.id="projectsmenu",c(this,e),this.state.menuitems=[];var t=e.host,r=e.projects||o["default"].getListableProjects();this.state.menuitems=r.map(function(r){return{title:r.title,description:r.description,thumbnail:r.thumbnail,gid:r.gid,cbk:e.cbk||function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.gid;return l["default"].changeProject({gid:r,host:t})}}})}var a=e("store/projects"),o=n(a),s=e("services/application"),l=n(s),u=e("core/utils/utils"),c=u.base,d=u.inherit,f=e("gui/projectsmenu/menu");d(i,f),t.exports=i},{"core/utils/utils":68,"gui/projectsmenu/menu":166,"services/application":351,"store/projects":379}],168:[function(e,t,r){var n=e("gui/querybuilder/vue/querybuilder"),i=e("gui/querybuilder/vue/panel/querybuilderpanel"),a={type:null,show:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=void 0===t?"sidebar":t,a=e.options,o=void 0;if(this.type=null===this.type?r:this.type,"modal"===this.type){o=new n({options:a});var s=o.$mount().$el;GUI.showModalDialog({title:"Query Builder",message:s,className:"modal-background-dark "})}else{var l=new i({options:a});o=l.getInternalPanel(),l.show()}return o}};t.exports=a},{"gui/querybuilder/vue/panel/querybuilderpanel":169,"gui/querybuilder/vue/querybuilder":170}],169:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.title="Query Builder",o(this,e);var t=new l(e);this.setInternalPanel(t)}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("gui/panel"),l=e("gui/querybuilder/vue/querybuilder");a(n,s),t.exports=n},{"core/utils/utils":68,"gui/panel":162,"gui/querybuilder/vue/querybuilder":170}],170:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/QueryBuilder.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/QueryBuilder.vue":276}],171:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function s(){var e=this;this.printService=new Z,this._currentLayerIds=[],h["default"].onafter("setCurrentProject",function(t){e._project=t,e._setRelations(t),e._setAtlasActions(t),e.state.download_data=!1,e.plotLayerIds=[]}),this.unlistenerlayeractionevents=[],this._actions={zoomto:s.zoomToElement,highlightgeometry:this.highlightGeometry.bind(this),clearHighlightGeometry:this.clearHighlightGeometry.bind(this)},this._relations=[],this._atlas=[],this.plotLayerIds=[];var t=this._project=h["default"].getCurrentProject();this._projectLayerIds=this._project.getConfigLayers().map(function(e){return e.id}),this.state={zoomToResult:!0,components:[],layers:[],changed:!1,query:null,type:"ows",layersactions:{},actiontools:{},currentactiontools:{},currentactionfeaturelayer:{},layeractiontool:{},layersFeaturesBoxes:{},layerscustomcomponents:{}},this.init=function(){this.clearState()},this.resultsQueryLayer=new ol.layer.Vector({source:new ol.source.Vector,style:function(e){var t=new ol.style.Fill({color:"rgba(0, 0, 255, 0.7)"}),r=new ol.style.Stroke({color:"blue",width:3});return"Point"===e.getGeometry().getType()?new ol.style.Style({text:new ol.style.Text({text:"",font:'900 3em "Font Awesome 5 Free"',fill:t,stroke:r,offsetY:-15})}):new ol.style.Style({stroke:r})}}),this._vectorLayers=[],this._addFeaturesLayerResultInteraction={id:null,interaction:null,mapcontrol:null,toggleeventhandler:null},this.setters={setQueryResponse:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{add:!1};if(e.data||(e.data=[]),e.query||(e.query={external:{add:!1,filter:{SELECTED:!1}}}),e.query.external||(e.query.external={add:!1,filter:{SELECTED:!1}}),!t.add)switch(this.clearState(),this.state.query=e.query,this.state.type=e.type,!0===e.query.external.add&&this._addVectorLayersDataToQueryResponse(e),this.state.query.type){case"coordinates":this.showCoordinates(this.state.query.coordinates);break;case"bbox":this.showBBOX(this.state.query.bbox);break;case"polygon":this.state.query.geometry&&this.showGeometry(this.state.query.geometry)}this.setLayersData(this._digestFeaturesForLayers(e.data),t)},setLayersData:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{add:!1},n=r.add;n||(this._currentLayerIds=e.map(function(e){return e.id}),this._orderResponseByProjectLayers(e)),e.forEach(function(e){n?t.updateLayerResultFeatures(e):t.state.layers.push(e)}),this.setActionsForLayers(e,{add:n}),this.state.changed=!0},addComponent:function(e){this._addComponent(e)},addActionsForLayers:function(e,t){},postRender:function(e){},closeComponent:function(){},changeLayerResult:function(e){this._changeLayerResult(e)},activeMapInteraction:function(){},editFeature:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.layer,e.feature},openCloseFeatureResult:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.open,e.layer,e.feature,e.container}},E(this),this.addLayersPlotIds=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.plotLayerIds=e},this.getPlotIds=function(){return this.plotLayerIds},this.findPlotId=function(e){return this.plotLayerIds.find(function(t){return t==e})},this._setRelations(t),this._setAtlasActions(t),this._asyncFnc={todo:T,zoomToLayerFeaturesExtent:{async:!1},goToGeometry:{async:!1}},d["default"].onbefore("setContent",function(t){var r=t.perc;e.mapService=e.mapService||C["default"].getApplicationService("map"),100===r&&d["default"].isMobile()&&(e._asyncFnc.zoomToLayerFeaturesExtent.async=!0,e._asyncFnc.goToGeometry.async=!0)})}var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=e("services/gui"),d=n(c),f=e("constant"),p=e("store/projects"),h=n(p),v=e("services/data"),g=n(v),m=e("store/catalog-layers"),y=n(m),b=e("components/QueryResultsActionDownloadFormats.vue"),w=n(b),x=e("components/QueryResultsActionQueryPolygonCSVAttributes.vue"),S=n(x),L=e("services/application"),C=n(L),k=e("core/utils/utils"),E=k.base,M=k.inherit,T=k.noop,I=k.downloadFile,P=k.throttle,F=k.getUniqueDomId,O=k.copyUrl,R=e("core/utils/geo"),A=R.createFeatureFromFeatureObject,j=R.intersects,N=R.within,D=e("core/utils/geo"),G=D.getAlphanumericPropertiesFromFeature,V=D.createFeatureFromGeometry,U=D.createFeatureFromBBOX,q=D.createFeatureFromCoordinates,B=e("core/i18n/i18n.service"),z=B.t,W=e("core/layers/layer"),H=e("core/g3wobject"),K=e("core/layers/vectorlayer"),Z=e("core/print/printservice"),Y=e("gui/relations/vue/relationspage"),Q=e("g3w-ol/interactions/pickcoordinatesinteraction"),X=new Vue;M(s,H);var J=s.prototype;J.registerCustomComponent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=void 0===t?F():t,n=e.layerId,i=e.component,a=e.type,o=void 0===a?"feature":a,s=e.position,l=void 0===s?"after":s;return void 0===this.state.layerscustomcomponents[n]&&(this.state.layerscustomcomponents[n]={layer:{before:[],after:[]},feature:{before:[],after:[]}}),this.state.layerscustomcomponents[n][o][l].push({id:r,component:i}),r},J.unRegisterCustomComponent=function(e){var t=this,r=e.id,n=e.layerId,i=e.type,a=e.position;a?this.state.layerscustomcomponents[n][i][a]=this.state.layerscustomcomponents[n][i][a].filter(function(e){var t=e.id;return t!==r}):Object.keys(this.state.layerscustomcomponents[n][i]).forEach(function(e){t.state.layerscustomcomponents[n][i][e]=t.state.layerscustomcomponents[n][i][e].filter(function(e){var t=e.id;return t!==r})})},J.addFeatureLayerToResult=function(e,t){this.state.layersFeaturesBoxes[this.getBoxId(e,t)].collapsed=!0},J.removeFeatureLayerFromResult=function(e,t){var r=e.id,n=e.external;this.updateLayerResultFeatures({id:r,external:n,features:[t]})},J.downloadApplicationWrapper=function(){var e=o(regeneratorRuntime.mark(function t(e){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=C["default"].setDownload(!0),d["default"].setLoadingContent(!0),t.prev=2,t.next=5,e(n);case 5:t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](2),d["default"].showUserMessage({type:"alert",message:t.t0||"server_error",textMessage:!!t.t0});case 10:C["default"].setDownload(!1,r),d["default"].setLoadingContent(!1);case 12:case"end":return t.stop()}},t,this,[[2,7]])}));return function(t){return e.apply(this,arguments)}}(),J.updateLayerResultFeatures=function(e){var t=this,r=e.features,n=void 0===r?[]:r,i=this.state.layers.find(function(t){return t.id===e.id});if(i&&n.length){var o=i.external,s=[],l=n.map(function(e){return o?e.id:e.attributes[f.G3W_FID]});if(i.features=i.features.filter(function(r){var i=l.indexOf(o?r.id:r.attributes[f.G3W_FID]),a=i===-1;if(a)t.state.layersFeaturesBoxes[t.getBoxId(e,r)].collapsed=!0;else{s.push(i);var u=n[i];t.state.layersFeaturesBoxes[t.getBoxId(e,r)].collapsed=!0,setTimeout(function(){return delete t.state.layersFeaturesBoxes[t.getBoxId(e,u)]})}return a}),n=n.filter(function(e,t){return s.indexOf(t)===-1}),n.length){var u=[].concat(a(i.features),a(n));i.features=u}1===i.features.length&&this.state.layersFeaturesBoxes[this.getBoxId(i,i.features[0])]&&setTimeout(function(){return t.state.layersFeaturesBoxes[t.getBoxId(i,i.features[0])].collapsed=!1}),this.checkIfLayerHasNoFeatures(i)}1===this.state.layers.length&&this.highlightFeaturesPermanently(this.state.layers[0]),this.changeLayerResult(i)},J.addRemoveFeaturesToLayerResult=J.updateLayerResultFeatures,J._changeLayerResult=function(e){var t=this.state.layersactions[e.id];t.forEach(function(t){return t.change&&t.change(e)}),this.resetCurrentActionToolsLayer(e)},J.checkIfLayerHasNoFeatures=function(e){var t=this;0===e.features.length&&setTimeout(function(){t.state.layers=t.state.layers.filter(function(t){return t.id!==e.id}),t.clearHighlightGeometry(e),t.removeAddFeaturesLayerResultInteraction({toggle:!0})})},J.getBoxId=function(e,t,r){return null!==r&&void 0!==r?e.id+"_"+t.id+"_"+r:e.id+"_"+t.id},J.setActionsForLayers=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{add:!1},n=r.add;n||(this.unlistenerlayeractionevents=[],e.forEach(function(e){t.state.layeractiontool[e.id]=Vue.observable({component:null,config:null});var r={},n={};e.features.forEach(function(e,t){r[t]=null,n[t]=null}),t.state.currentactiontools[e.id]=Vue.observable(r),t.state.currentactionfeaturelayer[e.id]=Vue.observable(n);var i=e.external||!!e.source&&"wms"===e.source.type;if(t.state.layersactions[e.id]||(t.state.layersactions[e.id]=[]),e.hasgeometry&&t.state.layersactions[e.id].push({id:"gotogeometry",download:!1,mouseover:!0,"class":d["default"].getFontClass("marker"),hint:"sdk.mapcontrols.query.actions.zoom_to_feature.hint",cbk:P(t.goToGeometry.bind(t))}),t._relations){var a=t._relations[e.id]&&t._relations[e.id].filter(function(e){return"MANY"===e.type});if(a&&a.length){var o=[];a.forEach(function(e){var r=t.plotLayerIds.find(function(t){return t===e.referencingLayer});r&&o.push(r)}),t.state.layersactions[e.id].push({id:"show-query-relations",download:!1,"class":d["default"].getFontClass("relation"),hint:"sdk.mapcontrols.query.actions.relations.hint",cbk:t.showQueryRelations,relations:a,chartRelationIds:o});var s=t.createActionState({layer:e});o.length&&t.state.layersactions[e.id].push({id:"show-plots-relations",download:!1,opened:!0,"class":d["default"].getFontClass("chart"),state:s,hint:"sdk.mapcontrols.query.actions.relations_charts.hint",cbk:P(t.showRelationsChart.bind(t,o))})}}t.getAtlasByLayerId(e.id).length&&t.state.layersactions[e.id].push({id:"printatlas",download:!0,"class":d["default"].getFontClass("print"),hint:"sdk.tooltips.atlas",cbk:t.printAtlas.bind(t)});var l=t.createActionState({layer:e});if(1===e.downloads.length){var c=u(e.downloads,1),f=c[0],p=t.downloadFeatures.bind(t,f);e[f]=Vue.observable({active:!1}),t.state.layersactions[e.id].push({id:"download_"+f+"_feature",download:!0,state:l,"class":d["default"].getFontClass("download"),hint:"sdk.tooltips.download_"+f,cbk:function(e,r,n,i){n.state.toggled[i]=!n.state.toggled[i],n.state.toggled[i]?p(e,r,n,i):t.setCurrentActionLayerFeatureTool({index:i,action:n,layer:e})}})}else if(e.downloads.length>1){var h=w["default"].name,v=[];e.downloads.forEach(function(e){v.push({id:"download_"+e+"_feature",download:!0,format:e,"class":d["default"].getFontClass(e),hint:"sdk.tooltips.download_"+e,cbk:function(r,n,i,a){t.downloadFeatures(e,r,n,i,a);var o=t.state.layersactions[r.id].find(function(e){return"downloads"===e.id});"polygon"!==t.state.query.type&&o.cbk(r,n,o,a)}})}),t.state.actiontools[h]=t.state.actiontools[h]||{},t.state.actiontools[h][e.id]={downloads:v},t.state.layersactions[e.id].push({id:"downloads",download:!0,"class":d["default"].getFontClass("download"),state:l,toggleable:!0,hint:"Downloads",change:function(e){var t=this,r=e.features;r.forEach(function(e,r){void 0===t.state.toggled[r]?X.$set(t.state.toggled,r,!1):t.state.toggled[r]=!1})},cbk:function(e,r,n,i){n.state.toggled[i]=!n.state.toggled[i],t.setCurrentActionLayerFeatureTool({layer:e,index:i,action:n,component:n.state.toggled[i]?w["default"]:null})}})}if(!i&&t.state.layersactions[e.id].push({id:"removefeaturefromresult",download:!1,mouseover:!0,"class":d["default"].getFontClass("minus-square"),style:{color:"red"},hint:"sdk.mapcontrols.query.actions.remove_feature_from_results.hint",cbk:t.removeFeatureLayerFromResult.bind(t)}),void 0!==e.selection.active){var g=t.createActionState({layer:e});t.state.layersactions[e.id].push({id:"selection",download:!1,"class":d["default"].getFontClass("success"),hint:"sdk.mapcontrols.query.actions.add_selection.hint",state:g,init:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.feature,i=r.index,a=r.action;"undefined"!=typeof e.selection.active&&t.checkFeatureSelection({layer:e,index:i,feature:n,action:a})},cbk:P(t.addToSelection.bind(t))}),t.listenClearSelection(e,"selection")}!i&&e.hasgeometry&&t.state.layersactions[e.id].push({id:"link_zoom_to_fid",download:!1,"class":d["default"].getFontClass("link"),hint:"sdk.mapcontrols.query.actions.copy_zoom_to_fid_url.hint",hint_change:{hint:"sdk.mapcontrols.query.actions.copy_zoom_to_fid_url.hint_change",duration:1e3},cbk:t.copyZoomToFidUrl.bind(t)}),e.editable&&!e.inediting&&t.state.layersactions[e.id].push({id:"editing","class":d["default"].getFontClass("pencil"),hint:"Editing",cbk:function(e,r){t.editFeature({layer:e,feature:r})}})}),this.addActionsForLayers(this.state.layersactions,this.state.layers))},J.createActionState=function(e){var t=e.layer,r=e.dynamicProperties,n=void 0===r?["toggled"]:r,i=n.reduce(function(e,t){return e[t]={},e},{});return t.features.map(function(e,t){Object.keys(i).forEach(function(e){i[e][t]=null})}),Vue.observable(i)},J.getActionLayerById=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,r=e.id;return this.state.layersactions[t.id].find(function(e){return e.id===r})},J.setCurrentActionLayerFeatureTool=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,r=e.action,n=e.index,i=e.component,a=void 0===i?null:i;a?(this.state.currentactiontools[t.id][n]&&r.id!==this.state.currentactionfeaturelayer[t.id][n].id&&this.state.currentactionfeaturelayer[t.id][n].toggleable&&(this.state.currentactionfeaturelayer[t.id][n].state.toggled[n]=!1),this.state.currentactionfeaturelayer[t.id][n]=r):this.state.currentactionfeaturelayer[t.id][n]=null,this.state.currentactiontools[t.id][n]=a},J.addCurrentActionToolsLayer=function(e){var t=e.id,r=e.layer,n=e.config,i=void 0===n?{}:n;this.state.actiontools[t]={},this.state.actiontools[t][r.id]=i},J.resetCurrentActionToolsLayer=function(e){var t=this;e.features.forEach(function(r,n){t.state.currentactiontools[e.id]&&(void 0===t.state.currentactiontools[e.id][n]?Vue.set(t.state.currentactiontools[e.id],n,null):t.state.currentactiontools[e.id][n]=null,t.state.currentactionfeaturelayer[e.id][n]=null)})},J.setLayerActionTool=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,r=e.component,n=void 0===r?null:r,i=e.config,a=void 0===i?null:i;this.state.layeractiontool[t.id].component=n,this.state.layeractiontool[t.id].config=a},J.copyZoomToFidUrl=function(e,t,r){var n=t.attributes[f.G3W_FID],i=new URL(location.href),a=e.id+"|"+n;i.searchParams.set("zoom_to_fid",a),O(i.toString()),r.hint_changed=!0},J.clear=function(){this.runAsyncTodo(),this.unlistenerEventsActions(),this.mapService.clearHighlightGeometry(),this.resultsQueryLayer.getSource().clear(),this.removeAddFeaturesLayerResultInteraction({toggle:!0}),this._asyncFnc=null,this._asyncFnc={todo:T,zoomToLayerFeaturesExtent:{async:!1},goToGeometry:{async:!1}},this.clearState(),this.closeComponent(),this.removeQueryResultLayerFromMap()},J.getCurrentLayersIds=function(){return this._currentLayerIds},J.runAsyncTodo=function(){this._asyncFnc.todo()},J._orderResponseByProjectLayers=function(e){var t=this;e.sort(function(e,r){var n=t._projectLayerIds.indexOf(e.id),i=t._projectLayerIds.indexOf(r.id);return n>i?1:-1})},J.setZoomToResults=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.state.zoomToResult=e},J.highlightFeaturesPermanently=function(e){var t=e.features;this.mapService.highlightFeatures(t,{duration:1/0})},J.isOneLayerResult=function(){return 1===this.state.layers.length},J.removeAddFeaturesLayerResultInteraction=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.toggle,r=void 0!==t&&t;this._addFeaturesLayerResultInteraction.interaction&&this.mapService.removeInteraction(this._addFeaturesLayerResultInteraction.interaction),this._addFeaturesLayerResultInteraction.interaction=null,this._addFeaturesLayerResultInteraction.id=null,r&&this._addFeaturesLayerResultInteraction.mapcontrol&&this._addFeaturesLayerResultInteraction.mapcontrol.toggle(!0),this._addFeaturesLayerResultInteraction.mapcontrol=null,this._addFeaturesLayerResultInteraction.toggleeventhandler&&this.mapService.off("mapcontrol:toggled",this._addFeaturesLayerResultInteraction.toggleeventhandler),this._addFeaturesLayerResultInteraction.toggleeventhandler=null},J.addLayerFeaturesToResultsAction=function(e){var t=this;if(null!==this._addFeaturesLayerResultInteraction.id&&this._addFeaturesLayerResultInteraction.id!==e.id){var r=this.state.layers.find(function(e){return e.id===t._addFeaturesLayerResultInteraction.id});r&&(r.addfeaturesresults.active=!1),this._addFeaturesLayerResultInteraction.interaction&&this.mapService.removeInteraction(this._addFeaturesLayerResultInteraction.interaction)}if(this._addFeaturesLayerResultInteraction.id=e.id,e.addfeaturesresults.active=!e.addfeaturesresults.active,e.addfeaturesresults.active){this.activeMapInteraction();var n=e.external;this._addFeaturesLayerResultInteraction.mapcontrol||(this._addFeaturesLayerResultInteraction.mapcontrol=this.mapService.getCurrentToggledMapControl()),this._addFeaturesLayerResultInteraction.interaction=new Q,this.mapService.addInteraction(this._addFeaturesLayerResultInteraction.interaction,{close:!1}),this._addFeaturesLayerResultInteraction.interaction.on("picked",function(){var r=o(regeneratorRuntime.mark(function i(r){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(a=r.coordinate,n){i.next=6;break}return i.next=4,g["default"].getData("query:coordinates",{inputs:{coordinates:a,query_point_tolerance:t._project.getQueryPointTolerance(),layerIds:[e.id],multilayers:!1},outputs:{show:{add:!0}}});case 4:i.next=9;break;case 6:o=t._vectorLayers.find(function(t){return e.id===t.get("id")}),s=t.getVectorLayerFeaturesFromQueryRequest(o,{coordinates:a}),t.setQueryResponse({data:[s],query:{coordinates:a}},{add:!0});case 9:case"end":return i.stop()}},i,t)}));return function(e){return r.apply(this,arguments)}}());var i=function(t){t.target.isToggled()&&t.target.isClickMap()&&(e.addfeaturesresults.active=!1)};this._addFeaturesLayerResultInteraction.toggleeventhandler=i,this.mapService.once("mapcontrol:toggled",i)}else this.removeAddFeaturesLayerResultInteraction({toggle:!0})},J.deactiveQueryInteractions=function(){this.state.layers.forEach(function(e){e.addfeaturesresults&&(e.addfeaturesresults.active=!1)}),this.removeAddFeaturesLayerResultInteraction()},J.zoomToLayerFeaturesExtent=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.features;t.highlight=!this.isOneLayerResult(),this._asyncFnc.zoomToLayerFeaturesExtent.async?this._asyncFnc.todo=this.mapService.zoomToFeatures.bind(this.mapService,r,t):this.mapService.zoomToFeatures(r,t)},J.clearState=function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state.layers.splice(0),this.state.query=null,this.state.querytitle="",this.state.changed=!1,Object.values(this.state.layersactions).forEach(function(e){return e.forEach(function(e){return e.clear&&e.clear()})}),this.state.layersactions={},this.state.actiontools={},this.state.layeractiontool={},this.state.currentactiontools={},this.state.layersFeaturesBoxes={},this.removeAddFeaturesLayerResultInteraction()},J.getState=function(){return this.state},J.setState=function(e){this.state=e},J._setRelations=function(e){var t=e.getRelations();this._relations=t?_.groupBy(t,"referencedLayer"):[]},J.getAtlasByLayerId=function(e){return this._atlas.filter(function(t){return t.atlas.qgs_layer_id===e})},J._setAtlasActions=function(e){this._atlas=e.getPrint().filter(function(e){return e.atlas})||[]},J.setTitle=function(e){this.state.querytitle=e||""},J.reset=function(){this.clearState()},J._digestFeaturesForLayers=function(e){var t=this,r=0;e=e||[];var n=[],a=void 0,o=void 0,s=void 0,u=void 0,c=function(e){var c,d=void 0,f=void 0,p=void 0,h=!1,v=!1,g=!1,m=!1,y=e.layer,_=[],b=[],x=void 0,S={},L={};if(y instanceof W){g=y.isEditable(),m=y.isInEditing(),p=y.getSource(),b=y.getInfoFormats(),x=y.getInfoFormat(),[W.SourceTypes.WMS,W.SourceTypes.WCS,W.SourceTypes.WMST].indexOf(y.getSourceType())===-1&&(S=y.state.filter,L=y.state.selection,h=!0),_=y.getDownloadableFormats();try{f=y.getSourceType()}catch(C){}if(a="ows"===t.state.type?y.getAttributes().map(function(e){var t=l({},e);return t.name=t.name.replace(/ /g,"_"),t}):y.getAttributes(),o=[],s=y.getTitle(),u=y.getId(),y.hasFormStructure()){var k=y.getLayerEditingFormStructure();if(t._relations&&t._relations.length){var E=function G(e){if(e.nodes){var t=!0,r=!1,n=void 0;try{for(var i,a=e.nodes[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;G(o)}}catch(s){r=!0,n=s}finally{try{!t&&a["return"]&&a["return"]()}finally{if(r)throw n}}}else e.name?e.relation=!0:null},M=!0,T=!1,I=void 0;try{for(var P,F=k[Symbol.iterator]();!(M=(P=F.next()).done);M=!0){var O=P.value;E(O)}}catch(C){T=!0,I=C}finally{try{!M&&F["return"]&&F["return"]()}finally{if(T)throw I}}}var R=y.getFields().filter(function(e){return e.show});d={structure:k,fields:R}}}else if(y instanceof ol.layer.Vector)L=y.selection,a=y.getProperties(),o=[],s=y.get("name"),u=y.get("id"),v=!0;else if("string"==typeof y||y instanceof String){f=W.LayerTypes.VECTOR;var A=e.features[0];a=A?A.getProperties():[],o=[];var j=y.split("_");s=j.length>4?j.slice(0,j.length-4).join(" "):y,u=y,v=!0}var N=(c={title:s,id:u,infoformat:x,infoformats:b,attributes:[],features:[],hasgeometry:!1,atlas:t.getAtlasByLayerId(u),source:p,downloads:_,show:!0,filter:S,addfeaturesresults:{active:!1}},i(c,w["default"].name,{active:!1}),i(c,"external",v),i(c,"editable",g),i(c,"inediting",m),i(c,"selection",L),i(c,"expandable",!0),i(c,"hasImageField",!1),i(c,"relationsattributes",o),i(c,"formStructure",d),i(c,"error",""),i(c,"rawdata",null),i(c,"loading",!1),c);if(e.rawdata)N.rawdata=e.rawdata,n.push(N);else if(e.features&&e.features.length){var D=y instanceof W?a.filter(function(e){try{return"_"===e.name[0]||Number.isInteger(1*e.name[0])}catch(t){return!1}}).map(function(e){return{alias:e.name.replace(/_/,""),name:e.name}}):[];D.length&&e.features.forEach(function(e){return t._setSpecialAttributesFeatureProperty(D,e)}),N.attributes=t._parseAttributes(a,e.features[0],f),N.attributes.forEach(function(e){if(d){var t=y.getFields().find(function(t){return t.name===e.name});!t&&d.fields.push(e)}"image"===e.type&&(N.hasImageField=!0)}),e.features.forEach(function(e){var n=t.getFeaturePropertiesAndGeometry(e),i=n.id,a=n.geometry,o=n.properties,s=n.selection;a&&(N.hasgeometry=!0);var l={id:N.external?e.getId():i,attributes:o,geometry:a,selection:s,show:!0};N.features.push(l),r+=1}),n.push(N)}else e.error&&(N.error=e.error)};return e.forEach(function(e){Array.isArray(e)?e.forEach(function(e){return c(e)}):c(e)}),n},J._setSpecialAttributesFeatureProperty=function(e,t){var r=t.getProperties(),n=Object.keys(r);e.length&&e.forEach(function(e){n.find(function(r){if(r===e.alias)return t.set(e.name,t.get(r)),!0})})},J.getFeaturePropertiesAndGeometry=function(e){if(e instanceof ol.Feature)return{selection:e.selection,properties:e.getProperties(),geometry:e.getGeometry(),id:e.getId()};var t=e.selection,r=e.properties,n=e.geometry,i=e.id;return{selection:t,properties:r,geometry:n,id:i}},J._parseAttributes=function(e,t,r){var n=this.getFeaturePropertiesAndGeometry(t),i=n.properties,a=Object.keys(i);if(a=G(a),e&&e.length){var o=e.filter(function(e){return a.indexOf(e.name)>-1});return o}var s=W.SourceTypes,l=s.GDAL,u=s.WMS,c=s.WCS,d=s.WMST,p=[l,u,c,d];return a.map(function(e){return{name:e,label:e,show:e!==f.G3W_FID&&(void 0===r||p.indexOf(r)!==-1),type:"varchar"}})},J.trigger=function(){var e=o(regeneratorRuntime.mark(function t(e,r,n,i,a){var o,s,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o=this._actions[e],o&&o(r,n,i),!r){t.next=10;break}if(s=this.state.layersactions[r.id],!s){t.next=10;break}if(l=s.find(function(t){return t.id===e}),t.t0=l,!t.t0){t.next=10;break}return t.next=10,this.triggerLayerAction(l,r,n,i,a);case 10:case"end":return t.stop()}},t,this)}));return function(t,r,n,i,a){return e.apply(this,arguments)}}(),J.triggerLayerAction=function(){var e=o(regeneratorRuntime.mark(function t(e,r,n,i,a){var o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.cbk,!t.t0){t.next=4;break}return t.next=4,e.cbk(r,n,e,i,a);case 4:e.route&&(o=void 0,s=e.route,o=s.replace(/{(\w*)}/g,function(e,t){return n.attributes.hasOwnProperty(t)?n.attributes[t]:""}),o&&""!==o&&d["default"]["goto"](o));case 5:case"end":return t.stop()}},t,this)}));return function(t,r,n,i,a){return e.apply(this,arguments)}}(),J.registerVectorLayer=function(e){this._vectorLayers.indexOf(e)===-1&&this._vectorLayers.push(e)},J.unregisterVectorLayer=function(e){var t=this;this._vectorLayers=this._vectorLayers.filter(function(r){return t.state.layers=t.state.layers&&t.state.layers.filter(function(t){return t.id!==e.get("id")}),r!==e})},J.getVectorLayerFeaturesFromQueryRequest=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.coordinates,n=t.bbox,i=t.geometry,a=t.filterConfig,o=void 0===a?{}:a,s=[];if(r&&Array.isArray(r)){var l=this.mapService.viewer.map.getPixelFromCoordinate(r);this.mapService.viewer.map.forEachFeatureAtPixel(l,function(e,t){s.push(e)},{layerFilter:function(t){return t===e}})}else if(n&&Array.isArray(n)&&(i=ol.geom.Polygon.fromExtent(n)),i instanceof ol.geom.Polygon||i instanceof ol.geom.MultiPolygon)switch(e.constructor){case K:s=e.getIntersectedFeatures(i);break;case ol.layer.Vector:e.getSource().getFeatures().forEach(function(e){var t=void 0;switch(o.spatialMethod){case"intersects":t=j(i,e.getGeometry());break;case"within":t=N(i,e.getGeometry());break;default:t=i.intersectsExtent(e.getGeometry().getExtent())}!0===t&&s.push(e)})}return{features:s,layer:e}},J._addVectorLayersDataToQueryResponse=function(e){var t=this,r=d["default"].getService("catalog"),n=e.query.external.filter.SELECTED;this._vectorLayers.forEach(function(i){var a=r.isExternalLayerSelected({id:i.get("id"),type:"vector"});i.getVisible()&&(!0===a&&!0===n||!1===a&&!1===n||"undefined"==typeof n)&&e.data.push(t.getVectorLayerFeaturesFromQueryRequest(i,e.query))})},J._addComponent=function(e){this.state.components.push(e)},J._printSingleAtlas=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.atlas,r=void 0===t?{}:t,n=e.features,i=void 0===n?[]:n,a=r.name,o=r.atlas.field_name,s=void 0===o?"":o;s=s||"$id";var l=i.map(function(e){return e.attributes["$id"===s?f.G3W_FID:s]}),u=C["default"].setDownload(!0);return this.printService.printAtlas({field:s,values:l,template:a,download:!0}).then(function(e){var t=e.url;I({url:t,filename:a,mime_type:"application/pdf"})["catch"](function(e){d["default"].showUserMessage({type:"alert",error:e})})["finally"](function(){C["default"].setDownload(!1,u),d["default"].setLoadingContent(!1)})})},J.showChart=function(e,t,r){this.emit("show-chart",e,t,r)},J.hideChart=function(e){this.emit("hide-chart",e)},J.showRelationsChart=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],r=arguments[2],n=arguments[3],i=arguments[4],a=arguments[5];if(n.state.toggled[i]=!n.state.toggled[i],n.state.toggled[i]){var o=this._relations[t.id],s={relations:o,fid:r.attributes[f.G3W_FID],height:400};this.emit("show-chart",e,a,s)}else this.hideChart(a)},J.printAtlas=function(e,t){var r=this,n=t?[t]:e.features,i=this.getAtlasByLayerId(e.id);if(i.length<=1)return void this._printSingleAtlas({features:n,atlas:i[0]});var a="g3w_atlas_index",o="";i.forEach(function(e,t){var r=F();o+='<input id="'+r+'" '+a+'="'+t+'" class="magic-radio" type="radio" name="template" value="'+e.name+'"/>',o+='<label for="'+r+'">'+e.name+"</label>",o+="<br>"}),d["default"].showModalDialog({title:z("sdk.atlas.template_dialog.title"),message:o,buttons:{success:{label:"OK",className:"skin-button",callback:function(){var e=$('input[name="template"]:checked').attr(a);return void 0!==e&&void r._printSingleAtlas({features:n,atlas:i[e]})}}}})},J.showLayerDownloadFormats=function(e){var t=w["default"].name;e[t].active=!e[t].active,this.setLayerActionTool({layer:e,component:e[t].active?w["default"]:null,config:e[t].active?this.state.actiontools[t][e.id]:null})},J.downloadFeatures=function(){var e=o(regeneratorRuntime.mark(function t(e,r){var n,i,a,s,l,u,c,p,h,v=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],g=this,m=arguments[3],_=arguments[4];return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=r.id,i=this.state.query,
a=void 0===i?{}:i,v=v?Array.isArray(v)?v:[v]:v,s={fids:v.map(function(e){return e.attributes[f.G3W_FID]}).join(",")},l=function(){var t=o(regeneratorRuntime.mark(function n(){var t,i,a,o=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return v.length>1&&(r[w["default"].name].active=o,g.setLayerActionTool({layer:r})),t=y["default"].getLayerById(r.id),i=C["default"].setDownload(!0),d["default"].setLoadingContent(!0),n.prev=4,n.next=7,t.getDownloadFilefromDownloadDataType(e,{data:s});case 7:if(n.t0=n.sent,n.t0){n.next=10;break}Promise.resolve();case 10:n.next=15;break;case 12:n.prev=12,n.t1=n["catch"](4),d["default"].notify.error(n.t1||z("info.server_error"));case 15:C["default"].setDownload(!1,i),d["default"].setLoadingContent(!1),a=g.state.layersactions[r.id].find(function(e){return"downloads"===e.id}),v.length>1?void 0===a?(r[e].active=!1,g.setLayerActionTool({layer:r})):r[w["default"].name].active=!1:(void 0===a?m.state.toggled[_]=!1:a.state.toggled[_]=!1,g.setCurrentActionLayerFeatureTool({index:_,action:m,layer:r}));case 19:case"end":return n.stop()}},n,g,[[4,12]])}));return function(){return t.apply(this,arguments)}}(),"polygon"===a.type?(u=this.state.layersactions[r.id].find(function(e){return"downloads"===e.id}),c=a.fid,p=a.layer,h={choices:[{id:F(),type:"feature",label:"sdk.mapcontrols.querybypolygon.download.choiches.feature.label"},{id:F(),type:"polygon",label:"sdk.mapcontrols.querybypolygon.download.choiches.feature_polygon.label"}],download:function(e){"polygon"===e?(s.sbp_qgs_layer_id=p.getId(),s.sbp_fid=c):(delete s.sbp_fid,delete s.sbp_qgs_layer_id),l(!0)}},1===v.length?(void 0===u&&(m.state.toggled[_]=!0),this.state.actiontools[S["default"].name]=this.state.actiontools[n]||{},this.state.actiontools[S["default"].name][n]=h,this.setCurrentActionLayerFeatureTool({layer:r,index:_,action:m,component:S["default"]})):void 0===u?(r[e].active=!r[e].active,r[e].active?this.setLayerActionTool({layer:r,component:S["default"],config:h}):this.setLayerActionTool({layer:r})):this.setLayerActionTool({layer:r,component:S["default"],config:h})):l();case 6:case"end":return t.stop()}},t,this)}));return function(t,r){return e.apply(this,arguments)}}(),J.downloadGpx=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.id,n=arguments[1],i=n?n.attributes[f.G3W_FID]:null,a=y["default"].getLayerById(r);a.getGpx({fid:i})["catch"](function(e){d["default"].notify.error(z("info.server_error"))})["finally"](function(){e.layerMenu.loading.shp=!1,e._hideMenu()})},J.downloadXls=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.id,n=arguments[1],i=n?n.attributes[f.G3W_FID]:null,a=y["default"].getLayerById(r);a.getXls({fid:i})["catch"](function(e){d["default"].notify.error(z("info.server_error"))})["finally"](function(){e.layerMenu.loading.shp=!1,e._hideMenu()})},J.listenClearSelection=function(e,t){var r=this;if(e.external)e.features.forEach(function(t){var r=e.selection.features.find(function(e){return t.id===e.getId()});t.selection=r?r.selection:{selected:!1}});else{var n=y["default"].getLayerById(e.id),i=function(){var n=r.state.layersactions[e.id].find(function(e){return e.id===t});e.features.forEach(function(e,t){return n.state.toggled[t]=!1})};n.on("unselectionall",i),this.unlistenerlayeractionevents.push({layer:n,event:"unselectionall",handler:i})}},J.clearSelectionExtenalLayer=function(e){var t=this;e.selection.active=!1;var r=this.state.layersactions[e.id]&&this.state.layersactions[e.id].find(function(e){return"selection"===e.id});e.selection.features.forEach(function(e,n){e.selection.selected&&(e.selection.selected=!1,r&&(r.state.toggled[n]=!1),t.mapService.setSelectionFeatures("remove",{feature:e}))})},J.unlistenerEventsActions=function(){this.unlistenerlayeractionevents.forEach(function(e){return e.layer.off(e.event,e.handler)}),this.unlistenerlayeractionevents=[]},J.addRemoveFilter=function(e){var t=y["default"].getLayerById(e.id);t.toggleFilterToken()},J.selectionFeaturesLayer=function(e){var t=this,r=e.id,n=this.state.layersactions[r].find(function(e){return"selection"===e.id}),i=Object.values(n.state.toggled).reduce(function(e,t){return e&&t},!0),a=e.external?e:y["default"].getLayerById(r);e.features.forEach(function(e,r){n.state.toggled[r]=!i,t._addRemoveSelectionFeature(a,e,r,i?"remove":"add")})},J._addRemoveSelectionFeature=function(){var e=o(regeneratorRuntime.mark(function t(e,r,n,i){var a,o,s,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("undefined"==typeof e.external||!e.external){t.next=12;break}if("undefined"==typeof e.selection.features&&(e.selection.features={}),e.selection.features.find(function(e){return e.getId()===r.id})||(a=A({feature:r,id:r.id}),a.__layerId=e.id,a.selection=r.selection,e.selection.features.push(a)),!("add"===i&&r.selection.selected||"remove"===i&&!r.selection.selected)){t.next=7;break}return t.abrupt("return");case 7:r.selection.selected=!r.selection.selected;case 8:this.mapService.setSelectionFeatures(r.selection.selected?"add":"remove",{feature:e.selection.features.find(function(e){return r.id===e.getId()})}),e.selection.active=e.selection.features.reduce(function(e,t){return e||t.selection.selected},!1),t.next=28;break;case 12:if(o=r?r.attributes[f.G3W_FID]:null,s=e.getFilterActive()||e.hasSelectionFid(o),s||r&&r.geometry&&!e.getOlSelectionFeature(o)&&e.addOlSelectionFeature({id:o,feature:r}),void 0!==i){t.next=19;break}e[s?"excludeSelectionFid":"includeSelectionFid"](o),t.next=27;break;case 19:if(s||"add"!==i){t.next=24;break}return t.next=22,e.includeSelectionFid(o);case 22:t.next=27;break;case 24:if(!s||"remove"!==i){t.next=27;break}return t.next=27,e.excludeSelectionFid(o);case 27:e.getFilterActive()&&(l=this.state.layers.find(function(t){return t.id===e.getId()}),e.getSelectionFids().size>0&&l&&l.features.splice(n,1),this.mapService.clearHighlightGeometry(),1===this.state.layers.length&&!this.state.layers[0].features.length&&this.state.layers.splice(0));case 28:case"end":return t.stop()}},t,this)}));return function(t,r,n,i){return e.apply(this,arguments)}}(),J.checkFeatureSelection=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,r=e.feature,n=e.index,i=e.action;if(t.external)i.state.toggled[n]=r.selection.selected;else{var a=y["default"].getLayerById(t.id);if(r){var o=r?r.attributes[f.G3W_FID]:null;i.state.toggled[n]=a.getFilterActive()||a.hasSelectionFid(o)}}},J.addToSelection=function(e,t,r,n){var i=e.external,a=void 0!==i&&i;r.state.toggled[n]=!r.state.toggled[n];var o=a?e:y["default"].getLayerById(e.id);this._addRemoveSelectionFeature(o,t,n)},J.removeQueryResultLayerFromMap=function(){this.resultsQueryLayer.getSource().clear(),this.mapService.getMap().removeLayer(this.resultsQueryLayer)},J.addQueryResultsLayerToMap=function(e){var t=e.feature;this.removeQueryResultLayerFromMap(),this.resultsQueryLayer.getSource().addFeature(t),this.mapService.getMap().addLayer(this.resultsQueryLayer),this.mapService.setZIndexLayer({layer:this.resultsQueryLayer})},J.showCoordinates=function(e){var t=q(e);this.addQueryResultsLayerToMap({feature:t})},J.showBBOX=function(e){var t=U(e);this.addQueryResultsLayerToMap({feature:t})},J.showGeometry=function(e){var t=V({geometry:e});this.addQueryResultsLayerToMap({feature:t})},J.goToGeometry=function(e,t){var r=this;if(t.geometry){var n={mapServiceMethod:this.isOneLayerResult()?"zoomToFeatures":"highlightGeometry",firstParam:this.isOneLayerResult()?[t]:t.geometry,options:this.isOneLayerResult()?{}:{layerId:e.id,duration:1500}};this._asyncFnc.goToGeometry.async?this._asyncFnc.todo=this.mapService[n.mapServiceMethod].bind(this.mapService,n.firstParam,n.options):setTimeout(function(){return r.mapService[n.mapServiceMethod](n.firstParam,n.options)})}},J.saveLayerResult=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,r=e.type,n=void 0===r?"csv":r;this.downloadFeatures(n,t,t.features)},J.highlightGeometry=function(e,t){t.geometry&&this.mapService.highlightGeometry(t.geometry,{layerId:e.id,zoom:!1,duration:1/0})},J.clearHighlightGeometry=function(e){this.mapService.clearHighlightGeometry(),this.isOneLayerResult()&&this.highlightFeaturesPermanently(e)},J.showRelation=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.relation,r=e.layerId,n=e.feature,i=t.name,a=t.nmRelationId,o=[],s=this._project.getRelationById(i),l=this._project.getRelationById(a);this.findPlotId(s.referencingLayer)&&o.push(s.referencingLayer),d["default"].pushContent({content:new Y({currentview:"relation",relations:[s],chartRelationIds:o,nmRelation:l,feature:n,layer:{id:r}}),crumb:{title:s.name},title:s.name,closable:!1})},J.showQueryRelations=function(e,t,r){d["default"].changeCurrentContentOptions({crumb:{title:e.title}}),d["default"].pushContent({content:new Y({relations:r.relations,chartRelationIds:r.chartRelationIds,feature:t,layer:e}),backonclose:!0,title:f.LIST_OF_RELATIONS_TITLE,id:f.LIST_OF_RELATIONS_ID,crumb:{title:f.LIST_OF_RELATIONS_TITLE,trigger:null},closable:!1})},t.exports=s},{"components/QueryResultsActionDownloadFormats.vue":280,"components/QueryResultsActionQueryPolygonCSVAttributes.vue":282,constant:4,"core/g3wobject":12,"core/i18n/i18n.service":13,"core/layers/layer":34,"core/layers/vectorlayer":57,"core/print/printservice":60,"core/utils/geo":64,"core/utils/utils":68,"g3w-ol/interactions/pickcoordinatesinteraction":105,"gui/relations/vue/relationspage":175,"services/application":351,"services/data":358,"services/gui":361,"store/catalog-layers":374,"store/projects":379}],172:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u(this,t),this.id="queryresults",this.title="Query Results",this._service=new f,this.setInternalComponent=function(){this.internalComponent=new p({queryResultsService:this._service}),this.internalComponent.querytitle=this._service.state.querytitle},this.getElement=function(){if(this.internalComponent)return this.internalComponent.$el},this._service.onafter("setLayersData",i(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return!e.internalComponent&&e.setInternalComponent(),t.next=3,e.internalComponent.$nextTick();case 3:case"end":return t.stop()}},r,e)}))),this.layout=function(e,t){},this.unmount=function(){return this.getService().closeComponent(),u(this,"unmount")}}var o=e("components/QueryResults.vue"),s=n(o),l=e("core/utils/utils"),u=l.base,c=l.inherit,d=e("gui/component/component"),f=e("gui/queryresults/queryresultsservice"),p=Vue.extend(s);c(a,d),t.exports=a},{"components/QueryResults.vue":278,"core/utils/utils":68,"gui/component/component":117,"gui/queryresults/queryresultsservice":171}],173:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state={},this._options={},v(this)}var o=e("app/constant"),s=e("services/relations"),l=n(s),u=e("services/application"),c=n(u),d=e("services/gui"),f=n(d),p=e("core/utils/utils"),h=p.inherit,v=p.base,g=e("core/g3wobject");h(a,g);var m=a.prototype;m.getRelations=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._options=e,l["default"].getRelations(e)},m.getRelationsNM=function(){var e=i(regeneratorRuntime.mark(function t(e){var r=e.nmRelation,n=e.features;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l["default"].getRelationsNM({nmRelation:r,features:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),m.saveRelations=function(){var e=i(regeneratorRuntime.mark(function t(e){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this._options.type=e,r=c["default"].setDownload(!0),t.prev=2,t.next=5,l["default"].save(this._options);case 5:t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](2),f["default"].showUserMessage({type:"alert",message:t.t0||"info.server_error",closable:!0});case 10:c["default"].setDownload(!1,r);case 11:case"end":return t.stop()}},t,this,[[2,7]])}));return function(t){return e.apply(this,arguments)}}(),m.buildRelationTable=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],r=c["default"].getCurrentProject().getLayerById(t),n=r.getTableHeaders(),i=null,a=[],s=[],l=void 0;if(e.length){var u=Object.keys(e[0].attributes);i=n.filter(function(e){return u.indexOf(e.name)!==-1}),a=e.map(function(e){return s.push(e.attributes[o.G3W_FID]),i.map(function(t){return e.attributes[t.name]})}),l=i,i=i.map(function(e){return e.label})}return{columns:i,rows:a,rows_fid:s,features:e,fields:l,formStructure:r.getLayerEditingFormStructure(),rowFormStructure:null,layerId:r.getId()}},t.exports=a},{"app/constant":4,"core/g3wobject":12,"core/utils/utils":68,"services/application":351,"services/gui":361,"services/relations":367}],174:[function(e,t,r){t.exports=new Vue},{}],175:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/RelationsPage.vue"),a=n(i),o=e("core/utils/utils"),s=o.base,l=o.inherit,u=e("gui/component/component"),c=e("gui/relations/relationsservice"),d=Vue.extend(a),f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s(this,e);var t=e.service||new c,r=e.layer,n=e.relation,i=void 0===n?null:n,a=e.relations,o=void 0===a?[]:a,l=e.feature,u=void 0===l?null:l,f=e.table,p=void 0===f?null:f,h=e.chartRelationIds,v=void 0===h?[]:h,g=e.nmRelation,m=e.currentview,y=void 0===m?"relations":m;this.setService(t);var _=new d({previousview:y,service:t,relations:o,relation:i,nmRelation:g,chartRelationIds:v,feature:u,currentview:y,layer:r,table:p});this.setInternalComponent(_),_.state=t.state,this.layout=function(){_.reloadLayout()}};l(f,u),t.exports=f},{"components/RelationsPage.vue":288,"core/utils/utils":68,"gui/component/component":117,"gui/relations/relationsservice":173}],176:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){c(this);var e=l["default"].getCurrentProject().state;this.title=e.search_title||"search",this.init=function(t){this.state.searches=t||e.search},this.state={searches:[],searchtools:[],querybuildersearches:o["default"].getCurrentProjectItems()}}var a=e("services/querybuilder"),o=n(a),s=e("store/projects"),l=n(s),u=e("core/utils/utils"),c=u.base,d=u.inherit,f=e("core/g3wobject"),p=e("gui/search/vue/panel/searchpanel");d(i,f);var h=i.prototype;h.removeItem=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=e.index;switch(t){case"querybuilder":this.state.querybuildersearches.splice(r,1)}},h.getTitle=function(){return this.title},h.showPanel=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new p(e);return t.show(),t},h.cleanSearchPanels=function(){this.state.panels={}},h.stop=function(){var e=$.Deferred();return e.resolve(),e.promise()},h.addTool=function(e){this.state.searchtools.push(e)},h.addTools=function(e){var t=!0,r=!1,n=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;this.addTool(o)}}catch(s){r=!0,n=s}finally{try{!t&&a["return"]&&a["return"]()}finally{if(r)throw n}}},h.addQueryBuilderSearch=function(e){this.state.querybuildersearches.push(e)},h.removeTool=function(e){},h.removeTools=function(){this.state.searchtools.splice(0)},h.reload=function(){this.state.searches=l["default"].getCurrentProject().state.search,this.state.querybuildersearches=o["default"].getCurrentProjectItems()},t.exports=i},{"core/g3wobject":12,"core/utils/utils":68,"gui/search/vue/panel/searchpanel":177,"services/querybuilder":366,"store/projects":379}],177:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.service||new f(e);this.setService(t),this.id=c(),this.title="search";var r=e.component||p,n=new r({service:t});this.setInternalPanel(n),this.unmount=function(){return l(this,"unmount").then(function(){t.clear()})}}var a=e("components/SearchPanel.vue"),o=n(a),s=e("core/utils/utils"),l=s.base,u=s.inherit,c=s.uniqueId,d=e("gui/panel"),f=e("gui/search/vue/panel/searchservice"),p=Vue.extend(o);u(i,d),t.exports=i},{"components/SearchPanel.vue":291,"core/utils/utils":68,"gui/panel":162,"gui/search/vue/panel/searchservice":178}],178:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function o(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function s(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.debounces={run:{fnc:function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=e.mapService.getMap().getSize(),a=f(i,2),o=a[0],s=a[1];return!x["default"].isMobile()||0!==o&&0!==s?void e._run.apply(e,r):(x["default"].hideSidebar(),void setTimeout(function(){e._run.apply(e,r)},600))}}},L(this),this.state={title:null,forminputs:[],loading:{},searching:!1},this.config=t;var r=this.config.options,n=void 0===r?{}:r,i=n.querylayerid||n.layerid||null;this.inputdependance={},this.inputdependencies={},this.cachedependencies={},this.project=b["default"].getCurrentProject(),this.mapService=x["default"].getService("map"),this.searchLayer=null,this.filter=null,this.inputs=[],this.state.title=t.name,this.search_endpoint=t.search_endpoint,this.url=n.queryurl,this.filter=n.filter,this.type=this.config.type||"search",this["return"]=n["return"]||"data",this.show="data"===this["return"]&&"search"===this.type,this.searchLayer=g["default"].getLayerById(i),this.searchLayers=[i].concat(o(n.otherquerylayerids||[])).map(function(e){return g["default"].getLayerById(e)}),this.createInputsFormFromFilter({filter:n.filter||[]})}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=i({},e,[]);return t.forEach(function(t){for(var n in t)if(Array.isArray(t[n])){l(n,t[n]);break}r[e].push(i({},t.op,i({},t.attribute,null)))}),r}function u(t,r){if("search"===r)if(x["default"].closeContent(),t=t.data[0].data,I(t))y["default"].showCustomOutputDataPromise(Promise.resolve({}));else{var n=e("gui/search/vue/panel/searchpanel");new n(t).show()}return t}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},f=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),p=function(){var e=a(regeneratorRuntime.mark(function t(e,r){var n,i,a,o,s,l,u,c,d,f,p,h;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r.search_endpoint,i=r.feature_count,a=r.relation_id,o=r.output_title,s=e.data[0]||{},l=s.features,u=void 0===l?[]:l,c=b["default"].getCurrentProject(),u.length){t.next=6;break}return y["default"].showEmptyOutputs(),t.abrupt("return",[]);case 6:if(d=c.getRelationById(a),!d){t.next=15;break}return f=[],p=new Set,u.forEach(function(e){var t=e.getProperties()[d.fieldRef.referencingField];p.has(t)||(p.add(t),f.push({attribute:d.fieldRef.referencedField,logicop:"OR",operator:"eq",value:t}))}),h=c.getLayerById(d.referencedLayer),t.next=14,y["default"].getData("search:features",{inputs:{layer:h,search_endpoint:n,filter:M({layer:h,search_endpoint:n,inputs:f}),formatter:1,feature_count:i},outputs:{title:o}});case 14:e=t.sent;case 15:return t.abrupt("return",e);case 16:case"end":return t.stop()}},t,this)}));return function(t,r){return e.apply(this,arguments)}}(),h=e("app/constant"),v=e("store/catalog-layers"),g=n(v),m=e("services/data"),y=n(m),_=e("store/projects"),b=n(_),w=e("services/gui"),x=n(w),S=e("core/utils/utils"),L=S.base,C=S.inherit,k=S.toRawType,E=S.getUniqueDomId,M=S.createFilterFormInputs,T=S.createSingleFieldParameter,I=S.isEmptyObject,P=S.sortAlphabeticallyArray,F=S.sortNumericArray,O=e("core/g3wobject"),R=[null,void 0,h.SEARCH_ALLVALUE];C(s,O);var A=s.prototype;A.createInputsFormFromFilter=a(regeneratorRuntime.mark(function j(){var e,t,r,n=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=i.filter,s=void 0===a?[]:a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:for(e=s.length-1,t=function(t){var r=s[t],i={label:r.label,attribute:r.attribute,type:r.input.type||"textfield",options:d({},r.input.options),value:null,operator:r.op,logicop:t===e?null:r.logicop,id:r.id||E(),loading:!1,widget:null},a=i.options,l=a.dependance,u=a.dependance_strict;if("selectfield"===i.type||"autocompletefield"===i.type){i.loading="autocompletefield"!==i.type;var c=new Promise(function(e,t){void 0===i.options.values?i.options.values=[]:l&&u?(i.loading=!1,e()):n.getValuesFromField(i).then(function(e){e=n.valuesToKeysValues(e),i.options.values=e})["catch"](function(){return i.options.values=[]})["finally"](function(){i.loading=!1,e()})});l&&(n.inputdependance[i.attribute]=l,n.state.loading[l]=!1,i.options.disabled=u,n.setInputDependencies({master:l,slave:i}),i.options.values.length?(i.widget="valuemap",i.options._values=[].concat(o(i.options.values))):i.options.layer_id&&(i.widget="valuerelation")),c.then(function(){"autocompletefield"!==i.type&&(i.options.values.length?i.options.values[0].value!==h.SEARCH_ALLVALUE&&i.options.values.unshift({value:h.SEARCH_ALLVALUE}):i.options.values.push({value:h.SEARCH_ALLVALUE}),i.value=h.SEARCH_ALLVALUE)})}n.state.forminputs.push(i)},r=0;r<=e;r++)t(r);case 3:case"end":return i.stop()}},j,this)})),A.getReturnType=function(){return this["return"]},A.setReturnType=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"data";this["return"]=e,this.show="data"===e},A.getAutoFieldDependeciesParamField=function(e){var t=this.getCurrentFieldDependance(e);if(t){var r=f(Object.entries(t)[0],2),n=r[0],i=r[1];return this.createFieldsDependenciesAutocompleteParameter({field:n,value:i})}},A.createFieldsDependenciesAutocompleteParameter=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.fields,r=void 0===t?[]:t,n=e.field,i=e.value,a=this.getCurrentFieldDependance(n);if(void 0!==i&&r.push(T({field:n,value:i,operator:this.getFilterInputFromField(n).op})),!a)return r.length&&r.join()||void 0;var o=f(Object.entries(a)[0],2),s=o[0],l=o[1];if(void 0!==l){var u=this.getFilterInputFromField(s),c=u.op,d=u.logicop;r.unshift(s+"|"+c.toLowerCase()+"|"+encodeURI(l)+"|"+(r.length?d.toLowerCase():""))}return this.createFieldsDependenciesAutocompleteParameter({fields:r,dfield:s})},A.getValuesFromField=function(){var e=a(regeneratorRuntime.mark(function t(e){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.options.layer_id){t.next=5;break}return t.next=3,this.getUniqueValuesFromField({field:e.attribute});case 3:return r=t.sent,t.abrupt("return",this.getValueRelationValues(e,M({layer:g["default"].getLayerById(e.options.layer_id),search_endpoint:this.getSearchEndPoint(),inputs:[{value:r,attribute:e.options.value,logicop:"OR",operator:"eq"}]})));case 5:if(!e.options.values.length){t.next=7;break}return t.abrupt("return",this.getValueMapValues(e));case 7:return t.abrupt("return",this.getUniqueValuesFromField({field:e.attribute}));case 8:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),A.getValueRelationValues=function(){var e=a(regeneratorRuntime.mark(function t(e,r){var n,i,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,y["default"].getData("search:features",{inputs:{layer:g["default"].getLayerById(e.options.layer_id),search_endpoint:this.getSearchEndPoint(),filter:r,ordering:e.options.key},outputs:!1});case 3:return n=t.sent,i=n.data,a=void 0===i?[]:i,o=[],(a&&a[0]&&a[0].features||[]).forEach(function(t){o.push({key:t.get(e.options.key),value:t.get(e.options.value)})}),t.abrupt("return",o);case 11:return t.prev=11,t.t0=t["catch"](0),t.abrupt("return",[]);case 14:case"end":return t.stop()}},t,this,[[0,11]])}));return function(t,r){return e.apply(this,arguments)}}(),A.getValueMapValues=function(){var e=a(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.options.values.filter(function(e){return h.SEARCH_ALLVALUE!==e}));case 1:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),A.getLayersFilterData=function(){var e=a(regeneratorRuntime.mark(function t(e){var r,n,i,a,s,l,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=u.field,n=u.suggest,i=u.unique,a=u.ordering,t.next=3,Promise.allSettled(e.map(function(e){return e.getFilterData({field:r,suggest:n,unique:i,ordering:a})}));case 3:s=t.sent,l=Array.from(s.filter(function(e){var t=e.status;return"fulfilled"===t}).reduce(function(e,t){var r=t.value,n=void 0===r?[]:r;return new Set([].concat(o(e),o(n)))},[])),t.t0=l.length&&c(l[0]),t.next="string"===t.t0?8:"number"===t.t0?9:10;break;case 8:return t.abrupt("return",P(l));case 9:return t.abrupt("return",F(l));case 10:return t.abrupt("return",l);case 11:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),A.getUniqueValuesFromField=function(){var e=a(regeneratorRuntime.mark(function t(e){var r,n=e.field,i=e.value,a=e.output;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],e.prev=1,e.next=4,this.getLayersFilterData(1===this.searchLayers.length?[this.searchLayer]:this.searchLayers,{field:this.getAutoFieldDependeciesParamField(n),suggest:void 0!==i?n+"|"+i:void 0,unique:n,ordering:n});case 4:r=e.sent,"autocomplete"===a&&(r=r.map(function(e){return{id:e,text:e}})),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1);case 11:return e.abrupt("return",r);case 12:case"end":return e.stop()}},t,this,[[1,8]])}));return function(t){return e.apply(this,arguments)}}(),A.doSearch=a(regeneratorRuntime.mark(function N(){var e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.filter,i=r.search_endpoint,a=void 0===i?this.getSearchEndPoint():i,o=r.queryUrl,s=void 0===o?this.url:o,l=r.feature_count,c=void 0===l?1e4:l,d=r.show,f=void 0===d?this.show:d;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=n||this.createFilter(),this.state.searching=!0,e=void 0,r.prev=3,r.next=6,y["default"].getData("search:features",{inputs:{layer:this.searchLayers,search_endpoint:a,filter:n,queryUrl:s,formatter:1,feature_count:c,raw:"search"===this["return"]},outputs:f&&{title:this.state.title}});case 6:if(e=r.sent,f){r.next=19;break}if("search_1n"!==this.type){r.next=14;break}return r.next=11,p(e,{search_endpoint:a,feature_count:c,relation_id:this.config.options.search_1n_relationid,output_title:this.state.title});case 11:r.t0=r.sent,r.next=15;break;case 14:r.t0=u(e,this["return"]);case 15:t=r.t0,e=t?t:e,r.next=20;break;case 19:this.project.state.autozoom_query&&e&&1===e.data.length&&this.mapService.zoomToFeatures(e.data[0].features);case 20:r.next=25;break;case 22:r.prev=22,r.t1=r["catch"](3);case 25:return this.state.searching=!1,r.abrupt("return",e);case 27:case"end":return r.stop()}},N,this,[[3,22]])})),A.filterValidFormInputs=function(){return this.state.forminputs.filter(function(e){return-1===R.indexOf(e.value)&&""!==e.value.toString().trim()})},A.getSearchEndPoint=function(){return this.search_endpoint||this.searchLayer.getSearchEndPoint()},A.createFilter=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getSearchEndPoint();return M({layer:this.searchLayers,inputs:this.filterValidFormInputs(),search_endpoint:e})},A._run=function(){this.doSearch()},A.changeInput=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.value;this.state.forminputs.find(function(e){return t==e.id}).value=r},A.createQueryFilterFromConfig=function(e){var t=e.filter,r=void 0;for(var n in t)r=l(n,t[n]);return r},A.getFilterInputFromField=function(e){return this.filter.find(function(t){return t.attribute===e})},A._getExpressionOperatorFromInput=function(e){var t=this.getFilterInputFromField(e);return t?t.op:null},A._getCascadeDependanciesFilter=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=this.getFilterInputFromField(e).input.options.dependance;return r&&(t.unshift(r),this._getCascadeDependanciesFilter(r,t)),t},A.getCurrentFieldDependance=function(e){var t=this.inputdependance[e];return t?i({},t,this.cachedependencies[t]&&h.SEARCH_ALLVALUE!==this.cachedependencies[t]._currentValue?this.cachedependencies[t]._currentValue:void 0):t},A.getDependanceCurrentValue=function(e){return this.inputdependance[e]?this.cachedependencies[this.inputdependance[e]]._currentValue:this.state.forminputs.find(function(t){return t.attribute===e}).value},A.fillDependencyInputs=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.field,n=t.subscribers,i=void 0===n?[]:n,s=t.value,l=void 0===s?h.SEARCH_ALLVALUE:s,u=void 0===this.inputdependance[r],c=l===h.SEARCH_ALLVALUE||null===l||void 0===l||""===l.toString().trim();return new Promise(function(t,n){i.forEach(function(e){"autocompletefield"===e.type?e.options.values.splice(0):(void 0===e.options._allvalues&&(e.options._allvalues=[].concat(o(e.options.values))),c?(e.options.values.splice(0),setTimeout(function(){return e.options.values=[].concat(o(e.options._allvalues))})):e.options.values.splice(1)),e.value="selectfield"!==e.type?h.SEARCH_ALLVALUE:null}),e.cachedependencies[r]=e.cachedependencies[r]||{},e.cachedependencies[r]._currentValue=l;var s=i.filter(function(e){return"autocompletefield"!==e.type});if(l&&l!==h.SEARCH_ALLVALUE){var d=void 0,f=void 0;if(u){var p=e.cachedependencies[r]&&e.cachedependencies[r][l];d=void 0!==p,f=d&&p}else{var v=e.getDependanceCurrentValue(r),m=e.cachedependencies[r]&&e.cachedependencies[r][v]&&e.cachedependencies[r][v][l];
d=void 0!==m,f=d&&m}if(d)for(var y=0;y<i.length;y++){var _=i[y],b=f[_.attribute];if(b&&b.length)for(var w=0;w<b.length;w++)_.options.values.push(b[w]);_.options.disabled=!1,t()}else{if(e.state.loading[r]=!0,u)e.cachedependencies[r][l]=e.cachedependencies[r][l]||{};else{var x=e.getDependanceCurrentValue(r);e.cachedependencies[r][x]=e.cachedependencies[r][x]||{},e.cachedependencies[r][x][l]=e.cachedependencies[r][x][l]||{}}if(s.length){var S=e.createFieldsDependenciesAutocompleteParameter({field:r,value:l});e.searchLayer.getFilterData({field:S}).then(function(){var t=a(regeneratorRuntime.mark(function n(t){var i,a,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:i=t.data[0].features||[],a=regeneratorRuntime.mark(function d(t){var n,a,c,f,p,h,v,m,y;return regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(n=s[t],a=n.attribute,c=n.widget,f=new Set,"valuemap"!==c){d.next=11;break}p=[].concat(o(n.options._values)),i.forEach(function(e){var t=e.get(a);t&&f.add(t)}),h=[].concat(o(f)),p=p.filter(function(e){var t=e.key;return h.indexOf(t)!==-1}),p.forEach(function(e){return n.options.values.push(e)}),d.next=29;break;case 11:if("valuerelation"!==c){d.next=27;break}if(i.forEach(function(e){var t=e.get(a);t&&f.add(t)}),!(f.size>0)){d.next=25;break}return v=T({layer:g["default"].getLayerById(n.options.layer_id),search_endpoint:e.getSearchEndPoint(),field:n.options.key,value:[].concat(o(f))}),d.prev=15,d.next=18,e.getValueRelationValues(n,v);case 18:m=d.sent,m.forEach(function(e){return n.options.values.push(e)}),d.next=25;break;case 22:d.prev=22,d.t0=d["catch"](15);case 25:d.next=29;break;case 27:i.forEach(function(e){var t=e.get(a);t&&f.add(t)}),e.valuesToKeysValues([].concat(o(f)).sort()).forEach(function(e){return n.options.values.push(e)});case 29:u?e.cachedependencies[r][l][n.attribute]=n.options.values.slice(1):(y=e.getDependanceCurrentValue(r),e.cachedependencies[r][y][l][n.attribute]=n.options.values.slice(1)),n.options.disabled=!1;case 31:case"end":return d.stop()}},d,e,[[15,22]])}),c=0;case 3:if(!(c<s.length)){n.next=8;break}return n.delegateYield(a(c),"t0",5);case 5:c++,n.next=3;break;case 8:case"end":return n.stop()}},n,e)}));return function(e){return t.apply(this,arguments)}}())["catch"](function(e){return n(e)})["finally"](function(){e.state.loading[r]=!1,t()})}else i.forEach(function(e){e.options.dependance_strict&&(e.options.disabled=!1)}),e.state.loading[r]=!1,t()}}else i.forEach(function(e){return e.options.disabled=e.options.dependance_strict}),t()})},A.getDependencies=function(e){return this.inputdependencies[e]||[]},A.setInputDependencies=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.master,r=e.slave;this.inputdependencies[t]=void 0!==this.inputdependencies[t]?this.inputdependencies[t]:[],this.inputdependencies[t].push(r)},A.valuesToKeysValues=function(e){return e.length&&"Object"!==k(e[0])?e.map(function(e){return{key:e,value:e}}):e},A.createQueryFilterObject=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.ogcService,r=void 0===t?"wms":t,n=e.filter,i=void 0===n?{}:n;return Object.assign(this.getInfoFromLayer(r),{ogcService:r,filter:i})},A.getInfoFromLayer=function(e){return{url:"wfs"===e?this.searchLayer.getProject().getWmsUrl():this.searchLayer.getQueryUrl(),layers:[],infoFormat:this.searchLayer.getInfoFormat(e),crs:this.searchLayer.getCrs(),serverType:this.searchLayer.getServerType()}},A.setSearchLayer=function(e){this.searchLayer=e},A.getSearchLayer=function(){return this.searchLayer},A.clear=function(){this.state=null},t.exports=s},{"app/constant":4,"core/g3wobject":12,"core/utils/utils":68,"gui/search/vue/panel/searchpanel":177,"services/data":358,"services/gui":361,"store/catalog-layers":374,"store/projects":379}],179:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u(this,e),this.id="search",this._service=e.service||new d,this._service.init(),this.title=this._service.getTitle(),this.internalComponent=new f({service:this._service}),this.internalComponent.state=this._service.state,this.state.visible=!0,this._reload=function(){this._service.reload()},this.unmount=function(){return this._searches_searchtools.$destroy(),u(this,"unmount")}}var a=e("components/Search.vue"),o=n(a),s=e("core/utils/utils"),l=s.inherit,u=s.base,c=e("gui/component/component"),d=e("gui/search/service"),f=Vue.extend(o);l(i,c),t.exports=i},{"components/Search.vue":289,"core/utils/utils":68,"gui/component/component":117,"gui/search/service":176}],180:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=new Vue},{}],181:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var a=e("components/SpatialBookMarks.vue"),o=i(a),s=e("services/gui"),l=n(s),u=e("core/utils/utils"),c=u.inherit,d=u.base,f=e("gui/component/component"),p=Vue.extend(o),h=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};d(this,t),this.title="sdk.spatialbookmarks.title",this.setInternalComponent=function(){return this.internalComponent=new p,this.internalComponent},l["default"].on("closecontent",function(){e.state.open=!1})};c(h,f),t.exports=h},{"components/SpatialBookMarks.vue":299,"core/utils/utils":68,"gui/component/component":117,"services/gui":361}],182:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/StreetView.vue"),a=n(i),o=e("core/utils/utils"),s=o.base,l=o.inherit,u=e("gui/component/component"),c=Vue.extend(a),d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s(this);var t=e.keyError,r=new c({keyError:t});this.setInternalComponent(r),this.unmount=function(){return s(this,"unmount")}};l(d,u),t.exports=d},{"components/StreetView.vue":300,"core/utils/utils":68,"gui/component/component":117}],183:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}var o=e("store/catalog-layers"),s=n(o),l=e("services/data"),u=n(l),c=e("services/gui"),d=n(c),f=e("core/utils/utils"),p=f.inherit,h=f.noop,v=e("core/g3wobject"),g=e("core/i18n/i18n.service"),m=g.t,y=e("core/utils/geo"),_=y.coordinatesToGeometry,b=e("core/layers/layer"),w=b.SELECTION_STATE,x=[10,25,50],S=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.currentPage=0,this.layer=t.layer,this.formatter=t.formatter;var r=this.getHeaders();this.allfeaturesnumber,this.nopaginationsfilter=[],this.selectedfeaturesfid=this.layer.getSelectionFids(),this.geolayer=this.layer.isGeoLayer(),this.relationsGeometry=[],!this.geolayer&&this.layer.getRelations().getArray().forEach(function(t){var r=s["default"].getLayerById(t.getChild());r.isGeoLayer()&&e.relationsGeometry.push({layer:r,child_field:t.getChildField(),field:t.getFatherField(),features:{}})}),this.projection=this.geolayer?this.layer.getProjection():null,this.mapService=d["default"].getService("map"),this.getAll=!1,this.paginationfilter=!1,this.mapBBoxEventHandlerKey={key:null,cb:null},this.clearAllSelection=function(){e.state.features.forEach(function(e){return e.selected=!1}),e.state.tools.show=!1,e.state.selectAll=!1},this.state={pageLengths:x,pageLength:this.layer.getAttributeTablePageLength()||x[0],features:[],title:this.layer.getTitle(),headers:r,geometry:!0,loading:!1,allfeatures:0,pagination:!this.getAll,selectAll:!1,nofilteredrow:!1,tools:{geolayer:{show:this.geolayer,active:!1,in_bbox:void 0},show:!1,filter:this.layer.state.filter}},this._async={state:!1,fnc:h},d["default"].onbefore("setContent",function(t){e._async.state=100===t.perc}),this.layer.on("unselectionall",this.clearAllSelection),this.filterChangeHandler=a(regeneratorRuntime.mark(function n(){var t,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=i.type;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e.allfeaturesnumber=void 0,t=[],r="in_bbox"===a||!e.selectedfeaturesfid.has(w.ALL),e.state.pagination){n.next=12;break}if(!r){n.next=10;break}return n.next=7,e.reloadData();case 7:n.t0=n.sent,n.next=11;break;case 10:n.t0=[];case 11:t=n.t0;case 12:r&&e.emit("redraw",t);case 13:case"end":return n.stop()}},n,e)})),this.layer.on("filtertokenchange",this.filterChangeHandler)};p(S,v);var L=S.prototype;L.toggleFilterToken=a(regeneratorRuntime.mark(function C(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.layer.toggleFilterToken();case 2:case"end":return e.stop()}},C,this)})),L.getHeaders=function(){return[null].concat(i(this.layer.getTableHeaders()))},L.setDataForDataTable=function(){var e=this,t=[];return this.state.features.forEach(function(r){var n=r.attributes?r.attributes:r.properties,i=[null];e.state.headers.forEach(function(e){if(e){var t=n[e.name];e.value=t,i.push(t)}}),t.push(i)}),t},L.addRemoveSelectedFeature=function(e){if(e.selected=!e.selected,this.state.selectAll)this.state.selectAll=!1,this.layer.excludeSelectionFid(e.id,this.state.pagination);else if(this.selectedfeaturesfid.has(w.EXCLUDE)){this.layer[e.selected?"includeSelectionFid":"excludeSelectionFid"](e.id);var t=this.selectedfeaturesfid.size;1===t?(!this.state.tools.filter.active&&this.layer.setSelectionFidsAll(),this.state.selectAll=!0):t-1===this.state.features.length&&this.layer.clearSelectionFids()}else{this.layer[e.selected?"includeSelectionFid":"excludeSelectionFid"](e.id);var r=this.selectedfeaturesfid.size;r===this.allfeaturesnumber&&(this.state.selectAll=!0,!this.state.tools.filter.active&&this.layer.setSelectionFidsAll())}this.state.tools.show=this.selectedfeaturesfid.size>0,this.state.pagination||this.nopaginationsfilter.length&&(this.state.selectAll=this.state.features.filter(function(e){return e.selected}).length===this.nopaginationsfilter.length)},L.createFeatureForSelection=function(e){return{attributes:e.attributes?e.attributes:e.properties,geometry:this._returnGeometry(e)}},L.getAllFeatures=function(e){var t=this;return d["default"].setLoadingContent(!0),new Promise(function(r,n){t.layer.getDataTable(e||{}).then(function(n){var i=n.features;if(t.geolayer&&i){if(!e){var a=t.state.features.map(function(e){return e.id});i.forEach(function(e){a.indexOf(e.id)===-1&&e.geometry&&t.layer.addOlSelectionFeature({id:e.id,feature:t.createFeatureForSelection(e)})}),t.getAll=!0}r(i)}}).fail(function(){return n()}).always(function(){return d["default"].setLoadingContent(!1)})})},L.switchSelection=a(regeneratorRuntime.mark(function k(){var e,t,r,n=this;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(this.state.pagination){i.next=4;break}this.nopaginationsfilter.length?(e=!1,t=[],this.state.features.forEach(function(r,i){n.nopaginationsfilter.indexOf(i)!==-1&&t.push(r),r.selected=!r.selected,n.layer[r.selected?"includeSelectionFid":"excludeSelectionFid"](r.id),e=e||r.selected}),this.state.tools.show=e,this.checkSelectAll(t)):(this.state.features.forEach(function(e){e.selected=!e.selected}),this.layer.invertSelectionFids(),this.checkSelectAll(),this.state.tools.show=this.selectedfeaturesfid.size>0),i.next=13;break;case 4:if(r=!1,this.state.features.forEach(function(e){e.selected=!e.selected,r=e.selected}),i.t0=!this.getAll,!i.t0){i.next=10;break}return i.next=10,this.getAllFeatures();case 10:this.state.selectAll=this.paginationfilter?r:this.state.selectAll,this.layer.invertSelectionFids(),this.state.tools.show=this.selectedfeaturesfid.size>0;case 13:case"end":return i.stop()}},k,this)})),L.clearLayerSelection=function(){this.layer.clearSelectionFids()},L.selectAllFeatures=a(regeneratorRuntime.mark(function E(){var e,t,r,n,i,a,o,s=this;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(this.state.selectAll=!this.state.selectAll,this.state.pagination){l.next=5;break}this.nopaginationsfilter.length?(e=!1,this.state.features.forEach(function(t,r){s.nopaginationsfilter.indexOf(r)!==-1&&(t.selected=s.state.selectAll,s.layer[t.selected?"includeSelectionFid":"excludeSelectionFid"](t.id),e=e||t.selected)}),this.state.tools.show=e):(this.state.tools.show=this.state.selectAll,this.layer[this.state.selectAll?"setSelectionFidsAll":"clearSelectionFids"](),this.state.features.forEach(function(e){return e.selected=s.state.selectAll})),l.next=25;break;case 5:if(!this.paginationfilter){l.next=18;break}if(!(this.state.featurescount>=this.state.allfeatures)){l.next=10;break}this.state.features.forEach(function(e){e.selected=s.state.selectAll,s.layer[e.selected?"includeSelectionFid":"excludeSelectionFid"](e.id)}),l.next=15;break;case 10:return t=this.paginationParams,r=t.search,n=t.ordering,i=t.formatter,a=t.in_bbox,l.next=13,this.getAllFeatures({search:r,ordering:n,formatter:i,in_bbox:a});case 13:o=l.sent,o.forEach(function(e){!s.getAll&&s.geolayer&&e.geometry&&s.layer.addOlSelectionFeature({id:e.id,feature:s.createFeatureForSelection(e)}),s.layer[s.state.selectAll?"includeSelectionFid":"excludeSelectionFid"](e.id)});case 15:this.state.features.forEach(function(e){return e.selected=s.state.selectAll}),l.next=24;break;case 18:if(this.state.features.forEach(function(e){return e.selected=s.state.selectAll}),l.t0=!this.getAll,!l.t0){l.next=23;break}return l.next=23,this.getAllFeatures();case 23:this.layer[this.state.selectAll?"setSelectionFidsAll":"clearSelectionFids"]();case 24:this.state.tools.show=this.state.selectAll||this.selectedfeaturesfid.size>0;case 25:case"end":return l.stop()}},E,this)})),L.setFilteredFeature=function(e){var t=this;this.nopaginationsfilter=e,this.checkSelectAll(e.length===this.allfeaturesnumber||0===e.length?void 0:this.nopaginationsfilter.map(function(e){return t.state.features[e]}))},L.setAttributeTablePageLength=function(e){this.layer.setAttributeTablePageLength(e)},L.getData=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.start,n=void 0===r?0:r,i=t.order,a=void 0===i?[]:i,o=t.length,s=void 0===o?this.state.pageLength:o,l=t.columns,u=void 0===l?[]:l,c=t.search,f=void 0===c?{value:null}:c,p=t.firstCall,h=void 0!==p&&p;return d["default"].setLoadingContent(!0),this.setAttributeTablePageLength(s),new Promise(function(t,r){if(e.state.headers.length){var i=f.value&&f.value.length>0?f.value:null;e.state.features.splice(0),a.length||a.push({column:1,dir:"asc"});var o="asc"===a[0].dir?e.state.headers[a[0].column].name:"-"+e.state.headers[a[0].column].name;e.currentPage=0===n||e.state.pagination&&e.state.tools.filter.active?1:n/s+1;var l=e.state.tools.geolayer.in_bbox,c=e.state.pagination?u.filter(function(e){return e.search&&e.search.value}).map(function(e){return e.name+"|ilike|"+e.search.value+"|and"}).join(","):void 0;e.paginationParams={field:c||void 0,page:e.currentPage,page_size:s,search:i,in_bbox:l,formatter:e.formatter,ordering:o};var p=e.state.pagination?e.layer.getDataTable(e.paginationParams):e.layer.getDataTable({ordering:o,in_bbox:l,formatter:e.formatter});p.then(function(r){var n=r.features,i=void 0===n?[]:n;e.state.allfeatures=r.count||e.state.features.length,e.state.featurescount=i.length,e.allfeaturesnumber=void 0===e.allfeaturesnumber?r.count:e.allfeaturesnumber,e.paginationfilter=r.count!==e.allfeaturesnumber,e.state.pagination=h?e.state.tools.filter.active||i.length<e.allfeaturesnumber:e.state.pagination,e.addFeatures(i),t({data:e.setDataForDataTable(),recordsFiltered:r.count,recordsTotal:r.count})}).fail(function(e){d["default"].notify.error(m("info.server_error")),r(e)}).always(function(){d["default"].setLoadingContent(!1)})}else t({data:[],recordsTotal:0,recordsFiltered:0})})},L.setInBBoxParam=function(){this.state.tools.geolayer.in_bbox=this.state.tools.geolayer.active?this.mapService.getMapBBOX().join(","):void 0},L.resetMapBBoxEventHandlerKey=function(){ol.Observable.unByKey(this.mapBBoxEventHandlerKey.key),this.mapBBoxEventHandlerKey.key=null,this.mapBBoxEventHandlerKey.cb=null},L.getDataFromBBOX=a(regeneratorRuntime.mark(function M(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.state.tools.geolayer.active=!this.state.tools.geolayer.active,this.state.tools.geolayer.active?(this.mapBBoxEventHandlerKey.cb=this.state.pagination?function(){e.setInBBoxParam(),e.emit("ajax-reload")}:a(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.setInBBoxParam(),e.filterChangeHandler({type:"in_bbox"});case 2:case"end":return t.stop()}},r,e)})),this.mapBBoxEventHandlerKey.key=this.mapService.getMap().on("moveend",this.mapBBoxEventHandlerKey.cb),this.mapBBoxEventHandlerKey.cb()):(this.mapBBoxEventHandlerKey.cb&&this.mapBBoxEventHandlerKey.cb(),this.resetMapBBoxEventHandlerKey());case 2:case"end":return t.stop()}},M,this)})),L.addFeature=function(e){var t={id:e.id,selected:this.state.tools.filter.active||this.layer.hasSelectionFid(e.id),attributes:e.attributes?e.attributes:e.properties};this.geolayer&&e.geometry&&(this.layer.getOlSelectionFeature(t.id)||this.layer.addOlSelectionFeature({id:t.id,feature:this.createFeatureForSelection(e)}),t.geometry=e.geometry),this.state.features.push(t)},L.checkSelectAll=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.features;this.state.selectAll=this.selectedfeaturesfid.has(w.ALL)||e.length&&e.reduce(function(e,t){return e&&t.selected},!0)},L.addFeatures=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach(function(t){return e.addFeature(t)}),this.state.tools.show=this.layer.getFilterActive()||this.selectedfeaturesfid.size>0,this.checkSelectAll()},L.reloadData=a(regeneratorRuntime.mark(function T(){var e,t,r,n,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return this.state.features.splice(0),this.state.pagination=i,a.next=4,this.getData();case 4:return e=a.sent,t=e.data,r=void 0===t?[]:t,n=e.reloadData,a.abrupt("return",r);case 7:case"end":return a.stop()}},T,this)})),L._setLayout=function(){},L._returnGeometry=function(e){var t=void 0;return e.attributes?t=e.geometry:e.geometry&&(t=_(e.geometry.type,e.geometry.coordinates)),t},L.zoomAndHighLightFeature=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.geometry;r&&(this._async.state?this._async.fnc=this.mapService.highlightGeometry.bind(mapService,r,{zoom:t}):this.mapService.highlightGeometry(r,{zoom:t}))},L.zoomAndHighLightGeometryRelationFeatures=function(){var e=a(regeneratorRuntime.mark(function t(e){var r,n,i,a,o=this,s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.relationsGeometry.length){t.next=10;break}return r=[],n=[],i=[],this.relationsGeometry.forEach(function(t){var r=t.layer,a=t.child_field,o=t.field,l=t.features,c=e.attributes[o];if(i.push(c),void 0===l[c]){var d=void 0;d=s?u["default"].getData("search:features",{inputs:{layer:r,filter:a+"|eq|"+c,formatter:1,search_endpoint:"api"},outputs:!1}):Promise.reject(),n.push(d)}else n.push(Promise.resolve({data:[{features:l[c]}]}))}),t.next=7,Promise.allSettled(n);case 7:a=t.sent,a.forEach(function(e,t){var n=e.status,a=e.value;if("fulfilled"===n){var s=a.data[0]?a.data[0].features:[];s.forEach(function(e){return r.push(e)}),void 0===o.relationsGeometry[t].features[i[t]]&&(o.relationsGeometry[t].features[i[t]]=s)}}),s?this.mapService.zoomToFeatures(r,{highlight:!0}):this.mapService.highlightFeatures(r);case 10:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),L.clear=function(){var e=this;this.layer.off("unselectionall",this.clearAllSelection),this.layer.off("filtertokenchange",this.filterChangeHandler),this.resetMapBBoxEventHandlerKey(),this.allfeaturesnumber=null,this.mapService=null,this._async.state&&setTimeout(function(){e._async.fnc(),e._async.state=!1,e._async.fnc=h})},t.exports=S},{"core/g3wobject":12,"core/i18n/i18n.service":13,"core/layers/layer":34,"core/utils/geo":64,"core/utils/utils":68,"services/data":358,"services/gui":361,"store/catalog-layers":374}],184:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("components/Table.vue"),a=n(i),o=e("services/gui"),s=n(o),l=e("core/i18n/i18n.service"),u=l.t,c=e("core/utils/utils"),d=c.base,f=c.inherit,p=e("gui/component/component"),h=e("gui/table/tableservice"),v=Vue.extend(a["default"]),g=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};d(this),this.id="openattributetable";var r=t.layer,n=t.formatter,i=t.service||new h({layer:r,formatter:n});this.setService(i);var a=new v({service:i});this.setInternalComponent(a),a.state=i.state,i.on("redraw",function(){e.layout()}),this.unmount=function(){return d(this,"unmount")},this.layout=function(){a.reloadLayout()}};f(g,p);var m=g.prototype;m.show=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=this.getService();s["default"].closeOpenSideBarComponent(),r.getData({firstCall:!0}).then(function(){s["default"].showContent({content:e,perc:50,split:s["default"].isMobile()?"h":"v",push:!1,title:t.title})})["catch"](function(e){return s["default"].notify.error(u("info.server_error"))})["finally"](function(){return e.emit("show")})},m.unmount=function(){var e=this;return d(this,"unmount").then(function(){e._service.clear()})},t.exports=g},{"components/Table.vue":301,"core/i18n/i18n.service":13,"core/utils/utils":68,"gui/component/component":117,"gui/table/tableservice":183,"services/gui":361}],185:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config=null,this.state=a({},t,{toolsGroups:[],visible:!1,loading:!1}),this.setters={addTool:function(e,t){return e.state=e.state?e.state:{type:null,message:null},this._addTool(e,t)},addTools:function(e,t){return this._addTools(e,t)},addToolGroup:function(e,t){return this._addToolGroup(e,t)},removeToolGroup:function(e){return this._removeToolGroup(e)},removeTools:function(){return this._removeTools()}},u(this);var r=s["default"].getCurrentProject(),n=r.getState(),i=n.tools,o=void 0===i?{}:i,l=function(t){var r=t.toUpperCase();e.addToolGroup(0,r);var n=o[t].map(function(e){return{name:e.name,action:ToolsService.ACTIONS[t].bind(null,e)}});e.addTools(n,{position:0,title:r})};for(var c in o)l(c)}var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("store/projects"),s=n(o),l=e("core/utils/utils"),u=l.base,c=l.inherit,d=e("core/g3wobject");c(i,d);var f=i.prototype;f.reload=function(){this.removeTools()},f._addTool=function(e,t){var r=t.position,n=t.title,a=this._addToolGroup(r,n);void 0===e.action&&e.type&&(e.action=i.ACTIONS[e.type]?i.ACTIONS[e.type].bind(null,e.options):function(){}),a.tools.push(e)},f._addTools=function(e,t){var r=this;e.forEach(function(e){return r.addTool(e,t)})},f.setLoading=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state.loading=e},f._removeTool=function(e){this.state.toolsGroups=this.state.toolsGroups.splice(e,1)},f._removeTools=function(){this.state.toolsGroups.splice(0)},f.updateToolsGroup=function(e,t){Vue.set(this.state.toolsGroups,e,t)},f.getState=function(){return this.state},f._removeToolGroup=function(e){this.state.toolsGroups=this.state.toolsGroups.filter(function(t){return t.name!==e})},f._addToolGroup=function(e,t){var r=this.state.toolsGroups.find(function(e){return e.name===t});return r||(r={name:t,tools:[]},this.state.toolsGroups.splice(e,0,r)),r},f.setToolState=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.state,n=void 0===r?{type:null,message:null}:r;this.state.toolsGroups.find(function(e){var r=e.tools.find(function(e){return e.name===t});if(r)return r.state.type=n.type,r.state.message=n.message,!0})},i.ACTIONS={},t.exports=i},{"core/g3wobject":12,"core/utils/utils":68,"store/projects":379}],186:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};d(this,e),this._service=new h(e),this.title="tools";var t=new v({toolsService:this._service});t.state=this._service.state,this.setInternalComponent(t,{events:[{name:"visible"}]}),this._setOpen=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.internalComponent.state.open=e,e&&u["default"].closeContent()}}var o=e("components/Tools.vue"),s=i(o),l=e("services/gui"),u=n(l),c=e("core/utils/utils"),d=c.base,f=c.inherit,p=e("gui/component/component"),h=e("gui/tools/service"),v=Vue.extend(s);f(a,p),t.exports=a},{"components/Tools.vue":306,"core/utils/utils":68,"gui/component/component":117,"gui/tools/service":185,"services/gui":361}],187:[function(e,t,r){function n(){this._parent=null,this.state={contentsdata:[]}}var i=e("core/utils/utils"),a=i.resolve,o=i.inherit,s=e("core/g3wobject"),l=e("gui/component/component"),u=e("gui/panel");o(n,s);var c=n.prototype;c.push=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._parent=t.parent,this._mount(e,t)},c.pop=function(){var e=this,t=$.Deferred();if(this.state.contentsdata.length){var r=this.state.contentsdata.slice(-1)[0].content;this._unmount(r).then(function(){var r=e.state.contentsdata.pop();t.resolve(r)})}else t.resolve();return t.promise()},c.clear=function(){var e=this,t=$.Deferred();if(this.state.contentsdata.length){var r=[];this.state.contentsdata.forEach(function(t){r.push(e._unmount(t.content))}),$.when(r).then(function(){e.state.contentsdata.splice(0,e.state.contentsdata.length),t.resolve()})}else t.resolve();return t.promise()},c.getContentData=function(){return this.state.contentsdata},c.getCurrentContentData=function(){return this.state.contentsdata[this.state.contentsdata.length-1]},c.getPreviousContentData=function(){return this.state.contentsdata[this.state.contentsdata.length-2]},c._mount=function(e,t){if(e instanceof jQuery)return this._setJqueryContent(e);if(_.isString(e)){var r=$(e);return r.length||(r=$("<div>"+e+"</div>")),this._setJqueryContent(r)}return e.mount&&"function"==typeof e.mount?(this._checkDuplicateVueContent(e),this._setVueContent(e,t)):this._setDOMContent(e)},c._setJqueryContent=function(e,t){return $(this._parent).append(e),this.state.contentsdata.push({content:e,options:t}),a()},c._setDOMContent=function(e,t){return this._parent.appendChild(e),this.state.contentsdata.push({content:e,options:t}),a()},c._setVueContent=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=$.Deferred(),i=r.append||!1;return e.mount(this._parent,i).then(function(){$(t._parent).localize(),t.state.contentsdata.push({content:e,options:r}),n.resolve(e)}),n.promise()},c._checkDuplicateVueContent=function(e){var t=this,r=null,n=e.getId();if(this.state.contentsdata.forEach(function(e,t){e.content.getId&&e.content.getId()==n&&(r=t)}),!_.isNull(r)){var i=this.state.contentsdata[r];i.content.unmount().then(function(){return t.state.contentsdata.splice(r,1)})}},c._unmount=function(e){var t=$.Deferred();return e instanceof l||e instanceof u?e.unmount().then(function(){return t.resolve()}):($(this._parent).empty(),t.resolve()),t.promise()},c.forEach=function(e){this.state.contentsdata.forEach(function(t){return e(t.content)})},c.getLength=function(){return this.state.contentsdata.length},t.exports=n},{"core/g3wobject":12,"core/utils/utils":68,"gui/component/component":117,"gui/panel":162}],188:[function(e,t,r){t.exports={barstack:e("./barstack")}},{"./barstack":187}],189:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l(this,e),this.stack=new d,this.setService(this),this.title="contents",this.contentsdata=this.stack.state.contentsdata,this.state.visible=!0;var t=new p({service:this});this.setInternalComponent(t),this.internalComponent.state=this.state}var a=e("components/ViewportContentsViewer.vue"),o=n(a),s=e("core/utils/utils"),l=s.base,u=s.inherit,c=e("gui/utils/utils"),d=c.barstack,f=e("gui/component/component"),p=Vue.extend(o);u(i,f);var h=i.prototype;h.setContent=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.push,n=void 0!==r&&r,i=t.content,a=(t.crumb,$.Deferred());return n?this.addContent(i,t).then(function(){return a.resolve(t)}):this.clearContents().then(function(){e.addContent(i,t).then(function(){return a.resolve(t)})}),this.setOpen(!0),a.promise()},h.addContent=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=$.Deferred();r.parent=this.internalComponent.$el,r.append=!0;var i=this.stack.push(e,r);return i.then(function(){t.contentsdata=t.stack.state.contentsdata,t.updateContentVisibility(),n.resolve()}),n.promise()},h.removeContent=function(){return this.setOpen(!1),this.clearContents()},h.popContent=function(){var e=this;return this.stack.pop().then(function(){e.contentsdata=e.stack.state.contentsdata,e.updateContentVisibility()})},h.getComponentByClass=function(e){var t=void 0,r=this.stack.getContentData();return r.forEach(function(r){if(r.content instanceof e)return t=r.content,!1}),t},h.getComponentById=function(e){var t=void 0,r=this.stack.getContentData();return r.forEach(function(r){if(r.content.id==e)return t=r.content,!1}),t},h.getContentData=function(){return this.stack.getContentData()},h.getCurrentContentData=function(){return this.stack.getCurrentContentData()},h.getPreviousContentData=function(){return this.stack.getPreviousContentData()},h.updateContentVisibility=function(){var e=$(this.internalComponent.$el).children();e.hide(),e.last().show()},h.clearContents=function(){var e=this;return this.stack.clear().then(function(){return e.contentsdata=e.stack.state.contentsdata})},h.layout=function(e,t){var r=this,n=$(this.internalComponent.$el);Vue.nextTick(function(){var t=r.stack.state.contentsdata,i=n.parent().height()-n.siblings(".close-panel-block").outerHeight(!0)-n.siblings(".content_breadcrumb").outerHeight(!0)-10;n.height(i),n.children().first().height(i),t.forEach(function(t){"function"==typeof t.content.layout&&t.content.layout(e+.5,i)})})},t.exports=i},{"components/ViewportContentsViewer.vue":309,"core/utils/utils":68,"gui/component/component":117,"gui/utils/utils":188}],190:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.wmsurls,n=void 0===r?[]:r;this.projectId=p["default"].getCurrentProject().getId(),
this.panel,this.state={adminwmsurls:n,localwmsurls:[]},m["default"].isReady().then(function(){m["default"].getService("map").isReady().then(i(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.loadClientWmsUrls();case 2:e.state.localwmsurls=t.sent;case 3:case"end":return t.stop()}},t,e)})))}),p["default"].onafter("setCurrentProject",function(){var t=i(regeneratorRuntime.mark(function r(t){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:e.projectId=t.getId(),e.state.adminwmsurls=t.wmsurls||[];case 2:case"end":return r.stop()}},r,e)}));return function(e){return t.apply(this,arguments)}}())}Object.defineProperty(r,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=e("gui/wms/vue/panel/wmslayerspanel"),l=n(s),u=e("app/constant"),c=e("services/data"),d=n(c),f=e("store/projects"),p=n(f),h=e("services/application"),v=n(h),g=e("services/gui"),m=n(g),y=e("core/utils/utils"),_=y.uniqueId,b=a.prototype;b.loadClientWmsUrls=i(regeneratorRuntime.mark(function w(){var e,t=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=this.getLocalWMSData(),void 0===e&&(e={urls:[],wms:{}},this.updateLocalWMSData(e)),r.next=4,m["default"].isReady();case 4:return setTimeout(function(){var r=m["default"].getService("map");r.on("remove-external-layer",function(e){return t.deleteWms(e)}),r.on("change-layer-position-map",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.id,n=e.position;return t.changeLayerData(r,{key:"position",value:n})}),r.on("change-layer-opacity",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.id,n=e.opacity;return t.changeLayerData(r,{key:"opacity",value:n})}),r.on("change-layer-visibility",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.id,n=e.visible;return t.changeLayerData(r,{key:"visible",value:n})}),Object.keys(e.wms).forEach(function(r){e.wms[r].forEach(function(e){t.loadWMSLayerToMap(o({url:r},e))})})}),r.abrupt("return",e.urls);case 6:case"end":return r.stop()}},w,this)})),b.changeLayerData=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.getLocalWMSData();Object.keys(r.wms).find(function(n){var i=r.wms[n],a=i.findIndex(function(t){return t.name==e});if(a!==-1)return i[a][t.key]=t.value,!0}),this.updateLocalWMSData(r)},b.getRequestStatusObject=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.error,r=void 0!==t&&t,n=e.added,i=void 0!==n&&n;return{error:r,added:i}},b.addNewUrl=i(regeneratorRuntime.mark(function x(){var e,t,r,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=i.id,o=i.url;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(e=this.state.localwmsurls.find(function(e){var t=e.id,r=e.url;return r==o||t==a}),t=this.getRequestStatusObject({added:!!e}),e){i.next=13;break}return i.prev=3,i.next=6,this.getWMSLayers(o);case 6:r=i.sent,r.result?(n=this.getLocalWMSData(),this.state.localwmsurls.push({id:a,url:o}),n.urls=this.state.localwmsurls,this.updateLocalWMSData(n),r.wmsurl=o,this.showWmsLayersPanel(r)):t.error=!0,i.next=13;break;case 10:i.prev=10,i.t0=i["catch"](3),t.error=!0;case 13:return i.abrupt("return",t);case 14:case"end":return i.stop()}},x,this,[[3,10]])})),b.deleteWms=function(e){var t=this.getLocalWMSData();Object.keys(t.wms).find(function(r){var n=t.wms[r],i=n.findIndex(function(t){return t.name==e});if(i!==-1)return n.splice(i,1),0==n.length&&delete t.wms[r],!0}),this.updateLocalWMSData(t)},b.checkIfWMSAlreadyAdded=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.layers,n=void 0===r?[]:r,i=!1,a=this.getLocalWMSData();return a.wms[t]&&(i=!!a.wms[t].find(function(e){var t=e.layers,r=n.length;if(t.length===r)return n.reduce(function(e,r){return e+t.indexOf(r)!==-1?1:0},0)===r})),i},b.deleteWmsUrl=function(e){this.state.localwmsurls=this.state.localwmsurls.filter(function(t){var r=t.id;return e!==r});var t=this.getLocalWMSData();t.urls=this.state.localwmsurls,this.updateLocalWMSData(t)},b.loadWMSDataAndShowWmsLayersPanel=function(){var e=i(regeneratorRuntime.mark(function t(e){var r,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.getRequestStatusObject(),t.prev=1,t.next=4,this.getWMSLayers(e);case 4:n=t.sent,r.error=!n.result,n.result&&(n.wmsurl=e,this.showWmsLayersPanel(n)),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](1),r.error=!0;case 12:return t.abrupt("return",r);case 13:case"end":return t.stop()}},t,this,[[1,9]])}));return function(t){return e.apply(this,arguments)}}(),b.showWmsLayersPanel=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.panel=new l["default"]({service:this,config:e}),this.panel.show(),this.panel},b.getWMSLayers=function(){var e=i(regeneratorRuntime.mark(function t(e){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={result:!1,layers:[],info_formats:[],"abstract":null,map_formats:[],title:null},t.prev=1,t.next=4,d["default"].getData("ows:wmsCapabilities",{inputs:{url:e},outputs:!1});case 4:r=t.sent,t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](1);case 10:if(!r.result){t.next=12;break}return t.abrupt("return",r);case 12:return t.abrupt("return",r);case 13:case"end":return t.stop()}},t,this,[[1,7]])}));return function(t){return e.apply(this,arguments)}}(),b.loadWMSLayerToMap=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.name,n=e.epsg,i=e.position,a=e.opacity,o=e.visible,s=void 0===o||o,l=e.layers,u=void 0===l?[]:l,c=m["default"].getService("map");return c.addExternalWMSLayer({url:t,name:r,layers:u,epsg:n,position:i,visible:s,opacity:a})},b.addWMSlayer=i(regeneratorRuntime.mark(function S(){var e,t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.url,a=n.name,o=void 0===a?"wms_"+_():a,s=n.epsg,l=n.position,u=n.layers,c=void 0===u?[]:u,d=n.opacity,f=void 0===d?1:d,p=n.visible,h=void 0===p||p;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e=this.getLocalWMSData(),t={url:i,name:o,layers:c,epsg:s,position:l,visible:h,opacity:f},void 0===e.wms[i]?e.wms[i]=[t]:e.wms[i].push(t),this.updateLocalWMSData(e),n.prev=4,n.next=7,this.loadWMSLayerToMap(t);case 7:n.next=15;break;case 9:n.prev=9,n.t0=n["catch"](4),r=m["default"].getService("map"),r.removeExternalLayer(o),this.deleteWms(o),setTimeout(function(){m["default"].showUserMessage({type:"warning",message:"sidebar.wms.layer_add_error"})});case 15:this.panel.close();case 16:case"end":return n.stop()}},S,this,[[4,9]])})),b.getLocalWMSData=function(){return v["default"].getLocalItem(u.LOCALSTORAGE_EXTERNALWMS_ITEM)&&v["default"].getLocalItem(u.LOCALSTORAGE_EXTERNALWMS_ITEM)[this.projectId]},b.updateLocalWMSData=function(e){var t=v["default"].getLocalItem(u.LOCALSTORAGE_EXTERNALWMS_ITEM)||{};t[this.projectId]=e,v["default"].setLocalItem({id:u.LOCALSTORAGE_EXTERNALWMS_ITEM,data:t})},b.clear=function(){this.panel=null},r["default"]=a},{"app/constant":4,"core/utils/utils":68,"gui/wms/vue/panel/wmslayerspanel":191,"services/application":351,"services/data":358,"services/gui":361,"store/projects":379}],191:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.service,r=e.config;this.setService(t),this.id=c(),this.title="sidebar.wms.panel.title";var n=f,i=new n({service:t,config:r});this.setInternalPanel(i),this.unmount=function(){return l(this,"unmount").then(function(){t.clear()})}}Object.defineProperty(r,"__esModule",{value:!0});var a=e("components/WMSLayersPanel.vue"),o=n(a),s=e("core/utils/utils"),l=s.base,u=s.inherit,c=s.uniqueId,d=e("gui/panel"),f=Vue.extend(o);u(i,d),r["default"]=i},{"components/WMSLayersPanel.vue":311,"core/utils/utils":68,"gui/panel":162}],192:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};p(this,e),this._service=new u["default"](e),this.title="WMS";var t=new g({service:this._service});t.state=this._service.state,this.setInternalComponent(t),this._setOpen=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.internalComponent.state.open=e,e&&d["default"].closeContent()}}var o=e("components/WMS.vue"),s=i(o),l=e("gui/wms/service"),u=n(l),c=e("services/gui"),d=n(c),f=e("core/utils/utils"),p=f.base,h=f.inherit,v=e("gui/component/component"),g=Vue.extend(s);h(a,v),t.exports=a},{"components/WMS.vue":310,"core/utils/utils":68,"gui/component/component":117,"gui/wms/service":190,"services/gui":361}],193:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=e("store/application-state"),o=n(a),s=e("services/gui"),l=n(s);t.exports=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.steps,r=void 0===t?{}:t;return{data:function(){return{steps:r,currentStep:0}},watch:{steps:{handler:function(e){var t=this;Object.values(e).find(function(e,r){if(!e.done)return t.currentStep=r,!0})},deep:!1}},render:function(e){var t=this;return e("ul",{style:{alignSelf:"flex-start",listStyle:"none",padding:(o["default"].ismobile?5:10)+"px !important",marginBottom:0}},Object.values(this.steps).map(function(r,n){var a,o={current:!r.done&&n===t.currentStep,done:r.done,todo:!r.done&&n!==t.currentStep};return e("li",{style:{fontWeight:(r.done||!r.done&&n===t.currentStep)&&"bold"||null,marginBottom:"5px",color:r.done&&"green",display:r.buttonnext&&"inline-flex"}},[e("i",{style:{marginRight:"5px",fontWeight:r.done&&"bold"},"class":(a={},i(a,l["default"].getFontClass("arrow-right"),o.current),i(a,l["default"].getFontClass("empty-circle"),o.todo),i(a,l["default"].getFontClass("success"),o.done),a)}),e("span",{directives:[{name:r.directive,value:r.description}],style:{display:r.buttonnext?"inline-flex":"inline",flexDirection:r.buttonnext&&"row-reverse"}}),void 0!==r.dynamic&&e("span",{style:{alignSelf:"center",padding:"3px"}},r.dynamic),r.buttonnext&&e("button",{on:{click:function(){r.done=!0,r.buttonnext.done()}},directives:[{name:"t",value:"sdk.workflow.next"}],style:{fontWeight:"bold"},"class":{btn:!0,"btn-success":!0,"g3w-disabled":r.buttonnext.disabled}})])}))}}}},{"services/gui":361,"store/application-state":373}],194:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=e("vue-cookie-law"),s=t(o),l=e("components/HeaderItem.vue"),u=t(l),c=e("store/projects"),d=t(c),f=e("services/application"),p=t(f),h=e("services/gui"),v=t(h),g=e("mixins"),m=e("constant"),y=e("core/utils/utils"),b=y.uniqueId,w=e("core/i18n/i18n.service"),x=w.t;if("undefined"==typeof jQuery)throw new Error("LayoutManager requires jQuery");$.LayoutManager=$.LayoutManager||{options:{navbarMenuSlimscroll:!0,navbarMenuSlimscrollWidth:"0px",navbarMenuHeight:"200px",animationSpeed:"fast",sidebarToggleSelector:"[data-toggle='offcanvas']",sidebarPushMenu:!0,sidebarSlimScroll:!1,sidebarExpandOnHover:!1,enableBoxRefresh:!0,enableFastclick:!0,enableControlSidebar:!0,controlSidebarOptions:{toggleBtnSelector:"[data-toggle='control-sidebar']",selector:".control-sidebar",slide:!0},enableBoxWidget:!0,boxWidgetOptions:{boxWidgetIcons:{collapse:"fa-minus",open:"fa-plus",remove:"fa-times"},boxWidgetSelectors:{remove:'[data-widget="remove"]',collapse:'[data-widget="collapse"]'}},directChat:{enable:!0,contactToggleSelector:'[data-widget="chat-pane-toggle"]'},colors:{lightBlue:"#3c8dbc",red:"#f56954",green:"#00a65a",aqua:"#00c0ef",yellow:"#f39c12",blue:"#0073b7",navy:"#001F3F",teal:"#39CCCC",olive:"#3D9970",lime:"#01FF70",orange:"#FF851B",fuchsia:"#F012BE",purple:"#8E24AA",maroon:"#D81B60",black:"#222222",gray:"#d2d6de"},screenSizes:{xs:480,sm:768,md:992,lg:1200}},_init:function(){"use strict";return $.LayoutManager.layout={activate:function(){var e=this;e.fix(),e.fixSidebar(),$(window,".wrapper").resize(function(){e.fix(),e.fixSidebar()})},fix:function(){var e=$(".main-header").outerHeight()+$(".main-footer").outerHeight(),t=$(window).height(),r=$(".sidebar").height();if($("body").hasClass("fixed"))$(".content-wrapper, .right-side").css("min-height",t-$(".main-footer").outerHeight()),$(".content-wrapper, .right-side").css("height",t-$(".main-footer").outerHeight());else{var n=void 0;t>=r?($(".content-wrapper, .right-side").css("min-height",t-e),n=t-e):($(".content-wrapper, .right-side").css("min-height",r),n=r);var i=$($.LayoutManager.options.controlSidebarOptions.selector);"undefined"!=typeof i&&i.height()>n&&$(".content-wrapper, .right-side").css("min-height",i.height())}},fixSidebar:function(){return $("body").hasClass("fixed")?("undefined"==typeof $.fn.slimScroll&&window.console&&window.console.error("Error: the fixed layout requires the slimscroll plugin!"),void($.LayoutManager.options.sidebarSlimScroll&&!isMobile.any?"undefined"!=typeof $.fn.slimScroll&&($("#g3w-sidebar").slimScroll({destroy:!0}).height("auto"),$("#g3w-sidebar").slimScroll({touchScrollStep:50,height:$(window).height()-$(".navbar-header").height()-10+"px",color:"rgba(255,255,255,0.7)",size:"3px"})):($(".sidebar").css({height:$(window).height()-$(".navbar-header").height()+"px"}),$(".sidebar").css("overflow-y","auto")))):void("undefined"!=typeof $.fn.slimScroll&&$(".sidebar").slimScroll({destroy:!0}).height("auto"))}},$.LayoutManager.pushMenu={activate:function(e){var t=$.LayoutManager.options.screenSizes;$(e).on("click",function(e){e.preventDefault(),$(window).width()>t.sm-1?$("body").hasClass("sidebar-collapse")?$("body").removeClass("sidebar-collapse").trigger("expanded.pushMenu"):$("body").addClass("sidebar-collapse").trigger("collapsed.pushMenu"):$("body").hasClass("sidebar-open")?$("body").removeClass("sidebar-open").removeClass("sidebar-collapse").trigger("collapsed.pushMenu"):$("body").addClass("sidebar-open").trigger("expanded.pushMenu")}),($.LayoutManager.options.sidebarExpandOnHover||$("body").hasClass("fixed")&&$("body").hasClass("sidebar-mini"))&&this.expandOnHover()},expandOnHover:function(){var e=this,t=$.LayoutManager.options.screenSizes.sm-1;$(".main-sidebar").hover(function(){$("body").hasClass("sidebar-mini")&&$("body").hasClass("sidebar-collapse")&&$(window).width()>t&&e.expand()},function(){$("body").hasClass("sidebar-mini")&&$("body").hasClass("sidebar-expanded-on-hover")&&$(window).width()>t&&e.collapse()})},expand:function(){$("body").removeClass("sidebar-collapse").addClass("sidebar-expanded-on-hover")},collapse:function(){$("body").hasClass("sidebar-expanded-on-hover")&&$("body").removeClass("sidebar-expanded-on-hover").addClass("sidebar-collapse")}},$.LayoutManager.tree=function(e){var t=this,r=$.LayoutManager.options.animationSpeed;$(document).on("click",e+" li a",function(e){var n=$(this),i=n.next();if(i.is(".treeview-menu")&&i.is(":visible"))i.slideUp(r,function(){i.parent("li.treeview").removeClass("active"),i.removeClass("menu-open")});else if(i.is(".treeview-menu")&&!i.is(":visible")){var a,o=n.parents("ul").first(),s=n.parent("li"),l=s.siblings(),u=(o.height()-o.find("li.header").outerHeight(),s.outerHeight());l.not(".header").each(function(e,t){u+=$(t).find("a").outerHeight()});var c=o.find("ul.treeview-menu:visible").slideUp(r);c.removeClass("menu-open"),i.slideDown(r,function(){i.addClass("menu-open"),a=o.find("li.treeview.active"),a.removeClass("active"),s.addClass("active"),t.layout.fix()})}i.is(".treeview-menu")&&e.preventDefault()})},$.LayoutManager.floatBar=$.LayoutManager.controlSidebar={activate:function(){var e=this,t=$.LayoutManager.options.controlSidebarOptions,r=$(t.selector),n=$(t.toggleBtnSelector);n.on("click",function(n){n.preventDefault(),r.hasClass("control-sidebar-open")||$("body").hasClass("control-sidebar-open")?e.close(r,t.slide):e.open(r,t.slide)});var i=$(".control-sidebar-bg");e._fix(i),$("body").hasClass("fixed")?e._fixForFixed(r):$(".content-wrapper, .right-side").height()<r.height()&&e._fixForContent(r)},open:function(e,t){t?e.addClass("control-sidebar-open"):$("body").addClass("control-sidebar-open")},close:function(e,t){t?e.removeClass("control-sidebar-open"):$("body").removeClass("control-sidebar-open")},_fix:function(e){var t=this;$("body").hasClass("layout-boxed")?(e.css("position","absolute"),e.height($(".wrapper").height()),$(window).resize(function(){t._fix(e)})):e.css({position:"fixed",height:"auto"})},_fixForFixed:function(e){e.css({position:"fixed","max-height":"100%","padding-bottom":"50px"})},_fixForContent:function(e){$(".content-wrapper, .right-side").css("min-height",e.height())}},$.LayoutManager.boxWidget={selectors:$.LayoutManager.options.boxWidgetOptions.boxWidgetSelectors,icons:$.LayoutManager.options.boxWidgetOptions.boxWidgetIcons,animationSpeed:$.LayoutManager.options.animationSpeed,activate:function(e){var t=this;e||(e=document),$(e).on("click",t.selectors.collapse,function(e){e.preventDefault(),t.collapse($(this))}),$(e).on("click",t.selectors.remove,function(e){e.preventDefault(),t.remove($(this))})},collapse:function(e){var t=this,r=e.parents(".box").first(),n=r.find("> .box-body, > .box-footer, > form  >.box-body, > form > .box-footer");r.hasClass("collapsed-box")?(e.find(".btn-collapser").removeClass(t.icons.open).addClass(t.icons.collapse),n.slideDown(t.animationSpeed,function(){r.removeClass("collapsed-box")})):(e.find(".btn-collapser").removeClass(t.icons.collapse).addClass(t.icons.open),n.slideUp(t.animationSpeed,function(){r.addClass("collapsed-box")}))},remove:function(e){var t=e.parents(".box").first();t.slideUp(this.animationSpeed)}},$.LayoutManager},addRefreshButton:function(){"use strict";return $.fn.boxRefresh=function(e){function t(e){e.append(i),n.onLoadStart.call(e)}function r(e){e.find(i).remove(),n.onLoadDone.call(e)}var n=$.extend({trigger:".refresh-btn",source:"",onLoadStart:function(e){return e},onLoadDone:function(e){return e}},e),i=$('<div class="overlay"><div class="fa fa-refresh fa-spin"></div></div>');return this.each(function(){if(""===n.source)return void(window.console&&window.console.log("Please specify a source first - boxRefresh()"));var e=$(this),i=e.find(n.trigger).first();i.on("click",function(i){i.preventDefault(),t(e),e.find(".box-body").load(n.source,function(){r(e)})})})},$.LayoutManager},activateBox:function(){"use strict";return $.fn.activateBox=function(){$.LayoutManager.boxWidget.activate(this)},$.LayoutManager},listCustomPlugin:function(){"use strict";return $.fn.todolist=function(e){var t=$.extend({onCheck:function(e){return e},onUncheck:function(e){return e}},e);return this.each(function(){"undefined"!=typeof $.fn.iCheck?($("input",this).on("ifChecked",function(){var e=$(this).parents("li").first();e.toggleClass("done"),t.onCheck.call(e)}),$("input",this).on("ifUnchecked",function(){var e=$(this).parents("li").first();e.toggleClass("done"),t.onUncheck.call(e)})):$("input",this).on("change",function(){var e=$(this).parents("li").first();e.toggleClass("done"),$("input",e).is(":checked")?t.onCheck.call(e):t.onUncheck.call(e)})})},$.LayoutManager},setup:function(){"use strict";$("body").removeClass("hold-transition"),"undefined"!=typeof LayoutManagerOptions&&$.extend(!0,$.LayoutManager.options,LayoutManagerOptions);var e=$.LayoutManager.options;return $.LayoutManager._init(),$.LayoutManager.layout.activate(),$.LayoutManager.tree(".sidebar"),e.enableControlSidebar&&$.LayoutManager.controlSidebar.activate(),e.navbarMenuSlimscroll&&"undefined"!=typeof $.fn.slimscroll&&$(".navbar .menu").slimscroll({height:e.navbarMenuHeight,alwaysVisible:!1,size:e.navbarMenuSlimscrollWidth}).css("width","100%"),e.sidebarPushMenu&&$.LayoutManager.pushMenu.activate(e.sidebarToggleSelector),e.enableBoxWidget&&$.LayoutManager.boxWidget.activate(),e.enableFastclick&&"undefined"!=typeof FastClick&&FastClick.attach(document.body),e.directChat.enable&&$(document).on("click",e.directChat.contactToggleSelector,function(){var e=$(this).parents(".direct-chat").first();e.toggleClass("direct-chat-contacts-open")}),$('.btn-group[data-toggle="btn-toggle"]').each(function(){var e=$(this);$(this).find(".btn").on("click",function(t){e.find(".btn.active").removeClass("active"),$(this).addClass("active"),t.preventDefault()})}),$.LayoutManager.addRefreshButton().activateBox().listCustomPlugin()},loading:function(e){$("#initerror").remove(),e=!_.isBoolean(e)||e,e?$("body").append('\n          <div id="startingspinner">\n          <div class="double-bounce1"></div>\n          <div class="double-bounce2"></div>\n          </div>'):$("#startingspinner").remove()}};var S=$.LayoutManager;r["default"]={name:"app",mixins:[g.resizeMixin],data:function(){return{customcredits:!1,appState:p["default"].getState(),current_custom_modal_content:null,language:null,cookie_law_buttonText:x("cookie_law.buttonText")}},components:{HeaderItem:u["default"],CookieLaw:s["default"]},computed:{app:function(){return this.appState.gui.app},languages:function L(){var L=Array.isArray(this.appconfig.i18n)&&this.appconfig.i18n||[];return L.length>1&&L},currentProject:function(){return d["default"].getCurrentProject()},appconfig:function(){return p["default"].getConfig()},isIframe:function(){return!!this.appconfig.group.layout.iframe},urls:function(){return this.appconfig.urls},staticurl:function(){return this.urls.staticurl},powered_by:function(){return this.appconfig.group.powered_by},clienturl:function(){return this.urls.clienturl},g3w_suite_logo:function(){return this.clienturl+"images/g3wsuite_logo.png"},credits_logo:function(){return this.clienturl+"images/logo_gis3w_156_85.png"},logo_url:function(){var e=this.currentProject.getThumbnail();return e?e:""+this.appconfig.mediaurl+this.appconfig.logo_img},logo_link:function C(){var C=this.getLogoLink();return C?C:"#"},logo_link_target:function(){var e=this.getLogoLink();return e?"_blank":""},project_title:function(){return this.currentProject.getState().name},user:function(){return this.appconfig.user&&this.appconfig.user.username?this.appconfig.user:null},login_url:function(){return this.appconfig.user.login_url},numberOfProjectsInGroup:function(){return this.appconfig.projects.length},hasRelatedMaps:function(){return this.appconfig.macrogroups.length+this.appconfig.groups.length+this.appconfig.projects.length>1},frontendurl:function(){return this.urls.frontendurl},main_title:function k(){var k=this.appconfig.main_map_title,e=this.appconfig.group.name||this.appconfig.group.slug;return k?k+" - "+e:e}},methods:{templateResultLanguages:function(e){return e.id?$('\n        <div style="font-weight: bold; display:flex; align-items: center; justify-content: space-around;">\n          <img src="'+this.staticurl+"img/flags/"+e.element.value.toLowerCase()+'.png" />\n          <span style="margin-left: 5px;">'+e.text+"</span> \n        </span>"):e.text},resize:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function r(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isIframe){t.next=5;break}return t.next=3,this.$nextTick();case 3:e=this.$refs.navbar_toggle.offsetWidth>0?this.$refs.navbar.offsetWidth-this.$refs.navbar_toggle.offsetWidth:this.$refs.mainnavbar.offsetWidth-this.$refs["app-navbar-nav"].offsetWidth,this.$refs.main_title_project_title.style.maxWidth=e-this.logoWidth-15+"px";case 5:case"end":return t.stop()}},r,this)}));return e}(),showCustomModalContent:function(e){var t=this.custom_modals.find(function(t){return t.id===e}),r=t.content;this.current_custom_modal_content=r},closePanel:function(){sidebarService.closePanel()},getLogoLink:function(){return this.appconfig.logo_link?this.appconfig.logo_link:null},openProjectsMenu:function(){v["default"].openProjectsMenu()},initDialogMessages:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function r(){var e,t,i,o,s,l=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(e=this.currentProject.getMessages()){r.next=3;break}return r.abrupt("return");case 3:t=this.currentProject.getId(),i=regeneratorRuntime.mark(function u(r){var i,o,s,c;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(i=e.items[r],o=p["default"].getLocalItem(m.LOCAL_ITEM_IDS.MESSAGES.id)||m.LOCAL_ITEM_IDS.MESSAGES.value,void 0===o[t]&&(o[t]=[]),void 0===o[t].find(function(e){return e===i.id})){l.next=5;break}return l.abrupt("return","continue");case 5:return s=new(Vue.extend({data:function(){return{id:b(),checked:!1}},template:'\n            <div style="display: flex; margin-top: 10px;">\n              <input :id="id"\n                v-model="checked"\n                class="magic-checkbox"\n                type="checkbox"/>\n              <label :for="id" v-t="\'dont_show_again\'"/>\n            </div>\n          '})),c=document.createElement("div"),c.append.apply(c,n((new DOMParser).parseFromString(i.body,"text/html").body.childNodes)),c.append(s.$mount().$el),l.next=11,new Promise(function(r){v["default"].showModalDialog({title:i.title,message:c,size:"large",closeButton:!1,className:"g3w-modal-project-message "+Object.entries(e.levels).find(function(e){var t=a(e,2),r=(t[0],t[1]);return r===i.level})[0],buttons:{close:{label:x("close"),className:"btn-secondary",callback:function(){s.checked&&(o[t].push(i.id),p["default"].setLocalItem({id:m.LOCAL_ITEM_IDS.MESSAGES.id,data:o})),r()}}}})});case 11:case"end":return l.stop()}},u,l)}),o=0;case 6:if(!(o<e.items.length)){r.next=14;break}return r.delegateYield(i(o),"t0",8);case 8:if(s=r.t0,"continue"!==s){r.next=11;break}return r.abrupt("continue",11);case 11:o++,r.next=6;break;case 14:case"end":return r.stop()}},r,this)}));return e}(),openChangeMapMenu:function(){v["default"].openChangeMapMenu()}},watch:{language:function(e,t){t&&(p["default"].changeLanguage(e),this.cookie_law_buttonText=x("cookie_law.buttonText"))}},beforeCreate:function(){this.delayType="debounce",this.delayTime=0},created:function(){var e=this;this.language=this.appconfig._i18n.language,this.custom_modals=[],this.custom_header_items_position={0:[],1:[],2:[],3:[],4:[]},this.customlinks=Array.isArray(this.appconfig.header_custom_links)?this.appconfig.header_custom_links.filter(function(t){if(null!==t){var r=t.id=b();"modal"===t.type&&e.custom_modals.push({id:r,content:t.content});var n=1*(t.position||0);return n=n>4?4:n<0||Number.isNaN(n)?0:n,e.custom_header_items_position[n].push(t),!0}return!1}):[],!!this.appconfig.credits&&$.get(this.appconfig.credits).then(function(t){return e.customcredits="None"!==t&&t})},mounted:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function r(){var e,t,n,i,a=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=function(){$(S.options.controlSidebarOptions.selector).css("max-height",$(window).innerHeight()),$(".g3w-sidebarpanel").css("height",$(window).height()-$("#main-navbar").height())},this.initDialogMessages(),this.logoWidth=0,r.next=5,this.$nextTick();case 5:for(e=this.isIframe?[]:this.$refs.mainnavbar.getElementsByTagName("ul"),t=e.length,this.rightNavbarWidth=15,n=0;n<t;n++)this.rightNavbarWidth+=e.item(n).offsetWidth;return this.language=this.appconfig.user.i18n,r.next=12,this.$nextTick();case 12:this.isIframe||this.$refs.img_logo.addEventListener("load",function(){a.logoWidth=a.$refs.img_logo.offsetWidth+15,a.resize()},{once:!0}),S.loading(!1),S.setup(),S.pushMenu.expandOnHover(),S.controlSidebar._fix($(".control-sidebar-bg")),S.controlSidebar._fix($(".control-sidebar")),i(),$(window).resize(function(){i(),$("#g3w-modal-overlay").css("height",$(window).height())});case 20:case"end":return r.stop()}},r,this)}));return e}()}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.app.disabled,expression:"app.disabled"}],staticClass:"wrapper"},[r("cookie-law",{attrs:{theme:"dark-lime",buttonText:e.cookie_law_buttonText}},[r("div",{directives:[{name:"t",rawName:"v-t",value:"cookie_law.message",expression:"'cookie_law.message'"}],attrs:{slot:"message"},slot:"message"})]),e._v(" "),e.isIframe?e._e():r("header",{staticClass:"main-header"},[r("nav",{ref:"navbar",staticClass:"navbar navbar-inverse navbar-fixed-top",attrs:{role:"navigation"}},[r("div",{staticClass:"container-fluid"},[r("div",{staticClass:"navbar-header"},[r("button",{ref:"navbar_toggle",staticClass:"navbar-toggle",attrs:{type:"button","data-toggle":"collapse","data-target":"#main-navbar"}},[r("i",{"class":e.g3wtemplate.getFontClass("ellips-v"),staticStyle:{"font-size":"1.3em"}})]),e._v(" "),r("a",{staticClass:"sidebar-toggle",attrs:{id:"g3w-small-screen-hamburger-sidebar",href:"#","data-toggle":"offcanvas",role:"button"}},[r("i",{"class":e.g3wtemplate.getFontClass("bars"),staticStyle:{"font-size":"1.3em"}})]),e._v(" "),r("div",{staticClass:"logo-wrapper","class":{mobile:e.isMobile()}},[e.logo_url?r("a",{staticClass:"project_logo_link",attrs:{href:e.logo_link,target:e.logo_link_target}},[r("img",{ref:"img_logo",staticClass:"img-responsive",staticStyle:{"max-width":"250px"},attrs:{src:e.logo_url}})]):e._e(),e._v(" "),r("div",{ref:"main_title_project_title",staticClass:"project_title_content"},[r("div",{staticClass:"main_title"},[e._v(e._s(e.main_title))]),e._v(" "),r("div",{staticClass:"sub_title"},[e._v(e._s(e.project_title))])])])]),e._v(" "),r("div",{ref:"mainnavbar",staticClass:"collapse navbar-collapse",staticStyle:{"text-align":"center",overflow:"hidden",margin:"0 0"},attrs:{id:"main-navbar"}},[r("navbarleftitems"),e._v(" "),r("navbarrightitems"),e._v(" "),r("ul",{ref:"app-navbar-nav",staticClass:"nav navbar-nav navbar-right app-navbar-nav"},[e.user?e._e():r("li",{staticClass:"dropdown user user-menu"},[r("a",{attrs:{href:e.login_url}},[r("i",{"class":e.g3wtemplate.getFontClass("sign-in"),attrs:{"aria-hidden":"true"}}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sign_in",expression:"'sign_in'"}]})])]),e._v(" "),e._l(e.custom_header_items_position[0],function(t){return r("header-item",{key:t.id,attrs:{state:t},on:{"show-custom-modal-content":e.showCustomModalContent}})}),e._v(" "),e.hasRelatedMaps?r("li",{staticClass:"dropdown user",attrs:{id:"changemaps"}},[r("a",{staticClass:"dropdown-toggle",attrs:{href:"#","data-toggle":"dropdown"},on:{click:e.openChangeMapMenu}},[r("i",{"class":e.g3wtemplate.getFontClass("change-map"),
attrs:{"aria-hidden":"true"}}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"changemap",expression:"'changemap'"}]})])]):e._e(),e._v(" "),e._l(e.custom_header_items_position[1],function(t){return r("header-item",{key:t.id,attrs:{state:t},on:{"show-custom-modal-content":e.showCustomModalContent}})}),e._v(" "),e.user?r("li",{staticClass:"dropdown user user-menu"},[r("a",{staticClass:"dropdown-toggle",attrs:{href:"#","data-toggle":"dropdown"}},[r("i",{"class":e.g3wtemplate.getFontClass("user")}),e._v(" "),r("span",{staticClass:"hidden-xs"},[e._v(e._s(e.user.username))])]),e._v(" "),r("ul",{staticClass:"dropdown-menu"},[r("li",{staticClass:"user-header"},[r("p",[e._v("\n                    "+e._s(e.user.first_name)+" "+e._s(e.user.last_name)+"\n                  ")])]),e._v(" "),r("li",{staticClass:"user-footer"},[e.user.admin_url?r("div",{staticClass:"pull-left"},[r("a",{staticClass:"btn btn-default btn-flat skin-color bold",attrs:{href:e.user.admin_url}},[r("i",{"class":e.g3wtemplate.getFontClass("folder")}),e._v(" Admin\n                    ")])]):e._e(),e._v(" "),r("div",{staticClass:"pull-right"},[r("a",{directives:[{name:"t",rawName:"v-t",value:"logout",expression:"'logout'"}],staticClass:"btn btn-default btn-flat skin-color bold",attrs:{href:e.user.logout_url}},[r("i",{"class":e.g3wtemplate.getFontClass("sign-out"),staticStyle:{"margin-right":"2px"}})])])])])]):e._e(),e._v(" "),e._l(e.custom_header_items_position[2],function(t){return r("header-item",{key:t.id,attrs:{state:t},on:{"show-custom-modal-content":e.showCustomModalContent}})}),e._v(" "),r("li",{staticClass:"dropdown user user-menu"},[r("a",{staticClass:"dropdown-toggle",attrs:{href:"#","data-toggle":"modal","data-target":"#credits"}},[r("i",{"class":e.g3wtemplate.getFontClass("credits"),attrs:{"aria-hidden":"true"}}),e._v(" "),r("span",[e._v("Credits")])])]),e._v(" "),e._l(e.custom_header_items_position[3],function(t){return r("header-item",{key:t.id,attrs:{state:t},on:{"show-custom-modal-content":e.showCustomModalContent}})}),e._v(" "),e.languages?r("li",{staticClass:"g3w-languages"},[r("select",{directives:[{name:"select2",rawName:"v-select2",value:"language",expression:"'language'"},{name:"model",rawName:"v-model",value:e.language,expression:"language"}],staticClass:"form-control",staticStyle:{cursor:"pointer",width:"130px"},attrs:{templateSelection:e.templateResultLanguages,templateResult:e.templateResultLanguages},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.language=t.target.multiple?r:r[0]}}},e._l(e.languages,function(t){return r("option",{key:t[0],domProps:{value:t[0],selected:t[0]===e.language&&"selected"}},[e._v("\n                  "+e._s(t[1])+"\n                ")])}),0)]):e._e(),e._v(" "),e.frontendurl?r("li",{staticClass:"dropdown"},[r("a",{attrs:{href:e.frontendurl}},[r("span",[r("i",{"class":e.g3wtemplate.getFontClass("home")}),e._v(" Home")])])]):e._e(),e._v(" "),e._l(e.custom_header_items_position[4],function(t){return r("header-item",{key:t.id,attrs:{state:t},on:{"show-custom-modal-content":e.showCustomModalContent}})})],2)],1)])])]),e._v(" "),r("sidebar"),e._v(" "),r("div",{staticClass:"content-wrapper",style:{paddingTop:e.isIframe?0:null}},[r("viewport",{attrs:{appState:e.appState}})],1),e._v(" "),r("floatbar"),e._v(" "),r("div",{staticClass:"control-sidebar-bg"}),e._v(" "),r("div",{staticClass:"modal fade modal-fullscreen force-fullscreen",attrs:{id:"full-screen-modal",tabindex:"-1",role:"dialog","data-backdrop":"static","data-keyboard":"false","aria-labelledby":"full-screen-modal","aria-hidden":"true"}}),e._v(" "),r("div",{staticClass:"modal fade",attrs:{id:"credits"}},[r("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[r("div",{staticClass:"modal-content"},[r("div",{staticClass:"modal-header"},[e._m(0),e._v(" "),r("div",{staticStyle:{display:"flex","flex-direction":"column","justify-content":"space-around","justify-items":"center","align-items":"center"}},[e.customcredits?r("div",{staticClass:"customcredits",domProps:{innerHTML:e._s(e.customcredits)}}):e._e(),e._v(" "),e.powered_by?r("div",[r("div",{staticClass:"g3w-credits-block"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"credits.g3wSuiteFramework",expression:"'credits.g3wSuiteFramework'"}],staticClass:"credit-title-logo",staticStyle:{"background-color":"#95ad36",padding:"5px","border-radius":"3px",color:"#ffffff"}}),e._v(" "),r("a",{attrs:{target:"_blank",href:"https://g3wsuite.it/"}},[r("img",{staticClass:"g3w-suite-logo",attrs:{src:e.g3w_suite_logo,alt:""}})]),e._v(" "),r("div",{directives:[{name:"t",rawName:"v-t",value:"credits.g3wSuiteDescription",expression:"'credits.g3wSuiteDescription'"}],staticStyle:{"margin-top":"10px"}})]),e._v(" "),r("div",{directives:[{name:"t",rawName:"v-t:pre",value:"credits.productOf",expression:"'credits.productOf'",arg:"pre"}],staticClass:"credit-title-logo g3w-credits-block",staticStyle:{"font-size":"1em",display:"flex","justify-content":"center"}},[r("a",{staticStyle:{"text-align":"center!important"},attrs:{href:"http://www.gis3w.it",target:"_blank"}},[r("img",{staticClass:"img-responsive center-block",staticStyle:{"margin-left":"5px"},attrs:{width:"60",src:e.credits_logo,alt:""}})])]),e._v(" "),r("address",{staticStyle:{"line-height":"1.3","text-align":"center","margin-top":"5px",display:"flex","justify-content":"center"},attrs:{id:"address-credits"}},[r("span",{staticStyle:{padding:"2px"}},[r("span",{"class":e.g3wtemplate.getFontClass("marker"),staticStyle:{color:"#95ad36","font-weight":"bold"},attrs:{"aria-hidden":"true"}}),e._v(" Montecatini Terme - Italy\n                ")]),e._v(" "),r("span",{staticStyle:{padding:"2px"}},[r("span",{"class":e.g3wtemplate.getFontClass("mobile"),staticStyle:{color:"#95ad36"},attrs:{"aria-hidden":"true"}}),e._v("  +39 393 8534336\n                ")]),e._v(" "),r("span",{staticStyle:{padding:"2px"}},[r("span",{"class":e.g3wtemplate.getFontClass("mail"),staticStyle:{color:"#95ad36"},attrs:{"aria-hidden":"true"}}),e._v(" "),r("a",{staticStyle:{color:"#000000"},attrs:{href:"mailto:info@gis3w.it"}},[e._v(" info@gis3w.it")])])])]):e._e()])])])])]),e._v(" "),r("div",{staticClass:"modal fade",attrs:{id:"custom_modal"}},[r("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[r("div",{staticClass:"modal-content",domProps:{innerHTML:e._s(e.current_custom_modal_content)}})])])],1)},n.staticRenderFns=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("button",{staticClass:"close",staticStyle:{color:"#ffffff","font-weight":"bold",opacity:"1",position:"absolute",right:"25px",top:"20px"},attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[r("span",{attrs:{"aria-hidden":"true"}},[e._v("×")])])}]},{"components/HeaderItem.vue":233,constant:4,"core/i18n/i18n.service":13,"core/utils/utils":68,mixins:343,"services/application":351,"services/gui":361,"store/projects":379,"vue-cookie-law":"vue-cookie-law"}],195:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("services/gui"),s=t(o),l=e("core/utils/utils"),u=l.getUniqueDomId;r["default"]={name:"c3xyline",props:{showdata:{type:Boolean,"default":!0}},data:function(){return{id:"graphline"+u(),selectitems:[],data:[],components:[],config:{data:{columns:[["x"],["y"]]}},size:{width:0,height:0}}},methods:{addComponent:function(e){this.components.push(e)},addComponents:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach(function(t){return e.addComponent(t)})},setConfig:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config=e},setDataOffset:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.getData(),n=0;n<r.length;n++){var i=r[n];i.value+=e}t&&this.resize()},getSelectedItems:function(){return this.selectitems},selectItem:function(e){this.chart.select(["y"],[e])},unselectItem:function(e){this.chart.unselect(["y"],[e])},selectItems:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.chart.select([y],e)},unselectItems:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.chart.unselect(["y"],e)},unselectAll:function(){this.chart.unselect()},selectAll:function(){this.chart.select()},getData:function(){return this.data},resize:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.width,n=e.height;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.chart.resize({width:t,height:n||$("#"+this.id).height()-4});case 3:case"end":return e.stop()}},r,this)}));return e}(),_setAllowedSpace:function(){this.components&&this.components.length&&(this.size.height=document.querySelector(".g3wform_content").offsetHeight-this.$el.offsetHeight-document.querySelector(".g3wform_header").offsetHeight-50)},_setMaxMin:function(e){var t=e.value,r=e.max,i=e.min;if(i=t?+t:+i,r=t?+t:+r,i<this.chart.axis.min().y)this.chart.axis.min(i);else if(r>this.chart.axis.max().y)this.chart.axis.max(r);else{var a=this.data.map(function(e){return+e.value});this.chart.axis.max(Math.max.apply(Math,n(a))),this.chart.axis.min(Math.min.apply(Math,n(a)))}this.resize()},changeItems:function(e){if(1===e.length)this._setMaxMin(e[0].value);else{var t=Math.max.apply(Math,n(e.map(function(e){return+e.value}))),r=Math.min.apply(Math,n(e.map(function(e){return+e.value})));this._setMaxMin({max:t,min:r})}this.resize()},changeItem:function(e){var t=e.item,r=e.render,n=void 0===r||r,i=t.value;this._setMaxMin({value:i}),n&&this.resize()}},mounted:function(){var e=this;this.$nextTick(function(){s["default"].on("resize",e.resize);var t=e;e.config.data.onselected=function(e){var r=[].concat(n(t.selectitems),[e]);t.selectitems=r},e.config.data.onunselected=function(e){t.selectitems=t.selectitems.filter(function(t){return t.index!==e.index})},e.chart=c3.generate(a({bindto:"#"+e.id},e.config));var r=e.chart.data()[0]?e.chart.data()[0].values:[];r.forEach(function(t){e.data.push(t)}),e._setAllowedSpace(),e.$emit("chart-ready",e.chart)})},beforeDestroy:function(){this.data=this.selectitems=null,this.chart.destroy(),this.chart=null,s["default"].off("resize",this.resize)}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"chart_wrapper",staticStyle:{height:"100%",width:"100%"}},[r("div",{staticStyle:{height:"100%","min-height":"200px","background-color":"#ffffff"},attrs:{id:e.id}}),e._v(" "),e._l(e.components,function(t){return r("div",[r("span",{staticClass:"divider"}),e._v(" "),r(t,{tag:"component",attrs:{data:e.data,selectitems:e.selectitems,size:e.size},on:{"change-item":e.changeItem,"change-items":e.changeItems,"select-item":e.selectItem,"select-all":e.selectAll,"unselect-all":e.unselectAll,"unselect-item":e.unselectItem}})],1)})],2)},n.staticRenderFns=[]},{"core/utils/utils":68,"services/gui":361}],196:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("app/constant"),a=e("gui/catalog/vue/catalogeventhub"),o=t(a),s=e("components/CatalogChangeMapThemes.vue"),l=t(s),u=e("components/CatalogLayerContextMenu.vue"),c=t(u),d=e("store/catalog-layers"),f=t(d),p=e("services/application"),h=t(p),v=e("store/map-controls"),g=t(v),m=e("services/gui"),y=t(m),_="layers";r["default"]={name:"catalog",data:function(){return this.$options.legend.place=h["default"].getCurrentProject().getLegendPosition()||"tab",{state:null,legend:this.$options.legend,showlegend:!1,currentBaseLayer:null,activeTab:null,loading:!1}},components:{changemapthemes:l["default"],cataloglayercontextmenu:c["default"]},computed:{showTocTools:function(){var e=this.project.state.map_themes,t=void 0===e?[]:e;return t.length>1},project:function(){return this.state.prstate.currentProject},title:function(){return this.project.state.name},baselayers:function(){return this.project.state.baselayers},hasBaseLayers:function(){return this.project.state.baselayers.length>0},hasLayers:function(){var e=0;return this.state.layerstrees.forEach(function(t){return e+=t.tree.length}),this.state.external.vector.length>0||e>0||this.state.layersgroups.length>0}},methods:{changeMapTheme:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){var t,n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return y["default"].closeContent(),r.next=3,this.$options.service.changeMapTheme(e);case 3:t=r.sent,n=Object.keys(t.layers).filter(function(e){if(t.layers[e].style){if(!t.layers[e].visible){var r=f["default"].getLayerById(e);r.clearCategories(),r.change()}return!0}}),"tab"===this.legend.place?o["default"].$emit("layer-change-style"):n.forEach(function(e){o["default"].$emit("layer-change-style",{layerId:e})});case 6:case"end":return r.stop()}},r,this)}));return e}(),delegationClickEventTab:function(e){this.activeTab=e.target.attributes["aria-controls"]?e.target.attributes["aria-controls"].value:this.activeTab},showLegend:function(e){this.showlegend=e},setBaseLayer:function(e){this.currentBaseLayer=e,this.project.setBaseLayer(e),h["default"].setBaseLayerId(e)},getSrcBaseLayerImage:function(e){var t=void 0,r=!1;switch(e&&e.servertype||e){case"OSM":t="osm.png";break;case"Bing":var n=e.source.subtype;t="bing"+n+".png";break;case"TMS":case"WMTS":if(e.icon){r=!0,t=e.icon;break}default:t="nobaselayer.png"}return r?t:y["default"].getResourcesUrl()+"images/"+t}},watch:{"state.external.wms":function(e,t){t&&0===e.length&&(this.activeTab=this.project.state.catalog_tab||_)},"state.prstate.currentProject":{handler:function(){function e(e,r){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e,t){var n,i=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state.catalog_tab||_,this.loading="baselayers"===n,t.next=4,this.$nextTick();case 4:setTimeout(function(){i.loading=!1,i.activeTab=n},"baselayers"===n?500:0);case 5:case"end":return t.stop()}},r,this)}));return e}(),immediate:!1}},created:function(){var e=this;this.layerpositions=i.MAP_SETTINGS.LAYER_POSITIONS.getPositions(),o["default"].$on("unselectionlayer",function(e,t){t.external?y["default"].getService("queryresults").clearSelectionExtenalLayer(t):f["default"].getLayersStore(e).getLayerById(t.id).clearSelectionFids()}),o["default"].$on("activefiltertokenlayer",function(){var t=n(regeneratorRuntime.mark(function r(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f["default"].getLayersStore(t).getLayerById(n.id).toggleFilterToken();case 2:n.filter.active=e.sent;case 3:case"end":return e.stop()}},r,e)}));return function(e,r){return t.apply(this,arguments)}}()),o["default"].$on("treenodevisible",function(e){y["default"].getService("map").emit("cataloglayervisible",e)}),o["default"].$on("treenodeselected",function(e,t){var r=f["default"].getLayersStore(e).getLayerById(t.id);r.isSelected()||y["default"].getService("catalog").setSelectedExternalLayer({layer:null,type:"vector",selected:!1}),setTimeout(function(){f["default"].getLayersStore(e).selectLayer(t.id,!r.isSelected()),y["default"].getService("map").emit("cataloglayerselected",r)})}),o["default"].$on("treenodeexternalselected",function(e){y["default"].getService("catalog").setSelectedExternalLayer({layer:e,type:"vector",selected:!e.selected}).then(function(){e.selected&&f["default"].getLayersStores().forEach(function(e){e.selectLayer(null,!1)})})}),g["default"].onafter("registerControl",function(t,r){"querybbox"===t&&r.getInteraction().on("propertychange",function(t){"active"===t.key&&(e.state.highlightlayers=!t.oldValue)})})},beforeMount:function(){this.currentBaseLayer=this.project.state.initbaselayer}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"tabbable-panel catalog",attrs:{id:"catalog"},on:{contextmenu:function(e){e.preventDefault(),e.stopPropagation()}}},[r("div",{staticClass:"tabbable-line"},[r("ul",{staticClass:"nav nav-tabs catalalog-nav-tabs",attrs:{role:"tablist"},on:{"!click":function(t){return e.delegationClickEventTab(t)}}},[e.hasLayers?r("li",{"class":{active:"layers"===e.activeTab&&"hasLayers"},attrs:{role:"presentation"}},[r("a",{directives:[{name:"t",rawName:"v-t",value:"data",expression:"'data'"}],attrs:{href:"#layers","aria-controls":"layers",role:"tab","data-toggle":"tab","data-i18n":"tree"}})]):e._e(),e._v(" "),e.state.external.wms.length?r("li",{"class":{active:"externalwms"===e.activeTab},attrs:{role:"presentation"}},[r("a",{directives:[{name:"t",rawName:"v-t",value:"externalwms",expression:"'externalwms'"}],attrs:{href:"#externalwms","aria-controls":"externalwms",role:"tab","data-toggle":"tab","data-i18n":"externalwms"}})]):e._e(),e._v(" "),e.hasBaseLayers?r("li",{"class":{active:"baselayers"===e.activeTab},attrs:{role:"presentation"}},[r("a",{directives:[{name:"t",rawName:"v-t",value:"baselayers",expression:"'baselayers'"}],attrs:{href:"#baselayers","aria-controls":"baselayers",role:"tab","data-toggle":"tab","data-i18n":"baselayers"}})]):e._e(),e._v(" "),e.showlegend&&"tab"===e.legend.place?r("li",{"class":{active:"legend"===e.activeTab},attrs:{role:"presentation"}},[r("a",{directives:[{name:"t",rawName:"v-t",value:"legend",expression:"'legend'"}],attrs:{href:"#legend","aria-controls":"legend",role:"tab","data-toggle":"tab","data-i18n":"legend"}})]):e._e()]),e._v(" "),r("div",{staticClass:"tab-content catalog-tab-content"},[r("bar-loader",{attrs:{loading:e.loading}}),e._v(" "),r("div",{staticClass:"tab-pane","class":{active:"layers"===e.activeTab&&"hasLayers"},attrs:{role:"tabpanel",id:"layers"}},[r("helpdiv",{attrs:{message:"catalog_items.helptext"}}),e._v(" "),e.showTocTools?r("div",{staticStyle:{margin:"2px"},attrs:{id:"g3w-catalog-toc-layers-toolbar"}},[r("changemapthemes",{key:e.project.state.gid,attrs:{map_themes:e.project.state.map_themes},on:{"change-map-theme":e.changeMapTheme}})],1):e._e(),e._v(" "),e._l(e.state.layerstrees,function(t){return r("ul",{key:t.storeid,staticClass:"tree-root root project-root"},e._l(t.tree,function(n){return r("tristate-tree",{key:n.id,staticClass:"item",attrs:{highlightlayers:e.state.highlightlayers,layerstree:n,parentFolder:!1,root:!0,legendplace:e.legend.place,parent_mutually_exclusive:!1,storeid:t.storeid}})}),1)}),e._v(" "),e.state.external.vector.length?r("ul",{staticClass:"g3w-external_layers-group"},e._l(e.state.external.vector,function(t){return r("tristate-tree",{key:t.id,staticClass:"item",attrs:{externallayers:e.state.external.vector,layerstree:t}})}),1):e._e(),e._v(" "),e._l(e.state.layersgroups,function(e){return r("ul",[r("layers-group",{attrs:{layersgroup:e}})],1)})],2),e._v(" "),e.state.external.wms.length?r("div",{staticClass:"tab-pane","class":{active:"externalwms"===e.activeTab},attrs:{id:"externalwms",role:"tabpanel"}},[r("ul",{staticClass:"g3w-external_wms_layers-group"},e._l(e.state.external.wms,function(t){return r("tristate-tree",{key:t.id,staticClass:"item",attrs:{externallayers:e.state.external.wms,layerstree:t}})}),1)]):e._e(),e._v(" "),e.hasBaseLayers?r("div",{staticClass:"tab-pane baselayers","class":{active:"baselayers"===e.activeTab||!e.hasLayers},attrs:{id:"baselayers",role:"tabpanel"}},[r("ul",{"class":{mobile:e.isMobile()},style:{gridTemplateColumns:"repeat(auto-fill, minmax("+(e.baselayers.length>4?80:120)+"px, 1fr))"},attrs:{id:"baselayers-content"}},[e._l(e.baselayers,function(t){return t.fixed?e._e():r("li",{key:t.title},[r("img",{staticClass:"img-responsive img-thumbnail baselayer",style:{opacity:t.id===e.currentBaseLayer?1:.5},attrs:{src:e.getSrcBaseLayerImage(t)},on:{click:function(r){return r.stopPropagation(),e.setBaseLayer(t.id)}}}),e._v(" "),r("div",{staticClass:"baseselayer-text text-center"},[e._v(e._s(t.title))])])}),e._v(" "),r("li",{on:{click:function(t){return t.stopPropagation(),e.setBaseLayer(null)}}},[r("img",{staticClass:"img-responsive img-thumbnail baselayer",style:{opacity:null===e.currentBaseLayer?1:.5},attrs:{src:e.getSrcBaseLayerImage(null)}}),e._v(" "),r("div",{directives:[{name:"t",rawName:"v-t",value:"nobaselayer",expression:"'nobaselayer'"}],staticClass:"baseselayer-text text-center"})])],2)]):e._e(),e._v(" "),e._l(e.state.layerstrees,function(t){return"tab"===e.legend.place?r("layerslegend",{key:t.id,attrs:{legend:e.legend,active:"legend"===e.activeTab,layerstree:t},on:{showlegend:e.showLegend}}):e._e()})],2)]),e._v(" "),r("cataloglayercontextmenu",{attrs:{external:e.state.external}})],1)},n.staticRenderFns=[]},{"app/constant":4,"components/CatalogChangeMapThemes.vue":197,"components/CatalogLayerContextMenu.vue":198,"gui/catalog/vue/catalogeventhub":114,"services/application":351,"services/gui":361,"store/catalog-layers":374,"store/map-controls":376}],197:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("store/projects"),i=t(n);r["default"]={name:"changemapthemes",data:function(){var e="collapsed"===i["default"].getCurrentProject().state.toc_themes_init_status,t=this.map_themes.find(function(e){return e["default"]});return{current_map_theme:t?t.theme:null,collapsed:e}},props:{map_themes:{type:Array,"default":[]}},watch:{current_map_theme:{immediate:!1,handler:function(e){this.$emit("change-map-theme",e)}}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ul",{staticClass:"sidebar-menu"},[r("li",{staticClass:"treeview sidebaritem skin-border-color",staticStyle:{"margin-bottom":"5px","border-bottom":"2px solid"},attrs:{id:"g3w-catalog-toc-views"}},[r("a",{ref:"g3w-map-theme-ancor",staticStyle:{display:"flex","align-items":"center",padding:"5px 5px 5px 2px"},attrs:{href:"#"}},[r("i",{"class":e.g3wtemplate.getFontClass("caret-down"),staticStyle:{padding:"3px"}}),e._v(" "),r("i",{"class":e.g3wtemplate.getFontClass("eye"),staticStyle:{padding:"0 0 0 4px"}}),e._v(" "),r("span",{directives:[{name:"show",rawName:"v-show",value:e.current_map_theme,expression:"current_map_theme "}],staticClass:"treeview-label g3w-long-text",staticStyle:{overflow:"hidden","white-space":"normal","text-overflow":"ellipsis"}},[r("span",{directives:[{name:"t",rawName:"v-t:pre",value:"sdk.catalog.current_map_theme_prefix",expression:"'sdk.catalog.current_map_theme_prefix'",arg:"pre"}],staticStyle:{color:"#cccccc !important"}},[e._v(":")]),e._v(" "),r("span",{staticClass:"skin-color",staticStyle:{"font-size":"1.1em"}},[e._v(e._s(e.current_map_theme))])]),e._v(" "),r("span",{directives:[{name:"show",rawName:"v-show",value:!e.current_map_theme,expression:"!current_map_theme"}],staticClass:"treeview-label",staticStyle:{color:"#cccccc !important","font-weight":"bold"}},[r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.choose_map_theme",expression:"'sdk.catalog.choose_map_theme'"}]})])]),e._v(" "),r("ul",{staticClass:"treeview-menu","class":{"menu-open":!e.collapsed},style:{display:e.collapsed?"none":"block"},attrs:{id:"g3w-catalog-views"}},[r("li",{staticStyle:{padding:"5px 5px 5px 17px"}},e._l(e.map_themes,function(t,n){return r("div",{key:t.theme},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.current_map_theme,expression:"current_map_theme"}],staticClass:"magic-radio",attrs:{type:"radio",name:"radio",id:"g3w-map_theme-"+n},domProps:{value:t.theme,checked:t["default"],checked:e._q(e.current_map_theme,t.theme)},on:{change:function(r){e.current_map_theme=t.theme}}}),e._v(" "),r("label",{staticStyle:{display:"flex","justify-content":"space-between"},attrs:{"for":"g3w-map_theme-"+n}},[r("span",{staticClass:"g3w-long-text"},[e._v(e._s(t.theme))])])])}),0)])])])},n.staticRenderFns=[]},{"store/projects":379}],198:[function(e,t,r){e("vueify/lib/insert-css").insert("li .item-text[data-v-1e167faf]{font-weight:700}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=e("vue-color"),o=e("components/LayerOpacityPicker.vue"),s=t(o),l=e("gui/catalog/vue/catalogeventhub"),u=t(l),c=e("store/catalog-layers"),d=t(c),f=e("services/application"),p=t(f),h=e("services/gui"),v=t(h),g=e("core/i18n/i18n.service"),m=g.t,y=e("shp-write"),_=e("gui/table/vue/table"),b=e("core/utils/utils"),w=b.downloadFile,x={top:50,left:15};r["default"]={name:"Cataloglayermenu",props:{external:{type:Object}},data:function(){return{layerMenu:{show:!1,top:0,left:0,tooltip:!1,name:"",layer:null,loading:{data_table:!1,shp:!1,csv:!1,gpx:!1,gpkg:!1,xls:!1},colorMenu:{show:!1,top:0,left:0,color:null},stylesMenu:{show:!1,top:0,left:0,style:null,"default":null},metadatainfoMenu:{show:!1,top:0,left:0}}}},components:{"chrome-picker":a.Chrome,"layer-opacity-picker":s["default"]},directives:{"click-outside-layer-menu":{bind:function(e,t,r){this.event=function(n){e===n.target||e.contains(n.target)||(n.stopPropagation(),r.context[t.expression](n))},document.body.addEventListener("click",this.event,!0)},unbind:function(e){document.body.removeEventListener("click",this.event,!0)}}},methods:{addLayerMenuItem:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.layerMenu=i({},this.layerMenu,e)},_hideMenu:function(){this.layerMenu.show=!1,this.layerMenu.styles=!1,this.layerMenu.loading.data_table=!1,this.layerMenu.loading.shp=!1,this.layerMenu.loading.csv=!1,this.layerMenu.loading.gpx=!1,this.layerMenu.loading.gpkg=!1,this.layerMenu.loading.xls=!1,this.layerMenu.loading.geotiff=!1,this.layerMenu.loading.unknow=!1},closeLayerMenu:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._hideMenu(),this.showColorMenu(!1),e.show=!1},onbeforeDestroyChangeColor:function(){this.$refs.color_picker.$off()},onChangeColor:function(e){var t=v["default"].getService("map");this.layerMenu.layer.color=e;var r=t.getLayerByName(this.layerMenu.name),n=r.getStyle();n._g3w_options.color=e,r.setStyle(n)},canShowWmsUrl:function(e){var t=d["default"].getLayerById(e);return!!t&&!(t.isType("table")||!t.getFullWmsUrl())},canShowWfsUrl:function(e){var t=d["default"].getLayerById(e);return t&&!t.isType("table")&&t.isWfsActive()},canDownloadXls:function(e){var t=d["default"].getLayerById(e);return!!t&&t.isXlsDownlodable()},canDownloadGpx:function(e){var t=d["default"].getLayerById(e);return!!t&&t.isGpxDownlodable()},canDownloadGpkg:function(e){var t=d["default"].getLayerById(e);return!!t&&t.isGpkgDownlodable()},canDownloadCsv:function(e){var t=d["default"].getLayerById(e);return!!t&&t.isCsvDownlodable()},canDownloadGeoTIFF:function(e){var t=d["default"].getLayerById(e);return!!t&&t.isGeoTIFFDownlodable()},canDownloadShp:function(e){var t=d["default"].getLayerById(e);return!!t&&t.isShpDownlodable()},getWmsUrl:function(e){var t=d["default"].getLayerById(e);return t.getCatalogWmsUrl()},getWfsUrl:function(e){var t=d["default"].getLayerById(e);return t.getCatalogWfsUrl()},copyUrl:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.evt,n=t.layerId,i=t.type,a=this["get"+i+"Url"](n),o=document.createElement("a");o.href=a;var s=document.createElement("input");s.value=o.href,document.body.appendChild(s),s.select(),document.execCommand("copy"),$(r.target).attr("data-original-title",m("sdk.catalog.menu.wms.copied")).tooltip("show"),$(r.target).attr("title",this.copywmsurltooltip).tooltip("fixTitle"),document.body.removeChild(s),o=null,setTimeout(function(){return e._hideMenu()},600)},downloadGeoTIFF:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=p["default"].setDownload(!0);this.layerMenu.loading.geotiff=!0;var i=d["default"].getLayerById(e);i.getGeoTIFF({data:r?{map_extent:v["default"].getService("map").getMapExtent().toString()}:void 0})["catch"](function(e){return v["default"].notify.error(m("info.server_error"))})["finally"](function(){t.layerMenu.loading.geotiff=!1,p["default"].setDownload(!1,n),t._hideMenu()})},downloadShp:function(e){var t=this,r=p["default"].setDownload(!0);this.layerMenu.loading.shp=!0;var n=d["default"].getLayerById(e);n.getShp()["catch"](function(e){return v["default"].notify.error(m("info.server_error"))})["finally"](function(){t.layerMenu.loading.shp=!1,p["default"].setDownload(!1,r),t._hideMenu()})},downloadCsv:function(e){var t=this,r=p["default"].setDownload(!0);this.layerMenu.loading.csv=!0;var n=d["default"].getLayerById(e);n.getCsv()["catch"](function(e){return v["default"].notify.error(m("info.server_error"))})["finally"](function(){t.layerMenu.loading.csv=!1,p["default"].setDownload(!1,r),t._hideMenu()})},downloadXls:function(e){var t=this,r=p["default"].setDownload(!0);this.layerMenu.loading.xls=!0;var n=d["default"].getLayerById(e);n.getXls()["catch"](function(e){return v["default"].notify.error(m("info.server_error"))})["finally"](function(){t.layerMenu.loading.xls=!1,p["default"].setDownload(!1,r),t._hideMenu()})},downloadGpx:function(e){var t=this,r=p["default"].setDownload(!0);this.layerMenu.loading.gpx=!0;var n=d["default"].getLayerById(e);n.getGpx()["catch"](function(e){return v["default"].notify.error(m("info.server_error"))})["finally"](function(){t.layerMenu.loading.gpx=!1,p["default"].setDownload(!1,r),t._hideMenu()})},downloadGpkg:function(e){var t=this,r=p["default"].setDownload(!0);this.layerMenu.loading.gpkg=!0;var n=d["default"].getLayerById(e);n.getGpkg()["catch"](function(e){return v["default"].notify.error(m("info.server_error"))})["finally"](function(){t.layerMenu.loading.gpkg=!1,p["default"].setDownload(!1,r),t._hideMenu()})},changeLayerMapPosition:function(e){var t=e.position,r=e.layer,n=v["default"].getService("map"),i=r.position!==t;i&&(r.position=t,n.changeLayerMapPosition({id:r.id,position:t}),i&&this._hideMenu())},setWMSOpacity:function(e){var t=e.id,r=void 0===t?this.layerMenu.layer.id:t,n=e.value;this.layerMenu.layer.opacity=n;var i=v["default"].getService("map");i.changeLayerOpacity({id:r,opacity:n})},zoomToLayer:function(e){v["default"].getService("map").goToBBox([e.bbox.minx,e.bbox.miny,e.bbox.maxx,e.bbox.maxy],e.epsg),this._hideMenu()},canZoom:function(e){return e.bbox&&[e.bbox.minx,e.bbox.miny,e.bbox.maxx,e.bbox.maxy].find(function(e){
return e>0})},getGeometryType:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=void 0;if(t){var n=this.external.vector.find(function(t){return t.id===e});n&&(r=n.geometryType)}else{var i=d["default"].getLayerById(e);r=i.config.geometrytype}return r=r&&"NoGeometry"!==r?r:""},downloadExternal:function(e){this.layerMenu.loading.unknow=!0,w({url:e}),this.layerMenu.loading.unknow=!1},downloadExternalShapefile:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){var t,n,i,a,o,s,l;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t="EPSG:4326",this.layerMenu.loading.shp=!0,n=v["default"].getService("map"),i=n.getLayerByName(e.name),a=new ol.format.GeoJSON,o=i.getSource().getFeatures(),e.crs!==t&&(o=o.map(function(r){var n=r.clone();return n.getGeometry().transform(e.crs,t),n})),s=a.writeFeaturesObject(o,{featureProjection:t}),l=e.name.split("."+e.type)[0],y.download(s,{folder:l,types:{point:l,mulipoint:l,polygon:l,multipolygon:l,line:l,polyline:l,multiline:l}}),r.next=12,this.$nextTick();case 12:this.layerMenu.loading.shp=!1,this._hideMenu();case 14:case"end":return r.stop()}},r,this)}));return e}(),showAttributeTable:function(e){var t=this;this.layerMenu.loading.data_table=!1,v["default"].closeContent();var r=d["default"].getLayerById(e);this.layerMenu.loading.data_table=!0;var n=new _({layer:r,formatter:1});n.on("show",function(){t.isMobile()&&v["default"].hideSidebar(),t.layerMenu.loading.data_table=!1,t._hideMenu()}),n.show({title:r.getName()})},startEditing:function(){var e=this,t=void 0,r=d["default"].getLayersStores();r.forEach(function(r){if(t=r.getLayerById(e.layerMenu.layer.id))return t.getLayerForEditing(),!1})},setCurrentLayerStyle:function(e){var t=this,r=!1;if(this.layerMenu.layer.styles.forEach(function(n,i){i===e?(t.layerMenu.stylesMenu.style=n.name,r=!n.current,n.current=!0):n.current=!1}),r){var n=this.layerMenu.layer.id,i=d["default"].getLayerById(this.layerMenu.layer.id);i&&(u["default"].$emit("layer-change-style",{layerId:n,style:this.layerMenu.stylesMenu.style}),i.change())}this.closeLayerMenu(this.layerMenu.stylesMenu)},showSubMenuContext:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){var t,n,i,a,o,s,l=e.menu,u=e.bool,c=e.evt;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!u){e.next=15;break}return t=$(c.target),l.top=t.offset().top,l.left=t.offset().left+t.width()+(t.outerWidth()-t.width())/2+x.left,n=$(this.$refs["layer-menu"]),i=$(c.target),a=i.children("ul"),o=a.height(),s=n.height(),l.maxHeight=o>=s?s:null,l.overflowY=o>=s?"scroll":null,l.top=(o>=s?n:i).offset().top,l.left=this.isMobile()?0:i.offset().left+i.width()+(i.outerWidth()-i.width())/2+x.left,e.next=15,this.$nextTick();case 15:l.show=u;case 16:case"end":return e.stop()}},r,this)}));return e}(),showStylesMenu:function(){function e(e,r){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e,t){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:this.showSubMenuContext({menu:this.layerMenu.stylesMenu,bool:e,evt:t});case 1:case"end":return r.stop()}},r,this)}));return e}(),showMetadataInfo:function(){function e(e,r){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e,t){var n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!e){r.next=6;break}return n=$(t.target),this.layerMenu.metadatainfoMenu.top=n.offset().top,this.layerMenu.metadatainfoMenu.left=n.offset().left+n.width()+(n.outerWidth()-n.width())/2+x.left,r.next=6,this.$nextTick();case 6:this.layerMenu.metadatainfoMenu.show=e;case 7:case"end":return r.stop()}},r,this)}));return e}(),showColorMenu:function(e,t){if(e){var r=$(t.target),n=$(this.$refs["layer-menu"]);this.layerMenu.colorMenu.top=n.offset().top,this.layerMenu.colorMenu.left=r.offset().left+r.width()+(r.outerWidth()-r.width())/2-x.left}this.layerMenu.colorMenu.show=e},getStyleName:function(e){return e.name+(e.name===this.layerMenu.layer.defaultstyle&&this.layerMenu.layer.styles.length>1?" ("+m("default")+")":"")},isExternalWMSLayer:function(e){return!e.projectLayer&&"wms"===e._type},isExternalVectorLayer:function(e){return!e.projectLayer&&"wms"!==e._type},canShowStylesMenu:function(e){return e.geolayer&&e.styles&&e.styles.length>1},hasMetadataInfo:function(e){return e.metadata&&e.metadata["abstract"]},canShowOpacityPicker:function(e){return e.geolayer&&e.visible}},created:function(){var e=this;u["default"].$on("showmenulayer",function(){var t=n(regeneratorRuntime.mark(function r(t,n){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e._hideMenu(),r.next=3,e.$nextTick();case 3:return e.layerMenu.left=n.x,e.layerMenu.name=t.name,e.layerMenu.layer=t,e.layerMenu.show=!0,e.layerMenu.colorMenu.color=t.color,r.next=10,e.$nextTick();case 10:e.layerMenu.top=$(n.target).offset().top-$(e.$refs["layer-menu"]).height()+$(n.target).height()/2,$('.catalog-menu-wms[data-toggle="tooltip"]').tooltip();case 12:case"end":return r.stop()}},r,e)}));return function(e,r){return t.apply(this,arguments)}}())}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.layerMenu.show?r("ul",{directives:[{name:"click-outside-layer-menu",rawName:"v-click-outside-layer-menu",value:e.closeLayerMenu,expression:"closeLayerMenu"}],ref:"layer-menu",style:{top:e.layerMenu.top+"px",left:e.layerMenu.left+"px"},attrs:{id:"layer-menu",tabindex:"-1"}},[r("li",{staticClass:"title"},[r("div",[e._v(e._s(e.layerMenu.layer.title))]),e._v(" "),r("div",{staticStyle:{"font-weight":"normal","font-size":"0.8em"}},[e._v(e._s(e.getGeometryType(e.layerMenu.layer.id,e.layerMenu.layer.external)))])]),e._v(" "),e.layerMenu.layer.projectLayer?e._e():r("li",[r("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"}},[r("layerspositions",{staticStyle:{display:"flex","flex-direction":"column","justify-content":"space-between"},attrs:{position:e.layerMenu.layer.position},on:{"layer-position-change":function(t){return e.changeLayerMapPosition({position:t,layer:e.layerMenu.layer})}}})],1)]),e._v(" "),e.hasMetadataInfo(e.layerMenu.layer)?r("li",{on:{mouseleave:function(t){return t.target!==t.currentTarget?null:e.showMetadataInfo(!1)},mouseover:function(t){return t.target!==t.currentTarget?null:e.showMetadataInfo(!0,t)}}},[r("span",{staticClass:"menu-icon skin-color-dark","class":e.g3wtemplate.getFontClass("info")}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"Metadata",expression:"'Metadata'"}],staticClass:"item-text"}),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.layerMenu.metadatainfoMenu.show,expression:"layerMenu.metadatainfoMenu.show"}],staticStyle:{position:"fixed","background-color":"#FFFFFF",color:"#000000","padding-left":"0","border-radius":"0 3px 3px 0"},style:{top:e.layerMenu.metadatainfoMenu.top+"px",left:e.layerMenu.metadatainfoMenu.left+1+"px"}},[r("div",{staticClass:"layer-menu-metadata-info",staticStyle:{padding:"5px"},domProps:{innerHTML:e._s(e.layerMenu.layer.metadata["abstract"])}})])]):e._e(),e._v(" "),e.canShowStylesMenu(e.layerMenu.layer)?r("li",{staticClass:"menu-icon",on:{mouseleave:function(t){return t.target!==t.currentTarget?null:e.showStylesMenu(!1,t)},mouseover:function(t){return t.target!==t.currentTarget?null:e.showStylesMenu(!0,t)}}},[r("span",{staticClass:"menu-icon skin-color-dark","class":e.g3wtemplate.getFontClass("palette")}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"catalog_items.contextmenu.styles",expression:"'catalog_items.contextmenu.styles'"}],staticClass:"item-text"}),e._v(" "),r("span",{staticClass:"menu-icon","class":e.g3wtemplate.getFontClass("arrow-right"),staticStyle:{position:"absolute",right:"0","margin-top":"3px"}}),e._v(" "),r("ul",{directives:[{name:"show",rawName:"v-show",value:e.layerMenu.stylesMenu.show,expression:"layerMenu.stylesMenu.show"}],staticStyle:{position:"fixed","padding-left":"0","background-color":"#FFFFFF",color:"#000000"},style:{top:e.layerMenu.stylesMenu.top+"px",left:e.layerMenu.stylesMenu.left+"px",maxHeight:e.layerMenu.stylesMenu.maxHeight+"px",overflowY:e.layerMenu.stylesMenu.overflowY}},e._l(e.layerMenu.layer.styles,function(t,n){return r("li",{key:t.name,on:{click:function(t){return t.stopPropagation(),e.setCurrentLayerStyle(n)}}},[t.current?r("span",{"class":e.g3wtemplate.getFontClass("circle"),staticStyle:{"font-size":"0.8em"}}):e._e(),e._v(" "),r("span",[e._v(e._s(e.getStyleName(t)))])])}),0)]):e._e(),e._v(" "),e.canShowOpacityPicker(e.layerMenu.layer)?r("li",{staticClass:"menu-icon",staticStyle:{"padding-right":"0"}},[r("layer-opacity-picker",{attrs:{layer:e.layerMenu.layer},on:{"init-menu-item":e.addLayerMenuItem,"show-menu-item":e.showSubMenuContext}})],1):e._e(),e._v(" "),e.canZoom(e.layerMenu.layer)?r("li",{on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.zoomToLayer(e.layerMenu.layer)}}},[r("span",{staticClass:"menu-icon skin-color-dark","class":e.g3wtemplate.getFontClass("search")}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"catalog_items.contextmenu.zoomtolayer",expression:"'catalog_items.contextmenu.zoomtolayer'"}],staticClass:"item-text"})]):e._e(),e._v(" "),e.layerMenu.layer.openattributetable?r("li",{on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.showAttributeTable(e.layerMenu.layer.id)}}},[r("bar-loader",{attrs:{loading:e.layerMenu.loading.data_table}}),e._v(" "),r("span",{staticClass:"menu-icon skin-color-dark","class":e.g3wtemplate.getFontClass("list")}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"catalog_items.contextmenu.open_attribute_table",expression:"'catalog_items.contextmenu.open_attribute_table'"}],staticClass:"item-text"})],1):e._e(),e._v(" "),e.isExternalVectorLayer(e.layerMenu.layer)?r("li",{on:{click:function(e){e.preventDefault(),e.stopPropagation()},mouseleave:function(t){return t.target!==t.currentTarget?null:e.showColorMenu(!1,t)},mouseover:function(t){return t.target!==t.currentTarget?null:e.showColorMenu(!0,t)}}},[r("span",{directives:[{name:"t",rawName:"v-t",value:"catalog_items.contextmenu.vector_color_menu",expression:"'catalog_items.contextmenu.vector_color_menu'"}],staticClass:"item-text"}),e._v(" "),r("span",{staticClass:"menu-icon skin-color-dark","class":e.g3wtemplate.getFontClass("arrow-right"),staticStyle:{position:"absolute",right:"0","margin-top":"3px"}}),e._v(" "),e.layerMenu.colorMenu.show?r("ul",{staticStyle:{position:"fixed"},style:{top:e.layerMenu.colorMenu.top+"px",left:e.layerMenu.colorMenu.left+"px"}},[r("li",{staticStyle:{padding:"0"}},[r("chrome-picker",{ref:"color_picker",staticStyle:{width:"100%"},on:{click:function(e){e.preventDefault(),e.stopPropagation()},"hook:beforeDestroy":e.onbeforeDestroyChangeColor,input:e.onChangeColor},model:{value:e.layerMenu.colorMenu.color,callback:function(t){e.$set(e.layerMenu.colorMenu,"color",t)},expression:"layerMenu.colorMenu.color"}})],1)]):e._e()]):e._e(),e._v(" "),e.isExternalVectorLayer(e.layerMenu.layer)&&e.layerMenu.layer.downloadUrl?r("li",{directives:[{name:"download",rawName:"v-download"}],on:{click:function(e){e.preventDefault(),e.stopPropagation()}}},[r("div",{on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.downloadExternal(e.layerMenu.layer.downloadUrl)}}},[r("bar-loader",{attrs:{loading:e.layerMenu.loading.unknow}}),e._v(" "),r("span",{staticClass:"menu-icon skin-color-dark","class":e.g3wtemplate.getFontClass("download")}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.unknow",expression:"'sdk.catalog.menu.download.unknow'"}],staticClass:"item-text"})],1)]):e._e(),e._v(" "),e.isExternalVectorLayer(e.layerMenu.layer)&&!e.layerMenu.layer.downloadUrl?r("li",{directives:[{name:"download",rawName:"v-download"}],on:{click:function(e){e.preventDefault(),e.stopPropagation()}}},[r("div",{on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.downloadExternalShapefile(e.layerMenu.layer)}}},[r("bar-loader",{attrs:{loading:e.layerMenu.loading.shp}}),e._v(" "),r("span",{staticClass:"menu-icon skin-color-dark","class":e.g3wtemplate.getFontClass("shapefile")}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.shp",expression:"'sdk.catalog.menu.download.shp'"}],staticClass:"item-text"})],1)]):e._e(),e._v(" "),e.isExternalWMSLayer(e.layerMenu.layer)?r("li",{on:{click:function(e){e.preventDefault(),e.stopPropagation()}}},[r("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.setwmsopacity",expression:"'sdk.catalog.menu.setwmsopacity'"}],staticClass:"item-text"}),e._v(" "),r("span",{staticStyle:{"font-weight":"bold","margin-left":"5px"}},[e._v(e._s(e.layerMenu.layer.opacity))])]),e._v(" "),r("range",{attrs:{value:e.layerMenu.layer.opacity,min:0,max:1,step:.1,sync:!0},on:{changed:e._hideMenu,"change-range":e.setWMSOpacity}})],1):e._e(),e._v(" "),e.canDownloadGeoTIFF(e.layerMenu.layer.id)?r("li",{directives:[{name:"download",rawName:"v-download"}]},[r("div",{on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.downloadGeoTIFF(e.layerMenu.layer.id)}}},[r("bar-loader",{attrs:{loading:e.layerMenu.loading.geotiff}}),e._v(" "),r("span",{staticClass:"menu-icon skin-color-dark","class":e.g3wtemplate.getFontClass("geotiff")}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.geotiff",expression:"'sdk.catalog.menu.download.geotiff'"}],staticClass:"item-text"})],1)]):e._e(),e._v(" "),e.canDownloadGeoTIFF(e.layerMenu.layer.id)?r("li",{directives:[{name:"download",rawName:"v-download"}]},[r("div",{staticStyle:{position:"relative"},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.downloadGeoTIFF(e.layerMenu.layer.id,!0)}}},[r("bar-loader",{attrs:{loading:e.layerMenu.loading.geotiff}}),e._v(" "),r("span",{staticClass:"menu-icon skin-color-dark","class":e.g3wtemplate.getFontClass("geotiff"),staticStyle:{color:"#777"}}),e._v(" "),r("span",{staticClass:"menu-icon skin-color-dark","class":e.g3wtemplate.getFontClass("crop"),staticStyle:{position:"absolute",left:"-7px",bottom:"8px","font-size":"1.2em"}}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.geotiff_map_extent",expression:"'sdk.catalog.menu.download.geotiff_map_extent'"}],staticClass:"item-text"})],1)]):e._e(),e._v(" "),e.canDownloadShp(e.layerMenu.layer.id)?r("li",{directives:[{name:"download",rawName:"v-download"}]},[r("div",{on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.downloadShp(e.layerMenu.layer.id)}}},[r("bar-loader",{attrs:{loading:e.layerMenu.loading.shp}}),e._v(" "),r("span",{staticClass:"menu-icon skin-color-dark","class":e.g3wtemplate.getFontClass("shapefile")}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.shp",expression:"'sdk.catalog.menu.download.shp'"}],staticClass:"item-text"})],1)]):e._e(),e._v(" "),e.canDownloadGpx(e.layerMenu.layer.id)?r("li",[r("div",{directives:[{name:"download",rawName:"v-download"}],on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.downloadGpx(e.layerMenu.layer.id)}}},[r("bar-loader",{attrs:{loading:e.layerMenu.loading.gpx}}),e._v(" "),r("span",{staticClass:"menu-icon skin-color-dark","class":e.g3wtemplate.getFontClass("gpx")}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.gpx",expression:"'sdk.catalog.menu.download.gpx'"}],staticClass:"item-text"})],1)]):e._e(),e._v(" "),e.canDownloadGpkg(e.layerMenu.layer.id)?r("li",[r("div",{directives:[{name:"download",rawName:"v-download"}],on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.downloadGpkg(e.layerMenu.layer.id)}}},[r("bar-loader",{attrs:{loading:e.layerMenu.loading.gpkg}}),e._v(" "),r("span",{staticClass:"menu-icon skin-color-dark","class":e.g3wtemplate.getFontClass("gpkg")}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.gpkg",expression:"'sdk.catalog.menu.download.gpkg'"}],staticClass:"item-text"})],1)]):e._e(),e._v(" "),e.canDownloadCsv(e.layerMenu.layer.id)?r("li",[r("div",{directives:[{name:"download",rawName:"v-download"}],on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.downloadCsv(e.layerMenu.layer.id)}}},[r("bar-loader",{attrs:{loading:e.layerMenu.loading.csv}}),e._v(" "),r("span",{staticClass:"menu-icon skin-color-dark","class":e.g3wtemplate.getFontClass("csv")}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.csv",expression:"'sdk.catalog.menu.download.csv'"}],staticClass:"item-text"})],1)]):e._e(),e._v(" "),e.canDownloadXls(e.layerMenu.layer.id)?r("li",{directives:[{name:"download",rawName:"v-download"}]},[r("div",{on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.downloadXls(e.layerMenu.layer.id)}}},[r("bar-loader",{attrs:{loading:e.layerMenu.loading.xls}}),e._v(" "),r("span",{staticClass:"menu-icon skin-color-dark","class":e.g3wtemplate.getFontClass("xls")}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.xls",expression:"'sdk.catalog.menu.download.xls'"}],staticClass:"item-text"})],1)]):e._e(),e._v(" "),e.canShowWmsUrl(e.layerMenu.layer.id)?r("li",[r("div",{staticStyle:{display:"flex","max-width":"300px","align-items":"center"},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.copyUrl({evt:t,layerId:e.layerMenu.layer.id,type:"Wms"})}}},[r("span",{staticClass:"menu-icon skin-color-dark","class":e.g3wtemplate.getFontClass("map")}),e._v(" "),r("div",{staticStyle:{display:"inline-flex","justify-content":"space-between",width:"100%","align-items":"baseline"}},[r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.catalog.menu.wms.copy",expression:"'sdk.catalog.menu.wms.copy'"}],staticClass:"item-text catalog-menu-wms skin-tooltip-top",attrs:{"data-toggle":"tooltip"}},[e._v("WMS URL")]),e._v(" "),r("span",{staticClass:"bold catalog-menu-wms wms-url-tooltip skin-tooltip-top skin-color-dark","class":e.g3wtemplate.getFontClass("eye"),attrs:{"data-placement":"top","data-toggle":"tooltip",title:e.getWmsUrl(e.layerMenu.layer.id)}})])])]):e._e(),e._v(" "),e.canShowWfsUrl(e.layerMenu.layer.id)?r("li",[r("div",{staticStyle:{display:"flex","max-width":"300px","align-items":"center"},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.copyUrl({evt:t,layerId:e.layerMenu.layer.id,type:"Wfs"})}}},[r("span",{staticClass:"menu-icon skin-color-dark","class":e.g3wtemplate.getFontClass("map")}),e._v(" "),r("div",{staticStyle:{display:"inline-flex","justify-content":"space-between",width:"100%","align-items":"baseline"}},[r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.catalog.menu.wms.copy",expression:"'sdk.catalog.menu.wms.copy'"}],staticClass:"item-text catalog-menu-wms skin-tooltip-top",attrs:{"data-toggle":"tooltip"}},[e._v("WFS URL")]),e._v(" "),r("span",{staticClass:"bold catalog-menu-wms wms-url-tooltip skin-tooltip-top skin-color-dark","class":e.g3wtemplate.getFontClass("eye"),attrs:{"data-placement":"top","data-toggle":"tooltip",title:e.getWfsUrl(e.layerMenu.layer.id)}})])])]):e._e()]):e._e()},n.staticRenderFns=[],n._scopeId="data-v-1e167faf"},{"components/LayerOpacityPicker.vue":253,"core/i18n/i18n.service":13,"core/utils/utils":68,"gui/catalog/vue/catalogeventhub":114,"gui/table/vue/table":184,"services/application":351,"services/gui":361,"shp-write":"shp-write","store/catalog-layers":374,"vue-color":"vue-color","vueify/lib/insert-css":1}],199:[function(e,t,r){e("vueify/lib/insert-css").insert(".layer-legend[data-v-5b4e061c]{padding-left:36px}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("services/gui"),a=t(i),o=e("gui/catalog/vue/catalogeventhub"),s=t(o),l=e("store/catalog-layers"),u=t(l),c=e("store/projects"),d=t(c),f=e("mixins/click"),p=t(f);r["default"]={name:"layerlegend",props:{legendplace:{type:String},layer:{type:Object}},data:function(){return{loading:!1,categories:[],currentstyle:this.layer.styles.find(function(e){return!0===e.current}).name}},mixins:[p["default"]],computed:{showfeaturecount:function(){return void 0!==this.layer.featurecount},externallegend:function(){return"wms"===this.layer.source.type},legend:function(){return this.layer.legend},show:function(){return this.layer.expanded&&this.layer.visible&&("toc"===this.legendplace||"tab"===this.legendplace&&this.layer.categories)}},methods:{onCategoryClick:function(){this.handleClick({1:function(){},2:function(){}},this)},showCategoryMenu:function(){this.$emit("showmenucategory")},getWmsSourceLayerLegendUrl:function(){return this.getProjectLayer().getLegendUrl({width:16,height:16})},getProjectLayer:function(){return u["default"].getLayerById(this.layer.id)},isDisabled:function(e){return this.categories[e].disabled},showHideLayerCategory:function(e){this.categories[e].checked=!this.categories[e].checked,this.getProjectLayer().change(),"tab"===this.legendplace?this.layer.legend.change=!0:this.categories[e].checked&&this.mapReady&&this.setLayerCategories(!1)},setError:function(){this.legend.error=!0,this.legend.loading=!1},urlLoaded:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.legend.loading=!1;case 1:case"end":return e.stop()}},r,this)}));return e}(),onChangeLayerLegendStyle:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.loading=!0,!this.externallegend){t.next=3;break}return t.abrupt("return");case 3:if(t.prev=3,void 0===e.style||e.layerId!==this.layer.id){t.next=13;break}return t.next=7,this.setLayerCategories(!0);case 7:return t.next=9,this.getProjectLayer().getStyleFeatureCount(e.style);case 9:if(this.currentstyle=e.style,!this.dynamic){t.next=13;break}return t.next=13,this.setLayerCategories(!1);case 13:t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](3);case 18:this.loading=!1;case 19:case"end":return t.stop()}},r,this,[[3,15]])}));return e}(),setLayerCategories:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e,t,n,i,a,o=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,e=this.getProjectLayer(),t=e.getCategories(),!o||!t){r.next=7;break}this.categories=t,r.next=13;break;case 7:return r.next=9,e.getLegendGraphic({all:o});case 9:n=r.sent,i=n.nodes,a=void 0===i?[]:i,o?this._setAllLayerCategories(a):this._updateLayerCategories(a,t);case 13:r.next=18;break;case 15:r.prev=15,r.t0=r["catch"](0),this.setError();case 18:case"end":return r.stop()}},r,this,[[0,15]])}));return e}(),_setAllLayerCategories:function(e){var t=this.getProjectLayer(),r=[];e.forEach(function(e){var t=e.icon,n=e.title,i=e.ruleKey,a=e.checked,o=e.symbols,s=void 0===o?[]:o;t?r.push({icon:t,title:n,ruleKey:i,checked:a,disabled:!1}):s.forEach(function(e){e._checked=e.checked,e.disabled=!1,r.push(e)})}),t.setCategories(r),this.categories=r},_updateLayerCategories:function(e,t){var r=this.getProjectLayer();r.setCategories(t),this.categories=t,e.length?e.forEach(function(e){var r=e.icon,n=e.title,i=e.symbols,a=void 0===i?[]:i;r&&(a=[{icon:r,title:n}]),t.forEach(function(e){var t=a.find(function(t){return t.icon===e.icon&&t.title===e.title}),r="undefined"==typeof e.checked||e.checked;e.disabled=r&&"undefined"==typeof t})}):t.forEach(function(e){return e.disabled="undefined"==typeof e.checked||e.checked})},onChangeMapLegendParams:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.mapReady=!0,this.layer.visible&&!1===this.externallegend&&("toc"===this.legendplace||this.layer.categories)&&this.setLayerCategories(!1);case 2:case"end":return e.stop()}},r,this)}));return e}(),runInitLayerVisibleAction:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setLayerCategories(!0);case 2:if(!this.dynamic){e.next=6;break}return e.next=5,this.setLayerCategories(!1);case 5:a["default"].getService("map").on("change-map-legend-params",this.onChangeMapLegendParams);case 6:this.initialize=!0;case 7:case"end":return e.stop()}},r,this)}));return e}()},watch:{"layer.visible":function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){var t;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t=e&&!1===this.externallegend,!t||!1!==this.initialize){r.next=4;break}return r.next=4,this.runInitLayerVisibleAction();case 4:if(!t||!1===this.initialize){r.next=7;break}return r.next=7,this.setLayerCategories(!this.dynamic);case 7:case"end":return r.stop()}},r,this)}));return e}()},created:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.initialize=!1,this.dynamic=d["default"].getCurrentProject().getContextBaseLegend(),this.mapReady=!1,s["default"].$on("layer-change-style",this.onChangeLayerLegendStyle),!1!==this.externallegend||!0!==this.layer.visible){e.next=7;break}return e.next=7,this.runInitLayerVisibleAction();case 7:case"end":return e.stop()}},r,this)}));return e}(),beforeDestroy:function(){s["default"].$off("layer-change-style",this.onChangeLayerLegendStyle)}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticClass:"layer-legend",on:{click:function(e){e.stopPropagation(),e.preventDefault()}}},[e.legend?r("bar-loader",{attrs:{loading:e.legend.loading}}):e._e(),e._v(" "),e.externallegend?r("figure",[r("img",{attrs:{src:e.getWmsSourceLayerLegendUrl()}})]):r("figure",{directives:[{name:"disabled",rawName:"v-disabled",value:e.loading,expression:"loading"}]},[r("bar-loader",{attrs:{loading:e.loading}}),e._v(" "),e._l(e.categories,function(t,n){return r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:t.disabled,expression:"category.disabled"}],staticStyle:{display:"flex","align-items":"center",width:"100%"},on:{contextmenu:function(t){return t.preventDefault(),t.stopPropagation(),e.showCategoryMenu(t)}}},[t.ruleKey?r("span",{"class":e.g3wtemplate.getFontClass(t.checked?"check":"uncheck"),staticStyle:{"padding-right":"3px"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.showHideLayerCategory(n)}}}):e._e(),e._v(" "),"toc"===e.legendplace?r("img",{attrs:{src:t.icon&&"data:image/png;base64,"+t.icon},on:{error:function(t){return e.setError()},load:function(t){return e.urlLoaded()}}}):e._e(),e._v(" "),"tab"===e.legendplace&&t.ruleKey||"toc"===e.legendplace?r("span",{staticClass:"g3w-long-text",staticStyle:{"padding-left":"3px"},on:{click:function(t){return t.stopPropagation(),e.onCategoryClick(t)}}},[r("span",[e._v(e._s(t.title))]),e._v(" "),e.showfeaturecount&&"undefined"!=typeof t.ruleKey?r("span",{staticStyle:{"font-weight":"bold"}},[e._v("\n          ["+e._s(e.layer.stylesfeaturecount[e.currentstyle][t.ruleKey])+"]\n        ")]):e._e()]):e._e()])})],2)],1)},n.staticRenderFns=[],n._scopeId="data-v-5b4e061c"},{"gui/catalog/vue/catalogeventhub":114,"mixins/click":339,"services/gui":361,"store/catalog-layers":374,"store/projects":379,"vueify/lib/insert-css":1}],200:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"catalog-layers-group",props:{layersgroup:{type:Object}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{border:"1px solid #ffffff33",margin:"5px"}},[r("h4",{staticStyle:{margin:"5px","font-weight":"bold"}},[e._v(e._s(e.layersgroup.title))]),e._v(" "),e._l(e.layersgroup.nodes,function(e){return r("tristate-tree",{staticClass:"item",attrs:{layerstree:e}})})],2)},n.staticRenderFns=[]},{}],201:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"catalog-layers-legend",props:["layerstree","legend","active"],data:function(){return{}},computed:{visiblelayers:function(){var e=[],t=function r(t){var n=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=o.value;!_.isNil(l.id)&&l.visible&&l.geolayer&&!l.exclude_from_legend&&e.push(l),_.isNil(l.nodes)||r(l.nodes)}}catch(u){i=!0,a=u}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}};return t(this.layerstree.tree),e}},watch:{layerstree:{handler:function(e,t){},deep:!0},visiblelayers:function(e){this.$emit("showlegend",!!e.length)}},created:function(){this.$emit("showlegend",!!this.visiblelayers.length)}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"tab-pane","class":{active:e.active},attrs:{role:"tabpanel",id:"legend"}},[r("layerslegend-items",{attrs:{active:e.active,legend:e.legend,layers:e.visiblelayers}})],1)},n.staticRenderFns=[]},{}],202:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=e("gui/catalog/vue/catalogeventhub"),o=t(a),s=e("store/catalog-layers"),l=t(s),u=e("services/application"),c=t(u),d=e("store/projects"),f=t(d),p=e("services/gui"),h=t(p);r["default"]={name:"catalog-layers-legend-items",props:{layers:{"default":[]},legend:{type:Object},active:{"default":!0}},data:function(){return{legendurls:[]}},watch:{layers:{handler:function(){this.getLegendSrc()},immediate:!1},active:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){var t;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!e){r.next=6;break}if(t=this.layers.filter(function(e){return e.legend.change}),0!==this.legendurls.length&&!this.dynamic&&!t.length){
r.next=6;break}return r.next=5,this.getLegendSrc(this.layers);case 5:t.forEach(function(e){return e.legend.change=!1});case 6:case"end":return r.stop()}},r,this)}));return e}()},methods:{setError:function(e){e.error=!0,e.loading=!1},urlLoaded:function(e){e.loading=!1},getLegendUrl:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=l["default"].getLayerById(e.id);if(r)return r.getLegendUrl(t,{all:!this.dynamic,format:"image/png",categories:e.categories})},getLegendUrlParams:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t="",r={LAYERS:[],STYLES:[],LEGEND_ON:[],LEGEND_OFF:[]};return e.reduce(function(e,t){return r.LAYERS.push(t.layerName),r.STYLES.push(t.style),t.legend_on&&r.LEGEND_ON.push(t.legend_on),t.legend_off&&r.LEGEND_OFF.push(t.legend_off),r},r),t+="LAYERS="+encodeURIComponent(r.LAYERS.join(",")),t+="&STYLES="+encodeURIComponent(r.STYLES.join(",")),r.LEGEND_ON.length&&(t+="&LEGEND_ON="+encodeURIComponent(r.LEGEND_ON.join(","))),r.LEGEND_OFF.length&&(t+="&LEGEND_OFF="+encodeURIComponent(r.LEGEND_OFF.join(","))),c["default"].getFilterToken()&&(t+="&filtertoken="+c["default"].getFilterToken()),t},getLegendSrc:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e,t,n,a,o,s,l,u,c,d,f,p,h,v,g,m,y,_,b,w,x,S,L=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return this.legendurls=[],r.next=3,this.$nextTick();case 3:if(this.active){r.next=5;break}return r.abrupt("return");case 5:e={GET:{},POST:{}},t=this,n=this.layers.filter(function(e){return e.geolayer}),a=0;case 9:if(!(a<n.length)){r.next=20;break}if(o=n[a],s=Array.isArray(o.styles)&&o.styles.find(function(e){return e.current}),l=o.source&&o.source.url||o.external?e.GET:e[o.ows_method],u=""+this.getLegendUrl(o,this.legend.config),"undefined"!=typeof u){r.next=16;break}return r.abrupt("continue",17);case 16:o.source&&o.source.url?l[u]=[]:(c=void 0,d=void 0,f=void 0,p=u.split("LAYER="),h=i(p,2),c=h[0],layerName=h[1],v=c.split("LEGEND_ON="),g=i(v,2),c=g[0],d=g[1],m=c.split("LEGEND_OFF="),y=i(m,2),c=y[0],f=y[1],l[c]||(l[c]=[]),l[c].unshift({layerName:layerName,style:s&&s.name,legend_on:(d||"").replace("&",""),legend_off:(f||"").replace("&","")}));case 17:a++,r.next=9;break;case 20:for(_ in e)if(b=e[_],"GET"===_)for(w in b)b[w].length&&(w+=""+this.getLegendUrlParams(b[w])),this.legendurls.push({loading:!0,error:!1,url:w});else{x=function(e){var r=new XMLHttpRequest,n=[],a=e.split("?"),o=i(a,2),s=o[0],l=o[1];l=l.split("&"),l.forEach(function(e){var t=e.split("="),r=i(t,2),a=r[0],o=r[1];a&&n.push(a+"="+encodeURIComponent(o))}),l=n.join("&")+"&"+L.getLegendUrlParams(b[e]);var u={loading:!0,url:null,error:!1};r.open("POST",s),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),r.responseType="blob",t.legendurls.push(u),r.onload=function(){void 0!==this.response&&(u.url=window.URL.createObjectURL(this.response)),u.loading=!1},r.onerror=function(){u.loading=!1},r.send(l)};for(S in b)x(S)}case 21:case"end":return r.stop()}},r,this)}));return e}()},created:function(){var e=this;this.dynamic=f["default"].getCurrentProject().getContextBaseLegend(),this.mapReady=!1,o["default"].$on("layer-change-style",function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.getLegendSrc()})},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$nextTick();case 2:this.dynamic?h["default"].getService("map").on("change-map-legend-params",function(){e.mapReady=!0,e.getLegendSrc()}):this.mapReady=!0;case 3:case"end":return t.stop()}},r,this)}));return e}()}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"legend-item"},e._l(e.legendurls,function(t){return r("figure",[r("bar-loader",{attrs:{loading:t.loading}}),e._v(" "),r("img",{directives:[{name:"show",rawName:"v-show",value:!t.loading&&!t.error,expression:"!legendurl.loading && !legendurl.error"}],attrs:{src:t.url},on:{error:function(r){return e.setError(t)},load:function(r){return e.urlLoaded(t)}}}),e._v(" "),r("span",{staticClass:"divider"})],1)}),0)},n.staticRenderFns=[]},{"gui/catalog/vue/catalogeventhub":114,"services/application":351,"services/gui":361,"store/catalog-layers":374,"store/projects":379}],203:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("components/CatalogLayerLegend.vue"),a=t(i),o=e("gui/catalog/vue/catalogeventhub"),s=t(o),l=e("store/catalog-layers"),u=t(l),c=e("mixins/click"),d=t(c),f=e("services/gui"),p=t(f),h=e("core/utils/utils"),v=h.downloadFile;r["default"]={name:"catalog-tristate-tree",props:["layerstree","storeid","legend","legendplace","highlightlayers","parent_mutually_exclusive","parentFolder","externallayers","root","parent"],components:{layerlegend:a["default"]},mixins:[d["default"]],data:function(){return{expanded:this.layerstree.expanded,isGroupChecked:!0,controltoggled:!1,n_childs:null,filtered:!1}},computed:{showfeaturecount:function(){return"undefined"!=typeof this.layerstree.featurecount},showLegendLayer:function(){return!this.layerstree.exclude_from_legend},showLayerTocLegend:function(){return!this.isGroup&&this.showLegendLayer&&this.layerstree.geolayer},isGroup:function(){return!!this.layerstree.nodes},legendlayerposition:function(){return this.showLegendLayer&&this.layerstree.legend?this.legendplace:"tab"},showscalevisibilityclass:function(){return!this.isGroup&&this.layerstree.scalebasedvisibility},showScaleVisibilityToolip:function(){return this.showscalevisibilityclass&&this.layerstree.disabled&&this.layerstree.checked},isTable:function(){return!this.isGroup&&!this.layerstree.geolayer&&!this.layerstree.external},isHidden:function(){return this.layerstree.hidden&&!0===this.layerstree.hidden},selected:function(){this.layerstree.selected=(!this.layerstree.disabled||!this.layerstree.selected)&&this.layerstree.selected},isHighLight:function(){return this._isHighLightProjectLayer||this._isHighLightExternalLayer},isInGrey:function(){return!this.isGroup&&!this.isTable&&!this.layerstree.external&&(!this.layerstree.visible||this.layerstree.disabled)},getFeatureCount:function(){return Object.values(this.layerstree.featurecount).reduce(function(e,t){return e+1*t},0)},_isHighLightProjectLayer:function(){return this.highlightlayers&&!this.isGroup&&u["default"].getLayerById(this.layerstree.id).getTocHighlightable()&&this.layerstree.visible},_isHighLightExternalLayer:function(){return this.layerstree.external&&this.layerstree.visible&&"vector"&&this.layerstree._type&&!0===this.layerstree.tochighlightable}},watch:{"layerstree.disabled":function(e){},"layerstree.checked":function(e,t){this.isGroup?this.handleGroupChecked(this.layerstree):this.handleLayerChecked(this.layerstree)}},methods:{init:function(){var e=this;this.isGroup&&!this.layerstree.checked&&this.handleGroupChecked(this.layerstree),this.isGroup&&!this.root&&this.layerstree.nodes.forEach(function(t){t.id&&e.parent_mutually_exclusive&&!e.layerstree.mutually_exclusive&&(t.uncheckable=!0)})},handleGroupChecked:function(e){var t=e.checked,r=e.parentGroup,n=e.nodes,i=function o(e){var t=e.nodes,r=e.visible;t.forEach(function(e){void 0!==e.id?e.parentGroup.checked&&e.checked&&u["default"].getLayerById(e.id).setVisible(r):o({nodes:e.nodes,visible:r&&e.checked})})};if(t){var a=!r||r.checked;for(r&&r.mutually_exclusive?r.nodes.forEach(function(t){t.checked=t.groupId===e.groupId,t.checked&&i({nodes:t.nodes,visible:a})}):i({nodes:n,visible:a});r;)r.checked=r.root||r.checked,r=r.parentGroup}else n.forEach(function(e){void 0!==e.id?e.checked&&u["default"].getLayerById(e.id).setVisible(!1):i({nodes:e.nodes,visible:!1})})},handleLayerChecked:function(e){var t=e.checked,r=e.id,n=e.disabled,i=e.projectLayer,a=void 0!==i&&i,o=e.parentGroup;if(a){var l=u["default"].getLayerById(r);if(t){l.setVisible(!n);for(o.mutually_exclusive&&o.nodes.forEach(function(e){return e.checked=e.id===r});o;)o.checked=!0,o=o.parentGroup}else l.setVisible(!1);s["default"].$emit("treenodevisible",l)}else e.visible=t,p["default"].getService("map").changeLayerVisibility({id:r,visible:t})},toggleFilterLayer:function(){s["default"].$emit("activefiltertokenlayer",this.storeid,this.layerstree)},clearSelection:function(){s["default"].$emit("unselectionlayer",this.storeid,this.layerstree)},toggle:function(){this.layerstree.checked=!this.layerstree.checked},expandCollapse:function(){this.layerstree.expanded=!this.layerstree.expanded},select:function(){void 0!==this.layerstree.selected&&(this.layerstree.external&&!1===this.layerstree.projectLayer?s["default"].$emit("treenodeexternalselected",this.layerstree):this.isGroup||this.isTable||s["default"].$emit("treenodeselected",this.storeid,this.layerstree))},zoomToLayer:function(e){p["default"].getService("map").goToBBox([e.bbox.minx,e.bbox.miny,e.bbox.maxx,e.bbox.maxy],e.epsg)},canZoom:function(e){return e.bbox&&[e.bbox.minx,e.bbox.miny,e.bbox.maxx,e.bbox.maxy].find(function(e){return e>0})},onTreeItemClick:function(){var e=this;this.handleClick({1:function(){return!e.isTable&&!e.isGroup&&e.select()},2:function(){return!e.isTable&&e.canZoom(e.layerstree)&&e.zoomToLayer(e.layerstree)}},this)},triClass:function(){return this.g3wtemplate.getFontClass(this.layerstree.checked?"check":"uncheck")},downloadExternalLayer:function(e){e.file?v(e.file):e.url},removeExternalLayer:function(e,t){p["default"].getService("map").removeExternalLayer(e,wms)},showLayerMenu:function(e,t){!this.isGroup&&(this.layerstree.openattributetable||this.layerstree.downloadable||this.layerstree.geolayer||this.layerstree.external)&&s["default"].$emit("showmenulayer",e,t)}},created:function(){this.init()},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:$("span.scalevisibility").tooltip();case 3:case"end":return e.stop()}},r,this)}));return e}()}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",{staticClass:"tree-item","class":{selected:(!e.isGroup||!e.isTable)&&e.layerstree.selected,itemmarginbottom:!e.isGroup,disabled:e.isInGrey,group:e.isGroup},style:{marginLeft:e.isGroup?"0":"5px"},on:{contextmenu:function(t){return t.preventDefault(),t.stopPropagation(),e.showLayerMenu(e.layerstree,t)},click:function(t){return t.stopPropagation(),e.onTreeItemClick(t)}}},[e.isGroup?r("span",{staticClass:"root collapse-expande-collapse-icon","class":[{bold:e.isGroup},e.g3wtemplate.getFontClass(e.layerstree.expanded?"caret-down":"caret-right")],staticStyle:{"padding-right":"2px"},on:{click:function(t){return t.stopPropagation(),e.expandCollapse(t)}}}):e._e(),e._v(" "),e.isGroup?r("span",{"class":[e.triClass()],staticStyle:{color:"#ffffff"},on:{click:function(t){return t.stopPropagation(),e.toggle()}}}):e.isTable?r("span",{directives:[{name:"show",rawName:"v-show",value:!e.layerstree.hidden,expression:"!layerstree.hidden"}],"class":[e.parentFolder?"child":"root",e.g3wtemplate.getFontClass("table")],staticStyle:{"padding-left":"18px"}}):[e.layerstree.external&&e.layerstree.removable?r("span",{"class":e.g3wtemplate.getFontClass("trash"),staticStyle:{color:"red","padding-left":"1px"},on:{click:function(t){return t.stopPropagation(),e.removeExternalLayer(e.layerstree.name,e.layerstree._type)}}}):e._e(),e._v(" "),e.layerstree.external&&e.layerstree.download?r("span",{"class":e.g3wtemplate.getFontClass("download"),staticStyle:{color:"#ffffff","margin-left":"5px"},on:{click:function(t){return e.downloadExternalLayer(e.layerstree.download)}}}):e._e(),e._v(" "),r("span",{directives:[{name:"show",rawName:"v-show",value:!e.layerstree.hidden,expression:"!layerstree.hidden"}],staticClass:"checkbox-layer","class":e.parentFolder?"child":"root"},["toc"===e.legendlayerposition||!e.isGroup&&e.layerstree.categories?r("span",{staticClass:"collapse-expande-collapse-icon","class":e.g3wtemplate.getFontClass(e.layerstree.visible&&e.layerstree.expanded?"caret-down":"caret-right"),on:{click:function(t){return t.target!==t.currentTarget?null:(t.stopPropagation(),e.expandCollapse(t))}}}):e._e(),e._v(" "),r("span",{"class":[e.g3wtemplate.getFontClass(e.layerstree.checked?"check":"uncheck"),{"toc-added-external-layer":!e.layerstree.legend&&e.layerstree.external}],style:{paddingLeft:"toc"===e.legendlayerposition?"5px":!e.isGroup&&e.layerstree.categories?"5px":!e.layerstree.legend&&e.layerstree.external?"1px":"18px"},on:{click:function(t){return t.stopPropagation(),e.toggle()}}})])],e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:!e.layerstree.hidden||e.isGroup,expression:"!layerstree.hidden || isGroup"}],staticClass:"tree-node-title","class":{disabled:!e.layerstree.external&&(e.layerstree.disabled||e.layerstree.id&&!e.layerstree.visible),bold:e.isGroup}},[r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip.text",value:e.showScaleVisibilityToolip?"minscale:"+e.layerstree.minscale+" - maxscale:"+e.layerstree.maxscale:"",expression:"showScaleVisibilityToolip ? `minscale:${layerstree.minscale} - maxscale:${layerstree.maxscale}` : ''",modifiers:{text:!0}}],staticClass:"skin-tooltip-top g3w-long-text","class":{highlightlayer:e.isHighLight,scalevisibility:e.showscalevisibilityclass},attrs:{"data-placement":"top","current-tooltip":e.showScaleVisibilityToolip?"minscale:"+e.layerstree.minscale+" - maxscale: "+e.layerstree.maxscale:""}},[r("span",[e._v(e._s(e.layerstree.title))]),e._v(" "),!e.isGroup&&e.showfeaturecount?r("span",{staticStyle:{"font-weight":"bold"}},[e._v("["+e._s(e.getFeatureCount)+"]")]):e._e()]),e._v(" "),!e.isGroup&&e.layerstree.selection?r("div",[e.layerstree.selection.active?r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"layer_selection_filter.tools.clear",expression:"'layer_selection_filter.tools.clear'",modifiers:{create:!0}}],staticClass:"action-button skin-tooltip-left selection-filter-icon","class":e.g3wtemplate.getFontClass("success"),attrs:{"data-placement":"left","data-toggle":"tooltip"},on:{click:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"caputure",void 0,t.key,void 0)?null:(t.preventDefault(),t.stopPropagation(),e.clearSelection(t))}}}):e._e(),e._v(" "),e.layerstree.external||!e.layerstree.selection.active&&!e.layerstree.filter.active?e._e():r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"layer_selection_filter.tools.filter",expression:"'layer_selection_filter.tools.filter'",modifiers:{create:!0}}],staticClass:"action-button skin-tooltip-left selection-filter-icon","class":[e.g3wtemplate.getFontClass("filter"),e.layerstree.filter.active?"active":""],attrs:{"data-placement":"left","data-toggle":"tooltip"},on:{click:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"caputure",void 0,t.key,void 0)?null:(t.preventDefault(),t.stopPropagation(),e.toggleFilterLayer(t))}}})]):e._e()]),e._v(" "),e.showLayerTocLegend?r("layerlegend",{attrs:{legendplace:e.legendplace,layer:e.layerstree}}):e._e(),e._v(" "),e.isGroup?r("ul",{directives:[{name:"show",rawName:"v-show",value:e.layerstree.expanded,expression:"layerstree.expanded"}],staticClass:"tree-content-items group","class":["g3w-lendplace-"+e.legendplace]},e._l(e.layerstree.nodes,function(t){return r("span",{key:t.id||t.groupId},[r("tristate-tree",{attrs:{root:!1,legendConfig:e.legend,legendplace:e.legendplace,highlightlayers:e.highlightlayers,parentFolder:e.isGroup,layerstree:t,storeid:e.storeid,parent:e.layerstree,parent_mutually_exclusive:!!e.layerstree.mutually_exclusive}})],1)}),0):e._e()],2)},n.staticRenderFns=[]},{"components/CatalogLayerLegend.vue":199,"core/utils/utils":68,"gui/catalog/vue/catalogeventhub":114,"mixins/click":339,"services/gui":361,"store/catalog-layers":374}],204:[function(e,t,r){e("vueify/lib/insert-css").insert("#g3w-change-map-menu[data-v-a010fcb8]{width:100%;position:relative}.g3w-change-map-menu-container[data-v-a010fcb8]{height:100%;display:grid;grid-template-columns:repeat(auto-fill,minmax(30%,1fr));grid-gap:1em;overflow-y:auto}.menu-item[data-v-a010fcb8]{margin-bottom:20px;margin-top:20px}.menu-item-image[data-v-a010fcb8]{cursor:pointer;position:relative;overflow:hidden;padding-bottom:50%;opacity:.7}.menu-item-image[data-v-a010fcb8]:hover{opacity:1}.menu-item-image img[data-v-a010fcb8]{position:absolute;top:0;bottom:0;left:0;right:0;margin:auto}.menu-item-content[data-v-a010fcb8]{padding:15px;background:hsla(0,0%,100%,.3)}.menu-item-text[data-v-a010fcb8]{position:relative;overflow:hidden;height:100%;text-align:justify}.menu-item-title[data-v-a010fcb8]{text-align:center;font-weight:700;background:hsla(0,0%,100%,.5);padding:5px}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var a=e("services/application"),o=t(a),s=e("store/projects"),l=t(s),u=e("constant"),c=e("g3w-ol/projection/projections"),d=e("core/utils/utils"),f=d.XHR;r["default"]={name:"change-map-menu",data:function(){return{state:null,loading:!1,current:"projects",items:[],parent:null,steps:[],currentProjectGroupId:null}},computed:{isChildNode:function(){return"root"!==this.current}},methods:{setFallBackImage:function(e){var t=""+o["default"].getConfig().urls.clienturl+u.LOGO_GIS3W;e.thumbnail||e.logo_img?e.thumbnail=t:e.header_logo_img&&(e.header_logo_img=t)},back:function(){if(this.steps.length>1){var e=this.steps[0];this.steps=[],this.showGroups(e)}else this.showRoot()},showRoot:function(){this.current="root",this.items=this.macrogroupsandgroups,this.steps=[]},_onChangeRoot:function(e){void 0===e.srid?this.showGroups(e):this.showProjects(e)},showGroups:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function r(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.loading=!0,this.parent=e,t.prev=2,t.next=5,f.get({url:encodeURI("/"+o["default"].getApplicationUser().i18n+u.API_BASE_URLS.ABOUT.group+e.id+"/")});case 5:this.items=t.sent,this.current="groups",t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](2),this.items=[];case 12:this.steps.push(this.parent),this.loading=!1;case 14:case"end":return t.stop()}},r,this,[[2,9]])}));return e}(),showProjects:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function r(e){var t=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(this.loading=!0,this.parent=e,this.parent.id!==this.currentProjectGroupId){r.next=7;break}this.items=l["default"].getListableProjects(),this.current="projects",r.next=18;break;case 7:return r.prev=7,r.next=10,f.get({url:encodeURI("/"+o["default"].getApplicationUser().i18n+u.API_BASE_URLS.ABOUT.projects.replace("__G3W_GROUP_ID__",e.id))});case 10:this.items=r.sent,this.items.forEach(function(e){return t.setItemImageSrc({item:e,type:"project"})}),this.current="projects",r.next=18;break;case 15:r.prev=15,r.t0=r["catch"](7),this.items=[];case 18:this.steps.push(this.parent),this.loading=!1;case 20:case"end":return r.stop()}},r,this,[[7,15]])}));return e}(),changeMapProject:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function r(e){var t,n,i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t=void 0,n=l["default"].getBaseUrl(),i=this.parent.srid?"EPSG:"+this.parent.srid:this.parent.crs.epsg,r.next=5,c.registerProjection(i);case 5:try{new URL(n),t=""+n+(e.url||e.map_url.replace(/^\//,""))}catch(a){t=""+location.origin+n+(e.url||e.map_url.replace(/^\//,""))}return r.abrupt("return",o["default"].changeMapProject({url:t,epsg:i}));case 7:case"end":return r.stop()}},r,this)}));return e}(),trigger:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function r(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=this.current,t.next="root"===t.t0?3:"macrogroup"===t.t0?4:"groups"===t.t0?5:"projects"===t.t0?8:11;break;case 3:return t.abrupt("return",this._onChangeRoot(e));case 4:return t.abrupt("return",this.showGroups(e));case 5:return t.next=7,this.showProjects(e);case 7:return t.abrupt("return",t.sent);case 8:return t.next=10,this.changeMapProject(e);case 10:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}},r,this)}));return e}(),setItemImageSrc:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.item,r=e.type;switch(r){case"project":t.thumbnail=this._setSrc(t.thumbnail);break;case"group":t.header_logo_img=this._setSrc(t.header_logo_img);break;case"macrogroup":t.logo_img=this._setSrc(t.logo_img)}},_setSrc:function(e){var t=void 0,r=this.$options.host||"",n=l["default"].config.mediaurl,i=o["default"].getConfig().urls.clienturl,a=e&&-1!==e.indexOf(n),s=e&&-1===e.indexOf("static")&&-1===e.indexOf("media");return t=e?a?e:s?""+n+e:""+i+u.LOGO_GIS3W:""+i+u.LOGO_GIS3W,""+r+t}},created:function(){var e=this;this.items=l["default"].getListableProjects(),this.items.forEach(function(t){return e.setItemImageSrc({item:t,type:"project"})}),this.parent=l["default"].getCurrentProjectGroup(),this.currentProjectGroupId=this.parent.id,this.macrogroups=o["default"].getConfig().macrogroups,this.macrogroups.forEach(function(t){return e.setItemImageSrc({item:t,type:"magrocroup"})}),this.groups=o["default"].getConfig().groups,this.groups.forEach(function(t){return e.setItemImageSrc({item:t,type:"group"})}),this.macrogroupsandgroups=[].concat(n(this.macrogroups),n(this.groups));var t=this.macrogroups.find(function(t){return t.id===e.parent.id});if(t){var r=this.groups.find(function(t){return t.id===e.parent.id});r&&(this.parent=r,this.currentProjectGroupId=this.parent.id)}0===this.items.length&&this.showRoot()}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"g3w-change-map-menu"}},[e.isChildNode?[r("div",{staticClass:"skin-background-color",staticStyle:{display:"flex","align-items":"center",color:"#ffffff"}},[r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:bottom.create",value:"change_session",expression:"'change_session'",arg:"bottom",modifiers:{create:!0}},{name:"disabled",rawName:"v-disabled",value:e.loading,expression:"loading"}],staticStyle:{"font-size":"2em",margin:"5px",cursor:"pointer",padding:"3px",border:"2px solid #ffffff","border-radius":"3px"},on:{click:function(t){return t.stopPropagation(),e.back(t)}}},[r("i",{"class":e.g3wtemplate.getFontClass("reply"),staticStyle:{color:"#FFFFFF"}})]),e._v(" "),e.parent?r("div",{staticStyle:{margin:"auto"}},[r("h3",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(e.parent.title||e.parent.name))])]):e._e()])]:e._e(),e._v(" "),e.items.length?r("div",{staticClass:"g3w-change-map-menu-container"},e._l(e.items,function(t){return r("div",{key:t.title,staticClass:"menu-item"},[r("div",{staticClass:"menu-item-image",on:{click:function(r){return r.stopPropagation(),e.trigger(t)}}},[r("img",{staticClass:"img-responsive",attrs:{src:t.thumbnail||t.header_logo_img||t.logo_img,alt:"logo"},on:{error:function(r){return e.setFallBackImage(t)}}})]),e._v(" "),r("div",{staticClass:"menu-item-content"},[r("div",{staticClass:"menu-item-text"},[r("h4",{staticClass:"menu-item-title"},[e._v(e._s(t.title))]),e._v(" "),r("div",{domProps:{innerHTML:e._s(t.description)}})])])])}),0):[r("h3",{directives:[{name:"t",rawName:"v-t",value:"no_other_"+e.current,expression:"`no_other_${current}`"}],staticStyle:{"font-weight":"bold"}})]],2)},n.staticRenderFns=[],n._scopeId="data-v-a010fcb8"},{constant:4,"core/utils/utils":68,"g3w-ol/projection/projections":111,"services/application":351,"store/projects":379,"vueify/lib/insert-css":1}],205:[function(e,t,r){e("vueify/lib/insert-css").insert(".field[data-v-c932f5da]{background-color:transparent!important;padding-top:3px;padding-bottom:3px;display:flex;align-items:center}.value[data-v-c932f5da]{position:relative}.field div[data-v-c932f5da]{padding-left:3px;padding-right:3px}.field_value[data-v-c932f5da]{padding-left:0!important}");!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"field",props:["state"]}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"field",style:{fontSize:e.isMobile()&&"0.8em"}},[e.state.label?r("div",{staticClass:"col-sm-6  field_label"},[e._t("label",[e._v(e._s(e.state.label))])],2):e._e(),e._v(" "),r("div",{staticClass:"field_value","class":[e.state.label?"col-sm-6":null]},[e._t("field",[r("span",{staticStyle:{"word-wrap":"break-word"},domProps:{innerHTML:e._s(e.state.value)}})])],2)])},n.staticRenderFns=[],n._scopeId="data-v-c932f5da"},{"vueify/lib/insert-css":1}],206:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},n=e("gui/fields/fieldsservice"),i=e("gui/fields/fields");r["default"]={name:"g3w-field",props:{state:{required:!0},feature:{type:Object}},components:t({},i),created:function(){this.type=n.getType(this.state)}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r(e.type,{tag:"component",attrs:{feature:e.feature,state:e.state}})},n.staticRenderFns=[],n._scopeId="data-v-547dc470"},{"gui/fields/fields":120,"gui/fields/fieldsservice":121}],207:[function(e,t,r){e("vueify/lib/insert-css").insert(".show-hide-geo[data-v-2c65a0ee]{color:#3c8dbc;cursor:pointer;font-size:1.2em}");!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("mixins");r["default"]={name:"g3w-geospatial",props:{data:{}},mixins:[t.geoMixin],data:function(){return{layerId:"table_layer_"+Date.now(),visible:!1,id:"geo_table_"+Date.now()}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"geo-content"},[r("span",{staticClass:"show-hide-geo","class":[e.visible?e.g3wtemplate.font["eye-close"]:e.g3wtemplate.font.eye],on:{click:function(t){return t.stopPropagation(),e.showLayer()}}})])},n.staticRenderFns=[],n._scopeId="data-v-2c65a0ee"},{mixins:343,"vueify/lib/insert-css":1}],208:[function(e,t,r){e("vueify/lib/insert-css").insert(".img-responsive[data-v-e69e4e90]{cursor:pointer}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("components/Field.vue"),i=t(n),a=e("core/utils/utils"),o=a.toRawType;r["default"]={name:"field-image",props:["state"],data:function(){return{galleryId:"gallery_"+Date.now(),active:null,value:void 0!==this.state.value.mime_type?this.state.value.value:this.state.value}},components:{Field:i["default"]},computed:{values:function(){return Array.isArray(this.value)?this.value:[this.value]}},methods:{getSrc:function(e){return"Object"===o(e)?e.photo:e},showGallery:function(e){this.active=e,"Object"===o(this.value)&&(this.value.active=!0),$("#"+this.galleryId).modal("show")},getGalleryImages:function(){var e=this;return this.values.map(function(t){return{src:e.getSrc(t)}})}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("field",{attrs:{state:e.state}},[r("div",{staticStyle:{"text-align":"left"},attrs:{slot:"field"},slot:"field"},[e._l(e.values,function(t,n){return r("img",{staticClass:"img-responsive",staticStyle:{"max-height":"50px"},attrs:{src:e.getSrc(t)},on:{click:function(t){return e.showGallery(n)}}})}),e._v(" "),r("g3w-images-gallery",{attrs:{id:e.galleryId,active:e.active,images:e.getGalleryImages()}})],2)])},n.staticRenderFns=[],n._scopeId="data-v-e69e4e90"},{"components/Field.vue":205,"core/utils/utils":68,"vueify/lib/insert-css":1}],209:[function(e,t,r){e("vueify/lib/insert-css").insert(".field_link[data-v-3cd356ad]{max-width:100%}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("components/Field.vue"),a=t(i);r["default"]={name:"field-link",props:["state"],data:function(){return{value:null}},components:{Field:a["default"]},methods:{openLink:function(e){window.open(e,"_blank")}},created:function(){this.value=this.state.value&&"object"===n(this.state.value)?this.state.value.value:this.state.value}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("field",{attrs:{state:e.state}},[r("button",{directives:[{name:"t",rawName:"v-t",value:"info.link_button",expression:"'info.link_button'"}],staticClass:"btn skin-button field_link",attrs:{slot:"field"},on:{click:function(t){return e.openLink(e.value)}},slot:"field"})])},n.staticRenderFns=[],n._scopeId="data-v-3cd356ad"},{"components/Field.vue":205,"vueify/lib/insert-css":1}],210:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("mixins");r["default"]={name:"g3w-media",mixins:[t.mediaMixin],props:["state"],computed:{type:function(){return this.getMediaType(this.state.mime_type).type},value:function(){return this.state.value}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.value?r("div",{staticClass:"preview"},[r("a",{attrs:{href:e.value,target:"_blank"}},[r("div",{staticClass:"previewtype","class":e.type},[r("i",{staticClass:"fa-2x","class":e.g3wtemplate.font[e.type]})])]),e._v(" "),r("div",{staticClass:"filename"},[e._v(e._s(e.filename))]),e._v(" "),e._t("default")],2):e._e()},n.staticRenderFns=[],n._scopeId="data-v-409d32c1"},{mixins:343}],211:[function(e,t,r){e("vueify/lib/insert-css").insert(".field_text_table[data-v-8c59cb40]{background-color:transparent!important}.field_text_table .field_label[data-v-8c59cb40]{font-weight:700}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("components/Field.vue"),i=t(n);r["default"]={
name:"field-text",props:["state"],components:{Field:i["default"]},created:function(){}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("field",{attrs:{state:e.state}})},n.staticRenderFns=[],n._scopeId="data-v-8c59cb40"},{"components/Field.vue":205,"vueify/lib/insert-css":1}],212:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("components/Field.vue"),i=t(n);r["default"]={name:"vuefield",props:{feature:{type:Object},state:{type:Object,"default":{value:null,vueoptions:{component:{}}}}},components:{Field:i["default"]}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("field",{attrs:{state:e.state}},[r("div",{attrs:{slot:"field"},slot:"field"},[r(e.state.vueoptions.component,{tag:"component",attrs:{feature:e.feature,value:e.state.value}})],1)])},n.staticRenderFns=[],n._scopeId="data-v-60a3b8a3"},{"components/Field.vue":205}],213:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("services/floatbar"),i=t(n);r["default"]={name:"Floatbar",data:function(){return{stack:i["default"].stack.state}},computed:{panelsinstack:function(){return this.stack.contentsdata.length>0},panelname:function(){var e=void 0;return this.stack.contentsdata.length&&(e=this.stack.contentsdata.slice(-1)[0].content.getTitle()),e},closable:function(){return i["default"].closable}},watch:{"stack.contentsdata":function(){var e=$("#g3w-floatbarpanel-placeholder").children();e.forEach(function(t,r){r==e.length-1?$(t).show():$(t).hide()})}},methods:{closePanel:function(){i["default"].closePanel()}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("aside",{staticClass:"control-sidebar control-sidebar-light"},[r("a",{directives:[{name:"show",rawName:"v-show",value:e.panelsinstack,expression:"panelsinstack"}],staticClass:"floatbar-aside-toggle",attrs:{href:"#","data-toggle":"control-sidebar",role:"button"}},[r("span",{staticClass:"sr-only"},[e._v("Expand")])]),e._v(" "),r("div",{staticStyle:{position:"absolute"},attrs:{id:"floatbar-spinner"}}),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.panelsinstack,expression:"panelsinstack"}],staticClass:"g3w-sidebarpanel"},[e.closable?r("div",{staticClass:"row"},[r("div",{staticClass:"col-xs-12 col-sm-12 col-md-12"},[r("button",{staticClass:"pull-right close-panel-button","class":e.g3wtemplate.getFontClass("close"),on:{click:e.closePanel}})])]):e._e(),e._v(" "),e.panelname?r("div",[r("h4",{staticClass:"g3w-floatbarpanel-name"},[e._v(e._s(e.panelname))])]):e._e(),e._v(" "),r("div",{staticClass:"g3w-floatbarpanel-placeholder",attrs:{id:"g3w-floatbarpanel-placeholder"}})])])},n.staticRenderFns=[],n._scopeId="data-v-22b3512e"},{"services/floatbar":360}],214:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("components/FormHeader.vue"),a=t(i),o=e("components/FormFooter.vue"),s=t(o);r["default"]={name:"g3w-form",data:function(){return{state:{},switchcomponent:!1,body:{components:{before:[],after:[]}}}},components:{g3wformheader:a["default"],G3wFormFooter:s["default"]},transitions:{addremovetransition:"showhide"},methods:{isRootComponent:function(e){return this.$options.service.isRootComponent(e)},backToRoot:function(){this.$options.service.setRootComponent()},handleRelation:function(e){this.$options.service.handleRelation(e)},disableComponent:function(e){var t=e.id,r=e.disabled,n=void 0!==r&&r;this.$options.service.disableComponent({id:t,disabled:n})},resizeForm:function(e){this.$options.service.setCurrentFormPercentage(e)},switchComponent:function(e){this.switchcomponent=!0,this.$options.service.setCurrentComponentById(e)},changeInput:function(e){return this.$options.service.changeInput(e)},addToValidate:function(e){this.$options.service.addToValidate(e)},removeToValidate:function(e){this.$options.service.removeToValidate(e)},reloadLayout:function(){var e=$(this.$el).height();if(e){var t=$(this.$refs.g3w_form_footer.$el),r=$(this.$refs.g3wform_body),n=t.height()?t.height()+50:50,i=e-($(this.$refs.g3wformheader.$el).height()+n);r.height(i)}}},updated:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$nextTick();case 2:this.switchcomponent&&setTimeout(function(){return e.switchcomponent=!1},0);case 3:case"end":return t.stop()}},r,this)}));return e}(),created:function(){var e=this;this.$options.service.getEventBus().$on("set-main-component",function(){e.switchComponent(0)}),this.$options.service.getEventBus().$on("component-validation",function(t){var r=t.id,n=t.valid;e.$options.service.setValidComponent({id:r,valid:n})}),this.$options.service.getEventBus().$on("addtovalidate",this.addToValidate),this.$options.service.getEventBus().$on("disable-component",this.disableComponent)},mounted:function(){this.$options.service.isValid(),this.$options.service.setReady(!0)},beforeDestroy:function(){this.$options.service.clearAll()}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"g3wform_content",staticStyle:{position:"relative"}},[r("bar-loader",{attrs:{loading:e.state.loading}}),e._v(" "),r("g3wformheader",{ref:"g3wformheader",attrs:{currentid:e.state.currentheaderid,headers:e.state.headers,update:e.state.update,valid:e.state.valid},on:{"resize-form":e.resizeForm,clickheader:e.switchComponent}}),e._v(" "),r("div",{ref:"g3wform_body",staticClass:"g3wform_body"},[e._l(e.body.components.before,function(t){return r(t,{tag:"component",attrs:{fields:e.state.fields}})}),e._v(" "),r("keep-alive",[r(e.state.component,{tag:"component",attrs:{handleRelation:e.handleRelation,state:e.state},on:{"hook:activated":e.reloadLayout,addtovalidate:e.addToValidate,removetovalidate:e.removeToValidate,changeinput:e.changeInput}})],1),e._v(" "),e._l(e.body.components.after,function(t){return r(t,{tag:"component",attrs:{fields:e.state.fields}})})],2),e._v(" "),r("g3w-form-footer",{ref:"g3w_form_footer",attrs:{isRootComponent:e.isRootComponent,backToRoot:e.backToRoot,state:e.state}})],1)},n.staticRenderFns=[]},{"components/FormFooter.vue":216,"components/FormHeader.vue":217}],215:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("components/InputG3WFormInputs.vue"),i=t(n);r["default"]=Vue.extend({name:"form-body",props:["state","handleRelation"],data:function(){return{show:!0}},components:{G3wFormInputs:i["default"]},methods:{addToValidate:function(e){this.$emit("addtovalidate",e)},removeToValidate:function(e){this.$emit("removetovalidate",e)},changeInput:function(e){this.$emit("changeinput",e)}},computed:{hasFormStructure:function(){return!!this.state.formstructure}}})}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("form",{staticClass:"form-horizontal g3w-form"},[r("div",{staticClass:"box-primary"},[r("div",{staticClass:"box-body"},[e.hasFormStructure?[r("tabs",{attrs:{layerid:e.state.layerid,feature:e.state.feature,handleRelation:e.handleRelation,contenttype:"editing",addToValidate:e.addToValidate,changeInput:e.changeInput,removeToValidate:e.removeToValidate,tabs:e.state.formstructure,fields:e.state.fields}})]:[r("g3w-form-inputs",{attrs:{state:e.state,addToValidate:e.addToValidate,removeToValidate:e.removeToValidate,changeInput:e.changeInput},on:{changeinput:e.changeInput,addinput:e.addToValidate,removeinput:e.removeToValidate}})]],2)])])])},n.staticRenderFns=[]},{"components/InputG3WFormInputs.vue":240}],216:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};r["default"]=Vue.extend({name:"form-footer",props:{state:{type:Object},backToRoot:{type:Function,"default":function(){}},isRootComponent:{type:Function}},data:function(){return this.originalbuttons=this.state.buttons.map(function(t){return e({},t)}),{id:"footer",active:!0,show:!0}},computed:{enableSave:function(){return this.state.valid&&this.state.update}},methods:{exec:function(e){e instanceof Function?e(this.state.fields):function(){return this.state.fields}()},btnEnabled:function(e){var t=e.enabled,r=void 0===t||t,n=e.type;return r&&("save"!==n||"save"===n&&this.enableSave)},isValid:function(){return this.state.valid}},watch:{"state.component":function(e){this.show=this.isRootComponent(e)},"state.update":{immediate:!0,handler:function(t){var r=this;this.state.buttons.find(function(n,i){n.eventButtons&&n.eventButtons.update&&(n.eventButtons.update[t]?r.state.buttons.splice(i,1,e({},n,n.eventButtons.update[t])):r.state.buttons.splice(i,1,r.originalbuttons[i]))})}}},activated:function(){this.active=!0},deactivated:function(){this.active=!1}})}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"form-group g3wform_footer"},[e.show?[e._t("default",[r("div",{staticStyle:{margin:"3px","font-weight":"bold"}},[e._v("\n        * "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.form.footer.required_fields",expression:"'sdk.form.footer.required_fields'"}]}),e._v(" "),e.state.footer.message?r("div",{style:[e.state.footer.style]},[e._v(e._s(e.state.footer.message))]):e._e()]),e._v(" "),e._l(e.state.buttons,function(t){return r("button",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.btnEnabled(t),expression:"!btnEnabled(button)"},{name:"t",rawName:"v-t",value:t.title,expression:"button.title"}],key:t.id,staticClass:"btn ","class":[t["class"]],attrs:{update:e.state.update,valid:e.state.valid},on:{click:function(r){return r.stopPropagation(),r.preventDefault(),e.exec(t.cbk)}}})})])]:[r("button",{directives:[{name:"t",rawName:"v-t",value:"back",expression:"'back'"}],staticClass:"btn skin-button",on:{click:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"prevet",void 0,t.key,void 0)?null:(t.stopPropagation(),e.backToRoot(t))}}})]],2)},n.staticRenderFns=[]},{}],217:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=Vue.extend({name:"form-header",props:{headers:{type:Array,"default":[]},currentid:{type:String},update:{type:Boolean},valid:{type:Boolean}},methods:{click:function(e){this.currentid!==e&&this.headers.length>1&&this.$emit("clickheader",e)},resizeForm:function(e){this.$emit("resize-form",e)}}})}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"g3wform_header box-header with-border",staticStyle:{display:"flex","flex-direction":"column"}},[r("section",{staticClass:"g3wform_header_content"},e._l(e.headers,function(t){return r("span",{key:t.id,staticClass:"title","class":[{item_selected:e.currentid===t.id&&e.headers.length>1},[e.headers.length>1?"tabs":"one"]],staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"},style:{fontSize:e.isMobile()&&"1em !important"},on:{click:function(r){return r.stopPropagation(),e.click(t.id)}}},[t.icon?r("span",{staticStyle:{"margin-right":"5px"}},[r("i",{"class":t.icon})]):e._e(),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t:pre",value:t.title,expression:"header.title",arg:"pre"}],staticClass:"g3w-long-text"},[e._v(e._s(t.name))]),e._v(" "),r(t.component,{tag:"component",attrs:{valid:e.valid,update:e.update}})],1)}),0)])},n.staticRenderFns=[]},{}],218:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"bar-loader",props:["loading","color"],render:function(e){if(this.loading)return e("div",{style:{backgroundColor:this.color||"#FFFFFF",border:0},"class":{"bar-loader":!0}})}}},{}],219:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("store/application-state"),a=t(i),o=e("core/utils/utils"),s=o.getUniqueDomId;r["default"]={name:"datetime",props:{type:{type:String,"default":"date"},format:{type:String,"default":"YYYY-MM-DD"},minDate:{"default":!1},maxDate:{"default":!1},enabledDates:{"default":!1},value:{},label:{"default":"Date"}},data:function(){return{datetimevalue:this.value}},methods:{changeInput:function(e){},change:function(e){var t=moment(e).format(this.format);this.$emit("change",t)}},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$nextTick();case 2:this.datetimeinputelement=$(this.$refs.iddatetimepicker),this.datetimeinputelement.datetimepicker({minDate:this.minDate,maxDate:this.maxDate,defaultDate:this.datetimevalue,useCurrent:!1,allowInputToggle:!0,enabledDates:this.enabledDates,showClose:!0,format:this.format,locale:a["default"].language,toolbarPlacement:"top",widgetPositioning:{horizontal:"right"}}),this.datetimeinputelement.on("dp.change",function(t){var r=t.date;e.change(r)}),this.datetimeinputelement.on("dp.hide",function(e){}),a["default"].ismobile&&setTimeout(function(){return datetimeinputelement.blur()});case 7:case"end":return t.stop()}},r,this)}));return e}(),watch:{value:function(e){this.datetimevalue=e,this.datetimeinputelement.data("DateTimePicker").date(e)},minDate:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.datetimeinputelement.data("DateTimePicker").minDate(e);case 1:case"end":return t.stop()}},r,this)}));return e}(),maxDate:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.datetimeinputelement.data("DateTimePicker").maxDate(e);case 1:case"end":return t.stop()}},r,this)}));return e}(),enabledDates:function(e){this.datetimeinputelement.data("DateTimePicker").enabledDates(e)}},created:function(){this.id=s()}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{ref:"datimecontainer"},[r("label",{directives:[{name:"t",rawName:"v-t",value:e.label,expression:"label"}],staticStyle:{display:"block"},attrs:{"for":e.id}}),e._v(" "),r("div",{staticClass:"form-group"},[r("div",{ref:"iddatetimepicker",staticClass:"input-group date"},[r("input",{ref:"idinputdatetimepiker",staticClass:"form-control",attrs:{id:e.id,type:"text"},on:{change:e.changeInput}}),e._v(" "),r("span",{staticClass:"input-group-addon caret"},[r("span",{staticClass:"datetimeinput","class":["time"===e.type?e.g3wtemplate.getFontClass("time"):e.g3wtemplate.getFontClass("calendar")]})])])])])},n.staticRenderFns=[],n._scopeId="data-v-77191a95"},{"core/utils/utils":68,"store/application-state":373}],220:[function(e,t,r){e("vueify/lib/insert-css").insert(".divider[data-v-635acf0f]{display:block;position:relative;padding:0;margin-bottom:5px;height:0;width:100%;max-height:0;font-size:1px;line-height:0;clear:both;border:none;border-bottom:2px solid #eee}");!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"divider"}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("span",{staticClass:"divider"})},n.staticRenderFns=[],n._scopeId="data-v-635acf0f"},{"vueify/lib/insert-css":1}],221:[function(e,t,r){e("vueify/lib/insert-css").insert('.modal-content[data-v-382c6ec8]{background:hsla(0,0%,100%,.6);border-radius:3px}.modal-dialog[data-v-382c6ec8]{display:inline-block;text-align:left;vertical-align:middle}.modal[data-v-382c6ec8]{text-align:center;padding:0!important}.modal[data-v-382c6ec8]:before{content:"";display:inline-block;height:100%;vertical-align:middle;margin-right:-4px}.carousel .carousel-control span[data-v-382c6ec8]{color:#3c8dbc}');!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("store/projects"),i=t(n);r["default"]={name:"g3w-images-gallery",props:{images:{type:Array,"default":[]},id:{type:String,"default":"gallery"},active:{type:Number}},data:function(){return{carouselId:"carousel_"+Date.now()}},methods:{isActive:function(e){return e===active},isRelativePath:function(e){return _.startsWith(e,"/")||_.startsWith(e,"http")?e:i["default"].getConfig().mediaurl+e}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"modal fade modal-fullscreen force-fullscreen",attrs:{id:e.id,tabindex:"-1",role:"dialog","aria-labelledby":"","aria-hidden":"true"}},[r("div",{staticClass:"modal-dialog"},[r("div",{staticClass:"modal-content"},[r("div",{staticClass:"modal-body"},[r("div",{staticClass:"carousel slide",attrs:{id:e.carouselId,"data-interval":"false"}},[r("div",{staticClass:"carousel-inner"},e._l(e.images,function(t,n){return r("div",{staticClass:"item","class":e.active==n?"active":""},[r("img",{staticStyle:{margin:"auto"},attrs:{src:e.isRelativePath(t.src)}})])}),0),e._v(" "),e.images.length>1?r("a",{staticClass:"left carousel-control",attrs:{href:"#"+e.carouselId,role:"button","data-slide":"prev"}},[r("span",{"class":e.g3wtemplate.getFontClass("arrow-left")})]):e._e(),e._v(" "),e.images.length>1?r("a",{staticClass:"right carousel-control",attrs:{href:"#"+e.carouselId,role:"button","data-slide":"next"}},[r("span",{"class":e.g3wtemplate.getFontClass("arrow-left")})]):e._e()])])])])])},n.staticRenderFns=[],n._scopeId="data-v-382c6ec8"},{"store/projects":379,"vueify/lib/insert-css":1}],222:[function(e,t,r){e("vueify/lib/insert-css").insert(".show-hide-geo[data-v-9bc5e372]{color:#3c8dbc;cursor:pointer;font-size:1.2em}");!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("mixins");r["default"]={name:"g3w-geospatial",props:{data:{}},mixins:[t.geoMixin],data:function(){return{layerId:"table_layer_"+Date.now(),visible:!1,id:"geo_table_"+Date.now()}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"geo-content"},[r("span",{staticClass:"show-hide-geo","class":[e.visible?e.g3wtemplate.getFontClass("eye-close"):e.g3wtemplate.getFontClass("eye")],on:{click:function(t){return t.stopPropagation(),e.showLayer()}}})])},n.staticRenderFns=[],n._scopeId="data-v-9bc5e372"},{mixins:343,"vueify/lib/insert-css":1}],223:[function(e,t,r){e("vueify/lib/insert-css").insert(".help_div_container[data-v-5c881206]{color:#fff;text-align:justify;position:relative;border-radius:3px;margin:5px 2px;white-space:pre-line;background-color:#384246!important}.help_icon[data-v-5c881206]{text-align:center;font-size:.7em;margin-top:-4px;margin-left:-4px;background-color:#222d32;font-weight:700;color:#fff;position:absolute;top:0;left:0;width:15px;height:15px;box-shadow:0 3px 5px rgba(0,0,0,.5);border:1px solid #fff;border-radius:50%}.g3w-help-message-content[data-v-5c881206]{max-height:200px;padding:10px;overflow-y:auto}");!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"helpdiv",props:{message:{type:String,required:!0},type:{type:String,"default":"info"}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"help_div_container"},[r("span",{staticClass:"help_icon"},[e._v("i")]),e._v(" "),r("div",{directives:[{name:"t",rawName:"v-t",value:e.message,expression:"message"}],staticClass:"g3w-help-message-content"})])},n.staticRenderFns=[],n._scopeId="data-v-5c881206"},{"vueify/lib/insert-css":1}],224:[function(e,t,r){e("vueify/lib/insert-css").insert(".img-responsive[data-v-fb7b585e]{cursor:pointer}.g3w-image[data-v-fb7b585e]{padding-left:0!important;min-width:100px;max-width:100%;cursor:pointer}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("components/GlobalGallery.vue"),a=t(i);r["default"]={name:"g3w-image",props:{value:{}},data:function(){return{galleryId:"gallery_"+Date.now(),active:null}},components:{"g3w-images-gallery":a["default"]},computed:{values:function(){return Array.isArray(this.value)?this.value:[this.value]}},methods:{getSrc:function(e){return"object"===("undefined"==typeof e?"undefined":n(e))?e.photo:e},showGallery:function(e){this.active=e,"object"===n(this.value)&&(this.value.active=!0),$("#"+this.galleryId).modal("show")},getGalleryImages:function(){var e=this,t=[];return this.values.forEach(function(r){t.push({src:e.getSrc(r)})}),t}},created:function(){}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container-fluid"},[r("div",{staticClass:"row"},e._l(e.values,function(t,n){return r("div",{staticClass:"g3w-image col-md-6 col-sm-12"},[r("img",{staticClass:"img-thumbnail",attrs:{src:e.getSrc(t)},on:{click:function(t){return e.showGallery(n)}}})])}),0),e._v(" "),r("g3w-images-gallery",{attrs:{id:e.galleryId,active:e.active,images:e.getGalleryImages()}})],1)},n.staticRenderFns=[],n._scopeId="data-v-fb7b585e"},{"components/GlobalGallery.vue":221,"vueify/lib/insert-css":1}],225:[function(e,t,r){e("vueify/lib/insert-css").insert(".g3w-layer-positions[data-v-32d24c93]{display:flex;flex-direction:column;margin:5px 0}.g3w-layer-positions-info-message[data-v-32d24c93]{margin-bottom:5px;font-weight:700}.g3w-layer-positions-checkboxes[data-v-32d24c93]{display:flex;justify-content:space-between}");!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("app/constant"),n=e("core/utils/utils"),i=n.getUniqueDomId;r["default"]={name:"layerspositions",props:{position:{type:String,"default":t.MAP_SETTINGS.LAYER_POSITIONS["default"]}},data:function(){return{layerpositions:t.MAP_SETTINGS.LAYER_POSITIONS.getPositions()}},methods:{change:function(){this.$emit("layer-position-change",this.position)}},created:function(){var e=this;this.ids={layerpositions:i()},this.layerpositions.forEach(function(t){return e.ids[t]=i()}),this.change()}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"g3w-layer-positions",attrs:{id:e.ids.layerpositions}},[r("div",{directives:[{name:"t",rawName:"v-t",value:"layer_position.message",expression:"`layer_position.message`"}],staticClass:"g3w-layer-positions-info-message"}),e._v(" "),r("div",{staticClass:"g3w-layer-positions-checkboxes"},e._l(e.layerpositions,function(t){return r("div",{key:t},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.position,expression:"position"}],staticClass:"form-control magic-radio",attrs:{type:"radio",id:e.ids[t]},domProps:{value:t,checked:e.position===t,checked:e._q(e.position,t)},on:{change:[function(r){e.position=t},e.change]}}),e._v(" "),r("label",{directives:[{name:"t",rawName:"v-t",value:"layer_position."+t,expression:"`layer_position.${layerposition}`"}],attrs:{"for":e.ids[t]}})])}),0)])},n.staticRenderFns=[],n._scopeId="data-v-32d24c93"},{"app/constant":4,"core/utils/utils":68,"vueify/lib/insert-css":1}],226:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"progressbar",props:["progress"],render:function(e){if(null!==this.progress&&void 0!==this.progress)return e("div",{style:{margin:"5px 0 5px 0",width:"100%",backgroundColor:"#FFFFFF",border:0,borderRadius:"3px"}},[e("div",{style:{width:(this.progress<10?10:this.progress)+"%",display:"flex",justifyContent:"center",fontWeight:"bold"},"class":{"skin-background-color":!0}},[e("span",this.progress+"%")])])}}},{}],227:[function(e,t,r){e("vueify/lib/insert-css").insert(".min-max-label[data-v-ec65ba9a]{align-self:end;font-weight:700}");!function(){function t(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("core/utils/utils"),i=n.debounce;r["default"]={name:"range",props:{id:{required:!0},label:{type:"String","default":""},min:{type:Number,"default":0},max:{type:Number,"default":10},step:{type:Number,"default":1},labelValue:{},value:{"default":0},sync:{type:Boolean,"default":!1},showValue:{type:Boolean,"default":!1},unit:{type:String,"default":""}},data:function(){return{}},methods:{changeBackGround:function(e){this.$refs["range-input"].style.backgroundSize=(e?100*(e-this.min)/(this.max-this.min):0)+"% 100%"},setValue:function(e){this.changedValue(e)},change:function(e){var t=1*e.target.value;this.changedValue(t)},emitChangeValue:function(e){this.value=e,this.$emit("change-range",{id:this.id,value:e})}},watch:{value:function(e){this.changeBackGround(e),this.sync&&this.emitChangeValue(e)}},created:function(){var e=this;this.changedValue=this.sync?function(){return e.$emit("changed")}:i(function(t){e.emitChangeValue(t)})},mounted:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.changeBackGround(this.value);case 3:case"end":return e.stop()}},n,this)}));return e}(),beforeDestroy:function(){}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("section",{staticStyle:{display:"flex","justify-content":"space-between","font-weight":"bold"}},[r("section",{staticStyle:{"align-self":"flex-end"}},[r("span",{staticClass:"min-max-label"},[e._v(e._s(e.min))]),e._v(" "),r("span",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(e.unit))])]),e._v(" "),r("div",{staticStyle:{display:"flex","flex-direction":"column",margin:"0 3px"}},[r("label",{directives:[{name:"t",rawName:"v-t",value:e.label,expression:"label"}],staticClass:"skin-color",staticStyle:{display:"block"},attrs:{"for":e.id}}),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],ref:"range-input",attrs:{type:"range",id:e.id,min:e.min,max:e.max,step:e.step},domProps:{value:e.value},on:{change:e.change,__r:function(t){e.value=t.target.value}}})]),e._v(" "),r("section",{staticStyle:{"align-self":"flex-end"}},[r("span",{staticClass:"min-max-label"},[e._v(e._s(e.max))]),e._v(" "),r("span",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(e.unit))])])]),e._v(" "),e.showValue?[r("span",[e._v(e._s(e.value))]),e._v(" "),r("span",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(e.unit))])]:e._e()],2)},n.staticRenderFns=[],n._scopeId="data-v-ec65ba9a"},{"core/utils/utils":68,"vueify/lib/insert-css":1}],228:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("services/gui"),a=t(i);r["default"]={name:"g3w-resize",props:{show:{type:Boolean,required:!0,"default":!0},orientation:{type:String,"default":"h"},where:{type:String,"default":"document"},moveFnc:{type:Function,"default":function(e){}}},computed:{style:function(){return{minWidth:"5px",backgroundColor:"#dddddd",cursor:"v"===this.orientation?"ns-resize":"col-resize"}}},methods:{wrapMoveFnc:function(e){this.domElementMoveListen.addEventListener("mouseup",this.stop,{once:!0}),this.moveFnc(e)},start:function(){this.domElementMoveListen.addEventListener("mousemove",this.wrapMoveFnc)},stop:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.domElementMoveListen.removeEventListener("mousemove",this.wrapMoveFnc),e.next=3,this.$nextTick();case 3:a["default"].emit("resize");case 4:case"end":return e.stop()}},r,this)}));return e}()},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.domElementMoveListen,this.domElementMoveListen="content"===this.where?document.getElementById("g3w-view-content"):document;case 2:case"end":return e.stop()}},r,this)}));return e}(),destroyed:function(){this.domElementMoveListen=null}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],style:e.style,attrs:{id:e.$attrs.id},on:{mousedown:function(t){return t.stopPropagation(),e.start(t)}}})},n.staticRenderFns=[]},{"services/gui":361}],229:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("services/gui"),a=t(i);
r["default"]={name:"resize-icon",props:{type:{type:String,"default":"h"}},data:function(){return{show:"undefined"!=typeof this.type}},watch:{type:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.show=!1,e.next=3,this.$nextTick();case 3:this.show=!0;case 4:case"end":return e.stop()}},r,this)}));return e}()},methods:{toggleFull:function(){a["default"].toggleFullViewContent(),a["default"].emit("resize")},resetToDefault:function(){a["default"].resetToDefaultContentPercentage(),a["default"].emit("resize")}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[e.show?r("i",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:bottom.create",value:"enlange_reduce",expression:"'enlange_reduce'",arg:"bottom",modifiers:{create:!0}}],staticClass:"action-button skin-color-dark","class":e.g3wtemplate.getFontClass("resize-"+this.type),staticStyle:{cursor:"pointer","margin-right":"3px"},on:{click:e.toggleFull}}):e._e(),e._v(" "),r("i",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"reset_default",expression:"'reset_default'",arg:"left",modifiers:{create:!0}}],staticClass:"action-button skin-color-dark","class":e.g3wtemplate.getFontClass("resize-default"),staticStyle:{cursor:"pointer"},on:{click:e.resetToDefault}})])},n.staticRenderFns=[]},{"services/gui":361}],230:[function(e,t,r){e("vueify/lib/insert-css").insert(".br[data-v-ae798b72]{border-radius:8px}.card[data-v-ae798b72]{width:80%;padding:10px 20px;margin:50px auto}.item[data-v-ae798b72]{height:15px;background:#ccc;margin-top:15px}.item-light[data-v-ae798b72]{background:#ddd}.text80[data-v-ae798b72]{width:80%}.chart-wrapper[data-v-ae798b72]{height:50px;display:flex;align-items:baseline;margin-bottom:20px}.chart-item[data-v-ae798b72]{height:100%;width:15px;background:#ccc;margin-right:10px}.chart-item-80[data-v-ae798b72]{height:80%}");!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"skeleton",mounted:function(){this.$nextTick(function(){})}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement;e._self._c||t;return e._m(0)},n.staticRenderFns=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"card br"},[r("div",{staticClass:"chart-wrapper"},[r("div",{staticClass:"chart-item br"}),e._v(" "),r("div",{staticClass:"chart-item chart-item-80 item-light br"}),e._v(" "),r("div",{staticClass:"chart-item br"}),e._v(" "),r("div",{staticClass:"chart-item br chart-item-80"})]),e._v(" "),r("div",{staticClass:"item br text80"}),e._v(" "),r("div",{staticClass:"item item-light br"}),e._v(" "),r("div",{staticClass:"item br"}),e._v(" "),r("div",{staticClass:"item item-light br text80"})])}],n._scopeId="data-v-ae798b72"},{"vueify/lib/insert-css":1}],231:[function(e,t,r){e("vueify/lib/insert-css").insert(".formquerytabs[data-v-1c509410]{overflow:hidden!important;display:flex;flex-wrap:wrap}.formquerytabs>li[data-v-1c509410]{flex:1;display:flex}.formquerytabs>li>a[data-v-1c509410]{font-weight:700;flex:1}.tab-content[data-v-1c509410]{//margin-top:10px}.nav-tabs>li>a.mobile[data-v-1c509410]{padding:5px 10px}.tab_a[data-v-1c509410]{padding:5px;margin-right:0!important;//border:1px solid #eee;border-bottom:0;margin-bottom:3px;border-radius:3px 3px 0 0}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/expression/tabservice"),a=t(i),o=e("components/GlobalTabsNode.vue"),s=t(o),l=e("services/gui"),u=t(l),c=e("core/utils/utils"),d=c.getUniqueDomId,f=c.noop;r["default"]={name:"tabs",props:{group:{type:Boolean,"default":!1},contenttype:{"default":"query"},layerid:{required:!0},tabs:{required:!0},feature:{required:!0},fields:{required:!0},addToValidate:{type:Function,"default":f},removeToValidate:{type:Function,"default":f},changeInput:{type:Function,"default":f},showRelationByField:{type:Boolean,"default":!0},handleRelation:{type:Function,"default":function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.relation,r=e.layerId,n=e.feature;return u["default"].getService("queryresults").showRelation({relation:t,layerId:r,feature:n})}}},data:function(){return{ids:[]}},computed:{required_fields:function(){return"editing"===this.contenttype&&this.fields.filter(function(e){return e.validate.required}).map(function(e){return e.name})},show:function(){return this.tabs.reduce(function(e,t){return e||void 0===t.visible||!!t.visible},!1)}},methods:{setVisibility:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){var t;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,a["default"].getVisibility({qgs_layer_id:this.layerid,expression:e.visibility_expression.expression,feature:this.feature,contenttype:this.contenttype});case 2:t=r.sent,e.visible=t;case 4:case"end":return r.stop()}},r,this)}));return e}(),setEditingRequireTab:function(e){var t=this,r=!1;return r=void 0===e.nodes?this.required_fields.indexOf(e.field_name)!==-1:!!e.nodes.find(function(e){return t.setEditingRequireTab(e)})},getField:function(e){return this.fields.find(function(t){return t.name===e})}},components:{Node:s["default"]},created:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e,t,i,a,o,s,l,u,c=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:for(this.unwatch=[],e=function(e){e.visibility_expression&&(void 0===e.visible&&c.$set(e,"visible",0),c.setVisibility(e)),"editing"===c.contenttype&&(void 0===e.required&&(e.required=c.setEditingRequireTab(e)),e.visibility_expression&&e.visibility_expression.referenced_columns.forEach(function(t){var r=c.fields.find(function(e){return e.name===t});c.unwatch.push(c.$watch(function(){return r.value},function(){var t=n(regeneratorRuntime.mark(function i(t){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:c.feature.set(r.name,t),c.setVisibility(e);case 2:case"end":return n.stop()}},i,c)}));return function(e){return t.apply(this,arguments)}}()))})),c.ids.push("tab_"+d())},t=!0,i=!1,a=void 0,r.prev=5,o=this.tabs[Symbol.iterator]();!(t=(s=o.next()).done);t=!0)l=s.value,e(l);r.next=13;break;case 9:r.prev=9,r.t0=r["catch"](5),i=!0,a=r.t0;case 13:r.prev=13,r.prev=14,!t&&o["return"]&&o["return"]();case 16:if(r.prev=16,!i){r.next=19;break}throw a;case 19:return r.finish(16);case 20:return r.finish(13);case 21:this.root_tabs=[],this.group?this.root_tabs=[this.tabs]:(u=[],this.tabs.forEach(function(e){e.nodes?u.push(e):(u.length&&(c.root_tabs.push([].concat(u)),u.splice(0)),c.root_tabs.push({nodes:[e]}))}),u.length&&this.root_tabs.push(u));case 23:case"end":return r.stop()}},r,this,[[5,9,13,21],[14,,16,20]])}));return e}(),beforeDestroy:function(){this.unwatch.forEach(function(e){return e()}),this.unwatch=null}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.show?r("div",{staticClass:"tabs-wrapper"},[e._l(e.root_tabs,function(t){return[Array.isArray(t)?[r("ul",{staticClass:"formquerytabs nav nav-tabs"},[e._l(t,function(t,n){return[void 0===t.visible||t.visible?r("li",{"class":{active:0===n}},[r("a",{staticClass:"tab_a","class":{mobile:e.isMobile(),"group-title":e.group},style:{fontSize:e.isMobile()?"1.0em":(e.group?"1.1":"1.2")+"em"},attrs:{"data-toggle":"tab",href:"#"+e.ids[n]}},[e._v("\n              "+e._s(t.name)+" "),"editing"===e.contenttype&&t.required?r("span",{staticStyle:{"padding-left":"3px","font-size":"1.1em"}},[e._v("*")]):e._e()])]):e._e()]})],2),e._v(" "),r("div",{staticClass:"tab-content","class":{editing:"editing"===e.contenttype}},[e._l(t,function(t,n){return[void 0===t.visible||t.visible?r("div",{staticClass:"tab-pane fade","class":{"in active":0===n},attrs:{id:e.ids[n]}},[r("node",{attrs:{showRelationByField:e.showRelationByField,handleRelation:e.handleRelation,feature:e.feature,layerid:e.layerid,contenttype:e.contenttype,addToValidate:e.addToValidate,removeToValidate:e.removeToValidate,changeInput:e.changeInput,fields:e.fields,showTitle:!1,node:t}})],1):e._e()]})],2)]:r("node",{attrs:{showRelationByField:e.showRelationByField,handleRelation:e.handleRelation,feature:e.feature,layerid:e.layerid,contenttype:e.contenttype,addToValidate:e.addToValidate,removeToValidate:e.removeToValidate,changeInput:e.changeInput,fields:e.fields,showTitle:!1,node:t}})]})],2):e._e()},n.staticRenderFns=[],n._scopeId="data-v-1c509410"},{"components/GlobalTabsNode.vue":232,"core/expression/tabservice":11,"core/utils/utils":68,"services/gui":361,"vueify/lib/insert-css":1}],232:[function(e,t,r){e("vueify/lib/insert-css").insert(".tab-node[data-v-c0eb71cc]{min-width:0;overflow:hidden}.title[data-v-c0eb71cc]{font-weight:700;width:100%;color:#fff;padding:3px;margin-top:5px;margin-bottom:5px;border-radius:2px}.node-row[data-v-c0eb71cc]{margin-bottom:0;column-gap:2px;margin-top:0;display:grid;grid-auto-columns:minmax(0,1fr);grid-auto-flow:column}.row.mobile[data-v-c0eb71cc]{margin-bottom:0!important}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=e("components/InputG3W.vue"),a=t(i),o=e("store/projects"),s=t(o),l=e("services/gui"),u=(t(l),e("gui/fields/fields"));r["default"]={name:"node",props:["contenttype","node","fields","showTitle","addToValidate","removeToValidate","changeInput","layerid","feature","showRelationByField","handleRelation"],components:n({G3wInput:a["default"]},u),data:function(){return{context:this.contenttype,editing_required:!1}},computed:{filterNodes:function c(){var e=this,c=this.node.nodes&&this.node.nodes.filter(function(t){return"group"===e.getNodeType(t)||(!t.nodes&&t.name&&"group"!=e.getNodeType(t)?(t.relation=!0,!0):!!e.fields.find(function(e){var r=t.field_name?t.field_name.replace(/ /g,"_"):t.field_name;return e.name===r||t.relation}))});return c||[]},nodesLength:function(){return this.filterNodes.length},rows:function(){var e=1;if(0===this.nodesLength)e=0;else if(this.columnNumber<=this.nodesLength){var t=this.nodesLength%this.columnNumber;e=Math.floor(this.nodesLength/this.columnNumber)+t}return e},columnNumber:function(){var e=parseInt(this.node.columncount)?parseInt(this.node.columncount):1;return e>this.nodesLength?this.nodesLength:e},showGroupTile:function(){return this.showTitle&&this.node.showlabel&&this.node.groupbox}},methods:{loadingRelation:function(e){var t=s["default"].getCurrentProject().getLayerById(this.layerid),r=t.getRelationById(e.name);return r.state},isRelationDisabled:function(e){return void 0===this.getRelationName(e.name)||"editing"===this.contenttype&&this.isRelationChildLayerNotEditable(e)},getRelationName:function(e){var t=s["default"].getCurrentProject().getRelationById(e);return t&&t.name},isRelationChildLayerNotEditable:function(e){var t=(e.nmRelationId,e.name),r=s["default"].getCurrentProject(),n=r.getRelationById(t),i=n.referencingLayer,a=r.getLayerById(i);return!a.isEditable()},getNodes:function(e){var t=(e-1)*this.columnNumber;return this.filterNodes.slice(t,this.columnNumber+t)},getNode:function(e,t){return this.getNodes(e)[t-1]},getField:function(e){if(e.relation)return e;var t=this.fields.find(function(t){var r=e.field_name?e.field_name.replace(/ /g,"_"):e.field_name;return t.name===r});return t},getNodeType:function(e){var t=e.groupbox||e.nodes?"group":e.relation?"relation":"field";return"field"!==t||void 0!==e.alias&&""!==e.alias||(e.alias=e.field_name),t},getComponent:function(e){return e.relation?void 0:e.query?e.input.type:"g3w-input"}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"tab-node group"},[e.showGroupTile?r("h5",{staticClass:"title group-title","class":{mobile:e.isMobile()},style:{fontSize:e.isMobile()?"1em":"1.1em"}},[e._v(e._s(e.node.name))]):e._e(),e._v(" "),e._l(e.rows,function(t){return r("div",{staticClass:"node-row","class":{mobile:e.isMobile()}},[e._l(e.columnNumber,function(n){return[e.getNode(t,n)?["field"===e.getNodeType(e.getNode(t,n))?r(e.getComponent(e.getField(e.getNode(t,n))),{tag:"component",staticStyle:{padding:"5px 3px 5px 3px"},attrs:{state:e.getField(e.getNode(t,n)),changeInput:e.changeInput,addToValidate:e.addToValidate,removeToValidate:e.removeToValidate,feature:e.feature},on:{changeinput:e.changeInput,addinput:e.addToValidate,removeinput:e.removeToValidate}}):["group"===e.getNodeType(e.getNode(t,n))?r("tabs",e._b({staticClass:"sub-group",staticStyle:{width:"100% !important"},attrs:{group:!0,tabs:[e.getNode(t,n)]}},"tabs",e.$props,!1)):[e.showRelationByField?r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.isRelationDisabled(e.getNode(t,n))||e.loadingRelation(e.getNode(t,n)).loading,expression:"isRelationDisabled(getNode(row, column)) || loadingRelation(getNode(row, column)).loading"}],style:{cursor:e.showRelationByField&&"pointer"},on:{click:function(r){r.stopPropagation(),e.handleRelation({relation:e.getNode(t,n),feature:e.feature,layerId:e.layerid})}}},[r("bar-loader",{attrs:{loading:e.loadingRelation(e.getNode(t,n)).loading}}),e._v(" "),r("div",{staticStyle:{display:"flex","align-items":"center"}},[r("div",{staticClass:"query_relation_field"},[r("i",{"class":e.g3wtemplate.font[""+("query"===e.context?"relation":"pencil")]})]),e._v(" "),r("span",{staticClass:"query_relation_field_message g3w-long-text"},[r("span",{staticStyle:{"text-transform":"uppercase"}},[e._v(" "+e._s(e.getRelationName(e.getNode(t,n).name)))])])])],1):e._e()]]]:e._e()]})],2)})],2)},n.staticRenderFns=[],n._scopeId="data-v-c0eb71cc"},{"components/InputG3W.vue":239,"gui/fields/fields":120,"services/gui":361,"store/projects":379,"vueify/lib/insert-css":1}],233:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"header-item",props:["state"],methods:{showCustomModal:function(e){this.$emit("show-custom-modal-content",e)}},created:function(){this.state.type=this.state.type||"link"}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",{staticClass:"customheaderlink dropdown user user-menu",attrs:{title:e.state.title}},["link"===e.state.type?r("a",{staticClass:"dropdown-toggle","class":{imagelink:!!e.state.img},attrs:{href:e.state.url,target:e.state.target}},[e.state.img?r("img",{staticStyle:{"max-height":"20px"},attrs:{src:e.state.img}}):r("span",[e.state.i18n?r("span",{directives:[{name:"t",rawName:"v-t",value:e.state.title,expression:"state.title"}]}):r("span",[e._v(e._s(e.state.title))])])]):"modal"===e.state.type?r("a",{staticClass:"dropdown-toggle",staticStyle:{cursor:"pointer"},attrs:{"data-toggle":"modal","data-target":"#custom_modal"},on:{click:function(t){return e.showCustomModal(e.state.id)}}},[r("span",[e._v(e._s(e.state.title))])]):e._e()])},n.staticRenderFns=[]},{}],234:[function(e,t,r){e("vueify/lib/insert-css").insert(".control-label[data-v-7c8b5e58]{text-align:left!important;padding-top:0!important;margin-bottom:3px}");!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},n=e("mixins");r["default"]=t({name:"InputBase",props:["state"]},n.baseInputMixin)}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.state.visible?r("div",{staticClass:"form-group"},[e._t("label",[r("label",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"}],staticClass:"col-sm-12 control-label",attrs:{"for":e.state.name}},[e._v(e._s(e.state.label)+"\n      "),e.state.validate&&e.state.validate.required?r("span",[e._v("*")]):e._e(),e._v(" "),e.showhelpicon?r("i",{staticClass:"skin-color","class":e.g3wtemplate.font.info,staticStyle:{"margin-left":"3px",cursor:"pointer"},on:{click:e.showHideHelp}}):e._e(),e._v(" "),e._t("label-action")],2)]),e._v(" "),r("div",{staticClass:"col-sm-12"},[e._t("loading",["loading"===e.loadingState?r("div",{staticStyle:{position:"relative",width:"100%"},attrs:{slot:"loading"},slot:"loading"},[r("bar-loader",{attrs:{loading:"true"}})],1):e._e()]),e._v(" "),e._t("body"),e._v(" "),e._t("message",[e.notvalid?r("p",{staticClass:"g3w-long-text error-input-message",staticStyle:{margin:"0"},domProps:{innerHTML:e._s(e.state.validate.message)}}):e.state.info?r("p",{staticStyle:{margin:"0"},domProps:{innerHTML:e._s(e.state.info)}}):e._e()]),e._v(" "),e.state.help&&this.state.help.visible?r("div",{staticClass:"g3w_input_help skin-background-color extralighten",domProps:{innerHTML:e._s(e.state.help.message)}}):e._e()],2)],2):e._e()},n.staticRenderFns=[],n._scopeId="data-v-7c8b5e58"},{mixins:343,"vueify/lib/insert-css":1}],235:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("mixins"),n=e("gui/inputs/input"),i=e("core/utils/utils"),a=i.getUniqueDomId;r["default"]={name:"input-checkbox",mixins:[n,t.widgetMixins],data:function(){return{value:null,label:null,id:a()}},methods:{setLabel:function(){this.label=this.service.convertCheckedToValue(this.value)},setValue:function(){this.value=this.service.convertValueToChecked()},changeCheckBox:function(){this.setLabel(),this.widgetChanged()},stateValueChanged:function(){this.setValue(),this.setLabel()}},created:function(){this.value=this.state.forceNull?this.value:this.service.convertValueToChecked()},mounted:function(){this.state.forceNull||this.setLabel()}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baseinput",{attrs:{state:e.state}},[r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"}],staticStyle:{height:"20px","margin-top":"8px"},attrs:{slot:"body"},slot:"body"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],staticClass:"magic-checkbox","class":{"input-error-validation":e.notvalid},staticStyle:{width:"100%"},attrs:{tabIndex:e.tabIndex,type:"checkbox",id:e.id},domProps:{checked:Array.isArray(e.value)?e._i(e.value,null)>-1:e.value},on:{change:[function(t){var r=e.value,n=t.target,i=!!n.checked;if(Array.isArray(r)){var a=null,o=e._i(r,a);n.checked?o<0&&(e.value=r.concat([a])):o>-1&&(e.value=r.slice(0,o).concat(r.slice(o+1)))}else e.value=i},e.changeCheckBox]}}),e._v(" "),r("label",{attrs:{"for":e.id}},[e._v(e._s(e.label))])])])},n.staticRenderFns=[]},{"core/utils/utils":68,"gui/inputs/input":131,mixins:343}],236:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("gui/inputs/input");r["default"]={name:"input-color",mixins:[t]}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baseinput",{attrs:{state:e.state}},[r("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.value,expression:"state.value"}],staticClass:"form-control","class":{"input-error-validation":e.notvalid},staticStyle:{cursor:"pointer"},attrs:{slot:"body",placeholder:e.state["default"],type:"color",tabIndex:e.tabIndex,field:e.state.name,id:e.state.name},domProps:{value:e.state.value},on:{change:e.change,input:function(t){t.target.composing||e.$set(e.state,"value",t.target.value)}},slot:"body"})])},n.staticRenderFns=[]},{"gui/inputs/input":131}],237:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("store/application-state"),a=t(i),o=e("mixins"),s=e("gui/inputs/input"),l=e("core/utils/utils"),u=l.getUniqueDomId;r["default"]={name:"input-datetime-picker",mixins:[s,o.resizeMixin],data:function(){var e=u();return{widget_container:{top:0,left:0},iddatetimepicker:"datetimepicker_"+e,idinputdatetimepiker:"inputdatetimepicker_"+e}},methods:{resize:function(){var e=$("#"+this.iddatetimepicker);e&&e.data("DateTimePicker")&&e.data("DateTimePicker").hide()},timeOnly:function(){return!this.state.input.options.formats[0].date},onDatePickerChange:function(){var e=$("#"+this.idinputdatetimepiker).val();this.state.value=_.isEmpty(_.trim(e))?null:moment(e,this.datetimedisplayformat).format(this.datetimefieldformat),this.change()},onDatePickerShow:function(e){var t=this;this.widget_container.top=0,this.widget_container.left=0,setTimeout(function(){var e=t.$refs.datetimepicker_body.getBoundingClientRect(),r=document.querySelector(".bootstrap-datetimepicker-widget").getBoundingClientRect();t.widget_container.top=e.top+(e.top<r.height?e.height+Math.abs(e.top-r.height)+20:0),t.widget_container.left=e.left-(e.width<r.width?r.width:e.width),t.$emit("datetimepickershow")})},onDatePickerHide:function(e){this.$emit("datetimepickershow")}},watch:{"state.value":function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){var t;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(e===$("#"+this.idinputdatetimepiker).val()){r.next=5;break}return t=null!==e?moment(e,this.datetimefieldformat).format(this.datetimedisplayformat):e,r.next=4,this.$nextTick();case 4:$("#"+this.idinputdatetimepiker).val(t);case 5:case"end":return r.stop()}},r,this)}));return e}()},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e,t,n,i,o,s,l,u,c,d,f,p,h,v,g=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=this.state.input.options,t=e.formats,n=void 0===t?[]:t,i=e.layout,o=void 0===i?{vertical:"top",horizontal:"left"}:i,s=n[0],l=s.minDate,u=s.maxDate,c=s.fieldformat,d=s.enabledDates,f=s.disabledDates,p=s.displayformat,h=s.useCurrent,r.next=4,this.$nextTick();case 4:this.datetimedisplayformat=this.service.convertQGISDateTimeFormatToMoment(p),this.datetimefieldformat=this.service.convertQGISDateTimeFormatToMoment(c),this.service.setValidatorOptions({fielddatetimeformat:this.datetimefieldformat}),v=moment(this.state.value,this.datetimefieldformat,!0).isValid()?moment(this.state.value,this.datetimefieldformat).toDate():null,$("#"+this.iddatetimepicker).datetimepicker({defaultDate:v,format:this.datetimedisplayformat,ignoreReadonly:!0,allowInputToggle:!0,enabledDates:d,disabledDates:f,useCurrent:h,toolbarPlacement:"top",minDate:l,maxDate:u,widgetParent:$(this.$refs.datimewidget_container),widgetPositioning:{vertical:o.vertical||"top",horizontal:o.horizontal||"left"},showClose:!0,locale:this.service.getLocale()}),$("#"+this.iddatetimepicker).on("dp.change",this.onDatePickerChange),$("#"+this.iddatetimepicker).on("dp.show",this.onDatePickerShow),$("#"+this.iddatetimepicker).on("dp.hide",this.onDatePickerHide),a["default"].ismobile&&setTimeout(function(){$("#"+g.idinputdatetimepiker).blur()});case 13:case"end":return r.stop()}},r,this)}));return e}()}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baseinput",{attrs:{state:e.state}},[r("div",{ref:"datetimepicker_body",attrs:{slot:"body"},slot:"body"},[r("div",{ref:"datimewidget_container",style:{top:e.widget_container.top+"px",left:e.widget_container.left+"px",position:"fixed",zIndex:1e4}}),e._v(" "),r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"}],staticClass:"input-group date",attrs:{id:e.iddatetimepicker}},[r("input",{staticClass:"form-control","class":{"input-error-validation":e.notvalid},attrs:{type:"text",id:e.idinputdatetimepiker,tabIndex:e.tabIndex,readonly:!e.editable||e.isMobile()?"readonly":null}}),e._v(" "),r("span",{staticClass:"input-group-addon caret"},[r("span",{"class":[e.g3wtemplate.getFontClass(e.timeOnly()?"time":"calendar")]})])])])])},n.staticRenderFns=[]},{"core/utils/utils":68,"gui/inputs/input":131,mixins:343,"store/application-state":373}],238:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("gui/inputs/input");r["default"]={name:"input-float",mixins:[t]}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baseinput",{attrs:{state:e.state}},[r("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.value,expression:"state.value"}],staticClass:"form-control","class":{"input-error-validation":e.notvalid},staticStyle:{width:"100%"},attrs:{slot:"body",tabIndex:e.tabIndex,type:"number",step:e.state.step||1,placeholder:e.state["default"]},domProps:{value:e.state.value},on:{change:e.change,input:[function(t){t.target.composing||e.$set(e.state,"value",t.target.value)},e.change]},slot:"body"})])},n.staticRenderFns=[]},{"gui/inputs/input":131}],239:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},n=e("gui/inputs/inputs");r["default"]={name:"g3w-input",props:{state:{required:!0},addToValidate:{type:Function,required:!0},removeToValidate:{type:Function,required:!0},changeInput:{type:Function,required:!0}},components:t({},n),computed:{type:function(){if("child"!==this.state.type)return this.state.input.type?this.state.input.type+"_input":this.state.type+"_input"}},created:function(){"child"===this.state.type||this.state.input.options||(this.state.input.options={})}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.state.visible?r("div",["child"!==e.state.type?r("div",[r(e.type,{tag:"component",attrs:{changeInput:e.changeInput,addToValidate:e.addToValidate,removeToValidate:e.removeToValidate,state:e.state},on:{changeinput:e.changeInput,addinput:e.addToValidate,removeinput:e.removeToValidate}}),e._v(" "),r("span",{staticClass:"divider"})],1):r("div",{staticClass:"skin-border-color field-child",staticStyle:{"border-top":"2px solid"}},[r("h4",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(e.state.label))]),e._v(" "),r("div",[e._v(" "+e._s(e.state.description)+" ")]),e._v(" "),e._l(e.state.fields,function(t){return r("g3w-input",{key:t.name,attrs:{state:t,changeInput:e.changeInput,addToValidate:e.addToValidate,removeToValidate:e.removeToValidate},on:{changeinput:e.changeInput,addinput:e.addToValidate,removeinput:e.removeToValidate}})})],2)]):e._e()},n.staticRenderFns=[],n._scopeId="data-v-08f01cf8"},{"gui/inputs/inputs":132}],240:[function(e,t,r){e("vueify/lib/insert-css").insert("#g3w-for-inputs-required-inputs-message[data-v-40788b36]{margin-bottom:5px;font-weight:700;text-align:center;display:flex;align-items:center;justify-content:center}.box-body[data-v-40788b36]{padding:5px}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("components/InputG3W.vue"),i=t(n);r["default"]={name:"g3w-form-inputs",props:{state:{type:Object,"default":{fields:[]}},addToValidate:{type:Function},changeInput:{type:Function},show_required_field_message:{type:Boolean,"default":!1}},components:{G3wInput:i["default"]}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("form",{staticClass:"form-horizontal g3w-form"},[r("div",{staticClass:"box-primary"},[r("div",{staticClass:"box-body"},[e._l(e.state.fields,function(t){return[r("g3w-input",{attrs:{state:t,addToValidate:e.addToValidate,changeInput:e.changeInput},on:{addToValidate:e.addToValidate,changeInput:e.changeInput}})]})],2),e._v(" "),e.show_required_field_message?r("div",{attrs:{id:"g3w-for-inputs-required-inputs-message"}},[r("span",{staticClass:"hide-cursor-caret-color"},[e._v("*")]),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.form.footer.required_fields",expression:"'sdk.form.footer.required_fields'"}],staticClass:"hide-cursor-caret-color"})]):e._e()])])},n.staticRenderFns=[],n._scopeId="data-v-40788b36"},{"components/InputG3W.vue":239,"vueify/lib/insert-css":1}],241:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("gui/inputs/input");r["default"]={name:"input-integer",mixins:[t]}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baseinput",{attrs:{state:e.state}},[r("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.value,expression:"state.value"}],staticClass:"form-control","class":{"input-error-validation":e.notvalid},staticStyle:{width:"100%"},attrs:{slot:"body",placeholder:e.state["default"],tabIndex:e.tabIndex,type:"number"},domProps:{value:e.state.value},on:{change:e.change,input:[function(t){t.target.composing||e.$set(e.state,"value",t.target.value)},e.change]},slot:"body"})])},n.staticRenderFns=[]},{"gui/inputs/input":131}],242:[function(e,t,r){!function(){function t(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("core/utils/utils"),i=n.getUniqueDomId,a=e("gui/inputs/input");r["default"]={name:"input-lonlat",mixins:[a],data:function(){return{lonId:i(),latId:i(),coordinatebutton:{active:!1}}},computed:{getCoordinateActive:function(){return this.service.state.getCoordinateActive}},methods:{toggleGetCoordinate:function(){this.service.toggleGetCoordinate()},changeLonLat:function(){this.change(),this.setValue()},setValue:function(){this.state.value=[[1*this.state.values.lon,1*this.state.values.lat]];
}},created:function(){this.state.values=this.state.values||{lon:0,lat:0},this.setValue(),this.service.setCoordinateButtonReactiveObject(this.coordinatebutton)},mounted:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$nextTick();case 2:this.$nextTick(function(){$(e.$refs["g3w-input-lat-lon"]).tooltip({trigger:"hover"})});case 3:case"end":return t.stop()}},n,this)}));return e}(),destroyed:function(){this.service.clear()}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{position:"relative"}},[r("div",{staticStyle:{display:"flex","justify-content":"flex-end",height:"35px","margin-right":"12px","margin-bottom":"5px"}},[r("button",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.form.inputs.tooltips.lonlat",expression:"'sdk.form.inputs.tooltips.lonlat'"}],ref:"g3w-input-lat-lon",staticClass:"action skin-tooltip-left skin-color skin-border-color","class":e.g3wtemplate.font.crosshairs,staticStyle:{"border-radius":"5px","font-weight":"bold","font-size":"20px",cursor:"pointer"},style:{border:e.coordinatebutton.active?"2px solid":0},attrs:{"data-placement":"left","data-toggle":"tooltip"},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.toggleGetCoordinate(t)}}})]),e._v(" "),r("baseinput",{attrs:{state:e.state}},[r("label",{staticClass:"col-sm-4 control-label",attrs:{slot:"label","for":e.lonId},slot:"label"},[e._v(e._s(e.state.labels.lon)+"\n      "),e.state.validate&&e.state.validate.required?r("span",[e._v("*")]):e._e()]),e._v(" "),r("div",{attrs:{slot:"body"},slot:"body"},[r("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.values.lon,expression:"state.values.lon"}],staticClass:"form-control","class":{"input-error-validation":e.notvalid},staticStyle:{width:"100%","margin-bottom":"5px"},attrs:{id:e.lonId,tabIndex:e.tabIndex,type:"number",min:"-180",max:"180",placeholder:"Lon"},domProps:{value:e.state.values.lon},on:{change:e.changeLonLat,input:function(t){t.target.composing||e.$set(e.state.values,"lon",t.target.value)}}})])]),e._v(" "),r("baseinput",{attrs:{state:e.state}},[r("label",{staticClass:"col-sm-4 control-label",attrs:{slot:"label","for":e.latId},slot:"label"},[e._v(e._s(e.state.labels.lat)+"\n      "),e.state.validate&&e.state.validate.required?r("span",[e._v("*")]):e._e()]),e._v(" "),r("div",{attrs:{slot:"body"},slot:"body"},[r("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.values.lat,expression:"state.values.lat"}],staticClass:"form-control","class":{"input-error-validation":e.notvalid},staticStyle:{width:"100%","margin-bottom":"5px"},attrs:{id:e.latId,tabIndex:e.tabIndex,type:"number",min:"-90",max:"90",placeholder:"Lon"},domProps:{value:e.state.values.lat},on:{change:e.changeLonLat,input:function(t){t.target.composing||e.$set(e.state.values,"lat",t.target.value)}}})])])],1)},n.staticRenderFns=[]},{"core/utils/utils":68,"gui/inputs/input":131}],243:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("services/gui"),i=t(n),a=e("gui/inputs/input"),o=e("core/utils/utils"),s=o.getUniqueDomId,l=e("core/i18n/i18n.service"),u=l.t,c=e("gui/fields/fields"),d=c.media_field;r["default"]={name:"input-media",mixins:[a],components:{"g3w-media":d},data:function(){return{data:{value:null,mime_type:null},mediaid:"media_"+s(),loading:!1}},methods:{onClick:function(e){document.getElementById(this.mediaid).click()},createImage:function(e,t){var r=new FileReader;r.onload=function(e){t.value=e.target.result},r.readAsDataURL(e)},checkFileSrc:function(e){return _.isNil(e)&&(e=""),e},clearMedia:function(){this.data.value=this.data.mime_type=this.state.value=null,this.change()}},created:function(){this.state.value&&(this.data.value=this.state.value.value,this.data.mime_type=this.state.value.mime_type)},mounted:function(){var e=this,t=this.state.name,r={name:t,csrfmiddlewaretoken:this.$cookie.get("csrftoken")};this.$nextTick(function(){$("#"+e.mediaid).fileupload({dataType:"json",formData:r,start:function(){e.loading=!0},done:function(r,n){var i=n.result[t];i&&(e.data.value=i.value,e.data.mime_type=i.mime_type,e.state.value=e.data,e.change())},fail:function(){i["default"].notify.error(u("info.server_error"))},always:function(){e.loading=!1}})})},beforeDestroy:function(){$("#"+this.mediaid).fileupload("destroy")}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baseinput",{attrs:{state:e.state}},[r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"}],attrs:{slot:"body"},slot:"body"},[r("div",{staticClass:"g3w_input_button skin-border-color",staticStyle:{"border-style":"solid","border-width":"2px","border-radius":"4px",width:"100%",cursor:"pointer","text-align":"center"},on:{click:e.onClick}},[r("i",{staticClass:"fa-2x skin-color","class":e.g3wtemplate.getFontClass("file-upload"),staticStyle:{padding:"5px"}},[r("input",{"class":{"input-error-validation":e.notvalid},staticStyle:{display:"none"},attrs:{id:e.mediaid,name:e.state.name,tabIndex:e.tabIndex,"data-url":e.state.input.options.uploadurl,type:"file"}})])]),e._v(" "),r("bar-loader",{attrs:{loading:e.loading}}),e._v(" "),r("g3w-media",{attrs:{state:e.data}},[r("div",{staticClass:"clearmedia",on:{click:function(t){return e.clearMedia()}}},[r("i",{staticClass:"g3w-icon","class":e.g3wtemplate.font["trash-o"]})])])],1)])},n.staticRenderFns=[]},{"core/i18n/i18n.service":13,"core/utils/utils":68,"gui/fields/fields":120,"gui/inputs/input":131,"services/gui":361}],244:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("gui/inputs/input"),n=e("gui/inputs/picklayer/service");r["default"]={name:"input-picklayer",mixins:[t],methods:{pickLayer:function(){var e=this;this.pickservice.pick().then(function(t){return e.state.value=t})["catch"](function(){})},unpick:function(){var e=this;setTimeout(function(){return!e.pickservice.isPicked()&&e.pickservice.unpick()},200)}},created:function(){this.pickservice=new n(this.state.input.options)},beforeDestroy:function(){this.pickservice.clear(),this.pickservice=null}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baseinput",{attrs:{state:e.state}},[r("div",{attrs:{slot:"body"},slot:"body"},[r("span",{staticClass:"skin-color","class":e.g3wtemplate.font.crosshairs,staticStyle:{left:"0",top:"7px",position:"absolute"}}),e._v(" "),r("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.value,expression:"state.value"}],staticClass:"form-control","class":{"input-error-validation":e.notvalid},staticStyle:{width:"100%"},style:{cursor:e.editable?"pointer":null},attrs:{readonly:"readonly",tabIndex:e.tabIndex},domProps:{value:e.state.value},on:{input:[function(t){t.target.composing||e.$set(e.state,"value",t.target.value)},e.change],click:e.pickLayer,blur:e.unpick}})])])},n.staticRenderFns=[]},{"gui/inputs/input":131,"gui/inputs/picklayer/service":139}],245:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("gui/inputs/input"),n=e("core/utils/utils"),i=n.getUniqueDomId;r["default"]={name:"input-radio",mixins:[t],data:function(){return{ids:[i(),i()],name:"name_"+i(),radio_value:this.state.value}},watch:{radio_value:function(){this.state.value=this.radio_value,this.change()}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baseinput",{attrs:{state:e.state}},[r("div",{attrs:{slot:"body"},slot:"body"},e._l(e.state.input.options.values,function(t,n){return r("span",{key:t.key},[r("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.radio_value,expression:"radio_value"}],staticClass:"magic-radio","class":{"input-error-validation":e.notvalid},staticStyle:{width:"100%"},attrs:{id:e.ids[n],name:e.name,tabIndex:e.tabIndex,type:"radio"},domProps:{value:t.value,checked:e._q(e.radio_value,t.value)},on:{change:function(r){e.radio_value=t.value}}}),e._v(" "),r("label",{attrs:{"for":e.ids[n]}},[e._v(e._s(t.key))])])}),0)])},n.staticRenderFns=[]},{"core/utils/utils":68,"gui/inputs/input":131}],246:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("gui/inputs/input");r["default"]={name:"input-range",mixins:[t],data:function(){var e=this.state.input.options.values[0],t=e.min,r=e.max,n=e.Step;return{min:t,max:r,step:n}},methods:{checkValue:function(){var e=_.isEmpty(_.trim(this.state.value));e&&!this.state.validate.required&&(this.state.value=this.state.input.options.values[0]["default"]),this.state.validate.valid=!this.state.validate.required,e||(this.state.validate.valid=this.service.getValidator().validate(this.state.value)),this.change()}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baseinput",{attrs:{state:e.state}},[r("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.value,expression:"state.value"}],staticClass:"form-control","class":{"input-error-validation":e.notvalid},staticStyle:{width:"100%","padding-right":"5px"},attrs:{slot:"body",tabIndex:e.tabIndex,type:"number",step:e.step},domProps:{value:e.state.value},on:{keydown:[function(e){return e.type.indexOf("key")||69===e.keyCode?void e.preventDefault():null},function(e){return e.type.indexOf("key")||13===e.keyCode?void e.stopPropagation():null}],change:e.checkValue,blur:e.checkValue,input:function(t){t.target.composing||e.$set(e.state,"value",t.target.value)}},slot:"body"})])},n.staticRenderFns=[]},{"gui/inputs/input":131}],247:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("store/catalog-layers"),a=t(i),o=e("store/map-layers"),s=t(o),l=e("services/gui"),u=t(l),c=e("mixins"),d=e("gui/inputs/picklayer/service"),f=e("core/layers/layer"),p=e("gui/inputs/input"),h=null;r["default"]={name:"input-select",mixins:[p,c.selectMixin,c.select2Mixin],data:function(){return{showPickLayer:!1,picked:!1}},computed:{showNullOption:function(){return void 0===this.state.nullOption||this.state.nullOption===!0},select2NullValue:function(){return this.showNullOption&&h}},watch:{"state.input.options.values":function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){var t,n,i,a=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.$nextTick();case 2:t=!1,this.autocomplete||(n=void 0,0===e.length?n=h:(i=e.find(function(e){return e.value==a.state.value}),n=i?i.value:h),t=n!=this.state.value,this.state.value=n,this.setValue()),t&&this.change();case 5:case"end":return r.stop()}},r,this)}));return e}()},methods:{pickLayerValue:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e,t,n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,!this.picked){r.next=6;break}this.pickLayerInputService.unpick(),this.picked=!1,r.next=16;break;case 6:return this.picked=!0,r.next=9,this.pickLayerInputService.pick();case 9:e=r.sent,t=this.state.input.options.value,n=e[t],this.select2.val(n).trigger("change"),this.changeSelect(n),u["default"].showUserMessage({type:"success",autoclose:!0}),this.picked=!1;case 16:r.next=22;break;case 18:r.prev=18,r.t0=r["catch"](0),u["default"].showUserMessage({type:"warning",message:"sdk.form.inputs.messages.errors.picklayer",autoclose:!0}),this.picked=!1;case 22:case"end":return r.stop()}},r,this,[[0,18]])}));return e}(),setAndListenSelect2Change:function(){var e=this;this.select2.on("select2:select",function(t){var r=t.params.data.$value?t.params.data.$value:t.params.data.id;r=e.showNullOption&&r===h?null:r.toString(),e.changeSelect(r)})}},created:function(){if(this.open=!1,"select_autocomplete"===this.state.input.type){var e=this.state.input.options.layer_id;try{var t=s["default"].getLayerById(e).getEditingLayer()||a["default"].getLayerById(e);this.showPickLayer=!!t&&t.getType()!==f.LayerTypes.TABLE;var r=this.state.input.options,n=r.value,i=r.layer_id,o={layer_id:i,fields:[n],pick_type:t.isStarted&&t.isStarted()&&"map"||null};this.pickLayerInputService=this.showPickLayer&&new d(o)}catch(l){}}this.autocomplete&&this.state.value&&this.service.getKeyByValue({search:this.state.value})},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e,t,n,i=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.$nextTick();case 2:this.unwatch,e=$(this.$refs.select),t=this.getLanguage(),n=void 0===this.state.dropdownParent&&$("#g3w-view-content"),this.autocomplete?this.select2=e.select2({minimumInputLength:1,dropdownParent:n,allowClear:this.showNullOption,language:t,ajax:{delay:250,transport:function(e,t,r){var n=e.data.term;$(".select2-results__option.loading-results").siblings().hide(),i.resetValues(),i.service.getData({search:n}).then(function(e){return t(e)})["catch"](function(e){return r(e)})},processResults:function(e,t){return t.page=t.page||1,{results:e,pagination:{more:!1}}}}}):this.select2=e.select2({language:t,dropdownParent:n,minimumResultsForSearch:this.isMobile()?-1:null}),this.setAndListenSelect2Change(),this.setValue();case 9:case"end":return r.stop()}},r,this)}));return e}(),beforeDestroy:function(){this.pickLayerInputService&&(this.pickLayerInputService.clear(),this.pickLayerInputService=null),this.unwatch&&this.unwatch(),this.unwatch=null}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baseinput",{attrs:{state:e.state}},[e.showPickLayer?r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.form.inputs.tooltips.picklayer",expression:"'sdk.form.inputs.tooltips.picklayer'"},{name:"disabled",rawName:"v-disabled",value:e.disabled,expression:"disabled"}],staticClass:"skin-color","class":e.g3wtemplate.font.crosshairs,staticStyle:{cursor:"pointer",position:"relative",top:"2px","font-size":"1.2em"},attrs:{slot:"label-action","data-placement":"top"},on:{click:e.pickLayerValue},slot:"label-action"}):e._e(),e._v(" "),r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.disabled,expression:"disabled"}],attrs:{slot:"body",tabIndex:e.tabIndex},slot:"body"},[r("select",{ref:"select",staticClass:"form-control",staticStyle:{width:"100%"}},[e.showNullOption?r("option",{domProps:{value:e.select2NullValue}}):e._e(),e._v(" "),e._l(e.state.input.options.values,function(t){return r("option",{key:e.getValue(t.value),domProps:{value:e.getValue(t.value)}},[e._v(e._s(t.key))])})],2)]),e._v(" "),"error"===e.loadingState?r("p",{directives:[{name:"t",rawName:"v-t",value:"server_error",expression:"'server_error'"}],staticClass:"error-input-message",attrs:{slot:"message"},slot:"message"}):e._e()])},n.staticRenderFns=[]},{"core/layers/layer":34,"gui/inputs/input":131,"gui/inputs/picklayer/service":139,mixins:343,"services/gui":361,"store/catalog-layers":374,"store/map-layers":377}],248:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("gui/inputs/input");r["default"]={name:"input-slider-range",mixins:[t],watch:{"state.input.options.min":function(){this.service.changeInfoMessage()},"state.input.options.max":function(){this.service.changeInfoMessage()}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baseinput",{attrs:{state:e.state}},[r("div",{attrs:{slot:"body"},slot:"body"},[r("span",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(e.state.value))]),e._v(" "),r("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.value,expression:"state.value"}],"class":{"input-error-validation":e.notvalid},staticStyle:{width:"100%","padding-right":"5px"},attrs:{slot:"body",tabIndex:e.tabIndex,min:e.state.input.options.min,max:e.state.input.options.max,type:"range",step:e.state.input.options.step},domProps:{value:e.state.value},on:{change:e.change,__r:function(t){return e.$set(e.state,"value",t.target.value)}},slot:"body"})])])},n.staticRenderFns=[]},{"gui/inputs/input":131}],249:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("gui/inputs/input");r["default"]={name:"input-text",mixins:[t]}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baseinput",{attrs:{state:e.state}},[r("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.value,expression:"state.value"}],staticClass:"form-control","class":{"input-error-validation":e.notvalid},attrs:{slot:"body",placeholder:e.state["default"],tabIndex:e.tabIndex,field:e.state.name,id:e.state.name},domProps:{value:e.state.value},on:{keyup:function(t){e.isMobile()?e.mobileChange(t):e.change()},input:function(t){t.target.composing||e.$set(e.state,"value",t.target.value)}},slot:"body"})])},n.staticRenderFns=[]},{"gui/inputs/input":131}],250:[function(e,t,r){e("vueify/lib/insert-css").insert("textarea[data-v-3c23c946]{resize:none;border:1px solid #ccc}");!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("gui/inputs/input");r["default"]={name:"input-textarea",mixins:[t]}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baseinput",{attrs:{state:e.state}},[r("textarea",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.value,expression:"state.value"}],"class":{"input-error-validation":e.notvalid},staticStyle:{"max-width":"100%","min-width":"100%"},attrs:{slot:"body",placeholder:e.state["default"],rows:"3",tabIndex:e.tabIndex},domProps:{value:e.state.value},on:{keydown:function(e){e.stopPropagation()},input:[function(t){t.target.composing||e.$set(e.state,"value",t.target.value)},e.change],change:e.change},slot:"body"})])},n.staticRenderFns=[],n._scopeId="data-v-3c23c946"},{"gui/inputs/input":131,"vueify/lib/insert-css":1}],251:[function(e,t,r){e("vueify/lib/insert-css").insert('button.ql-html{width:40px!important}button.ql-html:after{content:"html"}');!function(){function t(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("core/utils/utils"),i=(n.getUniqueDomId,e("gui/inputs/input"));r["default"]={name:"input-html",mixins:[i],methods:{setupTableCustomTools:function(){var e=this.$el.querySelector(".ql-column-left");e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-caret-left-square" viewBox="0 0 16 16"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M10.205 12.456A.5.5 0 0 0 10.5 12V4a.5.5 0 0 0-.832-.374l-4.5 4a.5.5 0 0 0 0 .748l4.5 4a.5.5 0 0 0 .537.082z"/></svg>',e.title="Add column left";var t=this.$el.querySelector(".ql-column-right");t.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-caret-right-square" viewBox="0 0 16 16"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M5.795 12.456A.5.5 0 0 1 5.5 12V4a.5.5 0 0 1 .832-.374l4.5 4a.5.5 0 0 1 0 .748l-4.5 4a.5.5 0 0 1-.537.082z"/></svg>',t.title="Add column right";var r=this.$el.querySelector(".ql-column-remove");r.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-square" viewBox="0 0 16 16"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/></svg>',r.title="Remove column";var n=this.$el.querySelector(".ql-row-above");n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-caret-up-square" viewBox="0 0 16 16"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M3.544 10.705A.5.5 0 0 0 4 11h8a.5.5 0 0 0 .374-.832l-4-4.5a.5.5 0 0 0-.748 0l-4 4.5a.5.5 0 0 0-.082.537z"/></svg>',n.title="Add row above";var i=this.$el.querySelector(".ql-row-below");i.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-caret-down-square" viewBox="0 0 16 16"><path d="M3.626 6.832A.5.5 0 0 1 4 6h8a.5.5 0 0 1 .374.832l-4 4.5a.5.5 0 0 1-.748 0l-4-4.5z"/><path d="M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm15 0a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2z"/></svg>',i.title="Add row below";var a=this.$el.querySelector(".ql-row-remove");a.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-dash-square" viewBox="0 0 16 16"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M4 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 4 8z"/></svg>',a.title="Remove row"}},created:function(){this.edit_state={edit:!1,show_html:!1},this.state.edit_states||(this.state.edit_states=[]),this.state.edit_states.push(this.edit_state)},mounted:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(){var e,t=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=[[{header:[1,2,3,4,5,6,!1]}],[{align:""},{align:"center"},{align:"right"},{align:"justify"}],[{color:[]},{background:[]}],["bold","italic","underline",{list:"ordered"},{list:"bullet"},"link","clean","html"],["table","column-left","column-right","column-remove","row-above","row-below","row-remove"]],r.next=3,this.$nextTick();case 3:this.quill=new Quill(this.$refs.quill_editor,{modules:{table:!0,toolbar:{container:e,handlers:{html:function(){t.edit_state.show_html=!t.edit_state.show_html,t.edit_state.show_html?t.quill.container.firstChild.innerText=t.quill.container.firstChild.innerHTML:t.quill.container.firstChild.innerHTML=t.quill.container.firstChild.innerText;var e=!0,r=!1,n=void 0;try{for(var i,a=t.$el.querySelectorAll(".ql-formats")[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var o=i.value,s=!0,l=!1,u=void 0;try{for(var c,d=o.children[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=c.value;f.classList.contains("ql-html")?f.classList.toggle("skin-color"):f.classList.toggle("g3w-disabled")}}catch(p){l=!0,u=p}finally{try{!s&&d["return"]&&d["return"]()}finally{if(l)throw u}}}}catch(p){r=!0,n=p}finally{try{!e&&a["return"]&&a["return"]()}finally{if(r)throw n}}},"column-left":function(){return t.table.insertColumnLeft()},"column-right":function(){return t.table.insertColumnRight()},"column-remove":function(){return t.table.deleteColumn()},"row-above":function(){return t.table.insertRowAbove()},"row-below":function(){return t.table.insertRowBelow()},"row-remove":function(){return t.table.deleteRow()}}}},theme:"snow"}),this.quill.container.firstChild.innerHTML=this.state.value,this.table=this.quill.getModule("table"),this.setupTableCustomTools(),this.handler=function(){t.state.value=t.edit_state.show_html?t.quill.container.firstChild.innerText:t.quill.container.firstChild.innerHTML,t.edit_state.edit=!0,t.change(),setTimeout(function(){return t.edit_state.edit=!1})},this.quill.on("text-change",this.handler);case 9:case"end":return r.stop()}},n,this)}));return e}(),watch:{"state.value":function(e){this.edit_state.edit||(this.edit_state.show_html?this.quill.container.firstChild.innerText=e:this.quill.container.firstChild.innerHTML=e)}},beforeDestroy:function(){this.quill.off("text-change",this.handler),this.handler=null,this.quill=null,this.edit_state.edit=!1,this.edit_state.show_html=!1}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baseinput",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"}],attrs:{state:e.state}},[r("div",{ref:"quill_editor",staticClass:"form-control",style:{border:e.novalid?"1px solid reed":"1px solid #ccc"},attrs:{slot:"body"},on:{keydown:function(e){e.stopPropagation()}},slot:"body"})])},n.staticRenderFns=[]},{"core/utils/utils":68,"gui/inputs/input":131,"vueify/lib/insert-css":1}],252:[function(e,t,r){!function(){function t(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("mixins"),i=e("gui/inputs/input"),a=e("core/utils/utils"),o=a.getUniqueDomId;r["default"]={name:"input-unique",mixins:[i,n.selectMixin],data:function(){var e="unique_"+o();return{id:e}},watch:{"state.input.options.values":function(){function e(e){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.state.value=this.state.value?this.state.value:null,null!==this.state.value&&e.indexOf(this.state.value)===-1&&this.service.addValueToValues(this.state.value),t.next=4,this.$nextTick();case 4:this.state.value&&this.select2.val(this.state.value).trigger("change");case 5:case"end":return t.stop()}},n,this)}));return e}()},mounted:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$nextTick();case 2:this.state.input.options.editable&&(this.select2=$("#"+this.id).select2({dropdownParent:$("#g3w-view-content"),tags:!0,language:this.getLanguage()}),this.select2.val(this.state.value).trigger("change"),this.select2.on("select2:select",function(t){var r=t.params.data.$value?t.params.data.$value:t.params.data.id;e.changeSelect(r)}));case 3:case"end":return t.stop()}},n,this)}));return e}()}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baseinput",{attrs:{state:e.state}},[r("select",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"}],staticClass:"form-control",staticStyle:{width:"100%"},attrs:{slot:"body",id:e.id,tabIndex:e.tabIndex},slot:"body"},[r("option",{attrs:{value:"null"}}),e._v(" "),e._l(e.state.input.options.values,function(t){return r("option",{key:t,domProps:{value:e.getValue(t)}},[e._v(e._s(e.getValue(t)))])})],2)])},n.staticRenderFns=[]},{"core/utils/utils":68,"gui/inputs/input":131,mixins:343}],253:[function(e,t,r){e("vueify/lib/insert-css").insert("li .item-text[data-v-8e4a0f42]{font-weight:700}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("store/catalog-layers"),a=t(i),o=e("gui/catalog/vue/catalogeventhub"),s=t(o);r["default"]={name:"Layeropacitypicker",props:{layer:{type:Object,required:!0}},data:function(){return{menu:{show:!1,top:0,left:0,overflowY:"none",style:null,"default":null}}},methods:{setLayerOpacity:function(e){var t=e.id,r=void 0===t?this.layer.id:t,n=e.value;if(this.layer.opacity!=n){this.layer.opacity=n;var i=a["default"].getLayerById(r);i&&(s["default"].$emit("layer-change-opacity",{layerId:r}),i.change())}},showLayerOpacityMenu:function(){function e(e,r){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e,t){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:this.$emit("show-menu-item",{menu:this.menu,bool:e,evt:t});case 1:case"end":return r.stop()}},r,this)}));return e}()},created:function(){this.$emit("init-menu-item",{layerOpacity:this.menu})}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{on:{mouseleave:function(t){return t.target!==t.currentTarget?null:e.showLayerOpacityMenu(!1,t)},mouseover:function(t){return t.target!==t.currentTarget?null:e.showLayerOpacityMenu(!0,t)}}},[r("span",{staticClass:"menu-icon skin-color-dark","class":e.g3wtemplate.getFontClass("slider")}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"catalog_items.contextmenu.layer_opacity",expression:"'catalog_items.contextmenu.layer_opacity'"}],staticClass:"item-text"}),e._v(" "),r("span",{staticClass:"menu-icon","class":e.g3wtemplate.getFontClass("arrow-right"),staticStyle:{position:"absolute",right:"0","margin-top":"3px"}}),e._v(" "),r("ul",{directives:[{name:"show",rawName:"v-show",value:e.layer&&e.menu.show,expression:"layer && menu.show"}],style:{top:e.menu.top+"px",left:e.menu.left-15+"px",maxHeight:e.menu.maxHeight+"px",overflowY:e.menu.overflowY,paddingLeft:0,position:"fixed",backgroundColor:"#FFF",color:"#000"}},[r("li",[r("range",{attrs:{value:e.layer.opacity,min:0,max:100,step:1,sync:!1,showValue:!0,
unit:"%"},on:{"change-range":e.setLayerOpacity}})],1)])])},n.staticRenderFns=[],n._scopeId="data-v-8e4a0f42"},{"gui/catalog/vue/catalogeventhub":114,"store/catalog-layers":374,"vueify/lib/insert-css":1}],254:[function(e,t,r){e("vueify/lib/insert-css").insert(".g3w-map-controls-left-bottom[data-v-01ac34b5]{position:absolute;bottom:75px;left:10px;z-index:1}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("components/MapAddLayer.vue"),a=t(i),o=e("components/MapFooter.vue"),s=t(o);r["default"]={name:"g3w-map",data:function(){var e=this.$options,t=e.service,r=e.target;return{target:r,maps_container:this.$options.maps_container,service:t,hidemaps:t.state.hidemaps,map_info:t.state.map_info}},components:{addlayer:a["default"],MapFooter:s["default"]},computed:{mapcontrolsalignement:function(){return this.service.state.mapcontrolsalignement},disableMapControls:function(){return this.service.state.mapControl.disabled}},methods:{showHideControls:function(){var e=this.service.getMapControls();e.forEach(function(e){return"scaleline"!==e.type&&e.control.showHide()})}},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.crs=this.service.getCrs(),t.next=3,this.$nextTick();case 3:this.service.setMapControlsContainer($(this.$refs["g3w-map-controls"])),this.service.onafter("addHideMap",n(regeneratorRuntime.mark(function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.ratio,i=t.layers,a=void 0===i?[]:i,o=t.mainview,s=void 0!==o&&o,l=t.switchable,u=void 0!==l&&l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$nextTick();case 2:e.service._addHideMap({ratio:n,layers:a,mainview:s,switchable:u});case 3:case"end":return t.stop()}},r,e)})));case 5:case"end":return t.stop()}},r,this)}));return e}(),destroyed:function(){this.service.clear()}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:e.maps_container}},[e._l(e.hidemaps,function(e){return r("div",{key:e.id,staticClass:"g3w-map hidemap",attrs:{id:e.id}})}),e._v(" "),r("div",{staticClass:"g3w-map",attrs:{id:e.target}},[r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.disableMapControls,expression:"disableMapControls"}],ref:"g3w-map-controls",staticClass:"g3w-map-controls","class":e.mapcontrolsalignement,staticStyle:{display:"flex"}}),e._v(" "),e.map_info.info?r("div",{ref:"g3w-map-info",style:e.map_info.style,attrs:{id:"g3w-map-info"}},[e._v("\n      "+e._s(e.map_info.info)+"\n    ")]):e._e(),e._v(" "),e._m(0),e._v(" "),r("addlayer",{attrs:{service:e.service}}),e._v(" "),r("div",{staticClass:"g3w-map-controls-left-bottom"})],1),e._v(" "),r("map-footer",{attrs:{service:e.service}})],2)},n.staticRenderFns=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{display:"none"}},[r("div",{attrs:{id:"marker"}})])}],n._scopeId="data-v-01ac34b5"},{"components/MapAddLayer.vue":255,"components/MapFooter.vue":257,"vueify/lib/insert-css":1}],255:[function(e,t,r){!function(){function t(e){return Array.isArray(e)?e:Array.from(e)}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("vue-color"),a=e("app/constant"),o=e("g3w-ol/projection/projections"),s=e("core/utils/geo"),l=s.createVectorLayerFromFile,u=s.createStyleFunctionToVectorLayer,c=["zip","geojson","GEOJSON","kml","kmz","KMZ","KML","json","gpx","gml","csv"],d=[",",";"];i.Chrome.mounted=n(regeneratorRuntime.mark(function f(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:$(".vue-color__chrome__toggle-btn").remove(),$(".vue-color__editable-input__label").remove(),$(".vue-color__chrome__saturation-wrap").css("padding-bottom","100px"),$(".vue-color__chrome").css({"box-shadow":"0 0 0 0",border:"1px solid #97A1A8"});case 6:case"end":return e.stop()}},f,this)})),r["default"]={name:"map-add-layer",props:["service"],data:function(){var e=this.service.getCrs();return void 0===a.EPSG.find(function(t){return t===e})&&a.EPSG.unshift(e),{vectorLayer:null,options:a.EPSG,error:!1,error_message:null,position:null,loading:!1,fields:[],field:null,accepted_extension:c.map(function(e){return"."+e}).join(","),csv:{valid:!1,loading:!1,headers:[],x:null,y:null,separators:d,separator:d[0]},layer:{name:null,type:null,crs:null,mapCrs:null,color:{hex:"#194d33",rgba:{r:25,g:77,b:51,a:1},a:1},data:null,visible:!0,title:null,id:null,external:!0}}},components:{"chrome-picker":i.Chrome},computed:{csv_extension:function(){return"csv"===this.layer.type},add:function(){return this.layer.data||this.csv.valid}},methods:{setLayerMapPosition:function(e){this.position=e},setError:function(e){this.error_message="sdk.errors."+e,this.error=!0},clearError:function(){this.error=!1,this.error_message=null},onChangeColor:function(e){this.layer.color=e},onAddLayer:function(){function e(e){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function i(e){var r,n,a,o,s,l=this;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(r=new FileReader,n=e.target.files[0].name,a=e.target.files[0].name.split("."),a=a[a.length-1].toLowerCase(),o=$(this.$refs.input_file),c.indexOf(a)===-1){i.next=32;break}if(this.clearError(),this.layer.mapCrs=this.service.getEpsg(),this.layer.name=n,this.layer.title=n,this.layer.id=n,this.layer.type=a,"csv"!==this.layer.type){i.next=17;break}r.onload=function(e){o.val(null);var r=e.target.result.split(/\r\n|\n/).filter(function(e){return e}),n=t(r),i=n[0],a=n.slice(1),s=function(e){var t=null;l.csv.loading=!0;var r=i.split(e),n=r.length;return n>1?(l.csv.headers=r,l.fields=r,l.csv.x=r[0],l.csv.y=r[1],t={headers:r,separator:e,x:l.csv.x,y:l.csv.y,values:a},l.csv.valid=!0):(l.csv.headers=l.fields=[],l.vectorLayer=null,l.csv.valid=!1,l.fields.splice(0)),l.csv.loading=!1,t};l.layer.data=s(l.csv.separator),l.$watch("csv.separator",function(e){return l.layer.data=s(e)})},r.readAsText(e.target.files[0]),i.next=30;break;case 17:return s=new Promise(function(t,n){if("zip"===l.layer.type||"kmz"===l.layer.type){var i=e.target.files[0];o.val(null),t(i)}else r.onload=function(e){var r=e.target.result;o.val(null),t(r)},r.readAsText(e.target.files[0])}),i.next=20,s;case 20:return this.layer.data=i.sent,i.prev=21,this.fields.splice(0),i.next=25,this.createVectorLayer();case 25:this.fields=this.vectorLayer.get("_fields"),i.next=30;break;case 28:i.prev=28,i.t0=i["catch"](21);case 30:i.next=33;break;case 32:this.setError("unsupported_format");case 33:case"end":return i.stop()}},i,this,[[21,28]])}));return e}(),createVectorLayer:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l(this.layer);case 3:return this.vectorLayer=e.sent,e.next=6,this.$nextTick();case 6:e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),this.setError("add_external_layer");case 11:case"end":return e.stop()}},r,this,[[0,8]])}));return e}(),addLayer:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.layer.data&&!this.csv.valid){t.next=27;break}return e=this.layer.crs,t.prev=2,t.prev=3,t.next=6,o.registerProjection(e);case 6:t.next=12;break;case 8:return t.prev=8,t.t0=t["catch"](3),this.setError(t.t0),t.abrupt("return");case 12:return this.loading=!0,t.next=15,l(this.layer);case 15:return this.vectorLayer=t.sent,this.vectorLayer.setStyle(u({color:this.layer.color,field:this.field})),t.next=19,this.service.addExternalLayer(this.vectorLayer,{crs:this.layer.crs,type:this.layer.type,position:this.position});case 19:$(this.$refs.modal_addlayer).modal("hide"),this.clear(),t.next=26;break;case 23:t.prev=23,t.t1=t["catch"](2),this.setError("add_external_layer");case 26:this.loading=!1;case 27:case"end":return t.stop()}},r,this,[[2,23],[3,8]])}));return e}(),clear:function(){this.clearError(),this.loading=!1,this.layer.name=null,this.layer.title=null,this.layer.id=null,this.layer.type=null,this.layer.crs=this.service.getCrs(),this.layer.color={hex:"#194d33",rgba:{r:25,g:77,b:51,a:1},a:1},this.layer.data=null,this.vectorLayer=null,this.fields=[],this.field=null,this.csv.valid=!1},clearLayer:function(){this.clear()}},watch:{"csv.x":function(e){e&&(this.layer.data.x=e)},"csv.y":function(e){e&&(this.layer.data.y=e)}},created:function(){var e=this;this.layer.crs=this.service.getCrs(),this.service.on("addexternallayer",function(){return e.modal.modal("show")})},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$nextTick();case 2:this.modal=$("#modal-addlayer").modal("hide"),this.modal.on("hide.bs.modal",function(){e.clear()});case 4:case"end":return t.stop()}},r,this)}));return e}(),beforeDestroy:function(){this.clear(),this.modal.modal("hide"),this.modal.remove()}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{ref:"modal_addlayer",staticClass:"modal fade",attrs:{id:"modal-addlayer",role:"dialog"}},[r("div",{staticClass:"modal-dialog"},[r("div",{staticClass:"modal-content"},[r("div",{staticClass:"modal-header"},[r("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal"}},[e._v("×")]),e._v(" "),r("h4",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.header",expression:"'mapcontrols.add_layer_control.header'"}],staticClass:"modal-title",staticStyle:{"font-weight":"bold"}})]),e._v(" "),r("div",{staticClass:"modal-body"},[r("div",{staticClass:"form-group"},[r("label",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.select_projection",expression:"'mapcontrols.add_layer_control.select_projection'"}],attrs:{"for":"projection-layer"}}),e._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.layer.crs,expression:"layer.crs"}],staticClass:"form-control",attrs:{id:"projection-layer"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.layer,"crs",t.target.multiple?r:r[0])}}},e._l(e.options,function(t){return r("option",{domProps:{value:t}},[e._v(e._s(t))])}),0)]),e._v(" "),r("layerspositions",{on:{"layer-position-change":function(t){return e.setLayerMapPosition(t)}}}),e._v(" "),r("p",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.select_color",expression:"'mapcontrols.add_layer_control.select_color'"}],staticStyle:{"font-weight":"700"}}),e._v(" "),r("chrome-picker",{staticStyle:{width:"100%",margin:"auto"},on:{input:e.onChangeColor},model:{value:e.layer.color,callback:function(t){e.$set(e.layer,"color",t)},expression:"layer.color"}}),e._v(" "),r("bar-loader",{attrs:{loading:e.loading}}),e._v(" "),r("form",{attrs:{id:"addcustomlayer"}},[r("input",{ref:"input_file",attrs:{type:"file",title:" ",accept:e.accepted_extension},on:{change:function(t){return e.onAddLayer(t)}}}),e._v(" "),r("h4",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.drag_layer",expression:"'mapcontrols.add_layer_control.drag_layer'"}]}),e._v(" "),e.layer.name?r("h4",{staticClass:"skin-color",staticStyle:{"font-weight":"bold"}},[e._v(e._s(e.layer.name))]):e._e(),e._v(" "),r("div",[r("i",{staticClass:"fa-5x","class":e.g3wtemplate.getFontClass("cloud-upload"),attrs:{"aria-hidden":"true"}})]),e._v(" "),r("p",{staticStyle:{"font-weight":"bold"}},[e._v("[.gml, .geojson, .kml, .kmz ,.gpx, .csv, .zip(shapefile)]")])]),e._v(" "),e.csv_extension?r("div",{staticStyle:{padding:"15px",border:"1px solid grey","border-radius":"3px"}},[r("bar-loader",{attrs:{loading:e.csv.loading}}),e._v(" "),r("div",{staticClass:"select_field"},[r("label",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.select_csv_separator",expression:"'mapcontrols.add_layer_control.select_csv_separator'"}],attrs:{"for":"g3w-select-field-layer"}}),e._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.csv.separator,expression:"csv.separator"}],staticClass:"form-control",attrs:{id:"g3w-select-separator"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.csv,"separator",t.target.multiple?r:r[0])}}},e._l(e.csv.separators,function(t){return r("option",{key:t,domProps:{value:t}},[e._v(e._s(t))])}),0),e._v(" "),r("div",{staticClass:"select_field","class":{"g3w-disabled":!e.csv.headers||0===e.csv.headers.length}},[r("label",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.select_csv_x_field",expression:"'mapcontrols.add_layer_control.select_csv_x_field'"}],attrs:{"for":"g3w-select-x-field"}}),e._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.csv.x,expression:"csv.x"}],staticClass:"form-control",attrs:{id:"g3w-select-x-field"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.csv,"x",t.target.multiple?r:r[0])}}},e._l(e.csv.headers,function(t){return r("option",{key:t,domProps:{value:t}},[e._v(e._s(t))])}),0)]),e._v(" "),r("div",{staticClass:"select_field","class":{"g3w-disabled":!e.csv.headers||0===e.csv.headers.length}},[r("label",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.select_csv_y_field",expression:"'mapcontrols.add_layer_control.select_csv_y_field'"}],attrs:{"for":"g3w-select-y-field"}}),e._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.csv.y,expression:"csv.y"}],staticClass:"form-control",attrs:{id:"g3w-select-y-field"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.csv,"y",t.target.multiple?r:r[0])}}},e._l(e.csv.headers,function(t){return r("option",{key:t,domProps:{value:t}},[e._v(e._s(t))])}),0)])])],1):e._e(),e._v(" "),r("div",{staticClass:"select_field","class":{"g3w-disabled":!e.fields||0===e.fields.length}},[r("label",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.select_field_to_show",expression:"'mapcontrols.add_layer_control.select_field_to_show'"}],attrs:{"for":"g3w-select-field-layer"}}),e._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.field,expression:"field"}],staticClass:"form-control",attrs:{id:"g3w-select-field-layer"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.field=t.target.multiple?r:r[0]}}},[r("option",{domProps:{value:null}},[e._v("---")]),e._v(" "),e._l(e.fields,function(t){return r("option",{key:t,domProps:{value:t}},[e._v(e._s(t))])})],2)]),e._v(" "),e.error?r("div",{directives:[{name:"t",rawName:"v-t",value:e.error_message,expression:"error_message"}],staticStyle:{"font-weight":"bold","font-size":"1.2em","background-color":"orange",padding:"10px","text-align":"center"}}):e._e(),e._v(" "),r("div",{staticClass:"modal-footer"},[r("button",{directives:[{name:"t",rawName:"v-t",value:"add",expression:"'add'"}],staticClass:"btn btn-success pull-left",attrs:{type:"button",disabled:!e.add},on:{click:function(t){return t.stopPropagation(),e.addLayer(t)}}}),e._v(" "),r("button",{directives:[{name:"t",rawName:"v-t",value:"close",expression:"'close'"}],staticClass:"btn btn-default",attrs:{type:"button","data-dismiss":"modal"}})])],1)])])])},n.staticRenderFns=[]},{"app/constant":4,"core/utils/geo":64,"g3w-ol/projection/projections":111,"vue-color":"vue-color"}],256:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("services/gui"),i=t(n),a=e("core/utils/utils"),o=a.debounce;r["default"]={name:"MapControlZoomHistory",data:function(){return{history:{index:0,items:[]}}},methods:{last:function(){this.history.index--,this.setMapExtent()},next:function(){this.history.index++,this.setMapExtent()},setMapExtent:function(){i["default"].getService("map").getMap().getView().fit(this.history.items[this.history.index])}},computed:{hasEmptyHistory:function(){return 0===this.history.index&&1===this.history.items.length||this.history.items.length-1===this.history.index}},created:function(){var e=this,t=i["default"].getService("map").getMap(),r=t.getView();this.history.items.push(r.calculateExtent(t.getSize())),this.changeKeyEvent=r.on("change",o(function(r){e.history.index!==e.history.items.length-1&&e.history.items.splice(e.history.index-e.history.items.length+1),e.history.items.push(r.target.calculateExtent(t.getSize())),e.history.index++},600))},beforeDestroy:function(){ol.Object.unByKey(this.changeKeyEvent)}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"ol-zoom-history ol-unselectable ol-control",staticStyle:{display:"flex",gap:"5px"}},[r("div",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top.create",value:"sdk.mapcontrols.zoomhistory.zoom_last",expression:"'sdk.mapcontrols.zoomhistory.zoom_last'",arg:"top",modifiers:{create:!0}}]},[r("button",{directives:[{name:"disabled",rawName:"v-disabled",value:0===e.history.index,expression:"history.index === 0"}],attrs:{type:"button"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.last(t)}}},[r("i",{"class":e.g3wtemplate.getFontClass("reply")})])]),e._v(" "),r("div",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top.create",value:"sdk.mapcontrols.zoomhistory.zoom_next",expression:"'sdk.mapcontrols.zoomhistory.zoom_next'",arg:"top",modifiers:{create:!0}}]},[r("button",{directives:[{name:"disabled",rawName:"v-disabled",value:e.hasEmptyHistory,expression:"hasEmptyHistory"}],attrs:{type:"button"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.next(t)}}},[r("i",{"class":e.g3wtemplate.getFontClass("share")})])])])},n.staticRenderFns=[],n._scopeId="data-v-38932d39"},{"core/utils/utils":68,"services/gui":361}],257:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("components/MapFooterRight.vue"),i=t(n),a=e("components/MapFooterLeft.vue"),o=t(a);r["default"]={name:"Mapfooter",props:{service:{type:Object}},components:{MapFooterRight:i["default"],MapFooterLeft:o["default"]}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"skin-border-color",attrs:{id:"map_footer"}},[r("map-footer-left"),e._v(" "),r("map-footer-right",{attrs:{service:e.service}})],1)},n.staticRenderFns=[]},{"components/MapFooterLeft.vue":258,"components/MapFooterRight.vue":259}],258:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"Mapfooter"}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement;e._self._c||t;return e._m(0)},n.staticRenderFns=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{display:"flex"},attrs:{id:"map_footer_left"}},[r("a",{staticStyle:{"margin-left":"5px","align-self":"center"},attrs:{href:"https://g3wsuite.it/",target:"_blank"}},[r("img",{attrs:{height:"15",src:"/static/client/images/g3wsuite_logo.png",alt:""}})])])}]},{}],259:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("store/application-state"),a=t(i);r["default"]={name:"map-footer-right",props:{service:{type:Object}},data:function(){return{mouse:{switch_icon:!1,epsg_4326:!1,tooltip:null},mapunit:a["default"].map.unit}},computed:{showmapunits:function(){return this.service.state.mapunits.length>1}},methods:{createCopyMapExtentUrl:function(){this.service.createCopyMapExtentUrl()},switchMapsCoordinateTo4326:function(){this.mouse.epsg_4326=!this.mouse.epsg_4326}},watch:{mapunit:function(e){a["default"].map.unit=e,this.service.changeScaleLineUnit(e)}},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.service.once("ready",function(){e.mouse.switch_icon=e.service.getMapControlByType({type:"mouseposition"})&&"EPSG:4326"!==e.service.getEpsg(),e.mouse.tooltip="ESPG "+e.service.getCrs().split(":")[1]+" <--> WGS84"});case 1:case"end":return t.stop()}},r,this)}));return e}()}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{display:"flex"},attrs:{id:"map_footer_right"}},[r("div",{attrs:{id:"scale-control"}}),e._v(" "),e.mouse.switch_icon&&!e.isMobile()?r("div",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top.create",value:e.mouse.tooltip,expression:"mouse.tooltip",arg:"top",modifiers:{create:!0}}],attrs:{id:"switch-mouse-coordinate"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.switchMapsCoordinateTo4326(t)}}},[r("span",{staticClass:"skin-color hide-cursor-caret-color","class":e.g3wtemplate.getFontClass("mouse")})]):e._e(),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:!e.mouse.epsg_4326,expression:"!mouse.epsg_4326"}],attrs:{id:"mouse-position-control"}}),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.mouse.epsg_4326,expression:"mouse.epsg_4326"}],attrs:{id:"mouse-position-control-epsg-4326"}}),e._v(" "),e.showmapunits?r("div",{attrs:{id:"scale-line-units"}},[r("select",{directives:[{name:"model",rawName:"v-model",value:e.mapunit,expression:"mapunit"}],staticClass:"skin-color",staticStyle:{padding:"5px 2px","font-weight":"bold",border:"0",cursor:"pointer"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.mapunit=t.target.multiple?r:r[0]}}},e._l(e.service.state.mapunits,function(t){return r("option",{directives:[{name:"t",rawName:"v-t",value:"sdk.mapcontrols.scaleline.units."+t,expression:"`sdk.mapcontrols.scaleline.units.${unit}`"}],staticStyle:{"font-weight":"bold"},domProps:{value:t,selected:e.mapunit===t}})}),0)]):e._e(),e._v(" "),r("div",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top.create",value:"sdk.tooltips.copy_map_extent_url",expression:"'sdk.tooltips.copy_map_extent_url'",arg:"top",modifiers:{create:!0}}],staticStyle:{"background-color":"#eeeeee"},attrs:{id:"permalink"}},[r("span",{staticClass:"skin-color","class":e.g3wtemplate.getFontClass("link"),on:{click:function(t){return t.stopPropagation(),e.createCopyMapExtentUrl(t)}}})])])},n.staticRenderFns=[]},{"store/application-state":373}],260:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"metadata",data:function(){return{state:null}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div")},n.staticRenderFns=[]},{}],261:[function(e,t,r){e("vueify/lib/insert-css").insert('.layer_header[data-v-7fe06e7b]{padding:5px;margin-bottom:0;margin-top:0;cursor:pointer}.layer-name[data-v-7fe06e7b]{font-weight:700}.layer-header-icon[data-v-7fe06e7b]{margin-right:10px;color:#999}.layer_header span.open-close[data-v-7fe06e7b]{position:absolute;right:5px;color:#999}.metadata-label[data-v-7fe06e7b]{font-weight:700;font-size:1.1em}.row[data-v-7fe06e7b]{padding:10px;border-bottom:1px solid #e2e2e2}.nav-tabs[data-v-7fe06e7b]{border-bottom:0 solid #ddd}.nav-tabs>li.active>a[data-v-7fe06e7b],.nav-tabs>li.active>a[data-v-7fe06e7b]:focus,.nav-tabs>li.active>a[data-v-7fe06e7b]:hover{border-width:0}.nav-tabs>li>a[data-v-7fe06e7b]{border:none;color:#aeaeae}.nav-tabs>li.active>a[data-v-7fe06e7b],.nav-tabs>li>a[data-v-7fe06e7b]:hover{border:none;background:transparent}.nav-tabs>li>a[data-v-7fe06e7b]:after{content:"";height:2px;position:absolute;width:100%;left:0;bottom:-1px;transition:all .25s ease 0s;transform:scale(0)}.nav-tabs>li.active>a[data-v-7fe06e7b]:after,.nav-tabs>li:hover>a[data-v-7fe06e7b]:after{transform:scale(1)}.tab-nav>li>a[data-v-7fe06e7b]:after{background:#21527d none repeat scroll 0 0;color:#fff}.tab-content[data-v-7fe06e7b]{margin:10px;background-color:#eee;overflow:auto}.spatial-tab[data-v-7fe06e7b]{font-weight:700}');!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("mixins");r["default"]={name:"layer",mixins:[t.metadataMixin],props:{state:{}},data:function(){return{show:!1}},computed:{isSpatial:function(){return"NoGeometry"!=this.state.geometrytype}},methods:{showHideInfo:function(){this.show=!this.show}},mounted:function(){}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"row-info"},[r("h4",{staticClass:"layer_header",attrs:{"data-toggle":"collapse","data-target":"#"+e.state.id},on:{click:e.showHideInfo}},[r("i",{staticClass:"layer-header-icon action-button nohover","class":[e.isSpatial?e.g3wtemplate.font.map:e.g3wtemplate.font.table],attrs:{"aria-hidden":"true"}}),e._v(" "),r("span",{staticClass:"layer-name"},[e._v(e._s(e.state.name))]),e._v(" "),r("span",{staticClass:"action-button nohover open-close","class":[e.show?e.g3wtemplate.getFontClass("minus"):e.g3wtemplate.getFontClass("plus")]})]),e._v(" "),r("div",{staticClass:"collapse",attrs:{id:e.state.id}},[r("ul",{staticClass:"metadata-nav-tabs nav nav-tabs",attrs:{role:"tablist"}},[r("li",{staticClass:"active spatial-tab",attrs:{role:"presentation"}},[r("a",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.groups.general",expression:"'sdk.metadata.groups.layers.groups.general'"}],attrs:{href:"#layer_general_"+e.state.id,"aria-controls":"general",role:"tab","data-toggle":"tab"}})]),e._v(" "),e.isSpatial?r("li",{staticClass:"spatial-tab",attrs:{role:"presentation"}},[r("a",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.groups.spatial",expression:"'sdk.metadata.groups.layers.groups.spatial'"}],attrs:{href:"#layer_spatial_"+e.state.id,"aria-controls":"profile",role:"tab","data-toggle":"tab"}})]):e._e()]),e._v(" "),r("div",{staticClass:"tab-content"},[r("div",{staticClass:"tab-pane active",attrs:{role:"tabpanel",id:"layer_general_"+e.state.id}},[r("div",{staticClass:"container-fluid"},[e.findAttributeFormMetadataAttribute("title")?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.title",expression:"'sdk.metadata.groups.layers.fields.subfields.title'"}],staticClass:"col-md-2 col-sm-12 metadata-label"}),e._v(" "),r("div",{staticClass:"col-md-10 col-sm-12 value"},[e._v(e._s(e.state.metadata.title))])]):e._e(),e._v(" "),e.findMetadataAttribute("name")?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.name",expression:"'sdk.metadata.groups.layers.fields.subfields.name'"}],staticClass:"col-md-2 col-sm-12 metadata-label"}),e._v(" "),r("div",{staticClass:"col-md-10 col-sm-12 value"},[e._v(e._s(e.state.name))])]):e._e(),e._v(" "),e.findMetadataAttribute("source")?r("div",{staticClass:"row metadata-layer-source"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.source",expression:"'sdk.metadata.groups.layers.fields.subfields.source'"}],staticClass:"col-md-2 col-sm-12 metadata-label metadata-layer-source-value-key"}),e._v(" "),r("div",{staticClass:"col-md-10 col-sm-12 value metadata-layer-source-value"},[e._v(e._s(e.state.source.type))])]):e._e(),e._v(" "),e.findAttributeFormMetadataAttribute("abstract")?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.abstract",expression:"'sdk.metadata.groups.layers.fields.subfields.abstract'"}],staticClass:"col-md-2 col-sm-12 metadata-label"}),e._v(" "),r("div",{staticClass:"col-md-10 col-sm-12 value",domProps:{innerHTML:e._s(e.state.metadata["abstract"])}})]):e._e(),e._v(" "),e.findAttributeFormMetadataAttribute("keywords")?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.keywords",expression:"'sdk.metadata.groups.layers.fields.subfields.keywords'"}],staticClass:"col-md-2 col-sm-12 metadata-label"}),e._v(" "),r("div",{staticClass:"col-md-10 col-sm-12 value"},[r("div",[e._v(e._s(e.state.metadata.keywords.join(", ")))])])]):e._e(),e._v(" "),e.findAttributeFormMetadataAttribute("metadataurl")&&e.state.metadata.metadataurl.onlineresources?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.metadataurl",expression:"'sdk.metadata.groups.layers.fields.subfields.metadataurl'"}],staticClass:"col-md-2 col-sm-12 metadata-label"}),e._v(" "),r("div",{staticClass:"col-md-10 col-sm-12 value"},[r("a",{attrs:{href:e.state.metadata.metadataurl.onlineresources}},[e._v(e._s(e.state.metadata.metadataurl.onlineresources))])])]):e._e(),e._v(" "),e.findAttributeFormMetadataAttribute("dataurl")&&e.state.metadata.dataurl.onlineresources?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.dataurl",expression:"'sdk.metadata.groups.layers.fields.subfields.dataurl'"}],staticClass:"col-md-2 col-sm-12 metadata-label"}),e._v(" "),r("div",{staticClass:"col-md-10 col-sm-12 value"},[r("a",{attrs:{href:e.state.metadata.dataurl.onlineresources}},[e._v(e._s(e.state.metadata.dataurl.onlineresources))])])]):e._e(),e._v(" "),e.findAttributeFormMetadataAttribute("attributes")?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.attributes",expression:"'sdk.metadata.groups.layers.fields.subfields.attributes'"
}],staticClass:"col-md-2 col-sm-12 metadata-label"}),e._v(" "),r("div",{staticClass:"col-md-10 col-sm-12 value",staticStyle:{overflow:"auto"}},[r("table",{staticClass:"table table-striped",staticStyle:{"background-color":"#eeeeee !important"}},[r("thead",[r("tr",e._l(e.state.metadata.attributes[0],function(t,n){return r("th",[e._v(e._s(n))])}),0)]),e._v(" "),r("tbody",e._l(e.state.metadata.attributes,function(t){return r("tr",e._l(t,function(t,n){return r("td",[e._v(e._s(t))])}),0)}),0)])])]):e._e()])]),e._v(" "),r("div",{staticClass:"tab-pane",attrs:{role:"tabpanel",id:"layer_spatial_"+e.state.id}},[r("div",{staticClass:"container-fluid"},[e.findMetadataAttribute("crs")?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.crs",expression:"'sdk.metadata.groups.layers.fields.subfields.crs'"}],staticClass:"col-sm-2 metadata-label"}),e._v(" "),r("div",{staticClass:"col-sm-10 value"},[e._v(e._s(e.state.crs.epsg))])]):e._e(),e._v(" "),e.findMetadataAttribute("geometrytype")?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.geometrytype",expression:"'sdk.metadata.groups.layers.fields.subfields.geometrytype'"}],staticClass:"col-sm-2 metadata-label"}),e._v(" "),r("div",{staticClass:"col-sm-10 value"},[e._v(e._s(e.state.geometrytype))])]):e._e(),e._v(" "),e.findMetadataAttribute("bbox")?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.bbox",expression:"'sdk.metadata.groups.layers.fields.subfields.bbox'"}],staticClass:"col-sm-2 metadata-label"}),e._v(" "),r("div",{staticClass:"col-sm-10 value"},e._l(e.state.bbox,function(t,n){return r("p",[r("span",{staticStyle:{"font-weight":"bold","margin-right":"5px"}},[e._v(e._s(n))]),e._v(" "),r("span",[e._v(e._s(t))])])}),0)]):e._e(),e._v(" "),e.findAttributeFormMetadataAttribute("crs")?r("div",{staticClass:"row"},[r("div",{staticClass:"col-sm-2 metadata-label"},[e._v("CRS")]),e._v(" "),r("div",{staticClass:"col-sm-10 value"},e._l(e.state.metadata.crs,function(t){return r("div",[r("span",[e._v(e._s(t))])])}),0)]):e._e()])])])])])},n.staticRenderFns=[],n._scopeId="data-v-7fe06e7b"},{mixins:343,"vueify/lib/insert-css":1}],262:[function(e,t,r){e("vueify/lib/insert-css").insert(".metadata-nav-bar li a[data-v-7d2f43c3]{text-align:center}.metadata-nav-bar li a i[data-v-7d2f43c3]{margin-right:5px}.metadata-item-tab[data-v-7d2f43c3]{margin-right:10px;border-radius:3px;margin-bottom:10px}.metadata-body[data-v-7d2f43c3]{overflow-y:auto;overflow-x:hidden;padding-left:0;padding-right:0}.tab-title[data-v-7d2f43c3]{position:absolute;bottom:10px;right:auto}.row-info[data-v-7d2f43c3]{margin:0!important;padding-top:10px;padding-bottom:10px;border-bottom:1px solid #eee}.row-info .label[data-v-7d2f43c3]{font-weight:700}.h_90[data-v-7d2f43c3]{height:90%}.h_100[data-v-7d2f43c3]{height:100%}#project-catalog[data-v-7d2f43c3]{position:relative;overflow:auto}.nav-tabs-wrapper[data-v-7d2f43c3]{display:inline-block;margin-bottom:-6px;margin-left:1.25%;margin-right:1.25%;position:relative;width:100%}.nav-tabs[data-v-7d2f43c3]{border-bottom:0 none}.nav-stacked[data-v-7d2f43c3]{font-size:1.2em;font-weight:700;padding:10px 0}.nav-stacked li a[data-v-7d2f43c3]{color:#fff}.left-vertical-tabs[data-v-7d2f43c3]{padding-left:0!important}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("components/MetadataLayer.vue"),a=t(i),o=e("components/MetadataProjectTabContent.vue"),s=t(o),l=e("components/MetadataProjectBBoxContent.vue"),u=t(l),c=e("components/MetadataProjectContactsContent.vue"),d=t(c);r["default"]={name:"project",data:function(){return{state:this.$options.state,iconsClass:{info:this.g3wtemplate.getFontClass("info-circle"),globe:this.g3wtemplate.getFontClass("globe"),bars:this.g3wtemplate.getFontClass("bars")}}},components:{"metadata-layer":a["default"],"metadata-tab-content":s["default"],"metadata-bbox-content":u["default"],"metadata-contacts-content":d["default"]},methods:{isArrayorObject:function(e){return Array.isArray(e)||"object"===("undefined"==typeof e?"undefined":n(e))},setComponent:function(e){var t=void 0;switch(e){case"extent":t="metadata-bbox-content";break;case"contactinformation":t="metadata-contacts-content";break;default:t="metadata-tab-content"}return t}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"project-catalog"}},[r("div",{"class":e.isMobile()?"mobile":null,staticStyle:{padding:"0"},attrs:{id:"project-catalog-container"}},[r("ul",{staticClass:"nav nav-tabs metadata-nav-bar",attrs:{role:"tablist"}},[r("li",{staticClass:"active"},[r("a",{staticClass:"metadata-item-tab general",attrs:{"data-toggle":"tab",href:"#general"}},[r("i",{staticClass:"action-button nohover","class":e.g3wtemplate.getFontClass("info"),attrs:{"aria-hidden":"true"}}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.general.title",expression:"'sdk.metadata.groups.general.title'"}],staticStyle:{"font-weight":"bold"}})])]),e._v(" "),r("li",[r("a",{staticClass:"metadata-item-tab spatial",attrs:{"data-toggle":"tab",href:"#spatial"}},[r("i",{staticClass:"action-button nohover","class":e.iconsClass.globe,attrs:{"aria-hidden":"true"}}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.spatial.title",expression:"'sdk.metadata.groups.spatial.title'"}],staticStyle:{"font-weight":"bold"}})])]),e._v(" "),r("li",[r("a",{staticClass:"metadata-item-tab layers",attrs:{"data-toggle":"tab",href:"#metadata_layers"}},[r("i",{staticClass:"action-button nohover","class":e.iconsClass.bars,attrs:{"aria-hidden":"true"}}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.title",expression:"'sdk.metadata.groups.layers.title'"}],staticStyle:{"font-weight":"bold"}})])])])]),e._v(" "),r("div",{staticClass:"col-sm-12 metadata-body tab-content"},[r("div",{staticClass:"tab-pane fade in active",attrs:{id:"general"}},[e._l(e.state.groups.general,function(t,n){return r("div",{staticClass:"row h_100 row-info"},[r(e.setComponent(n),{tag:"component",attrs:{data:t,fieldName:n}})],1)})],2),e._v(" "),r("div",{staticClass:"tab-pane fade",attrs:{id:"spatial"}},[r("div",[e._l(e.state.groups.spatial,function(t,n){return r("div",{staticClass:"row row-info"},[r(e.setComponent(n),{tag:"component",attrs:{data:t,fieldName:n}})],1)})],2)]),e._v(" "),r("div",{staticClass:"tab-pane fade",attrs:{id:"metadata_layers"}},e._l(e.state.groups.layers.layers.value,function(e){return r("metadata-layer",{attrs:{state:e}})}),1)])])},n.staticRenderFns=[],n._scopeId="data-v-7d2f43c3"},{"components/MetadataLayer.vue":261,"components/MetadataProjectBBoxContent.vue":263,"components/MetadataProjectContactsContent.vue":264,"components/MetadataProjectTabContent.vue":265,"vueify/lib/insert-css":1}],263:[function(e,t,r){e("vueify/lib/insert-css").insert(".metadata-label[data-v-f53612c6]{font-weight:700;font-size:1.1em}.bbox-labels[data-v-f53612c6]{font-weight:700}");!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"metadata-bbox",props:{data:{}},data:function(){return{bboxlabels:["MINX","MINY","MAXX","MAXY"]}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"wrap-content-tab"},[r("div",{directives:[{name:"t",rawName:"v-t",value:e.data.label,expression:"data.label"}],staticClass:"col-sm-2 metadata-label"}),e._v(" "),r("div",{staticClass:"col-sm-10 value",staticStyle:{"margin-top":"0"}},e._l(e.data.value,function(t,n){return r("div",[r("span",{staticClass:"bbox-labels"},[e._v(e._s(e.bboxlabels[n]))]),e._v(" "+e._s(t)+"\n      ")])}),0)])},n.staticRenderFns=[],n._scopeId="data-v-f53612c6"},{"vueify/lib/insert-css":1}],264:[function(e,t,r){e("vueify/lib/insert-css").insert(".metadata-label[data-v-593d4393]{font-weight:700;font-size:1.1em}.metadata-contact-label[data-v-593d4393]{font-weight:700}.contact-icon[data-v-593d4393]{margin-right:3px}.row[data-v-593d4393]{margin-bottom:5px}");!function(){Object.defineProperty(r,"__esModule",{value:!0});var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r["default"]={name:"metadatacontatcs",props:{data:{}},data:function(){return{iconsClass:{contactelectronicmailaddress:this.g3wtemplate.getFontClass("mail"),personprimary:this.g3wtemplate.getFontClass("user"),contactvoicetelephone:this.g3wtemplate.getFontClass("mobile")}}},methods:{sanitizeValue:function(t){return null!==t&&void 0!==t&&("object"===("undefined"==typeof t?"undefined":e(t))?t=Object.keys(t).length?t:"":Array.isArray(t)&&(t=t.length?t:"")),t},geti18n:function(e){}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"wrap-content-tab"},[r("div",{directives:[{name:"t",rawName:"v-t",value:e.data.label,expression:"data.label"}],staticClass:"col-sm-2 metadata-label"}),e._v(" "),r("div",{staticClass:"col-sm-10 value",staticStyle:{"margin-top":"0"}},e._l(e.data.value,function(t,n){return r("div",[r("div",{staticClass:"row"},[r("div",{staticClass:"col-sm-2 metadata-contact-label"},[r("i",{staticClass:"contact-icon","class":e.iconsClass[n],attrs:{"aria-hidden":"true"}}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.general.fields.subfields.contactinformation."+n,expression:"'sdk.metadata.groups.general.fields.subfields.contactinformation.' + key"}]})]),e._v(" "),r("div",{staticClass:"col-sm-10"},["personprimary"===n?e._l(t,function(t,n){return r("div",[r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.general.fields.subfields.contactinformation."+n,expression:"'sdk.metadata.groups.general.fields.subfields.contactinformation.' + key"}],staticClass:"metadata-contact-label"}),e._v(" "),r("span",[e._v(e._s(t))])])}):r("div",["contactelectronicmailaddress"===n?[r("a",{staticStyle:{"font-weight":"bold"},attrs:{href:"mailto:"+e.sanitizeValue(t)}},[e._v(e._s(e.sanitizeValue(t)))])]:[e._v("\n              "+e._s(e.sanitizeValue(t))+"\n            ")]],2)],2)])])}),0)])},n.staticRenderFns=[],n._scopeId="data-v-593d4393"},{"vueify/lib/insert-css":1}],265:[function(e,t,r){e("vueify/lib/insert-css").insert(".metadata-label[data-v-4554ef47]{font-weight:700;font-size:1.1em}");!function(){Object.defineProperty(r,"__esModule",{value:!0});var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r["default"]={name:"metadata-tab-content",props:{data:{},fieldName:{}},computed:{arrayToString:function(){return this.data.value.join(", ")}},methods:{isArrayorObject:function(t){return Array.isArray(t)||"object"===("undefined"==typeof t?"undefined":e(t))}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"wrap-content-tab"},[r("div",{directives:[{name:"t",rawName:"v-t",value:e.data.label,expression:"data.label"}],staticClass:"col-sm-2 metadata-label"}),e._v(" "),"keywords"==e.fieldName?r("div",{staticClass:"col-sm-10 value"},[e._v("\n    "+e._s(e.arrayToString)+"\n  ")]):"wms_url"==e.fieldName?r("div",{staticClass:"col-sm-10 value",staticStyle:{"margin-top":"0"}},[r("span",[e._v(e._s(e.data.value))])]):e.isArrayorObject(e.data.value)?"abstract"==e.fieldName?r("div",{staticClass:"col-sm-10 value",staticStyle:{"margin-top":"0"}},[r("span",{domProps:{innerHTML:e._s(e.data.value)}})]):r("div",{staticClass:"col-sm-10 value",staticStyle:{"margin-top":"0"}},e._l(e.data.value,function(t,n){return r("div",[r("span",[e._v(e._s(t))])])}),0):r("div",{staticClass:"col-sm-10 value",staticStyle:{"margin-top":"0"}},[r("span",{domProps:{innerHTML:e._s(e.data.value)}})])])},n.staticRenderFns=[],n._scopeId="data-v-4554ef47"},{"vueify/lib/insert-css":1}],266:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("services/navbaritems"),i=t(n);r["default"]={name:"NavbaritemLeft",data:function(){return{items:i["default"].state.items.right}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ul",{staticClass:"nav navbar-nav navbar-left"},e._l(e.items,function(e){return r(e,{key:e.id,tag:"li"})}),1)},n.staticRenderFns=[],n._scopeId="data-v-c9635ba0"},{"services/navbaritems":365}],267:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("services/navbaritems"),i=t(n);r["default"]={name:"navbar-item-right",data:function(){return{items:i["default"].state.items.right}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ul",{staticClass:"nav navbar-nav navbar-right"},e._l(e.items,function(e){return r(e,{key:e.id,tag:"li"})}),1)},n.staticRenderFns=[],n._scopeId="data-v-0bc10dc3"},{"services/navbaritems":365}],268:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"download-notify"}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"download",rawName:"v-download.show",modifiers:{show:!0}}],staticClass:"skin-color",attrs:{id:"download_notification",title:"DOWNLOAD"}},[r("bar-loader",{attrs:{loading:"true"}}),e._v(" "),r("i",{"class":e.g3wtemplate.getFontClass("download"),staticStyle:{padding:"3px"}})],1)},n.staticRenderFns=[]},{}],269:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"online-notify"}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"online",rawName:"v-online:hide",arg:"hide"}],staticStyle:{color:"#999"},attrs:{id:"offline_notification"}},[r("i",{"class":e.g3wtemplate.getFontClass("wifi")}),e._v(" "),r("div",{staticStyle:{"font-weight":"bold","font-size":"0.4em"}},[e._v("offline")])])},n.staticRenderFns=[]},{}],270:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"plugins-notify"}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"plugins",rawName:"v-plugins"}],staticStyle:{color:"#994b10"},attrs:{id:"plugins_notification"}},[r("bar-loader",{attrs:{loading:"true"}}),e._v(" "),r("i",{"class":e.g3wtemplate.getFontClass("plugin")})],1)},n.staticRenderFns=[]},{}],271:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("components/PrintSelectAtlasFieldValues.vue"),a=t(i),o=e("components/PrintFidAtlasValues.vue"),s=t(o);r["default"]={name:"print",data:function(){return{state:null,templateChanged:!1,button:{"class":"btn-success",type:"stampa",disabled:!1}}},components:{SelectAtlasFieldValues:a["default"],FidAtlasValues:s["default"]},computed:{disabled:function(){return this.state.output.loading||!!this.state.atlas&&0===this.state.atlasValues.length}},methods:{setDisabledPrintButton:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.button.disabled=e},setAtlasValues:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.state.atlasValues=e},onChangeTemplate:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.templateChanged=!0,this.$options.service.changeTemplate(),e.next=4,this.$nextTick();case 4:this.templateChanged=!1;case 5:case"end":return e.stop()}},r,this)}));return e}(),onChangeScale:function(){this.$options.service.changeScale()},onChangeFormat:function(){},onChangeDpi:function(){},onChangeRotation:function(e){this.state.rotation>=0&&!_.isNil(this.state.rotation)&&""!=this.state.rotation?(this.state.rotation=this.state.rotation>360?360:this.state.rotation,e.target.value=this.state.rotation):this.state.rotation<0?(this.state.rotation=this.state.rotation<-360?-360:this.state.rotation,e.target.value=this.state.rotation):this.state.rotation=0,this.$options.service.changeRotation()},print:function(){this.$options.service.print()}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ul",{staticClass:"treeview-menu",attrs:{id:"print"}},[r("li",[r("form",{staticClass:"g3w-search-form form-horizonal"},[r("div",{staticClass:"box-body"},[r("transition",{attrs:{duration:500,name:"fade"}},[r("bar-loader",{attrs:{loading:e.state.loading}})],1),e._v(" "),r("helpdiv",{attrs:{message:"sdk.print.help"}}),e._v(" "),r("label",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.template",expression:"'sdk.print.template'"}],attrs:{"for":"templates"}}),e._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.state.template,expression:"state.template"}],staticClass:"form-control",style:{marginBottom:this.state.atlas&&"10px"},attrs:{id:"templates"},on:{change:[function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.state,"template",t.target.multiple?r:r[0])},e.onChangeTemplate]}},e._l(e.state.print,function(t){return r("option",{domProps:{value:t.name}},[e._v(e._s(t.name)+"\n          ")])}),0),e._v(" "),e.state.atlas?e.templateChanged?e._e():[e.state.atlas.field_name?[r("select-atlas-field-values",{attrs:{atlas:e.state.atlas,reset:!e.state.isShow},on:{"disable-print-button":e.setDisabledPrintButton,"set-values":e.setAtlasValues}})]:[r("fid-atlas-values",{attrs:{atlas:e.state.atlas,reset:!e.state.isShow},on:{"disable-print-button":e.setDisabledPrintButton,"set-values":e.setAtlasValues}})]]:[r("label",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.scale",expression:"'sdk.print.scale'"}],attrs:{"for":"scala"}}),e._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.state.scala,expression:"state.scala"}],staticClass:"form-control",attrs:{id:"scala"},on:{change:[function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.state,"scala",t.target.multiple?r:r[0])},e.onChangeScale]}},e._l(e.state.scale,function(t){return r("option",{domProps:{value:t.value}},[e._v(e._s(t.label)+"\n            ")])}),0),e._v(" "),r("label",{attrs:{"for":"dpi"}},[e._v("dpi")]),e._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.state.dpi,expression:"state.dpi"}],staticClass:"form-control",attrs:{id:"dpi"},on:{change:[function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.state,"dpi",t.target.multiple?r:r[0])},e.onChangeDpi]}},e._l(e.state.dpis,function(t){return r("option",[e._v(e._s(t))])}),0),e._v(" "),r("label",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.rotation",expression:"'sdk.print.rotation'"}],attrs:{"for":"rotation"}}),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.state.rotation,expression:"state.rotation"}],staticClass:"form-control",attrs:{min:"-360",max:"360",id:"rotation",type:"number"},domProps:{value:e.state.rotation},on:{input:[function(t){t.target.composing||e.$set(e.state,"rotation",t.target.value)},e.onChangeRotation]}}),e._v(" "),r("label",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.format",expression:"'sdk.print.format'"}],attrs:{"for":"format"}}),e._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.state.output.format,expression:"state.output.format"}],staticClass:"form-control",attrs:{id:"format"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.state.output,"format",t.target.multiple?r:r[0])}}},e._l(e.state.formats,function(t){return r("option",{domProps:{value:t.value}},[e._v(e._s(t.label))])}),0)],e._v(" "),e.state.labels&&e.state.labels.length?[r("div",{staticClass:"print-labels-content",staticStyle:{"margin-top":"5px"}},[r("label",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.labels",expression:"'sdk.print.labels'"}],staticClass:"skin-color",staticStyle:{"font-weight":"bold","font-size":"1.1em",display:"block","border-bottom":"2px solid #ffffff","margin-bottom":"5px"}}),e._v(" "),r("div",{staticClass:"labels-input-content",staticStyle:{"max-height":"120px","overflow-y":"auto"}},e._l(e.state.labels,function(t){return r("span",{key:t.id},[r("label",{attrs:{"for":"g3w_label_id_input_"+t.id}},[e._v(e._s(t.id))]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"label.text"}],staticClass:"form-control",attrs:{id:"g3w_label_id_input_"+t.id},domProps:{value:t.text},on:{input:function(r){r.target.composing||e.$set(t,"text",r.target.value)}}})])}),0)])]:e._e()],2),e._v(" "),r("div",{staticClass:"box-footer",staticStyle:{"background-color":"transparent"}},[r("span",[r("button",{directives:[{name:"disabled",rawName:"v-disabled",value:e.button.disabled,expression:"button.disabled"},{name:"download",rawName:"v-download"},{name:"t",rawName:"v-t",value:"create_print",expression:"'create_print'"}],staticClass:"sidebar-button-run btn",staticStyle:{width:"100%","font-weight":"bold"},attrs:{id:"printbutton"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.print(t)}}})])])])])])},n.staticRenderFns=[]},{"components/PrintFidAtlasValues.vue":272,"components/PrintSelectAtlasFieldValues.vue":274}],272:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"fid-atlas-values",props:{atlas:{type:Object},reset:{type:Boolean,"default":!1}},data:function(){return{value:""}},methods:{validateValue:function(e){return e=e&&1*e,Number.isInteger(e)&&e>=0&&e<this.atlas.feature_count||null}},watch:{value:{immediate:!0,handler:function(e){var t=this;this.value=e;var r=new Set,n=function(e){return null!==t.validateValue(e)&&r.add(e)},i=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.length,n=1;n<t;n++)for(var i=e[n-1],a=e[n],o=i;o<a;o++)r.add(o+"");r.add(e[t-1])};e&&e.split(",").forEach(function(e){if(e)if(e.indexOf("-")!==-1){var r=e.split("-"),a=r.filter(function(e){return null!==t.validateValue(e)});if(a.length===r.length){var o=a.reduce(function(e,t,r){return e&&(0===r||a[r-1]<=t)},!0);o&&i(a)}}else n(e)}),this.$emit("set-values",Array.from(r)),this.$emit("disable-print-button",""===e.trim())}},reset:function(e){e&&(this.value="",this.$emit("set-values",[]),this.$emit("disable-print-button",!0))}},beforeDestroy:function(){this.value=null,this.$emit("disable-print-button",!1)}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"form-group",staticStyle:{width:"100%"}},[r("label",{staticStyle:{display:"block"},attrs:{"for":e.print_atlas_fid}},[r("span",[e._v("fids [max: "+e._s(e.atlas.feature_count-1)+"]")])]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],staticClass:"form-control",domProps:{value:e.value},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:void t.preventDefault()},input:function(t){t.target.composing||(e.value=t.target.value)}}}),e._v(" "),r("div",{staticStyle:{"margin-top":"5px",color:"#ffffff"},attrs:{id:"fid-print-atals-instruction"}},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.fids_instruction",expression:"'sdk.print.fids_instruction'"}],staticStyle:{"white-space":"pre-line"},attrs:{id:"fids_intruction"}}),e._v(" "),r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.fids_example",expression:"'sdk.print.fids_example'"}],staticStyle:{"margin-top":"3px","font-weight":"bold"},attrs:{id:"fids_examples_values"}})])])},n.staticRenderFns=[],n._scopeId="data-v-453eedb2"},{}],273:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("app/constant"),a=e("services/gui"),o=t(a),s=e("core/utils/utils"),l=s.imageToDataURL;r["default"]={name:"print-page",data:function(){return{state:null,disableddownloadbutton:!0,downloadImageName:"",format:null}},computed:{loading:function(){return this.state.loading&&this.state.layers}},methods:{setLoading:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];o["default"].disableSideBar(e),this.state.loading=e,this.disableddownloadbutton=e},downloadImage:function(){var e=this;this.setLoading(!0),"jpg"!==this.format&&"png"!==this.format||(this.downloadImageName="download."+this.state.format,l({src:this.state.url,type:"image/"+this.state.format,callback:function(t){return setTimeout(function(){return e.setLoading(!1)})}}))}},watch:{"state.url":function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){var t,n=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!e){r.next=6;break}return this.format=this.state.format,r.next=4,this.$nextTick();case 4:t=setTimeout(function(){n.setLoading(!1),o["default"].showUserMessage({type:"alert",message:"timeout"})},i.TIMEOUT),$(this.$refs.printoutput).load(e,function(e,r){n.$options.service.stopLoading(),"error"===r&&n.$options.service.showError(),clearTimeout(t),n.setLoading(!1)});case 6:case"end":return r.stop()}},r,this)}));return e}()},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.state.layers&&this.$options.service.startLoading();case 3:case"end":return e.stop()}},r,this)}));return e}(),beforeDestroy:function(){this.state.url&&"POST"===this.state.method&&window.URL.revokeObjectURL(this.state.url)}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{height:"100%",position:"relative"},attrs:{id:"print-output"}},[r("transition",{attrs:{duration:500,name:"fade"}},[r("bar-loader",{attrs:{loading:e.loading}})],1),e._v(" "),"pdf"===e.format?r("iframe",{ref:"printoutput",staticStyle:{border:"0",width:"100%",height:"100%"},attrs:{type:e.state.mime_type,src:e.state.url}}):"png"===e.format?r("div",{staticClass:"g3w-print-png-output",staticStyle:{display:"flex","flex-direction":"column",position:"relative",height:"100%"}},[r("div",{staticStyle:{display:"flex","justify-content":"flex-end","align-items":"flex-end","margin-top":"5px","margin-bottom":"5px"},attrs:{id:"g3w-print-header"}},[r("div",{"class":{"g3w-disabled":e.disableddownloadbutton}},[r("a",{attrs:{href:e.state.url,download:e.downloadImageName}},[r("button",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"sdk.print.download_image",expression:"'sdk.print.download_image'",modifiers:{create:!0}}],staticClass:"btn skin-button skin-tooltip-left","class":e.g3wtemplate.getFontClass("download"),staticStyle:{"font-weight":"bold"},attrs:{"data-placement":"left","data-toggle":"tooltip",role:"button"},on:{click:e.downloadImage}})])])]),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:"png"===e.format&&e.state.url,expression:"format==='png' && state.url"}],staticStyle:{height:"100%",width:"100%",position:"relative","overflow-y":"auto"}},[r("img",{ref:"printoutput",staticStyle:{height:"auto","max-width":"100%"},attrs:{src:e.state.url}})])]):e._e(),e._v(" "),e.state.layers?e._e():r("h4",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.no_layers",expression:"'sdk.print.no_layers'"}],staticStyle:{"font-weight":"bold"}})],1)},n.staticRenderFns=[]},{"app/constant":4,"core/utils/utils":68,"services/gui":361}],274:[function(e,t,r){!function(){function t(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=e("mixins"),a=e("gui/external/select2/options/autocomplete");r["default"]={name:"selectAtlasFieldValues",mixins:[i.autocompleteMixin,i.select2Mixin],props:{atlas:{type:Object,required:!0},reset:{type:Boolean,"default":!1}},methods:{emitValues:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.$emit("set-values",this.values);case 3:case"end":return e.stop()}},n,this)}));return e}()},data:function(){return{values:[]}},watch:{values:{immediate:!0,handler:function(e){this.$emit("disable-print-button",0===e.length)}},reset:function(e){e&&(this.select2&&this.select2.val(null).trigger("change"),this.values=[],this.emitValues())}},mounted:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function i(){var e,r,o,s=this;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.$nextTick();case 2:e=this.atlas,r=e.field_name,o=e.qgs_layer_id,this.select2=$("#print_atlas_autocomplete").select2(n({width:"100%",
multiple:!0,dropdownParent:$(this.$el),minimumInputLength:1,ajax:{delay:500,transport:function(){function e(e,t,r){return n.apply(this,arguments)}var n=t(regeneratorRuntime.mark(function i(e,t,n){var a,l=e.data.q;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.autocompleteRequest({layerId:o,field:r,value:l});case 3:a=e.sent,t({results:a}),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),n(e.t0);case 10:case"end":return e.stop()}},i,s,[[0,7]])}));return e}()}},a)),this.select2.on("select2:select",function(e){var t=e.params.data.id;s.values.push(t),s.emitValues()}),this.select2.on("select2:unselect",function(){var e=t(regeneratorRuntime.mark(function r(e){var t;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:t=e.params.data.id,s.values=s.values.filter(function(e){return e!=t}),s.emitValues();case 3:case"end":return r.stop()}},r,s)}));return function(t){return e.apply(this,arguments)}}());case 6:case"end":return i.stop()}},i,this)}));return e}(),beforeDestroy:function(){this.values=null,this.$emit("disable-print-button",!1)}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"form-group",staticStyle:{width:"100%"}},[r("label",{staticStyle:{display:"block"},attrs:{"for":e.print_atlas_autocomplete}},[r("span",[e._v(e._s(e.atlas.field_name))])]),e._v(" "),r("select",{staticClass:"form-control",attrs:{name:e.atlas.field_name,id:"print_atlas_autocomplete"}})])},n.staticRenderFns=[],n._scopeId="data-v-7dbd92b3"},{"gui/external/select2/options/autocomplete":119,mixins:343}],275:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("store/projects"),i=t(n),a=e("services/gui"),o=t(a),s=e("core/i18n/i18n.service"),l=s.t,u="/static/client/images/FakeProjectThumb.png";r["default"]={name:"projects-menu",data:function(){return{state:null,loading:!1}},methods:{trigger:function(e){e.cbk?this._initCallback(e):e.href?window.open(e.href,"_blank"):e.route&&o["default"]["goto"](e.route)},_initCallback:function(e){var t=this;this._toggleModal(!0),e.cbk.call(e,{gid:e.gid}).then(function(e){e.then(function(e){e&&(document.title=e.state.html_page_title)}).fail(function(){o["default"].notify.error("<h4>"+l("error_map_loading")+"</h4><h5>"+l("check_internet_connection_or_server_admin")+"</h5>")}).always(function(){t._toggleModal(!1)})})},_toggleModal:function(e){o["default"].showFullModal({show:e}),o["default"].setLoadingContent(e)},logoSrc:function(e){var t=void 0,r=this.$options.host||"",n=e&&-1!==e.indexOf(i["default"].config.mediaurl),a=e&&-1===e.indexOf("static")&&-1===e.indexOf("media");return t=e?n?e:a?""+i["default"].config.mediaurl+e:u:u,""+r+t}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container",attrs:{id:"menu-projects"}},[r("div",{staticClass:"row row-equal"},[e._l(e.state.menuitems,function(t){return r("div",{key:t.title,staticClass:"col-xs-12 col-sm-4 project-menu",on:{click:function(r){return e.trigger(t)}}},[r("div",{staticClass:"project-menu-item-image"},[r("img",{staticClass:"img-responsive",attrs:{src:e.logoSrc(t.thumbnail)}})]),e._v(" "),r("div",{staticClass:"project-menu-item-content"},[r("div",{staticClass:"project-menu-item-text"},[r("h4",{staticClass:"project-menu-item-title"},[e._v(e._s(t.title))]),e._v(" "),r("div",{domProps:{innerHTML:e._s(t.description)}})])])])}),e._v(" "),e.state.menuitems.length?e._e():r("div",{staticStyle:{"margin-left":"15px"}},[r("h2",{directives:[{name:"t",rawName:"v-t",value:"no_other_projects",expression:"'no_other_projects'"}]})])],2)])},n.staticRenderFns=[]},{"core/i18n/i18n.service":13,"services/gui":361,"store/projects":379}],276:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var a=e("services/querybuilder"),o=t(a),s=e("app/constant"),l=e("store/projects"),u=t(l),c=Object.values(s.FILTER_OPERATORS);r["default"]={name:"query-builder",data:function(){var e=this.$options.options,t=void 0!==e;return{edit:t,currentlayer:null,message:"",filter:t?e.filter:"",loading:{test:!1,values:!1},values:[],manual:!0,manualvalue:null,select:{field:null,value:null}}},computed:{fields:function(){return this.currentlayer?this.currentlayer.fields:[]},disabled:function(){return!this.filter}},watch:{"select.field":function(){this.values=[],this.manual=!0}},methods:{addToExpression:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.value,r=e.type;switch(r){case"operator":t=" "+t+" ";break;case"field":t='"'+t+'"';break;case"value":t="'"+t+"'"}t&&(this.filter=""+this.filter+t)},all:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading.values=!0,e.prev=1,e.next=4,o["default"].getValues({layerId:this.currentlayer.id,field:this.select.field});case 4:this.values=e.sent,e.next=9;break;case 7:e.prev=7,e.t0=e["catch"](1);case 9:return this.loading.values=!1,e.next=12,this.$nextTick();case 12:this.manualvalue=null,this.manual=!1;case 14:case"end":return e.stop()}},r,this,[[1,7]])}));return e}(),reset:function(){this.filter="",this.message="",this.filterElement.previous=null,this.filterElement.current=null,this.filterElement.operator=null},test:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function r(){var e,t;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=this.currentlayer.id,this.loading.test=!0,t=void 0,r.prev=3,r.next=6,o["default"].test({layerId:e,filter:this.filter});case 6:t=r.sent,this.message=void 0!==t?" "+t:"",r.next=13;break;case 10:r.prev=10,r.t0=r["catch"](3),this.message=r.t0;case 13:return this.loading.test=!1,r.next=16,this.$nextTick();case 16:case"end":return r.stop()}},r,this,[[3,10]])}));return e}(),run:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function r(){var e,t;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=this.currentlayer.id,this.loading.test=!0,r.prev=2,r.next=5,o["default"].run({layerId:e,filter:this.filter});case 5:t=r.sent,r.next=10;break;case 8:r.prev=8,r.t0=r["catch"](2);case 10:this.loading.test=!1;case 11:case"end":return r.stop()}},r,this,[[2,8]])}));return e}(),save:function(){o["default"].save({layerId:this.currentlayer.id,filter:this.filter,projectId:this.projectId,name:this.edit&&this.$options.options.name,id:this.edit&&this.$options.options.id})}},created:function(){var e=this;this.filterElement={current:null,previous:null,operator:null};var t=u["default"].getCurrentProject();this.layers=t.getLayers().filter(function(e){return!e.baselayer&&e.geometrytype&&"NoGeometry"!==e.geometrytype&&Array.isArray(e.fields)}).map(function(e){var r=t.getRelationsByLayerId({layerId:e.id,type:"ONE"}),i=[];return r.forEach(function(e){var r=e.customPrefix,a=t.getLayerById(e.referencingLayer);r=void 0===r?a.getName()+"_":r;var o=a.getFields().map(function(e){return""+r+e.name});i=[].concat(n(i),n(o))}),{id:e.id,label:e.name,fields:e.fields.filter(function(e){return e.show}).map(function(e){var t=e.label,r=e.name;return{label:t,name:r}}).filter(function(e){return i.indexOf(e)===-1})}}),this.operators=c,this.currentlayer=this.edit?this.layers.find(function(t){return t.id===e.$options.options.layerId}):this.layers[0]},mounted:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function r(){var e,t=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.$nextTick();case 2:this.select2=$("#query_builder_layers_select").select2({width:"100%"}),this.edit&&(e=this.layers.indexOf(this.currentlayer),this.select2.val(e),this.select2.trigger("change")),this.select2.on("select2:select",function(e){t.currentlayer=t.layers[e.params.data.id],t.select.field=null,t.select.value=null,t.reset()});case 5:case"end":return r.stop()}},r,this)}));return e}(),beforeDestroy:function(){this.select2.select2("destroy"),this.select2=null}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"form-group",staticStyle:{"flex-wrap":"nowrap !important"},attrs:{id:"query_builder"}},[r("div",{attrs:{id:"query_builder_header"}}),e._v(" "),r("div",{staticClass:"margin-between-element",attrs:{id:"query_builder_layers"}},[r("label",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.layers",expression:"'sdk.querybuilder.panel.layers'"}],staticClass:"querybuilder-title"}),e._v(" "),r("select",{staticClass:"form-control",attrs:{id:"query_builder_layers_select"}},e._l(e.layers,function(t,n){return r("option",{key:t.label,staticClass:"bold",domProps:{value:n}},[e._v(e._s(t.label))])}),0)]),e._v(" "),r("div",{staticClass:"margin-between-element",attrs:{id:"query_builder_fields"}},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.fields",expression:"'sdk.querybuilder.panel.fields'"}],staticClass:"querybuilder-title",attrs:{id:"query_builder_fields_title"}}),e._v(" "),r("div",{staticClass:"querybuilder-content",attrs:{id:"query_builder_fields_content"}},[r("table",{staticClass:"table table-striped content-table"},[r("tbody",e._l(e.fields,function(t){var n=t.name,i=t.label;return r("tr",{key:n,"class":{"skin-background-color lighten":e.select.field===n},staticStyle:{cursor:"pointer"},on:{click:function(t){e.select.field=n},dblclick:function(t){return e.addToExpression({value:n,type:"field"})}}},[r("th",{attrs:{scope:"row"}},[e._v(e._s(i))])])}),0)])])]),e._v(" "),r("div",{staticClass:"margin-between-element",attrs:{id:"query_builder_values"}},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.values",expression:"'sdk.querybuilder.panel.values'"}],staticClass:"querybuilder-title",attrs:{id:"query_builder_values_title"}}),e._v(" "),e.manual?r("div",{staticClass:"margin-between-element",staticStyle:{display:"flex","justify-content":"space-between","align-items":"stretch"},attrs:{id:"querybuilder-manual"}},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.manualvalue,expression:"manualvalue"}],staticClass:"form-control",staticStyle:{border:"0"},attrs:{style:"border: 0;"},domProps:{value:e.manualvalue},on:{input:function(t){t.target.composing||(e.manualvalue=t.target.value)}}}),e._v(" "),r("span",{"class":e.g3wtemplate.getFontClass("plus"),staticStyle:{cursor:"pointer","font-size":"1.2em","background-color":"white",color:"#000000",padding:"9px"},on:{click:function(t){e.manualvalue&&e.addToExpression({value:e.manualvalue,type:"value"})}}})]):r("div",{staticClass:"querybuilder-content margin-between-element",attrs:{id:"query_builder_values_content"}},[r("bar-loader",{attrs:{loading:e.loading.values}}),e._v(" "),r("table",{staticClass:"table table-striped content-table"},[r("tbody",[e._l(e.values,function(t){return r("tr",{key:t,"class":{"skin-background-color lighten":e.select.value===t},staticStyle:{cursor:"pointer"},on:{click:function(r){e.select.value=t},dblclick:function(r){return e.addToExpression({value:t,type:"value"})}}},[r("th",{attrs:{scope:"row"}},[e._v(e._s(t))])])}),e._v(" "),e._m(0)],2)])],1),e._v(" "),r("div",{staticClass:"content-end skin-color",attrs:{id:"query_builder_values_buttons"}},[r("button",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.button.manual",expression:"'sdk.querybuilder.panel.button.manual'"}],staticClass:"query_builder_button btn btn-secondary bold ","class":{"skin-border-color":e.manual},attrs:{id:"query_builder_values_buttons_sample"},on:{click:function(t){e.manual=!0}}}),e._v(" "),r("button",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.button.all",expression:"'sdk.querybuilder.panel.button.all'"}],staticClass:"query_builder_button btn btn-secondary bold ","class":{"skin-border-color":!e.manual},attrs:{id:"query_builder_values_buttons_all",disabled:null===e.select.field},on:{click:e.all}})])]),e._v(" "),r("div",{staticClass:"margin-between-element",staticStyle:{"margin-top":"auto !important"},attrs:{id:"query_builder_operators"}},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.operators",expression:"'sdk.querybuilder.panel.operators'"}],staticClass:"querybuilder-title",attrs:{id:"query_builder_operators_title"}}),e._v(" "),r("div",{staticClass:"content-wrap",attrs:{id:"query_builder_operators_content"}},e._l(e.operators,function(t){return r("button",{key:t,staticClass:"query_builder_button btn btn-secondary skin-color bold",on:{click:function(r){return e.addToExpression({value:t,type:"operator"})}}},[e._v(e._s(t))])}),0)]),e._v(" "),r("div",{attrs:{id:"query_builder_footer"}},[r("div",{attrs:{id:"query_builder_expression"}},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.expression",expression:"'sdk.querybuilder.panel.expression'"}],staticClass:"querybuilder-title",attrs:{id:"query_builder_expression_title"}}),e._v(" "),r("div",{attrs:{id:"query_builder_expression_content"}},[r("textarea",{directives:[{name:"model",rawName:"v-model",value:e.filter,expression:"filter"}],staticStyle:{width:"100%",resize:"none",height:"100px",color:"#000000"},domProps:{value:e.filter},on:{input:function(t){t.target.composing||(e.filter=t.target.value)}}})])]),e._v(" "),r("div",{staticClass:"margin-between-element",attrs:{id:"query_builder_message"}},[r("bar-loader",{attrs:{loading:e.loading.test}}),e._v(" "),r("span",{directives:[{name:"show",rawName:"v-show",value:e.message,expression:"message"},{name:"t",rawName:"v-t",value:"sdk.querybuilder.messages.number_of_features",expression:"'sdk.querybuilder.messages.number_of_features'"}],staticClass:"bold skin-color"}),r("span",{staticClass:"bold skin-color"},[e._v(e._s(e.message))])],1),e._v(" "),r("div",{staticClass:"content-end margin-between-element",attrs:{id:"query_builder_footer_buttons"}},[r("button",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.button.test",expression:"'sdk.querybuilder.panel.button.test'"}],staticClass:"query_builder_button btn btn-secondary  bold",attrs:{disabled:e.disabled},on:{click:e.test}}),e._v(" "),r("button",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.button.clear",expression:"'sdk.querybuilder.panel.button.clear'"}],staticClass:"query_builder_button btn btn-secondary  bold",on:{click:e.reset}}),e._v(" "),r("button",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.button.run",expression:"'sdk.querybuilder.panel.button.run'"}],staticClass:"query_builder_button btn btn-secondary  bold",attrs:{disabled:e.disabled},on:{click:e.run}}),e._v(" "),r("button",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.button.save",expression:"'sdk.querybuilder.panel.button.save'"}],staticClass:"query_builder_button btn btn-secondary  bold",attrs:{disabled:e.disabled},on:{click:e.save}})])])])},n.staticRenderFns=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("tr",[r("th",{attrs:{scope:"row"}})])}]},{"app/constant":4,"services/querybuilder":366,"store/projects":379}],277:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("services/querybuilder"),a=t(i),o=e("gui/querybuilder/querybuilderuifactory");r["default"]={name:"g3w-querybuilder-search",props:{querybuildersearch:{required:!0}},data:function(){return{loading:!1,showinfo:!1}},methods:{remove:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a["default"]["delete"](this.querybuildersearch);case 3:this.$emit("delete"),e.next=8;break;case 6:e.prev=6,e.t0=e["catch"](0);case 8:case"end":return e.stop()}},r,this,[[0,6]])}));return e}(),edit:function(){o.show({options:{id:this.querybuildersearch.id,name:this.querybuildersearch.name,layerId:this.querybuildersearch.layerId,filter:this.querybuildersearch.filter}})},run:function(){var e=this;this.loading=!0,a["default"].run({layerId:this.querybuildersearch.layerId,filter:this.querybuildersearch.filter})["finally"](function(){e.loading=!1})}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",[r("div",{staticStyle:{position:"relative"}},[r("bar-loader",{attrs:{loading:e.loading}}),e._v(" "),r("div",{staticClass:"querybuliserch-tools",staticStyle:{display:"flex","align-items":"baseline"}},[r("i",{"class":e.g3wtemplate.getFontClass("filter"),staticStyle:{"margin-right":"14px","margin-left":"1px"}}),e._v(" "),r("span",{staticStyle:{"white-space":"pre-wrap"}},[e._v(e._s(e.querybuildersearch.name))]),e._v(" "),r("div",{staticStyle:{"margin-left":"auto"}},[r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.querybuilder.search.run",expression:"'sdk.querybuilder.search.run'"}],staticClass:"icon-search-action skin-tooltip-bottom",attrs:{"data-placement":"bottom","data-toggle":"tooltip"}},[r("i",{"class":e.g3wtemplate.getFontClass("run"),staticStyle:{color:"green",padding:"3px","font-size":"1.3em"},on:{click:function(t){return t.stopPropagation(),e.run(t)}}})]),e._v(" "),r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.querybuilder.search.info",expression:"'sdk.querybuilder.search.info'"}],staticClass:"icon-search-action skin-tooltip-bottom",attrs:{"data-placement":"bottom","data-toggle":"tooltip"}},[r("i",{"class":e.g3wtemplate.getFontClass("info"),staticStyle:{color:"#FFFFFF",padding:"3px","font-size":"1.3em"},on:{click:function(t){t.stopPropagation(),e.showinfo=!e.showinfo}}})]),e._v(" "),r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.querybuilder.search.edit",expression:"'sdk.querybuilder.search.edit'"}],staticClass:"icon-search-action skin-tooltip-bottom",attrs:{"data-placement":"bottom","data-toggle":"tooltip"}},[r("i",{"class":e.g3wtemplate.getFontClass("pencil"),staticStyle:{color:"#307095",padding:"3px","font-size":"1.3em"},on:{click:function(t){return t.stopPropagation(),e.edit(t)}}})]),e._v(" "),r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.querybuilder.search.delete",expression:"'sdk.querybuilder.search.delete'"}],staticClass:"icon-search-action skin-tooltip-bottom",attrs:{"data-placement":"bottom","data-toggle":"tooltip"}},[r("i",{"class":e.g3wtemplate.getFontClass("trash"),staticStyle:{color:"red",padding:"3px","font-size":"1.3em"},on:{click:function(t){return t.stopPropagation(),e.remove(t)}}})])])]),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.showinfo,expression:"showinfo"}],staticClass:"querybuildsearch-info",staticStyle:{"margin-top":"5px"}},[r("div",[r("span",{staticStyle:{"font-weight":"bold","white-space":"pre"}},[e._v("LAYER: ")]),e._v(" "),r("span",{staticStyle:{"white-space":"pre-wrap"}},[e._v(e._s(e.querybuildersearch.layerName))])]),e._v(" "),r("div",[r("span",{staticStyle:{"font-weight":"bold"}},[e._v("EXPRESSION: ")]),e._v(" "),r("span",{staticStyle:{"white-space":"pre-wrap"}},[e._v(e._s(e.querybuildersearch.filter))])])])],1)])},n.staticRenderFns=[],n._scopeId="data-v-196f3572"},{"gui/querybuilder/querybuilderuifactory":168,"services/querybuilder":366}],278:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=e("mixins"),o=e("components/QueryResultsTableAttributeFieldValue.vue"),s=t(o),l=e("components/QueryResultsActionInfoFormats.vue"),u=t(l),c=e("components/QueryResultsHeaderFeatureBody.vue"),d=t(c),f=e("core/utils/utils"),p=f.throttle,h=3,v=10,g=10,m=["varchar","integer","float","date"];r["default"]={name:"queryresults",data:function(){return{state:this.$options.queryResultsService.state,headerExpandActionCellWidth:v,headerActionsCellWidth:g}},mixins:[a.fieldsMixin],components:{TableAttributeFieldValue:s["default"],infoformats:u["default"],"header-feature-body":d["default"]},computed:{onelayerresult:function(){return 1===this.state.layers.length},hasLayers:function(){return this.hasResults||!!this.state.components.length},hasResults:function(){return this.state.layers.length>0},info:function(){if(this.state.query){var e=this.state.query;switch(e.type){case"coordinates":return{icon:"marker",message:"  "+e.coordinates[0]+", "+e.coordinates[1]};case"bbox":return{icon:"square",message:"  ["+e.bbox.join(" , ")+"]"};case"polygon":return{icon:"draw",message:e.layerName?e.layerName+" "+("undefined"!=typeof e.fid?" - Feature Id: "+e.fid:""):" "}}}else this.state.search;return{icon:null,message:null}}},methods:{getLayerCustomComponents:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"feature",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"after";return this.state.layerscustomcomponents[e]&&this.state.layerscustomcomponents[e][t]&&this.state.layerscustomcomponents[e][t][r]||[]},getLayerField:function(e){var t=e.layer,r=e.feature,n=e.fieldName,a=t.attributes.find(function(e){return e.name===n}),o=i({},a,{label:null,value:r.attributes[n]});return o},getQueryFields:function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var s,l=e.formStructure.fields[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){var u=s.value,c=i({},u);c.query=!0,c.value=t.attributes[u.name],c.input={type:""+this.getFieldType(c)},r.push(c)}}catch(d){a=!0,o=d}finally{try{!n&&l["return"]&&l["return"]()}finally{if(a)throw o}}return r},getColSpan:function(e){return this.attributesSubsetLength(e)+(this.state.layersactions[e.id].length?1:0)+1*!this.hasLayerOneFeature(e)},getDownloadActions:function(e){return this.state.layersactions[e.id].find(function(e){return e.formats})},addLayerFeaturesToResults:function(e){this.$options.queryResultsService.addLayerFeaturesToResultsAction(e)},showDownloadAction:function(e){var t=e.target.children[0].style.display;e.target.children[0].style.display="none"===t?"inline-block":"none"},printAtlas:function(e){this.$options.queryResultsService.printAtlas(e)},showLayerDownloadFormats:function(e){this.$options.queryResultsService.showLayerDownloadFormats(e)},saveLayerResult:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"csv";this.$options.queryResultsService.saveLayerResult({layer:e,type:t})},hasLayerOneFeature:function(e){return 1===e.features.length},addRemoveFilter:function(e){this.$options.queryResultsService.addRemoveFilter(e)},getContainerFromFeatureLayer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,r=e.index;return $("#"+t.id+"_"+r+" > td")},hasOneLayerAndOneFeature:function(e){return this.hasLayerOneFeature(e)},hasFormStructure:function(e){return!!e.formStructure},layerHasFeatures:function(e){return!!(e.features&&e.features.length>0)},selectionFeaturesLayer:function(e){this.$options.queryResultsService.selectionFeaturesLayer(e)},layerHasActions:function(e){return this.state.layersactions[e.id].length>0},featureHasActions:function(e,t){return this.geometryAvailable(t)},geometryAvailable:function(e){return!!e.geometry},extractAttributesFromFirstTabOfFormStructureLayers:function(e){var t=this,r=new Set,n=function a(n){if(n.nodes)n.nodes.forEach(function(e){return a(e)});else{var o=e.formStructure.fields.find(function(e){return e.name===n.field_name});o&&("ows"===t.state.type&&(o=i({},o),o.name=o.name.replace(/ /g,"_")),r.add(o))}};return e.formStructure.structure.length&&e.formStructure.structure.forEach(function(e){return n(e)}),Array.from(r)},attributesSubset:function(e){var t=this.hasFormStructure(e)?this.extractAttributesFromFirstTabOfFormStructureLayers(e):e.attributes,r=t.filter(function(e){return e.show&&m.indexOf(e.type)!==-1}),n=Math.min(h,t.length);return r.slice(0,n)},relationsAttributesSubset:function(e){var t=[];_.forEach(e,function(e,r){Array.isArray(e)||t.push({label:r,value:e})});var r=Math.min(h,t.length);return t.slice(0,r)},relationsAttributes:function(e){var t=[];return _.forEach(e,function(e,r){t.push({label:r,value:e})}),t},attributesSubsetLength:function(e){return this.attributesSubset(e).length},cellWidth:function(e,t){var r=h+this.state.layersactions[t.id].length,n=this.attributesSubsetLength(t),i=r-n,a=t.hasgeometry?g:0,o=100-v-a,s=o/h;return e===n-1&&i>0?s*(i+1):s},featureBoxColspan:function(e){var t=this.attributesSubsetLength(e);return e.expandable&&(t+=1),e.hasgeometry&&(t+=1),t},relationsAttributesSubsetLength:function(e){return this.relationsAttributesSubset(e).length},getLayerFormStructure:function(e){return e.formStructure.structure},isAttributeOrTab:function(e,t){var r=void 0!==t.field_name;return{type:r&&"field"||"tab",item:r&&this.getLayerAttributeFromStructureItem(e,t.field_name)||[t]}},getLayerAttributeFromStructureItem:function(e,t){return e.attributes.find(function(e){return e.name===t})},getLayerFeatureBox:function(e,t,r){var n=this,i=this.getBoxId(e,t,r);return void 0===this.state.layersFeaturesBoxes[i]&&(this.state.layersFeaturesBoxes[i]=Vue.observable({collapsed:!0}),this.$watch(function(){return n.state.layersFeaturesBoxes[i].collapsed},function(r){var i=e.features.findIndex(function(e){return t.id===e.id}),a=n.getContainerFromFeatureLayer({layer:e,index:i});n.$options.queryResultsService.openCloseFeatureResult({open:!r,layer:e,feature:t,container:a})}),this.state.layersFeaturesBoxes[i].collapsed=e.features.length>1),this.state.layersFeaturesBoxes[i]},collapsedFeatureBox:function(e,t,r){var n=this.getBoxId(e,t,r);return!this.state.layersFeaturesBoxes[n]||this.state.layersFeaturesBoxes[n].collapsed},showFeatureInfo:function(e,t){this.$options.queryResultsService.emit("show-query-feature-info",{layer:e,tabs:this.hasFormStructure(e),show:!!this.state.layersFeaturesBoxes[t]&&!this.state.layersFeaturesBoxes[t].collapsed})},getBoxId:function(e,t,r){return this.$options.queryResultsService.getBoxId(e,t,r)},toggleFeatureBox:function(){function e(e,r,n){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e,t,n){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=this.getBoxId(e,t,n),this.state.layersFeaturesBoxes[i].collapsed=!this.state.layersFeaturesBoxes[i].collapsed,r.next=4,this.$nextTick();case 4:this.showFeatureInfo(e,i);case 5:case"end":return r.stop()}},r,this)}));return e}(),toggleFeatureBoxAndZoom:function(e,t,r){!this.hasLayerOneFeature(e)&&this.toggleFeatureBox(e,t,r)},trigger:function(){function e(e,r,n,i){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e,t,n,i){var a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!e.opened||"none"!==$("#"+t.id+"_"+i).css("display")){r.next=4;break}return this.toggleFeatureBox(t,n),r.next=4,this.$nextTick();case 4:return a=this.getContainerFromFeatureLayer({layer:t,index:i}),r.next=7,this.$options.queryResultsService.trigger(e.id,t,n,i,a);case 7:case"end":return r.stop()}},r,this)}));return e}(),showFullPhoto:function(e){this.$options.queryResultsService.showFullPhoto(e)},openLink:function(e){window.open(e,"_blank")}},watch:{"state.layers":function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){var t,n,i,a=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e.forEach(function(e){e.attributes.length<=h&&!e.hasImageField&&(e.expandable=!1),e.features.forEach(function(t){if(a.getLayerFeatureBox(e,t),t.attributes.relations){var r=t.attributes.relations;r.forEach(function(r){var n=e.id+"_"+t.id+"_"+r.name,i=r.elements;i.forEach(function(e,t){a.state.layersFeaturesBoxes[n+t]={collapsed:!0}})})}})}),this.onelayerresult&&this.hasLayerOneFeature(e[0])&&(t=e[0],n=t.features[0],i=this.getBoxId(t,n),this.$options.queryResultsService.onceafter("postRender",function(){a.showFeatureInfo(t,i)})),requestAnimationFrame(function(){return a.$options.queryResultsService.postRender(a.$el)}),r.next=5,this.$nextTick();case 5:case"end":return r.stop()}},r,this)}));return e}(),onelayerresult:function(e){e&&this.$options.queryResultsService.highlightFeaturesPermanently(this.state.layers[0])}},created:function(){var e=this;this.zoomToLayerFeaturesExtent=p(function(t){e.$options.queryResultsService.zoomToLayerFeaturesExtent(t,{highlight:!0})})},beforeDestroy:function(){this.state.zoomToResult=!0},destroyed:function(){this.$options.queryResultsService.clear()}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"queryresults-wrapper",attrs:{id:"search-results"}},[e.info.message?r("div",{staticClass:"skin-color",staticStyle:{"font-weight":"bold","margin-bottom":"3px","font-size":"1.1em"}},[e.info.icon?r("span",{staticClass:"action-button skin-tooltip-bottom","class":e.g3wtemplate.getFontClass(e.info.icon)}):e._e(),e._v(" "),r("span",[e._v(e._s(e.info.message))])]):e._e(),e._v(" "),r("div",{staticClass:"queryresults-container"},[e.state.layers.length?[e.hasLayers?r("ul",{staticClass:"queryresults",staticStyle:{position:"relative"},attrs:{id:"queryresults"}},[e._l(e.state.layers,function(t){return r("li",{directives:[{name:"show",rawName:"v-show",value:(e.layerHasFeatures(t)||t.rawdata)&&t.show,expression:"(layerHasFeatures(layer) || layer.rawdata) && layer.show"}]},[r("bar-loader",{attrs:{loading:t.loading}}),e._v(" "),r("div",{staticClass:"box box-primary"},[r("div",{staticClass:"box-header with-border","class":{mobile:e.isMobile()},attrs:{"data-widget":"collapse"}},[r("div",{staticClass:"box-title query-layer-title",style:{fontSize:e.isMobile()&&"1em !important"}},[e._v(e._s(t.title)+"\n                "),r("span",{directives:[{name:"show",rawName:"v-show",value:!t.rawdata,expression:"!layer.rawdata"}],staticClass:"query-layer-feature-count"},[e._v("("+e._s(t.features.length)+")")])]),e._v(" "),r("div",{staticClass:"box-features-action",on:{click:function(e){e.stopPropagation()}}},[r("infoformats",{attrs:{layer:t}}),e._v(" "),t.features.length>1?[t.hasgeometry?r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"sdk.mapcontrols.query.actions.zoom_to_features_extent.hint",
expression:"'sdk.mapcontrols.query.actions.zoom_to_features_extent.hint'",arg:"left",modifiers:{create:!0}}],staticClass:"action-button",on:{click:function(r){return r.stopPropagation(),e.zoomToLayerFeaturesExtent(t)}}},[r("span",{staticClass:"action-button-icon","class":e.g3wtemplate.getFontClass("marker")})]):e._e(),e._v(" "),t.atlas.length?r("span",{directives:[{name:"download",rawName:"v-download"},{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"sdk.mapcontrols.query.actions.atlas.hint",expression:"'sdk.mapcontrols.query.actions.atlas.hint'",arg:"left",modifiers:{create:!0}}],staticClass:"action-button",on:{click:function(r){return r.stopPropagation(),e.printAtlas(t)}}},[r("span",{staticClass:"action-button-icon","class":e.g3wtemplate.getFontClass("print")})]):e._e(),e._v(" "),1===t.downloads.length?[r("span",{directives:[{name:"download",rawName:"v-download"},{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"sdk.mapcontrols.query.actions.download_features_"+t.downloads[0]+".hint",expression:"`sdk.mapcontrols.query.actions.download_features_${layer.downloads[0]}.hint`",arg:"left",modifiers:{create:!0}}],staticClass:"action-button","class":{toggled:t[t.downloads[0]].active}},[r("span",{staticClass:"action-button-icon","class":e.g3wtemplate.getFontClass("download"),on:{click:function(r){return r.stopPropagation(),e.saveLayerResult(t,t.downloads[0])}}})])]:t.downloads.length>1?[r("span",{directives:[{name:"download",rawName:"v-download"},{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"Downloads",expression:"'Downloads'",arg:"left",modifiers:{create:!0}}],staticClass:"action-button","class":{toggled:t.downloadformats.active}},[r("span",{staticClass:"action-button-icon","class":e.g3wtemplate.getFontClass("download"),on:{click:function(r){return r.stopPropagation(),e.showLayerDownloadFormats(t)}}})])]:e._e()]:e._e(),e._v(" "),t.external||t.source&&"wms"!==t.source.type?r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"sdk.mapcontrols.query.actions.add_features_to_results.hint",expression:"'sdk.mapcontrols.query.actions.add_features_to_results.hint'",arg:"left",modifiers:{create:!0}}],staticClass:"action-button","class":{toggled:t.addfeaturesresults.active},on:{click:function(r){return r.stopPropagation(),e.addLayerFeaturesToResults(t)}}},[r("span",{staticClass:"action-button-icon","class":e.g3wtemplate.getFontClass("plus-square")})]):e._e(),e._v(" "),t.features.length>1&&(t.external||t.source&&"wms"!==t.source.type)?r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"sdk.mapcontrols.query.actions.add_selection.hint",expression:"'sdk.mapcontrols.query.actions.add_selection.hint'",arg:"left",modifiers:{create:!0}}],staticClass:"action-button skin-tooltip-left","class":{toggled:t.selection.active},on:{click:function(r){return r.stopPropagation(),e.selectionFeaturesLayer(t)}}},[r("span",{staticClass:"action-button-icon","class":e.g3wtemplate.getFontClass("success")})]):e._e(),e._v(" "),r("span",{directives:[{name:"show",rawName:"v-show",value:t.selection.active&&!t.external,expression:"layer.selection.active && !layer.external"},{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"layer_selection_filter.tools.filter",expression:"'layer_selection_filter.tools.filter'",arg:"left",modifiers:{create:!0}}],staticClass:"action-button skin-tooltip-left","class":{toggled:t.filter.active},on:{click:function(r){return r.stopPropagation(),e.addRemoveFilter(t)}}},[r("span",{staticClass:"action-button-icon","class":e.g3wtemplate.getFontClass("filter")})])],2),e._v(" "),r("button",{staticClass:"btn btn-box-tool",attrs:{"data-widget":"collapse"}},[r("i",{staticClass:"btn-collapser skin-color","class":e.g3wtemplate.font.minus})])]),e._v(" "),e.state.layeractiontool[t.id].component?[r("div",{staticClass:"g3w-layer-action-tools with-border","class":{mobile:e.isMobile()},staticStyle:{padding:"5px"}},[r(e.state.layeractiontool[t.id].component,{tag:"component",attrs:{layer:t,config:e.state.layeractiontool[t.id].config}})],1)]:e._e(),e._v(" "),e._l(e.getLayerCustomComponents(t.id,"layer","before"),function(e){var n=e.component;return r(n,{tag:"component",attrs:{layer:t}})}),e._v(" "),r("div",{staticClass:"box-body","class":{mobile:e.isMobile()}},[t.rawdata?[r("div",{staticClass:"queryresults-text-html","class":{text:"text/plain"===t.infoformat},domProps:{innerHTML:e._s(t.rawdata)}})]:e.hasFormStructure(t)?[r("table",{staticClass:"table","class":{mobile:e.isMobile()}},[r("thead",[r("tr",[e.state.layersactions[t.id].length?r("th",{style:{width:26*e.state.layersactions[t.id].length+"px",maxWidth:26*e.state.layersactions[t.id].length+"px"}}):e._e(),e._v(" "),e._l(e.attributesSubset(t),function(t,n){return r("th",{staticClass:"centered"},[e._v(e._s(t.label))])}),e._v(" "),e.hasLayerOneFeature(t)?e._e():r("th",{staticClass:"collapsed"})],2)]),e._v(" "),r("tbody",[e._l(t.features,function(n,i){return n.show?[r("header-feature-body",{attrs:{actions:e.state.layersactions[t.id],layer:t,feature:n,index:i,onelayerresult:e.onelayerresult,trigger:e.trigger,toggleFeatureBoxAndZoom:e.toggleFeatureBoxAndZoom,hasLayerOneFeature:e.hasLayerOneFeature,boxLayerFeature:e.getLayerFeatureBox(t,n),attributesSubset:e.attributesSubset,getLayerField:e.getLayerField}}),e._v(" "),r("tr",{staticClass:"g3w-feature-result-action-tools"},[e.state.currentactiontools[t.id][i]?[r("td",{attrs:{colspan:e.getColSpan(t)}},[r(e.state.currentactiontools[t.id][i],{tag:"component",attrs:{colspan:e.getColSpan(t),layer:t,feature:n,featureIndex:i,config:e.state.actiontools[e.state.currentactiontools[t.id][i].name][t.id]}})],1)]:e._e()],2),e._v(" "),e._l(e.getLayerCustomComponents(t.id,"feature","before"),function(i){var a=i.component;return r("tr",[r("td",{attrs:{colspan:e.getColSpan(t)}},[r(a,{tag:"component",attrs:{layer:t,feature:n}})],1)])}),e._v(" "),r("tr",{directives:[{name:"show",rawName:"v-show",value:!e.collapsedFeatureBox(t,n)||e.hasOneLayerAndOneFeature(t),expression:"!collapsedFeatureBox(layer,feature) || hasOneLayerAndOneFeature(layer)"}],staticClass:"featurebox-body",attrs:{id:t.id+"_"+i}},[r("td",{attrs:{colspan:e.getColSpan(t)}},[r("tabs",{attrs:{fields:e.getQueryFields(t,n),layerid:t.id,feature:n,tabs:e.getLayerFormStructure(t)}})],1)]),e._v(" "),e._l(e.getLayerCustomComponents(t.id,"feature","after"),function(i){var a=i.component;return r("tr",[r("td",{attrs:{colspan:e.getColSpan(t)}},[r(a,{tag:"component",attrs:{layer:t,feature:n}})],1)])})]:e._e()})],2)])]:r("table",{staticClass:"table","class":{mobile:e.isMobile()}},[r("thead",[r("tr",[e.state.layersactions[t.id].length?r("th",{style:{width:26*e.state.layersactions[t.id].length+"px",maxWidth:26*e.state.layersactions[t.id].length+"px"}}):e._e(),e._v(" "),e._l(e.attributesSubset(t),function(t,n){return r("th",{staticClass:"centered"},[e._v(e._s(t.label))])}),e._v(" "),e.hasLayerOneFeature(t)?e._e():r("th",{staticClass:"collapsed"})],2)]),e._v(" "),e._l(t.features,function(n,i){return n.show?r("tbody",{key:n.id},[r("header-feature-body",{attrs:{actions:e.state.layersactions[t.id],layer:t,feature:n,index:i,onelayerresult:e.onelayerresult,trigger:e.trigger,toggleFeatureBoxAndZoom:e.toggleFeatureBoxAndZoom,hasLayerOneFeature:e.hasLayerOneFeature,boxLayerFeature:e.getLayerFeatureBox(t,n),attributesSubset:e.attributesSubset,getLayerField:e.getLayerField}}),e._v(" "),r("tr",{staticClass:"g3w-feature-result-action-tools"},[e.state.currentactiontools[t.id][i]?[r("td",{attrs:{colspan:e.getColSpan(t)}},[r(e.state.currentactiontools[t.id][i],{tag:"component",attrs:{colspan:e.getColSpan(t),layer:t,feature:n,featureIndex:i,config:e.state.actiontools[e.state.currentactiontools[t.id][i].name][t.id]}})],1)]:e._e()],2),e._v(" "),e._l(e.getLayerCustomComponents(t.id,"feature","before"),function(e){var i=e.component;return r("tr",[r("td",{attrs:{colspan:"getColSpan(layer)"}},[r(i,{tag:"component",staticClass:"box-body",attrs:{layer:t,feature:n}})],1)])}),e._v(" "),r("tr",{directives:[{name:"show",rawName:"v-show",value:!e.collapsedFeatureBox(t,n)||e.hasOneLayerAndOneFeature(t),expression:"!collapsedFeatureBox(layer,feature) || hasOneLayerAndOneFeature(layer)"}],staticClass:"featurebox-body",attrs:{id:t.id+"_"+i}},[r("td",{attrs:{colspan:e.getColSpan(t)}},[r("table",{staticClass:"feature_attributes"},e._l(t.attributes.filter(function(e){return e.show}),function(i){return r("tr",[r("td",{staticClass:"attr-label"},[e._v(e._s(i.label))]),e._v(" "),r("td",{staticClass:"attr-value",attrs:{attribute:i.name}},[r("table-attribute-field-value",{attrs:{feature:n,field:e.getLayerField({layer:t,feature:n,fieldName:i.name})}})],1)])}),0)])]),e._v(" "),e._l(e.getLayerCustomComponents(t.id,"feature","after"),function(e){var i=e.component;return r("tr",[r("td",{attrs:{colspan:"getColSpan(layer)"}},[r(i,{tag:"component",staticClass:"box-body",attrs:{layer:t,feature:n}})],1)])})],2):r("tbody")})],2)],2),e._v(" "),e._l(e.getLayerCustomComponents(t.id,"layer","after"),function(n){var i=n.component;return r("div",{staticClass:"box-body","class":{mobile:e.isMobile()}},[r(i,{tag:"component",attrs:{layer:t}})],1)})],2)],1)}),e._v(" "),e._l(e.state.components,function(t){return r("li",[r(t,{tag:"component",on:{showresults:function(t){return e.showResults()}}})],1)})],2):e._e()]:[e.state.changed?r("div",{staticClass:"query-results-not-found"},[r("h4",{directives:[{name:"t",rawName:"v-t",value:"info.no_results",expression:"'info.no_results'"}],staticClass:"skin-color",staticStyle:{"font-weight":"bold","text-align":"center"}})]):e._e()]],2)])},n.staticRenderFns=[]},{"components/QueryResultsActionInfoFormats.vue":281,"components/QueryResultsHeaderFeatureBody.vue":284,"components/QueryResultsTableAttributeFieldValue.vue":285,"core/utils/utils":68,mixins:343}],279:[function(e,t,r){!function(){function t(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("core/i18n/i18n.service"),i=n.t;r["default"]={name:"action",data:function(){return{show:!0}},props:{featureIndex:{type:Number},feature:{type:Object},layer:{type:Object},trigger:{type:Function},action:{type:Object,required:!0}},methods:{clickAction:function(){function e(e,t,n,i,a){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(e,t,r,a,o){var s,l;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.trigger(e,t,r,a);case 2:e.hint_change&&(s=$(o.target).parent(),l=s.attr("data-original-title"),s.attr("data-original-title",i(e.hint_change.hint)),s.tooltip("show"),setTimeout(function(){s.attr("data-original-title",l),s.tooltip("show")},e.hint_change.duration||600)),this.$emit("action-clicked",e);case 4:case"end":return n.stop()}},n,this)}));return e}()},created:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.action.init&&this.action.init({layer:this.layer,feature:this.feature,index:this.featureIndex,action:this.action}),"function"!=typeof this.action.condition){t.next=11;break}if(e=this.action.condition({layer:this.layer,feature:this.feature}),!(e instanceof Promise)){t.next=9;break}return t.next=6,e;case 6:t.t0=t.sent,t.next=10;break;case 9:t.t0=e;case 10:this.show=t.t0;case 11:case"end":return t.stop()}},n,this)}));return e}(),mounted:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:$('.action-button[data-toggle="tooltip"]').tooltip();case 3:case"end":return e.stop()}},n,this)}));return e}()}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.show?r("span",{directives:[{name:"download",rawName:"v-download",value:e.action.download,expression:"action.download"},{name:"t-title",rawName:"v-t-title",value:e.action.hint,expression:"action.hint"}],staticClass:"action-button skin-tooltip-right","class":{toggled:e.action.state&&e.action.state.toggled[e.featureIndex]},attrs:{"data-placement":"right","data-toggle":"tooltip"},on:{contextmenu:function(e){e.preventDefault(),e.stopPropagation()},click:function(t){return t.stopPropagation(),e.clickAction(e.action,e.layer,e.feature,e.featureIndex,t)}}},[r("span",{"class":"action-button-icon "+e.action["class"],staticStyle:{padding:"2px"},style:e.action.style})]):e._e()},n.staticRenderFns=[],n._scopeId="data-v-d925a4ca"},{"core/i18n/i18n.service":13}],280:[function(e,t,r){!function(){function e(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"downloadformats",data:function(){var e=this.config.downloads[0].format;return{download_format:e}},props:{featureIndex:{type:Number},feature:{type:Object},layer:{type:Object},config:{type:Object,"default":null}},methods:{download:function(){function t(){return r.apply(this,arguments)}var r=e(regeneratorRuntime.mark(function n(){var e,t=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,e=this.config.downloads.find(function(e){return e.format===t.download_format}),r.next=4,e.cbk(this.layer,this.feature?this.feature:this.layer.features,e,this.featureIndex);case 4:r.next=8;break;case 6:r.prev=6,r.t0=r["catch"](0);case 8:case"end":return r.stop()}},n,this,[[0,6]])}));return t}()}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"g3w-download-formats-content",staticStyle:{width:"100%",display:"flex"},on:{click:function(e){e.preventDefault(),e.stopPropagation()}}},[r("select",{directives:[{name:"select2",rawName:"v-select2",value:"download_format",expression:"'download_format'"}],staticClass:"form-control",staticStyle:{"flex-grow":"1"},attrs:{search:!1}},e._l(e.config.downloads,function(t){return r("option",{directives:[{name:"download",rawName:"v-download"}],key:t.id,domProps:{value:t.format}},[r("span",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(t.format))])])}),0),e._v(" "),r("button",{directives:[{name:"download",rawName:"v-download"}],staticClass:"btn skin-button",staticStyle:{"border-radius":"0 3px 3px 0"},on:{click:function(t){return t.stopPropagation(),e.download(t)}}},[r("span",{"class":e.g3wtemplate.getFontClass("download")})])])},n.staticRenderFns=[],n._scopeId="data-v-e70c266e"},{}],281:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=e("store/catalog-layers"),o=t(a),s=e("services/gui"),l=t(s),u=e("core/utils/parsers"),c=u.response,d=e("core/utils/geo"),f=d.getAlphanumericPropertiesFromFeature;r["default"]={name:"Infoformats",props:{layer:{type:Object,required:!0}},data:function(){return{infoformat:this.layer.infoformat}},computed:{infoformats:function(){return this.layer.infoformats||[]},hasInfo:function(){return this.infoformats.length}},methods:{reloadLayerDataWithChangedContentType:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){var t,n,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return this.layer.loading=!0,r.prev=1,r.next=4,this.projectLayer.changeProxyDataAndReloadFromServer("wms",{headers:{"Content-Type":e},params:{INFO_FORMAT:e}});case 4:t=r.sent,this.layer.infoformat=e,this.projectLayer.setInfoFormat(this.layer.infoformat),n=c.get(e)({layers:[this.projectLayer],response:t}),a=i(n,1),o=a[0],o.features?this.__parsedata(o):this.__parserawdata(o),r.next=14;break;case 11:r.prev=11,r.t0=r["catch"](1);case 14:this.layer.loading=!1;case 15:case"end":return r.stop()}},r,this,[[1,11]])}));return e}(),__parsedata:function(e){var t=this,r=l["default"].getService("queryresults");this.layer.rawdata=null,e.features.forEach(function(e){var n=r.getFeaturePropertiesAndGeometry(e),i=n.id,a=n.geometry,o=n.properties;0===t.layer.attributes.length&&(t.layer.hasgeometry=!!a,r.setActionsForLayers([t.layer]),f(o).forEach(function(e){t.layer.attributes.push({name:e,label:e,show:!0})})),t.layer.features.push({id:i,attributes:o,geometry:a,show:!0})})},__parserawdata:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.layer.features.splice(0),t.next=3,this.$nextTick();case 3:this.layer.rawdata=e.rawdata;case 4:case"end":return t.stop()}},r,this)}));return e}()},watch:{infoformat:function(e){this.reloadLayerDataWithChangedContentType(e)}},created:function(){this.projectLayer=o["default"].getLayerById(this.layer.id)},beforeDestroy:function(){this.projectLayer&&this.projectLayer.clearProxyData("wms"),this.projectLayer=null}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.hasInfo?r("select",{directives:[{name:"select2",rawName:"v-select2",value:"infoformat",expression:"'infoformat'"}],staticClass:"skin-color",attrs:{select2_value:e.infoformat,search:!1}},e._l(e.infoformats,function(t){return r("option",{key:t,domProps:{value:t}},[e._v(e._s(t))])}),0):e._e()},n.staticRenderFns=[]},{"core/utils/geo":64,"core/utils/parsers":67,"services/gui":361,"store/catalog-layers":374}],282:[function(e,t,r){e("vueify/lib/insert-css").insert(".g3w-polygonattributes-types-title[data-v-6b7c9920]{font-weight:700;padding:3px;color:#fff;margin:0 0 5px}.g3w-polygonattributes-types-content[data-v-6b7c9920]{display:flex;justify-content:space-between;padding:3px;border-radius:3px;border:1px solid #f4f4f4}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("store/application-state"),i=t(n),a=e("core/i18n/i18n.service"),o=a.t;r["default"]={name:"queryresults-querypolygonaddattributes",props:{layer:{type:Object},config:{type:Object,"default":null}},data:function(){return{type:this.config.choices[0].type}},created:function(){var e=this;this.unwatch=this.$watch(function(){return i["default"].language},function(){e.config.choices.forEach(function(t){return $(e.$refs[t.type]).text(o(t.label))}),$(e.$refs.g3w_select_feature_featurepolygon).select2().trigger("change")})},beforeDestroy:function(){this.unwatch&&this.unwatch(),this.unwatch=null}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{width:"100%"}},[r("h5",{directives:[{name:"t",rawName:"v-t",value:"sdk.mapcontrols.querybypolygon.download.title",expression:"'sdk.mapcontrols.querybypolygon.download.title'"}],staticClass:"skin-background-color g3w-polygonattributes-types-title"}),e._v(" "),r("div",{staticClass:"g3w-polygonattributes-types-content"},[r("select",{directives:[{name:"select2",rawName:"v-select2",value:"type",expression:"'type'"}],ref:"g3w_select_feature_featurepolygon",staticClass:"form-control",staticStyle:{width:"100%"},attrs:{search:!1}},e._l(e.config.choices,function(e){return r("option",{directives:[{name:"t",rawName:"v-t",value:e.label,expression:"choice.label"}],key:e.type,ref:e.type,refInFor:!0,domProps:{value:e.type}})}),0),e._v(" "),r("button",{staticClass:"btn skin-button",staticStyle:{"border-radius":"0 3px 3px 0"},on:{click:function(t){return t.stopPropagation(),e.config.download(e.type)}}},[r("span",{"class":e.g3wtemplate.getFontClass("download")})])])])},n.staticRenderFns=[],n._scopeId="data-v-6b7c9920"},{"core/i18n/i18n.service":13,"store/application-state":373,"vueify/lib/insert-css":1}],283:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("components/QueryResultsAction.vue"),i=t(n);r["default"]={name:"actions",props:{featureIndex:{type:Number},feature:{type:Object},layer:{type:Object},trigger:{type:Function},actions:{type:Array,"default":[]}},components:{action:i["default"]}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.actions.length?r("td",{staticClass:"g3w-feature-actions"},e._l(e.actions,function(t){return r("action",e._b({key:t.id,attrs:{action:t}},"action",e.$props,!1))}),1):e._e()},n.staticRenderFns=[],n._scopeId="data-v-4437b230"},{"components/QueryResultsAction.vue":279}],284:[function(e,t,r){e("vueify/lib/insert-css").insert(".noAttributes[data-v-412fa416]{display:flex;justify-content:flex-end}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("components/QueryResultsActions.vue"),i=t(n),a=e("mixins");r["default"]={name:"headerfeaturebody",mixins:[a.fieldsMixin],props:{toggleFeatureBoxAndZoom:{type:Function},trigger:{type:Function},hasLayerOneFeature:{type:Function},boxLayerFeature:{type:Object},getLayerField:{type:Function},attributesSubset:{type:Function},layer:{type:Object},feature:{type:Object},index:{type:Number},actions:{type:Array}},components:{actions:i["default"]}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("tr",{staticClass:"featurebox-header","class":[e.boxLayerFeature.collapsed?"":"featurebox-header-open"],on:{click:function(t){return e.toggleFeatureBoxAndZoom(e.layer,e.feature)},mouseover:function(t){return e.trigger({id:"highlightgeometry"},e.layer,e.feature,e.index)},mouseout:function(t){return e.trigger({id:"clearHighlightGeometry"},e.layer,e.feature,e.index)}}},[r("actions",{attrs:{layer:e.layer,featureIndex:e.index,trigger:e.trigger,feature:e.feature,actions:e.actions}}),e._v(" "),e._l(e.attributesSubset(e.layer),function(t){return r("td",{staticClass:"attribute"},[e.isLink(e.getLayerField({layer:e.layer,feature:e.feature,fieldName:t.name}))?r("span",{staticClass:"skin-color","class":e.g3wtemplate.getFontClass("link")}):e.isPhoto(e.getLayerField({layer:e.layer,feature:e.feature,fieldName:t.name}))?r("span",{staticClass:"skin-color","class":e.g3wtemplate.getFontClass("image")}):e.isImage(e.getLayerField({layer:e.layer,feature:e.feature,fieldName:t.name}))?r("span",{staticClass:"skin-color","class":e.g3wtemplate.getFontClass("image")}):r("span",[e._v(e._s(e.feature.attributes[t.name]))])])}),e._v(" "),e.hasLayerOneFeature(e.layer)?e._e():r("td",{staticClass:"collapsed","class":{noAttributes:0===e.attributesSubset(e.layer).length}},[r("span",{staticClass:"fa link morelink skin-color","class":[e.boxLayerFeature.collapsed?e.g3wtemplate.font.plus:e.g3wtemplate.font.minus]})])],2)},n.staticRenderFns=[],n._scopeId="data-v-412fa416"},{"components/QueryResultsActions.vue":283,mixins:343,"vueify/lib/insert-css":1}],285:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("components/FieldLink.vue"),i=t(n),a=e("components/FieldVue.vue"),o=t(a),s=e("mixins");r["default"]={name:"tableattributefieldvalue",props:{field:{type:Object},feature:{type:Object}},mixins:[s.fieldsMixin],components:{"g3w-link":i["default"],"g3w-vue":o["default"]}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.isVue(e.field)?r("g3w-vue",{attrs:{feature:e.feature,state:e.field}}):e.isSimple(e.field)?r("span",{domProps:{innerHTML:e._s(e.field.value)}}):e.isPhoto(e.field)?r("g3w-image",{attrs:{value:e.field.value}}):e.isImage(e.field)?r("g3w-image",{attrs:{value:e.field.value}}):e.isLink(e.field)?r("g3w-link",{attrs:{state:{value:e.field.value}}}):e._e()},n.staticRenderFns=[],n._scopeId="data-v-04dcd76c"},{"components/FieldLink.vue":209,"components/FieldVue.vue":212,mixins:343}],286:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("app/constant"),a=e("components/FieldG3W.vue"),o=t(a),s=e("components/QueryResultsActionDownloadFormats.vue"),l=t(s),u=e("store/catalog-layers"),c=t(u),d=e("services/gui"),f=t(d),p=e("mixins"),h=e("core/utils/utils"),v=h.throttle,g=e("gui/relations/vue/relationeventbus"),m=void 0;r["default"]={name:"relation",props:{table:{},feature:{"default":null},relation:{},previousview:{},showChartButton:{},cardinality:{}},inject:["relationnoback"],mixins:[p.fieldsMixin,p.resizeMixin],components:{Field:o["default"]},data:function(){return{fields:null,chart:!1,headercomponent:null,downloadButton:null,downloadLayer:{state:null,config:{downloads:[]}}}},computed:{showrelationslist:function(){return"relations"===this.previousview&&!this.relationnoback},one:function(){return"ONE"===this.relation.type}},methods:{createTable:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e,t,a,o=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=c["default"].getLayerById(this.table.layerId),this.isEditable=e.isEditable()&&!e.isInEditing(),t=e.isDownloadable()?e.getDownloadableFormats():[],a=t.length,a>0&&(this.downloadButton={toggled:!1,tooltip:a>1?"Downloads":"sdk.tooltips.download_"+t[0],handler:a>1?n(regeneratorRuntime.mark(function s(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:o.downloadButton.toggled=!o.downloadButton.toggled,o.downloadLayer.state=o.downloadLayer.state||e.state,o.downloadLayer.config.downloads=o.downloadLayer.config.downloads.length?o.downloadLayer.config.downloads:t.map(function(t){return{id:t,format:t,cbk:function(){o.saveRelation(e.getDownloadUrl(t)),o.headercomponent=null},download:!0}}),o.headercomponent=o.downloadButton.toggled?l["default"]:null;case 4:case"end":return r.stop()}},s,o)})):function(){return o.saveRelation(e.getDownloadUrl(t[0]))}}),g.$on("reload",function(){o.reloadLayout()}),this.showChart=v(n(regeneratorRuntime.mark(function u(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o.chart=!o.chart,t.next=3,o.$nextTick();case 3:o.chartContainer=o.chartContainer||$("#chart_content"),e={relations:[o.relation],fid:o.feature.attributes[i.G3W_FID]},o.$emit(o.chart?"show-chart":"hide-chart",o.chartContainer,e);case 6:case"end":return t.stop()}},u,o)}))),r.next=9,this.$nextTick();case 9:m=f["default"].getSize({element:"sidebar",what:"width"}),this.relation.title=this.relation.name,this.one||(this.relationDataTable=$(this.$refs.relationtable).DataTable({pageLength:10,bLengthChange:!0,scrollResize:!0,scrollCollapse:!0,scrollX:!0,responsive:!0,order:[this.table.formStructure?1:0,"asc"],columnDefs:[{orderable:!this.table.formStructure,targets:0}]}),this.tableHeaderHeight=$(".query-relation  div.dataTables_scrollHeadInner").height()),f["default"].on("pop-content",this.resize);case 13:case"end":return r.stop()}},r,this)}));return e}(),resize:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e,t,n,i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:this.$refs.query_relation&&"none"!==this.$refs.query_relation.parentNode.style.display&&(e=$(".content").height(),t=$(this.$refs.query_relation).find("div.dataTables_scrollBody"),n=$(".content_breadcrumb").outerHeight(),i=n+$(".navbar-header").outerHeight()+$(".close-panel-block").outerHeight()+$(this.$refs["relation-header"]).outerHeight()+$(".dataTables_filter").last().outerHeight()+$(".dataTables_paginate.paging_simple_numbers").outerHeight()+$(".dataTables_scrollHead").last().outerHeight(),t.height(e-this.tableHeaderHeight-i),this.table.rowFormStructure&&(a=t.width()-$(this.$refs.relationtable).find("tr.selected > td").outerWidth()-20,$(".row-wrap-tabs > .tabs-wrapper").width(a)),this.reloadLayout());case 1:case"end":return r.stop()}},r,this)}));return e}(),saveRelation:function(e){this.$emit("save-relation",e),this.downloadButton.toggled=!1},showFormStructureRow:function(){function e(e,r){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e,t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.table.rowFormStructure=this.table.rowFormStructure===t?null:t,this.fields=this.getRowFields(t),e.next=4,this.$nextTick();case 4:$("#relationtable_wrapper div.dataTables_scrollBody").css("overflow-x",this.table.rowFormStructure?"hidden":"auto"),this.resize();case 6:case"end":return e.stop()}},r,this)}));return e}(),editFeature:function(e){var t=f["default"].getService("queryresults");t.editFeature({layer:{id:this.table.layerId,attributes:this.table.fields},feature:this.table.features[e]})},getRowFields:function(e){var t=this;return this.table.fields.map(function(r,n){return r.value=e[n],r.query=!0,r.input={type:""+t.getFieldType(r)},r})},reloadLayout:function(){this.relationDataTable&&this.relationDataTable.columns.adjust()},back:function(){this.$parent.setRelationsList()},fieldIs:function(e,t){var r=this.getFieldType(t);return r===e},is:function(e,t){return this.fieldIs(e,t)},moveFnc:function(e){var t=$(".sidebar-collapse").length?0:m,r=e.pageX+2-t;this.$refs.tablecontent.style.width=r+"px",this.$refs.chartcontent.style.width=$(this.$refs.relationwrapper).width()-r-10+"px"}},watch:{table:{immediate:!0,handler:function(e){e&&e.rows.length&&this.createTable()}},chart:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.resize();case 3:case"end":return e.stop()}},r,this)}));return e}(),headercomponent:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.resize();case 3:case"end":return e.stop()}},r,this)}));return e}()},beforeCreate:function(){this.delayType="debounce";
},beforeDestroy:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.relationDataTable&&(this.relationDataTable.destroy(),this.relationDataTable=null,this.chartContainer&&this.$emit("hide-chart",this.chartContainer),this.chartContainer=null,this.tableHeaderHeight=null,f["default"].off("pop-content",this.resize));case 1:case"end":return e.stop()}},r,this)}));return e}()}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.table?r("div",{ref:"query_relation",staticClass:"query-relation","class":e.isMobile()?"mobile":null,staticStyle:{"margin-top":"3px"}},[r("div",{ref:"relation-header",staticClass:"header skin-background-color lighten",staticStyle:{padding:"3px",display:"flex","justify-content":"space-between","align-items":"center",width:"100%"}},[r("div",{staticClass:"g3w-long-text",staticStyle:{"border-radius":"3px"},style:{fontSize:e.isMobile()?"1em":"1.3em"}},[e.showrelationslist?r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:right.create",value:"sdk.relations.back_to_relations",expression:"'sdk.relations.back_to_relations'",arg:"right",modifiers:{create:!0}}],staticClass:"action-button-icon action-button","class":e.g3wtemplate.getFontClass("exit"),staticStyle:{"font-size":"0.8em"},on:{click:function(t){return t.stopPropagation(),e.back(t)}}}):e._e(),e._v(" "),r("span",{staticClass:"relation-tile skin-color",staticStyle:{"font-weight":"bold"}},[e._v(" "+e._s(e.relation.name))])]),e._v(" "),e.table.rows.length?r("div",{staticClass:"relations-table-tools",staticStyle:{"font-size":"1.1em","margin-bottom":"3px"}},[e.downloadButton?r("span",{directives:[{name:"download",rawName:"v-download"},{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:e.downloadButton.tooltip,expression:"downloadButton.tooltip",arg:"left",modifiers:{create:!0}}],staticClass:"action-button-icon action-button","class":[e.g3wtemplate.getFontClass("download"),{"toggled-white":e.downloadButton.toggled}],staticStyle:{padding:"5px"},on:{click:e.downloadButton.handler}}):e._e(),e._v(" "),e.showChartButton?r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:bottom.create",value:"sdk.tooltips.show_chart",expression:"'sdk.tooltips.show_chart'",arg:"bottom",modifiers:{create:!0}}],staticClass:"action-button-icon action-button","class":[e.g3wtemplate.getFontClass("chart"),e.chart?"toggled-white":""],staticStyle:{padding:"5px"},on:{click:function(t){return t.stopPropagation(),e.showChart(t)}}}):e._e()]):e._e()]),e._v(" "),e.table.rows.length?r("div",{ref:"relationwrapper",staticStyle:{display:"flex","justify-content":"space-between","margin-bottom":"5px","margin-top":"3px",height:"95%"}},[r("div",{ref:"tablecontent",style:{width:e.chart?"70%":"100%",marginRight:e.chart?"8px":"3px",position:"relative"},attrs:{id:"table_content"}},[e.headercomponent?[r("div",{staticStyle:{width:"100%",display:"flex","margin-left":"auto","margin-bottom":"5px","margin-right":"4px"}},[r(e.headercomponent,{tag:"component",attrs:{layer:e.downloadLayer.state,config:e.downloadLayer.config}})],1)]:e._e(),e._v(" "),r("table",{ref:"relationtable",staticClass:"hover relationtable table table-striped row-border",staticStyle:{width:"100%"}},[r("thead",[r("tr",{staticStyle:{height:"0! important"}},[e.table.formStructure||e.isEditable?r("th",{style:{minWidth:30*(1*!!e.table.formStructure+1*e.isEditable)+"px",padding:"0 !important"}}):e._e(),e._v(" "),e._l(e.table.columns,function(t){return r("th",[e._v(e._s(t))])})],2)]),e._v(" "),r("tbody",e._l(e.table.rows,function(t,n){return r("tr",{key:e.table.rows_fid[n],"class":{selected:e.table.rowFormStructure===t}},[e.table.formStructure||e.isEditable?r("td",[e.table.formStructure?r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:right.create",value:e.table.rowFormStructure===t?"sdk.tooltips.relations.form_to_row":"sdk.tooltips.relations.row_to_form",expression:"table.rowFormStructure === row ? 'sdk.tooltips.relations.form_to_row': 'sdk.tooltips.relations.row_to_form'",arg:"right",modifiers:{create:!0}}],staticClass:"action-button row-form skin-color","class":[e.table.rowFormStructure===t?e.g3wtemplate.getFontClass("minus"):e.g3wtemplate.getFontClass("table")],staticStyle:{cursor:"pointer"},attrs:{"current-tooltip":e.table.rowFormStructure===t?"sdk.tooltips.relations.form_to_row":"sdk.tooltips.relations.row_to_form"},on:{click:function(r){return r.stopPropagation(),e.showFormStructureRow(r,t)}}}):e._e(),e._v(" "),e.isEditable?r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:right.create",value:"Edit",expression:"'Edit'",arg:"right",modifiers:{create:!0}}],staticClass:"action-button row-form skin-color","class":e.g3wtemplate.getFontClass("pencil"),on:{click:function(t){return t.stopPropagation(),e.editFeature(n)}}}):e._e()]):e._e(),e._v(" "),e.table.formStructure&&e.table.rowFormStructure===t?[r("td",{staticClass:"row-wrap-tabs",attrs:{colspan:e.table.columns.length}},[r("tabs",{attrs:{layerid:e.table.layerId,feature:e.table.features[n],fields:e.fields,tabs:e.table.formStructure}})],1)]:e._l(t,function(e){return r("td",[r("field",{attrs:{state:{value:e}}})],1)})],2)}),0)])],2),e._v(" "),r("g3w-resize",{staticClass:"skin-border-color lighten",staticStyle:{"border-style":"solid","border-width":"0 1px 0 1px"},attrs:{show:e.chart,moveFnc:e.moveFnc,where:"content"}}),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.chart,expression:"chart"}],ref:"chartcontent",style:{width:e.chart?"30%":"0",paddingBottom:"5px",marginBottom:"5px",marginLeft:"8px"},attrs:{id:"chart_content"}})],1):r("div",{staticClass:"dataTables_scrollBody",staticStyle:{"font-weight":"bold","margin-top":"10px","font-size":"1.1em",display:"flex","justify-content":"space-between"}},[r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.relations.no_relations_found",expression:"'sdk.relations.no_relations_found'"}]})])]):e._e()},n.staticRenderFns=[]},{"app/constant":4,"components/FieldG3W.vue":206,"components/QueryResultsActionDownloadFormats.vue":280,"core/utils/utils":68,"gui/relations/vue/relationeventbus":174,mixins:343,"services/gui":361,"store/catalog-layers":374}],287:[function(e,t,r){e("vueify/lib/insert-css").insert(".relation-grid-item[data-v-25e93b10]{min-width:0;min-height:80px;border:2px solid;cursor:pointer;border-radius:4px;background-color:#fff;display:flex;align-items:center}.relation-grid-item[data-v-25e93b10]:hover{background-color:transparent}");!function(){function e(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var t=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();r["default"]={name:"relations",props:["relations","feature","loading"],methods:{showRelation:function(){function t(e){return r.apply(this,arguments)}var r=e(regeneratorRuntime.mark(function n(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$parent.showRelation(e);case 2:case"end":return t.stop()}},n,this)}));return t}(),featureInfo:function(){var e=[],r=0;return Object.entries(this.feature.attributes).forEach(function(n){var i=t(n,2),a=i[0],o=i[1];return!(r>2)&&void(o&&_.isString(o)&&o.indexOf("/")===-1&&(e.push({key:a,value:o}),r+=1))}),e}},mounted:function(){function t(){return r.apply(this,arguments)}var r=e(regeneratorRuntime.mark(function n(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(1!==this.relations.length){t.next=5;break}return e=this.relations[0],e.noback=!0,t.next=5,this.showRelation(e);case 5:case"end":return t.stop()}},n,this)}));return t}(),beforeDestroy:function(){1===this.relations.length&&delete this.relations[0].noback}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"query-relations",staticStyle:{"overflow-y":"auto"}},[r("div",{staticClass:"header skin-background-color lighten",staticStyle:{"margin-bottom":"10px","border-radius":"4px",padding:"5px"}},[r("div",{staticClass:"skin-color-dark"},[r("span",{directives:[{name:"t",rawName:"v-t:pre",value:"sdk.relations.list_of_relations_feature",expression:"'sdk.relations.list_of_relations_feature'",arg:"pre"}],staticStyle:{"font-size":"1.1em"}}),e._v(" "),e._l(e.featureInfo(),function(t){return r("span",[r("b",[e._v(e._s(t.key))]),e._v(": "+e._s(t.value)+" ")])})],2)]),e._v(" "),r("div",{staticClass:"query-relations-content",staticStyle:{display:"grid","grid-template-columns":"repeat(2, auto)","grid-column-gap":"5px","grid-row-gap":"5px"}},e._l(e.relations,function(t){return r("div",{staticClass:"skin-border-color relation-grid-item",on:{click:function(r){return e.showRelation(t)}}},[r("span",{staticClass:"skin-color g3w-long-text",staticStyle:{"font-weight":"bold",padding:"5px"}},[e._v(e._s(t.name))])])}),0)])},n.staticRenderFns=[],n._scopeId="data-v-25e93b10"},{"vueify/lib/insert-css":1}],288:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("services/gui"),a=t(i),o=e("components/Relations.vue"),s=t(o),l=e("components/Relation.vue"),u=t(l),c=e("constant"),d=e("core/utils/geo"),f=d.getFeaturesFromResponseVectorApi,p=e("gui/relations/vue/relationeventbus");r["default"]={name:"relation-page",data:function(){this.chartRelationIds=this.$options.chartRelationIds||[];var e=this.$options,t=e.table,r=e.relation,n=void 0===r?null:r,i=e.relations,a=e.nmRelation,o=e.feature,s=e.currentview,l=e.service;return{loading:!1,state:null,error:!1,table:t?l.buildRelationTable(t):null,relation:n,relations:i,nmRelation:a,showChartButton:!1,feature:o,currentview:s,previousview:s}},provide:function(){return{relationnoback:1===this.$options.relations.length}},components:{relations:s["default"],relation:u["default"]},methods:{saveRelations:function(e){this.$options.service.saveRelations(e)},reloadLayout:function(){p.$emit("reload")},showChart:function(e,t){var r=this.relation.referencingLayer;a["default"].getService("queryresults").showChart([r],e,t)},hideChart:function(e){a["default"].getService("queryresults").hideChart(e)},showRelation:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){var t,n,i,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a["default"].setLoadingContent(!0),this.loading=!0,this.relation=e,t=e.referencingLayer,n=this.feature.attributes[c.G3W_FID],r.prev=5,r.next=8,this.$options.service.getRelations({layer:this.$options.layer,relation:e,fid:n});case 8:if(i=r.sent,o=f(i,{type:"result"}),!this.nmRelation){r.next=15;break}return t=this.nmRelation.referencedLayer,r.next=14,this.$options.service.getRelationsNM({nmRelation:this.nmRelation,features:o});case 14:o=r.sent;case 15:return this.showChartButton=!!this.chartRelationIds.find(function(e){return e===t}),this.table=this.$options.service.buildRelationTable(o,t),a["default"].changeCurrentContentOptions({title:e.name,crumb:{title:e.name}}),r.next=20,this.$nextTick();case 20:this.previousview=this.currentview,this.currentview="relation",r.next=26;break;case 24:r.prev=24,r.t0=r["catch"](5);case 26:a["default"].setLoadingContent(!1),this.loading=!0;case 28:case"end":return r.stop()}},r,this,[[5,24]])}));return e}(),setRelationsList:function(){this.previousview="relation",this.currentview="relations",a["default"].changeCurrentContentOptions({crumb:{title:c.LIST_OF_RELATIONS_TITLE}}),this.loading=!1}},beforeMount:function(){("relation"===this.currentview||1===this.relations.length&&"ONE"===this.relations[0].type)&&this.showRelation(this.relations[0])},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.relations.sort(function(e,t){var r=e.name,n=t.name;return r<n?-1:r>n?1:0}),e.next=3,this.$nextTick();case 3:this.error&&requestAnimationFrame(function(){a["default"].popContent()}),this.error=!1;case 5:case"end":return e.stop()}},r,this)}));return e}()}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"query-relations-page"},[r(e.currentview,{ref:e.currentview,tag:"component",attrs:{loading:e.loading,previousview:e.previousview,showChartButton:e.showChartButton,relations:e.relations,relation:e.relation,nmRelation:e.nmRelation,feature:e.feature,table:e.table},on:{"save-relation":e.saveRelations,"show-chart":e.showChart,"hide-chart":e.hideChart}})],1)},n.staticRenderFns=[]},{"components/Relation.vue":286,"components/Relations.vue":287,constant:4,"core/utils/geo":64,"gui/relations/vue/relationeventbus":174,"services/gui":361}],289:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("components/Tool.vue"),a=t(i),o=e("components/QueryBuilderSearch.vue"),s=t(o);r["default"]={name:"search",data:function(){return{state:null}},components:{"g3w-tool":a["default"],"g3w-search-querybuilder":s["default"]},computed:{show:function(){return this.state.searches.length+this.state.searchtools.length+this.state.querybuildersearches.length>0}},methods:{showPanel:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$options.service.showPanel(e)},removeItem:function(e){var t=e.type,r=e.index;this.$options.service.removeItem({type:t,index:r})}},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:$(".icon-search-action").tooltip();case 3:case"end":return e.stop()}},r,this)}));return e}()}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.show?r("ul",{staticClass:"treeview-menu g3w-search g3w-tools menu-items",attrs:{id:"g3w-search"}},[e._l(e.state.searches,function(t){return r("li",{staticClass:"menu-item",on:{click:function(r){return e.showPanel(t)}}},[r("i",{"class":e.g3wtemplate.getFontClass("empty-circle")}),e._v(" "),r("span",[e._v(e._s(t.name))])])}),e._v(" "),e._l(e.state.searchtools,function(e){return r("li",[r("g3w-tool",{attrs:{tool:e}})],1)}),e._v(" "),e._l(e.state.querybuildersearches,function(t,n){return r("g3w-search-querybuilder",{key:t.id,attrs:{querybuildersearch:t},on:{"delete":function(t){return e.removeItem({type:"querybuilder",index:n})}}})})],2):e._e()},n.staticRenderFns=[]},{"components/QueryBuilderSearch.vue":277,"components/Tool.vue":305}],290:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("store/application-state"),a=t(i),o=e("core/utils/utils"),s=o.getUniqueDomId,l=o.convertQGISDateTimeFormatToMoment;r["default"]={name:"Searchdatetime",props:{forminput:{type:Object,require:!0}},created:function(){this.id="search_datetime_"+s()},computed:{time:function(){return this.forminput.options.format.time}},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e,t,n,i=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.$nextTick();case 2:e=this.forminput.options.format,t=e.fieldformat,n=e.displayformat,t=l(t),n=l(n),$("#"+this.id).datetimepicker({defaultDate:null,format:n,ignoreReadonly:!0,allowInputToggle:!0,toolbarPlacement:"top",widgetPositioning:{vertical:"bottom",horizontal:"left"},showClose:!0,locale:a["default"].language||"en"}),$("#"+this.id).on("dp.change",function(){var e=$("#"+i.forminput.id).val();i.forminput.value=_.isEmpty(_.trim(e))?null:moment(e,n).format(t),i.$emit("change",i.forminput)}),a["default"].ismobile&&setTimeout(function(){$("#"+i.forminput.id).blur()});case 9:case"end":return r.stop()}},r,this)}));return e}()}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"input-group date",attrs:{id:e.id}},[r("input",{staticClass:"form-control",attrs:{id:e.forminput.id,type:"text"}}),e._v(" "),r("span",{staticClass:"input-group-addon skin-color"},[r("span",{"class":e.g3wtemplate.getFontClass(e.time?"time":"calendar")})])])},n.staticRenderFns=[]},{"core/utils/utils":68,"store/application-state":373}],291:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=e("components/SearchSelect2.vue"),o=t(a),s=e("components/SearchDatetime.vue"),l=t(s),u=e("components/SearchPanelLabel.vue"),c=t(u);r["default"]={components:{Select2:o["default"],SearchDatetime:l["default"],SearchPanelLabel:c["default"]},data:function(){return{state:this.$options.service.state}},methods:{isSelectDisabled:function(e){return[this.state.loading[e.options.dependance],e.loading,e.options.disabled].reduce(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e||t},!1)},onFocus:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){var t;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!this.isMobile()){r.next=5;break}return t=$(e.target).position().top-10,r.next=4,this.$nextTick();case 4:setTimeout(function(){return $(".sidebar").scrollTop(t)},500);case 5:case"end":return r.stop()}},r,this)}));return e}(),autocompleteRequest:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.$options.service.getUniqueValuesFromField(i({},e,{output:"autocomplete"})));case 1:case"end":return t.stop()}},r,this)}));return e}(),changeDependencyFields:function(e){var t=e.attribute,r=e.value,n=this.$options.service.getDependencies(t);return n.length?this.$options.service.fillDependencyInputs({field:t,subscribers:n,value:r}):Promise.resolve()},changeNumericInput:function(e){e.value=e.value||0===e.value?e.value:null,this.changeInput(e)},changeInput:function(e){var t=this,r=e.id,n=e.attribute,i=e.value,a=e.type;try{i="textfield"===a||"textField"===a?i:i.trim()}catch(o){}this.$options.service.changeInput({id:r,value:i}),this.state.searching=!0,this.changeDependencyFields({attribute:n,value:i})["finally"](function(){t.state.searching=!1})},doSearch:function(e){e.preventDefault(),this.$options.service.run()}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.state.searching,expression:"state.searching"}],staticClass:"g3w-search-panel form-group"},[r("h4",{},[r("b",[e._v(e._s(e.state.title))])]),e._v(" "),e._t("tools"),e._v(" "),e._t("form",[r("form",{staticClass:"g3w-search-form"},[e._l(e.state.forminputs,function(t){return r("span",{key:t.id},["numberfield"===t.type?r("div",{staticClass:"form-group numeric"},[r("search-panel-label",{attrs:{forminput:t}}),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"forminput.value"}],staticClass:"form-control",attrs:{type:"number",min:"0",id:t.id},domProps:{value:t.value},on:{change:function(r){return e.changeNumericInput(t)},input:[function(r){r.target.composing||e.$set(t,"value",r.target.value)},function(r){return e.changeNumericInput(t)}]}})],1):"textfield"===t.type||"textField"===t.type?r("div",{staticClass:"form-group form-item-search  text"},[r("search-panel-label",{attrs:{forminput:t}}),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"forminput.value"}],staticClass:"form-control",attrs:{type:"text",id:t.id},domProps:{value:t.value},on:{focus:e.onFocus,change:function(r){return e.changeInput(t)},input:function(r){r.target.composing||e.$set(t,"value",r.target.value)}}})],1):"selectfield"===t.type||"autocompletefield"===t.type?r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.isSelectDisabled(t),expression:"isSelectDisabled(forminput)"}],staticClass:"form-group text"},[r("search-panel-label",{attrs:{forminput:t}}),e._v(" "),t.options.dependance?r("bar-loader",{attrs:{loading:e.state.loading[t.options.dependance]||t.loading}}):e._e(),e._v(" "),r("select2",{attrs:{forminput:t,autocompleteRequest:e.autocompleteRequest},on:{"select-change":e.changeInput}})],1):e._e(),e._v(" "),"datetimefield"===t.type?r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.state.loading[t.options.dependance]||!1,expression:"state.loading[forminput.options.dependance] || false"}],staticClass:"form-group text"},[r("search-panel-label",{attrs:{forminput:t}}),e._v(" "),r("search-datetime",{attrs:{forminput:t},on:{change:e.changeInput}})],1):e._e(),e._v(" "),t.logicop?r("div",{staticClass:"search-logicop skin-border-color"},[r("h4",[e._v(e._s(t.logicop))])]):e._e()])}),e._v(" "),r("div",{staticClass:"form-group"},[r("button",{directives:[{name:"t",rawName:"v-t",value:"dosearch",expression:"'dosearch'"}],staticClass:"sidebar-button-run btn btn-block pull-right",attrs:{id:"dosearch","data-i18n":"dosearch"},on:{click:function(t){return t.stopPropagation(),e.doSearch(t)}}})])],2)]),e._v(" "),e._t("footer")],2)},n.staticRenderFns=[]},{"components/SearchDatetime.vue":290,"components/SearchPanelLabel.vue":292,"components/SearchSelect2.vue":293}],292:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("app/constant");r["default"]={name:"Searchpanellabel",props:{forminput:{type:Object,require:!0}},methods:{getLabelOperator:function(e){return"[ "+t.FILTER_EXPRESSION_OPERATORS[e]+" ]"}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("label",{staticClass:"search-label",staticStyle:{width:"100%",display:"flex","justify-content":"space-between"},attrs:{"for":e.forminput.id}},[r("span",[e._v(e._s(e.forminput.label||e.forminput.attribute))]),e._v(" "),r("span",{staticClass:"skin-color"},[e._v(e._s(e.getLabelOperator(e.forminput.operator)))])])},n.staticRenderFns=[]},{"app/constant":4}],293:[function(e,t,r){!function(){function t(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=e("app/constant"),a=e("mixins"),o=e("gui/external/select2/options/autocomplete"),s=e("core/i18n/i18n.service"),l=(s.t,e("core/utils/utils"));l.debounce;r["default"]={name:"select2",props:["forminput","autocompleteRequest"],mixins:[a.select2Mixin],methods:{emitChangeEvent:function(e){var t=$(e.target).attr("id"),r=$(e.target).attr("name"),n=e.params.data,a=n?n.id:i.SEARCH_ALLVALUE;this.$emit("select-change",{id:t,attribute:r,value:a,type:this.forminput.type})},_initSelect2Element:function(){var e=this,r=this.forminput,i=r.type,a=r.attribute,s=r.options,l=s.numdigaut&&!Number.isNaN(1*s.numdigaut)&&1*s.numdigaut>0&&1*s.numdigaut||2,u="autocompletefield"===i;this.select2=$(this.$el).select2(n({width:"100%",dropdownParent:$(".g3w-search-form:visible"),minimumInputLength:u&&l||0,allowClear:u,placeholder:u?"":null,ajax:u?{delay:500,transport:function(){function r(e,t,r){return n.apply(this,arguments)}var n=t(regeneratorRuntime.mark(function i(t,r,n){var o,s=t.data.q;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.autocompleteRequest({field:a,value:s});case 3:o=t.sent,r({results:o}),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),n(t.t0);case 10:case"end":return t.stop()}},i,e,[[0,7]])}));return r}()}:null},o)),this.select2.on("select2:select",function(t){e.emitChangeEvent(t)}),"autocompletefield"===this.forminput.type&&this.select2.on("select2:unselecting",function(t){e.emitChangeEvent(t)})}},watch:{"forminput.value":function(){function e(e){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$nextTick();case 2:e===i.SEARCH_ALLVALUE&&(this.select2.val(e),this.select2.trigger("change"));case 3:case"end":return t.stop()}},n,this)}));return e}()},created:function(){this.allvalue=i.SEARCH_ALLVALUE},mounted:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this._initSelect2Element();case 3:case"end":return e.stop()}},n,this)}));return e}()}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("select",{directives:[{name:"disabled",rawName:"v-disabled",value:e.forminput.options.disabled||e.forminput.loading,expression:"forminput.options.disabled || forminput.loading"}],staticClass:"form-control",attrs:{name:e.forminput.attribute,id:e.forminput.id}},e._l(e.forminput.options.values,function(t){return r("option",{key:t.value,domProps:{value:t.value}},[t.value===e.allvalue?r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.search.all",expression:"'sdk.search.all'"}]}):r("span",[e._v(e._s(t.key))])])}),0)},n.staticRenderFns=[],n._scopeId="data-v-51aca907"},{"app/constant":4,"core/i18n/i18n.service":13,"core/utils/utils":68,"gui/external/select2/options/autocomplete":119,mixins:343}],294:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("store/application-state"),i=t(n),a=e("gui/sidebar/eventbus"),o=t(a),s=e("services/sidebar"),l=t(s),u=e("core/i18n/i18n.service"),c=u.t;r["default"]={name:"Sidebar",data:function(){return{components:l["default"].state.components,panels:l["default"].stack.state.contentsdata,bOpen:!0,bPageMode:!1,header:c("main navigation"),state:l["default"].state}},computed:{title:function(){return this.state.gui.title},disabled:function(){return i["default"].gui.sidebar.disabled},panelsinstack:function(){return this.panels.length>0},showmainpanel:function(){return this.components.length>0&&!this.panelsinstack},componentname:function(){return this.components.length?this.components.slice(-1)[0].getTitle():""},panelname:function(){var e="";return this.panels.length&&(e=this.panels.slice(-1)[0].content.getTitle()),e}},methods:{closePanel:function(){l["default"].closePanel()},closeAllPanels:function(){l["default"].closeAllPanels()}},created:function(){this.iframe=i["default"].iframe,o["default"].$on("sidebaritemclick",function(){return $(".sidebar-toggle").click()})}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("aside",{staticClass:"main-sidebar","class":{iframe:e.iframe,"g3w-disabled":e.disabled}},[r("a",{staticClass:"sidebar-aside-toggle",attrs:{href:"#","data-toggle":"offcanvas",role:"button"}},[r("i",{"class":e.g3wtemplate.getFontClass("bars")})]),e._v(" "),r("div",{staticClass:"sidebar",attrs:{id:"g3w-sidebar"}},[r("div",{attrs:{id:"disable-sidebar"}}),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.panelsinstack,expression:"panelsinstack"}],staticClass:"g3w-sidebarpanel"},[r("div",{staticStyle:{overflow:"hidden","line-height":"14px","font-size":"1.5em"},attrs:{id:"g3w-sidebarpanel-header-placeholder"}},[r("div",{staticStyle:{display:"flex"},style:{justifyContent:e.state.gui.title?"space-between":"flex-end"}},[e.title?r("h4",{directives:[{name:"t",rawName:"v-t",value:e.title,expression:"title"}],staticStyle:{display:"inline-block","font-weight":"bold"}}):e._e(),e._v(" "),r("div",[e.panels.length>1?r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"back",expression:"'back'",modifiers:{create:!0}}],staticClass:"skin-tooltip-left g3w-span-button close-pane-button fa-stack",attrs:{"data-placement":"left","data-toggle":"tooltip"},on:{click:e.closePanel}},[r("i",{staticClass:"fa-stack-1x panel-button","class":e.g3wtemplate.getFontClass("circle")}),e._v(" "),r("i",{staticClass:"fa-stack-1x panel-icon","class":e.g3wtemplate.getFontClass("arrow-left")})]):e._e(),e._v(" "),r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"close",expression:"'close'",modifiers:{create:!0}}],staticClass:"skin-tooltip-left g3w-span-button close-pane-button fa-stack",attrs:{"data-placement":"left","data-toggle":"tooltip"},on:{click:e.closeAllPanels}},[r("i",{staticClass:"fa-stack-1x panel-button","class":e.g3wtemplate.getFontClass("circle")}),e._v(" "),r("i",{staticClass:"fa-stack-1x panel-icon","class":e.g3wtemplate.getFontClass("close")})])])])]),e._v(" "),r("div",{staticClass:"g3w-sidebarpanel-placeholder",attrs:{id:"g3w-sidebarpanel-placeholder"}})]),e._v(" "),r("div",{
attrs:{id:"g3w-sidebarcomponents-content"}},[r("ul",{directives:[{name:"show",rawName:"v-show",value:e.showmainpanel,expression:"showmainpanel"}],staticClass:"sidebar-menu","class":{"g3w-disabled":e.state.disabled},attrs:{id:"g3w-sidebarcomponents"}})])])])},n.staticRenderFns=[],n._scopeId="data-v-6cec5235"},{"core/i18n/i18n.service":13,"gui/sidebar/eventbus":180,"services/sidebar":369,"store/application-state":373}],295:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("gui/sidebar/eventbus"),i=t(n),a=e("components/SidebarItemAction.vue"),o=t(a);r["default"]={name:"SidebarItem",data:function(){return{info:this.$options.info||{state:null,style:null,"class":null},main:!0,component:this.$options.component,active:!1,title:"",open:!1,icon:null,iconColor:null,collapsible:null}},components:{SidebarItemAction:o["default"]},methods:{onClickItem:function(e){var t=this;this.component.isolate&&e.stopPropagation(),this.component.isolate||(this.$options.service.state.components.forEach(function(e){e!==t.component&&e.getOpen()&&e.click({open:e.isolate})}),!this.component.collapsible&&isMobile.any&&i["default"].$emit("sidebaritemclick")),this.component.setOpen(!this.component.state.open)}},created:function(){var e=this;this.component.openClose=function(){return e.$refs.anchor_click.click()}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",{directives:[{name:"show",rawName:"v-show",value:e.state.visible,expression:"state.visible"},{name:"disabled",rawName:"v-disabled",value:e.state.disabled,expression:"state.disabled"}],staticClass:"treeview sidebaritem","class":{active:e.open},attrs:{id:e.component.id}},[r("bar-loader",{attrs:{loading:e.state.loading}}),e._v(" "),r("a",{ref:"anchor_click",staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"},attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.onClickItem(t)}}},[r("div",[r("i",{"class":e.icon,style:{color:e.iconColor}}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:e.title,expression:"title"}],staticClass:"treeview-label"})]),e._v(" "),r("div",[e.info.state?r("span",{"class":e.info["class"],staticStyle:{position:"absolute",right:"5px","font-weight":"bold"},style:e.info.style,attrs:{title:e.info.tooltip}},[e._v(e._s(e.info.state))]):e._e(),e._v(" "),e._l(e.actions,function(t){return r("sidebar-item-action",{key:t.id,attrs:{component:e.component.internalComponent,action:t}})})],2),e._v(" "),e.collapsible?r("i",{staticClass:"pull-right","class":e.g3wtemplate.getFontClass("angle-left")}):e._e()]),e._v(" "),r("div",{attrs:{id:"g3w-sidebarcomponent-placeholder"}})],1)},n.staticRenderFns=[],n._scopeId="data-v-0d8b5968"},{"components/SidebarItemAction.vue":296,"gui/sidebar/eventbus":180}],296:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"Sidebaritemaction",props:{action:{type:Object,required:!0},component:{type:Object}},methods:{triggerAction:function(){this.action.fnc(this.component)}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:e.action.tooltip,expression:"action.tooltip",arg:"left",modifiers:{create:!0}}],staticClass:"action skin-tooltip-left","class":e.action["class"],staticStyle:{"font-weight":"bold",padding:"3px"},style:e.action.style,on:{click:function(t){return t.stopPropagation(),e.triggerAction(t)}}})},n.staticRenderFns=[]},{}],297:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("components/SpatialBookMarkItem.vue"),a=t(i);r["default"]={name:"spatial-bookmark-group",props:{group:{type:Object,required:!0}},components:{SpatialBookMarkItem:a["default"]},methods:{},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},r,this)}));return e}()}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",[r("div",{staticStyle:{"font-weight":"bold",width:"100%"},style:{borderBottom:e.group.expanded?"2px solid #2c3b41":"none"},on:{click:function(t){t.stopPropagation(),e.group.expanded=!e.group.expanded}}},[r("span",{"class":[e.g3wtemplate.getFontClass(e.group.expanded?"caret-down":"caret-right")],staticStyle:{"margin-right":"5px"}}),e._v(" "),r("span",[e._v(e._s(e.group.name))])]),e._v(" "),r("ul",{directives:[{name:"show",rawName:"v-show",value:e.group.expanded,expression:"group.expanded"}],staticStyle:{"margin-left":"10px"}},e._l(e.group.nodes,function(e){return r("spatial-book-mark-item",{attrs:{bookmark:e}})}),1)])},n.staticRenderFns=[],n._scopeId="data-v-2c6b139c"},{"components/SpatialBookMarkItem.vue":298}],298:[function(e,t,r){e("vueify/lib/insert-css").insert(".spatial-bookmark[data-v-526a54f4]{display:flex;align-items:baseline;justify-content:space-between;padding:5px!important}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("services/gui"),a=t(i),o=e("g3w-ol/projection/projections");r["default"]={name:"spatial-bookmark-item",props:{bookmark:{type:Object,required:!0}},methods:{removeBookMark:function(){},gotoSpatialBookmark:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){var t,n=e.extent,i=e.crs;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a["default"].getService("map").getEpsg().split("EPSG:")[1]===i.epsg){e.next=5;break}return e.next=3,o.registerProjection("EPSG:"+i.epsg);case 3:t=e.sent,n=ol.proj.transformExtent(n,t,a["default"].getService("map").getProjection());case 5:a["default"].getService("map").zoomToExtent(n,{force:!0});case 6:case"end":return e.stop()}},r,this)}));return e}()},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},r,this)}));return e}()}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",{staticClass:"spatial-bookmark",on:{click:function(t){return t.stopPropagation(),e.gotoSpatialBookmark(e.bookmark)}}},[r("div",[r("span",{"class":e.g3wtemplate.getFontClass("bookmark"),staticStyle:{"margin-right":"5px","font-size":"0.7em"}}),e._v(" "),r("span",{staticClass:"g3w-long-text"},[e._v(e._s(e.bookmark.name))])]),e._v(" "),e.bookmark.removable?r("span",{staticStyle:{color:"red",margin:"5px",cursor:"pointer"},on:{click:function(t){return t.stopPropagation(),e.$emit("remove-bookmark",e.bookmark.id)}}},[r("i",{"class":e.g3wtemplate.getFontClass("trash")})]):e._e()])},n.staticRenderFns=[],n._scopeId="data-v-526a54f4"},{"g3w-ol/projection/projections":111,"services/gui":361,"vueify/lib/insert-css":1}],299:[function(e,t,r){e("vueify/lib/insert-css").insert(".content-bookmarks{font-weight:700;color:#fff;padding:5px;border-bottom:2px solid #fff;margin-bottom:5px}.container.add-bookmark-input p.error-input-message{color:#fff}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("app/constant"),a=e("services/gui"),o=t(a),s=e("services/application"),l=t(s),u=e("store/projects"),c=t(u),d=e("components/SpatialBookMarkGroup.vue"),f=t(d),p=e("components/SpatialBookMarkItem.vue"),h=t(p),v=e("components/InputText.vue"),g=t(v),m=e("core/utils/utils"),y=m.uniqueId,_=e("core/i18n/i18n.service"),b=_.t,w=l["default"].getLocalItem(i.LOCAL_ITEM_IDS.SPATIALBOOKMARKS.id);r["default"]={name:"spatial-bookmarks",components:{SpatialBookMarkGroup:f["default"],SpatialBookMarkItem:h["default"],InputText:g["default"]},data:function(){var e=c["default"].getCurrentProject();return"undefined"==typeof w[e.getId()]&&(w[e.getId()]=[]),{showaddform:!1,project:{bookmarks:e.getSpatialBookmarks()||[]},user:{bookmarks:w[e.getId()]},addbookmarkinput:{name:"add-bookmark",label:b("sdk.spatialbookmarks.input.name"),value:null,editable:!0,type:"varchar",input:{type:"text",options:{}},visible:!0,validate:{valid:!1,required:!0}}}},computed:{hasProjectbookmarks:function(){return this.project.bookmarks.length>0}},methods:{addBookMark:function(){this.user.bookmarks.push({id:y(),name:this.addbookmarkinput.value,extent:o["default"].getService("map").getMapExtent(),removable:!0,crs:{epsg:1*o["default"].getService("map").getCrs().split("EPSG:")[1]}}),this.saveUserBookMarks(),this.showaddform=!1},removeBookMark:function(e){this.user.bookmarks=this.user.bookmarks.filter(function(t){return t.id!==e}),this.saveUserBookMarks()},saveUserBookMarks:function(){w[c["default"].getCurrentProject().getId()]=this.user.bookmarks,l["default"].setLocalItem({id:i.LOCAL_ITEM_IDS.SPATIALBOOKMARKS.id,data:w})},showAddForm:function(){this.addbookmarkinput.value=null,this.showaddform=!0}},created:function(){var e=this;this.$on("close",function(){e.showaddform=!1})},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},r,this)}));return e}()}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ul",{staticClass:"treeview-menu g3w-spatial-bookmarks menu-items","class":{"g3w-tools":!e.showaddform},attrs:{id:"g3w-spatial-bookmarks"}},[e.showaddform?[r("li",[r("div",{staticStyle:{display:"flex","justify-content":"end"}},[r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"close",expression:"'close'",arg:"left",modifiers:{create:!0}}],staticClass:"sidebar-button sidebar-button-icon","class":e.g3wtemplate.getFontClass("close"),staticStyle:{padding:"5px",margin:"3px"},on:{click:function(t){t.stopPropagation(),e.showaddform=!1}}})]),e._v(" "),r("helpdiv",{attrs:{message:"sdk.spatialbookmarks.helptext"}}),e._v(" "),r("div",{staticClass:"container add-bookmark-input",staticStyle:{padding:"5px",width:"100%"}},[r("input-text",{attrs:{state:e.addbookmarkinput}})],1),e._v(" "),r("div",{staticStyle:{"margin-top":"5px"}},[r("button",{directives:[{name:"t",rawName:"v-t",value:"add",expression:"'add'"},{name:"disabled",rawName:"v-disabled",value:!e.addbookmarkinput.validate.valid,expression:"!addbookmarkinput.validate.valid"}],staticClass:"sidebar-button-run btn btn-block",on:{click:function(t){return t.stopPropagation(),e.addBookMark(t)}}})])],1)]:[e.hasProjectbookmarks?[r("div",{staticClass:"content-bookmarks"},[r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.spatialbookmarks.sections.project.title",expression:"'sdk.spatialbookmarks.sections.project.title'"}]})]),e._v(" "),e._l(e.project.bookmarks,function(e){return[e.nodes?r("spatial-book-mark-group",{attrs:{group:e}}):r("spatial-book-mark-item",{attrs:{bookmark:e}})]})]:e._e(),e._v(" "),r("div",{staticClass:"content-bookmarks",staticStyle:{display:"flex","justify-content":"space-between","align-items":"center","margin-top":"10px"}},[r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.spatialbookmarks.sections.user.title",expression:"'sdk.spatialbookmarks.sections.user.title'"}],staticStyle:{"font-weight":"bold",color:"#ffffff"}}),e._v(" "),r("span",{staticClass:"sidebar-button sidebar-button-icon","class":e.g3wtemplate.getFontClass("plus"),staticStyle:{padding:"5px",cursor:"pointer"},on:{click:function(t){return t.stopPropagation(),e.showAddForm(t)}}})]),e._v(" "),e._l(e.user.bookmarks,function(t){return r("spatial-book-mark-item",{attrs:{bookmark:t},on:{"remove-bookmark":e.removeBookMark}})})]],2)},n.staticRenderFns=[]},{"app/constant":4,"components/InputText.vue":249,"components/SpatialBookMarkGroup.vue":297,"components/SpatialBookMarkItem.vue":298,"core/i18n/i18n.service":13,"core/utils/utils":68,"services/application":351,"services/gui":361,"store/projects":379,"vueify/lib/insert-css":1}],300:[function(e,t,r){e("vueify/lib/insert-css").insert("#streetview-error-key[data-v-7ca68402]{display:flex;justify-content:center;align-items:center;font-weight:700;height:100%;padding:10px;background-color:#fff}");!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"streetview",data:function(){return{state:null}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"streetview"}},[e.$options.keyError?r("div",{attrs:{id:"streetview-error-key"}},[r("span",{staticClass:"skin-color"},[e._v(" "+e._s(e.$options.keyError))])]):e._e()])},n.staticRenderFns=[],n._scopeId="data-v-7ca68402"},{"vueify/lib/insert-css":1}],301:[function(e,t,r){e("vueify/lib/insert-css").insert(".geometry[data-v-4d12d432]{cursor:pointer}#noheaders[data-v-4d12d432]{background-color:#fff;font-weight:700;margin-top:10px}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=e("components/TableBody.vue"),o=t(a),s=e("components/TableSelectRow.vue"),l=t(s),u=e("components/TableToolbar.vue"),c=t(u),d=e("components/FieldG3W.vue"),f=t(d),p=e("services/gui"),h=t(p),v=e("mixins"),g=e("core/utils/utils"),m=g.debounce,y=void 0,_=[],b={pagination:{},nopagination:{}};r["default"]={name:"G3WTable",mixins:[v.resizeMixin],data:function(){return{tableBodyComponent:null,state:null,table:null,selectedRow:null}},components:{TableBody:o["default"]},methods:{getDataFromBBOX:function(){this.$options.service.getDataFromBBOX()},toggleFilterToken:function(){this.$options.service.toggleFilterToken()},clearAllSelection:function(){this.$options.service.clearLayerSelection()},switchSelection:function(){this.$options.service.switchSelection()},selectAllRow:function(){this.state.features.length&&this.$options.service.selectAllFeatures()},_setLayout:function(){this.$options.service._setLayout()},zoomAndHighLightFeature:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!e.geometry){r.next=4;break}this.$options.service.zoomAndHighLightFeature(e,t),r.next=6;break;case 4:return r.next=6,this.$options.service.zoomAndHighLightGeometryRelationFeatures(e,t);case 6:case"end":return r.stop()}},r,this)}));return e}(),addRemoveSelectedFeature:function(e){this.$options.service.addRemoveSelectedFeature(e)},reloadLayout:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:y&&y.columns.adjust();case 3:case"end":return e.stop()}},r,this)}));return e}(),hasHeaders:function(){return!!this.state.headers.length},createdContentBody:function(){var e=this;_=_.filter(function(e){return e.$destroy(),!1});var t=y.rows().nodes();t.each(function(t,r){if($(t).css("cursor","pointer"),e.state.features.length){var n=e.state.features[r],i=!!n.geometry;$(t).addClass("feature_attribute"),n.selected&&$(t).addClass("selected"),$(t).on("click",function(){return i&&e.zoomAndHighLightFeature(n)}),$(t).on("mouseover",function(){return i&&e.zoomAndHighLightFeature(n,!1)}),$(t).children().each(function(r,i){var a=e.state.headers[r],o=void 0;if(null===a){var s=Vue.extend(l["default"]),u=new s({propsData:{feature:n}});u.$on("selected",function(t){return e.$options.service.addRemoveSelectedFeature(t)}),e.$watch(function(){return n.selected},function(e){e?$(t).addClass("selected"):$(t).removeClass("selected")}),o=u.$mount().$el}else{var c=Vue.extend(f["default"]),d=new c({propsData:{state:{value:n.attributes[a.name]}}});d.$mount(),_.push(d),o=d.$el}$(i).html(o)})}}),setTimeout(function(){return e.reloadLayout()},0)},resize:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e,t;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.$nextTick();case 2:e=$(".content").height(),t=$("#open_attribute_table  div.dataTables_scrollHeadInner").height(),$("#open_attribute_table  div.dataTables_scrollBody").height(e-t-130);case 5:case"end":return r.stop()}},r,this)}));return e}()},beforeCreate:function(){this.delayType="debounce"},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e,t,a,o,s,l=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return this.setContentKey=h["default"].onafter("setContent",this.resize),e=function(){$(".dataTables_info, .dataTables_length").hide(),$(".dataTables_paginate").css({display:"flex","justify-content":"space-between","font-size":"0.8em","margin-top":"5px"}),$(".dataTables_filter").css("float","right"),$(".dataTables_paginate").css("margin","0")},r.next=4,this.$nextTick();case 4:this.first=!1,t={lengthMenu:this.state.pageLengths,pageLength:this.state.pageLength,scrollX:!0,processing:!1,scrollCollapse:!0,sSearch:!1,order:[1,"asc"],dom:'l<"#g3w-table-toolbar">frtip',columnDefs:[{targets:0,orderable:!1,searchable:!1,width:"1%"}]},this.state.pagination?(y=$(this.$refs.attribute_table).DataTable(i({},t,{columns:this.state.headers,ajax:m(function(t,r){var i=$("#open_attribute_table table tr");i.each(function(e){$(e).off("click"),$(e).off("mouseover")}),l.$options.service.getData(t).then(function(){var t=n(regeneratorRuntime.mark(function i(t){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r(t),n.next=3,l.$nextTick();case 3:l.createdContentBody(),l.isMobile()&&e();case 5:case"end":return n.stop()}},i,l)}));return function(e){return t.apply(this,arguments)}}())["catch"](function(e){})},800),serverSide:!0,deferLoading:this.state.allfeatures})),this.$options.service.on("ajax-reload",y.ajax.reload),this.changeColumn=m(function(){var e=n(regeneratorRuntime.mark(function t(e,r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:y.columns(r).search(e.target.value.trim()).draw();case 1:case"end":return t.stop()}},t,l)}));return function(t,r){return e.apply(this,arguments)}}())):(y=$(this.$refs.attribute_table).DataTable(i({},t,{searchDelay:600})),a=m(function(){l.$options.service.setFilteredFeature(y.rows({search:"applied"})[0])},600),b.nopagination["search.dt"]=a,y.on("search.dt",a),y.on("length.dt",function(e,t,r){l.$options.service.setAttributeTablePageLength(r)}),this.changeColumn=m(function(){var e=n(regeneratorRuntime.mark(function t(e,r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:y.columns(r).search(e.target.value.trim()).draw(),l.$options.service.setFilteredFeature(y.rows({search:"applied"})[0]);case 2:case"end":return t.stop()}},t,l)}));return function(t,r){return e.apply(this,arguments)}}())),this.isMobile()&&e(),o=Vue.extend(c["default"]),s=new o({propsData:{tools:this.state.tools,geolayer:this.state.geolayer,switchSelection:this.switchSelection,clearAllSelection:this.clearAllSelection,toggleFilterToken:this.toggleFilterToken,getDataFromBBOX:this.getDataFromBBOX}}),$("#g3w-table-toolbar").html(s.$mount().$el),this.$options.service.on("redraw",function(t){y.clear(),y.draw(!1),setTimeout(function(){y.rows.add(t),y.draw(!1),l.createdContentBody(),l.isMobile()&&e()})});case 12:case"end":return r.stop()}},r,this)}));return e}(),beforeDestroy:function(){this.$options.service.clear(),this.$options.service.off("ajax-reload"),this.$options.service.off("redraw"),h["default"].un("setContent",this.setContentKey),y.destroy(!0),y=null}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{"margin-top":"5px"},attrs:{id:"open_attribute_table"}},[e.hasHeaders()?r("table",{ref:"attribute_table",staticClass:"table table-striped row-border compact nowrap",staticStyle:{width:"100%"},attrs:{id:"layer_attribute_table"}},[r("thead",[r("tr",[r("th"),e._v(" "),e._l(e.state.headers,function(t,n){return n>0?r("th",[r("input",{staticClass:"form-control column-search",staticStyle:{height:"25px","min-width":"40px",padding:"2px"},attrs:{type:"text",placeholder:t.name},on:{keyup:function(t){return e.changeColumn(t,n)}}})]):e._e()})],2),e._v(" "),r("tr",e._l(e.state.headers,function(t,n){return r("th",[0===n?r("span",[r("input",{staticClass:"magic-checkbox",attrs:{type:"checkbox",id:"attribute_table_select_all_rows",disabled:e.state.nofilteredrow||0===e.state.features.length},domProps:{checked:e.state.selectAll}}),e._v(" "),r("label",{staticStyle:{"margin-bottom":"0 !important"},attrs:{"for":"attribute_table_select_all_rows"},on:{"!click":function(t){return t.stopPropagation(),t.preventDefault(),e.selectAllRow(t)}}},[r("span",{staticStyle:{padding:"5px"}})])]):r("span",[e._v(e._s(t.label))])])}),0)]),e._v(" "),r("table-body",{attrs:{headers:e.state.headers,filter:e.state.tools.filter,features:e.state.features,addRemoveSelectedFeature:e.addRemoveSelectedFeature,zoomAndHighLightFeature:e.zoomAndHighLightFeature}})],1):r("div",{directives:[{name:"t",rawName:"v-t",value:"dataTable.no_data",expression:"'dataTable.no_data'"}],attrs:{id:"noheaders"}})])},n.staticRenderFns=[],n._scopeId="data-v-4d12d432"},{"components/FieldG3W.vue":206,"components/TableBody.vue":302,"components/TableSelectRow.vue":303,"components/TableToolbar.vue":304,"core/utils/utils":68,mixins:343,"services/gui":361,"vueify/lib/insert-css":1}],302:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("components/TableSelectRow.vue"),i=t(n),a=e("components/FieldG3W.vue"),o=t(a);r["default"]={name:"table-body",props:{headers:{required:!0,type:Array},features:{required:!0,type:Array},zoomAndHighLightFeature:{type:Function},addRemoveSelectedFeature:{type:Function},filter:{type:Object,"default":{active:!1}}},data:function(){return{selectedRow:null}},components:{Field:o["default"],SelectRow:i["default"]},methods:{getField:function(e,t){return{value:e.attributes[t.name],label:void 0}}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("tbody",{attrs:{id:"table_body_attributes"}},e._l(e.features,function(t,n){return r("tr",{key:t.id,staticClass:"feature_attribute","class":[n%2==1?"odd":"pair",{geometry:!!t.geometry},{selected:t.selected}],staticStyle:{cursor:"pointer"},attrs:{role:"row",selected:e.selectedRow===n},on:{mouseover:function(r){return e.zoomAndHighLightFeature(t,!1)},click:function(r){return e.zoomAndHighLightFeature(t,!0)}}},e._l(e.headers,function(n,i){return r("td",{attrs:{"tab-index":1}},[0===i?r("select-row",{attrs:{feature:t},on:{selected:e.addRemoveSelectedFeature}}):r("field",{attrs:{feature:t,state:e.getField(t,n)}})],1)}),0)}),0)},n.staticRenderFns=[],n._scopeId="data-v-035559ae"},{"components/FieldG3W.vue":206,"components/TableSelectRow.vue":303}],303:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("core/utils/utils"),n=t.getUniqueDomId;r["default"]={name:"select-row",props:{feature:{required:!0}},data:function(){return{id:n()}},methods:{select:function(){this.$emit("selected",this.feature)}},destroyed:function(){this.$off("selected")}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("span",[r("input",{staticClass:"magic-checkbox",attrs:{type:"checkbox",id:e.id},domProps:{checked:e.feature.selected}}),e._v(" "),r("label",{attrs:{"for":e.id},on:{"!click":function(t){return t.stopPropagation(),t.preventDefault(),e.select(t)}}},[r("span")])])},n.staticRenderFns=[],n._scopeId="data-v-70cb9447"},{"core/utils/utils":68}],304:[function(e,t,r){e("vueify/lib/insert-css").insert(".action-button[data-v-369b4644]{padding:4px}.action-button.toggled[data-v-369b4644]{border:1px solid #ccc}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("store/application-state"),i=t(n);r["default"]={name:"g3w-table-toolbar",props:{tools:{type:Object},switchSelection:{type:Function},clearAllSelection:{type:Function},toggleFilterToken:{type:Function},getDataFromBBOX:{type:Function}},computed:{disableMapTool:function(){return!this.tools.geolayer.active&&i["default"].gui.layout[i["default"].gui.layout.__current].rightpanel.height_100}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{display:"flex","justify-content":"space-between",padding:"1px"}},[e.tools.geolayer.show?r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.disableMapTool,expression:"disableMapTool"},{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"layer_selection_filter.tools.show_features_on_map",expression:"'layer_selection_filter.tools.show_features_on_map'",modifiers:{create:!0}}],staticClass:"skin-color action-button skin-tooltip-right","class":[e.g3wtemplate.getFontClass("map"),e.tools.geolayer.active?"toggled":""],attrs:{"data-placement":"right","data-toggle":"tooltip"},on:{click:function(t){return t.stopPropagation(),e.getDataFromBBOX(t)}}}):e._e(),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.tools.show,expression:"tools.show"},{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"layer_selection_filter.tools.clear",expression:"'layer_selection_filter.tools.clear'",modifiers:{create:!0}}],staticClass:"skin-color action-button skin-tooltip-right","class":e.g3wtemplate.getFontClass("clear"),attrs:{"data-placement":"right","data-toggle":"tooltip"},on:{click:function(t){return t.stopPropagation(),e.clearAllSelection(t)}}}),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.tools.show,expression:"tools.show"},{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"layer_selection_filter.tools.invert",expression:"'layer_selection_filter.tools.invert'",modifiers:{create:!0}}],staticClass:"skin-color action-button skin-tooltip-right","class":[e.g3wtemplate.getFontClass("invert"),e.tools.filter.active?"g3w-disabled":""],attrs:{"data-placement":"right","data-toggle":"tooltip"},on:{click:function(t){return t.stopPropagation(),e.switchSelection(t)}}}),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.tools.show,expression:"tools.show"},{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"layer_selection_filter.tools.filter",expression:"'layer_selection_filter.tools.filter'",modifiers:{create:!0}}],staticClass:"skin-color action-button skin-tooltip-right","class":[e.g3wtemplate.getFontClass("filter"),e.tools.filter.active?"toggled":""],attrs:{"data-placement":"right","data-toggle":"tooltip"},on:{click:function(t){return t.stopPropagation(),e.toggleFilterToken(t)}}})])},n.staticRenderFns=[],n._scopeId="data-v-369b4644"},{"store/application-state":373,"vueify/lib/insert-css":1}],305:[function(e,t,r){e("vueify/lib/insert-css").insert(".tool_disabled[data-v-1da404e2]{cursor:not-allowed}.tool_disabled>span[data-v-1da404e2]{color:#777}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("services/application"),i=t(n),a=e("services/gui"),o=t(a),s=i["default"].getState(),l={alert:{color:"red"},info:{color:"blue"},warning:{color:"orange"}};r["default"]={name:"g3w-tool",props:{tool:{required:!0}},data:function(){return{}},methods:{fireAction:function(e){this.tool.action(e)},showToolStateMessage:function(){o["default"].showModalDialog({title:this.tool.state.type.toUpperCase(),message:this.tool.state.message})}},computed:{disabled:function(){return!this.tool.offline&&!s.online||this.tool.loading||this.tool.disabled},icon:function(){return this.tool.icon||"caret-right"},toolstatecolor:function(){return l[this.tool.state.type].color}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",["checkbox"===e.tool.type?r("div",{staticClass:"checkbox"},[r("label",[r("input",{directives:[{name:"model",rawName:"v-model",value:e.tool.isCheck,expression:"tool.isCheck"}],staticStyle:{cursor:"pointer"},attrs:{id:e.tool.layerName,type:"checkbox"},domProps:{value:e.tool.layerName,checked:Array.isArray(e.tool.isCheck)?e._i(e.tool.isCheck,e.tool.layerName)>-1:e.tool.isCheck},on:{click:function(t){return e.fireAction(e.tool)},change:function(t){var r=e.tool.isCheck,n=t.target,i=!!n.checked;if(Array.isArray(r)){var a=e.tool.layerName,o=e._i(r,a);n.checked?o<0&&e.$set(e.tool,"isCheck",r.concat([a])):o>-1&&e.$set(e.tool,"isCheck",r.slice(0,o).concat(r.slice(o+1)))}else e.$set(e.tool,"isCheck",i)}}}),e._v("\n      "+e._s(e.tool.name)+"\n    ")])]):r("div",{staticClass:"tool","class":{tool_disabled:e.disabled},staticStyle:{position:"relative"},on:{click:function(t){e.disabled?null:e.fireAction(e.tool)}}},[r("bar-loader",{attrs:{loading:e.tool.loading}}),e._v(" "),r("i",{"class":e.g3wtemplate.getFontClass(e.icon)}),e._v(" "),e.tool.html?r("span",[r("i",{"class":e.tool.html.icon}),e._v("\n      "+e._s(e.tool.html.text||e.tool.name)+"\n    ")]):r("span",{directives:[{name:"t",rawName:"v-t",value:e.tool.name,expression:"tool.name"}]}),e._v(" "),e.tool.state.type?r("span",{staticStyle:{cursor:"pointer","vertical-align":"center",position:"absolute",right:"0",top:"0",padding:"5px"},style:{color:e.toolstatecolor},on:{click:function(t){
return t.stopPropagation(),e.showToolStateMessage(t)}}},[r("i",{"class":e.g3wtemplate.getFontClass(e.tool.state.type)})]):e._e()],1)])},n.staticRenderFns=[],n._scopeId="data-v-1da404e2"},{"services/application":351,"services/gui":361,"vueify/lib/insert-css":1}],306:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("components/Tool.vue"),i=t(n);r["default"]={name:"g3w-tools",data:function(){return{state:null}},watch:{"state.toolsGroups":{handler:function(e){this.$emit("visible",e.length>0)}}},components:{G3wTool:i["default"]}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ul",{staticClass:"g3w-tools treeview-menu"},[r("bar-loader",{attrs:{loading:e.state.loading}}),e._v(" "),e._l(e.state.toolsGroups,function(t){return r("li",{key:t.name},[r("div",{staticClass:"tool-header"},[r("i",{"class":e.g3wtemplate.getFontClass("tool")}),e._v(" "),r("span",{},[e._v(e._s(t.name))])]),e._v(" "),r("div",{staticClass:"tool-box",attrs:{id:t.name+"-tools"}},e._l(t.tools,function(e){return r("g3w-tool",{key:e.name,attrs:{tool:e}})}),1)])})],2)},n.staticRenderFns=[]},{"components/Tool.vue":305}],307:[function(e,t,r){e("vueify/lib/insert-css").insert(".usermessage-content[data-v-35eff015]{color:#fff;z-index:1000;position:absolute;line-height:normal;padding:3px;min-width:250px;box-shadow:0 3px 5px rgba(0,0,0,.3);-moz-box-shadow:0 3px 5px rgba(0,0,0,.3)}.usermessage-content.mobile[data-v-35eff015]{padding:0;min-width:100%}.usermessage-header-content[data-v-35eff015]{display:flex;align-items:baseline;justify-content:space-between;width:100%}.usermessage-header-icontype[data-v-35eff015]{padding:10px 0 0 5px;font-weight:700;font-size:1.3em}.usermessage-content.mobile .usermessage-header-icontype[data-v-35eff015]{padding:0 0 0 5px;font-size:1.1em}.usermessage-header-title[data-v-35eff015],.usermessage-header-title h4[data-v-35eff015]{font-weight:700;text-align:center}.usermessage-content.mobile .usermessage-header-title h4[data-v-35eff015]{margin:0}.usermessage-header-subtitle[data-v-35eff015]{font-weight:700;margin:5px}.usermessage-header-right[data-v-35eff015]{padding:5px}.usermessage-header-right-item[data-v-35eff015]{font-weight:700!important;font-size:1.2em;cursor:pointer}.usermessage-message[data-v-35eff015]{width:100%;padding:0 0 3px 10px;max-height:100px;font-size:1.1em;align-self:flex-start;overflow-y:auto}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(r,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=e("app/constant"),l=e("services/gui"),u=t(l),c={success:{backgroundColor:"#62ac62",color:"#FFFFFF"},info:{backgroundColor:"#44a0bb",color:"#FFFFFF"},warning:{backgroundColor:"#f29e1d",color:"#FFFFFF"},alert:{backgroundColor:"#c34943",color:"#FFFFFF"},tool:{backgroundColor:"#FFFFFF",color:"#222d32"},loading:{backgroundColor:"#FFFFFF",color:"#222d32",fontWeight:"bold"}},d={success:{},info:{},warning:{},alert:{},tool:{"z-index":s.ZINDEXES.usermessage.tool,left:"40px"},loading:{}};r["default"]={name:"usermessage",props:{id:{},type:{type:String,"default":"info"},title:{type:String,"default":null},subtitle:{type:String,"default":null},position:{type:String,"default":"top"},size:{type:String,"default":"fullpage"},message:{type:String,"default":""},textMessage:{type:Boolean,"default":!1},autoclose:{type:Boolean,"default":!1},draggable:{type:Boolean,"default":!1},duration:{type:Number,"default":2e3},closable:{type:Boolean,"default":!0}},computed:{showheader:function(){return"loading"!==this.type}},methods:{addClassMobile:function(){return this.isMobile()&&!u["default"].isSidebarVisible()},closeUserMessage:function(){this.$emit("close-usermessage")},hideShow:function(){}},created:function(){var e=this.position.split("-"),t=o(e,2),r=t[0],n=t[1],s="100%";switch(this.size){case"small":s="25%";break;case"medium":s="50%";break;case"fullpage":default:s="100%"}r="center"===r?{top:0,bottom:0,maxHeight:"20%"}:i({},r,50);var l=a({},r,{width:s});if(n)switch(l.width="25%",n){case"center":l.left="0",l.right="0",l.margin="auto";break;case"right":l.right=0}this.style=a({},c[this.type],l,d[this.type])},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e,t=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!this.autoclose){r.next=4;break}return r.next=3,this.$nextTick();case 3:e=setTimeout(function(){t.closeUserMessage(),clearTimeout(e)},this.duration);case 4:case"end":return r.stop()}},r,this)}));return e}()}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"usermessage-content","class":{mobile:e.addClassMobile()},style:e.style,attrs:{id:e.id}},[e.showheader?r("div",{staticClass:"usermessage-header-content"},[r("i",{staticClass:"usermessage-header-icontype","class":e.g3wtemplate.getFontClass(e.type)}),e._v(" "),r("div",{staticClass:"usermessage-header-title"},[e._t("header",[e.title?r("h4",{directives:[{name:"t",rawName:"v-t",value:e.title,expression:"title"}]}):r("h4",[e._v(" "+e._s(e.type.toUpperCase()))]),e._v(" "),e.subtitle?r("h5",{directives:[{name:"t",rawName:"v-t",value:e.subtitle,expression:"subtitle"}],staticClass:"usermessage-header-subtitle"}):e._e()])],2),e._v(" "),r("div",{staticClass:"usermessage-header-right"},[!e.autoclose&&e.closable?r("div",{on:{click:e.closeUserMessage}},[r("i",{staticClass:"usermessage-header-right-item","class":e.g3wtemplate.getFontClass("close")})]):e._e()])]):e._e(),e._v(" "),e._t("body",[e.textMessage?r("div",{staticClass:"usermessage-message"},[e._v(e._s(e.message))]):r("div",{directives:[{name:"t",rawName:"v-t",value:e.message,expression:"message"}],staticClass:"usermessage-message"})]),e._v(" "),e._t("footer")],2)},n.staticRenderFns=[],n._scopeId="data-v-35eff015"},{"app/constant":4,"services/gui":361,"vueify/lib/insert-css":1}],308:[function(e,t,r){e("vueify/lib/insert-css").insert(".content_breadcrumb[data-v-3f6d8e1d]{font-size:1.2em;padding:0 3px;border-radius:3px}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(r,"__esModule",{value:!0});var a=e("components/UserMessage.vue"),o=t(a),s=e("components/NotifyOnline.vue"),l=t(s),u=e("components/NotifyDownload.vue"),c=t(u),d=e("components/NotifyPlugins.vue"),f=t(d),p=e("app/constant"),h=e("services/viewport"),v=t(h),g=e("services/gui"),m=t(g);r["default"]={name:"Viewport",props:{appState:{type:Object}},components:{userMessage:o["default"],onlineNotify:l["default"],downloadNotify:c["default"],pluginsNotify:f["default"]},data:function(){return{state:v["default"].state,updatePreviousTitle:!1,media:{matches:!0}}},computed:{breadcrumb:function(){return this.state.content.contentsdata.filter(function(e){return e.options.crumb}).map(function(e){return e.options.crumb})},showresize:function(){var e=v["default"].getCurrentContentLayout()["h"===this.state.split?"width":"height"];return this.state.resized.start&&this.state.secondaryPerc>0&&this.state.secondaryPerc<100&&e<100&&e>0},showresizeicon:function(){return 100!==this.state.secondaryPerc},hooks:function(){return this.usermessage.hooks},usermessage:function(){return this.state.usermessage},showtitle:function y(){var y=!0,e=this.state.content.contentsdata;if(e.length){var t=e[e.length-1].options;_.isBoolean(t.showtitle)&&(y=t.showtitle)}return y},showContent:function(){return this.state.content.show},styles:function(){return{map:{width:this.state.map.sizes.width+"px",height:this.state.map.sizes.height+"px"},content:{width:this.state.content.sizes.width+"px",height:this.state.content.sizes.height+"px",zIndex:p.ZINDEXES.usermessage.tool+1,minHeight:"v"===this.state.split?p.VIEWPORT.resize.content.min+"px":null}}},contentTitle:function(){var e=this.state.content.contentsdata;if(e.length){var t=e[e.length-1].options,r=t.title,n=t.post_title;return{title:r,post_title:n}}},backOrBackTo:function(){var e=this.state.content.contentsdata;return!!(e.length>1&&this.state.content.showgoback)&&(e[e.length-2].options.title?"backto":"back")},previousTitle:function(){var e=this,t=this.state.content.contentsdata,r=t.length>1&&this.state.content.showgoback?t[t.length-2].options.title:null;return this.updatePreviousTitle=!0,this.$nextTick(function(){return e.updatePreviousTitle=!1}),r}},methods:{isNotLastCrumb:function(e){return e<this.breadcrumb.length-1},closeContent:function(){m["default"].closeContent()},closeMap:function(){v["default"].closeMap()},gotoPreviousContent:function(){m["default"].popContent()},closeUserMessage:function(){m["default"].closeUserMessage()},moveFnc:function(e){var t="h"===this.state.split?"width":"height";e.preventDefault();var r="width"===t?$(".sidebar-collapse").length?0:v["default"].SIDEBARWIDTH:$("#main-navbar").height(),n=$(this.$el)[t](),a=("width"===t?e.pageX+2:e.pageY+2)-r;a>n-p.VIEWPORT.resize.content.min?a=n-p.VIEWPORT.resize.content.min:a<p.VIEWPORT.resize.map.min&&(a=p.VIEWPORT.resize.map.min);var o=n-a,s=Math.round(a/n*100),l=100-s;v["default"].resizeViewComponents(this.state.split,{map:i({},t,a),content:i({},t,o)},l)}},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e,t,n=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=function(){n.state.resized.start=!0},r.next=3,this.$nextTick();case 3:t=window.matchMedia("(min-height: 300px)"),this.media.matches=t.matches,t.addListener(function(e){"change"===e.type&&(n.media.matches=e.currentTarget.matches)}),e();case 7:case"end":return r.stop()}},r,this)}));return e}()}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"g3w-viewport"},[r("transition",{attrs:{name:"fade",duration:{enter:500,leave:500}}},[e.usermessage.show?r("user-message",{attrs:{title:e.usermessage.title,subtitle:e.usermessage.subtitle,id:e.usermessage.id,message:e.usermessage.message,draggable:e.usermessage.draggable,closable:e.usermessage.closable,duration:e.usermessage.duration,position:e.usermessage.position,autoclose:e.usermessage.autoclose,textMessage:e.usermessage.textMessage,size:e.usermessage.size,type:e.usermessage.type},on:{"close-usermessage":e.closeUserMessage}},[e.hooks.header?r("template",{slot:"header"},[r(e.hooks.header,{tag:"component"})],1):e._e(),e._v(" "),e.hooks.body?r("template",{slot:"body"},[r(e.hooks.body,{tag:"component"})],1):e._e(),e._v(" "),e.hooks.footer?r("template",{slot:"footer"},[r(e.usermessage.hooks.footer,{tag:"component"})],1):e._e()],2):e._e()],1),e._v(" "),r("div",{staticClass:"g3w-view map","class":"split-"+e.state.split,style:e.styles.map,attrs:{id:"g3w-view-map"}},[r("g3w-resize",{"class":"split-"+e.state.split,style:{backgroundColor:"transparent"},attrs:{id:"resize-map-and-content",show:e.showresize,moveFnc:e.moveFnc,orientation:e.state.split}}),e._v(" "),r("div",{attrs:{id:"application-notifications"}},[r("online-notify"),e._v(" "),r("download-notify"),e._v(" "),r("plugins-notify")],1)],1),e._v(" "),r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.state.content.disabled,expression:"state.content.disabled"}],staticClass:"g3w-view content","class":"split-"+e.state.split,style:e.styles.content,attrs:{id:"g3w-view-content"}},[e.breadcrumb.length>1?r("section",{ref:e.breadcrumb,staticClass:"content_breadcrumb"},e._l(e.breadcrumb,function(t,n){return r("span",{key:t.title},[r("span",{directives:[{name:"t",rawName:"v-t",value:t.title,expression:"crumb.title"}],staticClass:"skin-color-dark",style:{fontWeight:e.isNotLastCrumb(n)?"bold":"normal"}}),e._v(" "),e.isNotLastCrumb(n)?r("span",{staticStyle:{"font-weight":"bold",margin:"3px 0"}},[e._v("/")]):e._e()])}),0):e._e(),e._v(" "),e.showtitle&&e.contentTitle||e.previousTitle||e.state.content.closable&&e.state.content.aside?r("div",{staticClass:"close-panel-block",staticStyle:{display:"flex","justify-content":"space-between"}},[e.previousTitle?r("div",{staticClass:"g3w_contents_back g3w-long-text"},["back"===e.backOrBackTo?r("div",{"class":e.backOrBackTo},[r("span",{staticClass:"action-button","class":e.g3wtemplate.getFontClass("back")}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"back",expression:"'back'"}]})]):r("div",{"class":e.backOrBackTo,on:{click:function(t){return t.stopPropagation(),e.gotoPreviousContent()}}},[r("span",{staticClass:"action-button","class":e.g3wtemplate.getFontClass("back")}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"backto",expression:"'backto'"}]}),e._v(" "),e.updatePreviousTitle?e._e():r("span",{directives:[{name:"t",rawName:"v-t",value:e.previousTitle,expression:"previousTitle"}]})])]):e._e(),e._v(" "),!e.previousTitle&&e.showtitle&&e.contentTitle?r("div",{staticClass:"panel-title","class":{mobile:e.isMobile()},style:[e.state.content.style.title]},[r("span",{attrs:{id:"contenttitle"}},[r("span",{directives:[{name:"t",rawName:"v-t",value:e.contentTitle.title,expression:"contentTitle.title"}]}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:e.contentTitle.post_title,expression:"contentTitle.post_title"}]})])]):e._e(),e._v(" "),r("div",{staticClass:"g3-content-header-action-tools",staticStyle:{display:"flex"}},[e._l(e.state.content.headertools,function(e){return r(e,{tag:"component"})}),e._v(" "),e.showresizeicon?r("resize-icon",{staticStyle:{"font-size":"1em",padding:"0","align-self":"center","margin-left":"auto"},style:{marginRight:e.state.content.closable?"5px":"0px"},attrs:{type:e.state.split}}):e._e(),e._v(" "),e.state.content.closable&&e.state.content.aside?r("span",{staticClass:"action-button","class":{mobile:e.isMobile()},staticStyle:{display:"flex","justify-content":"center"},on:{click:e.closeContent}},[r("i",{staticClass:"skin-color-dark","class":e.g3wtemplate.getFontClass("close")})]):e._e()],2)]):e._e(),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.state.content.loading,expression:"state.content.loading"}],staticClass:"bar-loader"})])],1)},n.staticRenderFns=[],n._scopeId="data-v-3f6d8e1d"},{"app/constant":4,"components/NotifyDownload.vue":268,"components/NotifyOnline.vue":269,"components/NotifyPlugins.vue":270,"components/UserMessage.vue":307,"services/gui":361,"services/viewport":371,"vueify/lib/insert-css":1}],309:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"viewport-contents-viewer",data:function(){return{state:null}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"contents",attrs:{id:"contents"}})},n.staticRenderFns=[]},{}],310:[function(e,t,r){e("vueify/lib/insert-css").insert(".g3w-add-wms-url-message[data-v-221e2194]{font-weight:700;color:#000}.g3w-wmsurl-error[data-v-221e2194]{background-color:red}.g3w-wmsurl-already-added[data-v-221e2194]{background-color:orange}.wms_url_input_content[data-v-221e2194]{margin-bottom:5px}.wms-icon-action[data-v-221e2194]{font-weight:700;font-size:1.3em;box-shadow:0 5px 10px #1e282c}.wms-icon-action[data-v-221e2194]:hover{box-shadow:none}");!function(){function t(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("core/utils/utils"),i=n.isURL;r["default"]={name:"wms",data:function(){return{url:null,id:null,loading:!1,status:{error:!1,added:!1}}},computed:{inputswmsurlvalid:function(){return null!==this.url&&this.url.trim()&&i(this.url)&&null!==this.id&&this.id.trim()}},methods:{addwmsurl:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(){var e,t,r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.loading=!0,n.next=3,this.$options.service.addNewUrl({url:this.url,id:this.id});case 3:e=n.sent,t=e.error,r=e.added,this.status.error=t,this.status.added=r,this.loading=!1;case 9:case"end":return n.stop()}},n,this)}));return e}(),deleteWmsUrl:function(e){this.$options.service.deleteWmsUrl(e)},showWmsLayersPanel:function(){function e(e){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(e){var t,r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,this.loading=!0,n.next=4,this.$options.service.loadWMSDataAndShowWmsLayersPanel(e);case 4:t=n.sent,r=t.error,i=t.added,this.status.error=r,this.status.added=i,this.loading=!1,n.next=15;break;case 12:n.prev=12,n.t0=n["catch"](0);case 15:case"end":return n.stop()}},n,this,[[0,12]])}));return e}()}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ul",{staticClass:"treeview-menu g3w-tools menu-items"},[e.loading?r("li",[r("bar-loader",{attrs:{loading:e.loading}})],1):e._e(),e._v(" "),r("li",{staticStyle:{display:"flex","flex-direction":"column","justify-content":"space-between",background:"transparent !important","margin-bottom":"10px"}},[r("div",{staticClass:"wms_url_input_content"},[r("label",{directives:[{name:"t",rawName:"v-t",value:"sidebar.wms.panel.label.name",expression:"'sidebar.wms.panel.label.name'"}],attrs:{"for":"add_custom_name_url_wms_input"}}),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.id,expression:"id"}],staticClass:"form-control",staticStyle:{width:"100%",color:"#000000"},attrs:{id:"add_custom_name_url_wms_input"},domProps:{value:e.id},on:{input:function(t){t.target.composing||(e.id=t.target.value)}}})]),e._v(" "),r("div",{staticClass:"wms_url_input_content"},[r("label",{attrs:{"for":"add_custom_url_wms_input"}},[e._v("URL")]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.url,expression:"url"}],staticClass:"form-control",staticStyle:{width:"100%",color:"#000000"},attrs:{id:"add_custom_url_wms_input"},domProps:{value:e.url},on:{input:function(t){t.target.composing||(e.url=t.target.value)}}})]),e._v(" "),r("div",[r("button",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.inputswmsurlvalid,expression:"!inputswmsurlvalid"}],staticClass:"btn btn-block skin-background-color",staticStyle:{width:"100%"},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.addwmsurl(t)}}},[r("i",{"class":e.g3wtemplate.getFontClass("plus-square")})])])]),e._v(" "),e.status.error?r("li",[r("div",{directives:[{name:"t",rawName:"v-t",value:"server_error",expression:"'server_error'"}],staticClass:"g3w-add-wms-url-message g3w-wmsurl-error"})]):e.status.added?r("li",[r("div",{directives:[{name:"t",rawName:"v-t",value:"sidebar.wms.url_already_added",expression:"'sidebar.wms.url_already_added'"}],staticClass:"g3w-add-wms-url-message g3w-wmsurl-already-added"})]):e._e(),e._v(" "),r("li",{staticClass:"skin-border-color",staticStyle:{background:"transparent !important","border-top":"2px solid"}},[r("div",{staticStyle:{"max-height":"200px","overflow-y":"auto"}},[e._l(e.state.adminwmsurls,function(t){var n=t.id;t.url;return r("div",{key:e.wmsurl,staticStyle:{display:"flex","justify-content":"space-between","align-items":"center","border-bottom":"1px solid #cccccc","padding-bottom":"3px"}},[r("span",{staticClass:"g3w-long-text",staticStyle:{"flex-grow":"1","margin-right":"15px"}},[e._v(e._s(n))]),e._v(" "),r("span",{staticClass:"skin-color",staticStyle:{padding:"5px"},on:{click:function(t){return t.stopPropagation(),e.showWmsLayersPanel(n)}}},[r("i",{"class":e.g3wtemplate.getFontClass("plus-square"),staticStyle:{"font-weight":"bold","font-size":"1.3em"}})])])}),e._v(" "),e._l(e.state.localwmsurls,function(t){var n=t.id,i=t.url;return r("div",{key:n,staticStyle:{"border-bottom":"1px solid #cccccc","padding-bottom":"3px"}},[r("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center","padding-top":"3px"}},[r("span",{staticClass:"g3w-long-text",staticStyle:{"flex-grow":"1","margin-right":"15px","font-weight":"bold"}},[e._v(e._s(n))]),e._v(" "),r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top.create",value:"sidebar.wms.add_wms_layer",expression:"'sidebar.wms.add_wms_layer'",arg:"top",modifiers:{create:!0}}],staticClass:"skin-color",staticStyle:{padding:"3px",margin:"2px"},on:{click:function(t){return t.stopPropagation(),e.showWmsLayersPanel(i)}}},[r("i",{staticClass:"wms-icon-action","class":e.g3wtemplate.getFontClass("plus-square")})]),e._v(" "),r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top.create",value:"sidebar.wms.delete_wms_url",expression:"'sidebar.wms.delete_wms_url'",arg:"top",modifiers:{create:!0}}],staticStyle:{color:"red",padding:"3px",margin:"2px"},on:{click:function(t){return t.stopPropagation(),e.deleteWmsUrl(n)}}},[r("i",{staticClass:"wms-icon-action","class":e.g3wtemplate.getFontClass("trash"),staticStyle:{color:"red"}})])]),e._v(" "),r("div",{staticClass:"g3w-long-text",staticStyle:{"font-size":"0.7em"},attrs:{title:i}},[e._v(e._s(i))])])})],2)])])},n.staticRenderFns=[],n._scopeId="data-v-221e2194"},{"core/utils/utils":68,"vueify/lib/insert-css":1}],311:[function(e,t,r){e("vueify/lib/insert-css").insert(".g3w-wms-panel-title[data-v-8f518808]{font-size:1.2em;font-weight:700;margin-bottom:10px}button.wms-add-layer-button[data-v-8f518808]{width:100%;margin-top:10px}.g3w-wms-external-panel-layer-added-message[data-v-8f518808]{font-weight:700;color:red;margin:5px 0}");!function(){function t(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("g3w-ol/projection/projections");r["default"]={name:"wmpspanel",data:function(){return{loading:!1,position:void 0,name:void 0,title:null,"abstract":null,map_formats:[],info_formats:[],layers:[],selectedlayers:[],projections:[],epsg:null,added:!1}},methods:{addWMSlayer:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e={url:this.url,name:this.name&&this.name.trim()||void 0,layers:this.selectedlayers,epsg:this.epsg,position:this.position},this.added=this.$options.service.checkIfWMSAlreadyAdded(e),!this.added){t.next=5;break}return t.abrupt("return");case 5:return t.prev=5,this.loading=!0,t.next=9,this.$options.service.addWMSlayer(e);case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](5);case 14:return t.prev=14,this.loading=!1,t.finish(14);case 17:this.clear();case 18:case"end":return t.stop()}},n,this,[[5,11,14,17]])}));return e}(),clear:function(){this.selectedlayers=[],this.name=null},getLayersByEpsg:function(e){var t=this;return null===e?this.$options.config.layers:this.layers.filter(function(r){var n=r.name;return t.layerProjections[n].crss.indexOf(e)!==-1})},getProjectionsByName:function(e){var t=this;return this.projections.filter(function(r){return-1!==t.layerProjections[e].crss.indexOf(r)})}},watch:{selectedlayers:function(e){e.length?1===e.length?(this.epsg=this.layerProjections[e[0]].crss[0],this.projections=this.layerProjections[e[0]].crss):this.projections=this.getProjectionsByName(e[e.length-1]):(this.epsg=null,this.projections=[])},epsg:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.layers=this.getLayersByEpsg(this.epsg);case 3:case"end":return e.stop()}},n,this)}));return e}()},created:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function i(){var e,t,r,a,o,s=this;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:e=this.$options.config,t=e.layers,r=e.title,a=e["abstract"],o=e.wmsurl,this.url=o,this.title=r,this["abstract"]=a,this.layerProjections={},t.forEach(function(e){var t=e.name,r=e.crss,i=e.title;s.layerProjections[t]={crss:r.map(function(e){return n.get(e),"EPSG:"+e.epsg}).sort(),title:i}}),this.layers=t;case 7:case"end":return i.stop()}},i,this)}));return e}(),beforeDestroy:function(){this.$data=null}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.loading,expression:"loading"}]},[r("bar-loader",{attrs:{loading:e.loading}}),e._v(" "),r("h3",{staticClass:"skin-color g3w-wms-panel-title"},[e._v(e._s(e.title))]),e._v(" "),e["abstract"]?r("helpdiv",{attrs:{message:e["abstract"]}}):e._e(),e._v(" "),r("label",{directives:[{name:"t",rawName:"v-t",value:"sidebar.wms.panel.label.layers",expression:"'sidebar.wms.panel.label.layers'"}],attrs:{"for":"g3w-wms-layers"}}),e._v(" "),r("select",{directives:[{name:"select2",rawName:"v-select2",value:"selectedlayers",expression:"'selectedlayers'"}],attrs:{id:"g3w-wms-layers",multiple:"multiple",clear:"true"}},e._l(e.layers,function(t){return r("option",{key:t.name,domProps:{value:t.name}},[e._v(e._s(t.title))])}),0),e._v(" "),r("label",{directives:[{name:"t",rawName:"v-t",value:"sidebar.wms.panel.label.projections",expression:"'sidebar.wms.panel.label.projections'"}],attrs:{"for":"g3w-wms-projections"}}),e._v(" "),r("select",{directives:[{name:"select2",rawName:"v-select2",value:"epsg",expression:"'epsg'"}],attrs:{id:"g3w-wms-projections"}},e._l(e.projections,function(t){return r("option",{key:t,domProps:{value:t}},[e._v(e._s(t))])}),0),e._v(" "),r("label",{directives:[{name:"t",rawName:"v-t",value:"sidebar.wms.panel.label.name",expression:"'sidebar.wms.panel.label.name'"}],attrs:{"for":"g3w-wms-layer-name"}}),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],staticClass:"form-control",attrs:{id:"g3w-wms-layer-name"},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}}),e._v(" "),e.added?r("div",{directives:[{name:"t",rawName:"v-t",value:"sidebar.wms.layer_id_already_added",expression:"'sidebar.wms.layer_id_already_added'"}],staticClass:"g3w-wms-external-panel-layer-added-message"}):e._e(),e._v(" "),r("layerspositions",{attrs:{position:e.position},on:{"layer-position-change":function(t){e.position=t}}}),e._v(" "),r("button",{directives:[{name:"disabled",rawName:"v-disabled",value:0===e.selectedlayers.length,expression:"0 === selectedlayers.length"}],staticClass:"btn wms-add-layer-button sidebar-button skin-button",on:{click:function(t){return t.stopPropagation(),e.addWMSlayer(t)}}},[r("i",{"class":e.g3wtemplate.getFontClass("plus-square"),staticStyle:{"font-weight":"bold"}})])],1)},n.staticRenderFns=[],n._scopeId="data-v-8f518808"},{"g3w-ol/projection/projections":111,"vueify/lib/insert-css":1}],312:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}e("regenerator-runtime");var i=e("vue-color"),a=n(i);window.VueColor=a,window.VueCookie=e("vue-cookie")},{"regenerator-runtime":"regenerator-runtime","vue-color":"vue-color","vue-cookie":"vue-cookie"}],313:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("core/utils/utils"),i=n.uniqueId,a=new Vue,o={};r.watch=function(e){var t=e.el,r=e.attr,n=e.watcher,s=i();t.setAttribute(r,s);var l=o[s]={};return n&&(l.unwatch=a.$watch(n[0],n[1],n[2]||{immediate:!0}),l.handler=n[1]),s},r.unwatch=function(e){var t=e.el,r=e.attr,n=t.getAttribute(r);n&&(o[n].unwatch(),delete o[n])},r.trigger=function(e){var t=e.el,r=e.attr,n=e.data;return o[t.getAttribute(r)].handler(n)}},{"core/utils/utils":68}],314:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=function(e,t){t.value?e.setAttribute("checked","checked"):e.removeAttribute("checked")}},{}],315:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=function(e,t){var r="g3w-disabled";t.value?e.classList.contains(r)||e.classList.add(r):e.classList.remove(r)}},{}],316:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("store/application-state"),a=n(i),o=e("directives/utils"),s="g3w-v-download-id";r["default"]={bind:function(e,t){("boolean"!=typeof t.value||t.value)&&(0,o.watch)({el:e,attr:s,watcher:[function(){return a["default"].download},function(r){var n=t.modifiers&&t.modifiers.show&&"hide"||"disabled";e.classList.toggle("g3w-"+n,"hide"===n?!r:r)}]})},unbind:function(e){return(0,o.unwatch)({el:e,attr:s})}}},{"directives/utils":313,"store/application-state":373}],317:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("store/application-state"),a=n(i),o=e("directives/utils"),s="g3w-v-offline-id";r["default"]={bind:function(e,t){(0,o.watch)({el:e,attr:s,watcher:[function(){return a["default"].online},function(r){r=t.arg&&"hide"===t.arg?!r:r,e.classList.toggle("g3w-hide",!r)}]})},unbind:function(e){return(0,o.unwatch)({el:e,attr:s})}}},{"directives/utils":313,"store/application-state":373}],318:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("store/application-state"),a=n(i),o=e("directives/utils"),s="g3w-v-plugins-id";r["default"]={bind:function(e){(0,o.watch)({el:e,attr:s,watcher:[function(){return a["default"].plugins},function(t){e.classList.toggle("g3w-hide",0===t.length)}]})},unbind:function(e){return(0,o.unwatch)({el:e,attr:s})}}},{"directives/utils":313,"store/application-state":373}],319:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={inserted:function(e,t,r){var n=r.data.attrs||{},i=n.templateResult,a=n.templateSelection,o=n.multiple,s=void 0!==o&&o,l=n.search,u=void 0===l||l,c=n.select2_value;
$(e).select2({width:"100%",dropdownCssClass:"skin-color",templateResult:i,templateSelection:a,minimumResultsForSearch:u?void 0:-1}).on("select2:select",function(e){if(t.value){var n=e.params.data.id;s&&0===r.context[t.value].filter(function(e){return n===e}).length?r.context[t.value].push(n):r.context[t.value]=n}}).on("select2:unselect",function(e){t.value&&s&&(r.context[t.value]=r.context[t.value].filter(function(t){return e.params.data.id!==t}))}),t.value&&c&&$(e).val(c).trigger("change")},unbind:function(e){$(e).select2("destroy")}}},{}],320:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=function(e,t){e.toggleAttribute("selected",0===t.value)}},{}],321:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("store/application-state"),a=n(i),o=e("directives/utils"),s=e("core/i18n/i18n.service"),l=s.t,u="g3w-v-t-html-id";r["default"]={bind:function(e,t){(0,o.watch)({el:e,attr:u,watcher:[function(){return a["default"].language},function(){e.innerHTML=""+l(t.value)}]})},unbind:function(e){return(0,o.unwatch)({el:e,attr:u})}}},{"core/i18n/i18n.service":13,"directives/utils":313,"store/application-state":373}],322:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("store/application-state"),a=n(i),o=e("directives/utils"),s=e("core/i18n/i18n.service"),l=s.t,u=s.tPlugin,c="g3w-v-t-placeholder-id";r["default"]={bind:function(e,t){(0,o.watch)({el:e,attr:c,watcher:[function(){return a["default"].language},function(){e.setAttribute("placeholder",("plugin"===t.arg?u:l)(t.value))}]})},unbind:function(e){return(0,o.unwatch)({el:e,attr:c})}}},{"core/i18n/i18n.service":13,"directives/utils":313,"store/application-state":373}],323:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("store/application-state"),a=n(i),o=e("directives/utils"),s=e("core/i18n/i18n.service"),l=s.tPlugin,u="g3w-v-t-plugin-id";r["default"]={bind:function(e,t){var r=e.innerHTML;(0,o.watch)({el:e,attr:u,watcher:[function(){return a["default"].language},function(){var n=null!==t.value?l(t.value):"";switch(t.arg?t.arg:"post"){case"pre":e.innerHTML=n+" "+r;break;case"post":e.innerHTML=r+" "+n}}]})},unbind:function(e){return(0,o.unwatch)({el:e,attr:u})}}},{"core/i18n/i18n.service":13,"directives/utils":313,"store/application-state":373}],324:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("store/application-state"),a=n(i),o=e("directives/utils"),s=e("core/i18n/i18n.service"),l=s.t,u=s.tPlugin,c="g3w-v-t-title-id";r["default"]={bind:function(e,t){(0,o.watch)({el:e,attr:c,watcher:[function(){return a["default"].language},function(){var r=("plugin"===t.arg?u:l)(t.value);e.setAttribute("title",r),e.setAttribute("data-original-title",r)}]})},unbind:function(e){return(0,o.unwatch)({el:e,attr:c})}}},{"core/i18n/i18n.service":13,"directives/utils":313,"store/application-state":373}],325:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("store/application-state"),a=n(i),o=e("directives/utils"),s=e("core/i18n/i18n.service"),l=s.t,u=s.tPlugin,c="g3w-v-t-tooltip-id";r["default"]={bind:function(e,t){t.modifiers.create&&(t.arg&&(e.setAttribute("data-placement",t.arg),e.classList.add("skin-color","skin-tooltip-"+t.arg)),$(e).tooltip({trigger:a["default"].ismobile?"click":"hover",html:!0}).on("shown.bs.tooltip",function(){a["default"].ismobile&&setTimeout(function(){return $(e).tooltip("hide")},600)})),(0,o.watch)({el:e,attr:c,watcher:[function(){return a["default"].language},function(r){var n=r.el,i=void 0===n?e:n,a=i.getAttribute("current-tooltip");null===a&&(a=t.value),i.setAttribute("data-original-title",t.modifiers.text?a:("plugin"===t.arg?u:l)(a))}]})},componentUpdated:function(e,t){var r=e.getAttribute("current-tooltip");null!=r&&r!==t.oldValue&&(0,o.trigger)({el:e,attr:c,data:{el:e}})},unbind:function(e){$(e).tooltip("hide"),(0,o.unwatch)({el:e,attr:c})}}},{"core/i18n/i18n.service":13,"directives/utils":313,"store/application-state":373}],326:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("store/application-state"),a=n(i),o=e("directives/utils"),s=e("core/i18n/i18n.service"),l=s.t,u="g3w-v-t-id",c=function(e){var t=e.el,r=null!==t.__currentBinding.value?l(t.__currentBinding.value):"";switch(t.__currentBinding.arg?t.__currentBinding.arg:"post"){case"pre":t.innerHTML=r+" "+t.__innerHTML;break;case"post":t.innerHTML=t.__innerHTML+" "+r}};r["default"]={bind:function(e,t){e.__innerHTML=e.innerHTML,e.__currentBinding=t,(0,o.watch)({el:e,attr:u,watcher:[function(){return a["default"].language},function(){return c({el:e})}]})},componentUpdated:function(e,t){e.__currentBinding=t,c({el:e})},unbind:function(e){return(0,o.unwatch)({el:e,attr:u})}}},{"core/i18n/i18n.service":13,"directives/utils":313,"store/application-state":373}],327:[function(e,t,r){window.g3wsdk=e("app/api")},{"app/api":2}],328:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();e("./deprecated"),e("./globals");var s=e("store/application-state"),l=n(s),u=e("services/application"),c=n(u),d=e("services/viewport"),f=n(d),p=e("services/gui"),h=n(p),v=e("services/floatbar"),g=n(v),m=e("services/navbaritems"),y=n(m),b=e("services/sidebar"),w=n(b),x=e("store/components"),S=n(x),L=e("components/App.vue"),C=n(L),k=e("components/GlobalImage.vue"),E=n(k),M=e("components/GlobalGallery.vue"),T=n(M),I=e("components/GlobalGeo.vue"),P=n(I),F=e("components/GlobalSkeleton.vue"),O=n(F),R=e("components/GlobalBarLoader"),A=n(R),j=e("components/GlobalProgressBar"),N=n(j),D=e("components/GlobalHelpDiv.vue"),G=n(D),V=e("components/GlobalResize.vue"),U=n(V),q=e("components/GlobalLayerPositions.vue"),B=n(q),z=e("components/GlobalDateTime.vue"),W=n(z),H=e("components/GlobalRange.vue"),K=n(H),Z=e("components/GlobalResizeIcon.vue"),Y=n(Z),Q=e("components/GlobalTabs.vue"),X=n(Q),J=e("components/GlobalDivider.vue"),ee=n(J),te=e("components/Floatbar.vue"),re=n(te),ne=e("components/NavbaritemsLeft.vue"),ie=n(ne),ae=e("components/NavbaritemsRight.vue"),oe=n(ae),se=e("components/Sidebar.vue"),le=n(se),ue=e("components/Viewport.vue"),ce=n(ue),de=e("directives/v-disabled"),fe=n(de),pe=e("directives/v-checked"),he=n(pe),ve=e("directives/v-selected-first"),ge=n(ve),me=e("directives/v-select2"),ye=n(me),_e=e("directives/v-t-tooltip"),be=n(_e),we=e("directives/v-t-html"),xe=n(we),Se=e("directives/v-t-placeholder"),Le=n(Se),Ce=e("directives/v-t-title"),ke=n(Ce),Ee=e("directives/v-t"),Me=n(Ee),Te=e("directives/v-t-plugin"),Ie=n(Te),Pe=e("directives/v-plugins"),Fe=n(Pe),Oe=e("directives/v-online"),Re=n(Oe),Ae=e("directives/v-download"),je=n(Ae),Ne=e("app/constant"),De=e("core/utils/utils"),Ge=De.base,Ve=De.inherit,$e=De.toRawType,Ue=e("core/i18n/i18n.service"),qe=Ue.t,Be=Ue.tPlugin,ze=e("core/g3wobject"),We=e("gui/projectsmenu/projectsmenu"),He=e("gui/changemapmenu/changemapmenu");Vue.component(E["default"].name,E["default"]),Vue.component(T["default"].name,T["default"]),Vue.component(P["default"].name,P["default"]),Vue.component(A["default"].name,A["default"]),Vue.component(N["default"].name,N["default"]),Vue.component(O["default"].name,O["default"]),Vue.component(G["default"].name,G["default"]),Vue.component(U["default"].name,U["default"]),Vue.component(B["default"].name,B["default"]),Vue.component(W["default"].name,W["default"]),Vue.component(K["default"].name,K["default"]),Vue.component(Y["default"].name,Y["default"]),Vue.component(X["default"].name,X["default"]),Vue.component(ee["default"].name,ee["default"]),Vue.filter("t",function(e){return qe(e)}),Vue.filter("tPlugin",function(e){return null!==e?Be(e):""}),Vue.directive("disabled",fe["default"]),Vue.directive("checked",he["default"]),Vue.directive("selected-first",ge["default"]),Vue.directive("select2",ye["default"]),Vue.directive("t-tooltip",be["default"]),Vue.directive("t-html",xe["default"]),Vue.directive("t-placeholder",Le["default"]),Vue.directive("t-title",ke["default"]),Vue.directive("t",Me["default"]),Vue.directive("t-plugin",Ie["default"]),Vue.directive("plugins",Fe["default"]),Vue.directive("online",Re["default"]),Vue.directive("download",je["default"]),Vue.use(window.VueCookie),Vue.use({install:function(e){e.prototype.g3wtemplate={font:Ne.FONT_AWESOME_ICONS,get:function(){},getInfo:function(){return{font:this.font}},addFontClass:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,r=e.className,n=void 0===this.font[t];return n&&(this.font[t]=r),n},getInfoString:function(){},getFontClass:function(e){return"undefined"!=typeof this.font[e]?this.font[e]:""}},e.mixin({methods:{isMobile:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){return isMobile.any})}})}},{}),Vue.mixin({inheritAttrs:!1});var Ke=$.LayoutManager;Ke.loading(!0);var Ze=function Ye(t){var r=t.ApplicationService,n=r.getConfig().layout||{};this._isMobile=isMobile.any,this._isIframe=n.iframe,this.sizes={sidebar:{width:0}},this.waitingoutputdataplace=null,this.init=function(){this._createApp()},this._createTemplateConfig=function(){var t=Vue.prototype.g3wtemplate,i=r.getConfig().apptitle||"G3W Suite",a=e("gui/viewport/contentsviewer"),o=e("gui/catalog/vue/catalog"),s=e("gui/search/vue/search"),l=e("gui/querybuilder/querybuilderuifactory"),u=e("gui/print/vue/print"),c=e("gui/metadata/vue/metadata"),d=e("gui/tools/vue/tools"),f=e("gui/wms/vue/wms"),p=e("gui/map/vue/map"),v=e("gui/queryresults/vue/queryresults"),g=e("gui/spatialbookmarks/vue/spatialbookmarks");return{title:i,placeholders:{navbar:{components:[]},sidebar:{components:[new c({id:"metadata",open:!1,collapsible:!1,icon:t.getFontClass("file"),mobile:!0}),new g({id:"spatialbookmarks",open:!1,collapsible:!0,icon:t.getFontClass("bookmark"),mobile:!0}),new u({id:"print",open:!1,collapsible:!0,icon:t.getFontClass("print"),mobile:!1}),new s({id:"search",open:!1,collapsible:!0,icon:t.getFontClass("search"),actions:[{id:"querybuilder","class":t.getFontClass("calculator")+" sidebar-button sidebar-button-icon",tooltip:"Query Builder",fnc:function(){h["default"].closeContent(),Ye.Services.sidebar.closeOpenComponents(),l.show({type:"sidebar"})},style:{color:"#8DC3E3",padding:"6px",fontSize:"1.2em",borderRadius:"3px",marginRight:"5px"}}],mobile:!0}),new d({id:"tools",open:!1,collapsible:!0,icon:t.getFontClass("tools"),mobile:!0}),new f({id:"wms",open:!1,collapsible:!0,icon:t.getFontClass("layers"),mobile:!0}),new o({id:"catalog",open:!1,collapsible:!1,isolate:!0,icon:t.getFontClass("map"),mobile:!0,config:{legend:{config:n.legend}}})]},floatbar:{components:[]}},othercomponents:[new v({id:"queryresults"})],viewport:{components:{map:new p({id:"map"}),content:new a({id:"contents"})}}}},this._createApp=function(){this._setDataTableLanguage();var e=this;return(isMobile.any||this._isIframe)&&$("body").addClass("sidebar-collapse"),new Vue({el:"#app",created:function(){e._setupInterface(),e._setupLayout(),e._setUpServices(),e.templateConfig=e._createTemplateConfig(),this.$watch(function(){return l["default"].language},function(){e._setDataTableLanguage()})},mounted:function(){function t(){return r.apply(this,arguments)}var r=i(regeneratorRuntime.mark(function n(){var t;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.$nextTick();case 2:return e._buildTemplate(),e._setUpTemplateDependencies(this),$(document).localize(),e._setViewport(e.templateConfig.viewport),t=$(".navbar").css("background-color"),h["default"].skinColor=t&&"#"+t.substr(4,t.indexOf(")")-4).split(",").map(function(e){return parseInt(e).toString(16)}).join(""),r.next=10,this.$nextTick();case 10:e.emit("ready"),e.sizes.sidebar.width=$("#g3w-sidebar").width(),h["default"].ready();case 13:case"end":return r.stop()}},n,this)}));return t}()})},this._setupLayout=function(){isMobile.any||$("<style type='text/css'> .ol-control-tl {top: 7px;left:43px;}</style>").appendTo("head"),Vue.component("sidebar",le["default"]),Vue.component("navbarleftitems",ie["default"]),Vue.component("navbarrightitems",oe["default"]),Vue.component("viewport",ce["default"]),Vue.component("floatbar",re["default"]),Vue.component("app",C["default"])},this._setDataTableLanguage=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t={language:{sSearch:"",searchPlaceholder:qe("dosearch"),sLengthMenu:qe("dataTable.lengthMenu"),paginate:{previous:qe("dataTable.previous"),next:qe("dataTable.next")},info:qe("dataTable.info"),zeroRecords:qe("dataTable.nodatafilterd"),infoFiltered:""}};$.extend($.fn.dataTableExt.oStdClasses,{sFilterInput:"form-control search"}),e?e.dataTable({oLanguage:t}):$.extend(!0,$.fn.dataTable.defaults,t)},this._addRoutes=function(){var e=r.getRouterService(),t=h["default"].getComponent("map").getService();e.addRoute("map/zoomto/{coordinate}/:zoom:",function(e,r){e=_.map(e.split(","),function(e){return Number(e)}),r=r?Number(r):null,e.length&&t.on("ready",function(){this.zoomTo(e,r)})})},this._setUpServices=function(){Object.keys(Ye.Services).forEach(function(e){var t=Ye.Services[e];r.registerService(e,t)}),Object.values(h["default"].getComponents()).forEach(function(e){r.registerService(e.id,e.getService())}),Ye.Services.viewport.on("resize",function(){return h["default"].emit("resize")})},this._buildTemplate=function(){var e=this;g["default"].init(Ke);var t=this.templateConfig.placeholders;Object.entries(t).forEach(function(t){var r=o(t,2),n=r[0],i=r[1];e._addComponents(i.components,n)}),this._addOtherComponents()},this._addOtherComponents=function(){this.templateConfig.othercomponents&&this._addComponents(this.templateConfig.othercomponents)},this._setViewport=function(e){e&&(Ye.Services.viewport.init(e),this._addComponents(e.components))},this._addComponent=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._addComponents([e],t,r),!0},this._addComponents=function(e,t,n){var i=!0;if(t&&Ye.PLACEHOLDERS.indexOf(t)>-1){var a=Ye.Services[t];a&&(i=a.addComponents(e,n))}Object.entries(e).forEach(function(e){var t=o(e,2),n=(t[0],t[1]);i&&(S["default"].registerComponent(n),r.registerService(n.id,n.getService()))})},this._removeComponent=function(e,t,r){var n=S["default"].unregisterComponent(e);t&&Ye.Services[t]&&Ye.Services[t].removeComponent(n,r)},this._showModalOverlay=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments[1],r=h["default"].getService("map");e?r.startDrawGreyCover(t):r.stopDrawGreyCover()},this._isSidebarVisible=function(){return!$("body").hasClass("sidebar-collapse")},this._showSidebar=function(){$("body").addClass("sidebar-open"),$("body").removeClass("sidebar-collapse")},this._hideSidebar=function(){$("body").removeClass("sidebar-open"),$("body").addClass("sidebar-collapse")},this._setUpTemplateDependencies=function(e){h["default"].isMobile=function(){return isMobile.any},h["default"].getTemplateInfo=function(){return e.g3wtemplate.getInfo()},h["default"].getTemplateInfo=function(){return e.g3wtemplate.getInfo()},h["default"].getFontClass=function(t){return e.g3wtemplate.getFontClass(t)}},h["default"].errorToMessage=function(e){var t="server_error";switch($e(e)){case"Error":t="CLIENT - "+e.message;break;case"Object":if(e.responseJSON){if(e=e.responseJSON,e.result===!1){var r=e.error,n=r.code,i=void 0===n?"":n,a=r.data,o=void 0===a?"":a,s=r.message,l=void 0===s?"":s;t=i.toUpperCase()+" "+o+" "+l}}else e.responseText&&(t=e.responseText);break;case"Array":t=e.map(function(e){return h["default"].errorToMessage(e)}).join(" ");break;case"String":default:t=e}return t},this._setupInterface=function(){var t=this;h["default"].layout=Ke,h["default"].getSize=function(e){var r=e.element,n=e.what;if(r&&n)return t.sizes[r][n]},h["default"].addComponent=this._addComponent.bind(this),h["default"].removeComponent=this._removeComponent.bind(this),h["default"].getResourcesUrl=function(){return r.getConfig().resourcesurl},h["default"].showList=g["default"].showPanel.bind(g["default"]),h["default"].closeList=g["default"].closePanel.bind(g["default"]),h["default"].hideList=g["default"].hidePanel.bind(g["default"]),h["default"].showTable=function(){},h["default"].closeTable=function(){},h["default"].outputDataPlace=function(){var e=i(regeneratorRuntime.mark(function t(e){var r,n,o,s,l,u,c,d,f,p,v,g,m=this,y=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r={condition:!0,add:!1,loading:!0},n=y.title,o=void 0===n?"":n,s=y.show,l=void 0===s?r:s,u=y.before,c=y.after,d="Object"!==$e(l)?{condition:l,add:!1,loading:!0}:a({},r,l),f=d.condition,p=d.add,v=d.loading,t.t0=this.waitingoutputdataplace,!t.t0){t.next=8;break}return t.next=8,this.waitingoutputdataplace.stop();case 8:g=p?h["default"].getService("queryresults"):v&&this.showContentFactory("query")(o),this.waitingoutputdataplace=function(){var t=!1;return i(regeneratorRuntime.mark(function r(){var n,i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e;case 3:if(n=r.sent,r.t0=u,!r.t0){r.next=8;break}return r.next=8,u(n);case 8:n.usermessage&&h["default"].showUserMessage({type:n.usermessage.type,message:n.usermessage.message,autoclose:n.usermessage.autoclose}),t||(i="Function"===$e(f)?f(n):"Boolean"!==$e(f)||f,i?(g?g:m.showContentFactory("query")(o)).setQueryResponse(n,{add:p}):h["default"].closeContent(),c&&c(n)),r.next=17;break;case 12:r.prev=12,r.t1=r["catch"](0),a=m.errorToMessage(r.t1),m.showUserMessage({type:"alert",message:a,textMessage:!0}),m.closeContent();case 17:return r.prev=17,t||(m.waitingoutputdataplace=null),r.finish(17);case 20:case"end":return r.stop()}},r,m,[[0,12,17,20]])}))(),{stop:function(){function e(){return r.apply(this,arguments)}var r=i(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=!0;case 1:case"end":return e.stop()}},n,m)}));return e}()}}();case 10:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),h["default"].showContentFactory=function(e){var t=void 0;switch(e){case"query":t=h["default"].showQueryResults;break;case"form":t=h["default"].showForm}return t},h["default"].showForm=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.perc,n=t.split,i=void 0===n?"h":n,a=t.push,o=t.showgoback,s=t.crumb,l=e("gui/form/vue/form"),u=t.formComponent?new t.formComponent(t):new l(t),c=u.getService();return h["default"].setContent({perc:r,content:u,split:i,crumb:s,push:!!a,showgoback:!!o,closable:!1}),c},h["default"].closeForm=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.pop,r=void 0!==t&&t;this.emit("closeform",!1),r?h["default"].popContent():f["default"].removeContent(),h["default"].setModal(!1)},h["default"].disableElement=function(e){var t=e.element,r=e.disable;r&&$(t).addClass("g3w-disabled")||$(t).removeClass("g3w-disabled")},h["default"].disableContent=function(e){f["default"].disableContent(e)},h["default"].disablePanel=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];h["default"].disableElement({element:"#g3w-sidebarpanel-placeholder",disable:e})},h["default"].hideContent=function(e,t){return f["default"].hideContent(e,t)},h["default"].closeContent=function(){return this.emit("closecontent",!1),f["default"].closeContent()},h["default"].closeOpenSideBarComponent=function(){Ye.Services.sidebar.closeOpenComponents()},h["default"].showQueryResults=function(e,t){var r=h["default"].getComponent("queryresults"),n=r.getService();return n.reset(),t&&n.setQueryResponse(t),h["default"].showContextualContent({content:r,title:"info.title",crumb:{title:"info.title",trigger:null},push:h["default"].getPushContent(),post_title:e}),n},h["default"].addNavbarItem=function(e){y["default"].addItem(e)},h["default"].removeNavBarItem=function(){},h["default"].showPanel=w["default"].showPanel.bind(w["default"]),h["default"].closePanel=w["default"].closePanel.bind(w["default"]),h["default"].disableApplication=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];r.disableApplication(e)},h["default"].showUserMessage=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return f["default"].showUserMessage(e)},h["default"].closeUserMessage=function(){f["default"].closeUserMessage()},h["default"].notify={warning:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];h["default"].showUserMessage({type:"warning",message:e,autoclose:t})},error:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];h["default"].showUserMessage({type:"alert",message:e,autoclose:t})},info:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];h["default"].showUserMessage({type:"info",message:e,autoclose:t})},success:function(e){h["default"].showUserMessage({type:"success",message:e,autoclose:!0})}},h["default"].dialog=bootbox,h["default"].showModalDialog=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return h["default"].dialog.dialog(e)},h["default"].showSpinner=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.container||"body",r=e.id||"loadspinner",n=e.where||"prepend",i=e.style||"",a=e.transparent?"background-color: transparent":"",o=e.center?"margin: auto":"";$("#"+r).length||$(t)[n].call($(t),'<div id="'+r+'" class="spinner-wrapper '+i+'" style="'+a+'"><div class="spinner '+i+'" style="'+o+'"></div></div>')},h["default"].hideSpinner=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"loadspinner";$("#"+e).remove()},h["default"].showFloatbar=function(){g["default"].open()},h["default"].hideFloatbar=function(){g["default"].close()},h["default"].showSidebar=this._showSidebar.bind(this),h["default"].hideSidebar=this._hideSidebar.bind(this),h["default"].isSidebarVisible=this._isSidebarVisible.bind(this),h["default"].reloadComponents=function(){Ye.Services.sidebar.reloadComponents()},h["default"].setModal=this._showModalOverlay.bind(this),h["default"].showFullModal=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.element,r=void 0===t?"#full-screen-modal":t,n=e.show,i=void 0===n||n;$(r).modal(i?"show":"hide")},h["default"].disableSideBar=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];l["default"].gui.sidebar.disabled=e},h["default"].setPrimaryView=function(e){f["default"].setPrimaryView(e)},h["default"].showMap=function(){f["default"].showMap()},h["default"].showContextualMap=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30,t=arguments[1];f["default"].showContextualMap({perc:e,split:t})},h["default"].setContextualMapComponent=function(e){f["default"].setContextualMapComponent(e)},h["default"].resetContextualMapComponent=function(){f["default"].resetContextualMapComponent()},h["default"].showContent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return h["default"].setLoadingContent(!1),e.perc=t._isMobile?100:e.perc,h["default"].setContent(e),!0},h["default"].showContextualContent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.perc=t._isMobile?100:e.perc,h["default"].setContent(e),!0},h["default"].pushContent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.perc=t._isMobile?100:e.perc,e.push=!0,h["default"].setContent(e)},h["default"].pushContextualContent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.perc=t._isMobile?100:e.perc,h["default"].pushContent(e)},h["default"].popContent=function(){f["default"].popContent()},h["default"].getContentLength=function(){return f["default"].contentLength()},h["default"].getCurrentContentTitle=function(){return f["default"].getCurrentContentTitle()},h["default"].getCurrentContentId=function(){return f["default"].getCurrentContentId()},h["default"].changeCurrentContentTitle=function(e){f["default"].changeCurrentContentTitle(e)},h["default"].changeCurrentContentOptions=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};f["default"].changeCurrentContentOptions(e)},h["default"].getCurrentContent=function(){return f["default"].getCurrentContent()},h["default"].toggleFullViewContent=function(){f["default"].toggleFullViewContent()},h["default"].resetToDefaultContentPercentage=function(){f["default"].resetToDefaultContentPercentage()},h["default"].getProjectMenuDOM=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.projects,r=e.host,n=e.cbk,i=new We({projects:t&&Array.isArray(t)&&t,cbk:n,host:r}).getInternalComponent();return i.$mount().$el},h["default"].setCloseUserMessageBeforeSetContent=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._closeUserMessageBeforeSetContent=e},h["default"]._setContent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t._closeUserMessageBeforeSetContent&&h["default"].closeUserMessage(),e.content=e.content||null,e.title=e.title||"",e.push=!!_.isBoolean(e.push)&&e.push,e.perc=t._isMobile?100:e.perc,e.split=e.split||"h",e.backonclose=!!_.isBoolean(e.backonclose)&&e.backonclose,e.showtitle=!_.isBoolean(e.showtitle)||e.showtitle,f["default"].showContent(e)},h["default"].hideClientMenu=function(){r.getConfig().user=null},h["default"].hideChangeMaps=function(){r.getConfig().projects=[]},h["default"].getTemplateClasses=function(){return BootstrapVersionClasses},h["default"].getTemplateClass=function(e){var t=e.element,r=e.type;return BootstrapVersionClasses[t][r]},h["default"].setLoadingContent=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Ye.Services.viewport.setLoadingContent(e),e&&new Promise(function(e){setTimeout(e,200)})},h["default"].openProjectsMenu=function(){var e=h["default"].getComponent("contents").getComponentById("projectsmenu");return e?void h["default"].closeContent():(this.isMobile()&&(h["default"].hideSidebar(),$("#main-navbar.navbar-collapse").removeClass("in")),Ye.Services.sidebar.closeOpenComponents(),void h["default"].setContent({content:new We,title:"",perc:100}))},h["default"].openChangeMapMenu=function(){var e=h["default"].getComponent("contents").getComponentById("changemapmenu");return e?void h["default"].closeContent():(this.isMobile()&&(h["default"].hideSidebar(),$("#main-navbar.navbar-collapse").removeClass("in")),Ye.Services.sidebar.closeOpenComponents(),void h["default"].setContent({content:new He,title:"",perc:100}))}},Ge(this)};Ve(Ze,ze),Ze.PLACEHOLDERS=["navbar","sidebar","viewport","floatbar"],Ze.Services={navbar:null,sidebar:w["default"],viewport:f["default"],floatbar:null},Ze.fail=function(e){var t=e.error;Ke.loading(!1),new Vue(a({el:"#app"},Vue.compile('<div class="error-initial-page skin-background-color">\n        <template v-if="isMobile()">\n          <h3 class="oops">Oops!</h3>\n          <h5 class="cause">'+(t||qe("error_page.error"))+'</h5>\n          <h6 class="at-moment">'+qe("error_page.at_moment")+'</h6>\n          <h4 class="f5">'+qe("error_page.f5")+'</h4>\n        </template>\n        <template v-else>\n          <h1 class="oops">Oops!</h1>\n          <h1 class="cause">'+(t||qe("error_page.error"))+'</h1>\n          <h3 class="at-moment">'+qe("error_page.at_moment")+'</h3>\n          <h2 class="f5">'+qe("error_page.error")+"</h2>\n        </template>\n      </div>")))},c["default"].init().then(function(){var e=new Ze({ApplicationService:c["default"]});e.on("ready",function(){return c["default"].postBootstrap()}),e.init()})["catch"](function(e){var t=e.error,r=void 0===t?null:t;e.language;r&&(r.responseJSON&&r.responseJSON.error.data?r=r.responseJSON.error.data:r.statusText&&(r=r.statusText)),Ze.fail({error:r})})},{"./deprecated":312,"./globals":327,"app/constant":4,"components/App.vue":194,"components/Floatbar.vue":213,"components/GlobalBarLoader":218,"components/GlobalDateTime.vue":219,"components/GlobalDivider.vue":220,"components/GlobalGallery.vue":221,"components/GlobalGeo.vue":222,"components/GlobalHelpDiv.vue":223,"components/GlobalImage.vue":224,"components/GlobalLayerPositions.vue":225,"components/GlobalProgressBar":226,"components/GlobalRange.vue":227,"components/GlobalResize.vue":228,"components/GlobalResizeIcon.vue":229,"components/GlobalSkeleton.vue":230,"components/GlobalTabs.vue":231,"components/NavbaritemsLeft.vue":266,"components/NavbaritemsRight.vue":267,"components/Sidebar.vue":294,"components/Viewport.vue":308,"core/g3wobject":12,"core/i18n/i18n.service":13,"core/utils/utils":68,"directives/v-checked":314,"directives/v-disabled":315,"directives/v-download":316,"directives/v-online":317,"directives/v-plugins":318,"directives/v-select2":319,"directives/v-selected-first":320,"directives/v-t":326,"directives/v-t-html":321,"directives/v-t-placeholder":322,"directives/v-t-plugin":323,"directives/v-t-title":324,"directives/v-t-tooltip":325,"gui/catalog/vue/catalog":113,"gui/changemapmenu/changemapmenu":115,"gui/form/vue/form":123,"gui/map/vue/map":158,"gui/metadata/vue/metadata":161,"gui/print/vue/print":164,"gui/projectsmenu/projectsmenu":167,"gui/querybuilder/querybuilderuifactory":168,"gui/queryresults/vue/queryresults":172,"gui/search/vue/search":179,"gui/spatialbookmarks/vue/spatialbookmarks":181,"gui/tools/vue/tools":186,"gui/viewport/contentsviewer":189,"gui/wms/vue/wms":192,"services/application":351,"services/floatbar":360,"services/gui":361,"services/navbaritems":365,"services/sidebar":369,"services/viewport":371,"store/application-state":373,"store/components":375}],329:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={translation:{error_page:{error:"Verbindungsfehler",at_moment:"Karte anzeigen ist im Moment nicht möglich",f5:"Drücken Sie Strg+F5"},cookie_law:{message:"Diese Website verwendet Cookies, um Ihnen die bestmögliche Erfahrung auf unserer Website zu bieten.",buttonText:"Verstanden!"},"default":"default",sign_in:"Anmelden",layer_selection_filter:{tools:{filter:"Filter hinzufügen/entfernen",nofilter:"Filter entfernen",invert:"Auswahl umkehren",clear:"Auswahl löschen",show_features_on_map:"Auf der Karte sichtbare Features anzeigen"}},warning:{not_supported_format:"Nicht unterstütztes Format"},layer_position:{top:"OBEN",bottom:"UNTEN",message:"Position relativ zu den Layern im TOC"},sdk:{atlas:{template_dialog:{title:"Template auswählen"}},spatialbookmarks:{title:"Räumliche Lesezeichen",helptext:"Bewegen Sie sich auf der Kartenausdehnung, fügen Sie den Namen ein und klicken Sie auf Hinzufügen",input:{name:"Name"},sections:{project:{title:"Projekt-Lesezeichen"},user:{title:"Benutzer-Lesezeichen"}}},search:{all:"ALLE",no_results:"Keine Ergebnisse",searching:"Suchen ...",error_loading:"Fehler beim Datenladen",
layer_not_searchable:"Layer ist nicht durchsuchbar",layer_not_querable:"Layer ist nicht abfragbar",autocomplete:{inputshort:{pre:"Bitte",post:"oder mehrere Zeichen eingeben"}}},print:{no_layers:"Kein Layer zu drucken",template:"Template",labels:"Labels",scale:"Skala",format:"Format",rotation:"Drehung",download_image:"Bild herunterladen",fids_instruction:"Akzeptierte Werte: von 1 bis [max]. Es ist möglich, ein Intervall einzugeben, z. B. 4-6",fids_example:"Bsp. 1,4-6 druckt id 1,4,5,6",help:"Die im Druck angezeigten Layer können die im Projekt definierten sein und nicht die auf der Karte angezeigten"},querybuilder:{search:{run:"Ausführen",info:"Information","delete":"Löschen",edit:"Bearbeiten"},messages:{changed:"Gespeichert",number_of_features:"Anzahl der Features"},panel:{button:{all:"ALLE",save:"SPEICHERN",test:"TEST",clear:"LÖSCHEN",run:"AUSFÜHREN",manual:"MANUELL"},layers:"LAYERS",fields:"FELDER",values:"WERTE",operators:"OPERATOREN",expression:"AUSDRUCK"},error_run:"Es ist ein Fehler aufgetreten. Bitte überprüfen Sie die Abfrage",error_test:"Während der Ausführung der Abfrage ist ein Fehler aufgetreten","delete":"Soll es gelöscht werden?",additem:"Geben Sie den Namen der neuen Suche ein"},errors:{layers:{load:"Einige Layer sind nicht verfügbar"},unsupported_format:"Nicht unterstütztes Format",add_external_layer:"Fehler im Ladevorgang des Layers"},metadata:{title:"Metadaten",groups:{general:{title:"ALLGEMEIN",fields:{title:"TITEL",name:"NAME",description:"BESCHREIBUNG","abstract":"ABASTRACT",keywords:"SCHLÜSSELWÖRTER",fees:"GEBÜHREN",accessconstraints:"ZUGRIFFSBESCHRÄNKUNG",contactinformation:"KONTAKTE",subfields:{contactinformation:{contactelectronicmailaddress:"Email",personprimary:"Referenzen",contactvoicetelephone:"Telefon",contactorganization:"Firma",ContactOrganization:"Firma",contactposition:"Position",ContactPosition:"Position",contactperson:"Person",ContactPerson:"Person"}},wms_url:"WMS"}},spatial:{title:"SPATIAL",fields:{crs:"EPSG",extent:"BBOX"}},layers:{title:"LAYERS",fields:{layers:"LAYERS",subfields:{crs:"EPSG",bbox:"BBOX",title:"TITEL",name:"NAME",geometrytype:"GEOMETRIE",source:"QUELLE",attributes:"ATTRIBUTE","abstract":"ABSTRACT",attribution:"ATRIBUTION",keywords:"SCHLÜSSELWÖRTER",metadataurl:"METADATEN URL",dataurl:"DATEN URL"}},groups:{general:"ALLGEMEIN",spatial:"SPATIAL"}}}},tooltips:{relations:{form_to_row:"Zeilenansicht",row_to_form:"Formularansicht"},copy_map_extent_url:"Link zur Kartenansicht kopieren",download_shapefile:"Shapefile herunterladen",download_gpx:"DGPX herunterladen",download_gpkg:"GPKG herunterladen",download_csv:"CSV herunterladen",download_xls:"XLS herunterladen",show_chart:"Diagramm anzeigen",atlas:"Atlas drucken"},mapcontrols:{query:{tooltip:"Query layer",actions:{add_selection:{hint:"Auswahl hinzufügen/entfernen"},zoom_to_features_extent:{hint:"Zoom auf Feature-Ausdehnung"},add_features_to_results:{hint:"Hinzufügen/Entfernen von Features zu den Ergebnissen"},remove_feature_from_results:{hint:"Feature aus den Ergebnissen entfernen"},zoom_to_feature:{hint:"Zum Feature zoomen"},relations:{hint:"Relationen anzeigen"},relations_charts:{hint:"Relationship-Diagramm anzeigen"},download_features_shapefile:{hint:"Features Shapefile herunterladen"},download_shapefile:{hint:"Feature Shapefile herunterladen"},download_features_gpx:{hint:"Feature GPX herunterladen"},download_features_gpkg:{hint:"Feature GPKG herunterladen"},download_gpx:{hint:"Feature GPX herunterladen"},download_gpkg:{hint:"Feature GPKG herunterladen"},download_features_csv:{hint:"Features CSV herunterladen"},download_csv:{hint:"Feature CSV herunterladen"},download_features_xls:{hint:"Features XLS herunterladen"},download_xls:{hint:"Feature XLS herunterladen"},atlas:{hint:"Atlas drucken"},copy_zoom_to_fid_url:{hint:"Kopieren der Karten-URL mit dieser Geometrie-Feature-Erweiterung",hint_change:"Kopiert"}}},querybypolygon:{download:{title:"Attribute herunterladen",choiches:{feature:{label:"Nur Features"},feature_polygon:{label:"Features+Query Polygon"}}},tooltip:"Query nach Polygon",no_geometry:"Keine Geometrie in der Antwort",help:{title:"Hilfe - Abfrage nach Polygon",message:"\n                <ul>\n                  <li>Wählen Sie einen Polygon Layer auf TOC.</li>\n                  <li>Stellen Sie sicher, dass der Layer sichtbar ist.</li>\n                  <li>Klicken Sie auf ein Feature des ausgewählten Layers.</li>\n                </ul>"}},querybydrawpolygon:{tooltip:"Abfrage durch Polygon zeichnen"},querybybbox:{tooltip:"BBox Layer abfragen",nolayers_visible:"Es sind keine abfragbaren Layer sichtbar. Bitte setzen Sie mindestens einen sichtbaren wfs Layer, um die Abfrage zu starten",help:{title:"Hilfe - Abfrage des BBox Layers",message:"\n                 <ul>\n                  <li>Ein Quadrat auf der Karte ziehen, um unterstrichene Layer im TOC abzufragen</li>\n                 </ul>"}},addlayer:{messages:{csv:{warning:"Das Ergebnis in der Karte ist unvollständig, da die unten stehende Liste fehlerhafter Einträge enthält:"}},tooltip:"Layer hinzufügen"},geolocation:{tooltip:"Geolokalisierung"},measures:{length:{tooltip:"Länge",help:"Klicken Sie auf die Karte, um die Linie zu zeichnen. Drücken Sie <br>CANC, wenn Sie den letzten Eckpunkt löschen möchten."},area:{tooltip:"Fläche",help:"Drücken Sie <br>CANC, wenn Sie den letzten Eckpunkt löschen wollen."}},scale:{no_valid_scale:"Ungültige Skala"},scaleline:{units:{metric:"Meter",nautical:"Nautische Meile"}},zoomhistory:{zoom_last:"Zoom Vorheriger",zoom_next:"Zoom Nächster"}},relations:{relation_data:"Daten zur Relation",no_relations_found:"Keine Relationen gefunden",back_to_relations:"Zurück zu den Relationen",list_of_relations_feature:"Liste der Relationen des Features",error_missing_father_field:"Ein Feld fehlt"},workflow:{steps:{title:"Schritte"},next:"Weiter"},form:{loading:"Laden ...",inputs:{messages:{errors:{picklayer:"Kein Feature ausgewählt. Prüfen, ob der Layer in Bearbeitung oder im aktuellen Maßstab sichtbar ist"}},tooltips:{picklayer:"Wert aus dem Layer abrufen",lonlat:"Zum Abrufen der Koordinaten auf die Karte klicken"},input_validation_mutually_exclusive:"Feld schließt sich gegenseitig aus mit ",input_validation_error:"Obligatorisches Feld oder falscher Datentyp",input_validation_min_field:"Der Wert muss größer/gleich sein als der Feldwert  ",input_validation_max_field:"Der Wert muss kleiner/gleich sein als der Feldwert ",input_validation_exclude_values:"Wert muss einmalig sein",integer:"integer",bigint:"integer",text:"text",varchar:"text",textarea:"text",string:"string",date:"date",datetime:"date","float":"float",table:"table"},footer:{required_fields:"Erforderliche Felder"},messages:{qgis_input_widget_relation:"Spezifisches Relations-Formular verwenden, um mit Relationen zu arbeiten"}},catalog:{current_map_theme_prefix:"THEMA",choose_map_theme:"THEMA AUSWÄHLEN",menu:{layerposition:"Position des Layers",setwmsopacity:"Opazität einstellen",wms:{title:"",copy:"Klicken Sie hier, um die Url zu kopieren",copied:"Kopiert"},download:{unknow:"Herunterladen",shp:"Shapefile herunterladen",gpx:"GPX herunterladen",gpkg:"GPKG herunterladen",csv:"CSV herunterladen",xls:"XLS herunterladen",geotiff:"GEOTIFF herunterladen",geotiff_map_extent:"GEOTIFF herunterladen (aktueller Ansichtsumfang)"}}},wps:{list_process:"Liste der Prozesse",tooltip:"Karte anklicken"}},credits:{g3wSuiteFramework:"Applikation basiert auf OS-Framework",g3wSuiteDescription:"Veröffentlichen und verwalten Sie Ihre QGIS-Projekte im Internet",productOf:"Framework entwickelt von"},toggle_color_scheme:"Farbschema umschalten",logout:"Logout",no_other_projects:"Kein weiteres Projekt für diese Gruppe",no_other_groups:"Keine weiteren Gruppen für diese Makrogruppe",yes:"Ja",no:"No",back:"Zurück",backto:"Zurück zu ",changemap:"Karte ändern",change_session:"Sitzung ändern",component:"Allgemeine Komponente",search:"Suche",no_results:"Keine Ergebnisse gefunden",print:"Drucken",create_print:"Drucken erstellen",dosearch:"Suche",catalog:"Karte",data:"Daten",externalwms:"WMS",baselayers:"Base",tools:"Tools",tree:"Layers",legend:"Legende",nobaselayer:"Keine Basemap",street_search:"Adresse finden",show:"Anzeigen",hide:"Ausblenden",copy_form_data:"Daten kopieren",paste_form_data:"Einfügen",copy_form_data_from_feature:"Daten von der Karte kopieren",error_map_loading:"Fehler beim Laden der Karte",check_internet_connection_or_server_admin:"Internetverbindung prüfen oder Admin kontaktieren",could_not_load_vector_layers:"Verbindungsfehler: Layers können geladen werden",server_saver_error:"Fehler beim Speichern auf dem Server",server_error:"Server-Verbindungsfehler",save:"Speichern",cancel:"Abbrechen",close:"Schließen",dont_show_again:"Diese Meldung nicht mehr anzeigen",enlange_reduce:"Vergrößern / Verkleinern",reset_default:"Standardgröße",add:"Hinzufügen",exitnosave:"Beenden ohne Speichern",annul:"Abbrechen",layer_is_added:"Layer mit gleichem Namen bereits hinzugefügt",sidebar:{wms:{panel:{title:"WMS Layer hinzufügen",label:{position:"Kartenposition",name:"Name",projections:"Projektion",layers:"Layers"}},add_wms_layer:"WMS Layer hinzufügen",delete_wms_url:"WMS Url löschen",layer_id_already_added:"WMS Layer bereits hinzugefügt",url_already_added:"WMS URL/Name bereits hinzugefügt",layer_add_error:"WMS Layer nicht hinzugefügt. Bitte überprüfen Sie alle WMS-Parameter oder Url"}},info:{title:"Ergebnisse",list_of_relations:"List of Relations",open_link:"Beigefügtes Dokument öffnen",server_error:"Auf dem Server ist ein Fehler aufgetreten",no_results:"Keine Ergebnisse für diese Anfrage/Suche gefunden",link_button:"Öffnen"},mapcontrols:{geolocations:{error:"Position kann nicht bestimmt werden"},nominatim:{placeholder:"Addresse ...",noresults:"Keine Ergebnisse",notresponseserver:"Keine Antwort vom Server"},add_layer_control:{header:"Layer hinzufügen",select_projection:"Layer Projektion auswählen",select_field_to_show:"Feld auswählen, das auf der Karte angezeigt werden soll",select_csv_separator:"Begrenzer auswählen",select_csv_x_field:"X-Feld auswählen",select_csv_y_field:"Y-Feld auswählen",select_color:"Layer Farbe auswählen",drag_layer:"Layer hierher ziehen und ablegen"},query:{input_relation:"Klicken, um Relationen anzuzeigen"},length:{tooltip:"Länge"},area:{tooltip:"Area"},screenshot:{error:"Screenshot Fehlererstellung",securityError:'  \n        <p><b>Sicherheitsfehler</b>: Eine externe Ebene verhindert, dass die Karte gedruckt wird. Gehen Sie zur Überprüfung wie folgt vor:</p>\n        <ol>\n          <li>Entfernen Sie alle manuell hinzugefügten externen Ebenen (z. B. WMS-Ebenen)</li>\n          <li>Neuladen der Seite erzwingen: <code>STRG + F5</code></li>\n          <li>Drucken Sie die Karte erneut</li>\n        </ol>\n        <p>Für weitere Informationen wenden Sie sich bitte an den Serveradministrator zu: <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image" style="color: #000 !important;font -weight: fett;">&#x2139;&#xFE0F; Sicherheit und befleckte Leinwände</a></p>\n        '}},catalog_items:{helptext:"Klicken Sie mit der rechten Maustaste auf einen einzelnen Layer, um auf zusätzliche Funktionen zuzugreifen",contextmenu:{zoomtolayer:"Zoom auf Layer",open_attribute_table:"Attributtabelle öffnen",show_metadata:"Metadaten",styles:"Stile",vector_color_menu:"Farbe einstellen/ändern",layer_opacity:"Opazität"}},dataTable:{previous:"Vorherige",next:"Weiter",lengthMenu:"_MENÜ_ anzeigen",info:"Anzeige von _START_ bis _END_ der _TOTAL_ Einträge",no_data:"Keine Daten",nodatafilterd:"Keine passenden Datensätze gefunden",infoFiltered:"(gefiltert aus _MAX_ Gesamtsätzen)"}}}},{}],330:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={translation:{error_page:{error:"Connection error",at_moment:"At the moment is not possible show map",f5:"Press Ctrl+F5"},cookie_law:{message:"This website uses cookies to ensure you get the best experience on our website.",buttonText:"Got It!"},"default":"default",sign_in:"Sign in",layer_selection_filter:{tools:{filter:"Add/Remove Filter",nofilter:"Remove Filter",invert:"Invert Selection",clear:"Clear Selection",show_features_on_map:"Show features visible on map"}},warning:{not_supported_format:"Not supported format"},layer_position:{top:"TOP",bottom:"BOTTOM",message:"Position relative to layers on TOC"},sdk:{atlas:{template_dialog:{title:"Select Template"}},spatialbookmarks:{title:"Spatial Bookmarks",helptext:"Move on map extent, insert name and click Add",input:{name:"Name"},sections:{project:{title:"Project Bookmarks"},user:{title:"User Bookmarks"}}},search:{all:"ALL",no_results:"No results",searching:"Searching ...",error_loading:"Error Loading Data",layer_not_searchable:"Layer is not searchable",layer_not_querable:"Layer is not querable",autocomplete:{inputshort:{pre:"Please enter",post:"or more characters"}}},print:{no_layers:"No Layer to print",template:"Template",labels:"Labels",scale:"Scale",format:"Format",rotation:"Rotation",download_image:"Download Image",fids_instruction:"Values accepted: from 1 to value of [max]. Is possible to insert a range ex. 4-6",fids_example:"Ex. 1,4-6 will be printed id 1,4,5,6",help:"The layers shown in the print could be those defined on the project and not those displayed on the map"},querybuilder:{search:{run:"Run",info:"Information","delete":"Delete",edit:"Edit"},messages:{changed:"Saved",number_of_features:"Number of features"},panel:{button:{all:"ALL",save:"SAVE",test:"TEST",clear:"CLEAR",run:"RUN",manual:"MANUAL"},layers:"LAYERS",fields:"FIELDS",values:"VALUES",operators:"OPERATORS",expression:"EXPRESSION"},error_run:"An error occurs. Please check the query",error_test:"An error occur during query execution","delete":"Do you want delete it?",additem:"Insert the name of the new search"},errors:{layers:{load:"Some layers are not available"},unsupported_format:"Not supported format",add_external_layer:"Load layer error"},metadata:{title:"Metadata",groups:{general:{title:"GENERAL",fields:{title:"TITLE",name:"NAME",description:"DESCRIPTION","abstract":"ABSTRACT",keywords:"KEYWORDS",fees:"FEES",accessconstraints:"ACCESS CONSTRAINT",contactinformation:"CONTACTS",subfields:{contactinformation:{contactelectronicmailaddress:"Email",personprimary:"References",contactvoicetelephone:"Phone",contactorganization:"Organization",ContactOrganization:"Organization",contactposition:"Position",ContactPosition:"Position",contactperson:"Person",ContactPerson:"Person"}},wms_url:"WMS"}},spatial:{title:"SPATIAL",fields:{crs:"EPSG",extent:"BBOX"}},layers:{title:"LAYERS",fields:{layers:"LAYERS",subfields:{crs:"EPSG",bbox:"BBOX",title:"TITLE",name:"NAME",geometrytype:"GEOMETRY",source:"SOURCE",attributes:"ATTRIBUTES","abstract":"ABSTRACT",attribution:"ATTRIBUTION",keywords:"PAROLE CHIAVE",metadataurl:"METADATA URL",dataurl:"DATA URL"}},groups:{general:"GENERAL",spatial:"SPATIAL"}}}},tooltips:{relations:{form_to_row:"Row View",row_to_form:"Form View"},copy_map_extent_url:"Copy map view link",download_shapefile:"Download Shapefile",download_gpx:"Download GPX",download_gpkg:"Download GPKG",download_csv:"Download CSV",download_xls:"Download XLS",show_chart:"Show Chart",atlas:"Print Atlas"},mapcontrols:{query:{tooltip:"Query layer",actions:{add_selection:{hint:"Add/Remove Selection"},zoom_to_features_extent:{hint:"Zoom to features extent"},add_features_to_results:{hint:"Add/Remove features to results"},remove_feature_from_results:{hint:"Remove feature from results"},zoom_to_feature:{hint:"Zoom to feature"},relations:{hint:"Show Relations"},relations_charts:{hint:"Show relations chart"},download_features_shapefile:{hint:"Download features Shapefile"},download_shapefile:{hint:"Download feature Shapefile"},download_features_gpx:{hint:"Download feature GPX"},download_features_gpkg:{hint:"Download features GPKG"},download_gpx:{hint:"Download feature GPX"},download_gpkg:{hint:"Download feature GPKG"},download_features_csv:{hint:"Download features CSV"},download_csv:{hint:"Download feature CSV"},download_features_xls:{hint:"Download features XLS"},download_xls:{hint:"Download feature XLS"},atlas:{hint:"Print Atlas"},copy_zoom_to_fid_url:{hint:"Copy map URL with this geometry feature extension",hint_change:"Copied"}}},querybypolygon:{download:{title:"Attributes download",choiches:{feature:{label:"Features only"},feature_polygon:{label:"Features+Query Polygon"}}},tooltip:"Query By Polygon",no_geometry:"No geometry on response",help:{title:"Guide - Query By Polygon",message:"\n                <ul>\n                  <li>Select a polygon layer on TOC.</li>\n                  <li>Be sure that layer is visible.</li>\n                  <li>Click on a feature of selected layer.</li>\n                </ul>"}},querybydrawpolygon:{tooltip:"Query by Draw Polygon "},querybybbox:{tooltip:"Query BBox layer",nolayers_visible:"No querable layers are visible. Please set at least one visible wfs layer to run query",help:{title:"Guide - Query BBox layer",message:"\n                  <ul>\n                  <li>Draw a square on map to query underlined layers on TOC</li>\n                  </ul>"}},addlayer:{messages:{csv:{warning:"The result in the map is partial due to the presence of the below incorrect records list:"}},tooltip:"Add Layer"},geolocation:{tooltip:"Geolocation"},measures:{length:{tooltip:"Length",help:"Click on map to draw the line. Press <br>CANC if you want delete last vertex"},area:{tooltip:"Area",help:"Click to draw poligon.Press <br>CANC if you want delete last vertex"}},scale:{no_valid_scale:"Invalid Scale"},scaleline:{units:{metric:"Meters",nautical:"Nautical Mile"}},zoomhistory:{zoom_last:"Zoom Last",zoom_next:"Zoom Next"}},relations:{relation_data:"Relation data",no_relations_found:"No relations found",back_to_relations:"Back to relations",list_of_relations_feature:"List of relations of feature",error_missing_father_field:"Field is missing"},workflow:{steps:{title:"Steps"},next:"Next"},form:{loading:"Loading ...",inputs:{messages:{errors:{picklayer:"No feature selected. Check if layer is on editing or visible at current scale"}},tooltips:{picklayer:"Get value from ma layer",lonlat:"Click on map to get coordinates"},input_validation_mutually_exclusive:"Field mutually exclusive with ",input_validation_error:"Mandatory Field or wrong data type",input_validation_min_field:"Value has to be more/equal to field value  ",input_validation_max_field:"Value has to be less/equal to field value ",input_validation_exclude_values:"Value has to be unique",integer:"integer",bigint:"integer",text:"text",varchar:"text",textarea:"text",string:"string",date:"date",datetime:"date","float":"float",table:"table"},footer:{required_fields:"Required fields"},messages:{qgis_input_widget_relation:"Use relation specific form to work with relation"}},catalog:{current_map_theme_prefix:"THEME",choose_map_theme:"CHOOSE THEME",menu:{layerposition:"Layer Position",setwmsopacity:"Set Opacity",wms:{title:"",copy:"Click here to copy url",copied:"Copied"},download:{unknow:"Download",shp:"Download Shapefile",gpx:"Download GPX",gpkg:"Download GPKG",csv:"Download CSV",xls:"Download XLS",geotiff:"Download GEOTIFF",geotiff_map_extent:"Download GEOTIFF(current view extent)"}}},wps:{list_process:"List of process",tooltip:"Click on map"}},credits:{g3wSuiteFramework:"Application based on OS framework",g3wSuiteDescription:"Publish and manage your QGIS projects on the web",productOf:"Framework developed by"},toggle_color_scheme:"Toggle color scheme",logout:"Logout",no_other_projects:"No more project for this group",no_other_groups:"No more groups for this Macrogroup",yes:"Yes",no:"No",back:"Back",backto:"Back to ",changemap:"Change Map",change_session:"Change Session",component:"Generic Component",search:"Search",no_results:"No results found",print:"Print",create_print:"Create Print",dosearch:"Search",catalog:"Map",data:"Data",externalwms:"WMS",baselayers:"Base",tools:"Tools",tree:"Layers",legend:"Legend",nobaselayer:"No basemap",street_search:"Find Address",show:"Show",hide:"Hide",copy_form_data:"Copy data",paste_form_data:"Paste",copy_form_data_from_feature:"Copy data from map",error_map_loading:"Error occurs loading map",check_internet_connection_or_server_admin:"Check internet connection or contact admin",could_not_load_vector_layers:"Connection error: Layers can be loaded",server_saver_error:"Error in server saving",server_error:"Server connection error",save:"Save",cancel:"Cancel",close:"Close",dont_show_again:"Don't show again",enlange_reduce:"Enlarge / Reduce",reset_default:"Default size",add:"Add",exitnosave:"Exit without save",annul:"Cancel",layer_is_added:"Layer with same name already added",sidebar:{wms:{panel:{title:"Add WMS Layer",label:{position:"Map Position",name:"Name",projections:"Projection",layers:"Layers"}},add_wms_layer:"Add WMS layer",delete_wms_url:"Delete WMS url",layer_id_already_added:"WMS Layer already added",url_already_added:"WMS URL/Name already added",layer_add_error:"WMS Layer not added. Please check all wms parameter or url"}},info:{title:"Results",list_of_relations:"List of Relations",open_link:"Open attached document",server_error:"An error occurred from server",no_results:"No results found for this query/search",link_button:"Open"},mapcontrols:{geolocations:{error:"Can't get your position"},nominatim:{placeholder:"Address ...",noresults:"No results",notresponseserver:"No response from server"},add_layer_control:{header:"Add Layer",select_projection:"Select layer projection",select_field_to_show:"Select Field to show on map",select_csv_separator:"Select delimiter",select_csv_x_field:"Select X field",select_csv_y_field:"Select Y field",select_color:"Select Layer Color",drag_layer:"Drag and drop layer here"},query:{input_relation:"Click to show relations"},length:{tooltip:"Length"},area:{tooltip:"Area"},screenshot:{error:"Screenshot error creation",securityError:'  \n        <p><b>Security Error</b>: an external layer is preventing map from being printed. To check, proceed as follows:</p>\n        <ol>\n          <li>remove any manually added external layers (eg. WMS layers)</li>\n          <li>force page reload: <code>CTRL + F5</code></li>\n          <li>print again the map</li>\n        </ol>\n        <p>For more info please contact server administrator about: <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image" style="color: #000 !important;font-weight: bold;">&#x2139;&#xFE0F; security and tainted canvases</a></p>\n        '}},catalog_items:{helptext:"Right-click on individual layer to access additional features",contextmenu:{zoomtolayer:"Zoom to Layer",open_attribute_table:"Open Attribute Table",show_metadata:"Metadata",styles:"Styles",vector_color_menu:"Set/Change Color",layer_opacity:"Opacity"}},dataTable:{previous:"Previous",next:"Next",lengthMenu:"Show _MENU_",info:"Showing _START_ to _END_ of _TOTAL_ entries",no_data:"No data",nodatafilterd:"No matching records found",infoFiltered:"(filtered from _MAX_ total records)"}}}},{}],331:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={translation:{error_page:{error:"Yhteysvirhe",at_moment:"Tällä hetkellä ei ole mahdollista näyttää karttaa",f5:"Paina Ctrl+F5"},cookie_law:{message:"This website uses cookies to ensure you get the best experience on our website.",buttonText:"Got It!"},"default":"oletuksena",sign_in:"Kirjaudu sisään",layer_selection_filter:{tools:{filter:"Lisätä/Poista Suodattaa",nofilter:"Poista Suodattaa",invert:"Käänteinen Valinta",clear:"Peruuttaa Valinta",show_features_on_map:"Näytä kartalla näkyvät ominaisuudet"}},warning:{not_supported_format:"Not supported format"},layer_position:{top:"TOP",bottom:"BOTTOM",message:"Position relative to layers on TOC"},sdk:{atlas:{template_dialog:{title:"Valitse Template"}},spatialbookmarks:{title:"Tilalliset kirjanmerkit",helptext:"Siirry kartan laajuuteen, lisää nimi ja napsauta Lisää",input:{name:"Nimi"},sections:{project:{title:"Projektin kirjanmerkit"},user:{title:"Käyttäjän kirjanmerkit"}}},search:{all:"KAIKKI",no_results:"Ei tuloksia",searching:"Haetaan ...",error_loading:"Virhe ladattaessa tietoja.",layer_not_searchable:"Taso ei ole haettavissa.",layer_not_querable:"Tasolle ei voi suorittaa kyselyitä.",autocomplete:{inputshort:{pre:"Syötä",post:"tai useampi merkki"}}},print:{no_layers:"Ei tulostettavia tasoja",template:"Template",labels:"Labels",scale:"Mittakaava",format:"Formaatti",rotation:"Kierto",download_image:"Lataa kuva",fids_instruction:"Hyväksytyt arvot: yhdestä arvoon [max]. Salittua syöttää myös väli, esim. 4-6.",fids_example:"Esimerkiksi 1,4-6 tulostuu id 1,4,5,6.",help:"Tulosteessa esiintyvät tasot voivat olla projektissa määriteltyjä ei kartalla esiintyviä."},querybuilder:{search:{run:"Suorita",info:"Informaatio","delete":"Poista",edit:"Muokkaa"},messages:{changed:"Tallennettu",number_of_features:"Ominaisuuksien lukumäärä"},panel:{button:{all:"KAIKKI",save:"TALLENNA",test:"TESTI",clear:"TYHJENNÄ",run:"SUORITA",manual:"MANUAALINEN"},layers:"TASOT",fields:"KENTÄT",values:"ARVOT",operators:"OPERAATTORIT",expression:"LAUSEKE"},error_run:"Tapahtui virhe. Tarkista kysely.",error_test:"Kyselyä suorittaessa tapahtui virhe.","delete":"Haluatko poistaa sen?",additem:"Anna nimi uudelle haulle."},errors:{layers:{load:"Jotkin tasot eivät ole saatavilla."},unsupported_format:"Ei tuettu formaatti",add_external_layer:"Tason latausvirhe"},metadata:{title:"Metatiedot",groups:{general:{title:"YLEINEN",fields:{title:"OTSIKKO",name:"NIMI",description:"KUVAUS","abstract":"TIIVISTELMÄ",keywords:"AVAINSANAT",fees:"MAKSUT",accessconstraints:"PÄÄSYRAJOITUKSET",contactinformation:"YHTEYSTIEDOT",subfields:{contactinformation:{contactelectronicmailaddress:"Sähköposti",personprimary:"Viitteet",contactvoicetelephone:"Puhelin",contactorganization:"Organisaatio",ContactOrganization:"Organisaatio",contactposition:"Asema",ContactPosition:"Asema",contactperson:"Yhteyshenkilö",ContactPerson:"Yhteyshenkilö"}},wms_url:"WMS"}},spatial:{title:"SPATIAL",fields:{crs:"EPSG",extent:"BBOX"}},layers:{title:"TASOT",fields:{layers:"TASOT",subfields:{crs:"EPSG",bbox:"BBOX",title:"OTSIKKO",name:"NIMI",geometrytype:"GEOMETRIA",source:"LÄHDE",attributes:"ATTRIBUUTIT","abstract":"TIIVISTELMÄ",attribution:"ATTRIBUUTIO",keywords:"AVAINSANAT",metadataurl:"METATIEDON URL",dataurl:"DATA URL"}},groups:{general:"YLEINEN",spatial:"SPATIAL"}}}},tooltips:{relations:{form_to_row:"Rivinäkymä",row_to_form:"Taulukkonäkymä"},copy_map_extent_url:"Kopioi kartan katselulinkki",download_shapefile:"Lataa SHP-tiedosto",download_gpx:"Lataa GPX-tiedosto",download_gpkg:"Lataa GPKG-tiedosto",download_csv:"Lataa CSV-tiedosto",download_xls:"Lataa XLS-tiedosto",show_chart:"Näytä kaavio",atlas:"Tulosta Atlas"},mapcontrols:{query:{tooltip:"Kyselytaso",actions:{add_selection:{hint:"Lisää/Poista valinta"},zoom_to_features_extent:{hint:"Tarkenna ominaisuuden laajuuteen"},add_features_to_results:{hint:"Add/Remove features to results"},remove_feature_from_results:{hint:"Remove feature from results"},zoom_to_feature:{hint:"Tarkenna ominaisuuteen"},relations:{hint:"Näytä relaatiot"},relations_charts:{hint:"Näytä relaatiokaavio"},download_features_shapefile:{hint:"Lataa ominaisuuden SHP-tiedosto"},download_shapefile:{hint:"Lataa ominaisuuden SHP-tiedosto"},download_features_gpx:{hint:"Lataa ominaisuuden GPX-tiedosto"},download_features_gpkg:{hint:"Lataa ominaisuuden GPKG-tiedosto"},download_gpx:{hint:"Lataa ominaisuuden GPX-tiedosto"},download_gpkg:{hint:"Lataa ominaisuuden GPKG-tiedosto"},download_features_csv:{hint:"Lataa ominaisuuden CSV-tiedosto"},download_csv:{hint:"Lataa ominaisuuden CSV-tiedosto"},download_features_xls:{hint:"Lataa ominaisuuden XLS-tiedosto"},download_xls:{hint:"Lataa ominaisuuden XLS-tiedosto"},atlas:{hint:"Tulosta Atlas"},copy_zoom_to_fid_url:{hint:"Copy map URL with this geometry feature extension",hint_change:"Copied"}}},querybypolygon:{download:{title:"Attributes download",choiches:{feature:{label:"Features only"},feature_polygon:{label:"Features+Query Polygon"}}},tooltip:"Kysely monikulmiolla",no_geometry:"No geometry on response",help:{title:"Ohje - Kysely monikulmiolla",message:"\n                <ul>\n                  <li>Valitse monikulmiotaso luettelosta.</li>\n                  <li>Tarkista, että taso on näkyvillä.</li>\n                  <li>Valitse ominaisuus valitulla tasolla.</li>\n                </ul>"}},querybydrawpolygon:{tooltip:"Kysely piirtopolygonin mukaan"},querybybbox:{tooltip:"Tasoon kohdituva BBox-kysely",nolayers_visible:"Ei kyseltäviä tasoja näkyvillä. Aseta vähintään yksi WFS-taso näkyväksi suorittaaksesi haun.",help:{title:"Ohje - Tasoon kohdistuva BBox-kysely",message:"\n                 <ul>\n                  <li>Piirrä suorakulmio kartalle suorittaaksesi kyselyn luettelossa alleviivatuille tasoille.</li>\n                 </ul>"}},addlayer:{messages:{csv:{warning:"The result in the map is partial due to the presence of the below incorrect records list:"}},tooltip:"Lisää taso"},geolocation:{tooltip:"Maantieteellinen sijainti"},measures:{length:{tooltip:"Pituus",help:"Piirrä murtoviiva kartalle. Paina <br>CANC, mikäli haluat poistaa edellisen pisteen."},area:{tooltip:"Alue",help:"Piirrä monikulmio kartalle. Paina <br>CANC, mikäli haluat poistaa edellisen pisteen."}},scale:{no_valid_scale:"Väärä mittakaava"},scaleline:{units:{metric:"Meters",nautical:"Nautical Mile"}},zoomhistory:{zoom_last:"Zoom Edellinen",zoom_next:"Zoom Seurata"}},relations:{relation_data:"Relaation tiedot",no_relations_found:"Relaatiota ei löytynyt.",back_to_relations:"Takaisin relaatioihin",list_of_relations_feature:"Lista ominaisuuden relaatioista",error_missing_father_field:"Kenttä puuttu"},workflow:{steps:{title:"Vaiheet"},next:"Seuraava"},form:{loading:"Ladataan...",inputs:{messages:{errors:{picklayer:"Ominaisuuksia ei valiitu. Tarkista, että taso on muokattavissa tai näkyvissä nykyisellä mittakaavalla."}},tooltips:{picklayer:"Valitse arvo karttatasolta",lonlat:"Click on map to get coordinates"},input_validation_mutually_exclusive:"Kenttä toisensa poissulkeva.",input_validation_error:"Pakollinen kenttä tai väärä tietotyyppi.",input_validation_min_field:"Arvon tulee olla suurempi tai yhtäsuuri kuin kentän arvo.",input_validation_max_field:"Arvon tulee olla pienempi tai yhtäsuuri kuin kentän arvo.",input_validation_exclude_values:"Arvon tulee olla uniikki.",integer:"kokonaisluku",bigint:"kokonaisluku",text:"teksti",varchar:"teksti",textarea:"teksti",string:"merkkijono",date:"päiväys",datetime:"päiväys","float":"liukuluku",table:"taulukko"},footer:{required_fields:"Vaaditut kentät"},messages:{qgis_input_widget_relation:"Käytä relaatioiden määrittämiseen tähän tarkoitettua toimintoa"}},catalog:{current_map_theme_prefix:"THEME",choose_map_theme:"CHOOSE THEME",menu:{layerposition:"Layer Position",setwmsopacity:"Set Opacity",wms:{title:"",copy:"Paina tästä kopioidaksesi url:n.",copied:"Kopioitu."},download:{unknow:"Lataa",shp:"Lataa SHP-tiedosto",gpx:"Lataa GPX-tiedosto",gpkg:"Lataa GPKG-tiedosto",csv:"Lataa CSV-tiedosto",xls:"Lataa XLS-tiedosto",geotiff:"Lataa GEOTIFF-tiedosto",geotiff_map_extent:"Lataa GEOTIFF-tiedosto(current view extent)"}}},wps:{list_process:"Lista prosesseista",tooltip:"Valitse kartalta"}},credits:{g3wSuiteFramework:"Sovellus perustuu OS framework",g3wSuiteDescription:"Julkaise ja hallinnoi QGIS-projekteja verkossa.",productOf:"Frameworkin on kehittänyt"},toggle_color_scheme:"Toggle color scheme",logout:"Kirjaudu ulos",no_other_projects:"Ei projekteja tälle ryhmälle",no_other_groups:"Ei enää ryhmiä tälle makroryhmälle",yes:"Kyllä",no:"Ei",back:"Palaa",backto:"Takaisin ",changemap:"Vaihda karttaa",change_session:"Vaihda istuntoa",component:"Yleinen komponentti",search:"Hae",no_results:"Ei hakutuloksia",print:"Tulosta",create_print:"Luo tuloste",dosearch:"Hae",catalog:"Kartta",data:"Data",externalwms:"WMS",baselayers:"Taustakartta",tools:"Työkalut",tree:"Tasot",legend:"Merkintöjen selite",nobaselayer:"Ei taustakarttaa",street_search:"Hae osoite",show:"Näytä",hide:"Piilota",copy_form_data:"Kopioi tiedot",
paste_form_data:"Liitä",copy_form_data_from_feature:"Kopioi tiedot kartalta",error_map_loading:"Virhe ladattessa karttaa",check_internet_connection_or_server_admin:"Tarkista internetyhteys tai ota yhteyttä ylläpitäjään.",could_not_load_vector_layers:"Yhteysvirhe, tasoja ei voida ladata.",server_saver_error:"Virhe tallentaessa palvelimelle.",server_error:"Yhteysvirhe palvelimeen",save:"Tallenna",cancel:"Peruuta",close:"Sulje",dont_show_again:"Älä näytä viestiä uudelleen",enlange_reduce:"Suurenna / Pienennä",reset_default:"Oletuskoko",add:"Lisää",exitnosave:"Poistu tallentamatta",annul:"Peruuta",layer_is_added:"Samanniminen taso on jo lisätty.",sidebar:{wms:{panel:{title:"Add WMS Layer",label:{position:"Map Position",name:"Name",projections:"Projection",layers:"Layers"}},add_wms_layer:"Aggiungi WMS layer",delete_wms_url:"Delete WMS url",layer_id_already_added:"WMS Taso on jo lisätty.",url_already_added:"WMS URL/Nimi on jo lisätty.",layer_add_error:"WMS Layer not added. Please check all wms parameter or url"}},info:{title:"Tulokset",list_of_relations:"List of Relations",open_link:"Avaa liitetiedosto",server_error:"Palvelimella tapahtui virhe.",no_results:"Ei tuloksia haulle/kyselylle.",link_button:"Avaa"},mapcontrols:{geolocations:{error:"Sijaintiasi ei saada"},nominatim:{placeholder:"Osoite ...",noresults:"Ei tuloksia",notresponseserver:"Ei vastausta palvelimelta"},add_layer_control:{header:"Lisää taso",select_projection:"Valitse tason projektio",select_field_to_show:"Select Field to show on map",select_csv_separator:"Select delimiter",select_csv_x_field:"Select X field",select_csv_y_field:"Select Y field",select_color:"Valitse tason väri",drag_layer:"Vedä ja pudota taso tähän"},query:{input_relation:"Paina näyttääksesi relaatiot"},length:{tooltip:"Pituus"},area:{tooltip:"Pinta-ala"},screenshot:{error:"Screenshot error creation",securityError:'  \n        <p><b>Turvallisuusvirhe</b>: ulkoinen kerros estää karttaa tulostamasta. Tarkistaaksesi, toimi seuraavasti:</p>\n        <ol>\n          <li>poista manuaalisesti lisätyt ulkoiset tasot (esim. WMS-tasot)</li>\n          <li>Pakota sivun uudelleenlataus: <code>CTRL + F5</code></li>\n          <li>tulosta kartta uudelleen</li>\n        </ol>\n        <p>Saat lisätietoja palvelimen järjestelmänvalvojalta seuraavista aiheista: <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image" style="color: #000 !important;font -paino: lihavoitu;">&#x2139;&#xFE0F; turvallisuus ja likaiset kankaat</a></p>\n        '}},catalog_items:{helptext:"Napsauta hiiren kakkospainikkeella yksittäistä tasoa päästäksesi lisäominaisuuksiin.",contextmenu:{zoomtolayer:"Tarkenna tasoon",open_attribute_table:"Avaa attribuuttitaulu",show_metadata:"Metatiedot",styles:"Tyylejä",vector_color_menu:"Aseta/muuta väriä",layer_opacity:"Peittävyys"}},dataTable:{previous:"Edellinen",next:"Seuraava",lengthMenu:"Show _MENU_ items",info:"Showing _START_ to _END_ of _TOTAL_ entries",no_data:"Ei tietoja",nodatafilterd:"Vastaavia tietueita ei löytynyt",infoFiltered:"(filtered from _MAX_ total records)"}}}},{}],332:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={translation:{error_page:{error:"Erreur de connexion",at_moment:"Pour le moment, il n'est pas possible d'afficher la carte",f5:"Appuyez sur Ctrl+F5"},cookie_law:{message:"Ce site utilise des cookies pour assurer une bonne convivialité pour l'utilisateur final.",buttonText:"J’ai compris !"},"default":"par défaut ",sign_in:"Se connecter ",layer_selection_filter:{tools:{filter:"Ajout/Suppression de filtre ",nofilter:"Supprimer le filtre ",invert:"Sélection inversée ",clear:"Effacer la sélection ",show_features_on_map:"Afficher les caractéristiques visibles sur la carte"}},warning:{not_supported_format:"Not supported format"},layer_position:{top:"TOP",bottom:"BOTTOM",message:"Position relative to layers on TOC"},sdk:{atlas:{template_dialog:{title:"Sélectionnez Template"}},spatialbookmarks:{title:"Signets spatiaux",helptext:"Déplacez-vous sur l'étendue de la carte, insérez le nom et cliquez sur Ajouter",input:{name:"Nom"},sections:{project:{title:"Signets du projet"},user:{title:"Signets de l'utilisateur"}}},search:{all:"TOUTES",no_results:"Aucune valeur trouvée",searching:"Je cherche...",error_loading:"Erreur de chargement des valeurs",layer_not_searchable:"Le layer n’est pas recherchable",layer_not_querable:"Le layer n'est pas interrogeable",autocomplete:{inputshort:{pre:"Tapez au moins",post:"caractères"}}},print:{no_layers:"Aucune layer visible",scale:"Échelle",format:"Format",rotation:"Rotation",download_image:"Télécharger l'image",fids_instruction:"Valeurs acceptées : de 1 à la valeur maximale indiquée par [max]. Il est également possible d'indiquer une fourchette de valeurs, par exemple 4-6",fids_example:"Par exemple 1,4-6 les ids 1,4,5,6 seront imprimés",help:"Les layers montrés dans l'impression peuvent être ceux définis dans le projet et non ceux montrés sur la carte"},querybuilder:{search:{run:"Lancer la recherche",info:"Information","delete":"Supprimer",edit:"Editer"},messages:{changed:"Enregistré correctement",number_of_features:"Nombre de fonctionnalités"},panel:{button:{all:"TOUTES",save:"SAUVEGARDER",test:"TESTER",clear:"NETTOYER",run:"EXECUTER",manual:"MANUEL"},layers:"LAYERS",fields:"CHAMPS",values:"VALEURS",operators:"OPERATEURS",expression:"EXPRESSION"},error_run:"Une erreur s'est produite. Vérifiez si la requête est correcte",error_test:"Erreur d'exécution de la requête","delete":"Voulez-vous confirmer la suppression ?",additem:"Entrer le nom de la requête"},errors:{layers:{load:"Certaines layers du projet ne sont pas disponibles actuellement et n'apparaissent donc pas dans la vue actuelle"},unsupported_format:"Format non supporté",add_external_layer:"Erreur lors du chargement du layer"},metadata:{title:"Métadonnées",groups:{general:{title:"GÉNÉRAL",fields:{title:"TITRE",name:"NOM",description:"DESCRIPTION","abstract":"ABREGE",keywords:"LISTE DE MOTS-CLÉS",fees:"DROITS D'INSCRIPTION",accessconstraints:"CONTRAINTES D'ACCÈS",contactinformation:"CONTACTS",subfields:{contactinformation:{contactelectronicmailaddress:"E-mail",personprimary:"Références",contactvoicetelephone:"Téléphone",contactorganization:"Organisation",ContactOrganization:"Organisation",contactposition:"Localisation",ContactPosition:"Localisation",contactperson:"Personne",ContactPerson:"Personne"}},wms_url:"WMS"}},spatial:{title:"INFO ESPACE",fields:{crs:"EPSG",extent:"BBOX"}},layers:{title:"STRATES",groups:{general:"GENERALE",spatial:"INFO ESPACE"},fields:{layers:"STRATES",subfields:{crs:"EPSG",bbox:"BBOX",title:"TITRE",name:"NOM",geometrytype:"GÉOMÉTRIE",source:"SOURCE",attributes:"ATTRIBUTES","abstract":"ABRÉGÉ",attribution:"ATTRIBUTION",keywords:"MOTS- CLÉS",metadataurl:"URL DE MÉTADONNÉES",dataurl:"URL DES DONNÉES"}}}}},tooltips:{relations:{form_to_row:"Afficher le format de la ligne",row_to_form:"Format du formulaire d'affichage"},zoom_to_features_extent:"Zoom sur les fonctionnalités",copy_map_extent_url:"Copier le lien de visualisation de la carte",download_shapefile:"Télécharger le fichier Shapefile",download_gpx:"Télécharger GPX",download_gpkg:"Télécharger GPKG",download_csv:"Télécharger CSV",download_xls:"Télécharger XLS",show_chart:"Montrer graphique",atlas:"Imprimer l'Atlas"},mapcontrols:{query:{tooltip:"Interrogation layer",actions:{add_selection:{hint:"Ajouter/supprimer une sélection"},zoom_to_features_extent:{hint:"Zoom sur les fonctionnalités"},add_features_to_results:{hint:"Ajouter des fonctionnalités aux résultats"},remove_feature_from_results:{hint:"Supprimer la fonctionnalité des résultats"},zoom_to_feature:{hint:"Zoom sur les fonctionnalités"},relations:{hint:"Voir les relations"},relations_charts:{hint:"Voir les graphiques de relations"},download_features_shapefile:{hint:"Télécharger les fonctionnalités vers Shapefile"},download_shapefile:{hint:"Télécharger le Shapefile"},download_features_gpx:{hint:"Télécharger les fonctionnalités vers GPX"},download_features_gpkg:{hint:"Télécharger les fonctionnalités vers GPKG"},download_gpx:{hint:"Télécharger le GPX"},download_gpkg:{hint:"Télécharger le GPKG"},download_features_csv:{hint:"Télécharger les fonctionnalités vers CSV"},download_csv:{hint:"Télécharger le CSV"},download_features_xls:{hint:"Télécharger les fonctionnalités vers XLS"},download_xls:{hint:"Télécharger le XLS"},atlas:{hint:"Imprimer l'Atlas"},copy_zoom_to_fid_url:{hint:"Copier l'URL de la carte avec l'extension vers cette géométrie",hint_change:"Copié"}}},querybypolygon:{download:{title:"Téléchargement des attributs",choiches:{feature:{label:"Fonctionnalités seulement"},feature_polygon:{label:"Fonctionnalités+Requête Polygon "}}},tooltip:"Requête par polygone",no_geometry:"La réponse ne contient pas de géométrie",help:{title:"Aide - Requête par polygone",message:"\n                <ul>\n                  <li>Sélectionnez un layer de polygone dans la légende.</li>\n                  <li>Vérifiez que le layer est visible dans la carte.</li>\n                  <li>Cliquez sur une géométrie du layer sélectionné.</li>\n                </ul>"}},querybydrawpolygon:{tooltip:"Requête par polygone de dessin"},querybybbox:{tooltip:"Requête pour BBOX",nolayers_visible:"Aucun layer requêtable n'est visible. Assurez-vous qu'au moins un layer wfs est visible pour exécuter la requête",help:{title:"Aide - Requête BBox",message:"\n                  <ul>\n                    <li>Dessinez un rectangle pour interroger les couches surlignées en jaune</li>\n                 </ul>\n            "}},addlayer:{messages:{csv:{warning:"Le résultat de la carte est partiel en raison de la présence des enregistrements incorrects suivants :"}},tooltip:"Ajouter un layer"},geolocation:{tooltip:"Géolocalisation"},measures:{length:{tooltip:"Longueur",help:"Cliquez sur la carte pour continuer à dessiner la ligne.<br>CANC si vous voulez supprimer le dernier vertex inséré"},area:{tooltip:"Zone",help:"Cliquez pour continuer à dessiner le polygone.<br>CANC si vous voulez supprimer le dernier vertex inséré"}},scale:{no_valid_scale:"Échelle invalide"},scaleline:{units:{metric:"Meters",nautical:"Nautical Mile"}},zoomhistory:{zoom_last:"Zoom Précédent",zoom_next:"Zoom Suivant"}},relations:{relation_data:"Données relationnelles",no_relations_found:"Aucune relation trouvée",back_to_relations:"Retour aux relations",list_of_relations_feature:"Liste des relations entre les caractéristiques",error_missing_father_field:"Le champ concerné n'existe pas"},workflow:{steps:{title:"Étapes"},next:"Suivant"},form:{loading:"Chargement...",inputs:{messages:{errors:{picklayer:"Aucune fonction sélectionnée. Vérifier si le layer est en édition ou non visible à l'échelle actuelle"}},tooltips:{picklayer:"Obtenir la valeur de la carte",lonlat:"Cliquez sur la carte pour obtenir les coordonnées"},input_validation_mutually_exclusive:"Champ mutuellement exclusif avec ",input_validation_error:"Champ obligatoire ou type de valeur incorrect",input_validation_min_field:"La valeur doit être supérieure ou égale au camp ",input_validation_max_field:"La valeur doit être inférieure ou égale au champ ",input_validation_exclude_values:"Le champ doit contenir une valeur différente",integer:"entier",bigint:"entier",text:"textuel",varchar:"textuel",textarea:"textuel",string:"chaîne",date:"date",datetime:"date","float":"float",table:"table"},footer:{required_fields:"Champs obligatoires"},messages:{qgis_input_widget_relation:"Gérer les relations via un formulaire dédié"}},catalog:{current_map_theme_prefix:"THEME",choose_map_theme:"SÉLECTIONNEZ LE THÈME",menu:{layerposition:"Layer Position",setwmsopacity:"Set Opacity",wms:{title:"",copy:"Cliquez ici pour copier l'url",copied:"Copié"},download:{unknow:"Télécharger",shp:"Télécharger Shapefile",gpx:"Télécharger GPX",gpkg:"Télécharger GPKG",csv:"Télécharger CSV",xls:"Télécharger XLS",geotiff:"Télécharger GEOTIFF",geotiff_map_extent:"Télécharger GEOTIFF(current view extent)"}}},wps:{list_process:"Liste des processus",tooltip:"Cliquez sur la carte"}},credits:{g3wSuiteFramework:"Application construite avec le framework OS",g3wSuiteDescription:"Publiez et gérez vos projets QGIS sur le Web",productOf:"Framework développé par"},logout:"Quitter",no_other_projects:"Il n'y a pas d'autres projets dans ce groupe de cartes",no_other_groups:"Il n'y a pas d'autres groupes dans ce macrogroupe",yes:"Oui",no:"No",back:"Retour",backto:"Retour à ",changemap:"Changer de carte",change_session:"Changer de séance",component:"Composant générique",search:"Recherches",no_results:"Aucun résultat trouvé",print:"Imprimer",create_print:"Créer une impression",dosearch:"Recherche",catalog:"Carte",data:"Données",externalwms:"WMS",baselayers:"Bases",tools:"Outils",tree:"Strates",legend:"Légende",nobaselayer:"Pas de carte de base",street_search:"Adresse de recherche",show:"Afficher",hide:"Cacher",copy_form_data:"Copier les données du formulaire",paste_form_data:"Coller",copy_form_data_from_feature:"Copier les données de la carte",error_map_loading:"Erreur de chargement de la nouvelle carte",check_internet_connection_or_server_admin:"Vérifiez la connexion internet ou contactez l'administrateur",could_not_load_vector_layers:"Erreur de connexion au serveur : il n'a pas été possible de charger les vecteurs demandés",server_saver_error:"Erreur de sauvegarde sur le serveur",server_error:"Une erreur s'est produite dans la requête au serveur",save:"Sauvegarder",cancel:"Supprimer",close:"Fermer",dont_show_again:"Ne plus afficher ce message",enlange_reduce:"Agrandir / Réduire",reset_default:"Taille par défaut",add:"Ajouter",exitnosave:"Quitter sans sauvegarder",annul:"Annuler",layer_is_added:"Layer avec le même nom déjà ajouté",wms_layer_id_already_added:"WMS Layer déjà ajouté",wms_url_already_added:"WMS URL déjà ajouté",sidebar:{wms:{panel:{title:"Add WMS Layer",label:{position:"Map Position",name:"Name",projections:"Projection",layers:"Layers"}},add_wms_layer:"Add WMS layer",delete_wms_url:"Delete WMS url",layer_id_already_added:"WMS Nivån har redan lagts till.",url_already_added:"WMS URL/Nom har redan lagts till.",layer_add_error:"WMS Layer not added. Please check all wms parameter or url"}},info:{title:"Résultats",list_of_relations:"List of Relations",open_link:"Ouvrir le document joint",server_error:"Une erreur s'est produite dans la requête au serveur",no_results:"Aucun résultat pour cette requête/recherche",link_button:"Ouvrir"},mapcontrols:{geolocations:{title:"",error:"Votre position ne peut être calculée."},nominatim:{placeholder:"Adresse ...",noresults:"Aucun résultat",notresponseserver:"Le serveur ne répond pas"},add_layer_control:{header:"Ajouter un layer",select_projection:"Sélectionnez le système de projection de couches",select_field_to_show:"Sélectionnez le champ à afficher sur la carte",select_csv_separator:"Sélectionner le séparateur",select_csv_x_field:"Sélectionnez le champ X",select_csv_y_field:"Sélectionnez le champ Y",select_color:"Sélectionnez la couleur du layer",drag_layer:"Faire glisser le layer vers cette zone"},query:{input_relation:"Cliquez pour voir les relations"},length:{tooltip:"Longueur"},area:{tooltip:"Zone"},screenshot:{error:"Erreur de création de la capture d'écran",securityError:'  \n        <p><b>Erreur de sécurité</b> : une couche externe empêche l\'impression de la carte. Pour vérifier, procédez comme suit :</p>\n        <ol>\n          <li>supprimer toutes les couches externes ajoutées manuellement (par exemple, les couches WMS)</li>\n          <li>forcer le rechargement de la page : <code>CTRL + F5</code></li>\n          <li>imprimer à nouveau la carte</li>\n        </ol>\n        <p>Pour plus d\'informations, veuillez contacter l\'administrateur du serveur à propos de : <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image" style="color: #000 !important;font -poids : gras ;">&#x2139;&#xFE0F; sécurité et toiles souillées</a></p>\n        '}},catalog_items:{helptext:"Cliquez avec le bouton droit de la souris sur les différents layers pour accéder à des fonctionnalités supplémentaires",contextmenu:{zoomtolayer:"Zoom sur le layer",open_attribute_table:"Table d'attributs ouverte",show_metadata:"Métadonnées",styles:"Styles",vector_color_menu:"Définir/changer la couleur",layer_opacity:"Opacité"}},dataTable:{previous:"Précédent",next:"Suivant",lengthMenu:"Afficher _MENU_",info:"Afficher _START_ à _END_ sur _TOTAL_ lignes",nodatafilterd:"Aucun résultat trouvé",infoFiltered:"(Filtré par _MAX_ rangs totaux)"}}}},{}],333:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("./it"),a=n(i),o=e("./en"),s=n(o),l=e("./fi"),u=n(l),c=e("./se"),d=n(c),f=e("./fr"),p=n(f),h=e("./de"),v=n(h),g=e("./ro"),m=n(g),y={it:a["default"],en:s["default"],fi:u["default"],se:d["default"],fr:p["default"],de:v["default"],ro:m["default"]};r["default"]=y},{"./de":329,"./en":330,"./fi":331,"./fr":332,"./it":334,"./ro":335,"./se":336}],334:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={translation:{error_page:{error:"Errore di connessione",at_moment:"Al momento non è possibile caricare la mappa",f5:"Premi Ctrl+F5"},cookie_law:{message:"Questo sito utilizza i cookie per garantire una buona usabilità all'utilizzatore finale.",buttonText:"Ho capito!"},"default":"predefinito",sign_in:"Accedi",layer_selection_filter:{tools:{filter:"Aggiungi/Rimuovi Filtro",nofilter:"Rimuovi filtro",invert:"Inverti Selezione",clear:"Annulla selezione",show_features_on_map:"Mostra features visibili su mappa"}},warning:{not_supported_format:"Formato non supportato"},layer_position:{top:"SOPRA",bottom:"IN FONDO",message:"Posizione rispetto ai layers della TOC"},sdk:{atlas:{template_dialog:{title:"Seleziona Template"}},spatialbookmarks:{title:"Segnalibri Spaziali",helptext:"Posizionati all'estensione del tuo nuovo segnalibro, definisci il nome e clicca Aggiungi",input:{name:"Nome"},sections:{project:{title:"Segnalibri Progetto"},user:{title:"Segnalibri Utente"}}},search:{all:"TUTTE",no_results:"Nessun valore trovato",searching:"Sto cercando ..",error_loading:"Errore nel caricamento valori",layer_not_searchable:"Il layer non è ricercabile",layer_not_querable:"Il layer non è interrogabile",autocomplete:{inputshort:{pre:"Digita almeno",post:"caratteri"}}},print:{no_layers:"Nessun Layer visibile",template:"Template",labels:"Etichette",scale:"Scala",format:"Formato",rotation:"Rotazione",download_image:"Scarica Immagine",fids_instruction:"Valori accettati: da 1 al valore massimo indicato da [max]. Possibile indicare anche range di valori es. 4-6",fids_example:"Es. 1,4-6 verranno stampati gli id 1,4,5,6",help:"I layers mostrati nella stampa potrebbero essere quelli definiti sul progetto e non quelli visualizzati sulla mappa"},querybuilder:{search:{run:"Lancia ricerca",info:"Informazioni","delete":"Cancella",edit:"Modifica"},messages:{changed:"Salvato correttamente",number_of_features:"Numero di features"},panel:{button:{all:"TUTTI",save:"SALVA",test:"TEST",clear:"PULISCI",run:"ESEGUI",manual:"MANUALE"},layers:"LAYERS",fields:"CAMPI",values:"VALORI",operators:"OPERATORI",expression:"ESPRESSIONE"},error_run:"Si è verificato un errore. Verificare se la query è corretta",error_test:"Errore nell'esecuzione della query","delete":"Vuoi confermare la cancellazione?",additem:"Inserisci nome della ricerca"},errors:{layers:{load:"Alcuni layers presenti nel progetto non sono attualmente disponibili e quindi non compaiono nell'attuale visualizzazione"},unsupported_format:"Formato non supportato",add_external_layer:"Errore nel caricamento del layer"},metadata:{title:"Metadati",groups:{general:{title:"GENERALE",fields:{title:"TITOLO",name:"NOME",description:"DESCRIZIONE","abstract":"ABSTRACT",keywords:"LISTA DELLE PAROLE CHIAVE",fees:"CANONI",accessconstraints:"VINCOLI DI ACCESSO",contactinformation:"CONTATTI",subfields:{contactinformation:{contactelectronicmailaddress:"E-mail",personprimary:"Riferimenti",contactvoicetelephone:"Telefono",contactorganization:"Organizzazione",ContactOrganization:"Organizzazione",contactposition:"Posizione",ContactPosition:"Posizione",contactperson:"Persona",ContactPerson:"Persona"}},wms_url:"WMS"}},spatial:{title:"INFO SPAZIALI",fields:{crs:"EPSG",extent:"BBOX"}},layers:{title:"STRATI",groups:{general:"GENERALE",spatial:"INFO SPAZIALI"},fields:{layers:"STRATI",subfields:{crs:"EPSG",bbox:"BBOX",title:"TITOLO",name:"NOME",geometrytype:"GEOMETRIA",source:"SORGENTE",attributes:"ATTRIBUTI","abstract":"ABSTRACT",attribution:"ATTRIBUTION",keywords:"PAROLE CHIAVE",metadataurl:"METADATA URL",dataurl:"DATA URL"}}}}},tooltips:{relations:{form_to_row:"Visualizza formato Riga",row_to_form:"Visualizza formato Form"},zoom_to_features_extent:"Zoom sulle features",copy_map_extent_url:"Copia map view link",download_shapefile:"Scarica Shapefile",download_gpx:"Scarica GPX",download_gpkg:"Scarica GPKG",download_csv:"Scarica CSV",download_xls:"Scarica XLS",show_chart:"Mostra Grafico",atlas:"Stampa Atlas"},mapcontrols:{query:{tooltip:"Interroga Layer",actions:{add_selection:{hint:"Aggiungi/Rimuovi Selezione"},zoom_to_features_extent:{hint:"Zoom sulle features"},add_features_to_results:{hint:"Aggiungi features ai risultati"},remove_feature_from_results:{hint:"Rimuovi feature dai risultati"},zoom_to_feature:{hint:"Zoom sulla feature"},relations:{hint:"Visualizza Relazioni"},relations_charts:{hint:"Visualizza grafici relazioni"},download_features_shapefile:{hint:"Scarica features in Shapefile"},download_shapefile:{hint:"Scarica feature in Shapefile"},download_features_gpx:{hint:"Scarica features in GPX"},download_features_gpkg:{hint:"Scarica features in GPKG"},download_gpx:{hint:"Scarica feature in GPX"},download_gpkg:{hint:"Scarica feature in GPKG"},download_features_csv:{hint:"Scarica features in CSV"},download_csv:{hint:"Scarica feature in CSV"},download_features_xls:{hint:"Scarica features in XLS"},download_xls:{hint:"Scarica la feature in XLS"},atlas:{hint:"Stampa Atlas"},copy_zoom_to_fid_url:{hint:"Copia URL mappa con estensione a questa geometria",hint_change:"Copiato"}}},querybypolygon:{download:{title:"Download attributi",choiches:{feature:{label:"Solo features"},feature_polygon:{label:"Features+Poligono Interrogazione"}}},tooltip:"Interroga per poligono",no_geometry:"Non contiene la geometria nella risposta",help:{title:"Guida - Interrogazione con Poligono",message:"\n                <ul>\n                  <li>Seleziona uno strato poligonale in legenda.</li>\n                  <li>Assicurati che lo strato sia visibile in mappa.</li>\n                  <li>Clicca su una geometria dello strato selezionato.</li>\n                </ul>"}},querybydrawpolygon:{tooltip:"Disegna un poligono per interrogare"},querybybbox:{tooltip:"Interroga per BBOX",nolayers_visible:"Nessun layer interrogabile è visibile. Assicurarsi che almeno un layer wfs sia visibile per eseguire l'interrogazione",help:{title:"Guida - Interrogazione BBox",message:"\n                  <ul>\n                    <li>Disegna un rettangolo per interrogare gli strati evidenziati in giallo</li>\n                  </ul>\n            "}},addlayer:{messages:{csv:{warning:"Il risultato in mappa è parziale a causa della presenza dei seguenti records non corretti:"}},tooltip:"Aggiungi Layer"},geolocation:{tooltip:"Geolocalizzazione"},measures:{length:{tooltip:"Lunghezza",help:"Clicca sulla mappa per continuare a disegnare la linea.<br>CANC se si vuole cancellare l'ultimo vertice inserito"},area:{tooltip:"Area",help:"Clicca per continuare a disegnare il poligono.<br>CANC se si vuole cancellare l'ultimo vertice inserito"}},scale:{no_valid_scale:"Scala non valida"},scaleline:{units:{metric:"Metri",nautical:"Miglio Nautico"}},zoomhistory:{zoom_last:"Zoom Precedente",zoom_next:"Zoom Successivo"}},relations:{relation_data:"Dati Relazione",no_relations_found:"Nessuna relazione trovata",back_to_relations:"Ritorna alle relazioni",list_of_relations_feature:"Lista delle relazioni della feature",error_missing_father_field:"Il campo relazionato non esiste"},workflow:{steps:{title:"Passi"},next:"Avanti"},form:{loading:"Caricamento ...",inputs:{messages:{errors:{picklayer:"Nessuna feature selezionata. Verificare se il layer è in editing o non visibile alla scala attuale"}},tooltips:{picklayer:"Prendi valore dalla mappa",lonlat:"Clicca sulla mappa per prendere le coordinate"},input_validation_mutually_exclusive:"Campo mutualmente esclusivo con ",input_validation_error:"Campo obbligatorio o tipo valore non corretto",input_validation_min_field:"Valore deve essere magiore uguale a quello del camp ",input_validation_max_field:"Valore deve essere minore uguale a quello del campo ",input_validation_exclude_values:"Campo deve contenere un valore diverso",integer:"intero",bigint:"intero",text:"testuale",varchar:"testuale",textarea:"testuale",string:"stringa",date:"data",datetime:"data","float":"float",table:"table"},footer:{required_fields:"Campi obbligatori"},messages:{qgis_input_widget_relation:"Gestisci le relazioni tramite form dedicato"}},catalog:{current_map_theme_prefix:"TEMA",choose_map_theme:"SCEGLI TEMA",menu:{layerposition:"Posizione Layer",setwmsopacity:"Cambia opacità",wms:{title:"",copy:"Clicca qui per copiare url",copied:"Copiato"},download:{unknow:"Scarica",shp:"Scarica Shapefile",gpx:"Scarica GPX",gpkg:"Scarica GPKG",csv:"Scarica CSV",xls:"Scarica XLS",geotiff:"Scarica GEOTIFF",geotiff_map_extent:"Scarica GEOTIFF(estensione vista corrente)"}}},wps:{list_process:"Lista dei processi",tooltip:"Clicca sulla mappa"}},credits:{g3wSuiteFramework:"Applicativo realizzato con il framework OS",g3wSuiteDescription:"Pubblica e gestisci i tuoi progetti QGIS sul Web",productOf:"Framework sviluppato da"},toggle_color_scheme:"Cambia colore",logout:"Esci",no_other_projects:"Nu există alte proiecte în acest grup de hărți",no_other_groups:"Nu există alte grupuri în acest grup de macrocomenzi",yes:"Si",no:"No",back:"Indietro",backto:"Torna a ",changemap:"Cambia Mappa",change_session:"Cambia Sessione",component:"Componente Generico",search:"Ricerche",no_results:"Nessun risultato trovato",print:"Stampa",create_print:"Crea Stampa",dosearch:"Cerca",catalog:"Mappa",data:"Dati",externalwms:"WMS",baselayers:"Basi",tools:"Strumenti",tree:"Strati",legend:"Legenda",nobaselayer:"Nessuna mappa di base",street_search:"Cerca indirizzo",show:"Mostra",hide:"Nascondi",copy_form_data:"Copia i dati del modulo",paste_form_data:"Incolla",copy_form_data_from_feature:"Copia i dati dalla mappa",error_map_loading:"Errore di caricamento della nuova mappa",check_internet_connection_or_server_admin:"Controllare la connessione internet o contattare l'amministratore",could_not_load_vector_layers:"Errore di connessione al server: non è stato possibile caricare i vettoriali richiesti",server_saver_error:"Errore nel salvataggio sul server",server_error:"Si è verificato un errore nella richiesta al server",save:"Salva",cancel:"Cancella",close:"Chiudi",dont_show_again:"Non mostrare più",enlange_reduce:"Allarga / Riduci",reset_default:"Dimensione predefinita",add:"Aggiungi",exitnosave:"Esci senza salvare",annul:"Annulla",layer_is_added:"Layer con stesso nome già aggiunto",sidebar:{wms:{panel:{title:"Aggiungi WMS Layer",label:{position:"Posizione su Mappa",name:"Nome",projections:"Sistema di riferimento",layers:"Layers"}},add_wms_layer:"Aggiungi WMS layer",delete_wms_url:"Elimina WMS url",layer_id_already_added:"WMS Layer già aggiunto",url_already_added:"WMS URL/Nome già aggiunto",layer_add_error:"WMS Layer non aggiunto. Verificare i parametri o l'url"}},info:{title:"Risultati",list_of_relations:"Lista delle relazioni",open_link:"Apri documento allegato",server_error:"Si è verificato un errore nella richiesta al server",no_results:"Nessun risultato per questa interrogazione/ricerca ",link_button:"Apri"},mapcontrols:{geolocations:{title:"",error:"Non è possibile calcolare la tua posizione."},nominatim:{placeholder:"Indirizzo ...",noresults:"Nessun risultato",notresponseserver:"Il server non risponde"},add_layer_control:{header:"Aggiungi Layer",select_projection:"Seleziona il sistema di proiezione del layer",select_field_to_show:"Seleziona il campo da visualizzare sulla mappa",select_csv_separator:"Seleziona il separatore",select_csv_x_field:"Seleziona il campo X",select_csv_y_field:"Seleziona il campo Y",select_color:"Seleziona il colore del Layer",drag_layer:"Trascina il layer in questa area"},query:{input_relation:"Clicca per consultare le relazioni"},length:{tooltip:"Lunghezza"},area:{tooltip:"Area"},screenshot:{error:"Errore nella creazione dello screenshot",securityError:'  \n        <p><b>Errore di sicurezza</b>: uno strato esterno impedisce la stampa della mappa. Per verificare, procedere come segue:</p>\n        <ol>\n          <li>rimuovi eventuali layer esterni aggiunti manualmente (es. layer WMS)</li>\n          <li>forza il ricaricamento della pagina: <code>CTRL + F5</code></li>\n          <li>stampa nuovamente la mappa</li>\n        </ol>\n        <p>Per maggiori informazioni contattare l\'amministratore del server in merito a: <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image" style="color: #000 !important;font-weight: bold;">&#x2139;&#xFE0F; security and tainted canvases</a></p>\n        '}},catalog_items:{helptext:"Tasto destro sui singoli layer per accedere alle funzionalità aggiuntive",contextmenu:{zoomtolayer:"Zoom to Layer",open_attribute_table:"Apri tabella attributi",show_metadata:"Metadati",styles:"Stili",vector_color_menu:"Setta/Cambia Colore",layer_opacity:"Trasparenza"}},dataTable:{previous:"Precedente",next:"Successivo",lengthMenu:"Visualizza _MENU_",info:"Visualizzazione _START_ a _END_ su _TOTAL_ righe",nodatafilterd:"Nessun risultato trovato",infoFiltered:"(Filtrati da _MAX_ total righe)"}}}},{}],335:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={translation:{error_page:{error:"Eroare de conexiune",at_moment:"Momentan nu este posibil să afișați harta",f5:"Apăsați Ctrl+F5"},cookie_law:{message:"Acest website foloseste cookie-uri pentru a furniza vizitatorilor o experiență mult mai bună de navigare",buttonText:"Am înțeles!"},"default":"Implicit",sign_in:"Logare",layer_selection_filter:{tools:{filter:"Adăugare/Eliminare Filtrare",nofilter:"Eliminare Filtrare",invert:"Inversare Selecție",clear:"Elimină Selecția",show_features_on_map:"Arată entitățile vizibile în cadrul hărții"}},warning:{not_supported_format:"Formatul nu este acceptat"},layer_position:{top:"SUS",bottom:"JOS",message:"Poziție relativă la straturile din TOC"},sdk:{atlas:{template_dialog:{title:"Selectați Template"}},spatialbookmarks:{title:"Marcaje spațiale",helptext:"Deplasați-vă pe întinderea hărții, introduceți numele și faceți clic pe Adăugați",input:{name:"Nume"},sections:{project:{title:"Marcaje de proiect"},user:{title:"Marcaje utilizator"}}},search:{all:"Toate",no_results:"Fără rezultat",searching:"Căutare ...",error_loading:"Încărcarea a eșuat",layer_not_searchable:"Nu se poate căuta pe strat",layer_not_querable:"Stratul nu se poate interoga",autocomplete:{inputshort:{pre:"Te rog introdu",post:"sau mai multe caractere"}}},print:{no_layers:"Nu avem straturi de print",template:"Șablon",labels:"Etichete",scale:"Scară",format:"Format",rotation:"Rotație",download_image:"Descarcă Imaginea",fids_instruction:"Valori acceptate: de la 1 la valoarea [max]. Este posibilă inserarea de interval, de ex. 4-6",fids_example:"Ex. 1,4-6 vor fi tipărite id 1,4,5,6",help:"Straturile prezentate în print pot fi acelea definite în proiect și nu acelea prezentate în cadrul hărții"},querybuilder:{search:{run:"Execută",info:"Info","delete":"Elimină",edit:"Modifică"},messages:{changed:"Salvat",number_of_features:"Număr de entități"},panel:{button:{all:"TOATE",save:"SALVEAZĂ",test:"TEST",clear:"ȘTERGE",run:"RUN",manual:"MANUAL"},layers:"STRATURI",fields:"CÂMPURI",values:"VALORI",operators:"OPERATORI",expression:"EXPRESII"},error_run:"A survenit o eroare. De verificat interogarea",
error_test:"A survenit o eroare în timp ce se executa interogarea","delete":"Vrei să o ștergi?",additem:"Introdu numele noii căutări"},errors:{layers:{load:"Câteva straturi nu sunt disponibile"},unsupported_format:"Formatul nu este acceptat",add_external_layer:"Eroare încărcare strat"},metadata:{title:"Metadate",groups:{general:{title:"GENERALITĂȚI",fields:{title:"TITLU",name:"NUME",description:"DESCRIERE","abstract":"ABSTRACT",keywords:"CUVINTE CHEIE",fees:"TAXE",accessconstraints:"CONSTRÂNGERI DE ACCES",contactinformation:"CONTACTE",subfields:{contactinformation:{contactelectronicmailaddress:"Email",personprimary:"Referințe",contactvoicetelephone:"Telefon",contactorganization:"Organizație",ContactOrganization:"Organizație",contactposition:"Poziție",ContactPosition:"Poziție",contactperson:"Persoana",ContactPerson:"Persoana"}},wms_url:"WMS"}},spatial:{title:"SPAȚIAL",fields:{crs:"EPSG",extent:"BBOX"}},layers:{title:"STRATURI",fields:{layers:"STRATURI",subfields:{crs:"EPSG",bbox:"BBOX",title:"TITLU",name:"NUME",geometrytype:"GEOMETRIE",source:"SURSA",attributes:"ATRIBUTE","abstract":"ABSTRACT",attribution:"ATRIBUIRE",keywords:"CUVINTE CHEIE",metadataurl:"URL METADATE",dataurl:"URL DATE"}},groups:{general:"GENERALITĂȚI",spatial:"SPAȚIAL"}}}},tooltips:{relations:{form_to_row:"Vizualizare pe rânduri",row_to_form:"Vizualizare formular"},copy_map_extent_url:"Copiază linkul de vizualizare hartă",download_shapefile:"Descarcă Shapefile",download_gpx:"Descarcă GPX",download_gpkg:"Descarcă GPKG",download_csv:"Descarcă CSV",download_xls:"Descarcă XLS",show_chart:"Arată Diagrama",atlas:"Tipărire Atlas"},mapcontrols:{query:{tooltip:"Interogare strat",actions:{add_selection:{hint:"Adaugă/Elimină Selecția"},zoom_to_features_extent:{hint:"Zoom la încadrarea entităților"},add_features_to_results:{hint:"Adaugă/Elimină entități rezultat"},remove_feature_from_results:{hint:"Elimină entitate din rezultat"},zoom_to_feature:{hint:"Zoom la entitate"},relations:{hint:"Arată Relațiile"},relations_charts:{hint:"Arată diagrama de relații"},download_features_shapefile:{hint:"Descarcă entități în Shapefile"},download_shapefile:{hint:"Descarcă entitate în Shapefile"},download_features_gpx:{hint:"Descarcă entități în GPX"},download_features_gpkg:{hint:"Descarcă entități în GPKG"},download_gpx:{hint:"Descarcă entitate în GPX"},download_gpkg:{hint:"Descarcă entitate în GPKG"},download_features_csv:{hint:"Descarcă entități în CSV"},download_csv:{hint:"Descarcă entitate în CSV"},download_features_xls:{hint:"Descarcă entități în XLS"},download_xls:{hint:"Descarcă entitate în XLS"},atlas:{hint:"Tipărire Atlas"},copy_zoom_to_fid_url:{hint:"Copiază URL hartă cu întinderea geometriei entității",hint_change:"Copiat"}}},querybypolygon:{download:{title:"Descărcare atribute",choiches:{feature:{label:"Doar entități"},feature_polygon:{label:"Entități+Poligon Interogare"}}},tooltip:"Interogare După Poligon",no_geometry:"Nu avem geometrii în răspuns",help:{title:"Ghid - Interogare După Poligon",message:"\n                <ul>\n                  <li>Selectează un strat poligon din TOC.</li>\n                  <li>Asigură-te că stratul este vizibil.</li>\n                  <li>Click pe o entitate a stratului selectat.</li>\n                </ul>"}},querybydrawpolygon:{tooltip:"Interogare prin poligon de desen"},querybybbox:{tooltip:"Interogare BBox strat",nolayers_visible:"Nu este vizibil niciun strat de interogare. Trebuie setat cel puțin un strat WFS vizibil pentru a efectua interogarea",help:{title:"Ghid - Interogare BBox strat",message:"\n                 <ul>\n                  <li>Desenează un pătrat pe hartă pentru a interoga straturile din TOC de sub </li>\n                 </ul>"}},addlayer:{messages:{csv:{warning:"Rezultateul pe hartă este parțial datorită prezenței următoarei liste de rezultate incorecte:"}},tooltip:"Adaugă Strat"},geolocation:{tooltip:"Geolocalizare"},measures:{length:{tooltip:"Lungime",help:"Click pe hartă pentru a desena linia. Apasă <br>CANC dacă dorești să ștergi ultimul vertex"},area:{tooltip:"Aria",help:"Click pentru desen poligon. Apasă <br>CANC dacă dorești să ștergi ultimul vertex"}},scale:{no_valid_scale:"Scară Invalidă"},scaleline:{units:{metric:"Metri",nautical:"Mile Nautice"}},zoomhistory:{zoom_last:"Zoom Anterior",zoom_next:"Zoom Urmatorul"}},relations:{relation_data:"Date Relații",no_relations_found:"Nu am găsit nicio relație",back_to_relations:"Înapoi la relații",list_of_relations_feature:"Lista de relații a entității",error_missing_father_field:"Câmpul de legătură lipsește"},workflow:{steps:{title:"Pași"},next:"Următorul"},form:{loading:"Se încarcă ...",inputs:{messages:{errors:{picklayer:"Nu avem entitate selectată. Verifică dacă stratul este în editare sau vizibil la scara curentă if layer is on editing or visible at current scale"}},tooltips:{picklayer:"Ia valoare din strat",lonlat:"Click pe hartă pentru a prelua coordonate"},input_validation_mutually_exclusive:"Câmp ce se exclude mutual cu ",input_validation_error:"Câmp mandatoriu sau tip de date greșit",input_validation_min_field:"Valoarea trebuie să fie mai mare/egală cu valoare câmpului ",input_validation_max_field:"Valoarea trebuie să fie mai mică/egală cu valoare câmpului ",input_validation_exclude_values:"Valoarea trebuie să fie unică",integer:"integer - nr. întreg",bigint:"integer - nr. întreg",text:"text",varchar:"text",textarea:"text",string:"string - text",date:"data",datetime:"data","float":"float - nr. cu zecimale",table:"tabelă"},footer:{required_fields:"Câmpuri necesare"},messages:{qgis_input_widget_relation:"Folosește formular specific de relații pentru a lucra cu relația"}},catalog:{current_map_theme_prefix:"TEMA",choose_map_theme:"ALEGE TEMA",menu:{layerposition:"Poziție Strat",setwmsopacity:"Alege Opacitatea",wms:{title:"Titlu",copy:"Click pentru copiere URL",copied:"Copiat"},download:{unknow:"Descarcă",shp:"Descarcă Shapefile",gpx:"Descarcă GPX",gpkg:"Descarcă GPKG",csv:"Descarcă CSV",xls:"Descarcă XLS",geotiff:"Descarcă GEOTIFF",geotiff_map_extent:"Descarcă GEOTIFF(ce se vede în cadrul hărții)"}}},wps:{list_process:"Lista de procese",tooltip:"Click pe hartă"}},credits:{g3wSuiteFramework:"Aplicație bazată pe frameworkul",g3wSuiteDescription:"Publică și administrează proiectele de QGIS pe WEB",productOf:"Framework dezvoltat de"},toggle_color_scheme:"Comutare schemă de culori",logout:"Deconectare",no_other_projects:"No more project for this group",no_other_groups:"Nu mai sunt grupuri pentru acest macrogrup",yes:"Da",no:"Nu",back:"Înapoi",backto:"Înapoi la ",changemap:"Schimbare Hartă",change_session:"Schimbați sesiunea",component:"Componentă Generică",search:"Căutare",no_results:"Niciun rezultat găsit",print:"Tipărire",create_print:"Tipărește",dosearch:"Caută",catalog:"Hartă",data:"Data",externalwms:"WMS",baselayers:"Straturi Bază",tools:"Instrumente",tree:"Straturi",legend:"Legendă",nobaselayer:"Fără strat de bază",street_search:"Caută Adresă",show:"Arată",hide:"Ascunde",copy_form_data:"Copiază data",paste_form_data:"Lipește",copy_form_data_from_feature:"Copiază data din hartă",error_map_loading:"Sunt erori la încărcarea hărții",check_internet_connection_or_server_admin:"Verificați conexiune de internet sau contactați administratorul de sistem",could_not_load_vector_layers:"Eroare de conexiune: Straturile nu pot fi încărcate",server_saver_error:"Eroare la salvarea pe server",server_error:"Eroare de conexiune la server",save:"Salvează",cancel:"Anulează",close:"Închide",dont_show_again:"Nu mai afișa mesajul",enlange_reduce:"Mărește / Micșorează",reset_default:"Mărimea implicită",add:"Adaugă",exitnosave:"Ieșire fără salvare",annul:"Anulează",layer_is_added:"Există un strat cu același nume deja adăugat",sidebar:{wms:{panel:{title:"Adaugă strat WMS",label:{position:"Poziție Hartă",name:"Nume",projections:"Proiecție",layers:"Straturi"}},add_wms_layer:"Adaugă strat WMS",delete_wms_url:"Șterge URL WMS",layer_id_already_added:"Strat WMS deja adăugat",url_already_added:"URL WMS/Nume deja adăugat",layer_add_error:"Stratul WMS nu s-a adăugat. Verificați URL-ul sau parametrii WMS"}},info:{title:"Rezultate",list_of_relations:"List of Relations",open_link:"Deschide document atașat",server_error:"Serverul a întâmpinat o eroare",no_results:"Niciun rezultat",link_button:"Deschide"},mapcontrols:{geolocations:{error:"Nu te-am putut localiza"},nominatim:{placeholder:"Adresa ...",noresults:"Niciun rezultat",notresponseserver:"Niciun răspuns de la server"},add_layer_control:{header:"Adăugare Strat",select_projection:"Selectează proiecția strat",select_field_to_show:"Selectează câmpul de arătat pe hartă",select_csv_separator:"Selectează delimitatorul",select_csv_x_field:"Selectează câmpul X - Est",select_csv_y_field:"Selectează câmpul Y - Nord",select_color:"Selectează culoare strat",drag_layer:"Trageți stratul aici (Drag&Drop)"},query:{input_relation:"Click pentru a arăta relațiile"},length:{tooltip:"Lungime"},area:{tooltip:"Arie"},screenshot:{error:"Eroare captură ecran",securityError:'  \n        <p><b>Eroare de securitate</b>: un strat extern împiedică imprimarea hărții. Pentru a verifica, procedați după cum urmează:</p>\n        <ol>\n          <li>eliminați orice straturi externe adăugate manual (de exemplu, straturi WMS)</li>\n          <li>forțați reîncărcarea paginii: <code>CTRL + F5</code></li>\n          <li>tipărește din nou harta</li>\n        </ol>\n        <p>Pentru mai multe informații, vă rugăm să contactați administratorul serverului despre: <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image" style="color: #000 !important;font -greutate: bold;">&#x2139;&#xFE0F; securitate și pânze contaminate</a></p>\n        '}},catalog_items:{helptext:"Click dreapta pe strat pentru a accesa opțiuni",contextmenu:{zoomtolayer:"Zoom pe Strat",open_attribute_table:"Deschide Tabela Atribute",show_metadata:"Metadate",styles:"Stiluri",vector_color_menu:"Setează/Schimbă Culoare",layer_opacity:"Opacitate"}},dataTable:{previous:"Anteriorul",next:"Următorul",lengthMenu:"Arată _MENU_",info:"Arată _START_ până la _END_ din _TOTAL_ de intrări",no_data:"Fără date",nodatafilterd:"Niciun rezultat",infoFiltered:"(filtrat din _MAX_ de rezultate totale)"}}}},{}],336:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={translation:{error_page:{error:"Anslutningsfel",at_moment:"För närvarande är inte möjligt visa karta",f5:"Tryck på Ctrl+F5"},cookie_law:{message:"This website uses cookies to ensure you get the best experience on our website.",buttonText:"Got It!"},"default":"standard",sign_in:"Logga in",layer_selection_filter:{tools:{filter:"Lägg till/Avlägsna Filtrera",nofilter:"Avlägsna Filtrera",invert:"Invertera Urval",clear:"Annullera Urval",show_features_on_map:"Visa funktioner som är synliga på kartan"}},warning:{not_supported_format:"Not supported format"},layer_position:{top:"TOP",bottom:"BOTTOM",message:"Position relative to layers on TOC"},sdk:{atlas:{template_dialog:{title:"Välj Template"}},spatialbookmarks:{title:"Rumsliga bokmärken",helptext:"Flytta på kartans omfattning, ange namn och klicka på Lägg till",input:{name:"Namn"},sections:{project:{title:"Projektbokmärken"},user:{title:"Användarbokmärken"}}},search:{all:"ALLA",no_results:"Inga resultat",searching:"Sökning ...",error_loading:"Fel vid laddning av uppgifter.",layer_not_searchable:"Nivån kan inte sökas.",layer_not_querable:"Förfrågningar kan inte göras på nivån.",autocomplete:{inputshort:{pre:"Mata in",post:"eller flera tecken"}}},print:{no_layers:"Inga nivåer att skriva ut",template:"Template",labels:"Labels",scale:"Skala",format:"Format",rotation:"Rotation",download_image:"Ladda ner bild",fids_instruction:"Godkända värden: Från ett till värdet [max]. Mellanslag tillåts, t.ex. 4-6.",fids_example:"Exempelvis 1,4-6 skriver ut id 1,4,5,6.",help:"Nivåerna på utskriften kan vara specificerade i ett projekt inte sådana som visas på karta."},querybuilder:{search:{run:"Utför",info:"Information","delete":"Ta bort",edit:"Redigera"},messages:{changed:"Sparat",number_of_features:"Antal funktione"},panel:{button:{all:"ALLA",save:"SPARA",test:"TEST",clear:"TÖM",run:"UTFÖR",manual:"MANUELL"},layers:"NIVÅER",fields:"FÄLT",values:"VÄRDEN",operators:"OPERATÖRER",expression:"KLAUSUL"},error_run:"Ett fel inträffade. Kontrollera förfrågan.",error_test:"Ett fel inträffade när förfrågan utfördes.","delete":"Vill du ta bort den?",additem:"Ge den nya sökningen ett namn."},errors:{layers:{load:"Vissa nivåer är inte tillgängliga."},unsupported_format:"Formatet stöds inte",add_external_layer:"Fel vid laddning av nivån"},metadata:{title:"Metadata",groups:{general:{title:"ALLMÄN",fields:{title:"RUBRIK",name:"NAMN",description:"BESKRIVNING","abstract":"SAMMANDRAG",keywords:"NYCKELORD",fees:"AVGIFTER",accessconstraints:"ÅTKOMSTBEGRÄNSNINGAR",contactinformation:"KONTAKTUPPGIFTER",subfields:{contactinformation:{contactelectronicmailaddress:"E-post",personprimary:"Referenser",contactvoicetelephone:"Telefon",contactorganization:"Organisation",ContactOrganization:"Organisation",contactposition:"Ställning",ContactPosition:"Ställning",contactperson:"Kontaktperson",ContactPerson:"Kontaktperson"}},wms_url:"WMS"}},spatial:{title:"SPATIAL",fields:{crs:"EPSG",extent:"BBOX"}},layers:{title:"NIVÅER",fields:{layers:"NIVÅER",subfields:{crs:"EPSG",bbox:"BBOX",title:"RUBRIK",name:"NAMN",geometrytype:"GEOMETRI",source:"KÄLLA",attributes:"ATTRIBUT","abstract":"SAMMANDRAG",attribution:"TILLSKRIVNING",keywords:"NYCKELORD",metadataurl:"METADATA URL",dataurl:"DATA URL"}},groups:{general:"ALLMÄN",spatial:"SPATIAL"}}}},tooltips:{relations:{form_to_row:"Radvy",row_to_form:"Tabellvy"},copy_map_extent_url:"Kopiera länk till karta",download_shapefile:"Ladda SHP-fil",download_gpx:"Ladda GPX-fil",download_gpkg:"Ladda GPKG-fil",download_csv:"Ladda CSV-fil",download_xls:"Ladda XLS-fil",show_chart:"Visa diagram",atlas:"Skriv ut Atlas"},mapcontrols:{query:{tooltip:"Förfrågningsnivå",actions:{add_selection:{hint:"Lägg till/Avlägsna Urval"},zoom_to_features_extent:{hint:"Zooma till egenskapens omfattning"},add_features_to_results:{hint:"Add/Remove features to results"},remove_feature_from_results:{hint:"Remove feature from results"},zoom_to_feature:{hint:"Zooma till egenskapen"},relations:{hint:"Visa relationerna"},relations_charts:{hint:"Visa relationsdiagrammet"},download_features_shapefile:{hint:"Ladda egenskapens SHP-fil"},download_shapefile:{hint:"Ladda egenskapens SHP-fil"},download_features_gpx:{hint:"Ladda egenskapens GPX-fil"},download_features_gpkg:{hint:"Ladda egenskapens GPKG-fil"},download_gpx:{hint:"Ladda egenskapens GPX-fil"},download_gpkg:{hint:"Ladda egenskapens GPKG-fil"},download_features_csv:{hint:"Ladda egenskapens CSV-fil"},download_csv:{hint:"Ladda egenskapens CSV-fil"},download_features_xls:{hint:"Ladda egenskapens XLS-fil"},download_xls:{hint:"Ladda egenskapens XLS-fil"},atlas:{hint:"Skriv ut Atlas"},copy_zoom_to_fid_url:{hint:"Copy map URL with this geometry feature extension",hint_change:"Copied"}}},querybypolygon:{download:{title:"Attributes download",choiches:{feature:{label:"Features only"},feature_polygon:{label:"Features+Query Polygon"}}},tooltip:"Förfrågan med polygon",no_geometry:"No geometry on response",help:{title:"Ohje - Förfrågan med polygon",message:"\n                <ul>\n                  <li>Välj polygonnivå i listan.</li>\n                  <li>Kontrollera att nivån är synlig.</li>\n                  <li>Välj egenskap på önskad nivå.</li>\n                </ul>"}},querybydrawpolygon:{tooltip:"Fråga efter ritpolygon"},querybybbox:{tooltip:"BBox-förfrågan som riktar sig till en nivå",nolayers_visible:"Inga nivåer som förfrågningar kan riktas till. Gör minst en WFS-nivå synlig för att kunna utföra sökningen.",help:{title:"Ohje - BBox-förfrågan som riktar sig till nivån",message:"\n                 <ul>\n                  <li>Rita upp en rektangel på kartan för att utföra förfrågan på de i listan understreckade nivåerna.</li>\n                 </ul>"}},addlayer:{messages:{csv:{warning:"The result in the map is partial due to the presence of the below incorrect records list:"}},tooltip:"Lägg till nivå"},geolocation:{tooltip:"Geografiskt läge"},measures:{length:{tooltip:"Längd",help:"Rita upp en bruten linje på kartan. Tryck <br>CANC, om du vill ta bort föregående punkt."},area:{tooltip:"Område",help:"Rita upp en polygon på kartan. Tryck <br>CANC, om du vill ta bort föregående punkt."}},scale:{no_valid_scale:"Fel skala"},scaleline:{units:{metric:"Meters",nautical:"Nautical Mile"}},zoomhistory:{zoom_last:"Zoom Föregående",zoom_next:"Zoom Nästa"}},relations:{relation_data:"Relationsuppgifter",no_relations_found:"Inga relationer hittades.",back_to_relations:"Tillbaka till relationerna",list_of_relations_feature:"Lista på egenskapens relationer",error_missing_father_field:"Fält saknas"},workflow:{steps:{title:"Skeden"},next:"Nästa"},form:{loading:"Laddning...",inputs:{messages:{errors:{picklayer:"Inga egenskaper har valts. Kontroller att nivån kan redigeras eller att den syns med nuvarande skala."}},tooltips:{picklayer:"Välj värde på kartnivå",lonlat:"Click on map to get coordinates"},input_validation_mutually_exclusive:"Fälten utesluter varandra.",input_validation_error:"Obligatoriskt fält eller fel datatyp.",input_validation_min_field:"Värdet ska vara större eller lika stort som värdet i fältet.",input_validation_max_field:"Värdet ska vara mindre eller lika stort som värdet i fältet.",input_validation_exclude_values:"Värdet ska vara unikt.",integer:"heltal",bigint:"heltal",text:"text",varchar:"text",textarea:"text",string:"teckensträng",date:"datum",datetime:"datum","float":"flyttal",table:"tabell"},footer:{required_fields:"Obligatoriska fält"},messages:{qgis_input_widget_relation:"Använd den specifika funktinen för att bestämma relationer"}},catalog:{current_map_theme_prefix:"THEME",choose_map_theme:"CHOOSE THEME",menu:{layerposition:"Layer Position",setwmsopacity:"Set Opacity",wms:{title:"",copy:"Tryck här för att kopiera url.",copied:"Kopierad."},download:{unknow:"Ladda",shp:"Ladda SHP-fil",gpx:"Ladda GPX-fil",gpkg:"Ladda GPKG-fil",csv:"Ladda CSV-fil",xls:"Ladda XLS-fil",geotiff:"Ladda GEOTIFF-fil",geotiff_map_extent:"Ladda GEOTIFF-fil(current view extent)"}}},wps:{list_process:"Lista på processer",tooltip:"Välj på kartan"}},credits:{g3wSuiteFramework:"Tillämpningen baserar på OS framework",g3wSuiteDescription:"Publicera och hantera QGIS-projekt på nätet.",productOf:"Framework har utvecklats av"},toggle_color_scheme:"Toggle color scheme",logout:"Logga ut",no_other_projects:"Inga projekt för denna grupp",no_other_groups:"Inga fler grupper för denna makrogrupp",yes:"Ja",no:"Nej",back:"Gå tillbaka",backto:"Tillbaka ",changemap:"Byt karta",change_session:"Ändra session",component:"Allmän komponent",search:"Sök",no_results:"Inga sökresultat",print:"Skriv ut",create_print:"Skapa utskrift",dosearch:"Sök",catalog:"Karta",data:"Data",externalwms:"WMS",baselayers:"Bakgrundskarta",tools:"Verktyg",tree:"Nivåer",legend:"Förklaring till beteckningarna",nobaselayer:"Ingen bakgrundskarta",street_search:"Sök adress",show:"Visa",hide:"Dölj",copy_form_data:"Kopiera uppgifterna",paste_form_data:"Infoga",copy_form_data_from_feature:"Kopiera uppgifter från kartan",error_map_loading:"Fel vid laddning av kartan",check_internet_connection_or_server_admin:"Kontrollera internetanslutningen eller kontakta administratören.",could_not_load_vector_layers:"Fel i anslutningen, nivåer kan inte laddas.",server_saver_error:"Fel vid lagring på servern.",server_error:"Fel på anslutningen till servern",save:"Spara",cancel:"Ånga",close:"Stäng",dont_show_again:"Visa inte det här meddelandet igen",enlange_reduce:"Förstora / Förminska",reset_default:"Standardstorlek",add:"Lägg till",exitnosave:"Lämna programmet utan att spara",annul:"Ångra",layer_is_added:"Lagret med samma namn har redan lagts till.",sidebar:{wms:{panel:{title:"Add WMS Layer",label:{position:"Map Position",name:"Name",projections:"Projection",layers:"Layers"}},add_wms_layer:"Aggiungi WMS layer",delete_wms_url:"Delete WMS url",layer_id_already_added:"WMS Nivån har redan lagts till.",url_already_added:"WMS URL/Namn har redan lagts till.",layer_add_error:"WMS Layer not added. Please check all wms parameter or url"}},info:{title:"Resultat",list_of_relations:"List of Relations",open_link:"Öppna filbilaga",server_error:"Ett fel uppstod på servern.",no_results:"Inga resultat för sökningen/förfrågan.",link_button:"Öppna"},mapcontrols:{geolocations:{error:"Du kan inte lokaliseras"},nominatim:{placeholder:"Adress ...",noresults:"Inga resultat",notresponseserver:"Inget svar från servern"},add_layer_control:{header:"Lägg till nivå",select_projection:"Välj projektion för nivån",select_field_to_show:"Select Field to show on map",select_csv_separator:"Select delimiter",select_csv_x_field:"Select X field",select_csv_y_field:"Select Y field",select_color:"Välj färg på nivån",drag_layer:"Dra och släpp nivån hit"},query:{input_relation:"Tryck för att visa relationerna"},length:{tooltip:"Längd"},area:{tooltip:"Areal"},screenshot:{error:"Screenshot error creation",securityError:'  \n        <p><b>Säkerhetsfel</b>: ett externt lager hindrar kartan från att skrivas ut. Gör så här för att kontrollera:</p>\n        <ol>\n          <li>ta bort alla manuellt tillagda externa lager (t.ex. WMS-lager)</li>\n          <li>tvinga om inläsning av sidan: <code>CTRL + F5</code></li>\n          <li>skriv ut kartan igen</li>\n        </ol>\n        <p>För mer information kontakta serveradministratören om: <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image" style="color: #000 !important;font -vikt: fet;">&#x2139;&#xFE0F; säkerhet och nedsmutsade dukar</a></p>\n        '}},catalog_items:{helptext:"Högerklicka på en enskild nivå för att komma till tilläggsegenskaperna.",contextmenu:{zoomtolayer:"Zooma till nivå",open_attribute_table:"Öppna attributtabellen",show_metadata:"Metadata",styles:"Stilar",vector_color_menu:"Ställ in/ändra färg",layer_opacity:"Opacitet"}},dataTable:{previous:"Föregående",next:"Nästa",lengthMenu:"Show _MENU_ items",info:"Showing _START_ to _END_ of _TOTAL_ entries",no_data:"Inga uppgifter",nodatafilterd:"Inga motsvarande poster hittades",infoFiltered:"(filtered from _MAX_ total records)"}}}},{}],337:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var a=e("store/catalog-layers"),o=n(a);r["default"]={methods:{autocompleteRequest:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function r(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.layerId,a=n.field,s=n.value;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=[],t=o["default"].getLayerById(i),r.prev=2,r.next=5,t.getFilterData({suggest:a+"|"+s,unique:a});case 5:e=r.sent,r.next=10;break;case 8:r.prev=8,r.t0=r["catch"](2);case 10:return r.abrupt("return",e.map(function(e){return{id:e,text:e}}));case 11:case"end":return r.stop()}},r,this,[[2,8]])}));return e}()}}},{"store/catalog-layers":374}],338:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={computed:{tabIndex:function(){return this.editable?0:-1},notvalid:function(){return this.state.validate.valid===!1},editable:function(){return this.state.editable},showhelpicon:function(){return this.state.help&&this.state.help.message.trim()},disabled:function(){return!this.editable||"loading"===this.loadingState||"error"===this.loadingState},loadingState:function(){return this.state.input.options.loading?this.state.input.options.loading.state:null}},methods:{showHideHelp:function(){this.state.help.visible=!this.state.help.visible},mobileChange:function(e){this.state.value=e.target.value,this.change()},change:function(){this.service.setEmpty(),this.service.setUpdate(),(this.state.validate.required||this.state.validate.unique)&&this.service.validate(),this.$emit("changeinput",this.state)},isVisible:function(){}}}},{}],339:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={created:function(){this.__CLICK_EVENT={count:0,timeoutID:null}},methods:{handleClick:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments[1];this.__CLICK_EVENT&&(this.__CLICK_EVENT.count+=1,this.__CLICK_EVENT.timeoutID||(this.__CLICK_EVENT.timeoutID=setTimeout(function(){void 0!==t[e.__CLICK_EVENT.count]&&t[e.__CLICK_EVENT.count].call(r),e.__resetClickMixin()},300)))},__resetClickMixin:function(){this.__CLICK_EVENT.count=0,this.__CLICK_EVENT.timeoutID=null},__clearClickMixin:function(){this.__resetClickMixin(),this.__CLICK_EVENT=null}},beforeDestroy:function(){this.__clearClickMixin()}}},{}],340:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={methods:{getFieldService:function(){return void 0===this._fieldsService&&(this._fieldsService=e("gui/fields/fieldsservice")),this._fieldsService},getFieldType:function(e){return this.getFieldService().getType(e)},isSimple:function(e){return this.getFieldService().isSimple(e)},isLink:function(e){return this.getFieldService().isLink(e)},isImage:function(e){return this.getFieldService().isImage(e)},isPhoto:function(e){return this.getFieldService().isPhoto(e)},isVue:function(e){return this.getFieldService().isVue(e)},sanitizeFieldValue:function(e){return Array.isArray(e)&&!e.length?"":e}}}},{"gui/fields/fieldsservice":121}],341:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={data:function(){return{valid:!1}},methods:{addToValidate:function(e){this.tovalidate.push(e)},changeInput:function(e){this.isValid(e)},isValid:function(e){var t=this;if(e)if(e.validate.mutually){if(!e.validate.required)if(e.validate.empty){e.value=null,e.validate.mutually_valid=!0,e.validate.valid=!0,e.validate._valid=!0;for(var r=[],n=e.validate.mutually.length;n--;){var i=e.validate.mutually[n];!this.tovalidate[i].validate.empty&&r.push(i)}r.length<2&&r.forEach(function(e){t.tovalidate[e].validate.mutually_valid=!0,t.tovalidate[e].validate.valid=!0,setTimeout(function(){t.tovalidate[e].validate.valid=t.tovalidate[e].validate._valid,t.state.valid=t.state.valid&&t.tovalidate[e].validate.valid})})}else e.validate._valid=e.validate.valid,e.validate.mutually_valid=e.validate.mutually.reduce(function(e,r){return e&&t.tovalidate[r].validate.empty},!0),e.validate.valid=e.validate.mutually_valid&&e.validate.valid}else if(!e.validate.empty&&(e.validate.min_field||e.validate.max_field)){var a=e.validate.min_field||e.validate.max_field;e.validate.valid=e.validate.min_field?this.tovalidate[e.validate.min_field].validate.empty||1*e.value>1*this.tovalidate[e.validate.min_field].value:this.tovalidate[e.validate.max_field].validate.empty||1*e.value<1*this.tovalidate[e.validate.max_field].value,e.validate.valid&&(this.tovalidate[a].validate.valid=!0)}this.valid=Object.values(this.tovalidate).reduce(function(e,t){return e&&t.validate.valid},!0)}},created:function(){this.tovalidate=[]},destroyed:function(){this.tovalidate=null}}},{}],342:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("services/gui"),a=n(i);r["default"]={methods:{showLayer:function(){this.visible=!this.visible,this.layer.setVisible(this.visible)}},created:function(){var e=this.data,t=a["default"].getComponent("map").getService(),r=t.getProjection().getCode(),n=void 0;switch(e.type){case"Point":case"MultiPoint":n=[new ol.style.Style({image:new ol.style.Circle({radius:6,fill:new ol.style.Fill({color:[255,255,255,1]}),stroke:new ol.style.Stroke({color:[0,0,0,1],width:2})})}),new ol.style.Style({image:new ol.style.Circle({radius:2,fill:new ol.style.Fill({color:[255,255,255,1]}),stroke:new ol.style.Stroke({color:[0,0,0,1],width:2})})})];break;case"Line":case"MultiLineString":case"Polygon":case"MultiPolygon":n=new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.3)"}),stroke:new ol.style.Stroke({color:[0,0,0,1],width:2})})}this.layer=new ol.layer.Vector({source:new ol.source.Vector({features:(new ol.format.GeoJSON).readFeatures(e,{featureProjection:r})}),visible:!!this.visible,style:n}),t.getMap().addLayer(this.layer)},beforeDestroy:function(){var e=a["default"].getComponent("map").getService();e.getMap().removeLayer(this.layer)}}},{"services/gui":361}],343:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0}),r.mixins=r.autocompleteMixin=r.baseInputMixin=r.metadataMixin=r.widgetMixins=r.formInputsMixins=r.select2Mixin=r.selectMixin=r.resizeMixin=r.geoMixin=r.mediaMixin=r.fieldsMixin=void 0;var i=e("mixins/autocomplete"),a=n(i),o=e("mixins/fields"),s=n(o),l=e("mixins/media"),u=n(l),c=e("mixins/geo"),d=n(c),f=e("mixins/resize"),p=n(f),h=e("mixins/select"),v=n(h),g=e("mixins/select2"),m=n(g),y=e("mixins/form-inputs"),_=n(y),b=e("mixins/widget"),w=n(b),x=e("mixins/metadata"),S=n(x),L=e("mixins/base-input"),C=n(L),k={autocompleteMixin:a["default"],fieldsMixin:s["default"],mediaMixin:u["default"],geoMixin:d["default"],resizeMixin:p["default"],selectMixin:v["default"],select2Mixin:m["default"],formInputsMixins:_["default"],widgetMixins:w["default"],metadataMixin:S["default"],baseInputMixin:C["default"]};r.fieldsMixin=s["default"],r.mediaMixin=u["default"],r.geoMixin=d["default"],r.resizeMixin=p["default"],r.selectMixin=v["default"],r.select2Mixin=m["default"],r.formInputsMixins=_["default"],r.widgetMixins=w["default"],r.metadataMixin=S["default"],r.baseInputMixin=C["default"],r.autocompleteMixin=a["default"],r.mixins=k,r["default"]=k},{"mixins/autocomplete":337,"mixins/base-input":338,"mixins/fields":340,"mixins/form-inputs":341,"mixins/geo":342,"mixins/media":344,"mixins/metadata":345,"mixins/resize":346,"mixins/select":347,"mixins/select2":348,"mixins/widget":349}],344:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r["default"]={computed:{filename:function(){return this.value?this.value.split("/").pop():this.value}},methods:{isMedia:function(e){return!(!e||"object"!==("undefined"==typeof e?"undefined":n(e))||e.constructor!==Object)&&!!e.mime_type},getMediaType:function(e){var t={type:null,options:{}};switch(e){case"image/gif":case"image/png":case"image/jpeg":case"image/bmp":t.type="image";break;case"application/pdf":t.type="pdf";break;case"video/mp4":case"video/ogg":case"video/x-ms-wmv":case"video/x-msvideo":case"video/quicktime":t.type="video",t.options.format=e;break;case"application/gzip":case"application/zip":t.type="zip";break;case"application/msword":case"application/vnd.oasis.opendocument.text":t.type="text";break;case"application/vnd.ms-office":case"application/vnd.oasis.opendocument.spreadsheet":t.type="excel";break;case"application/vnd.openxmlformats-officedocument.presentationml.presentation":case"application/vnd.ms-powerpoint":case"application/vnd.oasis.opendocument.presentation":t.type="ppt";break;default:t.type="unknow"}return t}}}},{}],345:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={methods:{findAttributeFormMetadataAttribute:function(e){return!!this.state.metadata&&void 0!==this.state.metadata[e]},findMetadataAttribute:function(e){return void 0!==this.state[e]}}}},{}],346:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){
return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var a=e("services/gui"),o=n(a),s=e("core/utils/utils"),l=s.throttle,u=s.debounce,c={throttle:l,debounce:u};r["default"]={created:function(){var e=this.delayType&&c[this.delayType]||c.throttle;this.delayResize=this.resize?e(this.resize.bind(this),this.delayTime):null,o["default"].on("resize",this.delayResize)},mounted:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.resize&&this.resize();case 3:case"end":return e.stop()}},r,this)}));return e}(),beforeDestroy:function(){o["default"].off("resize",this.delayResize),this.delayResize=null,this.delayTime=null}}},{"core/utils/utils":68,"services/gui":361}],347:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/i18n/i18n.service"),a=i.getAppLanguage;r["default"]={methods:{getLanguage:function(){return a()},changeSelect:function(e){this.state.value="null"===e?null:e,this.change()},getValue:function(e){return null===e?"null":e},resetValues:function(){this.state.input.options.values.splice(0)}},computed:{autocomplete:function(){return"select_autocomplete"===this.state.input.type&&this.state.input.options.usecompleter}},watch:{notvalid:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$nextTick();case 2:this.select2&&(e?this.select2.data("select2").$container.addClass("input-error-validation"):this.select2.data("select2").$container.removeClass("input-error-validation"));case 3:case"end":return t.stop()}},r,this)}));return e}()}}},{"core/i18n/i18n.service":13}],348:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("store/application-state"),a=n(i),o=e("mixins/resize"),s=n(o);r["default"]={mixins:[s["default"]],methods:{setValue:function(){this.select2.val(this.state.value).trigger("change")},resize:function(){this.select2&&!a["default"].ismobile&&this.select2.select2("close")}},beforeDestroy:function(){this.select2&&this.select2.select2("destroy"),this.select2.off(),this.select2=null}}},{"mixins/resize":346,"store/application-state":373}],349:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={data:function(){return{changed:!1}},methods:{widgetChanged:function(){this.changed=!0,this.change()},stateValueChanged:function(e){}},watch:{"state.value":function(e){this.changed?this.changed=!1:this.stateValueChanged(e)}}}},{}],350:[function(e,t,r){function n(){this._config=null,this._baseUrl=null,this.init=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=$.Deferred();return this._config=e,this._baseUrl=e.urls.api,this._apiEndpoints=e.urls.apiEndpoints,t.resolve(),t.promise()};var e=0;this._incrementLoaders=function(){0===e&&this.emit("apiquerystart"),e+=1},this._decrementLoaders=function(){e-=1,0===e&&this.emit("apiqueryend")},this.get=function(e,t){var r=this,n=this._apiEndpoints[e];if(n){var i=this._baseUrl+"/"+n;t.request&&(i=i+"/"+t.request);var a=t.params||{};return this.emit(e+"querystart"),this._incrementLoaders(),$.get(i,a).done(function(t){return r.emit(e+"queryend",t),t}).fail(function(t){return r.emit(e+"queryfail",t),t}).always(function(){return r._decrementLoaders()})}return s()},a(this)}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=i.reject,l=e("core/g3wobject");o(n,l),r["default"]=new n},{"core/g3wobject":12,"core/utils/utils":68}],351:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("config"),s=n(o),l=e("app/constant"),u=e("store/application-state"),c=n(u),d=e("services/data"),f=n(d),p=e("store/plugins"),h=n(p),v=e("store/projects"),g=n(v),m=e("services/api"),y=n(m),_=e("services/clipboard"),b=n(_),w=e("services/router"),x=n(w),S=e("services/gui"),L=n(S),C=e("core/i18n/i18n.service"),k=C.init,E=C.changeLanguage,M=e("core/utils/utils"),T=M.base,I=M.inherit,P=M.XHR,F=M.uniqueId,O=e("core/g3wobject"),R=function(){var t=this;this.version=l.APP_VERSION,c["default"].iframe=window.top!==window.self,c["default"].online=navigator.onLine,c["default"].ismobile=isMobile.any,this.complete=!1,this.baseurl="/",this.download_caller_id=null,this._applicationServices={},this.config={},this._initConfigUrl=null,this._initConfig=null,this._groupId=null,this._gid=null,this.setters={changeProject:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.gid,r=e.host;return this._changeProject({gid:t,host:r})},changeMapProject:function(e){var t=e.url,r=e.epsg;t=L["default"].getService("map").addMapExtentUrlParameterToUrl(t,r),history.replaceState(null,null,t),location.replace(t)},online:function(){this.setOnline()},offline:function(){this.setOffline()},setFilterToken:function(e){this._setFilterToken(e)}},T(this),this.on("initconfig",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.user;t.setApplicationUser(r)}),this.init=i(regeneratorRuntime.mark(function r(){var e,t,n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,this.createApplicationConfig();case 3:return e=r.sent,this.setConfig(e),this.setLayout("app",e.layout),r.next=8,this.bootstrap();case 8:return r.abrupt("return",r.sent);case 11:return r.prev=11,r.t0=r["catch"](0),t=navigator&&navigator.language||"en",n=s["default"].supportedLanguages.find(function(e){return t.indexOf(e)!==-1}),r.abrupt("return",Promise.reject({error:r.t0,language:n}));case 16:case"end":return r.stop()}},r,this,[[0,11]])})),this.setupI18n=function(){var e=this,t=this._config._i18n;t.appLanguages=this._config.i18n.map(function(e){return e[0]}),this.setApplicationLanguage(t.language),k(t),this._groupId=this._config.group.slug||this._config.group.name.replace(/\s+/g,"-").toLowerCase(),$.ajaxSetup({beforeSend:function(t){t.setRequestHeader("Accept-Language",e._config.user.i18n||"en")}})},this.getCurrentProject=function(){return g["default"].getCurrentProject()},this.setDownload=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments[1],r=!t,n=!e&&t&&this.download_caller_id===t,i=!n&&t&&e&&null===this.download_caller_id;return r&&(c["default"].download=e),n&&(c["default"].download=!1,this.download_caller_id=null),i&&(c["default"].download=e,this.download_caller_id=F()),this.download_caller_id},this.getDownload=function(){return c["default"].download},this.loadingPlugin=function(e){c["default"].plugins.push(e)},this.loadedPlugin=function(e){c["default"].plugins=c["default"].plugins.filter(function(t){return t!==e})},this._setFilterToken=function(e){c["default"].tokens.filtertoken=e},this.getFilterToken=function(){return c["default"].tokens.filtertoken},this.changeLanguage=function(e){E(e),c["default"].lng=e,c["default"].language=e;var t=window.location.pathname.split("/");t[1]=e,history.replaceState(null,null,t.join("/"))},this.registerOnlineOfflineEvent=function(){var e=this;this.registerWindowEvent({evt:"online",cb:function(){return e.online()}}),this.registerWindowEvent({evt:"offline",cb:function(){return e.offline()}})},this.getBaseLayerId=function(){return c["default"].baseLayerId},this.setBaseLayerId=function(e){c["default"].baseLayerId=e},this.registerLeavePage=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.bool,r=void 0!==t&&t,n=(e.message,r?r:void 0);window.onbeforeunload=function(e){return n}},this.unregisterOnlineOfflineEvent=function(){window.removeEventListener("online"),window.removeEventListener("offline")},this.getState=function(){return c["default"]},this.disableApplication=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];c["default"].gui.app.disabled=e},this.setApplicationLanguage=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en";c["default"].lng=e,c["default"].language=e},this.getApplicationLanguage=function(){return c["default"].language},this.setOnline=function(){c["default"].online=!0},this.setOffline=function(){c["default"].online=!1},this.isOnline=function(){return c["default"].online},this.setOfflineItem=function(){var e=i(regeneratorRuntime.mark(function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.setLocalItem({id:e,data:r});case 1:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),this.setLocalItem=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.data;try{window.localStorage.setItem(t,JSON.stringify(r))}catch(n){return n}},this.removeLocalItem=function(e){window.localStorage.removeItem(e)},this.getLocalItem=function(e){var t=window.localStorage.getItem(e);return t?JSON.parse(t):void 0},this.getOfflineItem=function(e){return this.getLocalItem(e)},this.removeOfflineItem=function(e){this.removeLocalItem(e)},this.isIframe=function(){return c["default"].iframe},this.getConfig=function(){return this._config},this.setConfig=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._config=e},this.getRouterService=function(){return x["default"]},this.getProxyUrl=function(){return""+this._initConfig.proxyurl},this.getInterfaceOwsUrl=function(){return""+this._initConfig.interfaceowsurl},this.getClipboardService=function(){return b["default"]},this.createApplicationConfig=function(){var e=i(regeneratorRuntime.mark(function t(e){var r,n,i,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=a({},s["default"]),t.prev=1,!e){t.next=6;break}t.t0=e,t.next=9;break;case 6:return t.next=8,this.obtainInitConfig({initConfigUrl:""+s["default"].server.urls.initconfig});case 8:t.t0=t.sent;case 9:return e=t.t0,this.baseurl=e.baseurl,t.next=13,this.getMacrogroupsGroups();case 13:return n=t.sent,i=n.macrogroups,o=n.groups,r.server.urls.baseurl=e.baseurl,r.server.urls.frontendurl=e.frontendurl,r.server.urls.staticurl=e.staticurl,r.server.urls.clienturl=e.staticurl+e.client,r.server.urls.mediaurl=e.mediaurl,r.server.urls.vectorurl=e.vectorurl,r.server.urls.proxyurl=e.proxyurl,r.server.urls.rasterurl=e.rasterurl,r.server.urls.interfaceowsurl=e.interfaceowsurl,r.main_map_title=e.main_map_title,r.group=e.group,r.user=e.user,r.credits=e.credits,r.i18n=e.i18n,r._i18n.language=r.user.i18n,r.group.layout.iframe=window.top!==window.self,t.abrupt("return",{apptitle:r.apptitle||"",logo_img:r.group.header_logo_img,logo_link:r.group.header_logo_link,terms_of_use_text:r.group.header_terms_of_use_text,terms_of_use_link:r.group.terms_of_use_link,header_custom_links:r.group.header_custom_links,debug:r.client.debug||!1,group:r.group,urls:r.server.urls,mediaurl:r.server.urls.mediaurl,resourcesurl:r.server.urls.clienturl,vectorurl:r.server.urls.vectorurl,rasterurl:r.server.urls.rasterurl,interfaceowsurl:r.server.urls.interfaceowsurl,projects:r.group.projects,initproject:r.group.initproject,overviewproject:r.group.overviewproject&&r.group.overviewproject.gid?r.group.overviewproject:null,baselayers:r.group.baselayers,mapcontrols:r.group.mapcontrols,background_color:r.group.background_color,crs:r.group.crs,minscale:r.group.minscale,maxscale:r.group.maxscale,main_map_title:r.main_map_title,credits:r.credits,_i18n:r._i18n,i18n:r.i18n,layout:r.group.layout||{},getWmsUrl:function(e){return r.server.urls.baseurl+r.server.urls.ows+"/"+r.group.id+"/"+e.type+"/"+e.id+"/"},getProjectConfigUrl:function(e){return r.server.urls.baseurl+r.server.urls.config+"/"+r.group.id+"/"+e.type+"/"+e.id+"?_t="+e.modified},plugins:r.group.plugins,tools:r.tools,views:r.views||{},user:r.user||null,groups:o,macrogroups:i});case 35:return t.prev=35,t.t1=t["catch"](1),t.abrupt("return",Promise.reject(t.t1));case 38:case"end":return t.stop()}},t,this,[[1,35]])}));return function(t){return e.apply(this,arguments)}}(),this.getMacrogroupsGroups=i(regeneratorRuntime.mark(function n(){var e,t;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=[],t=[],r.prev=2,r.next=5,P.get({url:"/"+this.getApplicationUser().i18n+l.API_BASE_URLS.ABOUT.macrogroups});case 5:e=r.sent,r.next=10;break;case 8:r.prev=8,r.t0=r["catch"](2);case 10:return r.prev=10,r.next=13,P.get({url:"/"+this.getApplicationUser().i18n+l.API_BASE_URLS.ABOUT.nomacrogoups});case 13:t=r.sent,r.next=18;break;case 16:r.prev=16,r.t1=r["catch"](10);case 18:return r.abrupt("return",{macrogroups:e,groups:t});case 19:case"end":return r.stop()}},n,this,[[2,8],[10,16]])})),this.obtainInitConfig=i(regeneratorRuntime.mark(function o(){var e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.initConfigUrl,i=r.url,a=r.host;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(this._initConfigUrl?this.clearInitConfig():this._initConfigUrl=n,this._initConfig=window.initConfig,e=void 0,t=i?i.split("?")[1]:location.search.substring(1),t?t.split("&").forEach(function(t){e=t.indexOf("project")>-1?t.split("=")[1]:e}):this._gid&&(e=this._groupId+"/"+this._gid.split(":").join("/")),r.prev=5,!e){r.next=10;break}return r.next=9,this.getInitConfig(""+(a||"")+this.baseurl+this._initConfigUrl+"/"+e);case 9:this._initConfig=r.sent;case 10:r.next=15;break;case 12:return r.prev=12,r.t0=r["catch"](5),r.abrupt("return",Promise.reject(r.t0));case 15:return r.prev=15,window.initConfig=this._initConfig,this.emit("initconfig",this._initConfig),this.setInitVendorKeys(this._initConfig),r.abrupt("return",Promise.resolve(this._initConfig));case 21:case"end":return r.stop()}},o,this,[[5,12,15,21]])})),this.getInitConfig=function(e){var t=this;return new Promise(function(r,n){t._initConfig?r(t._initConfig):P.get({url:e}).then(function(e){return r(e)})["catch"](function(e){return n(e)})})},this.getInitConfigUrl=function(){return this._initConfigUrl},this.setInitConfigUrl=function(e){this._initConfigUrl=e},this.setEPSGApplication=function(e){c["default"].map.epsg=e.state.crs.epsg},this.setApplicationUser=function(e){c["default"].user=e},this.getApplicationUser=function(){return c["default"].user},this.bootstrap=function(){var e=this;return new Promise(function(t,r){e.setupI18n();var n=setTimeout(function(){r("Timeout")},l.TIMEOUT);c["default"].ready||$.when(g["default"].init(e._config),y["default"].init(e._config)).then(function(){clearTimeout(n),e.registerOnlineOfflineEvent(),e.emit("ready"),c["default"].ready=e.initialized=!0;var r=g["default"].getCurrentProject();e._gid=r.getGid(),e.setEPSGApplication(r),c["default"].iframe&&e.startIFrameService({project:r}),f["default"].init(),e.initLocalItems(),t(!0)}).fail(function(e){return r(e)})})},this.postBootstrap=i(regeneratorRuntime.mark(function u(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.complete){e.next=13;break}return e.prev=1,x["default"].init(),e.next=5,h["default"].init({pluginsBaseUrl:this._config.urls.staticurl,pluginsConfigs:this._config.plugins,otherPluginsConfig:g["default"].getCurrentProject().getState()});case 5:e.next=9;break;case 7:e.prev=7,e.t0=e["catch"](1);case 9:return e.prev=9,this.complete=!0,this.emit("complete"),e.finish(9);case 13:case"end":return e.stop()}},u,this,[[1,7,9,13]])})),this.startIFrameService=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.project,n=e("core/iframe/routerservice");n.init({project:r})},this.registerWindowEvent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.evt,r=e.cb;window.addEventListener(t,r)},this.unregisterWindowEvent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.evt,r=e.cb;window.removeEventListener(t,r)},this.registerService=function(e,t){this._applicationServices[e]=t},this.unregisterService=function(e){delete this._applicationServices[e]},this.getApplicationService=function(e){return this._applicationServices[e]},this.getService=function(e){return this._applicationServices[e]},this.errorHandler=function(e){},this.clearInitConfig=function(){window.initConfig=this._initConfig=null},this.setInitVendorKeys=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.group.vendorkeys||{};e.group.baselayers.forEach(function(e){e.apikey&&(t[e.servertype?e.servertype.toLowerCase():null]=e.apikey)}),this.setVendorKeys(t)},this.setVendorKeys=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.keys(e).forEach(function(t){return c["default"].keys.vendorkeys[t]=e[t]})},this.changeProjectView=function(e){c["default"].changeProjectview=e},this.isProjectViewChanging=function(){return c["default"].changeProjectview},this.reloadCurrentProject=function(){return this.changeProject({gid:g["default"].getCurrentProject().getGid()})},this._changeProject=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.gid,r=(e.host,e.crs),n=$.Deferred();this._gid=t;var i=g["default"].getProjectUrl(t),a=L["default"].getService("map").addMapExtentUrlParameterToUrl(i,r);try{history.replaceState(null,null,a)}catch(o){}return location.replace(a),n.resolve(),n.promise()},this.setLayout=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"app",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.rightpanel||{width:50,height:50,width_default:50,height_default:50,width_100:!1,height_100:!1};t.rightpanel=Object.assign(r,{width:t.rightpanel.width||r.width,height:t.rightpanel.height||r.width,width_default:t.rightpanel.width||r.width,height_default:t.rightpanel.height||r.width,width_100:!1,height_100:!1}),c["default"].gui.layout[e]=t},this.removeLayout=function(e){e&&delete c["default"].gui.layout[e]},this.setCurrentLayout=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"app";c["default"].gui.layout.__current=e},this.getCurrentLayout=function(){return c["default"].gui.layout[c["default"].gui.layout.__current]},this.getCurrentLayoutName=function(){return c["default"].gui.layout.__current},this.cloneLayout=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"app";return JSON.parse(JSON.stringify(c["default"].gui.layout[e]))},this.clear=function(){this.unregisterOnlineOfflineEvent()},this.initLocalItems=function(){var e=this;Object.keys(l.LOCAL_ITEM_IDS).forEach(function(t){void 0===e.getLocalItem(t)&&e.setLocalItem({id:t,data:l.LOCAL_ITEM_IDS[t].value})})}};I(R,O),r["default"]=new R},{"app/constant":4,config:3,"core/g3wobject":12,"core/i18n/i18n.service":13,"core/iframe/routerservice":14,"core/utils/utils":68,"services/api":350,"services/clipboard":352,"services/data":358,"services/gui":361,"services/router":368,"store/application-state":373,"store/plugins":378,"store/projects":379}],352:[function(e,t,r){function n(){this._data={},this.set=function(e,t){var r=e.split("form")[0];this._data[r]=t},this.get=function(e){var t=this._data[e]||{};return this._data[e]={},t}}Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=new n},{}],353:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function i(){s(this),this.expression=n(regeneratorRuntime.mark(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=this,e.next=4,this.handleRequest({url:""+this.project.getUrl("vector_data")+t.layer_id+"/",params:t});case 4:return e.t1=e.sent,e.abrupt("return",e.t0.handleResponse.call(e.t0,e.t1));case 8:return e.prev=8,e.t2=e["catch"](0),e.abrupt("return",Promise.reject(e.t2));case 11:case"end":return e.stop()}},e,this,[[0,8]])})),this.expression_eval=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.handleRequest({url:this.project.getUrl("expression_eval"),params:e})},this.handleRequest=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.params,n=void 0===r?{}:r,i=e.contentType,a=void 0===i?"application/json":i;return u.post({url:t,contentType:a,data:JSON.stringify(n)})},this.handleResponse=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return d(e)}}Object.defineProperty(r,"__esModule",{value:!0});var a=e("core/data/service"),o=e("core/utils/utils"),s=o.base,l=o.inherit,u=o.XHR,c=e("core/utils/geo"),d=c.getFeaturesFromResponseVectorApi;l(i,a),r["default"]=new i},{"core/data/service":5,"core/utils/geo":64,"core/utils/utils":68}],354:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(){u(this),this.wmsCapabilities=i(regeneratorRuntime.mark(function e(){var t,r,n,i,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=a.url;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=""+s["default"].getInterfaceOwsUrl(),e.prev=1,r={url:o,service:"wms"},n=JSON.stringify(r),e.next=6,d.post({url:t,contentType:"application/json",data:n});case 6:return i=e.sent,e.abrupt("return",i);case 10:return e.prev=10,e.t0=e["catch"](1),e.abrupt("return");case 13:case"end":return e.stop()}},e,this,[[1,10]])}))}Object.defineProperty(r,"__esModule",{value:!0});var o=e("services/application"),s=n(o),l=e("core/utils/utils"),u=l.base,c=l.inherit,d=l.XHR,f=e("core/data/service");c(a,f),r["default"]=new a},{"core/data/service":5,"core/utils/utils":68,"services/application":351}],355:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(){u(this),this.wms=i(regeneratorRuntime.mark(function e(){var t,r,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=i.url,o=i.method,l=void 0===o?"GET":o,u=i.params,c=void 0===u?{}:u,f=i.headers,p=void 0===f?{}:f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=""+s["default"].getProxyUrl(),"GET"===l&&(a=new URL(a),Object.keys(c).forEach(function(e){return a.searchParams.set(e,c[e])}),a=a.toString()),e.prev=2,r=JSON.stringify({url:a,params:c,headers:p,method:l}),e.next=6,d.post({url:t,contentType:"application/json",data:r});case 6:return n=e.sent,e.abrupt("return",{response:n,data:r});case 10:return e.prev=10,e.t0=e["catch"](2),e.abrupt("return");case 13:case"end":return e.stop()}},e,this,[[2,10]])})),this.data=function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}}}Object.defineProperty(r,"__esModule",{value:!0});var o=e("services/application"),s=n(o),l=e("core/utils/utils"),u=l.base,c=l.inherit,d=l.XHR,f=e("core/data/service");c(a,f),r["default"]=new a},{"core/data/service":5,"core/utils/utils":68,"services/application":351}],356:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function i(){l(this),this.condition={filtrable:{ows:"WFS"}},this.polygon=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.feature,r=e.feature_count,n=void 0===r?this.project.getQueryFeatureCount():r,i=e.filterConfig,s=void 0===i?{}:i,l=e.multilayers,u=void 0!==l&&l,c=e.condition,f=void 0===c?this.condition:c,p=e.layerName,h=void 0===p?"":p,g=e.excludeSelected,y=void 0===g?null:g,_=e.external,b=void 0===_?{add:!0,filter:{SELECTED:!1}}:_,w=this.hasExternalLayerSelected({type:"vector"}),x=w?t.getId():t.get(o.G3W_FID),S=t.getGeometry();return S?this.handleRequest(v(m(a({},"boolean"==typeof y?{SELECTED:!y}:{SELECTED_OR_ALL:!0},{FILTERABLE:!0,VISIBLE:!0}),f),{geometry:S,multilayers:u,feature_count:n,filterConfig:s,projection:this.project.getProjection()}),{fid:x,geometry:S,layerName:h,type:"polygon",filterConfig:s,external:b}):this.returnExceptionResponse({usermessage:{type:"warning",message:h+" - "+d("sdk.mapcontrols.querybypolygon.no_geometry"),messagetext:!0,autoclose:!1}})},this.bbox=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.bbox,r=e.feature_count,n=void 0===r?this.project.getQueryFeatureCount():r,i=e.filterConfig,a=void 0===i?{}:i,o=e.multilayers,s=void 0!==o&&o,l=e.condition,u=void 0===l?this.condition:l,c=e.excludeSelected,d=void 0===c?null:c,f=e.addExternal,p=void 0===f||f,h=e.layersFilterObject,v=void 0===h?{SELECTED_OR_ALL:!0,FILTERABLE:!0,VISIBLE:!0}:h,y=this.hasExternalLayerSelected({type:"vector"}),_={bbox:t,type:"bbox",filterConfig:a,external:{add:p,filter:{SELECTED:y||"boolean"==typeof d&&d}}};return y?this.handleRequest(this.getEmptyRequest(),_):this.handleRequest(g(m(v,u),{bbox:t,feature_count:n,filterConfig:a,multilayers:s}),_)},this.coordinates=n(regeneratorRuntime.mark(function e(){var t,r,n,i,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=a.coordinates,l=a.layerIds,u=void 0===l?[]:l,c=a.multilayers,d=void 0!==c&&c,f=a.query_point_tolerance,p=void 0===f?o.QUERY_POINT_TOLERANCE:f,v=a.addExternal,g=void 0===v||v,y=a.feature_count;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.hasExternalLayerSelected({type:"vector"}),r={coordinates:s,type:"coordinates",external:{add:g,filter:{SELECTED:t}}},!t||0!==u.length){e.next=4;break}return e.abrupt("return",this.handleRequest(this.getEmptyRequest(),r));case 4:return n={QUERYABLE:!0,SELECTED_OR_ALL:0===u.length,VISIBLE:!0},Array.isArray(u)&&u.forEach(function(e){n.IDS||(n.IDS=[]),n.IDS.push(e)}),i=m(n),1===i.length&&i[0].isSelected()&&(r.external.add=!1),e.abrupt("return",this.handleRequest(h(i,{multilayers:d,feature_count:y,query_point_tolerance:p,coordinates:s}),r));case 9:case"end":return e.stop()}},e,this)})),this.handleRequest=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(n,i){e.then(function(e){var i=t.handleResponse(e,r);n(i)}).fail(i)})},this.handleResponse=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e,n={query:t,type:"ows",data:[],result:!0};return r.forEach(function(e){return e.data&&e.data.forEach(function(e){return n.data.push(e)})}),n},this.returnExceptionResponse=function(){var e=n(regeneratorRuntime.mark(function t(e){var r=e.usermessage;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{data:[],usermessage:r,result:!0,error:!0});case 1:case"end":return e.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}()}Object.defineProperty(r,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("app/constant"),s=e("core/utils/utils"),l=s.base,u=s.inherit,c=e("core/i18n/i18n.service"),d=c.t,f=e("core/data/service"),p=e("core/utils/geo"),h=p.getQueryLayersPromisesByCoordinates,v=p.getQueryLayersPromisesByGeometry,g=p.getQueryLayersPromisesByBBOX,m=p.getMapLayersByFilter;u(i,f),r["default"]=new i},{"app/constant":4,"core/data/service":5,"core/i18n/i18n.service":13,"core/utils/geo":64,"core/utils/utils":68}],357:[function(e,t,r){function n(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(){l(this),this.features=i(regeneratorRuntime.mark(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{layer:layer,search_endpoint:search_endpoint,filter:filter,raw:!1,queryUrl:queryUrl,feature_count:feature_count,ordering:ordering};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i(regeneratorRuntime.mark(function r(){var e,i,a,s,l,u,c,d,f,p,h;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=[],i=t.layer,a=n(t,["layer"]),s=t.raw,l=void 0!==s&&s,u=t.filter,c={data:[],query:{type:"search",search:u},type:a.search_endpoint},d=Array.isArray(i)?i:[i],a.filter=Array.isArray(a.filter)?a.filter:[a.filter],"api"===a.search_endpoint?d.forEach(function(t,r){return e.push(t.searchFeatures(o({},a,{filter:a.filter[r]})))}):(f=d[0].getProvider("search"),p=new Promise(function(e,t){f.query(o({},a,{layers:d},d[0].getSearchParams())).then(function(t){e({data:t})}).fail(t)}),e.push(p)),r.next=9,Promise.allSettled(e);case 9:return h=r.sent,h.forEach(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.status,r=e.value;if("fulfilled"===t)if(l)c.data.push("api"===a.search_endpoint?{data:r}:r);else{var n=r.data,i=void 0===n?[]:n;"api"===a.search_endpoint?i.length&&c.data.push(i[0]):c.data=i}}),r.abrupt("return",c);case 12:case"end":return r.stop()}},r,this)}))());case 1:case"end":return e.stop()}},e,this)})),this.fids=i(regeneratorRuntime.mark(function t(){var e,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.layer,a=n.formatter,o=void 0===a?0:a,s=n.fids,l=void 0===s?[]:s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e={data:[{layer:i,features:[]}],query:{type:"search"}},t.prev=1,t.t0=i,!t.t0){t.next=7;break}return t.next=6,i.getFeatureByFids({fids:l,formatter:o});case 6:t.t0=t.sent;case 7:r=t.t0,r&&r.forEach(function(t){return e.data[0].features.push(d(t))}),t.next=13;break;case 11:t.prev=11,t.t1=t["catch"](1);case 13:return t.abrupt("return",e);case 14:case"end":return t.stop()}},t,this,[[1,11]])})),this.layersfids=i(regeneratorRuntime.mark(function r(){var e,t,n,i=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=a.layers,s=void 0===o?[]:o,l=a.fids,u=void 0===l?[]:l,c=a.formatter,d=void 0===c?0:c;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=[],t={data:[],query:{type:"search"}},s.forEach(function(t,r){e.push(i.fids({layer:t,fids:u[r],formatter:d}))}),r.prev=3,r.next=6,Promise.all(e);case 6:n=r.sent,n.forEach(function(e){return t.data.push(e.data)}),r.next=13;
break;case 10:r.prev=10,r.t0=r["catch"](3);case 13:return r.abrupt("return",t);case 14:case"end":return r.stop()}},r,this,[[3,10]])}))}Object.defineProperty(r,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=e("core/utils/utils"),l=s.base,u=s.inherit,c=e("core/utils/geo"),d=c.createOlFeatureFromApiResponseFeature,f=e("core/data/service");u(a,f),r["default"]=new a},{"core/data/service":5,"core/utils/geo":64,"core/utils/utils":68}],358:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(){this.defaultoutputplaces=["gui"],this.currentoutputplaces=[].concat(a(this.defaultoutputplaces)),this.ouputplaces={gui:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return b["default"].setLoadingContent(!0),r.prev=1,b["default"].outputDataPlace(e,t),r.next=5,e;case 5:r.next=9;break;case 7:r.prev=7,r.t0=r["catch"](1);case 9:b["default"].setLoadingContent(!1);case 10:case"end":return r.stop()}},r,this,[[1,7]])}));return e}(),iframe:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:y["default"].outputDataPlace(e,t);case 1:case"end":return r.stop()}},r,this)}));return e}()},this.init=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.services={query:h["default"],search:g["default"],expression:l["default"],proxy:f["default"],ows:c["default"]};case 1:case"end":return e.stop()}},e,this)})),this.getData=function(){var e=i(regeneratorRuntime.mark(function t(e){var r,n,i,a,o,s,l,u,c,d,f=this,p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=x(e),n=r.context,i=r.method,a=this.getService(n),o=p.inputs,s=void 0===o?{}:o,l=p.outputs,u=void 0===l?{}:l,c=a[i](s),u&&this.currentoutputplaces.forEach(function(e){f.ouputplaces[e](c,u)}),t.next=7,c;case 7:return d=t.sent,t.next=10,d;case 10:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),this.showEmptyOutputs=function(){var e=this,t=Promise.resolve({data:[]});this.currentoutputplaces.forEach(function(r){e.ouputplaces[r](t)})},this.showCustomOutputDataPromise=function(e){var t=this;this.currentoutputplaces.forEach(function(r){t.ouputplaces[r](e,{})})},this.getService=function(e){return this.services[e]},this.setOutputPlaces=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.currentoutputplaces=e},this.addCurrentOutputPlace=function(e){e&&this.currentoutputplaces.indexOf(e)===-1&&this.currentoutputplaces.push(e)},this.addNewOutputPlace=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.place,r=e.method,n=void 0===r?function(){}:r,i=!1;return void 0===this.ouputplaces[t]&&(this.ouputplaces[t]=n,i=!0),i},this.resetDefaultOutput=function(){this.currentoutputplaces=[].concat(a(this.defaultoutputplaces))}}Object.defineProperty(r,"__esModule",{value:!0});var s=e("services/data-expression"),l=n(s),u=e("services/data-ows"),c=n(u),d=e("services/data-proxy"),f=n(d),p=e("services/data-query"),h=n(p),v=e("services/data-search"),g=n(v),m=e("services/iframe-plugin"),y=n(m),_=e("services/gui"),b=n(_),w=e("core/utils/utils"),x=w.splitContextAndMethod;r["default"]=new o},{"core/utils/utils":68,"services/data-expression":353,"services/data-ows":354,"services/data-proxy":355,"services/data-query":356,"services/data-search":357,"services/gui":361,"services/iframe-plugin":364}],359:[function(e,t,r){function n(){this.execute=function(e,t,r){var i=void 0,a=void 0;t.forEach(function(t){a=t.feature,r&&a[n.Actions[a.getState()].opposite](),i=n.Actions[a.getState()].fnc,e[i](a)})}}Object.defineProperty(r,"__esModule",{value:!0}),n.Actions={add:{fnc:"addFeature",opposite:"delete"},"delete":{fnc:"removeFeature",opposite:"add"},update:{fnc:"updateFeature",opposite:"update"}},r["default"]=new n},{}],360:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){this.stack=new l,this.init=function(e){this.layout=e,this.sidebarEl=$(this.layout.options.controlSidebarOptions.selector),this._zindex=this.sidebarEl.css("z-index"),this._modalOverlay=null,this._modal=!1,this._isopen=!1},this.isOpen=function(){return this._isopen},this.open=function(){this.layout.floatBar.open(this.sidebarEl,!0),this._isopen=!0},this.close=function(){this.layout.floatBar.close(this.sidebarEl,!0),this._isopen=!1},this.showPanel=function(e,t){t=t||{};t.append||!1,t.modal||!1;t.parent="#g3w-floatbarpanel-placeholder",this.stack.push(e,t),this._isopen||this.open()},this.closePanel=function(e){e?this.stack.remove(e):this.stack.pop(),this.stack.getLength()||(this._modal?(o["default"].setModal(!1),this.close(),$(".control-sidebar-bg").toggleClass("control-sidebar-bg-shadow"),this.sidebarEl.css("z-index",""),this.sidebarEl.css("padding-top","50px"),$(".control-sidebar-bg").css("z-index",""),this._modal=!1):this.close())},this.hidePanel=function(){this.close()}}Object.defineProperty(r,"__esModule",{value:!0});var a=e("services/gui"),o=n(a),s=e("gui/utils/utils"),l=s.barstack;r["default"]=new i},{"gui/utils/utils":188,"services/gui":361}],361:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){this.setters={setContent:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.emit("opencontent",!0),this._setContent(e)}},this.isready=!1,this.getResourcesUrl=f,this.showForm=f,this.closeForm=f,this.showListing=f,this.closeListing=f,this.hideListing=f,this.setModal=f,this.showFullModal=f,this.showQueryResults=f,this.hideQueryResults=f,this.showPanel=f,this.hidePanel=f,this.reloadComponents=f,this.showUserMessage=f,this.closeUserMessage=f,this.showModalDialog=f,this.push_content=!1,this.setPushContent=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.push_content=e},this.getPushContent=function(){return this.push_content},this._closeUserMessageBeforeSetContent=!0,this.setComponent=function(e){l["default"].registerComponent(e)},this.getComponent=function(e){return l["default"].getComponent(e)},this.getComponents=function(){return l["default"].getComponents()},this["goto"]=function(e){o["default"]["goto"](e)},this.ready=function(){this.emit("ready"),this.isready=!0},this.guiResized=function(){this.emit("guiresized")},this.isReady=function(){var e=this;return new Promise(function(t){return e.isready?t():e.once("ready",t)})},this.getService=function(e){var t=this.getComponent(e);return t&&t.getService()},this.showSpinner=function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}},this.hideSpinner=function(e){},this.notify=f,this.dialog=f,this.isMobile=f,c(this)}Object.defineProperty(r,"__esModule",{value:!0});var a=e("services/router"),o=n(a),s=e("store/components"),l=n(s),u=e("core/utils/utils"),c=u.base,d=u.inherit,f=u.noop,p=e("core/g3wobject");d(i,p),r["default"]=new i},{"core/g3wobject":12,"core/utils/utils":68,"services/router":368,"store/components":375}],362:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(){u(this),this.mapControls={screenshot:{control:null},changeMap:{control:null}},this.init=function(){var e=this;return new Promise(function(t,r){e.mapService.once("ready",function(){e._map=e.mapService.getMap(),e._mapCrs=e.mapService.getCrs(),e.mapControls.screenshot.control=e.mapService.getMapControlByType({type:"screenshot"}),e.setReady(!0),t()})})},this.results=function(){var e=i(regeneratorRuntime.mark(function t(e){var r=e.capture,n=void 0===r||r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n?s["default"].setOutputPlaces(["iframe"]):s["default"].resetDefaultOutput(),e.abrupt("return",[]);case 2:case"end":return e.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),this.screenshot=function(){var e=i(regeneratorRuntime.mark(function t(e){var r,n=this,a=e.capture,o=void 0===a||a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r="app:screenshot",o?this.mapControls.screenshot.control.overwriteOnClickEvent(i(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.mapService.createMapImage();case 3:e=t.sent,n.emit("response",{action:r,response:{result:!0,data:e}}),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),n.emit("response",{action:r,response:{result:!1,data:t.t0}});case 10:case"end":return t.stop()}},t,n,[[0,7]])}))):this.mapControls.screenshot.control.resetOriginalOnClickEvent();case 2:case"end":return e.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),this.getcenter=i(regeneratorRuntime.mark(function e(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.mapService.getCenter());case 1:case"end":return e.stop()}},e,this)})),this.zoomtocoordinates=i(regeneratorRuntime.mark(function t(){var e,r,n,i,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=a.coordinates,r=void 0===e?[]:e,n=a.highlight,i=void 0!==n&&n,!r||!Array.isArray(r)||2!==r.length){t.next=6;break}return this.mapService.zoomTo(r),t.abrupt("return",r);case 6:return t.abrupt("return",Promise.reject(r));case 7:case"end":return t.stop()}},t,this)})),this.getextent=i(regeneratorRuntime.mark(function r(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.mapService.getMapExtent());case 1:case"end":return e.stop()}},r,this)})),this.zoomtoextent=i(regeneratorRuntime.mark(function n(){var e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e=r.extent,t=void 0===e?[]:e,!t||!Array.isArray(t)||4!==t.length){n.next=6;break}return this.mapService.goToBBox(t),n.abrupt("return",t);case 6:return n.abrupt("return",Promise.reject(t));case 7:case"end":return n.stop()}},n,this)})),this.zoomtofeature=i(regeneratorRuntime.mark(function a(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise(function(){var r=i(regeneratorRuntime.mark(function n(r,i){var a,o,s,l,u;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=t.qgs_layer_id,o=t.feature,s=t.highlight,l=void 0!==s&&s,a=e.getQgsLayerId({qgs_layer_id:a}),n.next=4,e.findFeaturesWithGeometry({qgs_layer_id:a,feature:o,zoom:!0,highlight:l});case 4:u=n.sent,r(u.qgs_layer_id);case 6:case"end":return n.stop()}},n,e)}));return function(e,t){return r.apply(this,arguments)}}()));case 1:case"end":return r.stop()}},a,this)}))}Object.defineProperty(r,"__esModule",{value:!0});var o=e("services/data"),s=n(o),l=e("core/utils/utils"),u=l.base,c=l.inherit,d=e("core/iframe/services/baseservice");c(a,d),r["default"]=new a},{"core/iframe/services/baseservice":15,"core/utils/utils":68,"services/data":358}],363:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function o(){var e=this;d(this),this.pluginName="editing",this.subscribevents=[],this.isRunning=!1,this.responseObject={cb:null,qgs_layer_id:null,error:null},this.config={tools:{add:{disabled:[{id:"deletefeature"},{id:"copyfeatures"},{id:"editmultiattributes"},{id:"deletePart"},{id:"splitfeature"},{id:"mergefeatures"}]},update:{disabled:[{id:"addfeature"},{id:"copyfeatures"},{id:"deletefeature"},{id:"editmultiattributes"},{id:"deletePart"},{id:"splitfeature"},{id:"mergefeatures"}]},"delete":{enabled:[{id:"deletefeature",options:{active:!0}}]}}},this.startAction=function(){var e=a(regeneratorRuntime.mark(function t(e){var r=this,n=e.toolboxes,i=e.resolve,a=e.reject;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.responseObject.cb=a,this.dependencyApi.setSaveConfig({cb:{done:function(e){r.responseObject.cb=i,r.responseObject.qgs_layer_id=e.getId(),r.responseObject.error=null,r.dependencyApi.hidePanel()},error:function(e,t){r.responseObject.cb=a,r.responseObject.qgs_layer_id=e.getId(),r.responseObject.error=t}}}),this.dependencyApi.showPanel({toolboxes:n}),this.isRunning=!0;case 4:case"end":return e.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),this.stopAction=a(regeneratorRuntime.mark(function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=r.qgs_layer_id,t.t0=e,!t.t0){t.next=5;break}return t.next=5,this.stopEditing(e);case 5:case"end":return t.stop()}},t,this)})),this.subscribersHandlers={canUndo:function(t){var r=t.activeTool,n=t.disableToolboxes,i=void 0===n?[]:n;return function(t){t===!1&&(e.responseObject.qgs_layer_id=null,e.responseObject.error=null),r.setEnabled(!t),i.forEach(function(e){return e.setEditing(!t)})}},canRedo:function(){},cancelform:function(e){return function(){e()}},addfeature:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.properties,n=t.toolboxes;return function(t){Object.keys(r).forEach(function(e){return t.set(e,r[e])});var i=void 0,a=[];if(n.forEach(function(e){var t=e.getToolById("addfeature");t.isActive()?(t.setEnabled(!1),i=t):(e.setEditing(!1),a.push(e))}),e.subscribevents.find(function(e){return"canUndo"!==e.event})){var o=e.addSubscribeEvents("canUndo",{activeTool:i,disableToolboxes:a});e.addSubscribeEvents("cancelform",o)}}},closeeditingpanel:function(t){var r=t.qgs_layer_id;return function(){e.responseObject.cb({qgs_layer_id:e.responseObject.qgs_layer_id,error:e.responseObject.error}),e.stopAction({qgs_layer_id:r})}}},this.addSubscribeEvents=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.subscribersHandlers[e](t);return this.dependencyApi.subscribe(e,r),this.subscribevents.push({event:e,handler:r}),r},this.resetSubscribeEvents=function(){var e=this;this.subscribevents.forEach(function(t){var r=t.event,n=t.handler;e.dependencyApi.unsubscribe(r,n)})},this.add=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise(function(){var r=a(regeneratorRuntime.mark(function n(r,a){var o,s,u,c,d,f,p;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.isRunning){n.next=4;break}a(),n.next=19;break;case 4:return o=t.qgs_layer_id,s=i(t,["qgs_layer_id"]),u=s.properties,c=e.getQgsLayerId({qgs_layer_id:o,noValue:e.dependencyApi.getEditableLayersId()}),n.next=9,e.startAction({toolboxes:c,resolve:r,reject:a});case 9:return d={tools:e.config.tools.add,startstopediting:!1,action:"add",selected:1===c.length},n.next=12,e.startEditing(c,d);case 12:f=n.sent,f=f.filter(function(e){return"fulfilled"===e.status}).map(function(e){return e.value}),!l["default"].isSidebarVisible()&&l["default"].showSidebar(),p=1===f.length&&f[0],p&&p.setActiveTool(p.getToolById("addfeature")),e.addSubscribeEvents("addfeature",{properties:u,toolboxes:f}),e.addSubscribeEvents("closeeditingpanel",{qgs_layer_id:c});case 19:case"end":return n.stop()}},n,e)}));return function(e,t){return r.apply(this,arguments)}}())},this.update=a(regeneratorRuntime.mark(function r(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise(function(){var r=a(regeneratorRuntime.mark(function n(r,a){var o,s,u,c,d,f,p;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.isRunning){n.next=4;break}a(),n.next=22;break;case 4:return o=t.qgs_layer_id,s=i(t,["qgs_layer_id"]),u=s.feature,c=e.getQgsLayerId({qgs_layer_id:o,noValue:e.dependencyApi.getEditableLayersId()}),n.next=9,e.findFeaturesWithGeometry({qgs_layer_id:c,feature:u,zoom:!0,highlight:!0,selected:1===c.length});case 9:if(d=n.sent,f=d.found,!f){n.next=21;break}return n.next=14,e.startAction({toolboxes:[d.qgs_layer_id],resolve:r,reject:a});case 14:return p={feature:u,tools:e.config.tools.update,startstopediting:!1,action:"update"},n.next=17,e.startEditing([d.qgs_layer_id],p);case 17:!l["default"].isSidebarVisible()&&l["default"].showSidebar(),e.addSubscribeEvents("closeeditingpanel",{qgs_layer_id:[d.qgs_layer_id]}),n.next=22;break;case 21:a();case 22:case"end":return n.stop()}},n,e)}));return function(e,t){return r.apply(this,arguments)}}()));case 1:case"end":return r.stop()}},r,this)})),this["delete"]=function(){},this.startEditing=a(regeneratorRuntime.mark(function n(){var e,t,r,i,a,o=this,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:e=l.action,t=void 0===e?"add":e,r=l.feature,i={},l.filter=i,n.t0=t,n.next="add"===n.t0?6:"update"===n.t0?8:10;break;case 6:return i.nofeatures=!0,n.abrupt("break",10);case 8:return i.field=r.field+"|eq|"+r.value,n.abrupt("break",10);case 10:return a=[],s.forEach(function(e){a.push(o.dependencyApi.startEditing(e,l))}),n.next=14,Promise.allSettled(a);case 14:return n.abrupt("return",n.sent);case 15:case"end":return n.stop()}},n,this)})),this.stopEditing=function(){var e=a(regeneratorRuntime.mark(function t(e){var r,n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=[],e.forEach(function(e){r.push(n.dependencyApi.stopEditing(e))}),t.next=4,Promise.allSettled(r);case 4:this.clear();case 5:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),this.stop=function(){var e=this;return new Promise(function(t,r){e.dependencyApi.hidePanel(),l["default"].hideSidebar(),e.once("clear",t)})},this.clear=function(){this.dependencyApi.resetDefault(),this.isRunning=!1,this.responseObject={cb:null,qgs_layer_id:null,error:null},this.resetSubscribeEvents(),this.emit("clear")}}Object.defineProperty(r,"__esModule",{value:!0});var s=e("services/gui"),l=n(s),u=e("core/iframe/services/plugins/service"),c=g3wsdk.core.utils,d=c.base,f=c.inherit;f(o,u),r["default"]=new o},{"core/iframe/services/plugins/service":17,"services/gui":361}],364:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function o(){var t=this;arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pendingactions={},this.init=a(regeneratorRuntime.mark(function r(){var t,n,i,a,o=this,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=s.project;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,l["default"].isReady();case 2:this.services=e("core/iframe/services/index"),this.eventResponseServiceHandler=function(e){var t=e.action,r=e.response;o.postMessage({id:null,action:t,response:r})},t=u.state.layers.map(function(e){return{id:e.id,name:e.name}}),n=Object.keys(this.services),i=0;case 7:if(!(i<n.length)){r.next=16;break}return a=this.services[n[i]],void 0===a.getLayers()&&a.setLayers(t),r.next=12,a.init();case 12:a.on("response",this.eventResponseServiceHandler);case 13:i++,r.next=7;break;case 16:this.postMessage({id:null,action:"app:ready",response:{result:!0,data:{layers:t}}}),window.addEventListener?window.addEventListener("message",this.getMessage,!1):window.attachEvent("onmessage",this.getMessage);case 18:case"end":return r.stop()}},r,this)})),this.outputDataPlace=function(){var e=a(regeneratorRuntime.mark(function t(e){var r,n,a,o,s,l,u,c,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=d.action,n=void 0===r?"app:results":r,t.next=3,e;case 3:a=t.sent,o=a.result,s=a.data,l=void 0===s?[]:s,u=new ol.format.GeoJSON,c=[];try{c=l.map(function(e){var t=e.layer,r=e.features;return i({},t.getId(),{features:u.writeFeatures(r)})})}catch(f){}this.postMessage({id:null,action:n,response:{result:o,data:c}});case 11:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),this.postMessage=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};window.parent&&window.parent.postMessage(e,"*")},this.stopPendingActions=a(regeneratorRuntime.mark(function n(){var e,t=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=[],Object.keys(this.pendingactions).forEach(function(r){var n=t.pendingactions[r].context;e.push(t.services[n].stop()),delete t.pendingactions[r]}),r.abrupt("return",Promise.allSettled(e));case 3:case"end":return r.stop()}},n,this)})),this.getMessage=function(){var e=a(regeneratorRuntime.mark(function r(e){var n,i,a,o,s,l,u,f,p,h,v,g;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!e||!e.data){r.next=24;break}if(n=e.data,i=n.id,a=void 0===i?d():i,o=n.single,s=void 0===o||o,l=n.action,u=n.data,f=c(l),p=f.context,h=f.method,v=!1,g=void 0,r.prev=5,!t.services[p].getReady()){r.next=16;break}if(r.t0=s,!r.t0){r.next=11;break}return r.next=11,t.stopPendingActions();case 11:return t.pendingactions[a]={context:p},r.next=14,t.services[p][h](u);case 14:g=r.sent,v=!0;case 16:r.next=22;break;case 18:r.prev=18,r.t1=r["catch"](5),v=!1,g=r.t1;case 22:t.postMessage({id:a,action:l,response:{result:v,data:g}}),delete t.pendingactions[a];case 24:case"end":return r.stop()}},r,t,[[5,18]])}));return function(t){return e.apply(this,arguments)}}(),this.clear=function(){for(var e=Object.keys(this.services),t=0;t<e.length;t++){var r=this.services[e[t]];r.off("response",this.eventResponseServiceHandler)}this.stopPendingActions(),window.removeEventListener?window.removeEventListener("message",this.getMessage,!1):window.detachEvent("onmessage",this.getMessage)}}Object.defineProperty(r,"__esModule",{value:!0});var s=e("services/gui"),l=n(s),u=e("core/utils/utils"),c=u.splitContextAndMethod,d=u.uniqueId;r["default"]=new o},{"core/iframe/services/index":16,"core/utils/utils":68,"services/gui":361}],365:[function(e,t,r){function n(){this.state={items:{left:[],right:[]}},this.addItem=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"right";this.state.items[t].push(e)},a(this)}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("core/g3wobject");o(n,s),r["default"]=new n},{"core/g3wobject":12,"core/utils/utils":68}],366:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function s(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._cacheValues={},this._items=v["default"].getLocalItem(L)||{}}Object.defineProperty(r,"__esModule",{value:!0});var l=e("store/catalog-layers"),u=n(l),c=e("services/data"),d=n(c),f=e("store/projects"),p=n(f),h=e("services/application"),v=n(h),g=e("services/gui"),m=n(g),y=e("core/i18n/i18n.service"),_=y.t,b=e("core/utils/utils"),w=b.uniqueId,x=b.createFilterFromString,S=b.XHR,L="QUERYBUILDERSEARCHES",C=s.prototype;C.getCurrentProjectItems=function(){var e=p["default"].getCurrentProject().getId();return this._items[e]=this._items[e]||[],this._items[e]},C.getItems=function(e){var t=v["default"].getLocalItem(L);return e=e||p["default"].getCurrentProject().getId(),t?t[e]||[]:[]},C._getLayerById=function(e){return u["default"].getLayerById(e)},C.getValues=o(regeneratorRuntime.mark(function k(){var e,t,r,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=i.layerId,o=i.field;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(this._cacheValues[a]=this._cacheValues[a]||{},e=this._cacheValues[a][o],void 0!==e){i.next=18;break}return i.prev=3,t=this._getLayerById(a),r=t.getUrl("data"),i.next=8,S.get({url:r,params:{ordering:o,unique:o}});case 8:return n=i.sent,n.result&&(this._cacheValues[a][o]=this._cacheValues[a][o]||n.data),i.abrupt("return",this._cacheValues[a][o]||[]);case 13:i.prev=13,i.t0=i["catch"](3),reject();case 16:i.next=19;break;case 18:return i.abrupt("return",e);case 19:case"end":return i.stop()}},k,this,[[3,13]])})),C.run=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.layerId,n=t.filter,i=t.showResult,a=void 0===i||i;return new Promise(function(){var t=o(regeneratorRuntime.mark(function i(t,o){var s,l,u,c,f;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return s=e._getLayerById(r),l=s.getSearchEndPoint(),u=x({layer:s,search_endpoint:l,filter:n}),i.prev=3,i.next=6,d["default"].getData("search:features",{inputs:{layer:s,filter:u,search_endpoint:l,feature_count:100},outputs:a});case 6:c=i.sent,f=c.data,t(f),i.next=15;break;case 11:i.prev=11,i.t0=i["catch"](3),m["default"].showUserMessage({type:"alert",message:"sdk.querybuilder.error_run",autoclose:!0}),o(i.t0);case 15:case"end":return i.stop()}},i,e,[[3,11]])}));return function(e,r){return t.apply(this,arguments)}}())},C.test=o(regeneratorRuntime.mark(function E(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.layerId,n=t.filter;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.run({layerId:r,filter:n,showResult:!1});case 3:return e=t.sent,t.abrupt("return",e.length&&e[0].features.length);case 7:return t.prev=7,t.t0=t["catch"](0),t.t0=_("sdk.querybuilder.error_test"),t.abrupt("return",Promise.reject(t.t0));case 11:case"end":return t.stop()}},E,this,[[0,7]])})),C["delete"]=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.id;return new Promise(function(t,n){m["default"].dialog.confirm(_("sdk.querybuilder.delete"),function(i){if(i){var a=e.getItems().filter(function(e){return e.id!==r}),o=p["default"].getCurrentProject().getId(),s=v["default"].getLocalItem(L);a.length?s[o]=a:delete s[o],Object.keys(s).length?v["default"].setLocalItem({id:L,data:s}):v["default"].removeLocalItem(L),t()}else n()})})},C.editLocalItem=function(e,t){e=e||p["default"].getCurrentProject().getId();var r=v["default"].getLocalItem(L);r[e].find(function(n,i){if(n.id===t.id)return r[e][i]=t,!0}),v["default"].setLocalItem({id:L,data:r}),this._resetItems(e,r[e])},C._resetItems=function(e,t){var r=this;setTimeout(function(){t.forEach(function(t){return r._items[e].push(t)})},0),this._items[e].splice(0)},C.addLocalItem=function(e,t){t.id=w(),e=e||p["default"].getCurrentProject().getId();var r=v["default"].getLocalItem(L);if(void 0===r){var n=[t];v["default"].setLocalItem({id:L,data:a({},e,n)}),this._resetItems(e,n)}else r[e]=r[e]?[].concat(i(r[e]),[t]):[t],v["default"].setLocalItem({id:L,data:r}),this._resetItems(e,r[e])},C.save=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.id,n=t.name,i=t.layerId,a=t.filter,o=t.projectId,s=this._getLayerById(i).getName(),l={layerId:i,filter:a,layerName:s};return r?(l.name=n,l.id=r,this.editLocalItem(o,l),void m["default"].showUserMessage({type:"success",message:_("sdk.querybuilder.messages.changed"),autoclose:!0})):void m["default"].dialog.prompt(_("sdk.querybuilder.additem"),function(t){if(t){var r=m["default"].getComponent("search").getService();l.name=t,r.addQueryBuilderSearch(l),e.addLocalItem(o,l),m["default"].showUserMessage({type:"success",message:_("sdk.querybuilder.messages.changed"),autoclose:!0})}})},C.all=function(){},C.sample=function(){},C.clear=function(){this._cacheValues={}},C.add=function(){},r["default"]=new s},{"core/i18n/i18n.service":13,"core/utils/utils":68,"services/application":351,"services/data":358,"services/gui":361,"store/catalog-layers":374,"store/projects":379}],367:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};v(this)}Object.defineProperty(r,"__esModule",{value:!0});var o=e("store/catalog-layers"),s=n(o),l=e("store/projects"),u=n(l),c=e("services/data"),d=n(c),f=e("core/utils/utils"),p=f.inherit,h=f.XHR,v=f.base,g=f.createSingleFieldParameter,m=e("core/utils/geo"),y=m.sanitizeFidFeature,_=m.getAlphanumericPropertiesFromFeature,b=e("core/g3wobject");p(a,b);var w=a.prototype;w.createUrl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=u["default"].getCurrentProject(),r=e.layer,n=void 0===r?{}:r,i=e.relation,a=void 0===i?{}:i,o=e.fid,s=e.type,l=void 0===s?"data":s,c=e.formatter,d=void 0===c?1:c,f=void 0,p=a.father,h=a.child,v=a.referencedLayer,g=a.referencingLayer,m=a.id;f=void 0!==p?n.id===p?h:p:n.id===v?g:v;var _=t.getLayerById(f).getUrl(l),b=y(o);return _+"?relationonetomany="+m+"|"+b+"&formatter="+d},w.getRelations=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.createUrl(e);return h.get({url:t})},w.getRelationsNM=i(regeneratorRuntime.mark(function x(){var e,t,r,n,i,a,o,l,u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=u.nmRelation,f=u.features,p=void 0===f?[]:f;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(e=c.referencedLayer,t=c.referencingLayer,r=c.fieldRef,n=r.referencingField,i=r.referencedField,
a=[],!p.length){u.next=8;break}return o=p.map(function(e){return e.attributes[n]}),u.next=6,d["default"].getData("search:features",{inputs:{layer:s["default"].getLayerById(e),filter:""+g({field:i,value:o,logicop:"OR"}),formatter:1,search_endpoint:"api"},outputs:null});case 6:l=u.sent,l.data&&l.data[0]&&Array.isArray(l.data[0].features)&&(a=l.data[0].features.map(function(e){var t=_(e.getProperties()).reduce(function(t,r){return t[r]=e.get(r),t},{});return{id:e.getId(),attributes:t,geometry:e.getGeometry()}}));case 8:return u.abrupt("return",a);case 9:case"end":return u.stop()}},x,this)})),w.save=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.createUrl(e);return h.fileDownload({url:t,httpMethod:"GET"})},r["default"]=new a},{"core/g3wobject":12,"core/utils/geo":64,"core/utils/utils":68,"services/data":358,"store/catalog-layers":374,"store/projects":379}],368:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("core/utils/utils"),i=n.base,a=n.inherit,o=(n.Base64,e("core/g3wobject"));crossroads.ignoreState=!0,crossroads.greedy=!0;var s=function(){this._initialLocationQuery,this._routeQuery="",this.setters={setRouteQuery:function(e){this._routeQuery=e,crossroads.parse(e)}},i(this)};a(s,o);var l=s.prototype;l.init=function(){var e=window.location.search;this._setRouteQueryFromLocationQuery(e)},l.addRoute=function(e,t,r){return crossroads.addRoute(e,t,r)},l.removeRoute=function(e){return crossroads.removeRoute(e)},l.removeAllRoutes=function(){return crossroads.removeAllRoutes()},l.parse=function(e,t){return crossroads.parse(e,t)},l["goto"]=function(e){this._initialQuery||(this._initialLocationQuery=this._stripInitialQuery(location.search.substring(1))),e&&this.setRouteQuery(e)},l.makePermalink=function(e){this._initialQuery||(this._initialLocationQuery=this._stripInitialQuery(location.search.substring(1)));this._encodeRouteQuery(e);return"?"+this._initialLocationQuery+"&q="+this._encodeRouteQuery(e)},l.makeQueryString=function(e){},l.slicePath=function(e){return e.split("?")[0].split("/")},l.sliceFirst=function(e){var t=e.split("?"),r=t[1],n=t[0].split("/"),i=n[0];return e=n.slice(1).join("/"),e=[e,r].join("?"),[i,e]},l.getQueryParams=function(e){e=e.replace("?","");var t={},r=[];r=""!=e&&e.indexOf("&")==-1?[e]:e.split("&");try{_.forEach(r,function(e){var r=e.split("="),n=r[0],i=r[1];t[n]=i})}catch(n){}return t},l.getQueryString=function(e){return e.split("?")[1]},l._getQueryPortion=function(e,t){var r;try{var n=e.split("&");_.forEach(n,function(e){var n=e.split("="),i=n[0];i==t&&(r=e)})}catch(i){}return r},l._encodeRouteQuery=function(e){return e=e.replace("?","@"),e=e.replace("&","|"),e=e.replace("=","!")},l._decodeRouteQuery=function(e){return e=e.replace("@","?"),e=e.replace("|","&"),e=e.replace("!","=")},l._setRouteQueryFromLocationQuery=function(e){var t=this._getRouteQueryFromLocationQuery(e);if(t){var r=this._decodeRouteQuery(t);this.setRouteQuery(r)}},l._getRouteQueryFromLocationQuery=function(e){return this.getQueryParams(e).q},l._stripInitialQuery=function(e){var t=this._getQueryPortion(e,"q");if(t){var r=t.length,n=e.indexOf(t);queryPrefix=_.trimEnd(e.substring(0,n),"&"),querySuffix=e.substring(n+r),querySuffix=""!=queryPrefix?querySuffix:_.trimStart(querySuffix,"&"),e=queryPrefix+querySuffix}return e},r["default"]=new s},{"core/g3wobject":12,"core/utils/utils":68}],369:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){this.stack=new f,this.setters={closeSidebarPanel:function(){},openCloseItem:function(e){}},this.state={components:[],gui:{title:""},disabled:!1},this.init=function(e){this.layout=e},this.addComponents=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.forEach(function(e){return t.addComponent(e,r)}),!0},this.addComponent=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.position,n=t.before,i=void 0===n||n,a=t.info;if(isMobile.any&&!e.mobile)return!1;var o=new h({service:this,info:a,component:e});o.title=e.title||o.title,o.info=e.info||o.info,o.actions=e.actions||o.actions,o.open=e.state.open,o.icon=e.icon||o.icon,o.iconColor=e.iconColor,o.state=e.state||!0,o.collapsible="boolean"!=typeof e.collapsible||e.collapsible,o.isolate="boolean"==typeof e.isolate&&e.isolate;var s=o.$mount().$el;this.state.components.push(e);var l=$(".g3w-sidebarpanel").is(":visible"),u="#g3w-sidebarcomponents"+(l?":hidden":""),c=$(u).children().filter(function(){return"none"!==this.style.display}),d=c.length;return null===r||void 0===r||r<0||r>=d?$(u).append(s):c.each(function(e,t){var n=Number.isInteger(r)?r===e:t.id===r;n&&$(s)["insert"+(i?"Before":"After")](t)}),e.mount("#g3w-sidebarcomponent-placeholder"),e.initService&&e.initService(),this.setComponentClickHandler(e),!0},this.setComponentClickHandler=function(e){e.click=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.open,n=void 0!==r&&r;n=n||!1,$(e.getInternalComponent().$el).siblings("a").click(),e.setOpen(n)}},this.getComponent=function(e){return this.state.components.find(function(t){return t.getId()===e})},this.getComponents=function(){return this.state.components},this.closeOpenComponents=function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.getComponents().forEach(function(e){return e.closeWhenViewportContentIsOpen()&&e.collapsible&&e.click({open:!1})})},this.reloadComponent=function(e){var t=this.getComponent(e);t&&t.reload()},this.reloadComponents=function(){this.closePanel(),this.state.components.forEach(function(e){e.collapsible&&e.state.open&&e.click({open:!1}),e.reload()})},this.removeComponent=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.position;this.state.components.forEach(function(r,i){if(e===r)return e.unmount(),t.state.components.splice(i,1),void 0!==n&&Number.isInteger(n)?$("#g3w-sidebarcomponents").children(":visible")[n].remove():$("#g3w-sidebarcomponents").children("#"+e.id).remove(),!1})},this.showPanel=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(n,i){t.state.gui.title=e.title;var o="#g3w-sidebarpanel-placeholder";t.stack.getCurrentContentData()&&$(t.stack.getCurrentContentData().content.internalPanel.$el).hide(),t.stack.push(e,a({parent:o},r)).then(function(e){return n(e)})})},this.closePanel=function(){var e=this;this.closeSidebarPanel(),this.stack.pop().then(function(t){t=null,e.stack.getCurrentContentData()&&($(e.stack.getCurrentContentData().content.internalPanel.$el).show(),e.state.gui.title=e.stack.getCurrentContentData().content.title)})},this.closeAllPanels=function(){this.state.gui.title=null,this.closeSidebarPanel(),this.stack.clear()},u(this)}Object.defineProperty(r,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("components/SidebarItem.vue"),s=n(o),l=e("core/utils/utils"),u=l.base,c=l.inherit,d=e("gui/utils/utils"),f=d.barstack,p=e("core/g3wobject"),h=Vue.extend(s["default"]);c(i,p),r["default"]=new i},{"components/SidebarItem.vue":295,"core/g3wobject":12,"core/utils/utils":68,"gui/utils/utils":188}],370:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function i(){var e=[];this.runTask=n(regeneratorRuntime.mark(function t(){var r,i,a,s,l,u,c,d,f,p,h,v,g,m,y,_,b=this,w=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=w.method,i=void 0===r?"GET":r,a=w.params,s=void 0===a?{}:a,l=w.url,u=w.taskUrl,c=w.interval,d=void 0===c?1e3:c,f=w.timeout,p=void 0===f?1/0:f,h=w.listener,v=void 0===h?function(){}:h,t.prev=1,"GET"!==i){t.next=8;break}return t.next=5,o.get({url:l,params:s});case 5:t.t0=t.sent,t.next=11;break;case 8:return t.next=10,o.post({url:l,data:s.data||{},contentType:s.contentType||"application/json"});case 10:t.t0=t.sent;case 11:if(g=t.t0,m=g.result,y=g.task_id,!m){t.next=19;break}_=setInterval(n(regeneratorRuntime.mark(function x(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(p-=d,!(p>0)){t.next=15;break}return e=void 0,t.prev=3,t.next=6,o.get({url:""+u+y});case 6:e=t.sent,t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](3),e=t.t0;case 12:v({task_id:y,timeout:!1,response:e}),t.next=17;break;case 15:v({timeout:!0}),b.stopTask({task_id:y});case 17:case"end":return t.stop()}},x,b,[[3,9]])})),d),e.push({task_id:y,intervalId:_}),v({task_id:y,response:g}),t.next=20;break;case 19:return t.abrupt("return",Promise.reject(g));case 20:t.next=25;break;case 22:return t.prev=22,t.t1=t["catch"](1),t.abrupt("return",Promise.reject(t.t1));case 25:case"end":return t.stop()}},t,this,[[1,22]])})),this.stopTask=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.task_id,n=e.find(function(e){return e.task_id===r});n&&clearInterval(n.intervalId)},this.clear=function(){var t=this;e.forEach(function(e){var r=e.taskId;t.stopTask({taskId:r})}),e.splice(0)}}Object.defineProperty(r,"__esModule",{value:!0});var a=e("core/utils/utils"),o=a.XHR;r["default"]=new i},{"core/utils/utils":68}],371:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=e("store/application-state"),o=n(a),s=e("app/constant"),l=e("services/gui"),u=n(l),c=e("core/utils/utils"),d=c.base,f=c.inherit,p=c.uniqueId,h=e("core/g3wobject"),v=function(){this.state={primaryView:"map",secondaryPerc:0,resized:{start:!1,h:!1,v:!1},split:"h",map:{sizes:{width:0,height:0},aside:!1},content:{loading:!1,disabled:!1,sizes:{width:0,height:0},resize:{h:{perc:0},v:{perc:0}},aside:!0,showgoback:!0,stack:[],closable:!0,backonclose:!1,contentsdata:[]},usermessage:{id:null,show:!1,title:null,message:null,position:null,type:null,draggable:null,cloasable:null,autoclose:null,textMessage:!1,hooks:{header:null,body:null,footer:null}}},this._components={map:null,content:null},this._defaultMapComponent,this._contextualMapComponent,this._secondaryViewMinWidth=s.VIEWPORT.resize.content.min,this._secondaryViewMinHeight=s.VIEWPORT.resize.content.min,this._immediateComponentsLayout=!0,this.init=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.primaryview,r=void 0===t?"map":t,n=e.split,i=void 0===n?"h":n,a=e.components;this.state.primaryView=r,this.state.split=i,this._addComponents(a)},this.setResized=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.state.resized[e]=t},this.showUserMessage=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.title,n=t.subtitle,i=t.message,a=t.type,o=t.position,s=t.size,l=t.draggable,u=t.duration,c=t.textMessage,d=void 0!==c&&c,f=t.closable,h=t.autoclose,v=t.hooks,g=void 0===v?{}:v;return this.closeUserMessage(),setTimeout(function(){e.state.usermessage.id=p(),e.state.usermessage.show=!0,e.state.usermessage.message=i,e.state.usermessage.textMessage=d,e.state.usermessage.title=r,e.state.usermessage.subtitle=n,e.state.usermessage.position=o,e.state.usermessage.duration=u,e.state.usermessage.type=a,e.state.usermessage.show=!0,e.state.usermessage.size=s,e.state.usermessage.autoclose=h,e.state.usermessage.closable=f,e.state.usermessage.draggable=l,e.state.usermessage.hooks.header=g.header,e.state.usermessage.hooks.body=g.body,e.state.usermessage.hooks.footer=g.footer}),this.state.usermessage},this.closeUserMessage=function(){this.state.usermessage.id=null,this.state.usermessage.show=!1,this.state.usermessage.textMessage=!1,this.state.usermessage.message=""},this.getState=function(){return this.state},this.getMapState=function(){return this.state.map},this.getContentState=function(){return this.state.content},this.setLoadingContent=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state.content.loading=e},this._addComponents=function(e){var t=this;Object.entries(e).forEach(function(e){var r=i(e,2),n=r[0],a=r[1];Object.keys(t._components).indexOf(n)>-1&&a.mount("#g3w-view-"+n,!0).then(function(){t._components[n]=a,"map"===n&&(t._defaultMapComponent=a)}).fail(function(e){})})},this.showMap=function(){this._toggleMapComponentVisibility(this._defaultMapComponent,!0),this._components.map=this._defaultMapComponent,this._showView("map")},this.showContextualMap=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._contextualMapComponent||(this._contextualMapComponent=this._defaultMapComponent),this._contextualMapComponent!=this._defaultMapComponent&&this._toggleMapComponentVisibility(this._defaultMapComponent,!1),this._contextualMapComponent.ismount())this._components.map=this._contextualMapComponent,this._toggleMapComponentVisibility(this._contextualMapComponent,!0);else{var r=this._contextualMapComponent;r.mount("#g3w-view-map",!0).then(function(){return e._components.map=r})}this._showView("map",t)},this.recoverDefaultMap=function(){return this._components.map!==this._defaultMapComponent&&(this._components.map=this._defaultMapComponent,this._toggleMapComponentVisibility(this._contextualMapComponent,!1),this._toggleMapComponentVisibility(this._defaultMapComponent,!0)),this._components.map},this.setContextualMapComponent=function(e){e!==this._defaultMapComponent&&(this._contextualMapComponent&&this._contextualMapComponent.unmount(),this._contextualMapComponent=e)},this.resetContextualMapComponent=function(){this._contextualMapComponent&&this._contextualMapComponent.unmount(),this._contextualMapComponent=this._defaultMapComponent},this._toggleMapComponentVisibility=function(e,t){e.internalComponent.$el.style.display=t?"block":"none"},this.closeMap=function(){this.state.secondaryPerc="map"===this.state.primaryView?100:0,this.recoverDefaultMap(),this._layout()},this.showContent=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.perc=void 0!==t.perc?t.perc:this.getContentPercentageFromCurrentLayout(),t.push=t.push||!1;var r=100===t.perc?"show-content-full":"show-content";this._prepareContentView(t),this._immediateComponentsLayout=!1,this._showView("content",t),this._components.content.setContent(t).then(function(){e._immediateComponentsLayout=!0,e._layoutComponents(r)})},this.hideContent=function(e){var t=this.getContentPercentageFromCurrentLayout(this.state.split);return this.state.secondaryVisible=!e,this._layout("hide-content"),t},this.resetToDefaultContentPercentage=function(){var e=this.getCurrentContentLayout();e[""+("h"===this.state.split?"width":"height")]=e[("h"===this.state.split?"width":"height")+"_default"],e[("h"===this.state.split?"width":"height")+"_100"]=!1,this._layoutComponents()},this.toggleFullViewContent=function(){o["default"].gui.layout[o["default"].gui.layout.__current].rightpanel[("h"===this.state.split?"width":"height")+"_100"]=!o["default"].gui.layout[o["default"].gui.layout.__current].rightpanel[("h"===this.state.split?"width":"height")+"_100"],this._layoutComponents()},this.isFullViewContent=function(){return o["default"].gui.layout[o["default"].gui.layout.__current].rightpanel[("h"===this.state.split?"width":"height")+"_100"]},this.contentLength=function(){return this.state.content.contentsdata.length},this.popContent=function(){var e=this,t=$.Deferred();if(this.state.content.contentsdata.length){this.recoverDefaultMap();var r=this._components.content.getPreviousContentData();this._prepareContentView(r.options),this._immediateComponentsLayout=!1,this._showView("content",r.options),this._components.content.popContent().then(function(){e.state.secondaryPerc=r.options.perc,e._immediateComponentsLayout=!0,e._layout("pop-content"),t.resolve(e._components.contentgetCurrentContentData)})}else t.reject();return t.promise()},this.getCurrentContent=function(){return this.contentLength()?this.state.content.contentsdata[this.contentLength()-1]:null},this.getCurrentContentTitle=function(){var e=this.getCurrentContent();return e&&e.options.title},this.getCurrentContentId=function(){var e=this.getCurrentContent();return e&&e.options.id},this.changeCurrentContentOptions=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.getCurrentContent();if(t){var r=e.title,n=e.crumb;r&&(t.options.title=r),n&&(t.options.crumb=n)}},this.changeCurrentContentTitle=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.getCurrentContent();t&&(t.options.title=e)},this.isContentOpen=function(){return!!this.state.content.contentsdata.length},this.closeContent=function(){var e=this,t=$.Deferred();if(this.isContentOpen())this._components.content.removeContent(),this.closeSecondaryView("close-content").then(function(){var r=e.recoverDefaultMap();t.resolve(r)});else{var r=this.recoverDefaultMap();t.resolve(r)}return t.promise()},this.disableContent=function(e){this.state.content.disabled=e},this.removeContent=function(){return this.state.content.backonclose&&this.state.content.contentsdata.length>1?void this.popContent():this.closeContent()},this.isPrimaryView=function(e){return this.state.primaryView==e},this.setPrimaryView=function(e){this.state.primaryView!==e&&(this.state.primaryView=e),this._layout()},this.showPrimaryView=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e&&this.state.secondaryVisible&&100===this.state.secondaryPerc&&(this.state.secondaryPerc=100-e,this._layout())},this.showSecondaryView=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.split,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state.perc;this.state.secondaryVisible=!0,this.state.split=e,this.state.secondaryPerc=t,this._layout()},this.closeSecondaryView=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=$.Deferred(),n=this._components[this._otherView(this.state.primaryView)];return n.clearContents?n.clearContents().then(function(){e.state.secondaryVisible=!1,e.state.secondaryPerc=0,e._layout(t),Vue.nextTick(function(){return r.resolve()})}):(this.state.secondaryVisible=!1,this._layout(t),Vue.nextTick(function(){return r.resolve()})),r.promise()},this.getDefaultViewPerc=function(e){return this.isPrimaryView(e)?100:50},this._otherView=function(e){return"map"===e?"content":"map"},this._isSecondary=function(e){return this.state.primaryView!==e},this._setPrimaryView=function(e){this.state.primaryView!==e&&(this.state.primaryView=e)},this._prepareContentView=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.title,r=e.split,n=void 0===r?null:r,i=e.closable,a=void 0===i||i,o=e.backonclose,s=void 0===o||o,l=e.style,u=void 0===l?{}:l,c=e.showgoback,d=void 0===c||c,f=e.headertools,p=void 0===f?[]:f;this.state.content.title=t,this.state.content.split=n,this.state.content.closable=a,this.state.content.backonclose=s,this.state.content.contentsdata=this._components.content.contentsdata,this.state.content.style=u,this.state.content.headertools=p,this.state.content.showgoback=d},this._showView=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.perc,n=void 0===r?this.getDefaultViewPerc(e):r,i=t.split,a=void 0===i?"h":i,o=void 0;o=!this.isPrimaryView(e)||"undefined"!=typeof t.aside&&t.aside,this.state[e].aside=o;var s=this.isPrimaryView(e)?100-n:n;return s>0?void this.showSecondaryView(a,s):this.closeSecondaryView()},this._getReducedSizes=function(){var e=$(".content"),t=0,r=0,n=$(".sidebar-aside-toggle");if(e&&this.state.secondaryVisible&&this.isFullViewContent()){if(n&&n.is(":visible")){var i=n.outerWidth();e.css("padding-left",i+5),t=i-5}}else{var a=n.outerWidth();e.css("padding-left",100===this.state.secondaryPerc?a+5:15)}return{reducedWidth:t,reducedHeight:r}},this._layout=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this._getReducedSizes();this._setViewSizes(t.reducedWidth,t.reducedHeight),this._immediateComponentsLayout&&this._layoutComponents(e)},this._setViewSizes=function(){var e=this.state.primaryView,t=this._otherView(e),r=this.getViewportSize(),n=r.width,i=r.height,a=void 0,o=void 0,s=void 0,l=void 0,u=(100===this.state.secondaryPerc||this.isFullViewContent()?100:this.getContentPercentageFromCurrentLayout(this.state.split))/100;"h"===this.state.split?(s=this.state.secondaryVisible?Math.max(n*u,this._secondaryViewMinWidth):0,l=i,a=n-s,o=i):(s=n,l=this.state.secondaryVisible?Math.max(i*u,this._secondaryViewMinHeight):0,a=this.state.secondaryVisible&&1===u?0:n,o=i-l),this.state[e].sizes.width=a,this.state[e].sizes.height=o,this.state[t].sizes.width=s,this.state[t].sizes.height=l},this.getViewportSize=function(){return{width:this._viewportWidth(),height:this._viewportHeight()}},this._viewportHeight=function(){var e=$(".navbar-header").innerHeight();return $(document).innerHeight()-e},this._viewportWidth=function(){var e=$(".main-sidebar"),t=e.length&&e.offset().left,r=e.length&&e[0].getBoundingClientRect().width,n=r+t;return $("#app")[0].getBoundingClientRect().width-n},this.resizeViewComponents=function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments[2]);this.setResized(e,!0),this.setContentPercentageFromCurrentLayout(e,t),this._layout("resize")},this.setContentPercentageFromCurrentLayout=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.split,t=arguments[1];this.getCurrentContentLayout()["h"===e?"width":"height"]=t},this.getContentPercentageFromCurrentLayout=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.split;return this.getCurrentContentLayout()["h"===e?"width":"height"]},this.getCurrentContentLayout=function(){return o["default"].gui.layout[o["default"].gui.layout.__current].rightpanel},this._layoutComponents=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;requestAnimationFrame(function(){var r=e._getReducedSizes(),n=r.reducedWidth||0,a=r.reducedHeight||0;e._setViewSizes(),Object.entries(e._components).forEach(function(t){var r=i(t,2),o=r[0],s=r[1],l=e.state[o].sizes.width-n,u=e.state[o].sizes.height-a;s.layout(l,u)}),t&&setTimeout(function(){e.emit(t),u["default"].emit(t)})})},this._firstLayout=function(){function e(){n=!0,i()}var t=this,r=!1,n=!1,i=function a(){n===!0?(n=!1,r=!0,t._layout("resize"),requestAnimationFrame(a)):r=!1};u["default"].on("ready",function(){t.SIDEBARWIDTH=u["default"].getSize({element:"sidebar",what:"width"}),t._layout(),u["default"].on("guiresized",function(){return e()}),$(window).resize(function(){r===!1&&e()}),$(".main-sidebar").on("webkitTransitionEnd transitionend msTransitionEnd oTransitionEnd",function(t){t.target===this&&($(this).trigger("trans-end"),e())})})},this._firstLayout(),d(this)};f(v,h),r["default"]=new v},{"app/constant":4,"core/g3wobject":12,"core/utils/utils":68,"services/gui":361,"store/application-state":373}],372:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=function(){this._workflows=[],this.push=function(e){return this._workflows.indexOf(e)===-1?this._workflows.push(e)-1:this._workflows.indexOf(e)},this.getParent=function(){var e=this._getCurrentIndex();return e>0&&this._workflows[e-1]},this.getParents=function(){var e=this._getCurrentIndex();return e>0&&this._workflows.slice(0,e)},this.pop=function(){return this._workflows.pop()},this.getLength=function(){return this._workflows.length},this._getCurrentIndex=function(){var e=this.getCurrent();return this._workflows.findIndex(function(t){return t===e})},this.getCurrent=function(){return this.getLast()},this.getLast=function(){var e=this._workflows.length;return e?this._workflows[e-1]:null},this.getFirst=function(){return this._workflows[0]},this.removeAt=function(e){this._workflows.splice(e,1)},this.getAt=function(e){return this._workflows[e]},this.insertAt=function(e,t){this._workflows[e]=t},this.clear=function(){for(;this._workflows.length;){var e=this.pop();e.stop()}}};r["default"]=new n},{}],373:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=Vue.observable({ready:!1,iframe:!1,online:!1,ismobile:!1,download:!1,upload:!1,baseLayerId:null,language:"en",lng:"en",changeProjectview:!1,plugins:[],user:null,map:{epsg:"",unit:"metric"},gui:{app:{disabled:!1},sidebar:{disabled:!1},layout:{__current:"app",app:{}}},keys:{vendorkeys:{google:void 0,bing:void 0}},tokens:{filtertoken:void 0}});r.STATE_METHODS={};r["default"]=n},{}],374:[function(e,t,r){function n(){a(this)}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("core/layers/layersstoresregistry");o(n,s),r["default"]=new n},{"core/layers/layersstoresregistry":37,"core/utils/utils":68}],375:[function(e,t,r){function n(){this.components={},this.registerComponent=function(e){var t=e.getId();this.components[t]||(this.components[t]=e,this.emit("componentregistered",e))},this.getComponent=function(e){return this.components[e]},this.getComponents=function(){return this.components},this.unregisterComponent=function(e){var t=this.components[e];return t&&("function"==typeof t.destroy&&t.destroy(),this.components[e]=null),t},o(this)}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/g3wobject"),a=e("core/utils/utils"),o=a.base,s=a.inherit;s(n,i),r["default"]=new n},{"core/g3wobject":12,"core/utils/utils":68}],376:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=this;this._controls={},this._offlineids=[],this.selectedLayer=null,this.externalLayers=[],o["default"].on("complete",function(){var t=l["default"].getService("catalog"),r={};t.onafter("addExternalLayer",function(t){var n=t.layer,i=t.type;"vector"===i&&(e.externalLayers.push(n),r[n.name]=[u.VM.$watch(function(){return n.selected},function(t){e.setSelectedLayer(!0===t?n:null)})],e.callControlsEventHandler({handler:"onAddExternalLayer",param:{layer:n,unWatches:r[n.name]}}))}),t.onafter("removeExternalLayer",function(t){var n=t.name,i=t.type;"vector"===i&&(e.externalLayers=e.externalLayers.filter(function(t){return n===t.name&&e.callControlsEventHandler({handler:"handleRemoveExternalLayer",param:t}),n===t.name&&t===e.selectedLayer&&e.setSelectedLayer(null),n!==t.name}),r[n].forEach(function(e){return e()}),delete r[n])})}),o["default"].onbefore("offline",function(){e._offlineids.forEach(function(t){var r=e._controls[t.id];t.enable=r.getEnable(),r.setEnable(!1)})}),o["default"].onbefore("online",function(){e._offlineids.forEach(function(t){e._controls[t.id].setEnable(t.enable)})}),this.setters={registerControl:function(e,t){this._registerControl(e,t)}},this.setSelectedLayer=function(e){this.selectedLayer=e},this.getSelectedLayer=function(){return this.selectedLayer},this.getExternalLayers=function(){return this.externalLayers},this.catalogSelectedLayer=function(e){this.setSelectedLayer(e.isSelected()?e:null),this.callControlsEventHandler({handler:"onSelectLayer",param:this.selectedLayer})},this.callControlsEventHandler=function(e){var t=e.handler,r=e.param;Object.values(this._controls).forEach(function(e){"function"==typeof e[t]&&e[t](r)})},this._registerControl=function(e,t){this._controls[e]=t,t.offline===!1&&(this._offlineids.push({id:e,enable:t.getEnable()}),t.getEnable()&&t.setEnable(o["default"].isOnline()))},this.getControl=function(e){return this._controls[e]},this.getControls=function(){return this._controls},this.unregisterControl=function(e){var t=this.getControl(e);return!!t&&(l["default"].getService("map").getMap().removeControl(t),delete this._controls[e],this._offlineids=this._offlineids.filter(function(t){return t!==e}),!0)},d(this)}Object.defineProperty(r,"__esModule",{value:!0});var a=e("services/application"),o=n(a),s=e("services/gui"),l=n(s),u=e("g3w-ol/constants"),c=e("core/utils/utils"),d=c.base,f=c.inherit,p=e("core/g3wobject");f(i,p),r["default"]=new i},{"core/g3wobject":12,"core/utils/utils":68,"g3w-ol/constants":75,"services/application":351,"services/gui":361}],377:[function(e,t,r){function n(){o(this)}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("core/layers/layersstoresregistry");a(n,s),r["default"]=new n},{"core/layers/layersstoresregistry":37,"core/utils/utils":68}],378:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(){var e=this;this.config=null,this._plugins={},this._configurationPlugins=[],this.pluginsConfigs={},this._loadedPluginUrls=[],this.setters={registerPlugin:function(e){this._plugins[e.name]||(this._plugins[e.name]=e)}},u["default"].onafter("setCurrentProject",function(t){e.gidProject=t.getGid()}),p(this),this.init=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise(function(){var r=i(regeneratorRuntime.mark(function n(r,i){var a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e.pluginsBaseUrl=t.pluginsBaseUrl,e.setPluginsConfig(t.pluginsConfigs),Object.keys(e.pluginsConfigs).forEach(function(t){return e._configurationPlugins.push(t)}),e.addLoadingPlugins(),e.otherPluginsConfig=t.otherPluginsConfig,e.setOtherPlugins(),e.setDependencyPluginConfig(),n.prev=7,n.next=10,e._loadPlugins();case 10:a=n.sent,r(a),n.next=17;break;case 14:n.prev=14,n.t0=n["catch"](7),i(n.t0);case 17:case"end":return n.stop()}},n,e,[[7,14]])}));return function(e,t){return r.apply(this,arguments)}}())},this.addLoadingPlugins=function(){Object.keys(this.pluginsConfigs).forEach(function(e){return d["default"].loadingPlugin(e)})},this.removeLoadingPlugin=function(e,t){d["default"].loadedPlugin(e,t)},this._loadPlugins=function(){var e=this,t=Object.entries(this.pluginsConfigs).map(function(t){var r=s(t,2),n=r[0],i=r[1];return e._setup(n,i)});return Promise.allSettled(t)},this.setDependencyPluginConfig=function(){var e=this,t=function(t){var r=e.pluginsConfigs[t].plugins;r&&Object.keys(r).forEach(function(t){e.pluginsConfigs[t]=o({},e.pluginsConfigs[t],r[t])})};for(var r in this.pluginsConfigs)t(r)},this.setOtherPlugins=function(){var e=g[0];this.otherPluginsConfig&&this.otherPluginsConfig[e]&&this.otherPluginsConfig[e].length?(this.pluginsConfigs[e]=this.otherPluginsConfig[e],this.pluginsConfigs[e].gid=this.otherPluginsConfig.gid):delete this.pluginsConfigs[e]},this.reloadPlugins=function(e,t){var r=this;return new Promise(function(){var n=i(regeneratorRuntime.mark(function a(n,i){var o,s,l,u,c;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:o=$("script"),s=r.getPlugins(),l=function(e){var t=s[e];t.unload(),delete r._plugins[e],o.each(function(t,n){r._loadedPluginUrls.forEach(function(t,i){if(n.getAttribute("src")===t&&t.indexOf(e)!==-1)return n.parentNode.removeChild(n),r._loadedPluginUrls.splice(i,1),!1})})};for(u in s)l(u);return r._loadedPluginUrls=[],r.otherPluginsConfig=t.getState(),r.setPluginsConfig(e.group.plugins),r.addLoadingPlugins(),r.setOtherPlugins(),a.prev=9,a.next=12,r._loadPlugins();case 12:c=a.sent,n(c),a.next=19;break;case 16:
a.prev=16,a.t0=a["catch"](9),i(a.t0);case 19:case"end":return a.stop()}},a,r,[[9,16]])}));return function(e,t){return n.apply(this,arguments)}}())},this.setPluginsConfig=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r={};Object.entries(t).filter(function(t){var r=s(t,2),n=r[1];return n.gid===e.gidProject}).forEach(function(e){var t=s(e,2),n=t[0],i=t[1];return r[n]=i}),this.pluginsConfigs=r},this._loadScript=function(e){return $.getScript(e)},this._setup=function(e,t){var r=this;return new Promise(function(){var n=i(regeneratorRuntime.mark(function a(n,i){var o,s,l,u,c,d,f,p,h,v,g,m;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(_.isNull(t)){a.next=38;break}for(o=t.jsscripts,s=void 0===o?[]:o,l=[],u=function(e){l.push(new Promise(function(t,n){r._loadScript(e).done(function(){return t()}).fail(function(){return n()})}))},c=!0,d=!1,f=void 0,a.prev=7,p=s[Symbol.iterator]();!(c=(h=p.next()).done);c=!0)v=h.value,u(v);a.next=15;break;case 11:a.prev=11,a.t0=a["catch"](7),d=!0,f=a.t0;case 15:a.prev=15,a.prev=16,!c&&p["return"]&&p["return"]();case 18:if(a.prev=18,!d){a.next=21;break}throw f;case 21:return a.finish(18);case 22:return a.finish(15);case 23:return a.prev=23,a.next=26,Promise.all(l);case 26:g=""+r.pluginsBaseUrl+e,m=g+"/js/plugin.js?"+Date.now(),t.baseUrl=r.pluginsBaseUrl,r._loadScript(m).done(function(){r._loadedPluginUrls.push(m),n()}).fail(function(){r.removeLoadingPlugin(e,!1),i()}),a.next=36;break;case 32:a.prev=32,a.t1=a["catch"](23),r.removeLoadingPlugin(e,!1),i();case 36:a.next=39;break;case 38:n();case 39:case"end":return a.stop()}},a,r,[[7,11,15,23],[16,,18,22],[23,32]])}));return function(e,t){return n.apply(this,arguments)}}())},this.getPluginConfig=function(e){return this.pluginsConfigs[e]},this.getPlugins=function(){return this._plugins},this.getPlugin=function(e){return this._plugins[e]},this.isPluginInConfiguration=function(e){return this._configurationPlugins.indexOf(e)!==-1},this.isTherePlugin=function(e){return this.pluginsConfigs[e]}}Object.defineProperty(r,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=e("store/projects"),u=n(l),c=e("services/application"),d=n(c),f=e("core/utils/utils"),p=f.base,h=f.inherit,v=e("core/g3wobject"),g=["law"];h(a,v),r["default"]=new a},{"core/g3wobject":12,"core/utils/utils":68,"services/application":351,"store/projects":379}],379:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){this.config=null,this.initialized=!1,this.projectType=null,this.currentProjectGroup=null,this.overviewproject=void 0,this.setters={createProject:function(e){},setCurrentProject:function(e){this.state.currentProject!==e&&(o["default"].removeLayersStores(),l["default"].removeLayersStores()),this.state.currentProject=e,this.state.qgis_version=e.getQgisVersion(),this.setProjectType(e.state.type);var t=e.getLayersStore();o["default"].addLayersStore(t,0),l["default"].addLayersStore(t,0)}},this.state={baseLayers:{},minScale:null,maxscale:null,currentProject:null,qgis_version:null},this._groupProjects=[],this._projectConfigs={},this.init=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred();return this.initialized?(r.resolve(this.getCurrentProject()),r.promise()):(this.config=t,this.currentProjectGroup=t.group,this.overviewproject=t.overviewproject,this.setupState(),this.getProject(t.initproject,{map_theme:new URLSearchParams(location.search).get("map_theme")}).then(function(t){e.setCurrentProject(t),e.initialized=!0,r.resolve(t)}).fail(function(e){return r.reject(e)}),r.promise())},this.clear=function(){this.config=null,this.initialized=!1,this.projectType=null,this.overviewproject=void 0,this.initialized=!1,this._groupProjects=[],this._projectConfigs={},this.state={baseLayers:{},minScale:null,maxscale:null,currentProject:null,qgis_version:null}},this.setProjectType=function(e){this.projectType=e},this.getConfig=function(){return this.config},this.getState=function(){return this.state},this.setupState=function(){this.state.baseLayers=this.config.baselayers,this.state.minScale=this.config.minscale,this.state.maxScale=this.config.maxscale,this.state.crs=this.config.crs,this.setProjects(this.config.projects)},this.getProjectType=function(){return this.projectType},this.getProjects=function(){return this._groupProjects},this.setProjects=function(e){var t=this;this.clearProjects(),e.forEach(function(e){t.state.qgis_version=e.qgis_version||t.state.qgis_version,e.baselayers=t.config.baselayers,e.minscale=t.config.minscale,e.maxscale=t.config.maxscale,e.crs=t.config.crs,e.vectorurl=t.config.vectorurl,e.rasterurl=t.config.rasterurl,e.overviewprojectgid=t.overviewproject?t.overviewproject.gid:null,t._groupProjects.push(e)})},this.clearProjects=function(){this._groupProjects=[]},this.getListableProjects=function(){var e=this.getCurrentProject().getId();return _.sortBy(this.getProjects().filter(function(t){return _.isNil(t.listable)?!(t.id===e||t.overviewprojectgid&&t.gid===t.overviewprojectgid)&&t:t.listable}),"title")},this.getCurrentProject=function(){return this.state.currentProject},this.getProject=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{reload:!1},n=$.Deferred(),i=this._groupProjects.find(function(t){return t.gid===e});if(!i)return n.reject("Project doesn't exist"),n.promise();var a=!r.reload&&this._projectConfigs[e];return a?(n.resolve(new p(a)),n.promise()):(this._getProjectFullConfig(i,{map_theme:r.map_theme}).then(function(e){var r=_.merge(i,e);r.WMSUrl=t.config.getWmsUrl(r),r.relations=t._setProjectRelations(r),t._projectConfigs[r.gid]=r,t.createProject(r),n.resolve(new p(r))}).fail(function(e){return n.reject(e)}),n.promise())},this._setProjectRelations=function(e){var t=this;return e.relations=(e.relations?e.relations:[]).map(function(r){return r=t._updateRelation(e,r)}),e.relations},this._updateRelation=function(e,t){return"ONE"===t.type&&e.layers.find(function(e){if(e.id===t.referencingLayer)return t.name=e.name,t.origname=e.origname,!0}),t},this.getProjectConfigByGid=function(e){return this._groupProjects.find(function(t){return t.gid===e})},this.setProjectAliasUrl=function(e){var t=this.config.projects.find(function(t){return t.gid===e.gid});t&&(t.url=t&&""+(e.host||"")+e.url)},this.getProjectUrl=function(e){var t=this.config&&this.config.urls&&this.config.urls.baseurl,r=this.getProjectConfigByGid(e),n=r.url;try{return""+new URL(t)+n}catch(i){return""+location.origin+t+n}},this.getBaseUrl=function(){return this.config.urls.baseurl},this._getProjectFullConfig=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=$.Deferred();return $.get(this.config.getProjectConfigUrl(e)).done(function(n){if(!t.map_theme)return void r.resolve(n);var i=n.map_themes.find(function(e){var r=e.theme;return r===t.map_theme});i&&$.get("/"+e.type+"/api/prjtheme/"+e.id+"/"+t.map_theme).done(function(e){var t=e.result,r=e.data;t&&(n.layerstree=r,i.layetstree=r,i["default"]=!0)}).always(function(){r.resolve(n)})}).fail(function(e){return r.reject(e)}),r.promise()},this.getCurrentProjectGroup=function(){return this.currentProjectGroup},c(this)}Object.defineProperty(r,"__esModule",{value:!0});var a=e("store/catalog-layers"),o=n(a),s=e("store/map-layers"),l=n(s),u=e("core/utils/utils"),c=u.base,d=u.inherit,f=e("core/g3wobject"),p=e("core/project/project");d(i,f),r["default"]=new i},{"core/g3wobject":12,"core/project/project":61,"core/utils/utils":68,"store/catalog-layers":374,"store/map-layers":377}],380:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=function(){this._sessions={},this.register=function(e){var t=e.getId();this._sessions[t]=e},this.unregister=function(e){delete this._sessions[e]},this.getSession=function(e){return this._sessions[e]},this.setSession=function(e,t){this._sessions[e]=t},this.getSessions=function(){return this._sessions},this.clear=function(){this._sessions={}}};r["default"]=new n},{}],381:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]="3.8.15"},{}]},{},[328]);
//# sourceMappingURL=app.min.js.map
