!function r(i,a,o){function s(t,e){if(!a[t]){if(!i[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(l)return l(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}n=a[t]={exports:{}},i[t][0].call(n.exports,function(e){return s(i[t][1][e]||e)},n,n.exports,r,i,a,o)}return a[t].exports}for(var l="function"==typeof require&&require,e=0;e<o.length;e++)s(o[e]);return s}({1:[function(e,t,n){var r,i,t=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(e){i=o}function s(t){if(r===setTimeout)return setTimeout(t,0);if((r===a||!r)&&setTimeout)return(r=setTimeout)(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}var l,u=[],c=!1,d=-1;function p(){c&&l&&(c=!1,l.length?u=l.concat(u):d=-1,u.length)&&f()}function f(){if(!c){for(var e=s(p),t=(c=!0,u.length);t;){for(l=u,u=[];++d<t;)l&&l[d].run();d=-1,t=u.length}l=null,c=!1,!function(t){if(i===clearTimeout)return clearTimeout(t);if((i===o||!i)&&clearTimeout)return(i=clearTimeout)(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function g(){}t.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new h(e,t)),1!==u.length||c||s(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=g,t.addListener=g,t.once=g,t.off=g,t.removeListener=g,t.removeAllListeners=g,t.emit=g,t.prependListener=g,t.prependOnceListener=g,t.listeners=function(e){return[]},t.binding=function(e){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(e){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],2:[function(e,t,n){var r=n.cache={};function i(){}n.insert=function(e){if(r[e])return i;r[e]=!0;var t=document.createElement("style");return t.setAttribute("type","text/css"),"textContent"in t?t.textContent=e:t.styleSheet.cssText=e,document.getElementsByTagName("head")[0].appendChild(t),function(){document.getElementsByTagName("head")[0].removeChild(t),r[e]=!1}}},{}],3:[function(qt,Yt,e){!function(e){!function(){var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},e=qt("app/constant"),t=M(e),n=M(qt("store/application-state")),i=M(qt("services/application")),a=qt("utils/addZValueToOLFeatureGeometry"),o=qt("utils/is3DGeometry"),s=qt("utils/removeZValueToOLFeatureGeometry"),l=qt("utils/sanitizeFidFeature"),u=qt("utils/getOLGeometry"),c=qt("utils/isMultiGeometry"),d=qt("utils/getAllPointGeometryTypes"),p=qt("utils/isPointGeometryType"),f=qt("utils/getAllLineGeometryTypes"),h=qt("utils/isLineGeometryType"),g=qt("utils/getAllPolygonGeometryTypes"),v=qt("utils/isPolygonGeometryType"),m=qt("utils/coordinatesToGeometry"),y=qt("utils/getDefaultLayerStyle"),_=qt("utils/createLayerStyle"),b=qt("utils/createFeatureFromCoordinates"),w=qt("utils/createFeatureFromBBOX"),x=qt("utils/createFeatureFromGeometry"),S=qt("utils/createFeatureFromFeatureObject"),L=qt("utils/createOlLayer"),C=qt("utils/createWMSLayer"),R=qt("utils/createVectorLayerFromFeatures"),N=qt("utils/createVectorLayerFromGeometry"),G=qt("utils/createVectorLayerFromFile"),D=qt("utils/createStyleFunctionToVectorLayer"),B=qt("utils/createSelectedStyle"),V=qt("utils/getAlphanumericPropertiesFromFeature"),U=qt("utils/getFormDataExpressionRequestFromFeature"),$=qt("utils/convertFeatureToGEOJSON"),z=qt("utils/getQueryLayersPromisesByBBOX"),q=qt("utils/getQueryLayersPromisesByGeometry"),Y=qt("utils/getQueryLayersPromisesByCoordinates"),W=qt("utils/transformBBOX"),H=qt("utils/parseQueryLayersPromiseResponses"),Q=qt("utils/getMapLayerById"),Z=qt("utils/getMapLayersByFilter"),K=qt("utils/areCoordinatesEqual"),X=qt("utils/getFeaturesFromResponseVectorApi"),J=qt("utils/convertVectorFeaturesToResultFeatures"),ee=qt("utils/splitGeometryLine"),te=qt("utils/splitFeatures"),ne=qt("utils/splitFeature"),re=qt("utils/getPointFeaturesfromGeometryVertex"),ie=qt("utils/getVertexLength"),ae=qt("utils/isSameBaseGeometryType"),oe=qt("utils/isSingleGeometry"),se=qt("utils/singleGeometriesToMultiGeometry"),le=qt("utils/multiGeometryToSingleGeometries"),ue=qt("utils/convertSingleMultiGeometry"),ce=qt("utils/dissolve"),de=qt("utils/within"),pe=qt("utils/intersects"),fe=qt("utils/findSelfIntersects"),he=qt("utils/normalizeEpsg"),ge=qt("utils/crsToCrsObject"),ve=qt("utils/convertDMToDEG"),me=qt("utils/convertDEGToDM"),ye=qt("utils/convertDMSToDEG"),_e=qt("utils/convertDEGToDMS"),be=qt("utils/getGeoTIFFfromServer"),we=qt("utils/createOlFeatureFromApiResponseFeature"),xe=qt("utils/parseAttributes"),Se=qt("utils/handleQueryResponse"),Le=qt("utils/distance"),Ce=qt("utils/squaredDistance"),Ee=qt("utils/closestOnSegment"),Te=qt("utils/get_legend_params"),ke=M(qt("components/InputG3W.vue")),Me=M(qt("components/InputG3WFormInputs.vue")),Pe=M(qt("components/FormBody.vue")),Oe=M(qt("components/FormFooter.vue")),E=M(qt("components/C3XYLine.vue")),Fe=M(qt("store/catalog-layers")),Ie=M(qt("services/data")),je=M(qt("services/iframe")),Ae=M(qt("store/map-layers")),T=M(qt("store/plugins")),Re=M(qt("store/projects")),Ne=M(qt("services/relations")),Ge=M(qt("services/tasks")),De=M(qt("services/api")),Be=M(qt("services/router")),k=M(qt("services/gui")),Ve=M(qt("mixins")),Ue=qt("utils/reverseGeometry"),$e=qt("utils/getExtentForViewAndSize"),ze=qt("utils/createPolygonLayerFromBBox"),qe=qt("utils/getLengthMessageText"),Ye=qt("utils/needUseSphereMethods"),We=qt("utils/transformMeterLength"),He=qt("utils/createMeasureTooltip"),Qe=qt("utils/formatMeasure"),Ze=qt("utils/getCurrentMapUnit"),Ke=qt("utils/getAreaMessageText"),Xe=qt("utils/transformMeterArea"),Je=qt("utils/removeMeasureTooltip"),et=qt("utils/setMeasureTooltipStatic"),tt=qt("utils/getMetersFromDegrees"),nt=qt("utils/getDPI"),rt=qt("utils/getResolutionFromScale"),it=qt("utils/getScaleFromResolution"),at=qt("utils/mergeOptions");function M(e){return e&&e.__esModule?e:{default:e}}function ot(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var st=qt("core/g3wobject"),lt=qt("utils"),ut=qt("core/i18n/i18n.service"),ct=qt("core/errors/parser/servererrorparser"),dt=qt("core/project/project"),pt=qt("core/layers/layersstoresregistry"),ft=qt("core/layers/layersstore"),ht=qt("core/layers/layer"),gt=qt("core/layers/layerfactory"),vt=qt("core/layers/tablelayer"),mt=qt("core/layers/vectorlayer"),yt=qt("core/layers/imagelayer"),_t=qt("core/layers/map/wmslayer"),bt=qt("core/layers/map/xyzlayer"),wt=qt("core/layers/map/maplayer"),xt=qt("core/layers/features/feature"),St=qt("core/layers/features/featuresstore"),Lt=qt("core/layers/features/olfeaturesstore"),Ct=qt("core/layers/filter/filter"),Et=qt("core/layers/filter/expression"),Tt=qt("core/plugin/plugin"),kt=qt("core/plugin/pluginservice"),P=qt("gui/panel"),Mt=qt("gui/map/mapservice").ControlFactory,Pt=qt("gui/fields/fieldsservice"),O=qt("gui/component/component"),Ot=qt("gui/metadata/vue/metadata"),Ft=qt("gui/search/vue/search"),It=qt("gui/search/vue/panel/searchpanel"),jt=qt("gui/print/vue/print"),At=qt("gui/catalog/vue/catalog"),Rt=qt("gui/map/vue/map"),Nt=qt("gui/tools/vue/tools"),Gt=qt("gui/queryresults/vue/queryresults"),Dt=qt("gui/form/vue/form"),F=qt("gui/form/formservice"),Bt=qt("gui/inputs/inputs"),Vt=qt("gui/fields/fields"),I=qt("g3w-ol/interactions/pickfeatureinteraction"),j=qt("g3w-ol/interactions/pickcoordinatesinteraction"),Ut=qt("g3w-ol/interactions/deletefeatureinteraction"),$t=qt("g3w-ol/interactions/areainteraction"),zt=qt("g3w-ol/interactions/lengthinteraction"),A={constant:t.default,core:{G3WObject:st,utils:lt,geoutils:{geometryFields:e.GEOMETRY_FIELDS,coordinatesToGeometry:m.coordinatesToGeometry,getDefaultLayerStyle:y.getDefaultLayerStyle,createLayerStyle:_.createLayerStyle,createFeatureFromCoordinates:b.createFeatureFromCoordinates,createFeatureFromBBOX:w.createFeatureFromBBOX,createFeatureFromGeometry:x.createFeatureFromGeometry,createFeatureFromFeatureObject:S.createFeatureFromFeatureObject,createOlLayer:L.createOlLayer,createWMSLayer:C.createWMSLayer,createVectorLayerFromGeometry:N.createVectorLayerFromGeometry,createVectorLayerFromFeatures:R.createVectorLayerFromFeatures,createVectorLayerFromFile:G.createVectorLayerFromFile,createStyleFunctionToVectorLayer:D.createStyleFunctionToVectorLayer,createSelectedStyle:B.createSelectedStyle,getAlphanumericPropertiesFromFeature:V.getAlphanumericPropertiesFromFeature,getFormDataExpressionRequestFromFeature:U.getFormDataExpressionRequestFromFeature,convertFeatureToGEOJSON:$.convertFeatureToGEOJSON,getQueryLayersPromisesByBBOX:z.getQueryLayersPromisesByBBOX,getQueryLayersPromisesByGeometry:q.getQueryLayersPromisesByGeometry,getQueryLayersPromisesByCoordinates:Y.getQueryLayersPromisesByCoordinates,transformBBOX:W.transformBBOX,parseQueryLayersPromiseResponses:H.parseQueryLayersPromiseResponses,getMapLayerById:Q.getMapLayerById,getMapLayersByFilter:Z.getMapLayersByFilter,areCoordinatesEqual:K.areCoordinatesEqual,getFeaturesFromResponseVectorApi:X.getFeaturesFromResponseVectorApi,covertVectorFeaturesToResultFeatures:J.convertVectorFeaturesToResultFeatures,splitGeometryLine:ee.splitGeometryLine,splitFeatures:te.splitFeatures,splitFeature:ne.splitFeature,getPointFeaturesfromGeometryVertex:re.getPointFeaturesfromGeometryVertex,getVertexLength:ie.getVertexLength,isSameBaseGeometryType:ae.isSameBaseGeometryType,isSingleGeometry:oe.isSingleGeometry,singleGeometriesToMultiGeometry:se.singleGeometriesToMultiGeometry,multiGeometryToSingleGeometries:le.multiGeometryToSingleGeometries,convertSingleMultiGeometry:ue.convertSingleMultiGeometry,dissolve:ce.dissolve,within:de.within,intersects:pe.intersects,findSelfIntersects:fe.findSelfIntersects,normalizeEpsg:he.normalizeEpsg,crsToCrsObject:ge.crsToCrsObject,ConvertDMToDEG:ve.convertDMToDEG,ConvertDEGToDM:me.convertDEGToDM,ConvertDMSToDEG:ye.convertDMSToDEG,ConvertDEGToDMS:_e.convertDEGToDMS,getGeoTIFFfromServer:be.getGeoTIFFfromServer,createOlFeatureFromApiResponseFeature:we.createOlFeatureFromApiResponseFeature,sanitizeFidFeature:l.sanitizeFidFeature,parseAttributes:xe.parseAttributes,handleQueryResponse:Se.handleQueryResponse,distance:Le.distance,squaredDistance:Ce.squaredDistance,closestOnSegment:Ee.closestOnSegment,get_LEGEND_ON_LEGEND_OFF_Params:Te.get_legend_params,Geometry:{GeometryTypes:e.GEOMETRY_TYPES,removeZValueToOLFeatureGeometry:s.removeZValueToOLFeatureGeometry,addZValueToOLFeatureGeometry:a.addZValueToOLFeatureGeometry,getOLGeometry:u.getOLGeometry,isMultiGeometry:c.isMultiGeometry,getAllPointGeometryTypes:d.getAllPointGeometryTypes,isPointGeometryType:p.isPointGeometryType,getAllLineGeometryTypes:f.getAllLineGeometryTypes,isLineGeometryType:h.isLineGeometryType,getAllPolygonGeometryTypes:g.getAllPolygonGeometryTypes,isPolygonGeometryType:v.isPolygonGeometryType,is3DGeometry:o.is3DGeometry}},ApplicationService:i.default,ApplicationState:n.default,ApiService:De.default,Router:Be.default,i18n:ut,task:{TaskService:Ge.default},data:{DataRouterService:Ie.default},iframe:{IFrameRouterService:je.default},errors:{parsers:{Server:ct}},project:{ProjectsRegistry:Re.default,Project:dt},map:{MapLayersStoreRegistry:Ae.default},catalog:{CatalogLayersStoresRegistry:Fe.default},layer:{LayersStoreRegistry:pt,LayersStore:ft,Layer:ht,LayerFactory:gt,TableLayer:vt,VectorLayer:mt,ImageLayer:yt,WmsLayer:_t,XYZLayer:bt,MapLayer:wt,features:{Feature:xt,FeaturesStore:St,OlFeaturesStore:Lt},filter:{Filter:Ct,Expression:Et}},relations:{RelationsService:Ne.default},interaction:{PickCoordinatesInteraction:j,PickFeatureInteraction:I},plugin:{Plugin:Tt,PluginsRegistry:T.default,PluginService:kt},input:{inputService:{handleFilterExpressionFormInput:F._getFilterExpression,handleDefaultExpressionFormInput:F._getDefaultExpression}}},gui:{GUI:k.default,Panel:P,ControlFactory:Mt,ComponentsFactory:{build:function(e){var t=e.vueComponentObject,n=e.service,r=e.propsData;return new O(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).init({vueComponentObject:t,service:n,propsData:r})}},FieldsService:Pt,vue:{Component:O,Panel:P,MetadataComponent:Ot,SearchComponent:Ft,SearchPanel:It,PrintComponent:jt,CatalogComponent:At,MapComponent:Rt,ToolsComponent:Nt,QueryResultsComponent:Gt,FormComponent:Dt,FormComponents:{Body:Pe.default,Footer:Oe.default},Inputs:{G3wFormInputs:Me.default,G3WInput:ke.default,InputsComponents:Bt},Charts:{ChartsFactory:{build:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.type,e=e.hooks,e=void 0===e?{}:e,t=t.split(":"),t=r(t,2),n=t[0],t=t[1];return Object.assign(e,this.CHARTS[void 0===n?"c3":n][void 0===t?"lineXY":t])}},c3:{lineXY:E.default}},Fields:Vt,Mixins:Ve.default,services:{FormService:F}}},ol:{interactions:{PickFeatureInteraction:I,PickCoordinatesInteraction:j,DeleteFeatureInteraction:Ut,measure:{AreaInteraction:$t,LengthInteraction:zt}},controls:{},utils:{merge:at.mergeOptions,getExtentForViewAndSize:$e.getExtentForViewAndSize,createPolygonLayerFromBBox:ze.createPolygonLayerFromBBox,reverseGeometry:Ue.reverseGeometry,getScaleFromResolution:it.getScaleFromResolution,getResolutionFromScale:rt.getResolutionFromScale,getDPI:nt.getDPI,getMetersFromDegrees:tt.getMetersFromDegrees,needUseSphereMethods:Ye.needUseSphereMethods,getLengthMessageText:qe.getLengthMessageText,getAreaMessageText:Ke.getAreaMessageText,formatMeasure:Qe.formatMeasure,createMeasureTooltip:He.createMeasureTooltip,getCurrentMapUnit:Ze.getCurrentMapUnit,transformMeterLength:We.transformMeterLength,transformMeterArea:Xe.transformMeterArea,removeMeasureTooltip:Je.removeMeasureTooltip,setMeasureTooltipStatic:et.setMeasureTooltipStatic}},info:function(){Promise.allSettled([new Promise(function(e){return $script("https://unpkg.com/platform@1.3.6/platform.js",e)}),new Promise(function(e){return i.default.complete?e():i.default.on("complete",e)})]).finally(ot(function*(){var e=window.platform||{};window.console.info(("\n[g3wsdk.info]\n\n- g3w-admin: __"+initConfig.version+"__\n- g3w-client: __3.10.0-alpha.2__\n"+Object.entries(T.default.pluginsConfigs).map(function(e){return"    - "+e[0]+": __"+e[1].version+"__"}).join("\n")+"\n- browser: __"+e.name+" "+e.version+"__\n- operating system: __"+e.os.toString()+"__\n").trim())}))},version:t.default.APP_VERSION};A.core.geometry={Geom:A.core.geoutils,Geometry:A.core.geoutils.Geometry},A.core.layer.geometry={geom:A.core.geoutils,Geometry:A.core.geoutils.Geometry},A.gui.vue.Charts.ChartsFactory.CHARTS={c3:{lineXY:E.default}},A.gui.ComponentsFactory.buildSidebar=function(e){function t(e,t){return void 0!==e?e:t}var n=e.vueComponentObject,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=A.gui.ComponentsFactory.build({vueComponentObject:n},{id:r.id,title:r.title,open:t(r.open,!1),collapsible:t(r.collapsible,!0),isolate:t(r.isolate,!1),iconColor:t(r.iconConfig,{}).color,icon:t(r.iconConfig,{}).icon&&k.default.getFontClass(r.iconConfig.icon),mobile:t(r.mobile,!0),events:t(r.events,{})});return k.default.addComponent(n,"sidebar",t(r.sidebarOptions,{position:1})),n},Yt.exports=A}.call(this)}.call(this,qt("_process"))},{_process:1,"app/constant":5,"components/C3XYLine.vue":133,"components/FormBody.vue":151,"components/FormFooter.vue":152,"components/InputG3W.vue":175,"components/InputG3WFormInputs.vue":176,"core/errors/parser/servererrorparser":6,"core/g3wobject":11,"core/i18n/i18n.service":12,"core/layers/features/feature":14,"core/layers/features/featuresstore":15,"core/layers/features/olfeaturesstore":16,"core/layers/filter/expression":17,"core/layers/filter/filter":18,"core/layers/imagelayer":20,"core/layers/layer":21,"core/layers/layerfactory":22,"core/layers/layersstore":23,"core/layers/layersstoresregistry":24,"core/layers/map/maplayer":27,"core/layers/map/wmslayer":29,"core/layers/map/xyzlayer":31,"core/layers/tablelayer":37,"core/layers/vectorlayer":41,"core/plugin/plugin":42,"core/plugin/pluginservice":43,"core/project/project":44,"g3w-ol/interactions/areainteraction":67,"g3w-ol/interactions/deletefeatureinteraction":68,"g3w-ol/interactions/lengthinteraction":69,"g3w-ol/interactions/pickcoordinatesinteraction":71,"g3w-ol/interactions/pickfeatureinteraction":72,"gui/catalog/vue/catalog":77,"gui/component/component":79,"gui/fields/fields":80,"gui/fields/fieldsservice":81,"gui/form/formservice":82,"gui/form/vue/form":83,"gui/inputs/inputs":92,"gui/map/mapservice":116,"gui/map/vue/map":117,"gui/metadata/vue/metadata":118,"gui/panel":119,"gui/print/vue/print":120,"gui/queryresults/vue/queryresults":124,"gui/search/vue/panel/searchpanel":126,"gui/search/vue/search":127,"gui/tools/vue/tools":129,mixins:290,"services/api":297,"services/application":298,"services/data":300,"services/gui":302,"services/iframe":303,"services/relations":305,"services/router":306,"services/tasks":308,"store/application-state":310,"store/catalog-layers":311,"store/map-layers":315,"store/plugins":316,"store/projects":317,utils:404,"utils/addZValueToOLFeatureGeometry":320,"utils/areCoordinatesEqual":322,"utils/closestOnSegment":326,"utils/convertDEGToDM":328,"utils/convertDEGToDMS":329,"utils/convertDMSToDEG":330,"utils/convertDMToDEG":331,"utils/convertFeatureToGEOJSON":332,"utils/convertSingleMultiGeometry":335,"utils/convertVectorFeaturesToResultFeatures":336,"utils/coordinatesToGeometry":337,"utils/createFeatureFromBBOX":339,"utils/createFeatureFromCoordinates":340,"utils/createFeatureFromFeatureObject":341,"utils/createFeatureFromGeometry":342,"utils/createLayerStyle":347,"utils/createMeasureTooltip":348,"utils/createOlFeatureFromApiResponseFeature":349,"utils/createOlLayer":350,"utils/createPolygonLayerFromBBox":351,"utils/createSelectedStyle":352,"utils/createStyleFunctionToVectorLayer":354,"utils/createVectorLayerFromFeatures":355,"utils/createVectorLayerFromFile":356,"utils/createVectorLayerFromGeometry":357,"utils/createWMSLayer":358,"utils/crsToCrsObject":359,"utils/dissolve":361,"utils/distance":362,"utils/findSelfIntersects":367,"utils/formatMeasure":369,"utils/getAllLineGeometryTypes":371,"utils/getAllPointGeometryTypes":372,"utils/getAllPolygonGeometryTypes":373,"utils/getAlphanumericPropertiesFromFeature":374,"utils/getAreaMessageText":375,"utils/getCurrentMapUnit":376,"utils/getDPI":377,"utils/getDefaultLayerStyle":379,"utils/getExtentForViewAndSize":380,"utils/getFeaturesFromResponseVectorApi":381,"utils/getFormDataExpressionRequestFromFeature":382,"utils/getGeoTIFFfromServer":383,"utils/getLengthMessageText":384,"utils/getMapLayerById":385,"utils/getMapLayersByFilter":386,"utils/getMetersFromDegrees":387,"utils/getOLGeometry":388,"utils/getPointFeaturesfromGeometryVertex":389,"utils/getQueryLayersPromisesByBBOX":390,"utils/getQueryLayersPromisesByCoordinates":391,"utils/getQueryLayersPromisesByGeometry":392,"utils/getResolutionFromScale":394,"utils/getScaleFromResolution":395,"utils/getVertexLength":398,"utils/get_legend_params":399,"utils/handleQueryResponse":401,"utils/intersects":406,"utils/is3DGeometry":407,"utils/isLineGeometryType":409,"utils/isMultiGeometry":410,"utils/isPointGeometryType":411,"utils/isPolygonGeometryType":412,"utils/isSameBaseGeometryType":413,"utils/isSingleGeometry":414,"utils/mergeOptions":417,"utils/multiGeometryToSingleGeometries":419,"utils/needUseSphereMethods":420,"utils/normalizeEpsg":422,"utils/parseAttributes":423,"utils/parseQueryLayersPromiseResponses":424,"utils/removeMeasureTooltip":431,"utils/removeZValueToOLFeatureGeometry":432,"utils/reverseGeometry":434,"utils/sanitizeFidFeature":436,"utils/setMeasureTooltipStatic":438,"utils/singleGeometriesToMultiGeometry":439,"utils/splitFeature":443,"utils/splitFeatures":444,"utils/splitGeometryLine":445,"utils/squaredDistance":446,"utils/transformBBOX":449,"utils/transformMeterArea":450,"utils/transformMeterLength":451,"utils/within":454}],4:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.utils=n.server=n.client=n._i18n=n.tools=n.plugins=void 0;var e=e("../locales"),e=(e=e)&&e.__esModule?e:{default:e};var r=n.plugins={},i=n.tools={tools:[]},e=n._i18n={resources:e.default},a=n.client={debug:!0,local:!1},o=n.server={urls:{baseurl:"/",ows:"ows",api:"api",initconfig:"api/initconfig",config:"api/config"}},s=n.utils={merge:function(e){}};n.default={apptitle:"G3W Client",client:a,server:o,plugins:r,supportedLanguages:["en","it"],tools:i,_i18n:e,utils:s}},{"../locales":280}],5:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.INCHES_PER_UNIT=n.DOTS_PER_INCH=n.SPATIAL_METHODS=n.LOGO_GIS3W=n.LOCAL_ITEM_IDS=n.FONT_AWESOME_ICONS=n.API_BASE_URLS=n.ZINDEXES=n.VIEWPORT=n.TOC_THEMES_INIT_STATUS=n.TOC_LAYERS_INIT_STATUS=n.TIMEOUT=n.SEARCH_RETURN_TYPES=n.SEARCH_ALLVALUE=n.QUERY_POINT_TOLERANCE=n.PRINT_SCALES=n.PRINT_RESOLUTIONS=n.PRINT_FORMATS=n.MAP_SETTINGS=n.LOCALSTORAGE_EXTERNALWMS_ITEM=n.LIST_OF_RELATIONS_ID=n.LIST_OF_RELATIONS_TITLE=n.GEOMETRY_TYPES=n.GEOMETRY_FIELDS=n.FILTER_EXPRESSION_OPERATORS=n.FILTER_OPERATORS=n.G3W_FID=n.EPSG=n.DOWNLOAD_FORMATS=n.DEFAULT_EDITING_CAPABILITIES=n.APP_VERSION=void 0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},e=e("../version"),e=(e=e)&&e.__esModule?e:{default:e};var e=n.APP_VERSION=e.default,i=n.DEFAULT_EDITING_CAPABILITIES=["add_feature","change_feature","change_attr_feature","delete_feature"],a=n.DOWNLOAD_FORMATS={download:{format:"shapefile",url:"shp"},download_gpkg:{format:"gpkg",url:"gpkg"},download_gpx:{format:"gpx",url:"gpx"},download_csv:{format:"csv",url:"csv"},download_xls:{format:"xls",url:"xls"},download_raster:{format:"geotiff",url:"geotiff"}},o=(n.EPSG=["EPSG:3003","EPSG:3004","EPSG:3045","EPSG:3857","EPSG:4326","EPSG:6708","EPSG:23032","EPSG:23033","EPSG:25833","EPSG:32632","EPSG:32633"],n.G3W_FID="g3w_fid",n.FILTER_OPERATORS={gte:">=",lte:"<=",NOT:"!=",eq:"=",gt:">",lt:"<",IN:"IN","NOT IN":"NOT IN",LIKE:"LIKE",ILIKE:"ILIKE",AND:"AND",OR:"OR"}),r=n.FILTER_EXPRESSION_OPERATORS=r({lte:"<=",ltgt:"!=",ilike:"ILIKE",like:"LIKE"},o),s=n.GEOMETRY_FIELDS=["geometryProperty","boundedBy","geom","the_geom","geometry","bbox","GEOMETRY","geoemtria","geometria"],l=n.GEOMETRY_TYPES={POINT:"Point",POINTZ:"PointZ",POINTM:"PointM",POINTZM:"PointZM",POINT25D:"Point25D",MULTIPOINT:"MultiPoint",MULTIPOINTZ:"MultiPointZ",MULTIPOINTM:"MutliPointM",MULTIPOINTZM:"MultiPointZM",MULTIPOINT25D:"MultiPoint25D",LINESTRING:"LineString",LINESTRINGZ:"LineStringZ",LINESTRINGM:"LineStringM",LINESTRINGZM:"LineStringZM",LINESTRING25D:"LineString25D",LINE:"Line",LINEZ:"LineZ",LINEM:"LineM",LINEZM:"LineZM",LINE25D:"Line25D",MULTILINESTRING:"MultiLineString",MULTILINESTRINGZ:"MultiLineStringZ",MULTILINESTRINGM:"MultiLineStringM",MULTILINESTRINGZM:"MultiLineStringZM",MULTILINESTRING25D:"MultiLineString25D",MULTILINE:"MultiLine",MULTILINEZ:"MultiLineZ",MULTILINEM:"MultiLineM",MULTILINEZM:"MultiLineZM",MULTILINE25D:"MultiLine25D",POLYGON:"Polygon",POLYGONZ:"PolygonZ",POLYGONM:"PolygonM",POLYGONZM:"PolygonZM",POLYGON25D:"Polygon25D",MULTIPOLYGON:"MultiPolygon",MULTIPOLYGONZ:"MultiPolygonZ",MULTIPOLYGONM:"MultiPolygonM",MULTIPOLYGONZM:"MultiPolygonZM",MULTIPOLYGON25D:"MultiPolygon25D",GEOMETRYCOLLECTION:"GeometryCollection",GEOMETRYCOLLECTIONZ:"GeometryCollectionZ",GEOMETRYCOLLECTIONM:"GeometryCollectionM",GEOMETRYCOLLECTIONZM:"GeometryCollectionZM",GEOMETRYCOLLECTION25D:"GeometryCollection25D"},u=(n.LIST_OF_RELATIONS_TITLE="info.list_of_relations",n.LIST_OF_RELATIONS_ID="__G3W_LIST_OF_RELATIONS_ID__",n.LOCALSTORAGE_EXTERNALWMS_ITEM="externalwms",n.MAP_SETTINGS={ZOOM:{maxScale:1e3},ANIMATION:{duration:2e3},LAYER_POSITIONS:{default:"top",getPositions:function(){return["top","bottom"]}}}),c=n.PRINT_FORMATS=[{value:"png",label:"PNG"},{value:"jpg",label:"JPG"},{value:"svg",label:"SVG"},{value:"pdf",label:"PDF"},{value:"geopdf",label:"GEOPDF"}],d=n.PRINT_RESOLUTIONS=[150,300],p=n.PRINT_SCALES=[{value:100,label:"1:100"},{value:200,label:"1:200"},{value:500,label:"1:500"},{value:1e3,label:"1:1.000"},{value:2e3,label:"1:2.000"},{value:2500,label:"1:2.500"},{value:5e3,label:"1:5.000"},{value:1e4,label:"1:10.000"},{value:2e4,label:"1:20.000"},{value:25e3,label:"1:25.000"},{value:5e4,label:"1:50.000"},{value:1e5,label:"1:100.000"},{value:25e4,label:"1:250.000"},{value:5e5,label:"1:500.000"},{value:1e6,label:"1:1.000.000"},{value:25e5,label:"1:2.500.000"},{value:5e6,label:"1:5.000.000"},{value:1e7,label:"1:10.000.000"},{value:2e7,label:"1:20.000.000"},{value:5e7,label:"1:50.000.000"},{value:1e8,label:"1:100.000.000"},{value:25e7,label:"1:250.000.000"},{value:5e8,label:"1:500.000.000"}],f=n.QUERY_POINT_TOLERANCE={unit:"pixel",value:10},h=(n.SEARCH_ALLVALUE="__G3W_ALL__",n.SEARCH_RETURN_TYPES=["data","search"]),g=(n.TIMEOUT=6e4,n.TOC_LAYERS_INIT_STATUS="not_collapsed",n.TOC_THEMES_INIT_STATUS="collapsed",n.VIEWPORT={resize:{map:{min:200},content:{min:200}}}),v=n.ZINDEXES={usermessage:{tool:2}},m=n.API_BASE_URLS={ABOUT:{macrogroups:"/about/api/macrogroup/",nomacrogoups:"/about/api/group/nomacrogroup/",projects:"/about/api/group/__G3W_GROUP_ID__/projects/",group:"/about/api/group/"},CRS:"/crs/"},y=n.FONT_AWESOME_ICONS={"change-map":"fas fa-map-signs",map:"far fa-map",file:"fas fa-file-code",marker:"fas fa-map-marker-alt",relation:"fas fa-sitemap",tools:"fas fa-cogs",tool:"fas fa-cog",search:"fas fa-search",print:"fas fa-print",info:"fas fa-info-circle","info-circle":"fas fa-info-circle",globe:"fas fa-globe",mail:"fas fa-envelope",mobile:"fas fa-mobile",fax:"fas fa-fax",user:"fas fa-user",bars:"fas fa-bars",uncheck:"far fa-square",check:"far fa-check-square",filluncheck:"fas fa-square",table:"fas fa-table",trash:"fas fa-trash","trash-o":"far fa-trash-alt",pencil:"fas fa-pencil-alt","ellips-h":"fas fa-ellipsis-h","ellips-v":"fas fa-ellipsis-v","arrow-up":"fas fa-chevron-up","arrow-down":"fas fa-chevron-down","arrow-left":"fas fa-chevron-left","arrow-right":"fas fa-chevron-right","resize-h":"fas fa-arrows-alt-h","resize-v":"fas fa-arrows-alt-v","resize-default":"fas fa-compress","caret-up":"fas fa-caret-up","caret-down":"fas fa-caret-down","caret-left":"fas fa-caret-left","caret-right":"fas fa-caret-right","empty-circle":"far fa-circle","cloud-upload":"fas fa-cloud-upload-alt",spinner:"fas fa-spinner",minus:"fas fa-minus","minus-square":"far fa-minus-square",plus:"fas fa-plus","plus-circle":"fas fa-plus-circle","plus-square":"far fa-plus-square",grid:"fas fa-th",home:"fas fa-home",folder:"fas fa-folder","sign-out":"fas fa-sign-out-alt",close:"fas fa-times",time:"far fa-clock",calendar:"fas fa-calendar-alt",list:"fas fa-list-alt",link:"fas fa-link",unlink:"fas fa-unlink",eye:"far fa-eye","eye-close":"far fa-eye-slash",save:"far fa-save",pdf:"fas fa-file-pdf",image:"far fa-image",video:"far fa-file-video",unknow:"far fa-question-circle",zip:"far fa-file-archive",text:"far fa-file-alt",excel:"far fa-file-excel",xls:"far fa-file-excel",gpx:"fas fa-location-arrow",gpkg:"fas fa-box-open",shapefile:"fas fa-file-archive",csv:"fas fa-file-csv",geotiff:"fas fa-th",ppt:"far fa-file-powerpoint",circle:"fas fa-circle",calculator:"fas fa-calculator",picture:"far fa-image",keyboard:"far fa-keyboard","file-download":"fas fa-file-download",copy:"far fa-copy",draw:"fas fa-draw-polygon",chart:"fas fa-chart-bar","chart-line":"fas fa-chart-line","chart-area":"fas fa-chart-area","chart-pie":"fas fa-chart-pie",run:"fas fa-play",warning:"fas fa-exclamation-circle",alert:"fas fa-exclamation-triangle",crosshairs:"fas fa-crosshairs",success:"far fa-check-circle",back:"fas fa-chevron-circle-left","file-upload":"fas fa-file-upload",wifi:"fas fa-wifi",mouse:"fas fa-mouse","copy-paste":"far fa-copy","vector-square":"fas fa-vector-square",download:"fas fa-download",credits:"fas fa-euro-sign",filter:"fas fa-filter",plugin:"fas fa-plug",invert:"fas fa-exchange-alt",clear:"fas fa-broom",palette:"fas fa-palette",layers:"fas fa-layer-group","sign-in":"fas fa-sign-in-alt",language:"fas fa-language",target:"fas fa-bullseye",pin:"fas fa-map-pin",square:"far fa-square",move:"fas fa-arrows-alt",moon:"fas fa-moon",sun:"fas fa-sun",refresh:"fas fa-sync-alt",pause:"fas fa-pause","step-backward":"fas fa-step-backward","fast-backward":"fas fa-fast-backward","step-forward":"fas fa-step-forward","fast-forward":"fas fa-fast-forward",crop:"fas fa-crop-alt",exit:"fas fa-door-open",slider:"fas fa-sliders-h",bookmark:"fas fa-bookmark",reply:"fas fa-reply",share:"fas fa-share"},_=n.LOCAL_ITEM_IDS={MESSAGES:{id:"MESSAGES",value:{}},SPATIALBOOKMARKS:{id:"SPATIALBOOKMARKS",value:{}}},b=(n.LOGO_GIS3W="images/logo_gis3w_156_85.png",n.SPATIAL_METHODS=["intersects","within"]),w=(n.DOTS_PER_INCH=96,n.INCHES_PER_UNIT={m:39.37,degrees:4374754});n.default={APP_VERSION:e,API_BASE_URLS:m,DEFAULT_EDITING_CAPABILITIES:i,DOTS_PER_INCH:96,DOWNLOAD_FORMATS:a,FILTER_OPERATORS:o,FILTER_EXPRESSION_OPERATORS:r,FONT_AWESOME_ICONS:y,G3W_FID:"g3w_fid",GEOMETRY_FIELDS:s,GEOMETRY_TYPES:l,INCHES_PER_UNIT:w,LIST_OF_RELATIONS_TITLE:"info.list_of_relations",LIST_OF_RELATIONS_ID:"__G3W_LIST_OF_RELATIONS_ID__",LOCAL_ITEM_IDS:_,LOCALSTORAGE_EXTERNALWMS_ITEM:"externalwms",LOGO_GIS3W:"images/logo_gis3w_156_85.png",MAP_SETTINGS:u,PRINT_FORMATS:c,PRINT_RESOLUTIONS:d,PRINT_SCALES:p,QUERY_POINT_TOLERANCE:f,SEARCH_ALLVALUE:"__G3W_ALL__",SEARCH_RETURN_TYPES:h,SPATIAL_METHODS:b,TIMEOUT:6e4,TOC_LAYERS_INIT_STATUS:"not_collapsed",TOC_THEMES_INIT_STATUS:"collapsed",VIEWPORT:g,ZINDEXES:v}},{"../version":455}],6:[function(e,t,n){function r(){this._error=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).error}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},l=e("core/i18n/i18n.service").t;r.prototype.parse=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).type,e=void 0===e?"responseJSON":e,i="server_saver_error";function a(e){var e=Object.entries(e),t=e.find(function(e){var e=s(e,2),t=e[0];e[1];return"fields"===t});if(t){var n,t=s(t,2)[1];try{"string"==typeof t?(r=e.find(function(e){var e=s(e,2),t=e[0];e[1];return"fields"!==t}),n=s(r,1)[0],i="["+n+"] "+t):(i="",Object.entries(t).forEach(function(e){var e=s(e,2),t=e[0],e=e[1];i=""+i+t+" "+(Array.isArray(e)?e[0]:e)+" \n"}))}catch(e){}return i.replace(/\:|\./g,"")}var r=s(e[0],2)[1];if(!Array.isArray(r)&&"object"===(void 0===r?"undefined":o(r)))return a(r)}if("responseJSON"===e){if(this._error&&this._error.responseJSON&&this._error.responseJSON.error.message)return this._error.responseJSON.error.message;if(this._error&&this._error.errors)return a(this._error.errors)}else if("String"===e)return"string"==typeof this._error?this._error:a(this._error);return l("server_saver_error")},t.exports=r},{"core/i18n/i18n.service":12}],7:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.BarStack=void 0;var r=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=s(e("core/g3w-panel")),o=s(e("core/g3w-component")),e=s(e("core/g3wobject"));function s(e){return e&&e.__esModule?e:{default:e}}n.BarStack=function(e){var t=n;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);function n(){var e;if(this instanceof n)return(e=function(e,t){if(e)return!t||"object"!=typeof t&&"function"!=typeof t?e:t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this)))._parent=null,e.state={contentsdata:[]},e;throw new TypeError("Cannot call a class as a function")}return t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e),r(n,[{key:"push",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return this._parent=t.parent,this._mount(e,t)}},{key:"pop",value:function(){var e=$.Deferred(),t=this.state.contentsdata;return t.length?this._unmount(t.slice(-1)[0].content).then(function(){e.resolve(t.pop())}):e.resolve(),e.promise()}},{key:"clear",value:function(){var t=this,e=$.Deferred(),n=this.state.contentsdata;return n.length?$.when(n.map(function(e){return t._unmount(e.content)})).then(function(){n.splice(0,n.length),e.resolve()}):e.resolve(),this.emit("clear"),e.promise()}},{key:"getContentData",value:function(){return this.state.contentsdata}},{key:"getCurrentContentData",value:function(){return this.state.contentsdata[this.state.contentsdata.length-1]}},{key:"getPreviousContentData",value:function(){return this.state.contentsdata[this.state.contentsdata.length-2]}},{key:"_mount",value:function(t,e){var n,r,i=this,a=$.Deferred(),o=this.state.contentsdata;return t instanceof jQuery||_.isString(t)?(n=_.isString(t)?$(t).length?$("<div>"+t+"</div>"):$(t):t,$(this._parent).append(n),o.push({content:n,options:e}),a.resolve()):t.mount&&"function"==typeof t.mount?(-1!==(r=o.findIndex(function(e){return e.content.getId&&e.content.getId()===t.getId()}))&&o[r].content.unmount().then(function(){return o.splice(r,1)}),t.mount(this._parent,e.append||!1).then(function(){$(i._parent).localize(),o.push({content:t,options:e}),a.resolve(t)})):(this._parent.appendChild(t),o.push({content:t,options:e}),a.resolve()),a.promise()}},{key:"_unmount",value:function(e){var t=$.Deferred();return e instanceof o.default||e instanceof a.default?e.unmount().then(function(){return t.resolve()}):($(this._parent).empty(),t.resolve()),t.promise()}},{key:"forEach",value:function(t){this.state.contentsdata.forEach(function(e){return t(e.content)})}},{key:"getLength",value:function(){return this.state.contentsdata.length}},{key:"getComponentById",value:function(t){return(this.getContentData().find(function(e){return e.content.id==t})||{}).content}}]),n}(e.default)},{"core/g3w-component":8,"core/g3w-panel":10,"core/g3wobject":11}],8:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e};function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=p(e("core/g3wobject")),s=e("utils/merge"),l=e("utils/noop"),u=e("utils/capitalize_first_letter"),c=e("utils/resolve"),d=p(e("services/gui"));function p(e){return e&&e.__esModule?e:{default:e}}function f(e,t){return void 0!==e?e:t}var h=e("lodash.clonedeep"),e=e("util-deprecate"),o=function(e){var t=a;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);function a(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=this,n=a;if(!(t instanceof n))throw new TypeError("Cannot call a class as a function");e.iconConfig&&(e.iconColor=e.iconConfig.color,e.icon=e.iconConfig.icon,delete e.iconConfig),e.icon=d.default.getFontClass(e.icon)||e.icon;var r,i,t=function(e,t){if(e)return!t||"object"!=typeof t&&"function"!=typeof t?e:t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,{setters:{setOpen:function(e){this.state.open=e,this._setOpen&&this._setOpen(e)},setVisible:function(e){this.state.visible=e,this._setVisible&&this._setVisible(e)},setLoading:function(){this.state.loading=0<arguments.length&&void 0!==arguments[0]&&arguments[0]},setDisabled:function(){this.state.disabled=0<arguments.length&&void 0!==arguments[0]&&arguments[0]},reload:function(){this._reload&&this._reload()}}}));return t._firstLayout=!0,t.internalComponent=f(e.internalComponent,null),t._components=[],t.id=f(e.id,1e3*Math.random()),t.title=f(e.title,""),t.state={sizes:{width:0,height:0},info:f(e.info,null),open:f(e.open,!1),visible:f(e.visible,!0),loading:f(e.loading,!1),disabled:f(e.disabled,!1),resizable:f(e.resizable,!1),closewhenshowviewportcontent:f(e.closewhenshowviewportcontent,!0)},t.setService(e.service||t),e.internalComponent&&t.setInternalComponent(e.internalComponent),(0,s.merge)(t,e),t.events=f(e.events,{}),t.events.open&&(r=(n=t.events.open).when,n=n.cb,i=void 0===n?function(){}:n,t["on"+(void 0===r?"after":r)]("setOpen",function(e){return i(e)})),e.vueComponentObject&&t.init(e),t}return t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e),r(a,[{key:"init",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this.vueComponent=h(e.vueComponentObject),this._components=e.components||[],this.setService(e.service||this._service||l.noop),this._service.init&&this.init!==this._service.init&&this._service.init(e),e.template&&(this.vueComponent.template=e.template),this.setInternalComponent=function(){this.internalComponent=new(Vue.extend(this.vueComponent))({service:this._service,template:e.template,propsData:e.propsData}),this.internalComponent.state=this.getService().state},this.setInternalComponent(),this}},{key:"getId",value:function(){return this.id}},{key:"setId",value:function(e){this.id=e}},{key:"getOpen",value:function(){return this.state.open}},{key:"closeWhenViewportContentIsOpen",value:function(){return this.getOpen()&&this.state.closewhenshowviewportcontent}},{key:"getVisible",value:function(){return this.state.visible}},{key:"getTitle",value:function(){return this.state.title}},{key:"setTitle",value:function(e){this.state.title=e}},{key:"getService",value:function(){return this._service}},{key:"setService",value:function(e){this._service=e}},{key:"addComponent",value:function(e){this._components.push(e)}},{key:"removeComponent",value:function(n){var r=this;this._components.find(function(e,t){if(e===n)return r.splice(t,1),!0})}},{key:"getInternalComponent",value:function(){return this.internalComponent}},{key:"setInternalComponent",value:function(e){var n=this,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.internalComponent=void 0===e&&this.internalComponentClass?new this.internalComponentClass:e,(t.events||[]).forEach(function(t){return n.internalComponent.$on(t.name,function(e){return t.handler&&t.handler(e)||n["set"+(0,u.capitalize_first_letter)(t.name)](e)})}),this._service&&this._service.state&&(this.internalComponent.state=this._service.state)}},{key:"mount",value:function(e,t){var n=this,r=$.Deferred();return this.internalComponent||this.setInternalComponent(),t&&$(e).append(this.internalComponent.$mount().$el),t||this.internalComponent.$mount(e),this.internalComponent.$nextTick(function(){$(e).localize(),n.emit("ready"),r.resolve(!0)}),this.emit("mount"),r.promise()}},{key:"unmount",value:function(){return this.internalComponent&&(this.state.resizable&&this.internalComponent.$off("resize-component",this.internalComponent.layout),this.state.open=!1,this.internalComponent.$destroy(!0),$(this.internalComponent.$el).remove(),this.internalComponent=null,this.emit("unmount")),(0,c.resolve)()}},{key:"ismount",value:function(){return this.internalComponent&&this.internalComponent.$el}},{key:"layout",value:function(e,t){var n=this;this.state.resizable&&this._firstLayout&&(this.internalComponent.$on("resize-component",this.internalComponent.layout),this._firstLayout=!1),this.internalComponent.$nextTick(function(){n.internalComponent.$emit("resize-component",{width:e,height:t})}),this.emit("layout")}}]),a}(o.default);n.default=o,Object.assign(o.prototype,{_setOpen:l.noop,_setVisible:l.noop,_reload:l.noop,destroy:l.noop,click:l.noop,show:l.noop,setComponents:e(function(e){this._components=Array.isArray(e)?e:[]},"[G3W-CLIENT] Component::setComponents(components) is deprecated"),setInternalComponentTemplate:e(function(e){e&&(this.vueComponent.template=e)},"[G3W-CLIENT] Component::setInternalComponentTemplate(template) is deprecated"),getInternalTemplate:e(function(){return this.vueComponent.template},"[G3W-CLIENT] Component::getInternalTemplate() is deprecated"),insertComponentAt:e(function(e,t){this._components.splice(e,0,t)},"[G3W-CLIENT] Component::insertComponentAt(index, Component) is deprecated"),removeCompomentAt:e(function(e){this._components.splice(e,1)},"[G3W-CLIENT] Component::removeCompomentAt(index) is deprecated"),exendComponents:e(function(e){_.merge(this._components,e)},"[G3W-CLIENT] Component::exendComponents(components) is deprecated"),addInternalComponentData:e(function(e){_.merge(this.internalComponent,e)},"[G3W-CLIENT] Component::addInternalComponentData(data) is deprecated"),handleEventsComponent:e(function(){var t=this;this.events.open&&this["on"+(this.events.open||"after")]("setOpen",function(e){return(t.events.open.cb||function(){})(e)})},"[G3W-CLIENT] Component::handleEventsComponent() is deprecated"),popComponent:e(function(){return this._components.pop()},"[G3W-CLIENT] Component::popComponent() is deprecated"),overwriteServiceMethod:e(function(e,t){this._service[e]=t},"[G3W-CLIENT] Component::overwriteServiceMethod(methodName, method) is deprecated"),extendInternalComponentMethods:e(function(n){n&&Object.entries(n).forEach(function(e){var e=i(e,2),t=e[0];return!(e[1]instanceof Function)&&delete n[t]}),(0,s.merge)(this.vueComponent.methods,n)},"[G3W-CLIENT] Component::extendInternalComponentMethods(methods) is deprecated"),extendInternalComponentComponents:e(function(e){e&&(0,s.merge)(this.vueComponent.components,e)},"[G3W-CLIENT] Component::extendInternalComponentComponents(components) is deprecated"),extendComponents:e(function(e){this.extendInternalComponentComponents(e)},"[G3W-CLIENT] Component::extendComponents(components) is deprecated"),extendInternalComponentComputed:e(function(n){n&&Object.entries(n).forEach(function(e){var e=i(e,2),t=e[0];return!(e[1]instanceof Function)&&delete n[t]}),(0,s.merge)(this.vueComponent.computed,n)},"[G3W-CLIENT] Component::extendInternalComponentComputed(computed) is deprecated"),extendService:e(function(e){this._service&&(0,s.merge)(this._service,serviceOptions)},"[G3W-CLIENT] Component::extendService(serviceOptions) is deprecated"),createVueComponent:e(function(e){return h(e)},"[G3W-CLIENT] Component::createVueComponent(vueObjOptions) is deprecated"),closeWhenViewportContentIsOpen:e(function(){return this.getOpen()&&this.state.closewhenshowviewportcontent},"[G3W-CLIENT] Component::closeWhenViewportContentIsOpen() is deprecated"),overwriteServiceMethods:e(function(e){var n=this;Object.entries(e).forEach(function(e){var e=i(e,2),t=e[0],e=e[1];return n._service[t]=e})},"[G3W-CLIENT] Component::overwriteServiceMethods(methodsOptions) is deprecated"),extendInternalComponent:e(function(e){var r=this;this.vueComponent?Object.entries(e).forEach(function(e){var e=i(e,2),t=e[0],n=e[1];switch(t){case"methods":r.extendInternalComponentMethods(n);break;case"components":r.extendInternalComponentComponents(n);break;case"computed":case"data":(0,s.merge)(r.vueComponent[t],n)}}):this.vueComponent=e},"[G3W-CLIENT] Component::extendInternalComponent(internalComponentOptions) is deprecated")})},{"core/g3wobject":11,"lodash.clonedeep":"lodash.clonedeep","services/gui":302,"util-deprecate":"util-deprecate","utils/capitalize_first_letter":325,"utils/merge":416,"utils/noop":421,"utils/resolve":433}],9:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=e("utils/noop"),o=e("utils/debounce"),s=e("utils/throttle");function l(t,e,n,r){if(r)return n.call(t,r);var i=r;Object.defineProperty(t,e,{get:function(){return i},set:function(e){(i=e)&&n.call(t,e)}})}e=function(e){var t=n;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);function n(e){var t;if(this instanceof n)return l(t=function(e,t){if(e)return!t||"object"!=typeof t&&"function"!=typeof t?e:t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e)),"setters",t._setupListenersChain,(e=e||{}).setters||t.setters),l(t,"throttles",t._setupThrottles,e.throttles||t.throttles),l(t,"debounces",t._setupDebounces,e.debounces||t.debounces),t;throw new TypeError("Cannot call a class as a function")}return t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e),r(n,[{key:"onafter",value:function(e,t,n){return this._onsetter("after",e,t,!1,n)}},{key:"onceafter",value:function(e,t,n){return this._onsetter("after",e,t,!1,n,!0)}},{key:"onbefore",value:function(e,t,n){return this._onsetter("before",e,t,!1,n)}},{key:"oncebefore",value:function(e,t,n){return this._onsetter("before",e,t,!1,n,!0)}},{key:"onbeforeasync",value:function(e,t,n){return this._onsetter("before",e,t,!0,n)}},{key:"un",value:function(r,i){Object.entries(this.settersListeners).forEach(function(e){var e=a(e,2),n=(e[0],e[1]);void 0===i?n[r].splice(0):n[r].forEach(function(e,t){e.key===i&&n[r].splice(t,1)})})}},{key:"_onsetter",value:function(e,t,n,r){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,a=5<arguments.length&&void 0!==arguments[5]&&arguments[5],o=void 0;return this.settersListeners&&void 0!==this.settersListeners[e][t]&&(o=""+(Math.floor(1e6*Math.random())+Date.now()),this.settersListeners[e][t].push({key:o,fnc:n,async:r,priority:i,once:a}),this.settersListeners[e][t]=_.sortBy(this.settersListeners[e][t],function(e){return e.priority})),o}},{key:"_setupListenersChain",value:function(u){var e,t=this;this.settersListeners={after:{},before:{}};for(e in u)!function(l){t.settersListeners.after[l]=[],t.settersListeners.before[l]=[],t[l]=function(){for(var i=this,e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];var o=0,s=$.Deferred();return function e(t){var n,t=!!_.isBoolean(t)&&!t,r=i.settersListeners.before[l].length;t?((!_.isFunction(u[l])&&u[l].fallback||c.noop).apply(i,a),s.reject()):(o===r&&(s.resolve((_.isFunction(u[l])?u[l]:u[l].fnc).apply(i,a)),n=[],i.settersListeners.after[l].forEach(function(e){e.fnc.apply(i,a),e.once&&n.push(e.key)}),n.forEach(function(e){return i.un(l,e)}),i.emitEvent("set:"+l,a)),o<r&&((t=i.settersListeners.before[l][o++]).async?(a.push(e),t.fnc.apply(i,a)):e(t.fnc.apply(i,a)),t.once)&&i.settersListeners.before[l].splice(o-1,1))}(!0),s.promise()}}(e);return this.settersListeners}},{key:"_setupDebounces",value:function(e){for(var t in e)this[t]=(0,o.debounce)(e[t].fnc,e[t].delay)}},{key:"_setupThrottles",value:function(e){for(var t in e)this[t]=(0,s.throttle)(e[t].fnc,e[t].delay)}},{key:"get",value:function(e){return!this[e]||this[e]instanceof Function?null:this[e]}},{key:"set",value:function(e,t){this[e]=t}}]),n}(EventEmitter);n.default=e},{"utils/debounce":360,"utils/noop":421,"utils/throttle":447}],10:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e};function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=l(e("services/gui")),o=l(e("core/g3w-object")),s=e("utils/resolve");function l(e){return e&&e.__esModule?e:{default:e}}e=function(e){var t=r;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);function r(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=this,n=r;if(t instanceof n)return(t=function(e,t){if(e)return!t||"object"!=typeof t&&"function"!=typeof t?e:t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(this,(r.__proto__||Object.getPrototypeOf(r)).call(this))).id=e.id||null,t.title=e.title||"",t.service=e.service,e.vueComponentObject?t.internalPanel=new(Vue.extend(e.vueComponentObject))({service:t.service}):t.internalPanel=e.panel||e.internalPanel||null,!0===e.show&&t.internalPanel&&t.show(),t;throw new TypeError("Cannot call a class as a function")}return t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e),i(r,[{key:"getId",value:function(){return this.id}},{key:"getTitle",value:function(){return this.title}},{key:"getService",value:function(){return this.service}},{key:"setService",value:function(e){this.service=e}},{key:"getInternalPanel",value:function(){return this.internalPanel}},{key:"setInternalPanel",value:function(e){this.internalPanel=e}},{key:"show",value:function(){a.default.showPanel(this)}},{key:"close",value:function(){a.default.closePanel()}},{key:"mount",value:function(e){var t=this.internalPanel,n=t.$mount();return $(e).append(n.$el),n.$nextTick(function(){$(e).localize(),t.onShow&&t.onShow()}),(0,s.resolve)(!0)}},{key:"unmount",value:function(){var e=this.internalPanel;return e.$destroy(!0),$(e.$el).remove(),e.onClose&&e.onClose(),this.internalComponent=null,this.service&&this.service.clear&&this.service.clear(),(0,s.resolve)()}},{key:"onResize",value:function(e,t){}}]),r}(o.default);n.default=e},{"core/g3w-object":9,"services/gui":302,"utils/resolve":433}],11:[function(e,t,n){var e=e("core/g3w-object"),e=(e=e)&&e.__esModule?e:{default:e};t.exports=e.default},{"core/g3w-object":9}],12:[function(e,t,n){var e=e("services/application"),r=(e=e)&&e.__esModule?e:{default:e};var a={};function o(e){for(var t in e){var n,r=e[t];for(n in r)i18next.addResource(t,"translation",n,r[n])}}t.exports={init:function(e){return e.appLanguages.forEach(function(e){a[e]={plugins:{}}}),i18next.use(i18nextXHRBackend).init({lng:e.language,ns:"app",fallbackLng:"en",resources:e.resources}),new Promise(function(e,t){jqueryI18next.init(i18next,$,{tName:"t",i18nName:"i18n",handleName:"localize",selectorAttr:"data-i18n",targetAttr:"data-i18n-target",optionsAttr:"data-i18n-options",useOptionsAttr:!1,parseDefaultValueFromContent:!0}),o(a),e()})},t:function(e){return i18next.t(e)},tPlugin:function(e){return i18next.t("plugins."+e)},tPrefix:function(t){return function(e){return i18next.t(t+"."+e)}},addI18n:o,addI18nPlugin:function(e){var t,n=e.name,r=e.config;for(t in r){var i=a[t];i&&(i.plugins[n]=r[t])}o(a)},changeLanguage:function(e){i18next.changeLanguage(e)},getAppLanguage:function(){return r.default.getConfig().user.i18n||"en"}}},{"services/application":298}],13:[function(e,t,n){var r=e("utils"),i=r.base,r=r.inherit,a=e("g3w-ol/projection/projections"),o=e("core/layers/map/wmslayer");function s(){i(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}),this.isWMS()?(this._mapLayer=new o({url:this.getWmsUrl(),id:this.state.id,tiled:this.state.tiled}),this._mapLayer.addLayer(this)):this._mapLayer=this}r(s,e("core/layers/imagelayer"));r=s.prototype;r.getProjectionFromCrs=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e.epsg=e.epsg||"EPSG:3857",a.get(e)},r._makeOlLayer=function(){},r._registerLoadingEvent=function(){var e=this;this._olLayer.getSource().on("imageloadstart",function(){return e.emit("loadstart")}),this._olLayer.getSource().on("imageloadend",function(){return e.emit("loadend")})},r.getSource=function(){return this.getOLLayer().getSource()},r.update=function(e,t){this._updateLayer(e,t)},r.getOLLayer=function(){return this._olLayer||(this._olLayer=this._makeOlLayer(),this._registerLoadingEvent(),this._mapLayer.config.attributions&&this._olLayer.getSource().setAttributions(this._mapLayer.config.attributions),this._olLayer.setVisible(this._mapLayer.state.visible)),this._olLayer},r._updateLayer=function(e,t){this.isWMS()&&this._mapLayer.update(e,t)},r.setVisible=function(e){this.getOLLayer().setVisible(e)},r.getMapLayer=function(){return this._mapLayer},t.exports=s},{"core/layers/imagelayer":20,"core/layers/map/wmslayer":29,"g3w-ol/projection/projections":76,utils:404}],14:[function(e,t,n){var r=e("app/constant"),r=(r=r)&&r.__esModule?r:{default:r};function i(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=(ol.Feature.call(this),this._uid=a(),this._newPrefix="_new_",this._geometry=!1,e.feature),e=e.properties;n&&(e&&Array.isArray(e)?e.forEach(function(e){return t.set(e,n.get(e))}):this.setProperties(n.getProperties()),this.setId(n.getId()),this.setGeometryName(n.getGeometryName()),e=n.getGeometry(),this._geometry=!!e,e&&this.setGeometry(e),e=this.getStyle())&&this.setStyle(e),this.state={new:!1,state:null,visible:!0}}var a=e("utils").uniqueId,o=r.default.GEOMETRY_FIELDS,e=(ol.inherits(i,ol.Feature),i.prototype);e.constructor="Feature",e.getUid=function(){return this._uid},e._setUid=function(e){this._uid=e},e.isGeometry=function(){return this._geometry},e.cloneNew=function(e){var t=this.clone(),n=a();return t._setUid(n),t.setTemporaryId(),e&&!1===e.editable&&t.set(e.name,null),t},e.clone=function(){var e=ol.Feature.prototype.clone.call(this),e=(e.setId(this.getId()),this.isGeometry()&&e.setGeometry(e.getGeometry().clone()),new i({feature:e})),t=this.getUid();return e._setUid(t),e.setState(this.getState()),this.isNew()&&e.setNew(),e},e.setTemporaryId=function(){var e=""+this._newPrefix+a();this.setId(e),this.setNew()},e.setNew=function(){this.state.new=!0},e.delete=function(){return this.state.state="delete",this},e.update=function(){return this.state.state="update",this},e.add=function(){return this.state.state="add",this},e.isNew=function(){return this.state.new},e.isAdded=function(){return"add"===this.state.state},e.isUpdated=function(){return"update"===this.state.state},e.isDeleted=function(){return"delete"===this.state.state},e.setFullState=function(e){this.state=e},e.getFullState=function(){return this.state},e.setState=function(e){this.state.state=e},e.getState=function(){return this.state.state},e.getAlphanumericProperties=function(){var e,t=this.getProperties(),n={};for(e in t)-1===o.indexOf(e)&&(n[e]=t[e]);return n},e.clearState=function(){this.state.state=null,this.state.new=!1},e.isVisible=function(){return this.state.visible},e.setVisible=function(){this.state.visible=!(0<arguments.length&&void 0!==arguments[0])||arguments[0]},t.exports=i},{"app/constant":5,utils:404}],15:[function(e,t,n){function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var i=e("utils"),a=i.base,i=i.inherit,o=e("core/g3wobject"),s=e("lodash.clonedeep");function l(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._features=e.features||[],this._provider=e.provider||null,this._loadedIds=[],this._lockIds=[],this.setters={addFeatures:function(e){var t=this;e.forEach(function(e){return t._addFeature(e)})},addFeature:function(e){this._addFeature(e)},removeFeature:function(e){this._removeFeature(e)},updateFeature:function(e){this._updateFeature(e)},clear:function(){this._clearFeatures()},getFeatures:function(){return this._getFeatures(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},commit:function(e,t){return this._commit(e,t)},featuresLockedByOtherUser:function(){}},a(this)}i(l,o);e=l.prototype;e.clone=function(){return s(this)},e.setProvider=function(e){this._provider=e},e.getProvider=function(){return this._provider},e.unlock=function(){var t=$.Deferred();return this._provider.unlock().then(function(e){return t.resolve(e)}).fail(function(e){return t.reject(e)}),t.promise()},e._getFeatures=function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=$.Deferred();return this._provider?this._provider.getFeatures(e).then(function(e){e=t._filterFeaturesResponse(e);t.addFeatures(e),n.resolve(e)}).fail(function(e){return n.reject(e)}):n.resolve(this._readFeatures()),n.promise()},e._filterFeaturesResponse=function(){var n=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.features,t=void 0===t?[]:t,e=e.featurelocks,r=void 0===e?[]:e;if(0===r.length)return 0<t.length&&this.featuresLockedByOtherUser(t),[];this._filterLockIds(r);var i=[],e=t.filter(function(e){var t=e.getId();if(r.find(function(e){e=e.featureid;return t==e})){if(-1===n._loadedIds.indexOf(t))return n._loadedIds.push(t),!0}else i.push(e)});return r.length<t.length&&this.featuresLockedByOtherUser(i),e},e._filterLockIds=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=this._lockIds.map(function(e){return e.featureid}),e=e.filter(function(e){return-1===t.indexOf(e.featureid)});this._lockIds=[].concat(r(this._lockIds),r(e))},e.addLoadedIds=function(e){this._loadedIds.push(e)},e.getLockIds=function(){return this._lockIds},e.addLockIds=function(e){var t=this;this._lockIds=_.union(this._lockIds,e),this._lockIds.forEach(function(e){return t._loadedIds.push(e.featureid)})},e._readFeatures=function(){return this._features},e._commit=function(e){var t=$.Deferred();return e&&this._provider?(e.lockids=this._lockIds,this._provider.commit(e).then(function(e){return t.resolve(e)}).fail(function(e){return t.reject(e)})):t.reject(),t.promise()},e.getFeatureById=function(t){return this._features.find(function(e){return t==e.getId()})},e.getFeatureByUid=function(t){return this._features.find(function(e){return t===e.getUid()})},e._addFeature=function(e){this._features.push(e)},e._updateFeature=function(n){var r=this;this._features.find(function(e,t){if(e.getUid()===n.getUid())return r._features[t]=n,!0})},e.setFeatures=function(e){this._features=e},e._removeFeature=function(t){this._features=this._features.filter(function(e){return t.getUid()!==e.getUid()})},e._clearFeatures=function(){this._features=null,this._features=[],this._lockIds=[],this._loadedIds=[]},e.getDataProvider=function(){return this._provider},e.readFeatures=function(){return this._features},t.exports=l},{"core/g3wobject":11,"lodash.clonedeep":"lodash.clonedeep",utils:404}],16:[function(e,t,n){var r=e("utils"),i=r.inherit,a=r.base;function o(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this._features=e.features||new ol.Collection([])}i(o,e("core/layers/features/featuresstore"));r=o.prototype;r.getLength=function(){return this._features.getLength()},r.setFeatures=function(){var t=this;(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(e){return t._features.push(e)})},r.readFeatures=function(){return this._features.getArray()},r.getFeaturesCollection=function(){return this._features},r.getFeatureById=function(t){return this._features.getArray().find(function(e){return t==e.getId()})},r.getFeatureByUid=function(t){return this._features.getArray().find(function(e){return t===e.getUid()})},r._addFeature=function(e){this._features.push(e),this._features.dispatchEvent("change")},r._updateFeature=function(e){for(var t=-1,n=this._features.getArray(),r=0;n.length;r++)if(n[r].getUid()===e.getUid()){t=r;break}0<=t&&(this._features.removeAt(t),this._features.insertAt(t,e),this._features.dispatchEvent("change"))},r._removeFeature=function(e){for(var t=this._features.getArray(),n=0;n<t.length;n++){var r=t[n];if(e.getUid()===r.getUid()){this._features.removeAt(n);break}}this._features.dispatchEvent("change")},r._clearFeatures=function(){try{this._features.clear()}catch(e){}this._features=null,this._features=new ol.Collection([])},t.exports=o},{"core/layers/features/featuresstore":15,utils:404}],17:[function(e,t,n){var r=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=e("app/constant");function a(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=this,n=a;if(!(t instanceof n))throw new TypeError("Cannot call a class as a function");this._layerName=e.layerName,this._expression=e.filter||""}t.exports=(r(a,[{key:"and",value:function(e,t){return this._expression=this._expression&&this._expression+" AND ",e&&t&&this.eq(e,t),this}},{key:"or",value:function(e,t){return e&&t&&(this._expression=this._expression&&this._expression+" OR ",this.eq(e,t)),this}},{key:"eq",value:function(e,t){return this._expression=this._expression+this._build("eq",e,t),this}},{key:"like",value:function(e,t){return this._expression=this._expression+this._build("LIKE",e,t),this}},{key:"ilike",value:function(e,t){return this._expression=this._expression+this._build("ILIKE",e,t),this}},{key:"not",value:function(e,t){return this._expression=this._expression+this._build("NOT",e,t),this}},{key:"gt",value:function(e,t){return this._expression=this._expression+this._build("gt",e,t),this}},{key:"gte",value:function(e,t){return this._expression=this._expression+this._build("gte",e,t),this}},{key:"lt",value:function(e,t){return this._expression=this._expression+this._build("lt",e,t),this}},{key:"lte",value:function(e,t){return this._expression=this._expression+this._build("lte",e,t),this}},{key:"clear",value:function(){return this._expression="",this}},{key:"get",value:function(){return this._layerName?this._layerName+": "+this._expression:this._expression}},{key:"_build",value:function(e,t,n){return['"'+t+'"',l.FILTER_EXPRESSION_OPERATORS[e],""+n].join(" ")}},{key:"createSingleExpressionElement",value:function(){var e,t,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=n.value,i=n.attribute,a=n.operator,n=n.logicop,o=l.FILTER_EXPRESSION_OPERATORS[a],s=n&&" "+n+" "||"";return"IN"===a?'"'+i+'" '+o+" ( "+[].concat(r).map(function(e){return"'"+e+"'"}).join(",").replace(/,/g," , ")+" )"+s:(e=![null,void 0].includes(r)&&!(Number.isNaN(r)||!r.toString().trim()),t=Array.isArray(r)?r:"number"!=typeof r?r.split("'"):[],e&&1<t.length?""+t.filter(function(e){return e}).map(function(e){return'"'+i+'" '+o+" '%"+e+"%'"}).join(" "+n+" ")+s:e?(t=["LIKE","ILIKE"].includes(a)?"%":"",'"'+i+'" '+o+" '"+t+r+t+"'"+s):void 0)}},{key:"createExpressionFromFilterObject",value:function(){var e,r=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=[],n=void 0;for(e in t)n=l.FILTER_EXPRESSION_OPERATORS[e],t[e].forEach(function(e){for(var t in e)if(Array.isArray(e[t]))r.createExpressionFromFilterObject(e);else for(var n in e[t])i.push(r.createSingleExpressionElement({value:e[t][n],operator:t,attribute:n}))}),n=i.join(" "+n+" ")||!1;return n}},{key:"createExpressionFromField",value:function(e){var t=e.layerName,n=e.field,r=e.value,e=e.operator;return this._expression=t+":"+this.createSingleExpressionElement({attribute:n,value:r,operator:void 0===e?"eq":e}),this}},{key:"createExpressionFromFilterArray",value:function(){var i=this,a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return a.reduce(function(e,t,n){var r=i.createSingleExpressionElement(t);return""+e+(t.logicop&&n===a.length-1?r.substring(0,r.length-(t.logicop.length+1)):r)},"")||void 0}},{key:"createExpressionFromFilter",value:function(e,t){e=Array.isArray(e)?this.createExpressionFromFilterArray(e):this.createExpressionFromFilterObject(e);return e&&(this._expression=t+":"+e),this}}]),a)},{"app/constant":5}],18:[function(e,t,n){var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)})(o,[{key:"getConfig",value:function(){return this.config}},{key:"setConfig",value:function(){this.config=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}}},{key:"mergeConfig",value:function(){this.config=r({},this.config,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}},{key:"getAll",value:function(){this._type=o.TYPES.all,this._filter=null}},{key:"setExpression",value:function(e){return this._type=o.TYPES.expression,this._filter=e,this}},{key:"setGeometry",value:function(e){return this._type=o.TYPES.geometry,this._filter=e,this}},{key:"setBBOX",value:function(e){return this._type=o.TYPES.bbox,this._filter=e,this}},{key:"setFids",value:function(e){return this._type=o.TYPES.fids,this._filter=e,this}},{key:"serialize",value:function(){return JSON.stringify(this)}},{key:"get",value:function(){return this._filter}},{key:"getType",value:function(){return this._type}},{key:"clear",value:function(){this._filter=null}}]);var a=o;function o(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=this,n=o;if(!(t instanceof n))throw new TypeError("Cannot call a class as a function");this._filter=null,this._type=null,this.config=e}a.TYPES={bbox:"bbox",geometry:"geometry",expression:"expression",fids:"fids",all:"all"},t.exports=a},{}],19:[function(e,t,n){var r=e("utils"),i=r.base,r=r.inherit,a=e("core/layers/vectorlayer"),o=e("core/layers/map/geojson");function s(e,t){i(this,e,t),this.config.style=e.style,this.setup(e)}r(s,a),s.prototype.getMapLayer=function(){return this._mapLayer||(this._mapLayer=new o({url:this.get("source").url,projection:this.getProjection().getCode(),id:this.getId(),name:this.getName(),style:this.get("style"),provider:this.getProvider("data")})),this._mapLayer},t.exports=s},{"core/layers/map/geojson":26,"core/layers/vectorlayer":41,utils:404}],20:[function(e,t,n){var T=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},k=r(e("store/projects")),p=r(e("services/application")),M=e("utils/get_legend_params");function r(e){return e&&e.__esModule?e:{default:e}}var i=e("utils"),a=i.base,o=i.inherit,i=i.mixin,f=e("core/layers/layer"),s=e("core/layers/vectorlayer"),h=e("core/layers/map/wmslayer"),g=e("core/layers/map/wmstlayer"),v=e("core/layers/map/arcgismapserverlayer"),m=e("core/layers/map/xyzlayer"),e=e("core/layers/mixins/geo");function P(e,t){return t||0===t?""+e+t:null}function l(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.setters={change:function(){}},a(this,e,t),this.config.baselayer=e.baselayer||!1,this.type=f.LayerTypes.IMAGE,this.legendUrl=null,this.customParams={},this.setup(e,t)}o(l,f),i(l,e);var u,o=l.prototype;o.getLayerForEditing=(u=function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.force,n=e.vectorurl,r=e.project_type,e=e.project;if(!(void 0!==t&&t)&&!this.isEditable())return null;try{var i=yield new s(this.config,{vectorurl:n,project_type:r,project:e||k.default.getCurrentProject()}).layerForEditing;return this.setEditingLayer(i),i}catch(e){return Promise.reject(e)}},function(){var s=u.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}),o.isBaseLayer=function(){return this.config.baselayer},o.isWMS=function(){return-1<l.WMSServerTypes.indexOf(this.config.servertype)},o.isLayerProjectionASMapProjection=function(){return this.config.crs.epsg===this.config.map_crs},o.getCrs=function(){return this.config.crs.epsg},o.isExternalWMS=function(){return!!(this.config.source&&this.config.source.external&&this.config.source.url)},o.isArcgisMapserver=function(){return this.isExternalWMS()&&this.config.source.type===f.SourceTypes.ARCGISMAPSERVER},o._getBaseLayerName=function(){return this.isWmsUseLayerIds()?this.getId():this.getName()},o._hasExternalWMSOrLegend=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"map",t=this.config.source;return t&&("map"!==e||this.isExternalWMS()&&this.isLayerProjectionASMapProjection())&&("legend"===e||t.external)},o.getWMSLayerName=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).type,t=(this.config||{source:{}}).source,t=t.layers||t.layer;return t&&this._hasExternalWMSOrLegend(void 0===e?"map":e)?t:this._getBaseLayerName()},o.getWmsUrl=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).type,t=(this.config||{source:{}}).source;return t.url&&this._hasExternalWMSOrLegend(void 0===e?"map":e)&&["wms","wmst"].includes(t.type)?t.url:this.config.wmsUrl},o.getWFSLayerName=function(){return this.getQueryLayerName().replace(/\s/g,"_").replaceAll(":","-")},o.useProxy=function(){return this.isExternalWMS()&&this.isLayerProjectionASMapProjection()&&this.getInfoFormats()},o.getWMSInfoLayerName=function(){return this.useProxy()?this.getSource().layers:this._getBaseLayerName()},o.getPrintLayerName=function(){return this.isWmsUseLayerIds()?this.getId():this.getName()},o.getStringBBox=function(){var e=this.config.bbox;return e.minx+","+e.miny+","+e.maxx+","+e.maxy},o.isWfsActive=function(){return Array.isArray(this.config.ows)&&this.config.ows.some(function(e){return"WFS"===e})},o.getFullWmsUrl=function(){var e=k.default.getCurrentProject().getState().metadata.wms_url;return e&&!this.isExternalWMS()?e:this.getWmsUrl()},o.getCatalogWmsUrl=function(){var e=k.default.getCurrentProject().getMetadata().wms_url;return e&&!this.isExternalWMS()?e:this.getWmsUrl()+"?service=WMS&version=1.3.0&request=GetCapabilities"},o.getCatalogWfsUrl=function(){return this.getWfsUrl()+"?service=WFS&version=1.1.0&request=GetCapabilities"},o.getCatalogWfs3Url=function(){return this.getWfsUrl()+"wfs3/"},o.getWfsUrl=function(){var e=k.default.getCurrentProject().getMetadata().wms_url;return e||this.config.wmsUrl},o.getQueryUrl=function(){var e=a(this,"getQueryUrl"),t=f.ServerTypes.QGIS===this.getServerType()&&this.isExternalWMS()&&this.isLayerProjectionASMapProjection();return t&&this.getInfoFormats()?this.getSource().url:t?e+"SOURCE="+this.config.source.type:e},o.getIconUrlFromLegend=function(){return this.getLegendUrl({layertitle:!1})},o.getLegendUrl=function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{categories:!1,all:!1,format:"image/png"},r=void 0,i=void 0,t=T({},t,this.customParams),a=t.width,o=t.height,s=t.color,s=void 0===s?"white":s,l=t.fontsize,l=void 0===l?10:l,u=t.transparent,u=void 0===u||u,c=t.boxspace,d=t.layerspace,p=t.layertitle,p=void 0===p||p,f=t.layertitlespace,h=t.symbolspace,g=t.iconlabelspace,v=t.symbolwidth,m=t.symbolheight,y=t.itemfontfamily,_=t.layerfontfamily,b=t.layerfontbold,w=t.itemfontbold,x=t.layerfontitalic,S=t.itemfontitalic,L=t.rulelabel,C=t.crs,E=t.bbox,t=t.sld_version,t=void 0===t?"1.1.0":t;return i=(i=this.isArcgisMapserver()?(r=this.getConfig().source.url.replace("/rest/","/")+"/WMSServer",["request=GetLegendGraphic","version=1.3.0","format=image/png","LAYER="+this.getConfig().source.layer]):(e=n.categories&&(["image/png",void 0].includes(n.format)||k.default.getCurrentProject().getContextBaseLegend())?(0,M.get_legend_params)(this):void 0,r=this.getWmsUrl({type:"legend"}),["SERVICE=WMS","VERSION=1.3.0","REQUEST=GetLegendGraphic",P("SLD_VERSION=",t),P("WIDTH=",a),P("HEIGHT=",o),P("FORMAT=",void 0===n.format?"image/png":n.format),P("TRANSPARENT=",u),P("ITEMFONTCOLOR=",s),P("LAYERFONTCOLOR=",s),P("LAYERTITLE=",p),P("ITEMFONTSIZE=",l),P("CRS=",C),P("BBOX=",[!1,void 0].includes(n.all)&&E&&E.join(",")),P("BOXSPACE=",c),P("LAYERSPACE=",d),P("LAYERTITLESPACE=",f),P("SYMBOLSPACE=",h),P("ICONLABELSPACE=",g),P("SYMBOLWIDTH=",n.categories&&"application/json"===n.format?16:v),P("SYMBOLHEIGHT=",n.categories&&"application/json"===n.format?16:m),P("LAYERFONTFAMILY=",_),P("ITEMFONTFAMILY=",y),P("LAYERFONTBOLD=",b),P("ITEMFONTBOLD=",w),P("LAYERFONTITALIC=",x),P("ITEMFONTITALIC=",S),P("RULELABEL=",L),P("LEGEND_ON=",e&&e.LEGEND_ON),P("LEGEND_OFF=",e&&e.LEGEND_OFF),P("STYLES=",n.categories&&"application/json"===n.format?encodeURIComponent(this.getCurrentStyle().name):void 0),P("LAYER=",this.getWMSLayerName({type:"legend"}))])).filter(function(e){return e}),this.legendUrl=""+r+(-1<r.indexOf("?")?"&":"?")+i.join("&"),this.legendUrl},o.setMapParamstoLegendUrl=function(e){var t=e.bbox,e=e.crs;this.customParams=T({},this.customParams,{bbox:t,crs:e})},o.getWfsCapabilities=function(){return this.config.wfscapabilities||1===this.config.capabilities},o.getMapLayer=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=(e.iframe_internal=p.default.isIframe()&&!this.isExternalWMS(),this.isExternalWMS()?"GET":this.getOwsMethod()),r=this.config.bbox?[this.config.bbox.minx,this.config.bbox.miny,this.config.bbox.maxx,this.config.bbox.maxy]:null,i=this.config.source,a=this.config.cache_provider,o=this.config.cache_service_type||"tms",s=this.config.cache_layer,l=this.config.cache_extent,u=this.config.cache_grid,c=this.config.cache_grid_extent,d=this.isCached()?this.getCacheUrl():e.url||this.getWmsUrl();return this.isCached()&&"tms"===o?new m(T({},e,{extent:r,url:d,cache_provider:a}),n):this.isCached()&&"wmts"===o?new g(T({},e,{url:d,cache_provider:a,cache_layer:s,cache_extent:l,cache_grid:u,cache_grid_extent:c}),t,n):this.isExternalWMS()&&i&&f.SourceTypes.ARCGISMAPSERVER===i.type?new v(T({},e,i),t):this.isExternalWMS()&&i&&f.SourceTypes.WMST===i.type?new g(T({},e,{url:d,cache_provider:a}),t,n):new h(T({},e,{url:d}),t,n)},o.getFormat=function(){return this.isExternalWMS()&&this.getSource()?this.getSource().format:a(this,"getFormat")},o.getOwsMethod=function(){return this.isExternalWMS()||!/^\/ows/.test(new URL(this.getQueryUrl(),window.initConfig.baseurl).pathname)?"GET":this.config.ows_method},l.WMSServerTypes=[f.ServerTypes.QGIS,f.ServerTypes.Mapserver,f.ServerTypes.Geoserver,f.ServerTypes.OGC],t.exports=l},{"core/layers/layer":21,"core/layers/map/arcgismapserverlayer":25,"core/layers/map/wmslayer":29,"core/layers/map/wmstlayer":30,"core/layers/map/xyzlayer":31,"core/layers/mixins/geo":33,"core/layers/vectorlayer":41,"services/application":298,"store/projects":317,utils:404,"utils/get_legend_params":399}],21:[function(e,t,n){var d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},r=e("app/constant"),p=c(e("store/application-state")),a=c(e("services/data")),o=c(e("store/projects")),i=c(e("core/layers/mixins/download")),s=e("core/layers/mixins/selection"),l=c(s),u=c(e("core/layers/mixins/relations")),f=e("utils/parseAttributes");function c(e){return e&&e.__esModule?e:{default:e}}function h(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var g=e("core/i18n/i18n.service").t,v=e("utils"),m=v.inherit,y=v.base,_=v.XHR,v=e("core/g3wobject"),b=e("core/layers/providersfactory"),e=e("util-deprecate");function w(){var e,t,n=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=((this.config=r).id=r.id||"Layer",r.title=r.title||r.name,r.download=!!r.download,r.geolayer=!1,r.baselayer=!!r.baselayer,r.fields=r.fields||{},r.urls=d({query:r.infourl&&""!==r.infourl?r.infourl:r.wmsUrl},r.urls||{}),i.project),i=void 0===i?o.default.getCurrentProject():i,a=(this.config.search_endpoint="api",this._relations=this._createRelations(i.getRelations()),this.isBaseLayer()||(t=i.getType()+"/"+i.getId()+"/"+r.id+"/",e=i.getVectorUrl(),a=i.getRasterUrl(),this.config.urls.filtertoken=e+"filtertoken/"+t,this.config.urls.data=e+"data/"+t,this.config.urls.shp=e+"shp/"+t,this.config.urls.csv=e+"csv/"+t,this.config.urls.xls=e+"xls/"+t,this.config.urls.gpx=e+"gpx/"+t,this.config.urls.gpkg=e+"gpkg/"+t,this.config.urls.geotiff=a+"geotiff/"+t,this.config.urls.editing=e+"editing/"+t,this.config.urls.commit=e+"commit/"+t,this.config.urls.config=e+"config/"+t,this.config.urls.unlock=e+"unlock/"+t,this.config.urls.widget={unique:e+"widget/unique/data/"+t},this.config.urls.featurecount=i.getUrl("featurecount"),this.config.searchParams={I:0,J:0}),r.styles&&r.styles.find(function(e){return e.current}).name),a=(this.state={id:r.id,title:r.title,selected:r.selected||!1,disabled:r.disabled||!1,metadata:r.metadata,metadata_querable:!this.isBaseLayer()&&this.isQueryable({onMap:!1}),openattributetable:!this.isBaseLayer()&&this.canShowTable(),removable:r.removable||!1,downloadable:this.isDownloadable(),source:r.source,styles:r.styles,defaultstyle:a,inediting:!1,infoformat:this.getInfoFormat(),infoformats:this.config.infoformats||[],projectLayer:!0,geolayer:!1,selection:{active:!1},filter:{active:!1,current:null},filters:r.filters||[],attributetable:{pageLength:null},visible:r.visible||!1,tochighlightable:!1,featurecount:r.featurecount,stylesfeaturecount:r.featurecount&&a&&(e={},t=a,i=r.featurecount,t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e),name:r.name,expanded:r.expanded,toc:"boolean"!=typeof r.toc||r.toc},this.selectionFids=new Set,this._layersstore=r.layersstore||null,this.config.servertype+" "+(this.config.source&&this.config.source.type));this.providers={data:["QGIS virtual","QGIS postgres","QGIS oracle","QGIS mssql","QGIS spatialite","QGIS ogr","QGIS delimitedtext","QGIS wfs"].includes(a)?new b.qgis({layer:n}):"G3WSUITE geojson"==a?new b.geojson({layer:n}):void 0,filter:["QGIS virtual","QGIS postgres","QGIS oracle","QGIS mssql","QGIS spatialite","QGIS ogr","QGIS delimitedtext","QGIS wfs","QGIS wmst","QGIS wcs","QGIS wms"].includes(a)&&new b.wfs({layer:this}),filtertoken:["QGIS virtual","QGIS postgres","QGIS oracle","QGIS mssql","QGIS spatialite","QGIS ogr","QGIS delimitedtext"].includes(a)&&new b.qgis({layer:this}),query:["QGIS virtual","QGIS postgres","QGIS oracle","QGIS mssql","QGIS spatialite","QGIS ogr","QGIS delimitedtext","QGIS wfs","QGIS wmst","QGIS wcs","QGIS wms","QGIS gdal","QGIS postgresraster","QGIS vector-tile","QGIS vectortile","QGIS arcgismapserver","QGIS mdal","OGC wms"].includes(a)?new b.wms({layer:n}):"G3WSUITE geojson"==a?new b.geojson({layer:n}):void 0,search:["QGIS virtual","QGIS postgres","QGIS oracle","QGIS mssql","QGIS spatialite","QGIS ogr","QGIS delimitedtext","QGIS wfs"].includes(a)&&new b.qgis({layer:this})},this.proxyData={wms:null},y(this)}m(w,v),Object.assign(w.prototype,i.default),Object.assign(w.prototype,u.default),Object.assign(w.prototype,l.default);var x,S,m=w.prototype;m.getProxyData=function(e){return e?this.proxyData[e]:this.proxyData},m.setProxyData=function(e){this.proxyData[e]=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}},m.clearProxyData=function(e){this.proxyData[e]=null},m.getDataProxyFromServer=h(function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"wms",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};try{var n=yield a.default.getData("proxy:"+e,{inputs:t,outputs:!1}),r=n.response,i=n.data;return this.setProxyData(e,JSON.parse(i)),r}catch(e){}}),m.changeProxyDataAndReloadFromServer=function(){var n=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"wms",i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(i).forEach(function(t){Object.keys(i[t]).forEach(function(e){n.proxyData[r][t][e]=i[t][e]})}),this.getDataProxyFromServer(r,this.proxyData[r])},m.isInEditing=function(){return this.state.inediting},m.setInEditing=function(){this.state.inediting=0<arguments.length&&void 0!==arguments[0]&&arguments[0]},m.getSearchParams=function(){return this.config.searchParams},m.getSearchEndPoint=function(){return"api"},m.setAttributeTablePageLength=function(e){this.state.attributetable.pageLength=e},m.getAttributeTablePageLength=function(){return this.state.attributetable.pageLength},m.getWMSLayerName=function(){return this.isWmsUseLayerIds()?this.getId():this.getName()},m.isWmsUseLayerIds=function(){return this.config.wms_use_layer_ids},m.getSourceType=function(){return this.config.source?this.config.source.type:null},m.isGeoLayer=function(){return this.state.geolayer},m.getDataTable=function(){var n=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.page,t=void 0===t?null:t,r=e.page_size,r=void 0===r?null:r,i=e.ordering,i=void 0===i?null:i,a=e.search,a=void 0===a?null:a,o=e.suggest,o=void 0===o?null:o,s=e.formatter,s=void 0===s?0:s,l=e.custom_params,l=void 0===l?{}:l,u=e.field,e=e.in_bbox,c=$.Deferred(),l=d({},l,{field:u,page:t,page_size:r,ordering:i,search:a,formatter:s,suggest:o,in_bbox:e,filtertoken:p.default.tokens.filtertoken});return this.getProvider("filter")||this.getProvider("data")?this.getProvider("data").getFeatures({editing:!1},l).done(function(e){var t=e.data.features&&e.data.features||[];c.resolve({headers:(0,f.parseAttributes)(n.getAttributes(),t.length?t[0].properties:[]),features:t,title:n.getTitle(),count:e.count})}).fail(function(e){return c.reject(e)}):c.reject(),c.promise()},m.getFeatureByFids=h(function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.fids,t=void 0===t?[]:t,e=e.formatter,e=void 0===e?0:e,n=this.getUrl("data");try{var r=yield _.get({url:n,params:{fids:t.toString(),formatter:e}});if(r&&r.result&&r.vector&&r.vector.data)return r.vector.data.features}catch(e){}}),m.searchFeatures=function(){var n,e=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},t=r.search_endpoint,a=void 0===t?this.config.search_endpoint:t;return new Promise((n=h(function*(t,n){switch(a){case"ows":e.search(r,i).then(function(e){t({data:e})}).fail(n);break;case"api":try{t(yield e.getFilterData({queryUrl:r.queryUrl,field:r.filter,ordering:r.ordering,unique:r.unique,raw:void 0!==r.raw&&r.raw,suggest:r.suggest,formatter:void 0!==r.formatter?r.formatter:1}))}catch(e){n(e)}}}),function(e,t){return n.apply(this,arguments)}))},m.getFilterData=h(function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.raw,t=void 0!==t&&t,n=e.suggest,r=e.field,i=e.unique,a=e.fformatter,o=e.ffield,s=e.formatter,s=void 0===s?1:s,l=e.queryUrl,e=e.ordering;return yield this.getProvider("data").getFilterData({queryUrl:l,field:r,raw:t,ordering:e,suggest:n,formatter:s,unique:i,fformatter:a,ffield:o})}),m.search=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=(e.feature_count=e.feature_count||10,e=d({},e,this.config.searchParams,t),$.Deferred()),t=this.getProvider("search");return t?t.query(e).done(function(e){return n.resolve(e)}).fail(function(e){return n.reject(e)}):n.reject(g("sdk.search.layer_not_searchable")),n.promise()},m.query=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=$.Deferred(),n=this.getProvider(e.filter?"filter":"query");return n?n.query(e).done(function(e){return t.resolve(e)}).fail(function(e){return t.reject(e)}):t.reject(g("sdk.search.layer_not_querable")),t.promise()},m.get=function(e){return this.config[e]||this.state[e]},m.getFields=function(){return this.config.fields},m.getFieldByName=function(t){return this.getFields().find(function(e){return e.name===t})},m.getEditingFields=function(){return this.config.editing.fields},m.getTableFields=function(){return(this.config.fields||[]).filter(function(e){return e.show})},m.getTableHeaders=function(){return this.getTableFields().filter(function(e){return-1===r.GEOMETRY_FIELDS.indexOf(e.name)})},m.getProject=function(){return this.config.project},m.getConfig=function(){return this.config},m.getLayerEditingFormStructure=function(e){return this.config.editor_form_structure},m.getFieldsOutOfFormStructure=function(){return this.config.editor_form_structure?this.config.editor_form_structure.filter(function(e){return e.field_name}):[]},m.hasFormStructure=function(){return!!this.config.editor_form_structure},m.getCustomStyle=function(){return this.config.customstyle},m.getState=function(){return this.state},m.getSource=function(){return this.state.source},m.getEditingLayer=function(){return this._editingLayer},m.setEditingLayer=function(e){this._editingLayer=e},m.isHidden=function(){return this.state.hidden},m.setHidden=function(){this.state.hidden=!(0<arguments.length&&void 0!==arguments[0])||arguments[0]},m.isModified=function(){return this.state.modified},m.getId=function(){return this.config.id},m.getMetadata=function(){return this.state.metadata},m.getTitle=function(){return this.config.title},m.getName=function(){return this.config.name},m.getOrigName=function(){return this.config.origname},m.getServerType=function(){return this.config.servertype&&""!==this.config.servertype?this.config.servertype:ServerTypes.QGIS},m.getType=function(){return this.type},m.setType=function(e){this.type=e},m.isType=function(e){return this.getType()===e},m.setDisabled=function(e){this.state.disabled=e},m.isDisabled=function(){return this.state.disabled},m.isVisible=function(){return this.state.visible},m.setVisible=function(e){this.state.visible=e},m.isQueryable=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{onMap:!1}).onMap,t=!1,n=!!(this.config.capabilities&&this.config.capabilities&w.CAPABILITIES.QUERYABLE);return e?n&&(t=this.isVisible()&&!this.isDisabled(),void 0!==this.config.infowhennotvisible)&&!0===this.config.infowhennotvisible||t:n},m.getOws=function(){return this.config.ows},m.getTocHighlightable=function(){return this.state.tochighlightable},m.setTocHighlightable=function(){this.state.tochighlightable=0<arguments.length&&void 0!==arguments[0]&&arguments[0]},m.isFilterable=function(){var e,r=this,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=!!(this.config.capabilities&&this.config.capabilities&w.CAPABILITIES.FILTERABLE);return t&&i&&(e=Object.keys(i).reduce(function(e,t){var n=r.get(t),t=i[t];return e&&Array.isArray(n)?-1!==n.indexOf(t):t===n},!0),t=t&&e),t},m.isQtimeseries=function(){return this.config.qtimeseries},m.isEditable=function(){return!!(this.config.capabilities&&this.config.capabilities&w.CAPABILITIES.EDITABLE)},m.isBaseLayer=function(){return this.config.baselayer},m.getUrl=function(e){return this.config.urls[e]},m.setUrl=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.type,e=e.url;this.config.urls[t]=e},m.getUrls=function(){return this.config.urls},m.setEditingUrl=function(e){this.config.urls.editing=e||this.config.urls.editing},m.getQueryUrl=function(){return this.config.urls.query},m.setQueryUrl=function(e){this.config.urls.query=e},m.getQueryLayerName=function(){return this.config.infolayer&&""!==this.config.infolayer?this.config.infolayer:this.getName()},m.getQueryLayerOrigName=function(){return this.state.infolayer&&""!==this.config.infolayer?this.config.infolayer:this.config.origname},m.getInfoFormat=function(e){return!0===this.config.qtimeseries||"gdal"===this.getSourceType()?"application/json":this.config.infoformat&&""!==this.config.infoformat&&"wfs"!==e?this.config.infoformat:"application/vnd.ogc.gml"},m.getInfoFormats=function(){return this.state.infoformats},m.getInfoUrl=function(){return this.config.infourl},m.setInfoFormat=function(e){this.config.infoformat=e},m.getAttributes=function(){return this.config.fields},m.changeAttribute=function(e,t,n){var r=!0,i=!1,a=void 0;try{for(var o,s=this.config.fields[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var l=o.value;if(l.name===e){l.type=t,l.options=n;break}}}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}},m.getAttributeLabel=function(t){var e=this.getAttributes().find(function(e){return e.name===t});return e&&e.label},m.getProvider=function(e){return this.providers[e]},m.getProviders=function(){return this.providers},m.getLayersStore=function(){return this._layersstore},m.setLayersStore=function(e){this._layersstore=e},m.canShowTable=function(){return!this.config.not_show_attributes_table&&(this.getServerType()===w.ServerTypes.QGIS&&-1<[w.SourceTypes.POSTGIS,w.SourceTypes.ORACLE,w.SourceTypes.WFS,w.SourceTypes.OGR,w.SourceTypes.MSSQL,w.SourceTypes.SPATIALITE].indexOf(this.config.source.type)&&this.isQueryable()?0<this.getTableFields().length:this.getServerType()===w.ServerTypes.G3WSUITE&&"geojson"===this.get("source").type||!(this.getServerType()===w.ServerTypes.G3WSUITE||!this.isFilterable()))},m.changeFieldType=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.name,n=e.type,r=e.options,r=void 0===r?{}:r,e=e.reset,e=void 0!==e&&e,i=this.getFields().find(function(e){return e.name===t});return i&&e?(i.type=i._type,delete i._type,delete i[n+"options"],i.type):i&&!e?(i._type=i.type,i.type=n,i[n+"options"]=r,i._type):void 0},m.changeConfigFieldType=function(e){var t=e.name,n=e.type,r=e.options,e=e.reset;return this.changeFieldType({name:t,type:n,options:void 0===r?{}:r,reset:void 0!==e&&e})},m.resetConfigField=function(e){e=e.name;this.changeConfigFieldType({name:e,reset:!0})},m.clear=function(){},m.isVector=function(){return this.getType()===w.LayerTypes.VECTOR},m.isTable=function(){return this.getType()===w.LayerTypes.TABLE},m.getFeatureCount=function(){return this.state.featurecount},m.getStyleFeatureCount=(x=h(function*(t){if(void 0!==this.state.stylesfeaturecount){if(void 0===this.state.stylesfeaturecount[t])try{var e=yield _.post({url:""+this.config.urls.featurecount+this.getId()+"/",data:JSON.stringify({style:t}),contentType:"application/json"}),n=e.result,r=e.data;this.state.stylesfeaturecount[t]=!0===n?r:{}}catch(e){this.state.stylesfeaturecount[t]={}}return this.state.stylesfeaturecount[t]}}),function(e){return x.apply(this,arguments)}),m.getFormat=function(){return this.config.format||o.default.getCurrentProject().getWmsGetmapFormat()||"image/png"},m.activeFilterToken=e((S=h(function*(e){yield this[e?"createFilterToken":"deleteFilterToken"]()}),function(e){return S.apply(this,arguments)}),"[G3W-CLIENT] Layer::activeFilterToken(bool) is deprecated"),m.getEditorFormStructure=e(m.getLayerEditingFormStructure,"[G3W-CLIENT] Layer::getEditorFormStructure() is deprecated"),w.LayerTypes={TABLE:"table",IMAGE:"image",VECTOR:"vector"},w.ServerTypes={OGC:"OGC",QGIS:"QGIS",Mapserver:"Mapserver",Geoserver:"Geoserver",ARCGISMAPSERVER:"ARCGISMAPSERVER",OSM:"OSM",BING:"Bing",LOCAL:"Local",TMS:"TMS",WMS:"WMS",WMTS:"WMTS",G3WSUITE:"G3WSUITE"},w.SourceTypes={VIRTUAL:"virtual",POSTGIS:"postgres",SPATIALITE:"spatialite",ORACLE:"oracle",MSSQL:"mssql",CSV:"delimitedtext",OGR:"ogr",GDAL:"gdal",WMS:"wms",WMST:"wmst",WFS:"wfs",WCS:"wcs",MDAL:"mdal","VECTOR-TILE":"vector-tile",VECTORTILE:"vectortile",ARCGISMAPSERVER:"arcgismapserver",GEOJSON:"geojson",POSTGRESRASTER:"postgresraster"},w.CAPABILITIES={QUERYABLE:1,FILTERABLE:2,EDITABLE:4},w.EDITOPS={INSERT:1,UPDATE:2,DELETE:4},w.SELECTION_STATE=s.SELECTION,t.exports=w},{"app/constant":5,"core/g3wobject":11,"core/i18n/i18n.service":12,"core/layers/mixins/download":32,"core/layers/mixins/relations":34,"core/layers/mixins/selection":35,"core/layers/providersfactory":36,"services/data":300,"store/application-state":310,"store/projects":317,"util-deprecate":"util-deprecate",utils:404,"utils/parseAttributes":423}],22:[function(e,t,n){var r=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=e("store/application-state"),o=(a=a)&&a.__esModule?a:{default:a};function s(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(e)return!t||"object"!=typeof t&&"function"!=typeof t?e:t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var p=e("core/layers/layer"),f=e("core/layers/tablelayer"),h=e("core/layers/vectorlayer"),g=e("core/layers/imagelayer"),a=e("core/layers/baselayer"),d=e("g3w-ol/layers/bases"),v=e("core/layers/geojson"),m=[p.SourceTypes.VIRTUAL,p.SourceTypes.POSTGIS,p.SourceTypes.MSSQL,p.SourceTypes.SPATIALITE,p.SourceTypes.WFS,p.SourceTypes.CSV,p.SourceTypes.ORACLE,p.SourceTypes.OGR,p.SourceTypes.MDAL],y=[p.SourceTypes.WMST,p.SourceTypes.WCS,p.SourceTypes.WMS,p.SourceTypes.GDAL,p.SourceTypes.VECTORTILE,p.SourceTypes["VECTOR-TILE"],p.SourceTypes.MDAL,p.SourceTypes.ARCGISMAPSERVER,p.SourceTypes.POSTGRESRASTER],_=(s(e={},p.ServerTypes.OSM,(c(C,a),r(C,[{key:"_makeOlLayer",value:function(){return d.OSM.get({id:this.config.name,title:this.config.title,url:this.config.url})}}]),C)),s(e,p.ServerTypes.BING,(c(L,a),r(L,[{key:"_makeOlLayer",value:function(){var e=o.default.keys.vendorkeys.bing;switch(this.config.source?this.config.source.subtype:null){case"streets":return d.BING.get({key:e,imagerySet:"Road"});case"aerial":return d.BING.get({key:e,imagerySet:"Aerial"});case"aerialwithlabels":return d.BING.get({key:e,imagerySet:"AerialWithLabels"});default:return d.BING.get({key:e,imagerySet:"Aerial"})}}}]),L)),s(e,p.ServerTypes.TMS,(c(S,a),r(S,[{key:"_makeOlLayer",value:function(){var e=this.config,t=e.url,n=e.attributions,r=e.minZoom,i=e.maxZoom,e=e.crs;return d.TMS.get({url:t,minZoom:r,maxZoom:i,attributions:n,projection:this.getProjectionFromCrs(e)})}}]),S)),s(e,p.ServerTypes.ARCGISMAPSERVER,(c(x,a),r(x,[{key:"_makeOlLayer",value:function(){var e=this.config,t=e.url,n=e.attributions,e=e.crs;return d.TMS.get({url:t,source_type:"arcgismapserver",projection:this.getProjectionFromCrs(e),attributions:n})}}]),x)),s(e,p.ServerTypes.WMTS,(c(w,a),r(w,[{key:"_makeOlLayer",value:function(){var e=this.config,t=e.url,n=e.layer,r=e.attributions,i=e.matrixSet,a=e.format,o=e.style,s=e.requestEncoding,l=e.crs,u=e.grid,c=e.grid_extent,e=e.projection;return d.WMTS.get({url:t,layer:n,attributions:r,format:a,projection:e||this.getProjectionFromCrs(l),requestEncoding:s,matrixSet:i,style:o,grid:u,grid_extent:c})}}]),w)),s(e,p.ServerTypes.WMS,(c(b,a),r(b,[{key:"_makeOlLayer",value:function(){var e=this.config,t=e.url,n=e.layers,r=e.singleTile,i=e.attributions,a=e.crs,e=e.opacity;return d.WMS.get({url:t,layers:n,singleTile:r,attributions:i,projection:this.getProjectionFromCrs(a),opacity:e})}}]),b)),e);function b(){return l(this,b),u(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}function w(){return l(this,w),u(this,(w.__proto__||Object.getPrototypeOf(w)).apply(this,arguments))}function x(){return l(this,x),u(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}function S(){return l(this,S),u(this,(S.__proto__||Object.getPrototypeOf(S)).apply(this,arguments))}function L(){return l(this,L),u(this,(L.__proto__||Object.getPrototypeOf(L)).apply(this,arguments))}function C(){return l(this,C),u(this,(C.__proto__||Object.getPrototypeOf(C)).apply(this,arguments))}r(E,[{key:"build",value:function(e,t){var n=this.get(e);return n?new n(e,t):null}},{key:"get",value:function(){var e,t,n,r,i,a,o,s,l,u,c,d=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(d.servertype)return u=d.source||{},e=p.ServerTypes.QGIS===d.servertype,i=p.ServerTypes.OGC===d.servertype,t=p.ServerTypes.G3WSUITE===d.servertype,n=p.ServerTypes.LOCAL===d.servertype,r=i&&p.SourceTypes.WMS===u.type,i=i&&p.SourceTypes.WFS===u.type,a=t&&p.SourceTypes.GEOJSON===u.type,o=e&&p.SourceTypes.POSTGRESRASTER===u.type,s="NoGeometry"===d.geometrytype,l=d.geometrytype&&m.includes(u.type),u=!d.geometrytype&&y.includes(u.type),c=d.servertype in _,e&&l&&s?f:r||e&&(u||l&&!s||o)?g:n||i||t&&!a?h:c?_[d.servertype]:a?v:void 0}}]);a=E;function E(){l(this,E)}t.exports=new a},{"core/layers/baselayer":13,"core/layers/geojson":19,"core/layers/imagelayer":20,"core/layers/layer":21,"core/layers/tablelayer":37,"core/layers/vectorlayer":41,"g3w-ol/layers/bases":73,"store/application-state":310}],23:[function(e,t,n){var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=e("utils"),i=r.base,o=r.inherit,l=r.uniqueId;function u(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.config={id:e.id||Date.now(),projection:e.projection,extent:e.extent,initextent:e.initextent,wmsUrl:e.wmsUrl,catalog:!_.isBoolean(e.catalog)||e.catalog},this.state={layerstree:[],relations:null},this._isQueryable=!_.isBoolean(e.queryable)||e.queryable,this._layers=this.config.layers||{},this.setters={setLayerSelection:function(e){var t=e.layerId;e.selection,this.getLayerById(t)},setLayerSelected:function(t,n){this.getLayers().forEach(function(e){return e.state.selected=t===e.getId()&&n})},addLayers:function(e){var t=this;e.forEach(function(e){return t.addLayer(e)})},addLayer:function(e){this._addLayer(e)},removeLayer:function(e){this._removeLayer(e)}},i(this)}o(u,e("core/g3wobject"));r=u.prototype;r.isQueryable=function(){return this._isQueryable},r.setQueryable=function(e){this._isQueryable=!!e},r.showOnCatalog=function(){return this.config.catalog},r.setOptions=function(e){this.config=e},r.getId=function(){return this.config.id},r._addLayer=function(e){this._layers[e.getId()]=e},r._removeLayer=function(e){e=e.getId();delete this._layers[e]},r.removeLayers=function(){var t=this;Object.entries(this._layers).forEach(function(e){e=s(e,2),e[0],e=e[1];t.removeLayer(e)})},r.getLayersDict=function(){var t,e,n,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return!r||[r.PRINTABLE,r.QUERYABLE,r.FILTERABLE,r.EDITABLE,r.VISIBLE,r.SELECTED,r.CACHED,r.SELECTED_OR_ALL,r.SERVERTYPE,r.BASELAYER,r.GEOLAYER,r.VECTORLAYER,r.HIDDEN,r.DISABLED,r.IDS].every(function(e){return void 0===e})?this._layers:(e=Object.values(this._layers),r.IDS&&(t=[].concat(r.IDS),e=e.filter(function(e){return-1!==t.indexOf(e.getId())})),r.SELECTED_OR_ALL&&(e=0<(n=e.filter(function(e){return e.isSelected()})).length?n:e),(n=function(e){return"boolean"==typeof e})(r.SELECTED)&&!r.SELECTED_OR_ALL&&(e=e.filter(function(e){return r.SELECTED===e.isSelected()})),n(r.QUERYABLE)&&(e=e.filter(function(e){return r.QUERYABLE===e.isQueryable()})),n(r.FILTERABLE)&&(e=e.filter(function(e){return r.FILTERABLE===e.isFilterable(i.filtrable||null)})),n(r.EDITABLE)&&(e=e.filter(function(e){return r.EDITABLE===e.isEditable()})),n(r.VISIBLE)&&(e=e.filter(function(e){return r.VISIBLE===e.isVisible()})),n(r.CACHED)&&(e=e.filter(function(e){return r.CACHED===e.isCached()})),n(r.BASELAYER)&&(e=e.filter(function(e){return r.BASELAYER===e.isBaseLayer()})),n(r.GEOLAYER)&&(e=e.filter(function(e){return r.GEOLAYER===e.state.geolayer})),n(r.VECTORLAYER)&&(e=e.filter(function(e){return r.VECTORLAYER===e.isType("vector")})),n(r.HIDDEN)&&(e=e.filter(function(e){return r.HIDDEN==e.isHidden()})),n(r.DISABLED)&&(e=e.filter(function(e){return r.DISABLED===e.isDisabled()})),"string"==typeof r.SERVERTYPE&&r.SERVERTYPE.length&&(e=e.filter(function(e){return r.SERVERTYPE===e.getServerType()})),r.PRINTABLE?e.filter(function(e){return e.state.geolayer&&e.isPrintable({scale:r.PRINTABLE.scale})}):e)},r.getLayers=function(){return Object.values(this.getLayersDict(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}))},r.getBaseLayers=function(){return this.getLayersDict({BASELAYER:!0})},r.getLayerById=function(e){return this.getLayersDict()[e]},r.getLayerByName=function(t){return this._layers.find(function(e){return e.getName()===t})},r.getLayerAttributes=function(e){return this.getLayerById(e).getAttributes()},r.getLayerAttributeLabel=function(e,t){return this.getLayerById(e).getAttributeLabel(t)},r.getGeoLayers=function(){return this.getLayers({GEOLAYER:!0})},r._getAllSiblingsChildrenLayersId=function(e){var n=[];return function t(e){e.nodes.forEach(function(e){e.id?n.push(e.id):t(e)})}(e),n},r._getAllParentLayersId=function(e,t){var n=[];return{nodes:e.nodes.filter(function(e){return e!==t})}.nodes.forEach(function(e){e.id&&n.push(e.id)}),n},r.selectLayer=function(e,t){this.setLayerSelected(e,t)},r.getProjection=function(){return this.config.projection},r.getExtent=function(){return this.config.extent},r.getInitExtent=function(){return this.config.initextent},r.getWmsUrl=function(){return this.config.wmsUrl},r.removeLayersTree=function(){this.state.layerstree.splice(0,this.state.layerstree.length)},r.getLayersTree=function(){return this.state.layerstree},r.setLayersTree=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],r=this.getInitExtent(),r=s(r,4),i=r[0],a=r[1],o=r[2],r=r[3],t={title:t||this.config.id,root:!0,parentGroup:null,expanded:n,disabled:!1,checked:!0,bbox:{minx:i,miny:a,maxx:o,maxy:r},nodes:e};e.length&&(this._traverseLayersTree(e,t),this.state.layerstree.splice(0,0,t))},r.createLayersTree=function(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{layerstree:null,expanded:!1,full:!1},r=[];if(n.layerstree&&!0===n.full)return this.state.layerstree;n.layerstree&&!0!==n.full&&(t=this.getLayers({BASELAYER:!1}).map(function(e){return e.getId()}),this._traverseLightLayersTree(n.layerstree,r,t)),n.layerstree||(r=this.getGeoLayers().map(function(e){return{id:e.getId(),name:e.getName(),title:e.getTitle(),visible:e.isVisible()||!1}})),this.setLayersTree(r,e,n.expanded)},r._traverseLightLayersTree=function(e,n,r){var i=this;e.forEach(function(t){var e=null;null!==t.id&&void 0!==t.id&&r.find(function(e){return e===t.id})&&(e=a({},e,t)),null!==t.nodes&&void 0!==t.nodes&&(e=a({},e,{name:t.name,title:t.name,groupId:l(),root:!1,nodes:[],checked:t.checked,mutually_exclusive:t["mutually-exclusive"],"mutually-exclusive":t["mutually-exclusive"]}),i._traverseLightLayersTree(t.nodes,e.nodes,r)),null!==e&&(e.expanded=t.expanded,n.push(e))})},r._traverseLayersTree=function(n,r){var i=this;n.forEach(function(e,t){void 0!==e.id&&(n[t]=i.getLayerById(e.id).getState()),void 0!==e.id&&(n[t]=i.getLayerById(e.id).getState(),void 0!==n[t].bbox)&&i._setLayersTreeGroupBBox(r,{bbox:n[t].bbox,epsg:n[t].epsg}),Array.isArray(e.nodes)&&(e.nodes.forEach(function(e){return e.parentGroup=r}),i._traverseLayersTree(e.nodes,e)),n[t].parentGroup=r})},r._setLayersTreeGroupBBox=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.bbox,t=t.epsg,r=this.getProjection().getCode();t!==r&&(t=ol.proj.transformExtent([n.minx,n.miny,n.maxx,n.maxy],t,r),n={minx:(t=s(t,4))[0],miny:t[1],maxx:t[2],maxy:t[3]}),void 0===e.bbox?e.bbox=n:e.bbox=ol.extent.extend([e.bbox.minx,e.bbox.miny,e.bbox.maxx,e.bbox.maxy],[n.minx,n.miny,n.maxx,n.maxy]).reduce(function(e,t,n){switch(n){case 0:e.minx=t;break;case 1:e.miny=t;break;case 2:e.maxx=t;break;case 3:e.maxy=t}return e},{minxx:null,miny:null,maxx:null,maxy:null}),e.parentGroup&&!1===e.parentGroup.root&&this._setLayersTreeGroupBBox(e.parentGroup,{bbox:e.bbox,epsg:r})},t.exports=u},{"core/g3wobject":11,utils:404}],24:[function(e,t,n){var r=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var e=e("core/g3w-object"),e=(e=e)&&e.__esModule?e:{default:e};t.exports=function(e){var t=n;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);function n(){var e;if(this instanceof n)return(e=function(e,t){if(e)return!t||"object"!=typeof t&&"function"!=typeof t?e:t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this))).stores={},e.storesArray=[],e.setters={addLayersStore:function(e,t){var n=e.getId();this.stores[n]=e,null!=t?this.storesArray.splice(t,0,n):this.storesArray.push(n)},removeLayersStore:function(e){var t;e&&(t=e.getId(),this.storesArray=this.storesArray.filter(function(e){return e!=t}),delete this.stores[t])},removeLayersStores:function(){this.storesArray=[],this.stores={}}},e;throw new TypeError("Cannot call a class as a function")}return t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e),r(n,[{key:"getLayerById",value:function(t){return Object.values(this.stores).map(function(e){return e.getLayerById(t)}).find(function(e){return e})}},{key:"getLayers",value:function(t){return Object.values(this.stores).flatMap(function(e){return e.getLayers(t)})}},{key:"getQuerableLayersStores",value:function(){return this.getLayersStores().filter(function(e){return e.isQueryable()})}},{key:"getLayersStore",value:function(e){return this.stores[e]}},{key:"getLayersStores",value:function(){var t=this;return this.storesArray.map(function(e){return t.stores[e]})}}]),n}(e.default)},{"core/g3w-object":9}],25:[function(e,t,n){var r=e("utils"),i=r.inherit,a=r.base,r=e("core/layers/map/wmslayer"),o=e("g3w-ol/layers/rasters");function s(){a(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},1<arguments.length&&void 0!==arguments[1]?arguments[1]:{})}i(s,r),s.prototype._makeOlLayer=function(){var e=this,t=new o.TiledArgisMapServer({url:this.config.url,id:this.config.id,projection:this.config.projection,format:this.config.format});return t.getSource().on("imageloadstart",function(){e.emit("loadstart")}),t.getSource().on("imageloadend",function(){e.emit("loadend")}),t.getSource().on("imageloaderror",function(){e.emit("loaderror")}),t},t.exports=s},{"core/layers/map/wmslayer":29,"g3w-ol/layers/rasters":74,utils:404}],26:[function(e,t,n){var r=e("utils"),i=r.inherit,a=r.base;function o(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.setProvider(e.provider),a(this,e),this.getFeatures({url:e.url,mapProjection:this.mapProjection})}i(o,e("core/layers/map/vectorlayer")),t.exports=o},{"core/layers/map/vectorlayer":28,utils:404}],27:[function(e,t,n){var r=e("utils"),i=r.base;function a(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.config=e,this.id=e.id,this.iframe_internal=e.iframe_internal||!1,this.extent=e.extent,this.projection=e.projection,this.layer=null,this.layers=e.layers||[],this.allLayers=[],this.showSpinnerWhenLoading=!0,i(this)}(0,r.inherit)(a,e("core/g3wobject"));r=a.prototype;r.getId=function(){return this.id},r.getOLLayer=function(){},r.update=function(){this._updateLayers(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},1<arguments.length&&void 0!==arguments[1]?arguments[1]:{})},r.checkLayerDisabled=function(e,t,n){return e.setDisabled(t,n),e.isDisabled()},r.checkLayersDisabled=function(t,n){var r=this;this.allLayers.forEach(function(e){return r.checkLayerDisabled(e,t,n)})},r.setupCustomMapParamsToLegendUrl=function(){},t.exports=a},{"core/g3wobject":11,utils:404}],28:[function(e,t,n){var i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=e("services/gui"),a=(r=r)&&r.__esModule?r:{default:r},o=e("utils/createOlLayer"),s=e("utils/createLayerStyle");function l(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.mapService=a.default.getComponent("map").getService(),this.geometrytype=e.geometrytype||null,this.type=e.type||null,this.crs=e.crs||null,this.id=e.id,this.name=e.name||"",this.style=e.style,this.color=e.color,this.geometryType=e.geometryType,this.mapProjection=this.mapService.getProjection().getCode(),this.projection=e.projection||this.mapProjection,this.url=e.url,this.provider=e.provider,this._features=e.features||[],this._olLayer=e.olLayer||this.getOLLayer()}(0,e("utils").inherit)(l,e("core/g3wobject"));r=l.prototype;r.setProvider=function(e){this._provider=e},r.getProvider=function(){return this._provider},r.resetSource=function(){var e=new ol.source.Vector({features:0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]});this.setSource(e)},r._makeOlLayer=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).style;this._olLayer=new ol.layer.Vector({name:this.name,id:this.id,style:this._makeStyle(e),source:new ol.source.Vector({})})},r._makeStyle=function(e){var t=void 0,r={};return e&&(Object.entries(e).forEach(function(e){var e=i(e,2),t=e[0],n=e[1];switch(t){case"point":n.icon&&(r.image=new ol.style.Icon({src:n.icon.url,imageSize:n.icon.width}));break;case"line":r.stroke=new ol.style.Stroke({color:n.color,width:n.width});break;case"polygon":r.fill=new ol.style.Fill({color:n.color})}}),t=new ol.style.Style(r)),t},r.getFeatures=function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=$.Deferred();return this.provider.getFeatures(e).then(function(e){t.addFeatures(e),n.resolve(e)}).fail(function(e){return n.reject(e)}),n.promise()},r.addFeatures=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];this.getSource().addFeatures(e)},r.addFeature=function(e){e&&this.getSource().addFeature(e)},r.getOLLayer=function(){var e,t,n,r;return this._olLayer||(e=this.id,t=this.geometryType,n=this.color,r=this.style?(0,s.createLayerStyle)(this.style):null,this._olLayer=(0,o.createOlLayer)({id:e,geometryType:t,color:n,style:r,features:this._features})),this._olLayer},r.setOLLayer=function(e){this._olLayer=e},r.getSource=function(){return this._olLayer||this.getOLLayer(),this._olLayer.getSource()},r.setSource=function(e){this._olLayer.setSource(e)},r.setStyle=function(e){this._olLayer.setStyle(e)},r.getFeatureById=function(e){return e?this._olLayer.getSource().getFeatureById(e):null},r.isVisible=function(){return this._olLayer.getVisible()},r.setVisible=function(e){this._olLayer.setVisible(e)},r.clear=function(){this.getSource().clear()},r.addToMap=function(e){e.addLayer(this._olLayer)},t.exports=l},{"core/g3wobject":11,"services/gui":302,utils:404,"utils/createLayerStyle":347,"utils/createOlLayer":350}],29:[function(e,t,n){var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},r=e("store/application-state"),l=(r=r)&&r.__esModule?r:{default:r},u=e("utils/get_legend_params");var r=e("utils"),i=r.base,r=r.inherit,a=e("core/layers/map/maplayer"),o=e("g3w-ol/layers/rasters");function c(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"GET";this.LAYERTYPE={LAYER:"layer",MULTILAYER:"multilayer"},this.extraParams=t,this._method=n,i(this,e)}r(c,a);e=c.prototype;e.getOLLayer=function(e){return this._olLayer||(this._olLayer=this._makeOlLayer(e)),this._olLayer},e.getSource=function(){return this.getOLLayer().getSource()},e.getInfoFormat=function(){return"application/vnd.ogc.gml"},e.getGetFeatureInfoUrl=function(e,t,n,r){return this.getOLLayer().getSource().getGetFeatureInfoUrl(e,t,n,r)},e.getLayerConfigs=function(){return this.layers},e.addLayer=function(t){this.allLayers.find(function(e){return e===t})||this.allLayers.push(t),this.layers.find(function(e){return e===t})||this.layers.push(t)},e.removeLayer=function(t){this.layers=this.layers.filter(function(e){return e!==t})},e.isVisible=function(){return 0<this._getVisibleLayers().length},e.getQueryUrl=function(){return this.layers[0].infourl&&""!==this.layers[0].infourl?this.layers[0].infourl:this.config.url},e.getQueryableLayers=function(){return this.layers.filter(function(e){return e.isQueryable()})},e._getVisibleLayers=function(){return this.layers.filter(function(e){return e.isVisible()})},e._makeOlLayer=function(e){var t=this,e=new o.WMSLayer({url:this.layers[0]&&this.layers[0].getWmsUrl?this.layers[0].getWmsUrl():this.config.url,id:this.config.id,projection:this.config.projection,iframe_internal:this.iframe_internal,layers:e?this.layers.map(function(e){return e.getWMSLayerName()}):this.layers,format:this.config.format},this.extraParams,this._method);return e.getSource().on("imageloadstart",function(){return t.emit("loadstart")}),e.getSource().on("imageloadend",function(){return t.emit("loadend")}),e.getSource().on("imageloaderror",function(){return t.emit("loaderror")}),e},e._updateLayers=function(){var r,i,a,o,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.force,n=void 0!==n&&n,t=function(e,t){var n,r={};for(n in e)0<=t.indexOf(n)||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(t,["force"]),n=(n||this.checkLayersDisabled(e.resolution,e.mapUnits),this._getVisibleLayers(e)||[]);n.length<=0?this._olLayer.setVisible(!1):(r=[],i=[],o=a=void 0,n.forEach(function(e){var t=(0,u.get_legend_params)(e),n=t.LEGEND_ON,t=t.LEGEND_OFF;r.push(e.getStyle()),i.push(parseInt(e.getOpacity()/100*255)),n&&(a=void 0===a?n:a+";"+n),t&&(o=void 0===o?t:o+";"+t)}),this._olLayer.setVisible(!0),this._olLayer.getSource().updateParams&&this._olLayer.getSource().updateParams(s({},t,{LEGEND_ON:a,LEGEND_OFF:o,filtertoken:l.default.tokens.filtertoken,LAYERS:(n[0].isArcgisMapserver()?"show:":"")+n.map(function(e){return e.getWMSLayerName()}).join(","),STYLES:r.join(","),OPACITIES:i.join(",")})))},e.setupCustomMapParamsToLegendUrl=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};[].concat(this.layer||this.layers).forEach(function(e){return e.setMapParamstoLegendUrl(t)})},t.exports=c},{"core/layers/map/maplayer":27,"g3w-ol/layers/rasters":74,"store/application-state":310,utils:404,"utils/get_legend_params":399}],30:[function(e,t,n){var r=e("utils"),i=r.base,r=r.inherit,a=e("core/layers/map/wmslayer"),o=e("g3w-ol/layers/rasters");function s(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"GET";this.LAYERTYPE={LAYER:"layer",MULTILAYER:"multilayer"},this.extraParams=t,this._method=n,i(this,e)}r(s,a),s.prototype._makeOlLayer=function(e){var t=this,e=new o.TiledWMSLayer({url:"mapproxy"!==this.config.cache_provider&&this.layers[0]&&this.layers[0].getWmsUrl?this.layers[0].getWmsUrl():this.config.url,id:this.config.id,projection:this.config.projection,iframe_internal:this.iframe_internal,layers:e?this.layers.map(function(e){return e.getWMSLayerName()}):this.layers,cache_provider:this.config.cache_provider,cache_type:this.config.cache_type,cache_layer:this.config.cache_layer,cache_extent:this.config.cache_extent,cache_grid:this.config.cache_grid,cache_grid_extent:this.config.cache_grid_extent},this.extraParams,this._method);return e.getSource().on("tileloadstart",function(){return t.emit("loadstart")}),e.getSource().on("tileloadend",function(){return t.emit("loadend")}),e.getSource().on("tileloaderror",function(){return t.emit("loaderror")}),e},t.exports=s},{"core/layers/map/wmslayer":29,"g3w-ol/layers/rasters":74,utils:404}],31:[function(e,t,n){var r=e("utils"),i=r.inherit,a=r.base,r=e("core/layers/map/maplayer"),o=e("g3w-ol/layers/rasters");function s(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"GET";a(this,e),this._method=t}i(s,r);e=s.prototype;e.getOLLayer=function(){return this._olLayer||(this._olLayer=this._makeOlLayer()),this._olLayer},e.getSource=function(){return this.getOLLayer().getSource()},e.getLayerConfigs=function(){return this.layer},e.addLayer=function(e){this.layer=e,this.layers.push(e),this.allLayers.push(e)},e.update=function(e,t){this._updateLayer(e,t)},e.isVisible=function(){return layer.state.visible},e._makeOlLayer=function(){var e=this;return this._olLayer=new o.XYZLayer({url:this.config.url,maxZoom:20,extent:this.config.extent,iframe_internal:this.iframe_internal,projection:this.projection||this.layer.getProjection(),cache_provider:this.config.cache_provider},this._method),this._olLayer.getSource().on("imageloadstart",function(){return e.emit("loadstart")}),this._olLayer.getSource().on("imageloadend",function(){return e.emit("loadend")}),this._olLayer.getSource().on("imageloaderror",function(){return e.emit("loaderror")}),this._olLayer},e._updateLayer=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).force;void 0!==t&&t||this.checkLayersDisabled(e.resolution,e.mapUnits),this._olLayer.setVisible(this.layer.isVisible())},t.exports=s},{"core/layers/map/maplayer":27,"g3w-ol/layers/rasters":74,utils:404}],32:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("app/constant"),i=e("utils").XHR;n.default={getDownloadFilefromDownloadDataType:function(e,t){var n=t.data,r=void 0===n?{}:n,i=t.options;switch(r.filtertoken=this.getFilterToken(),e){case"shapefile":return this.getShp({data:r,options:i});case"xls":return this.getXls({data:r,options:i});case"csv":return this.getCsv({data:r,options:i});case"gpx":return this.getGpx({data:r,options:i});case"gpkg":return this.getGpkg({data:r,options:i});case"geotiff":return this.getGeoTIFF({data:r,options:i})}},getGeoTIFF:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).data,e=void 0===e?{}:e;return e.filtertoken=this.getFilterToken(),i.fileDownload({url:this.getUrl("geotiff"),data:e,httpMethod:"POST"})},getXls:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).data,e=void 0===e?{}:e;return e.filtertoken=this.getFilterToken(),i.fileDownload({url:this.getUrl("xls"),data:e,httpMethod:"POST"})},getShp:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).data,e=void 0===e?{}:e;return e.filtertoken=this.getFilterToken(),i.fileDownload({url:this.getUrl("shp"),data:e,httpMethod:"POST"})},getGpx:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).data,e=void 0===e?{}:e;return e.filtertoken=this.getFilterToken(),i.fileDownload({url:this.getUrl("gpx"),data:e,httpMethod:"POST"})},getGpkg:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).data,e=void 0===e?{}:e;return e.filtertoken=this.getFilterToken(),i.fileDownload({url:this.getUrl("gpkg"),data:e,httpMethod:"POST"})},getCsv:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).data,e=void 0===e?{}:e;return e.filtertoken=this.getFilterToken(),i.fileDownload({url:this.getUrl("csv"),data:e,httpMethod:"POST"})},isDownloadable:function(){return this.isShpDownlodable()||this.isXlsDownlodable()||this.isGpxDownlodable()||this.isGpkgDownlodable()||this.isCsvDownlodable()},getDownloadableFormats:function(){var t=this;return Object.keys(r.DOWNLOAD_FORMATS).filter(function(e){return t.config[e]}).map(function(e){return r.DOWNLOAD_FORMATS[e].format})},getDownloadUrl:function(t){var e=Object.values(r.DOWNLOAD_FORMATS).find(function(e){return e.format===t});return e&&e.url},isGeoTIFFDownlodable:function(){return!this.isBaseLayer()&&this.config.download&&"gdal"===this.config.source.type},isShpDownlodable:function(){return!this.isBaseLayer()&&this.config.download&&"gdal"!==this.config.source.type},isXlsDownlodable:function(){return!this.isBaseLayer()&&this.config.download_xls},isGpxDownlodable:function(){return!this.isBaseLayer()&&this.config.download_gpx},isGpkgDownlodable:function(){return!this.isBaseLayer()&&this.config.download_gpkg},isCsvDownlodable:function(){return!this.isBaseLayer()&&this.config.download_csv}}},{"app/constant":5,utils:404}],33:[function(e,t,n){var i=s(e("services/gui")),r=s(e("services/application")),a=e("utils/createFeatureFromFeatureObject"),o=e("utils/getScaleFromResolution");function s(e){return e&&e.__esModule?e:{default:e}}var l=e("g3w-ol/projection/projections"),e=e("utils"),u=e.XHR,c=e.sanitizeUrl,d={wms:["VERSION","REQUEST","BBOX","LAYERS","WIDTH","HEIGHT","DPI","FORMAT","CRS"]};function p(){}e=p.prototype;e.setup=function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.config&&(e=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).project,this.config.map_crs=e.getProjection().getCode(),this.config.multilayerid=t.multilayer,this.legendCategories={},this.olSelectionFeatures={},_.extend(this.state,{geolayer:"NoGeometry"!==t.geometrytype,legend:{url:null,loading:!1,error:!1,show:!0,change:!1},external:t.source&&t.source.external||!1,bbox:t.bbox||null,visible:t.visible||!1,checked:t.visible||!1,epsg:t.crs.epsg,hidden:t.hidden||!1,scalebasedvisibility:t.scalebasedvisibility||!1,minscale:t.minscale,maxscale:t.maxscale,ows_method:t.ows_method,exclude_from_legend:"boolean"!=typeof t.exclude_from_legend||t.exclude_from_legend,categories:!1,expanded:t.expanded,opacity:t.opacity||100}),t.projection&&(this.config.projection=t.projection.getCode()===t.crs.epsg?t.projection:l.get(t.crs)),t.attributions&&(this.config.attributions=t.attributions),t.source)&&t.source.url&&this._sanitizeSourceUrl()},e.getLegendGraphic=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).all,e=void 0===e||e,t=r.default.getConfig().layout?r.default.getConfig().layout.legend:{},t=this.getLegendUrl(t,{categories:!0,all:e,format:"application/json"});return u.get({url:t})},e.setCategories=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];this.legendCategories[this.getCurrentStyle().name]=e,this.state.categories=0<e.length&&0<e.filter(function(e){return e.ruleKey}).length},e.getCategories=function(){return this.legendCategories[this.getCurrentStyle().name]},e.clearCategories=function(){this.legendCategories={},this.state.categories=!1},e.clearOlSelectionFeatures=function(){this.olSelectionFeatures=null},e.getOlSelectionFeature=function(e){return this.olSelectionFeatures[e]},e.updateOlSelectionFeature=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,e=e.feature,t=this.getOlSelectionFeature(t);t&&(t.feature=e,i.default.getService("map").setSelectionFeatures("update",{feature:e}))},e.deleteOlSelectionFeature=function(e){var t=this.getOlSelectionFeature(e);t&&(mapService.setSelectionFeatures("remove",{feature:t.feature}),delete this.olSelectionFeatures[e])},e.getOlSelectionFeatures=function(){return this.olSelectionFeatures},e.addOlSelectionFeature=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,e=e.feature;return this.olSelectionFeatures[t]=this.olSelectionFeatures[t]||{feature:(0,a.createFeatureFromFeatureObject)({id:t,feature:e}),added:!1},this.olSelectionFeatures[t]},e.hideOlSelectionFeatures=function(){i.default.getService("map").setSelectionLayerVisible(!1)},e.showAllOlSelectionFeatures=function(){var t=i.default.getService("map");Object.values(this.olSelectionFeatures).forEach(function(e){e.added&&t.setSelectionFeatures("add",{feature:e.feature})}),t.setSelectionLayerVisible(!0)},e.setInversionOlSelectionFeatures=function(){var t=i.default.getService("map");Object.values(this.olSelectionFeatures).forEach(function(e){e.added=!e.added,t.setSelectionFeatures(e.added?"add":"remove",{feature:e.feature})})},e.setOlSelectionFeatureByFid=function(e,t){var n=this.getOlSelectionFeature(e);if(n&&n.feature)return this.setOlSelectionFeatures({id:e,feature:n.feature},t)},e.setOlSelectionFeatures=function(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"add",r=i.default.getService("map");return e&&((t=this.getOlSelectionFeature(e.id)||this.addOlSelectionFeature(e)).feature.__layerId="add"!==n||t.added?void 0:this.getId(),r.setSelectionFeatures(n,{feature:t.feature}),t.added="add"===n&&!t.added),e||Object.values(this.olSelectionFeatures).forEach(function(e){e.added&&r.setSelectionFeatures("remove",{feature:e.feature}),e.added=!1}),void 0===Object.values(this.olSelectionFeatures).find(function(e){return e.added})},e._sanitizeSourceUrl=function(){this.config.source.url=c({url:this.config.source.url,reserverParameters:d[0<arguments.length&&void 0!==arguments[0]?arguments[0]:"wms"]})},e.isLayerCheckedAndAllParents=function(){var e=this.isChecked();if(e)for(var t=this.state.parentGroup;e&&t;)e=e&&t.checked,t=t.parentGroup;return e},e.setChecked=function(e){this.state.checked=e},e.isChecked=function(){return this.state.checked},e.setVisible=function(e){var t=this.state.visible;return this.state.visible=e&&this.isChecked(),t!==this.state.visible&&this.change(),this.state.visible},e.isVisible=function(){return this.state.visible},e.isDisabled=function(){return this.state.disabled},e.isPrintable=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).scale;return this.isLayerCheckedAndAllParents()&&(!this.state.scalebasedvisibility||e>=this.state.maxscale&&e<=this.state.minscale)},e.getStyles=function(){return(this.config.source.external?this.config.source:this.config).styles},e.getStyle=function(){return this.config.source.external?this.config.source.styles:this.config.styles?this.config.styles.find(function(e){return e.current}).name:""},e.getOpacity=function(){return this.state.opacity},e.setCurrentStyle=function(t){var n=!1;return this.config.styles.forEach(function(e){e.name===t&&(n=!e.current),e.current=e.name===t}),n},e.getCurrentStyle=function(){return this.config.styles.find(function(e){return e.current})},e.setDisabled=function(e){if(this.state.scalebasedvisibility){for(var t=(0,o.getScaleFromResolution)(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:"m"),n=(this.state.disabled=!(t>=this.state.maxscale&&t<=this.state.minscale),this.state.disabled=0===this.state.minscale?!(t>=this.state.maxscale):this.state.disabled,!0),r=this.state.parentGroup;r;)n=n&&r.checked,r=r.parentGroup;n&&this.setVisible(!this.state.disabled),this.isFilterable()&&this.setTocHighlightable(!this.state.disabled)}else this.state.disabled=!1},e.getMultiLayerId=function(){return this.config.multilayerid},e.getGeometryType=function(){return this.config.geometrytype},e.getOwsMethod=function(){return this.config.ows_method},e.setProjection=function(){this.config.projection=l.get(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},e.getProjection=function(){return this.config.projection},e.getEpsg=function(){return this.config.crs.epsg},e.getCrs=function(){return this.config.projection&&this.config.projection.getCode()||null},e.getMapCrs=function(){return this.config.map_crs},e.isCached=function(){return this.config.cache_url&&""!==this.config.cache_url},e.getCacheUrl=function(){return this.isCached()&&this.config.cache_provider&&"mapproxy"===this.config.cache_provider?this.config.cache_url:this.isCached()?this.config.cache_url+"/{z}/{x}/{y}.png":void 0},e.hasAxisInverted=function(){var e=this.getProjection();return"ne"===(e.getAxisOrientation?e.getAxisOrientation():"enu").substr(0,2)},e.getMapLayer=function(){},e.setMapProjection=function(e){this._mapProjection=e},e.getMapProjection=function(){return this._mapProjection},t.exports=p},{"g3w-ol/projection/projections":76,"services/application":298,"services/gui":302,utils:404,"utils/createFeatureFromFeatureObject":341,"utils/getScaleFromResolution":395}],34:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var s=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=e("core/relations/relation");n.default={getRelations:function(){return this._relations},getRelationById:function(t){return this._relations.getArray().find(function(e){return e.getId()===t})},getRelationAttributes:function(t){var e=this._relations.find(function(e){return e.name===t});return e?e.fields:[]},getRelationsAttributes:function(){return(this.state.relations||[]).reduce(function(e,t){return e[t.name]=t.fields,e},{})},isChild:function(){return!!this.getRelations()&&this._relations.isChild(this.getId())},isFather:function(){return!!this.getRelations()&&this._relations.isFather(this.getId())},getChildren:function(){return this.isFather()?this._relations.getChildren(this.getId()):[]},getFathers:function(){return this.isChild()?this._relations.getFathers(this.getId()):[]},hasChildren:function(){return!!this.hasRelations()&&this._relations.hasChildren(this.getId())},hasFathers:function(){return!!this.hasRelations()&&this._relations.hasFathers(this.getId())},hasRelations:function(){return!!this._relations},_createRelations:function(e){var t=this.getId(),e=e.filter(function(e){return-1!==[e.referencedLayer,e.referencingLayer].indexOf(t)}),e={_relations:(e||[]).reduce(function(e,t){t=new r(t);return e[t.getId()]=t,e},{}),_length:e?e.length:0,_createRelationsInfo:function(){this._relationsInfo||this._clearRelationsInfo();var n,r,e=this._relationsInfo,i=e.father_child,a=e.fathers,o=e.children;Object.entries(this._relations).forEach(function(e){var e=s(e,2),t=e[0],e=e[1];n=e.getFather(),r=e.getChild(),i[n+r]=t,a[n]=a[n]||[],o[r]=o[r]||[],a[n].push(r),o[r].push(n)})},_clearRelationsInfo:function(){this._relationsInfo={children:{},fathers:{},father_child:{}}},_reloadRelationsInfo:function(){this._clearRelationsInfo(),this._createRelationsInfo()},getLength:function(){return this._length},getRelations:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).type,t=void 0===e?null:e;if(!t)return this._relations;if(-1===["ONE","MANY"].indexOf(t))return{};var n,r={};for(n in this._relations)t===this._relations[n].getType()&&(r[n]=this._relations[n]);return r},getArray:function(){return Object.entries(this._relations).map(function(e){return e[1]})},setRelations:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];this._relations=Array.isArray(e)?e:[]},getRelationById:function(e){return this._relations[e]},getRelationByFatherChildren:function(e,t){return this.getRelationById(this._relationsInfo.father_child[e+t])},addRelation:function(e){e instanceof r&&(this._relations[e.getId()]=e,this._reloadRelationsInfo())},removeRelation:function(e){e instanceof r&&(delete this._relations[e.getId()],this._reloadRelationsInfo())},hasChildren:function(e){e=this.getChildren(e);return e&&0<e.length},hasFathers:function(e){e=this.getFathers(e);return e&&0<e.length},getChildren:function(e){return this.isFather(e)?this._relationsInfo.fathers[e]:null},getFathers:function(e){return this.isChild(e)?this._relationsInfo.children[e]:null},isChild:function(e){return!!this._relationsInfo.children[e]},isFather:function(e){return!!this._relationsInfo.fathers[e]}};return e._reloadRelationsInfo(),e}}},{"core/relations/relation":45}],35:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SELECTION=void 0;var r=o(e("services/application")),i=o(e("services/gui")),a=e("utils/prompt");function o(e){return e&&e.__esModule?e:{default:e}}function s(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var l,u,c,d,p,f,h,g,v,m,y,_=e("core/i18n/i18n.service").t,b=n.SELECTION={ALL:"__ALL__",EXCLUDE:"__EXCLUDE__"};n.default={isSelected:function(){return this.state.selected},setSelected:function(e){this.state.selected=e},setSelection:(y=s(function*(){var e,t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];(this.state.selection.active=t)||(t=this.state.filter.active,(e=null!==this.state.filter.current)&&t&&(yield this._applyFilterToken(this.state.filter.current)),!e&&t&&(yield this.deleteFilterToken()),this.emit("unselectionall",this.getId()))}),function(){return y.apply(this,arguments)}),isSelectionActive:function(){return this.state.selection.active},getSelection:function(){return this.state.selection},getFilter:function(){return this.state.filter},setFilter:function(){this.state.filter.active=0<arguments.length&&void 0!==arguments[0]&&arguments[0]},getCurrentFilter:function(){return this.state.filter.current},getFilterActive:function(){return this.state.filter.active},getFilters:function(){return this.state.filters},addFilter:function(){this.state.filters.push(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},removefilter:function(t){this.state.filters=this.state.filters.filter(function(e){return t===e.fid})},setCurrentFilter:function(e){this.state.filter.current=e},applyFilter:(m=s(function*(e){this.providers.filtertoken&&(null!==this.state.filter.current&&e.fid===this.state.filter.current.fid||(yield this.clearSelectionFids(),i.default.closeContent()),yield this._applyFilterToken(e))}),function(e){return m.apply(this,arguments)}),_applyFilterToken:(v=s(function*(e){var t=(yield this.providers.filtertoken.applyFilterToken(e.fid)).filtertoken;t&&(this.setFilter(!1),this.setCurrentFilter(e),this.setFilterToken(t))}),function(e){return v.apply(this,arguments)}),saveFilter:function(){var n,t;!this.providers.filtertoken||0<!this.selectionFids.size||(n=this,(0,a.prompt)({label:_("layer_selection_filter.tools.savefilter"),value:n.getCurrentFilter()?n.getCurrentFilter().name:"",callback:(t=s(function*(e){var t=yield n.providers.filtertoken.saveFilterToken(e);t&&(void 0===(e=n.state.filters.find(function(e){return e.fid===t.fid}))&&(e={fid:t.fid,name:t.name},n.state.filters.push(e)),n.setCurrentFilter(e),n.setFilter(!1),n.getSelection().active=!1,n.selectionFids.clear(),n.isGeoLayer()&&n.setOlSelectionFeatures(),n.emit("unselectionall",n.getId()))}),function(e){return t.apply(this,arguments)})}))},toggleFilterToken:(g=s(function*(){this.setFilter(!this.state.filter.active);var e=this.state.filter.current,t=this.state.filter.active,e=(t&&(yield this.createFilterToken()),e&&!t&&(yield this.applyFilter(this.state.filter.current)),e||t||(yield this.deleteFilterToken()),this.state.selection.active&&this.isGeoLayer());return e&&this.state.filter.active&&this.hideOlSelectionFeatures(),e&&!this.state.filter.active&&this.showAllOlSelectionFeatures(),this.state.filter.active}),function(){return g.apply(this,arguments)}),deleteFilterToken:(h=s(function*(t){try{var e;this.providers.filtertoken&&(e=yield this.providers.filtertoken.deleteFilterToken(t),void 0!==t&&(this.state.filters=this.state.filters.filter(function(e){return t!==e.fid})),this.setCurrentFilter(null),this.setFilter(!1),this.setFilterToken(e))}catch(e){}}),function(e){return h.apply(this,arguments)}),setFilterToken:function(){r.default.setFilterToken(0<arguments.length&&void 0!==arguments[0]?arguments[0]:null),this.emit("filtertokenchange",{layerId:this.getId()})},createFilterToken:(f=s(function*(){try{var e,t=this.providers.filtertoken,n=this.selectionFids;!t||0<!n.size||(n.has(b.ALL)?(yield t.deleteFilterToken(),this.setFilterToken(null)):(e=Array.from(n),n.has(b.EXCLUDE)?this.setFilterToken(yield t.getFilterToken({fidsout:e.filter(function(e){return e!==b.EXCLUDE}).join(",")})):this.setFilterToken(yield t.getFilterToken({fidsin:e.join(",")}))))}catch(e){}}),function(){return f.apply(this,arguments)}),getFilterToken:function(){return r.default.getFilterToken()},setSelectionFidsAll:function(){this.selectionFids.clear(),this.selectionFids.add(b.ALL),this.isGeoLayer()&&this.showAllOlSelectionFeatures(),this.setSelection(!0),this.state.filter.active&&this.createFilterToken()},getSelectionFids:function(){return this.selectionFids},invertSelectionFids:function(){var e=this.selectionFids;e.has(b.EXCLUDE)?e.delete(b.EXCLUDE):e.has(b.ALL)?e.delete(b.ALL):0<e.size&&e.add(b.EXCLUDE),this.isGeoLayer()&&this.setInversionOlSelectionFeatures(),this.state.filter.active&&this.createFilterToken(),this.setSelection(0<e.size)},hasSelectionFid:function(e){var t=this.selectionFids;return!!t.has(b.ALL)||(t.has(b.EXCLUDE)?!t.has(e):t.has(e))},includeSelectionFid:(p=s(function*(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=this.selectionFids,r=n.has(b.EXCLUDE)&&n.has(e);r&&n.delete(e),r&&1===n.size&&this.setSelectionFidsAll(),r||n.add(e),r||this.isSelectionActive()||this.setSelection(!0),this.isGeoLayer()&&this.setOlSelectionFeatureByFid(e,"add"),t&&this.state.filter.active&&(yield this.createFilterToken())}),function(e){return p.apply(this,arguments)}),excludeSelectionFid:(d=s(function*(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=this.selectionFids,r=(!n.has(b.ALL)&&0!==n.size||(n.clear(),n.add(b.EXCLUDE)),n.has(b.EXCLUDE)?n.add(e):n.delete(e),1===n.size&&n.has(b.EXCLUDE)&&this.setselectionFidsAll(),this.isGeoLayer()&&this.setOlSelectionFeatureByFid(e,"remove"));t&&this.state.filter.active&&(yield this.createFilterToken()),0!==n.size&&!r||(n.clear(),this.setSelection(!1))}),function(e){return d.apply(this,arguments)}),includeSelectionFids:(c=s(function*(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];e.forEach(function(e){return t.includeSelectionFid(e,!1)}),n&&this.state.filter.active&&(yield this.createFilterToken())}),function(){return c.apply(this,arguments)}),excludeSelectionFids:(u=s(function*(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];e.forEach(function(e){return t.excludeSelectionFid(e,!1)}),n&&this.state.filter.active&&(yield this.createFilterToken())}),function(){return u.apply(this,arguments)}),clearSelectionFids:(l=s(function*(){this.selectionFids.clear(),this.isGeoLayer()&&this.setOlSelectionFeatures(),yield this.setSelection(!1)}),function(){return l.apply(this,arguments)})}},{"core/i18n/i18n.service":12,"services/application":298,"services/gui":302,"utils/prompt":429}],36:[function(e,t,A){var c=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},n=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e};function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=l(e("core/g3wobject")),d=l(e("store/application-state")),s=l(e("services/relations")),p=e("app/constant"),a=e("core/layers/utils/QgsFilterToken"),f=e("utils/handleQueryResponse"),o=e("utils/getDPI"),h=e("utils/getExtentForViewAndSize"),g=e("utils/get_legend_params"),v=e("utils/XHR"),m=e("utils/appendParams"),y=e("utils/getTimeoutPromise");function l(e){return e&&e.__esModule?e:{default:e}}function u(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){if(e)return!t||"object"!=typeof t&&"function"!=typeof t?e:t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}function w(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function x(e){return void 0!==e}var S,L=e("utils/parsers"),C=e("core/i18n/i18n.service").t,E=e("core/layers/features/feature"),T=e("core/layers/filter/filter"),k=[101,101],M=(0,o.getDPI)(),e=(w(P,i.default),n(P,[{key:"getLayer",value:function(){return this._layer}},{key:"setLayer",value:function(e){this._layer=e}},{key:"getFeatures",value:function(){}},{key:"query",value:function(){}},{key:"setReady",value:function(e){this._isReady=e}},{key:"isReady",value:function(){return this._isReady}},{key:"error",value:function(){}},{key:"isValid",value:function(){}},{key:"getName",value:function(){return this._name}}]),P);function P(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(_(this,P),b(this,(P.__proto__||Object.getPrototypeOf(P)).call(this)));return t._isReady=!1,t._name="provider",t._layer=e.layer,t._hasFieldsStartWithNotPermittedKey=void 0,t}function O(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=(_(this,O),b(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,e)));return e._name="wfs",e}function F(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=(_(this,F),b(this,(F.__proto__||Object.getPrototypeOf(F)).call(this,e)));return e._name="wms",e}function I(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(_(this,I),b(this,(I.__proto__||Object.getPrototypeOf(I)).call(this)));return t._name="qgis",t._layer=e.layer||{},t._projections={map:null,layer:null},t._queryUrl=t._layer.getUrl("query"),t._filtertokenUrl=t._layer.getUrl("filtertoken"),t._layerName=t._layer.getName()||null,t._infoFormat=t._layer.getInfoFormat()||"application/vnd.ogc.gml",t.saveFilterToken=a.QgsFilterToken.save.bind(null,t._filtertokenUrl),t.applyFilterToken=a.QgsFilterToken.apply.bind(null,t._filtertokenUrl),t.deleteFilterToken=a.QgsFilterToken.delete.bind(null,t._filtertokenUrl),t.getFilterToken=a.QgsFilterToken.getToken.bind(null,t._filtertokenUrl),t}function j(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(_(this,j),b(this,(j.__proto__||Object.getPrototypeOf(j)).call(this,e)));return t._name="geojson",t.provider=e.provider,t}t.exports={geojson:(w(j,e),n(j,[{key:"query",value:function(){var e=$.Deferred();return e.resolve([]),e.promise()}},{key:"getFeatures",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=$.Deferred(),n=new ol.format.GeoJSON,r={featureProjection:e.mapProjection,dataProjection:e.projection||"EPSG:4326"};return e.data?t.resolve(n.readFeatures(e.data,r)):v.XHR.get({url:e.url||this.getLayer().get("source").url}).then(function(e){return t.resolve(n.readFeatures(e.results,r))}).catch(function(e){t.reject(e)}),t.promise()}},{key:"getDataTable",value:function(){var e=this,t=((0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).page,$.Deferred());return this.getFeatures().then(function(){return t.resolve(e._features)}).fail(function(e){t.reject(e)}),t.promise()}},{key:"digestFeaturesForTable",value:function(){return{headers:[],features:[]}}}]),j),qgis:(w(I,e),n(I,[{key:"getFilterData",value:(S=u(function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.field,n=e.raw,n=void 0!==n&&n,r=e.suggest,i=e.unique,a=e.formatter,o=e.queryUrl,s=e.ordering,l=e.fformatter,r={field:t,suggest:r,ordering:s,formatter:void 0===a?1:a,unique:i,fformatter:l,ffield:e.ffield,filtertoken:d.default.tokens.filtertoken};try{var u=o||this._layer.getUrl("data"),c=t?yield v.XHR.post({url:u,contentType:"application/json",data:JSON.stringify(r)}):yield v.XHR.get({url:u,params:r});if("table"!==this._layer.getType()&&this.setProjections(),n)return c;if(i&&c.result)return c.data;if(l&&c.result)return c;if(c.result)return{data:L.response.get("application/json")({layers:[this._layer],response:c.vector.data,projections:this._projections})}}catch(e){return Promise.reject(e)}return Promise.reject()}),function(){return S.apply(this,arguments)})},{key:"setProjections",value:function(){this._projections.map=this._layer.getMapProjection()||this._projections.layer}},{key:"query",value:function(){var t=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred(),e="table"===this._layer.getType(),i=(e||this.setProjections(),n.layers?n.layers.map(function(e){return e.getWMSLayerName()}).join(","):this._layer.getWMSLayerName()),a=n.filter,a=void 0===a?null:a;return(a=a&&Array.isArray(a)?a:[a])&&"geometry"!==a[0].getType()&&(this._projections.layer=null),a?(a=a.map(function(e){return e.get()}).filter(function(e){return e}),v.XHR.get({url:n.queryUrl||this._queryUrl,params:{SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetFeatureInfo",filtertoken:d.default.tokens.filtertoken,LAYERS:i,QUERY_LAYERS:i,INFO_FORMAT:this._infoFormat,FEATURE_COUNT:n.feature_count||10,CRS:e?d.default.map.epsg:this._projections.map.getCode(),I:n.I,J:n.J,FILTER:a.length?a.join(";"):void 0,WITH_GEOMETRY:!e}}).then(function(e){n.raw?r.resolve(e):r.resolve((0,f.handleQueryResponse)({response:e,projections:t._projections,layers:void 0!==n.layers?n.layers:[t._layer],wms:!0}))}).catch(function(e){r.reject(e)})):r.reject(),r.promise()}},{key:"getConfig",value:function(){var t=$.Deferred(),e=this._layer.getUrl("config");return e?v.XHR.get({url:e}).then(function(e){return t.resolve(e)}).catch(function(e){t.reject(e)}):t.reject("not valid url"),t.promise()}},{key:"getWidgetData",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return $.get(this._layer.getUrl("widget")[e.type],{fields:e.fields})}},{key:"unlock",value:function(){var t=$.Deferred();return v.XHR.post({url:this._layer.getUrl("unlock")}).then(function(e){return t.resolve(e)}).catch(function(e){t.reject(e)}),t.promise()}},{key:"commit",value:function(e){var t=$.Deferred();return v.XHR.post({url:this._layer.getUrl("commit"),data:JSON.stringify(e),contentType:"application/json"}).then(function(e){return t.resolve(e)}).catch(function(e){t.reject(e)}),t.promise()}},{key:"getFeatures",value:function(){var e,t,a=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=$.Deferred(),i=(Object.entries(r).forEach(function(e){var e=c(e,2),t=e[0],e=e[1];[null,void 0].includes(e)&&delete r[t]}),$.param(r));return n.editing?(e=t=void 0,(t=this._layer.getUrl("editing"))?(t+=i?"?"+i:"",(n=n.filter||null)?x(n.bbox)?e=v.XHR.post({url:t,data:JSON.stringify({in_bbox:n.bbox.join(","),filtertoken:d.default.tokens.filtertoken}),contentType:"application/json"}):x(n.fid)?e=s.default.getRelations(n.fid):n.field?e=v.XHR.post({url:t,data:JSON.stringify(n),contentType:"application/json"}):x(n.fids)?e=v.XHR.get({url:t,params:n}):x(n.nofeatures)&&(e=v.XHR.post({url:t,data:JSON.stringify({field:(n.nofeatures_field||"id")+"|eq|__G3W__NO_FEATURES__"}),contentType:"application/json"})):e=v.XHR.post({url:t,contentType:"application/json"}),e.then(function(e){var t,n,r=e.vector,i=e.result,e=e.featurelocks;!1===i?o.reject({message:C("info.server_error")}):(t=[],n=e.map(function(e){return e.featureid}),L[a._layer.getType()].get({type:"json"})(r.data,"NoGeometry"===r.geometrytype?{}:{crs:a._layer.getCrs()}).forEach(function(e){-1<n.indexOf(""+e.getId())&&t.push(new E({feature:e}))}),o.resolve({count:r.count,features:t,featurelocks:e}))}).catch(function(e){o.reject({message:C("info.server_error")})}),o.promise()):void o.reject("Url not valid")):(v.XHR.get({url:this._layer.getUrl("data")+(i?"?"+i:"")}).then(function(e){e=e.vector;return o.resolve({data:e.data,count:e.count})}).catch(function(e){o.reject(e)}),o.promise())}}]),I),wms:(w(F,e),n(F,[{key:"query",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=$.Deferred(),n=this._layer.getMapProjection()||this._layer.getProjection(),r=e.layers,i=void 0===r?[this._layer]:r,r=e.size,r=void 0===r?k:r,a=e.coordinates,o=void 0===a?[]:a,s=e.resolution,a=(0,h.getExtentForViewAndSize)(o,s,0,r),l=void 0!==e.query_point_tolerance?e.query_point_tolerance:p.QUERY_POINT_TOLERANCE,u=i[0].getQueryUrl(),e={SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetFeatureInfo",CRS:n.getCode(),LAYERS:(i||[this._layer.getWMSInfoLayerName()]).map(function(e){return e.getWMSInfoLayerName()}).join(","),QUERY_LAYERS:(i||[this._layer.getWMSInfoLayerName()]).map(function(e){return e.getWMSInfoLayerName()}).join(","),filtertoken:d.default.tokens.filtertoken,INFO_FORMAT:this._layer.getInfoFormat()||"application/vnd.ogc.gml",FEATURE_COUNT:void 0!==e.feature_count?e.feature_count:10,WITH_GEOMETRY:!0,DPI:M,FILTER_GEOM:"map"===l.unit?(new ol.format.WKT).writeGeometry(ol.geom.Polygon.fromCircle(new ol.geom.Circle(o,l.value))):void 0,FI_POINT_TOLERANCE:"map"===l.unit?void 0:l.value,FI_LINE_TOLERANCE:"map"===l.unit?void 0:l.value,FI_POLYGON_TOLERANCE:"map"===l.unit?void 0:l.value,G3W_TOLERANCE:"map"===l.unit?void 0:l.value*s,I:"map"===l.unit?void 0:Math.floor((o[0]-a[0])/s),J:"map"===l.unit?void 0:Math.floor((a[3]-o[1])/s),WIDTH:r[0],HEIGHT:r[1],STYLES:"",BBOX:("ne"===n.getAxisOrientation().substr(0,2)?[a[1],a[0],a[3],a[2]]:a).join(","),LEGEND_ON:i.flatMap(function(e){return(0,g.get_legend_params)(e).LEGEND_ON}).filter(Boolean).join(";")||void 0,LEGEND_OFF:i.flatMap(function(e){return(0,g.get_legend_params)(e).LEGEND_OFF}).filter(Boolean).join(";")||void 0},c=(0,y.getTimeoutPromise)({resolve:t.resolve,data:{data:L.response.utils.getTimeoutData(i),query:{coordinates:o,resolution:s}}}),l=i[0].getOwsMethod(),r=(u||"").split("SOURCE");return(i[0].useProxy()?i[0].getDataProxyFromServer("wms",{url:u,params:e,method:l,headers:{"Content-Type":e.INFO_FORMAT}}):"GET"===l?v.XHR.get({url:(0,m.appendParams)(r.length?r[0]:u,e)+(1<r.length?"&SOURCE"+r[1]:"")}):"POST"===l?v.XHR.post({url:u,data:e}):Promise.resolve()).then(function(e){return t.resolve({data:(0,f.handleQueryResponse)({response:e,projections:{map:n,layer:null},layers:i,wms:!0}),query:{coordinates:o,resolution:s}})}).catch(function(e){return t.reject(e)}).finally(function(){return!i[0].useProxy()&&clearTimeout(c)}),t.promise()}}]),F),wfs:(w(O,e),n(O,[{key:"getData",value:function(){return $.Deferred().promise()}},{key:"query",value:function(){var t=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=$.Deferred(),i=n.filter||new T({}),a=n.layers||[this._layer],o=(a[0].getQueryUrl()+"/").replace(/\/+$/,"/"),s=a[0].getOwsMethod(),l=(0,y.getTimeoutPromise)({resolve:r.resolve,data:{data:L.response.utils.getTimeoutData(a),query:{}}}),u=void 0,e=Object.assign(e,{SERVICE:"WFS",VERSION:"1.1.0",REQUEST:"GetFeature",MAXFEATURES:void 0!==n.feature_count?n.feature_count:10,TYPENAME:a.map(function(e){return e.getWFSLayerName()}).join(","),OUTPUTFORMAT:a[0].getInfoFormat(),SRSNAME:(n.reproject?a[0].getProjection():this._layer.getMapProjection()).getCode(),FILTER:"all"!==i.getType()?("("+(new ol.format.WFS).writeGetFeature({featureTypes:[a[0]],filter:{bbox:ol.format.filter.bbox("the_geom",i.get()),geometry:ol.format.filter[(i.getConfig()||{}).spatialMethod||"intersects"]("the_geom",i.get()),expression:null}[i.getType()]}).children[0].innerHTML+")").repeat(a.length||1):void 0});return"GET"!==s||["all","geometry"].includes(i.getType())||(u=v.XHR.get({url:o+"?"+$.param(e)})),((u="POST"!==s&&!["all","geometry"].includes(i.getType())?u:v.XHR.post({url:o,data:e}))||Promise.reject()).then(function(e){e=(0,f.handleQueryResponse)({response:e,layers:a,projections:{map:t._layer.getMapProjection(),layer:n.reproject?t._layer.getProjection():null},wms:!1});e.flatMap(function(e){return e.features||[]}).forEach(function(n){return Object.entries(n.getProperties()).forEach(function(e){var e=c(e,2),t=e[0],e=e[1];return e&&e["xsi:nil"]&&n.set(t,"NULL")})}),r.resolve({data:e})}).catch(function(e){return r.reject(e)}).finally(function(){return clearTimeout(l)}),r.promise()}}]),O)}},{"app/constant":5,"core/g3wobject":11,"core/i18n/i18n.service":12,"core/layers/features/feature":14,"core/layers/filter/filter":18,"core/layers/utils/QgsFilterToken":38,"services/relations":305,"store/application-state":310,"utils/XHR":319,"utils/appendParams":321,"utils/getDPI":377,"utils/getExtentForViewAndSize":380,"utils/getTimeoutPromise":396,"utils/get_legend_params":399,"utils/handleQueryResponse":401,"utils/parsers":425}],37:[function(e,t,n){var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=e("constant"),i=o(e("store/catalog-layers")),a=o(e("store/projects"));function o(e){return e&&e.__esModule?e:{default:e}}function l(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var u=e("utils"),c=u.base,u=u.inherit,d=e("core/layers/layer"),p=e("core/layers/features/featuresstore"),f=e("core/layers/features/feature"),h=e("lodash.clonedeep");function g(){var o=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=(this.setters={clearFeatures:this._clearFeatures,addFeature:this._addFeature,deleteFeature:this._deleteFeature,updateFeature:this._updateFeature,setFeatures:this._setFeatures,setColor:this._setColor,getFeatures:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=$.Deferred();return this._featuresstore.getFeatures(e).then(function(e){e.then(function(e){return t.emit("getFeatures",e),n.resolve(e)}).fail(n.reject)}).fail(n.reject),n.promise()},commit:function(t){var n=this,r=$.Deferred();return this._featuresstore.commit(t).then(function(e){e.then(function(e){e&&e.result&&n.syncSelectionFilterFeatures(t),r.resolve(e)}).fail(r.reject)}).fail(r.reject),r.promise()}},this.type=d.LayerTypes.TABLE,this._color=null,t.project=t.project||a.default.getCurrentProject(),this.layerId=e.id,e.urls=e.urls||{},e.editing={fields:[]},c(this,e,t),this._editatbleLayer,this.isEditable());e&&(this.layerForEditing=new Promise(function(r,t){o.getEditingConfig().then(l(function*(){var i,a,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.vector,n=e.constraints,n=void 0===n?{}:n,e=e.capabilities;i=function(){return window.g3wsdk.core.hasOwnProperty("editing")},a=s.TIMEOUT,yield new Promise(function(e,t){function n(){i()&&(clearInterval(r),e())}var r=setInterval(n,100);n(),a&&setTimeout(function(){clearInterval(r),t()},a)}),o.config.editing.fields=t.fields,o.config.editing.format=t.format,o.config.editing.constraints=n,o.config.editing.capabilities=e||window.g3wsdk.constant.DEFAULT_EDITING_CAPABILITIES,o.config.editing.form={perc:null},o.config.editing.style=t.style,t.style&&o.setColor(t.style.color),o._setOtherConfigParameters(t),o._editor=new window.g3wsdk.core.editing.Editor({layer:o}),r(o),o.setReady(!0)})).fail(function(e){t(o),o.setReady(!1)})})),e&&(this.state=r({},this.state,{editing:{started:!1,modified:!1,ready:!1}})),this._featuresstore=new p({provider:this.providers.data})}u(g,d);e=g.prototype;e.syncSelectionFilterFeatures=function(e){try{var n=i.default.getLayerById(this.getId());n.isGeoLayer()&&e.update.forEach(function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,e=e.geometry;n.getOlSelectionFeature(t)&&n.updateOlSelectionFeature({id:t,geometry:e})}),e.delete.forEach(function(e){n.hasSelectionFid(e)&&n.excludeSelectionFid(e)})}catch(e){}},e.setFormPercentage=function(e){this.config.editing.form.perc=e},e.getFormPercentage=function(){return this.config.editing.form.perc},e.clone=function(){return h(this)},e.cloneFeatures=function(){return this._featuresstore.clone()},e.setVectorUrl=function(e){this.vectorUrl=e},e.setProjectType=function(e){this.projectType=e},e._setColor=function(e){this._color=e},e.getColor=function(){return this._color},e.readFeatures=function(){return this._featuresstore.readFeatures()},e.getLayerForEditing=l(function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.vectorurl,e=e.project_type;t&&this.setVectorUrl(t),e&&this.setProjectType(e),this.setEditingUrl();try{return yield this.clone().layerForEditing}catch(e){return e}}),e.getEditingSource=function(){return this._editor.getEditingSource()},e.readEditingFeatures=function(){return this._editor.readEditingFeatures()},e.getEditingLayer=function(){return this},e.isEditingLayer=function(){return!!this.config.editing},e.getEditingStyle=function(){return this.config.editing.style},e.setEditingStyle=function(){this.config.editing.style=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}},e.getEditingConstrains=function(){return this.config.editing.constraints},e.getEditingCapabilities=function(){return this.config.editing.capabilities},e.isFieldRequired=function(t){var n=!1;return this.getEditingFields().forEach(function(e){if(t===e.name)return n=!!e.validate.required,!1}),n},e.unlock=function(){var e=$.Deferred();return this._featuresstore.unlock().then(function(){return e.resolve()}).fail(e.reject),e.promise()},e._setOtherConfigParameters=function(e){},e.getEditingFields=function(){var e=(this.config.editing.fields.length?this.config.editing:this.config).fields;return e=0<arguments.length&&void 0!==arguments[0]&&arguments[0]?e.filter(function(e){return e.editable}):e},e.getPkField=function(){return this.getEditingFields().find(function(e){return e.pk})},e.isPkField=function(t){var e=this.getEditingFields().find(function(e){return e.name===t});return e&&e.pk},e.isEditingFieldEditable=function(t){var e=this.getEditingFields().find(function(e){return e.name===t});return!!e&&e.editable},e.getEditingNotEditableFields=function(){return this.config.editing.fields.filter(function(e){return!e.editable}).map(function(e){return e.name})},e.getEditingMediaFields=function(){return this.config.editing.fields.filter(function(e){return"media"===e.input.type}).map(function(e){return e.name})},e.getFieldsLabel=function(){var t=[];return this.getEditingFields().forEach(function(e){return t.push(e.label)}),t},e.getDataFormat=function(){return this.config.editing.format},e.getEditingFormat=function(){return this.config.editing.format},e.isReady=function(){return this.state.editing.ready},e.setReady=function(){this.state.editing.ready=0<arguments.length&&void 0!==arguments[0]&&arguments[0]},e.getEditingConfig=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=$.Deferred();return this.getProvider("data").getConfig(e).then(t.resolve).fail(t.reject),t.promise()},e.addEditingConfigFieldOption=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.field,n=e.key,e=e.value;return t.input.options[n]=e,t.input.options[n]},e.getWidgetData=function(e){var t=$.Deferred();return this.getProvider("data").getWidgetData(e).then(t.resolve).fail(t.reject),t.promise()},e.getCommitUrl=function(){return this.config.urls.commit},e.setCommitUrl=function(e){this.config.urls.commit=e},e.getEditingUrl=function(){return this.config.urls.editing},e.getUnlockUrl=function(){return this.config.url.unlock},e.setUnlockUrl=function(e){this.config.urls.unlock=e},e.getWidgetUrl=function(){return this.config.urls.widget},e.setDataUrl=function(e){this.config.urls.data=e},e.getDataUrl=function(){return this.config.urls.data},e.getConfigUrl=function(){return this.config.urls.config},e.setConfigUrl=function(e){this.config.urls.index=e},e.getEditor=function(){return this._editor},e.isStarted=function(){return this.getEditor().isStarted()},e.setEditor=function(e){this._editor=e},e.getFeaturesStore=function(){return this._featuresstore},e.setFeaturesStore=function(e){this._featuresstore=e},e.setSource=function(e){this.setFeaturesStore(e)},e.getSource=function(){return this._featuresstore},e.getEditingStyle=function(){return this.config.editing.style},e._setFeatures=function(e){this._featuresstore.setFeatures(e)},e.addFeatures=function(e){var t=this;e.forEach(function(e){return t.addFeature(e)})},e._addFeature=function(e){this._featuresstore.addFeature(e)},e._deleteFeature=function(e){return e.getId()},e._updateFeature=function(e){},e._clearFeatures=function(){this._featuresstore.clearFeatures()},e.addLockIds=function(e){this._featuresstore.addLockIds(e)},e.setFieldsWithValues=function(e,t){t=function t(e){var n={};return e.forEach(function(e){"child"===e.type?n[e.name]=t(e.fields):"null"===e.value&&(e.value=null),n[e.name]=e.value}),n}(t);return e.setProperties(t),t},e.getFieldsWithValues=function(e){var n=this,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=t.exclude,i=void 0===r?[]:r,r=t.get_default_value,a=void 0===r||r,t=h(this.getEditingFields()),r=void 0;if(e instanceof f)r=e;else if(e instanceof ol.Feature)r=new f({feature:e});else{if(!e)return t;r=this.getFeatureById(e)}var o=r.getProperties();return t.forEach(function(t){var e;t.value=o[t.name],t._value=o[t.name],t.update=!1,t.input&&(e=n.getEditingFields().find(function(e){return e.name===t.name}).input.options,t.input.options.loading=e.loading||{state:null},t.input.options.values=e.values),t.visible=-1===i.indexOf(t.name),void 0===t.validate&&(t.validate={}),t.forceNull=!1,t.validate.valid=!0,t.validate._valid=!0,t.value_from_default_value=!1,t.get_default_value=a,t.validate.exclude_values=new Set,t.validate.unique=t.validate.unique||!1,t.validate.required=t.validate.required||!1,t.validate.mutually_valid=!0,t.validate.empty=!t.validate.required,t.validate.message=null}),t},e.createNewFeature=function(){var e=new ol.Feature,t={};return this.getEditingFields().forEach(function(e){return t[e.name]=null}),e.setProperties(t),(e=new f({feature:e})).setNew(),e},t.exports=g},{constant:5,"core/layers/features/feature":14,"core/layers/features/featuresstore":15,"core/layers/layer":21,"lodash.clonedeep":"lodash.clonedeep","store/catalog-layers":311,"store/projects":317,utils:404}],38:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.QgsFilterToken=void 0;var r=e("utils");function i(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var a,o,s,l;n.QgsFilterToken={save:(l=i(function*(e,t){e=yield r.XHR.get({url:e,params:{mode:"save",name:t}});if(e&&e.result&&e.data)return e.data}),function(e,t){return l.apply(this,arguments)}),apply:(s=i(function*(e,t){try{var n=yield r.XHR.get({url:e,params:{mode:"apply",fid:t}});if(n&&n.result&&n.data)return n.data}catch(e){}}),function(e,t){return s.apply(this,arguments)}),delete:(o=i(function*(e,t){try{var n=yield r.XHR.get({url:e,params:{mode:void 0===t?"delete":"delete_saved",fid:t}});if(n&&n.result&&n.data)return n.data.filtertoken}catch(e){}}),function(e,t){return o.apply(this,arguments)}),getToken:(a=i(function*(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};try{var n=(yield r.XHR.get({url:e,params:t})).data;return(void 0===n?{}:n).filtertoken}catch(e){return Promise.reject(e)}}),function(e){return a.apply(this,arguments)})}},{utils:404}],39:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});r=l(function*(e,r){var i,a,n,t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=t.fids,s=t.features,l=t.index,u=t.force;null==o||(o=Array.isArray(o)?o:[o],s=Array.isArray(s)?s:[s],i=[],a=[],o.forEach(function(e,t){var t=s[t],n=r.getFilterActive()||r.hasSelectionFid(e);!n&&t&&t.geometry&&!r.getOlSelectionFeature(e)&&r.addOlSelectionFeature({id:e,feature:t}),void 0===u&&r[n?"excludeSelectionFid":"includeSelectionFid"](e),"add"!==u||n||i.push(e),"remove"===u&&a.push(e)}),r.includeSelectionFids(i,!1),r.excludeSelectionFids(a,!1),r.getFilterActive()&&(yield r.createFilterToken()),n=h.default.getService("queryresults").getState().layers,o.forEach(function(e,t){e=!r.hasSelectionFid(e)&&r.getFilterActive()&&0<r.getSelectionFids().size&&n.find(function(e){return e.id===r.getId()});e&&e.features.splice(void 0===l?t:l,1)}),e.clearHighlightGeometry(),1!==n.length)||n[0].features.length||n.splice(0)});var r,i,a=function(e,t){return r.apply(this,arguments)},f=(i=l(function*(e,t,n){t.external?function(r,i){var e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},t=e.fids,a=e.features,o=(e.index,e.force);null!=t&&(t=Array.isArray(t)?t:[fid],a=Array.isArray(a)?a:[a],void 0===i.selection.features&&(i.selection.features=[]),t.forEach(function(t,e){var n,e=a[e];void 0===i.selection.features.find(function(e){return e.getId()===t})&&((n=(0,s.createFeatureFromFeatureObject)({feature:e,id:t})).__layerId=i.id,n.selection=e.selection,i.selection.features.push(n)),"add"===o&&e.selection.selected||"remove"===o&&!e.selection.selected||(e.selection.selected=!e.selection.selected,r.setSelectionFeatures(e.selection.selected?"add":"remove",{feature:i.selection.features.find(function(e){return t===e.getId()})}))}),i.selection.active=i.selection.features.reduce(function(e,t){return e||t.selection.selected},!1))}(e,t,n):yield a(e,t,n)}),function(e,t,n){return i.apply(this,arguments)});n.addToSelection=function(e,t,n,r){var i=h.default.getService("queryresults"),a=i.mapService,o=i._getFeaturesIds.bind(i),s=i._getFeatureId.bind(i),l=i._getExternalLayer.bind(i),i=i.getActionLayerById.bind(i),u=g.default.getLayerById.bind(g.default);{var c,d,p;void 0===t&&void 0===n&&void 0===r?(c=i({layer:e,id:"selection"}),d=Object.values(c.state.toggled).reduce(function(e,t){return e&&t},!0),i=e.external?e:u(e.id),p=e.features&&e.features.length?e.features:[],f(a,i,{fids:0<p.length?o(p,i.external):null,features:p,force:d?"remove":"add"}),e.features.forEach(function(e,t){c.state.toggled[t]=!d})):(n.state.toggled[r]=!n.state.toggled[r],o=l(e.id)?e:u(e.id),i=t?s(t,o.external):null,f(a,o,{fids:[i],features:[t],index:r,force:void 0}))}};var h=o(e("services/gui")),g=o(e("store/catalog-layers")),s=e("utils/createFeatureFromFeatureObject");function o(e){return e&&e.__esModule?e:{default:e}}function l(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}},{"services/gui":302,"store/catalog-layers":311,"utils/createFeatureFromFeatureObject":341}],40:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.removeFromSelection=function(e,t){if(!e)return;e.external?function(e){var t=i.default.getService("queryresults"),n=t.mapService,r=(e.selection.active=!1,t.getActionLayerById({layer:e,id:"selection"}));e.selection.features.forEach(function(e,t){e.selection.selected&&(e.selection.selected=!1,r&&(r.state.toggled[t]=!1),n.setSelectionFeatures("remove",{feature:e}))})}(e):t&&r.default.getLayersStore(t).getLayerById(e.id).clearSelectionFids()};var i=a(e("services/gui")),r=a(e("store/catalog-layers"));function a(e){return e&&e.__esModule?e:{default:e}}},{"services/gui":302,"store/catalog-layers":311}],41:[function(e,t,n){var r=e("utils"),i=r.base,a=r.inherit,r=r.mixin,o=e("core/layers/layer"),s=e("core/layers/tablelayer"),l=e("core/layers/mixins/geo"),u=e("core/layers/map/vectorlayer");function c(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];i(this,e,t),this._mapLayer=null,this.type=o.LayerTypes.VECTOR,this.setup(e,t),this.onafter("setColor",function(e){})}a(c,s),r(c,l);e=c.prototype;e.getEditingLayer=function(){return this.getMapLayer().getOLLayer()},e.resetEditingSource=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];this.getMapLayer().resetSource(e)},e._setOtherConfigParameters=function(e){this.config.editing.geometrytype=e.geometrytype},e.getEditingGeometryType=function(){return this.config.editing.geometrytype},e.getMapLayer=function(){return this._mapLayer||(this._mapLayer=new u({id:this.getId(),geometryType:this.getGeometryType(),color:this.getColor(),style:this.isEditingLayer()?this.getEditingStyle():this.getCustomStyle(),provider:this.getProvider("data"),features:this._editor&&this._editor.getEditingSource().getFeaturesCollection()})),this._mapLayer},t.exports=c},{"core/layers/layer":21,"core/layers/map/vectorlayer":28,"core/layers/mixins/geo":33,"core/layers/tablelayer":37,utils:404}],42:[function(e,t,n){var r=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=c(e("core/g3w-object")),o=c(e("core/g3w-component")),d=c(e("store/plugins")),s=c(e("store/projects")),l=c(e("services/application")),p=c(e("services/gui")),u=e("utils/toRawType");function c(e){return e&&e.__esModule?e:{default:e}}function f(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var h=e("core/i18n/i18n.service").addI18nPlugin;t.exports=function(e){var t,n=c;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);function c(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=t.name,n=void 0===n?null:n,r=t.config,r=void 0===r?d.default.getPluginConfig(n):r,i=t.service,i=void 0===i?null:i,a=t.dependencies,a=void 0===a?[]:a,o=t.i18n,o=void 0===o?null:o,s=t.fontClasses,s=void 0===s?[]:s,t=t.api,t=void 0===t?{}:t,l=this,u=c;if(l instanceof u)return(e=function(e,t){if(e)return!t||"object"!=typeof t&&"function"!=typeof t?e:t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(this,(c.__proto__||Object.getPrototypeOf(c)).call(this))).setName(n),e.setConfig(r),e.setLocale(o),e.setService(i),e.setDependencies(a),e.addFontClasses(s),e.setApi(t),e.setHookService(null),e._ready=!1,e.hookservices={search:p.default.getService("search"),tools:p.default.getService("tools")},e._timeout=setTimeout(function(){d.default.removeLoadingPlugin(e.name,e._ready),e.removeLayout()},1e4),e;throw new TypeError("Cannot call a class as a function")}return n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(n,e):n.__proto__=e),r(c,[{key:"setName",value:function(e){this.name=e}},{key:"getName",value:function(){return this.name}},{key:"setConfig",value:function(e){this.config="Object"===(0,u.toRawType)(e)?e:null}},{key:"getConfig",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.name;return this.config||d.default.getPluginConfig(e)}},{key:"setLocale",value:function(e){e&&this.name&&h({name:this.name,config:e})}},{key:"setService",value:function(e){(this.service=e)&&e.setPlugin(this)}},{key:"getService",value:function(){return this.service}},{key:"setDependencies",value:function(e){this.dependencies=e}},{key:"setApi",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};(this._api=e).getConfig=this._api.getConfig}},{key:"getApi",value:function(){return this._api}},{key:"setHookService",value:function(e){this._hook=e}},{key:"getHookService",value:function(){return this.hookservices[0<arguments.length&&void 0!==arguments[0]?arguments[0]:"tools"]}},{key:"setLayout",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:l.default.cloneLayout("app");l.default.setLayout(this.name,e)}},{key:"setCurrentLayout",value:function(){l.default.setCurrentLayout(this.name)}},{key:"removeLayout",value:function(){l.default.removeLayout(this.name)}},{key:"setReady",value:function(e){var t=this;this._ready=e,this._ready&&this.setLayout(),this.emit("set-ready",e,this.name),setTimeout(function(){clearTimeout(t._timeout),d.default.removeLoadingPlugin(t.name,t._ready)},0)}},{key:"isReady",value:function(){var n=this;return new Promise(function(t){n._ready?t(n._ready):n.once("set-ready",function(e){n._ready=e,t(n._ready)})})}},{key:"isCurrentProjectCompatible",value:function(e){return e===s.default.getCurrentProject().getGid()}},{key:"registerPlugin",value:function(e){e=this.isCurrentProjectCompatible(e);return e?d.default.registerPlugin(this):(d.default.removeLoadingPlugin(this.name,!1),clearTimeout(this._timeout)),e}},{key:"getDependencyPlugins",value:function(e){var t=this;return this.dependencies=e||this.dependencies,Promise.all(this.dependencies.map(function(e){return t.getDependencyPlugin(e)}))}},{key:"getDependencyPluginsObject",value:(t=f(function*(e){var n={},r=yield this.getDependencyPlugins(e);return this.dependencies.forEach(function(e,t){return n[e]=r[t]}),n}),function(e){return t.apply(this,arguments)})},{key:"getDependencyPlugin",value:function(n){return d.default.isTherePlugin(n)?new Promise(function(t){var e=d.default.getPlugin(n);e&&e.isReady().then(function(){return t(e.getApi())})||d.default.onafter("registerPlugin",function(e){e.name===n&&e.isReady().then(function(){t(e.getApi())})})}):Promise.reject({error:"no plugin"})}},{key:"setHookLoading",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.hook,e=e.loading,e=void 0!==e&&e;this.getHookService(void 0===t?"tools":t).setLoading(e)}},{key:"addToolGroup",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.hook,n=e.position,e=e.title;this.getHookService(void 0===t?"tools":t).addToolGroup(n,e)}},{key:"removeToolGroup",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.hook,e=e.group;this.getHookService(t).removeToolGroup(e.title)}},{key:"addTools",value:function(t,e){var n=this,r=t.hook||"tools",i=[];return t.action||t.type?(this.setHookService(r),i=(this.config.configs||[this.config]).map(function(e){return{icon:t.icon,type:t.type,name:e.name||t.name,html:t.html,options:t.options||{},action:t.action&&t.action.bind(n,e),loading:void 0!==t.loading&&t.loading,disabled:void 0!==t.disabled&&t.disabled,offline:void 0===t.offline||t.offline,state:void 0!==t.state?t.state:{type:null,message:null}}}),this.getHookService(r).addTools(i,e)):this.removeToolGroup({hook:r,group:e}),i}},{key:"setToolState",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,e=e.state;this.hookservices[this._hook].setToolState({id:t,state:void 0===e?{type:null,message:null}:e})}},{key:"removeTools",value:function(){this.hookservices[this._hook].removeTools()}},{key:"createSideBarComponent",value:function(e){function t(e,t){return void 0!==e?e:t}var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return n.vueComponentObject=e,n.collapsible=t(n.collapsible,!0),n.mobile=t(n.mobile,!0),n.isolate=t(n.isolate,!1),n.sidebarOptions=t(n.sidebarOptions,{position:1}),p.default.addComponent(new o.default(n),"sidebar",n.sidebarOptions),this.once("unload",function(){return p.default.removeComponent(n.id,"sidebar",n.sidebarOptions)}),p.default.getComponent(n.id)}},{key:"unload",value:function(){this.service&&this.service.clearAllEvents(),this.emit("unload")}},{key:"load",value:function(){}},{key:"getProject",value:function(){return s.default.getCurrentProject()}},{key:"addDependency",value:function(e){this.dependencies.push(e)}},{key:"addFontClass",value:function(e){var t=e.name,e=e.className;Vue.prototype.g3wtemplate.addFontClass({name:t,className:e})}},{key:"addFontClasses",value:function(){var t=this;(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(e){return t.addFontClass(e)})}}]),c}(a.default)},{"core/g3w-component":8,"core/g3w-object":9,"core/i18n/i18n.service":12,"services/application":298,"services/gui":302,"store/plugins":316,"store/projects":317,"utils/toRawType":448}],43:[function(e,t,n){var r=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=l(e("core/g3w-object")),o=l(e("store/application-state")),s=l(e("services/application"));function l(e){return e&&e.__esModule?e:{default:e}}t.exports=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);function i(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=this,r=i;if(n instanceof r)return(t=function(e,t){if(e)return!t||"object"!=typeof t&&"function"!=typeof t?e:t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e))).plugin,t._api={own:null,dependencies:{}},t._pluginEvents={},t._appEvents=[],t.currentLayout=s.default.getCurrentLayoutName(),t.vm=new Vue,t.unwatch=t.vm.$watch(function(){return o.default.gui.layout.__current},function(e){return t.currentLayout=e!==t.getPlugin().getName()?e:t.currentLayout}),t;throw new TypeError("Cannot call a class as a function")}return t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e),r(i,[{key:"init",value:function(){this.config=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}}},{key:"setCurrentLayout",value:function(){s.default.setCurrentLayout(this.getPlugin().getName())}},{key:"resetCurrentLayout",value:function(){s.default.setCurrentLayout(this.currentLayout)}},{key:"setPlugin",value:function(e){this.plugin=e}},{key:"getPlugin",value:function(){return this.plugin}},{key:"isIframe",value:function(){return s.default.isIframe()}},{key:"getCurrentProject",value:function(){return s.default.getCurrentProject()}},{key:"getGid",value:function(){return this.config.gid&&this.config.gid.split(":")[1]}},{key:"getConfig",value:function(){return this.config}},{key:"setConfig",value:function(e){this.config=e}},{key:"setApi",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.dependency,e=e.api;t?this._api.dependencies[t]=e:this._api.own=e}},{key:"getApi",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).dependency;return e&&this._api.dependencies[e]||this._api.own}},{key:"initEvents",value:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];for(e in t)this._pluginEvents[t[e]]={}}},{key:"registerWindowEvent",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.evt,e=e.cb;s.default.registerWindowEvent({evt:t,cb:e})}},{key:"unregisterWindowEvent",value:function(e){var t=e.evt,e=e.cb;s.default.unregisterWindowEvent({evt:t,cb:e})}},{key:"subscribeEvent",value:function(e){var t=e.name,n=e.once,n=void 0!==n&&n,r=e.owner,e=e.listener;this._pluginEvents[t]=this._pluginEvents[t]||{},this._pluginEvents[t][r]=e,n?this.once(t,e):this.on(t,e)}},{key:"triggerEvent",value:function(e){var t=e.name,e=e.params;this.emit(t,void 0===e?{}:e)}},{key:"unsubscribeEvent",value:function(e){var t=e.name,e=e.owner;this.removeEvent(t,this._pluginEvents[t][e]),delete this._pluginEvents[t][e]}},{key:"unsubscribeAllEvents",value:function(){for(var e in this._pluginEvents)this.removeEvent(e),delete this._pluginEvents[e]}},{key:"clearAllEvents",value:function(){this.unsubscribeAllEvents(),this.unwatch(),this.vm=null,this._pluginEvents=null}},{key:"loadPlugin",value:function(){return!0}},{key:"clear",value:function(){}}]),i}(a.default)},{"core/g3w-object":9,"services/application":298,"store/application-state":310}],44:[function(e,t,n){var r=e("app/constant"),a=l(e("store/application-state")),o=l(e("services/application")),i=e("utils/crsToCrsObject"),s=l(e("core/g3wobject"));function l(e){return e&&e.__esModule?e:{default:e}}function u(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}function c(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var d=e("utils"),p=d.base,f=d.inherit,h=d.XHR,g=e("core/layers/layerfactory"),v=e("core/layers/layersstore"),m=e("g3w-ol/projection/projections");function y(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=(e.catalog_tab=e.toc_tab_default||e._catalog_tab||"layers",e.ows_method=e.ows_method||"GET",e.toc_layers_init_status=e.toc_layers_init_status||r.TOC_LAYERS_INIT_STATUS,e.toc_themes_init_status=e.toc_themes_init_status||r.TOC_THEMES_INIT_STATUS,e.query_point_tolerance=e.query_point_tolerance||r.QUERY_POINT_TOLERANCE,this.state=e,this.getType()),t=this.getId(),n=this.getVectorUrl();this.urls={map_themes:"/"+e+"/api/prjtheme/"+t+"/",expression_eval:"/api/expression_eval/"+t+"/",vector_data:n+"data/"+e+"/"+t+"/",featurecount:n+"featurecount/"+e+"/"+t+"/"},this._processLayers(),this.state.crs=(0,i.crsToCrsObject)(this.state.crs),this._projection=m.get(this.state.crs),this._layersStore=this._buildLayersStore(),this.setters={setBaseLayer:function(t){var n=this;this.state.baselayers.forEach(function(e){n._layersStore.getLayerById(e.id).setVisible(e.id===t),e.visible=e.id===t})}},this.setSearchEndPoint(),p(this)}f(y,s.default);var _,b,w,x,d=y.prototype;d.getWmsGetmapFormat=function(){return this.state.wms_getmap_format},d.getSearchEndPoint=function(){return"api"},d.setSearchEndPoint=function(){(this.state.search||[]).forEach(function(e){return e.search_endpoint="api"})},d.getAliasUrl=function(){return this.state.aliasUrl},d.getActiveCatalogTab=function(){return this.state.catalog_tab},d.setActiveCatalogTab=function(){this.state.catalog_tab=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"layers"},d.isWmsUseLayerIds=function(){return this.state.wms_use_layer_ids},d.getContextBaseLegend=function(){return this.state.context_base_legend},d.getQueryPointTolerance=function(){return this.state.query_point_tolerance},d.getQueryFeatureCount=function(){return this.state.feature_count||5},d.isQueryMultiLayers=function(e){return this.state.querymultilayers&&-1!==this.state.querymultilayers.indexOf(e)},d.getRelations=function(){return this.state.relations},d.getRelationById=function(t){return this.state.relations.find(function(e){return e.id===t})},d.getRelationsByLayerId=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layerId,n=e.type;return this.state.relations.filter(function(e){return e.referencedLayer===t&&(!n||e.type===n)})},d.getOwsMethod=function(){return this.state.ows_method},d._processLayers=function(){var i=this,e=(function e(r){for(var t=0;t<r.length;t++)!function(t){var n=r[t];void 0!==n.id&&i.state.layers.forEach(function(e){if(e.name,n.id===e.id)return n.name=e.name,e.wmsUrl=i.getWmsUrl(),e.project=i,n[t]=Object.assign(e,n),!1}),Array.isArray(n.nodes)&&(n.title=n.name,e(n.nodes))}(t)}(this.state.layerstree),o.default.getBaseLayerId());this.state.baselayers=this.state.baselayers.filter(function(e){return"Bing"!==e.servertype||a.default.keys.vendorkeys.bing});for(var t=0;t<this.state.baselayers.length;t++){var n=this.state.baselayers[t],r=null!==e?e:this.state.initbaselayer;n.visible=r&&n.id===r||!!n.fixed,n.baselayer=!0}},d._buildLayersStore=function(){var t=this,n=new v,e=this.state.overviewprojectgid?this.state.overviewprojectgid.gid:null;return n.setOptions({id:this.state.gid,projection:this._projection,extent:this.state.extent,initextent:this.state.initextent,wmsUrl:this.state.WMSUrl,catalog:e!==this.state.gid}),this.getLayers().forEach(function(e){e.crs=(0,i.crsToCrsObject)(e.crs),e.projection=e.crs?m.get(e.crs):t._projection,e.ows_method=t.getOwsMethod(),e.wms_use_layer_ids=t.state.wms_use_layer_ids;e=g.build(e,{project:t});e&&n.addLayer(e)}),n.createLayersTree(this.state.name,{layerstree:this.state.layerstree,expanded:"not_collapsed"===this.state.toc_layers_init_status}),n},d.getLayerById=function(e){return this._layersStore.getLayerById(e)},d.getLayers=function(){return[].concat(c(this.state.layers),c(this.state.baselayers))},d.getBaseLayers=function(){return this.state.baselayers},d.getConfigLayers=function(){var t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).key;return t?this.state.layers.filter(function(e){return void 0!==e[t]}):this.state.layers},d.setLegendPosition=function(){this.state.legend_position=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"tab"},d.getLegendPosition=function(){return this.state.legend_position},d.getThumbnail=function(){return this.state.thumbnail},d.getMetadata=function(){return this.state.metadata||{}},d.getState=function(){return this.state},d.getPrint=function(){return this.state.print||[]},d.getSearches=function(){return this.state.search||[]},d.getVectorUrl=function(){return this.state.vectorurl},d.getRasterUrl=function(){return this.state.rasterurl},d.getId=function(){return this.state.id},d.getType=function(){return this.state.type},d.getGid=function(){return this.state.gid},d.getName=function(){return this.state.name},d.getOverviewProjectGid=function(){return this.state.overviewprojectgid?this.state.overviewprojectgid.gid:null},d.getCrs=function(){return this._projection.getCode()},d.getQgisVersion=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).type,e=["major","minor","patch"].indexOf(e);return-1===e?this.state.qgis_version:+this.state.qgis_version.split(".")[e]},d.getProjection=function(){return this._projection},d.getWmsUrl=function(){return this.state.WMSUrl},d.getInfoFormat=function(){return"application/vnd.ogc.gml"},d.getLayersStore=function(){return this._layersStore},d.setLayersTreePropertiesFromMapTheme=(_=u(function*(e){var a=this,t=e.map_theme,e=e.layerstree,e=void 0===e?this.state.layerstree:e,o=yield this.getMapThemeFromThemeName(t),s={layers:{}},l=[],u=[];return function t(e,n,r){e.forEach(function(i,e){i.nodes?(u.push({node:i,group:n[e]}),t(i.nodes,n[e].nodes,r&&i.checked)):(i.style=o.styles[i.id],n[e].checked!==i.visible&&(s.layers[i.id]={visibility:!0,style:!1}),n[e].checked=i.visible,i.style&&(e=new Promise(function(t,e){function n(e){void 0===s.layers[e.id]&&(s.layers[e.id]={visibility:!1,style:!1}),s.layers[e.id].style=a.getLayerById(e.id).setCurrentStyle(e.style),t()}var r;a.getLayersStore()?n(i):(r=i,setTimeout(function(){return n(r)}))}),l.push(e)))})}(o.layerstree,e),yield Promise.allSettled(l),u.forEach(function(e){var t=e.group,e=e.node,n=e.checked,e=e.expanded;t.checked=n,t.expanded=e}),s}),function(e){return _.apply(this,arguments)}),d.getMapThemeFromThemeName=(b=u(function*(t){var e=Object.values(this.state.map_themes).flat().find(function(e){return t===e.theme});return e&&void 0===e.layerstree&&(e.layerstree=yield this.getMapThemeConfiguration(t)),e}),function(e){return b.apply(this,arguments)}),d.saveMapTheme=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return e?h.post({url:""+this.urls.map_themes+encodeURIComponent(e)+"/",contentType:"application/json",data:JSON.stringify(t)}):Promise.reject()},d.deleteMapTheme=(w=u(function*(e){return e?h.delete({url:""+this.urls.map_themes+encodeURIComponent(e)+"/"}):Promise.reject()}),function(e){return w.apply(this,arguments)}),d.getMapThemeConfiguration=(x=u(function*(e){try{var t=yield h.get({url:""+this.urls.map_themes+e+"/"});if(t.result)return t.data}catch(e){}}),function(e){return x.apply(this,arguments)}),d.getUrl=function(e){return this.urls[e]},d.getSpatialBookmarks=function(){return this.state.bookmarks||[]},d.getMessages=function(){return this.state.messages},t.exports=y},{"app/constant":5,"core/g3wobject":11,"core/layers/layerfactory":22,"core/layers/layersstore":23,"g3w-ol/projection/projections":76,"services/application":298,"store/application-state":310,utils:404,"utils/crsToCrsObject":359}],45:[function(e,t,n){var r=e("utils"),i=r.base;function a(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=Date.now();[].concat(e.fieldRef.referencedField);this.state={loading:!1,id:e.id||"id_"+t,name:e.name||"name_"+t,origname:e.origname||"origname_"+t,father:e.referencedLayer,child:e.referencingLayer,type:e.type,editable:e.editable||!1,prefix:e.prefix,fatherField:[].concat(e.fieldRef.referencedField),childField:[].concat(e.fieldRef.referencingField)},i(this)}(0,r.inherit)(a,e("core/g3wobject"));r=a.prototype;r.getId=function(){return this.state.id},r.setId=function(e){this.state.id=e},r.getName=function(){return this.state.name},r.setName=function(e){this.state.name=e},r.getTitle=function(){return this.state.title},r.setTitle=function(e){return this.state.title=e},r.getChild=function(){return this.state.child},r.getFather=function(){return this.state.father},r.getState=function(){return this.state},r.getType=function(){return this.state.type},r.getFields=function(){return{father:this.state.fatherField,child:this.state.childField}},r.getFatherField=function(){return this.state.fatherField},r.getChildField=function(){return this.state.childField},r.setLoading=function(){this.state.loading=0<arguments.length&&void 0!==arguments[0]&&arguments[0]},r.isLoading=function(){return this.state.loading},r.isEditable=function(){return this.state.editable},r.getPrefix=function(){return this.state.prefix},t.exports=a},{"core/g3wobject":11,utils:404}],46:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=n.VM=new Vue,i=n.CatalogEventBus=new Vue,a=n.RelationEventBus=new Vue,o=n.SidebarEventBus=new Vue;n.default={VM:r,CatalogEventBus:i,RelationEventBus:a,SidebarEventBus:o}},{}],47:[function(e,t,n){var r=e("g3w-ol/controls/control");function i(){r.call(this,{name:"addlayer",tipLabel:"sdk.mapcontrols.addlayer.tooltip",label:""}),this._layerstore=null}ol.inherits(i,r);e=i.prototype;e.setMap=function(e){var t=this;r.prototype.setMap.call(this,e),$(this.element).on("click",function(){return t.dispatchEvent("addlayer")})},e.layout=function(e){r.prototype.layout.call(this,e)},e.getLayersSore=function(){return this._layerstore},e.setLayersStore=function(e){this._layerstore=e},t.exports=i},{"g3w-ol/controls/control":50}],48:[function(e,t,n){function r(){var e=(0,i.mergeOptions)(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},{tipLabel:"sdk.mapcontrols.measures.area.tooltip",label:"",clickmap:!0,interactionClass:a});o.call(this,e)}var i=e("utils/mergeOptions"),a=e("g3w-ol/interactions/areainteraction"),o=e("g3w-ol/controls/measurecontrol");ol.inherits(r,o),t.exports=r},{"g3w-ol/controls/measurecontrol":55,"g3w-ol/interactions/areainteraction":67,"utils/mergeOptions":417}],49:[function(e,t,n){function r(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=void 0===(t=(r=e).spatialMethod)?i.SPATIAL_METHODS[0]:t,n=r.onSelectlayer,r=r.interactionClass;(e=(0,o.mergeOptions)(e,{offline:!1,onSelectlayer:n,clickmap:!0,interactionClass:r,spatialMethod:t,toggledTool:{type:"spatialMethod",how:"toggled"},onhover:!0})).geometryTypes=l,s.call(this,e)}var i=e("app/constant"),a=e("utils/getAllPolygonGeometryTypes"),o=e("utils/mergeOptions"),s=e("g3w-ol/controls/interactioncontrol"),l=(0,a.getAllPolygonGeometryTypes)();ol.inherits(r,s),t.exports=r},{"app/constant":5,"g3w-ol/controls/interactioncontrol":53,"utils/getAllPolygonGeometryTypes":373,"utils/mergeOptions":417}],50:[function(e,t,n){var e=e("components/MapControlButton"),i=(e=e)&&e.__esModule?e:{default:e};function a(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=void 0===(t=e.name)?"":t,n=void 0===(n=e.visible)||n,r=e.enabled;this._enabled=void 0!==r&&r,this.offline=void 0===e.offline||e.offline,this.name=t.split(" ").join("-").toLowerCase(),this.id=this.name+"_"+Math.floor(1e6*Math.random()),this.eventKeys={},this.positionCode=e.position||"tl",this.priority=e.priority||0,e.element||(r=Vue.extend((0,i.default)({className:"ol-"+this.name.split(" ").join("-").toLowerCase(),customClass:e.customClass,tipLabel:e.tipLabel||this.name,label:e.label||""})),e.element=(new r).$mount().$el),$(e.element).on("click",e.buttonClickHandler||a.prototype._handleClick.bind(this)),ol.control.Control.call(this,e),this.setVisible(n),this._postRender()}ol.inherits(a,ol.control.Control);e=a.prototype;e.isClickMap=function(){return this.clickmap},e.isToggled=function(){return this._toggled},e.setEventKey=function(e){var t=e.eventType,e=e.eventKey;this.eventKeys[t]={eventKey:e,originalHandler:e.listener}},e.resetOriginalHandlerEvent=function(e){this.eventKeys[e]&&this.eventKeys[e].eventKey&&(ol.Observable.unByKey(this.eventKeys[e].eventKey),this.eventKeys[e].eventKey=this.on(e,this.eventKeys[e].originalHandler))},e.overwriteEventHandler=function(e){var t=e.eventType,e=e.handler;this.eventKeys[t]&&this.eventKeys[t].eventKey&&(ol.Observable.unByKey(this.eventKeys[t].eventKey),this.eventKeys[t].eventKey=this.on(t,e))},e.getPosition=function(e){e=e||this.positionCode;var t={};return t.top=-1<e.indexOf("t"),t.left=-1<e.indexOf("l"),t.bottom=-1<e.indexOf("b"),t.right=-1<e.indexOf("r"),t},e._handleClick=function(e){var t=this,e=(e.preventDefault(),this.getMap()),n=null,e=e.getControls();this._toggled&&e.forEach(function(e){e.id&&e.toggle&&e.id!==t.id&&(e.toggle(!1),"reset"===e.name)&&(n=e)}),!this._toggled&&n&&n.toggle(!0),this.dispatchEvent("controlclick")},e.shiftPosition=function(e){$(this.element).css(hWhere,e+"px")},e.layout=function(e){var t,n;e&&(t=this.getPosition(),n=$(this.element))},e.changelayout=function(e){},e.setMap=function(e){e&&(this.layout(e),ol.control.Control.prototype.setMap.call(this,e))},e.showControl=function(){$(this.element).show()},e.hideControl=function(){var e,t=$(this.element).position().left,n=$(this.element).outerWidth();$(this.element).siblings(".ol-control-tl").each(function(){$(this).position().left>t&&(e=$(this).position().left,n>$(this).outerWidth()&&(t+=n-$(this).outerWidth()),$(this).css("left",t+"px"),t=e,n=$(this).outerWidth())}),$(this.element).hide()},e.setEnable=function(e){$(this.element).find("button").first().toggleClass("g3w-ol-disabled",!e),!e&&this._interaction&&this._interaction.setActive(!1),this._enabled=e},e.getEnable=function(){return this._enabled},e.setVisible=function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this._visible=e,$(this.element)[e?"show":"hide"]()},e.isVisible=function(){return this._visible},e._postRender=function(){},t.exports=a},{"components/MapControlButton":192}],51:[function(e,t,n){var r=e("services/gui"),a=(r=r)&&r.__esModule?r:{default:r};var i=e("g3w-ol/controls/interactioncontrol"),o={visible:!0,offline:!1,enabled:!0,name:"geolocation",tipLabel:"sdk.mapcontrols.geolocation.tooltip",label:""},s=new ol.style.Style({text:new ol.style.Text({text:"",font:'900 3em "Font Awesome 5 Free"',fill:new ol.style.Fill({color:"red"}),offsetY:-15})});function l(){var t=this;this._layer=new ol.layer.Vector({source:new ol.source.Vector,style:s}),this._geolocation=new ol.Geolocation({trackingOptions:{enableHighAccuracy:!0}}),i.call(this,o),this.on("controlclick",function(e){t._geolocation.getTracking()?t._geolocation.setTracking(!1):t.geolocate()})}ol.inherits(l,i);r=l.prototype;r._showMarker=function(e){var t=e.map,n=e.coordinates,e=e.show,e=void 0===e||e;this._layer&&(this._layer.getSource().clear(),e?(t.getView().setCenter(n),this._layer.getSource().addFeature(new ol.Feature({geometry:new ol.geom.Point(n)})),t.addLayer(this._layer)):t.removeLayer(this._layer))},r.geolocate=function(){var t,n,r=this,i=this.getMap();i&&(t=this._geolocation,n=void 0,t.on("change:position",function(){var e=t.getPosition();e&&(n=r.on("toggled",function(){r._showMarker({map:i,coordinates:t.getPosition(),show:r.isToggled()})}),$(r.element).removeClass("g3w-ol-disabled"),r._showMarker({map:i,coordinates:e,show:r.isToggled()}))}),t.on("error",function(e){r._layer=null,a.default.showUserMessage({type:"warning",title:"mapcontrols.geolocation.error",message:e.message,autoclose:!1}),r.toggle(!1),ol.Observable.unByKey(n),n=null}),t.setProjection(i.getView().getProjection()),t.setTracking(!0))},t.exports=l},{"g3w-ol/controls/interactioncontrol":53,"services/gui":302}],52:[function(e,t,n){var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=e("g3w-ol/controls/screenshotcontrol");function a(){i.call(this,r({name:"maptoimagegeo",tipLabel:"Geo Screenshot",label:""},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}))}ol.inherits(a,i),t.exports=a},{"g3w-ol/controls/screenshotcontrol":64}],53:[function(e,t,n){var a=e("app/constant"),r=e("app/eventbus"),o=s(e("services/gui")),i=s(e("store/map-controls"));function s(e){return e&&e.__esModule?e:{default:e}}function g(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=void 0===(n=t.visible)||n,r=void 0===(r=t.enabled)||r,i=void 0!==(a=t.toggled)&&a,a=void 0!==(a=t.clickmap)&&a,o=void 0===(o=t.interactionClass)?null:o,s=void 0!==(s=t.autountoggle)&&s,l=void 0===(l=t.geometryTypes)?[]:l,u=void 0!==(u=t.onhover)&&u,c=void 0===(c=t.help)?null:c,d=t.toggledTool,p=void 0===(p=t.interactionClassOptions)?{}:p,f=t.layers,h=t.spatialMethod;this.layers=void 0===f?[]:f,this.unwatches=[],this.listenLayersVisibilityChange(),this._visible=n,this._toggled=!1,this.clickmap=a,this._interactionClass=o,this._interaction=null,this._autountoggle=s,this._geometryTypes=l,this._onhover=u,this._help=c,this._helpButton,this._toolButton,this.spatialMethod=h,this.toggledTool,this._interactionClassOptions=p,t.buttonClickHandler=g.prototype._handleClick.bind(this),v.call(this,t),!0===i&&this.on("setMap",function(){return e.toggle(i)}),this._help&&this._createModalHelp(),d&&this.createControlTool(d),this.setEnable(r),this.spatialMethod&&this.handleChangeSpatialMethod(this.spatialMethod)}var l=e("core/i18n/i18n.service").t,v=e("g3w-ol/controls/control"),e=(ol.inherits(g,v),g.prototype);e.onSelectLayer=function(){},e.runSpatialQuery=function(){},e.clear=function(){},e.onAddExternalLayer=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.layer,e.unWatches},e.onRemoveExternalLayer=function(e){},e.handleSelectedLayer=function(e){},e.handleExternalSelectedLayer=function(e){},e.checkVisibile=function(e){return!0},e.checkVisibile=function(e){return!0},e.listenLayersVisibilityChange=function(){},e.change=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=(this.layers=e,this.checkVisibile(e));this.setVisible(e),this.setEnable(!1),this.listenLayersVisibilityChange()},e.isClickMap=function(){return this.clickmap},e.enable=function(){$(this.element).removeClass("g3w-disabled")},e.disable=function(){$(this.element).addClass("g3w-disabled")},e.createControlTool=function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=e.type,r=e.component,e=e.how,e=void 0===e?"toggled":e;switch(n){case"spatialMethod":var i=this.getSpatialMethod();this.toggledTool={data:function(){return this.methods=a.SPATIAL_METHODS,{method:i}},template:'\n          <div style="width: 100%; padding: 5px;">\n            <select ref="select" style="width: 100%"  :search="false" v-select2="\'method\'">\n              <option v-for="method in methods">{{method}}</option>\n            </select>\n          </div>',watch:{method:function(e){return t.setSpatialMethod(e)}},created:function(){o.default.setCloseUserMessageBeforeSetContent(!1)},beforeDestroy:function(){o.default.setCloseUserMessageBeforeSetContent(!0)}};break;case"custom":this.toggledTool=r}"hover"===e&&this._createToolOnHoverButton()},e._createToolOnHoverButton=function(){var t=this;this._onhover&&(this._toolButton=$('<span style="display:none" class="tool_mapcontrol_button"><i class="'+o.default.getFontClass("tool")+'"></i></span>'),$(this.element).prepend(this._toolButton),this._toolButton.on("click",function(e){e.stopPropagation(),t.showToggledTool(!0)}),$(this.element).hover(function(){return t._toggled&&t._toolButton.show()}),$(this.element).mouseleave(function(){return t._toolButton.hide()}))},e.showToggledTool=function(){!(0<arguments.length&&void 0!==arguments[0])||arguments[0]?o.default.showUserMessage({title:"",type:"tool",size:"small",closable:!!this._toolButton,hooks:{body:this.toggledTool}}):o.default.closeUserMessage()},e._showModalHelp=function(){o.default.showModalDialog({title:l(this._help.title),message:l(this._help.message)})},e._createModalHelp=function(){var t=this;this._onhover&&(this._helpButton=$('<span style="display:none" class="info_mapcontrol_button">i</span>'),$(this.element).prepend(this._helpButton),this._helpButton.on("click",function(e){e.stopPropagation(),t._showModalHelp()}),$(this.element).hover(function(){return t._helpButton.show()}),$(this.element).mouseleave(function(){return t._helpButton.hide()}))},e.getGeometryTypes=function(){return this._geometryTypes},e.isToggled=function(){return this._toggled},e.getControlBottom=function(){return $(this.element).find("button").first()},e.addClassToControlBottom=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";this.getControlBottom().addClass(e)},e.removeClassToControlBottom=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";this.getControlBottom().removeClass(e)},e.toggle=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!this._toggled;this._toggled!==e&&((this._toggled=e)?(this._interaction&&this._interaction.setActive(!0),this.addClassToControlBottom("g3w-ol-toggled"),this._toolButton&&this._toolButton.show()):(this._help&&this._helpButton.hide(),this._interaction&&this._interaction.setActive(!1),this.removeClassToControlBottom("g3w-ol-toggled"),this._toolButton&&this._toolButton.hide(),this.toggledTool&&this.showToggledTool(!1)),void 0===this._toolButton&&this.toggledTool&&this.showToggledTool(this._toggled),this.dispatchEvent({type:"toggled",toggled:e}))},e.getGeometryTypes=function(){return this._geometryTypes},e.setGeometryTypes=function(e){this._geometryTypes=e},e.setMap=function(e){v.prototype.setMap.call(this,e),!this._interaction&&this._interactionClass&&(this._interaction=new this._interactionClass(this._interactionClassOptions),e.addInteraction(this._interaction),this._interaction.setActive(!1)),this.dispatchEvent({type:"setMap",map:e})},e._handleClick=function(e){this._enabled&&(this.toggle(),v.prototype._handleClick.call(this,e))},e.getInteraction=function(){return this._interaction},e.setSpatialMethod=function(){this.spatialMethod=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"intersects",this.dispatchEvent({type:"change-spatial-method",spatialMethod:this.spatialMethod})},e.getSpatialMethod=function(){return this.spatialMethod},e.setLayers=function(){this.layers=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]},e.setSelectedLayer=function(e){i.default.setSelectedLayer(e)},e.getSelectedLayer=function(){return i.default.getSelectedLayer()},e.getExternalLayers=function(){return i.default.getExternalLayers()},e.handleChangeSpatialMethod=function(t){var n=this,r=null;this.on("toggled",function(e){!0===e.toggled?r=n.on("change-spatial-method",n.runSpatialQuery):null!==r&&(ol.Observable.unByKey(r),r=null,n.setSpatialMethod(t),n.clear())})},e.watchLayer=function(e,t){return r.VM.$watch(e,t)},e.isSelectedLayerVisible=function(){return"function"==typeof this.getSelectedLayer().isVisible?this.getSelectedLayer().isVisible():this.getSelectedLayer().visible},e.hasVisibleProjectLayer=function(){return!!(0<this.layers.length&&this.layers.find(function(e){return e.isVisible()}))},e.hasVisibleExternalLayer=function(){var t=this;return!!this.getExternalLayers().find(function(e){return e!==t.layer&&!0===e.visible})},e.hasVisibleLayers=function(){return!(!this.hasVisibleProjectLayer()&&!this.hasVisibleExternalLayer())},e.addExternalLayerToResult=function(){var t=this;return null===this.getSelectedLayer()||void 0!==this.getExternalLayers().find(function(e){return e===t.getSelectedLayer()})},e.isExternalLayerSelected=function(){var t=this;return null!==this.getSelectedLayer()&&void 0!==this.getExternalLayers().find(function(e){return e===t.getSelectedLayer()})},t.exports=g},{"app/constant":5,"app/eventbus":46,"core/i18n/i18n.service":12,"g3w-ol/controls/control":50,"services/gui":302,"store/map-controls":314}],54:[function(e,t,n){function r(){var e=(0,i.mergeOptions)(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},{tipLabel:"sdk.mapcontrols.measures.length.tooltip",label:"",clickmap:!0,interactionClass:a});o.call(this,e)}var i=e("utils/mergeOptions"),a=e("g3w-ol/interactions/lengthinteraction"),o=e("g3w-ol/controls/measurecontrol");ol.inherits(r,o),t.exports=r},{"g3w-ol/controls/measurecontrol":55,"g3w-ol/interactions/lengthinteraction":69,"utils/mergeOptions":417}],55:[function(e,t,n){function r(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._map=null,i.call(this,e)}var i=e("g3w-ol/controls/interactioncontrol"),e=(ol.inherits(r,i),r.prototype);e.setMap=function(e){i.prototype.setMap.call(this,e)},e.toggle=function(e){i.prototype.toggle.call(this,e),!this.isToggled()&&this.getInteraction()&&this.getInteraction().clear()},t.exports=r},{"g3w-ol/controls/interactioncontrol":53}],56:[function(e,t,n){function r(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.target=e.target||"mouse-position-control",ol.control.MousePosition.call(this,e)}ol.inherits(r,ol.control.MousePosition);t=(t.exports=r).prototype;t.offline=!0,t.setEnable=function(e){$(this.element)},t.setMap=function(e){e&&($(this.element).removeClass("ol-control"),ol.control.MousePosition.prototype.setMap.call(this,e))}},{}],57:[function(e,t,n){function i(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var a=e("g3w-ol/controls/control");function r(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._originalonlick=null,this._onclick=e.onclick,a.call(this,e)}ol.inherits(r,a);e=r.prototype;e.overwriteOnClickEvent=function(e){this._originalonlick=this._originalonlick||this._onclick,this._onclick=e},e.resetOriginalOnClickEvent=function(){this._onclick=this._originalonlick||this._onclick,this._originalonlick=null},e.setMap=function(e){var t=this,e=(a.prototype.setMap.call(this,e),$(this.element)),n=e.children("button"),r=!1;e.on("click",i(function*(){r||(r=!0,n.addClass("g3w-ol-disabled"),t._onclick&&(yield t._onclick()),n.removeClass("g3w-ol-disabled"),r=!1)}))},t.exports=r},{"g3w-ol/controls/control":50}],58:[function(e,t,n){var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=(e("app/constant"),s(e("services/gui"))),r=s(e("services/data")),o=s(e("store/projects"));function s(e){return e&&e.__esModule?e:{default:e}}function l(){var n=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=void 0===(t=e.spatialMethod)?SPATIAL_METHODS[0]:t;this._startCoordinate=null,this.unwatches=[];(r=a.default.getService("map").filterableLayersAvailable(f)||[]).forEach(function(e){return e.setTocHighlightable(!0)});var r=i({},e,{layers:r,offline:!1,name:"querybbox",tipLabel:"sdk.mapcontrols.querybybbox.tooltip",label:e.label||"",clickmap:!0,interactionClass:ol.interaction.DragBox,onhover:!0,toggledTool:{type:"spatialMethod",how:"toggled"},spatialMethod:t,help:{title:"sdk.mapcontrols.querybybbox.help.title",message:"sdk.mapcontrols.querybybbox.help.message"}});d.call(this,r),this.setEnable(this.hasVisibleLayers()),this.bbox=null,this.on("toggled",function(e){var t=e.toggled;n.getExternalLayers().forEach(function(e){return e.tochighlightable=t})})}var u,c=e("utils").throttle,d=e("g3w-ol/controls/interactioncontrol"),p={SELECTED_OR_ALL:!0,FILTERABLE:!0,VISIBLE:!0},f={filtrable:{ows:"WFS"}},e=(ol.inherits(l,d),l.prototype);e.change=function(){this.layers=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],this.setEnable(this.hasVisibleLayers()),this.listenLayersVisibilityChange()},e.checkVisible=function(){return 0<this.layers.length||0<this.getExternalLayers().length},e.setMap=function(e){var t=this;d.prototype.setMap.call(this,e),this._interaction.on("boxstart",function(e){return t._startCoordinate=e.coordinate}),this._interaction.on("boxend",c(function(e){t.bbox=ol.extent.boundingExtent([t._startCoordinate,e.coordinate]),t.dispatchEvent({type:"bboxend",extent:t.bbox}),t._startCoordinate=null,t._autountoggle&&t.toggle()})),this.setEventKey({eventType:"bboxend",eventKey:this.on("bboxend",this.runSpatialQuery)})},e.onSelectLayer=function(t){var e;t?(e=this.layers.find(function(e){return e===t}),this.setEnable(!!e&&e.isVisible())):this.setEnable(this.hasVisibleLayers()),this.toggle(this.isToggled()&&this.getEnable())},e.listenLayersVisibilityChange=function(){var n=this;this.unwatches.forEach(function(e){return e()}),this.unwatches.splice(0),this.layers.forEach(function(t){n.unwatches.push(n.watchLayer(function(){return t.state.visible},function(e){!0===t.state.selected?n.setEnable(e):n.setEnable(n.hasVisibleLayers()),n.toggle(n.isToggled()&&n.getEnable())}))})},e.runSpatialQuery=(u=function*(){if(null!==this.bbox){a.default.closeOpenSideBarComponent();try{yield r.default.getData("query:bbox",{inputs:{bbox:this.bbox,feature_count:o.default.getCurrentProject().getQueryFeatureCount(),addExternal:this.addExternalLayerToResult(),layersFilterObject:p,filterConfig:{spatialMethod:this.getSpatialMethod()},condition:f,multilayers:o.default.getCurrentProject().isQueryMultiLayers(this.name)}})}catch(e){}}},function(){var s=u.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}),e.onAddExternalLayer=function(e){var t=this,n=e.layer,e=e.unWatches;n.tochighlightable=this.isToggled()&&this.getEnable(),e.push(this.watchLayer(function(){return n.selected},function(e){t.setEnable(!0===e?n.visible:t.hasVisibleLayers()),t.toggle(t.isToggled()&&t.getEnable())})),e.push(this.watchLayer(function(){return n.visible},function(){t.setEnable(t.hasVisibleLayers()),t.toggle(t.isToggled()&&t.getEnable())})),this.setEnable(this.hasVisibleLayers())},e.onRemoveExternalLayer=function(){this.setEnable(this.isThereVisibleLayerNotSelected())},e.clear=function(){this.bbox=null},t.exports=l},{"app/constant":5,"g3w-ol/controls/interactioncontrol":53,"services/data":300,"services/gui":302,"store/projects":317,utils:404}],59:[function(e,t,n){var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=s(e("services/gui")),a=s(e("services/data")),o=s(e("store/projects"));function s(e){return e&&e.__esModule?e:{default:e}}function l(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=i.default.getService("map").filterableLayersAvailable({filtrable:{ows:"WFS"}})||[],e=r({},e,{name:"querybydrawpolygon",tipLabel:"sdk.mapcontrols.querybydrawpolygon.tooltip",customClass:i.default.getFontClass("draw"),clickmap:!0,interactionClass:ol.interaction.Draw,interactionClassOptions:{type:"Polygon"},layers:t,help:{title:"sdk.mapcontrols.querybybbox.help.title",message:"sdk.mapcontrols.querybybbox.help.message"}});d.call(this,e),this.setEnable(this.hasVisibleLayers()),this.feature=null}var u,c=e("utils").throttle,d=e("g3w-ol/controls/basequerypolygoncontrol"),e=(ol.inherits(l,d),l.prototype);e.setMap=function(e){var t=this;d.prototype.setMap.call(this,e),this._interaction.on("drawend",c(function(e){t.feature=e.feature,t.dispatchEvent({type:"drawend",feature:t.feature}),t._autountoggle&&t.toggle()})),this.setEventKey({eventType:"drawend",eventKey:this.on("drawend",this.runSpatialQuery)})},e.onSelectLayer=function(t){var e;t?(e=this.layers.find(function(e){return e===t}),this.setEnable(!!e&&e.isVisible())):this.setEnable(this.hasVisibleLayers()),this.toggle(this.isToggled()&&this.getEnable())},e.listenLayersVisibilityChange=function(){var t=this;this.unwatches.forEach(function(e){return e()}),this.unwatches.splice(0),this.layers.forEach(function(e){t.unwatches.push(t.watchLayer(function(){return e.state.visible},function(e){null===t.getSelectedLayer()?t.setEnable(t.hasVisibleLayers()):t.setEnable(t.isSelectedLayerVisible()),t.toggle(t.isToggled()&&t.getEnable())}))})},e.onAddExternalLayer=function(e){var t=this,n=e.layer,e=e.unWatches;e.push(this.watchLayer(function(){return n.selected},function(e){t.setEnable(!0===e?n.visible:t.hasVisibleLayers()),t.toggle(t.isToggled()&&t.getEnable())})),e.push(this.watchLayer(function(){return n.visible},function(e){t.setEnable(!0===n.selected?e:t.hasVisibleLayers()),t.toggle(t.isToggled()&&t.getEnable())})),this.setEnable(this.hasVisibleLayers())},e.onRemoveExternalLayer=function(){this.setEnable(this.hasVisibleLayers())},e.runSpatialQuery=(u=function*(){i.default.closeOpenSideBarComponent();try{yield a.default.getData("query:polygon",{inputs:{feature:this.feature,excludeSelected:null===this.getSelectedLayer(),external:{add:this.addExternalLayerToResult(),filter:{SELECTED:this.isExternalLayerSelected()}},filterConfig:{spatialMethod:this.getSpatialMethod()},multilayers:o.default.getCurrentProject().isQueryMultiLayers(this.name),type:"drawpolygon"},outputs:{show:function(e){e=e.error;return!(void 0!==e&&e)}}})}catch(e){}},function(){var s=u.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}),e.clear=function(){this.feature=null},t.exports=l},{"g3w-ol/controls/basequerypolygoncontrol":49,"services/data":300,"services/gui":302,"store/projects":317,utils:404}],60:[function(e,t,n){var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=c(e("services/gui")),a=c(e("services/data")),o=c(e("store/projects")),s=e("utils/getMapLayersByFilter"),l=e("utils/getAllPolygonGeometryTypes"),u=e("utils/isPolygonGeometryType");function c(e){return e&&e.__esModule?e:{default:e}}function d(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}function p(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function f(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(0,s.getMapLayersByFilter)({QUERYABLE:!0,SELECTED_OR_ALL:!0}),n=i.default.getService("map").filterableLayersAvailable(y),e=r({},e,{offline:!1,enabled:!1,name:"querybypolygon",tipLabel:"sdk.mapcontrols.querybypolygon.tooltip",label:e.label||"",interactionClass:v,layers:n.length?[].concat(p(new Set([].concat(p(n),p(t))))):[],help:{title:"sdk.mapcontrols.querybypolygon.help.title",message:"sdk.mapcontrols.querybypolygon.help.message"}});g.call(this,e),this.data={layer:null,feature:null,coordinates:null}}var h=e("utils").throttle,g=e("g3w-ol/controls/basequerypolygoncontrol"),v=e("g3w-ol/interactions/pickcoordinatesinteraction"),m=(0,l.getAllPolygonGeometryTypes)(),y={filtrable:{ows:"WFS"}},e=(ol.inherits(f,g),f.prototype);e.change=function(){this.layers=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],this.setEnable(!1),this.listenLayersVisibilityChange()},e.checkVisibile=function(e){var t;return!(!e.length||1===e.length)&&(t=e.filter(function(e){return e.isFilterable()}),1===(e=e.filter(function(e){return-1!==m.indexOf(e.getGeometryType())})).length&&1===t.length?t[0]!==e[0]:0<e.length&&0<t.length)},e.setMap=function(e){var t,n=this;g.prototype.setMap.call(this,e),this._interaction.on("picked",h((t=d(function*(e){n.data.coordinates=e.coordinate,n.dispatchEvent({type:"picked",coordinates:n.data.coordinates}),n._autountoggle&&n.toggle()}),function(e){return t.apply(this,arguments)}))),this.setEventKey({eventType:"picked",eventKey:this.on("picked",this.getPolygonFeatureFromCoordinates)}),this.setEnable(!1)},e.onSelectLayer=function(e){e&&e.isQueryable()&&-1!==this.getGeometryTypes().indexOf(e.getGeometryType())?(this.setEnable(this.isThereVisibleLayerNotSelected()),this.toggle(this.isToggled()&&this.getEnable())):(this.setEnable(!1),this.toggle(!1))},e.listenLayersVisibilityChange=function(){var n=this;this.unwatches.forEach(function(e){return e()}),this.unwatches.splice(0),this.layers.forEach(function(t){n.unwatches.push(n.watchLayer(function(){return t.state.visible},function(e){t===n.getSelectedLayer()?n.setEnable(e&&n.isThereVisibleLayerNotSelected()):n.setEnable(n.isThereVisibleLayerNotSelected()),n.toggle(n.isToggled()&&n.getEnable())}))})},e.getPolygonFeatureFromCoordinates=d(function*(){i.default.closeOpenSideBarComponent();try{var e=(yield a.default.getData("query:coordinates",{inputs:{feature_count:o.default.getCurrentProject().getQueryFeatureCount(),coordinates:this.data.coordinates},outputs:{show:function(e){var t=e.data,e=e.query,t=0===(void 0===t?[]:t).length;return e.coordinates=t?e.coordinates:null,t}}})).data,t=void 0===e?[]:e;t.length&&t[0].features.length&&(this.data.feature=t[0].features[0],this.data.layer=t[0].layer,this.runSpatialQuery())}catch(e){}}),e.isThereVisibleLayerNotSelected=function(){var t=this;return!(!this.getSelectedLayer()||!this.isSelectedLayerVisible()||!this.layers.find(function(e){return e!==t.getSelectedLayer()&&e.isVisible()&&e.isFilterable(y.filtrable)})&&!this.getExternalLayers().find(function(e){return e!==t.getSelectedLayer()&&!0===e.visible}))},e.listenPolygonLayersChange=function(){this.listenLayersVisibilityChange()},e.onAddExternalLayer=function(e){var t=this,n=e.layer,e=e.unWatches;(0,u.isPolygonGeometryType)(n.geometryType)&&(e.push(this.watchLayer(function(){return n.selected},function(e){!0===e?t.setEnable(n.visible&&t.isThereVisibleLayerNotSelected()):t.setEnable(!1),t.toggle(t.isToggled()&&t.getEnable())})),e.push(this.watchLayer(function(){return n.visible},function(e){n.selected?t.setEnable(e&&t.isThereVisibleLayerNotSelected()):t.setEnable(t.isThereVisibleLayerNotSelected()),t.toggle(t.isToggled()&&t.getEnable())}))),this.setEnable(this.isThereVisibleLayerNotSelected())},e.onRemoveExternalLayer=function(){this.setEnable(this.isThereVisibleLayerNotSelected())},e.runSpatialQuery=d(function*(){null!==this.data.coordinates&&null!==this.data.feature&&null!==this.data.layer&&(yield a.default.getData("query:polygon",{inputs:{layerName:this.data.layer.getName?this.data.layer.getName():this.data.layer.get("name"),excludeSelected:!0,feature:this.data.feature,external:{add:!0,filter:{SELECTED:!1}},filterConfig:{spatialMethod:this.getSpatialMethod()},multilayers:o.default.getCurrentProject().isQueryMultiLayers(this.name)},outputs:{show:function(e){e=e.error;return!(void 0!==e&&e)}}}))}),e.clear=function(){this.data.layer=this.data.feature=this.data.coordinates=null},t.exports=f},{"g3w-ol/controls/basequerypolygoncontrol":49,"g3w-ol/interactions/pickcoordinatesinteraction":71,"services/data":300,"services/gui":302,"store/projects":317,utils:404,"utils/getAllPolygonGeometryTypes":373,"utils/getMapLayersByFilter":386,"utils/isPolygonGeometryType":412}],61:[function(e,t,n){var r=s(e("services/gui")),i=s(e("store/projects")),a=s(e("services/data")),o=e("utils/mergeOptions");function s(e){return e&&e.__esModule?e:{default:e}}function l(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}function u(){var e={offline:!1,name:"querylayer",tipLabel:"sdk.mapcontrols.query.tooltip",label:(t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).label||"",clickmap:!0,interactionClass:f},t=(0,o.mergeOptions)(t,e);p.call(this,t)}var c,d=e("utils").throttle,p=e("g3w-ol/controls/interactioncontrol"),f=e("g3w-ol/interactions/pickcoordinatesinteraction"),e=(ol.inherits(u,p),u.prototype);e.setMap=function(t){var n=this,r=null;this.on("toggled",function(e){!0!==e.toggled?(ol.Observable.unByKey(r),r=null):null===r&&t&&(r=n.getInteraction().on("picked",d(function(e){return n.runQuery({coordinates:e.coordinate})})))}),this.setEventKey({eventType:"picked",eventKey:this.on("picked",this.runQuery)}),p.prototype.setMap.call(this,t)},e.runQuery=(c=l(function*(e){e=e.coordinates;r.default.closeOpenSideBarComponent();try{var t=i.default.getCurrentProject();yield a.default.getData("query:coordinates",{inputs:{coordinates:e,feature_count:t.getQueryFeatureCount(),query_point_tolerance:t.getQueryPointTolerance(),multilayers:t.isQueryMultiLayers(this.name)}})}catch(e){}}),function(e){return c.apply(this,arguments)}),t.exports=u},{"g3w-ol/controls/interactioncontrol":53,"g3w-ol/interactions/pickcoordinatesinteraction":71,"services/data":300,"services/gui":302,"store/projects":317,utils:404,"utils/mergeOptions":417}],62:[function(e,t,n){function r(e){this._toggled=!0,e=(this._startCoordinate=null,i.mergeOptions)(e,{name:"reset",tipLabel:"Pan",label:""}),a.call(this,e)}var i=e("utils/mergeOptions"),a=e("g3w-ol/controls/interactioncontrol");ol.inherits(r,a),(t.exports=r).prototype._postRender=function(){this.toggle(!0)}},{"g3w-ol/controls/interactioncontrol":53,"utils/mergeOptions":417}],63:[function(e,t,n){function r(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.isMobile=e.isMobile||!1,e.target="scale-control",ol.control.Control.call(this,e)}var i=e("app/constant"),l=e("utils/getResolutionFromScale"),u=e("utils/getScaleFromResolution"),c=e("core/i18n/i18n.service").t,e=(ol.inherits(r,ol.control.Control),(t.exports=r).prototype);e.offline=!0,e.changelayout=function(e){this.position,$(this.element)},e.layout=function(n){var r=this,i=!1,a=!1,t=$(this.element).children("select").select2({tags:!0,dropdownParent:$(n.getTargetElement()),width:"120px",height:"20px",language:{noResults:function(e){return c("sdk.mapcontrols.scale.no_valid_scale")}},minimumResultsForSearch:this.isMobile?-1:0,createTag:function(e){var t=null,n=void 0;return-1!==e.term.indexOf("1:")?n=e.term.split("1:")[1]:Number.isInteger(Number(e.term))&&0<Number(e.term)&&+(n=Number(e.term))<=r.scales[0]&&(t={id:n,text:"1:"+e.term,new:!0},o()),t}});function o(){t.find("option").each(function(e,t){return-1===r.scales.indexOf(+t.value)&&$(t).remove()})}function s(e){(t.find("option[value='"+e.id+"']").length?t.val(e.id):(o(),e=new Option(e.text,e.id,!0,!0),t.append(e))).trigger("change")}n.on("change:size",function(){return t.select2("close")}),n.on("moveend",function(){var e,t;i?(t=(e=this.getView()).getResolution(),e=e.getProjection().getUnits(),s({id:t=parseInt((0,u.getScaleFromResolution)(t,e)),text:"1:"+t,new:!0}),i=!1):a=!1});function e(){n.getView().on("change:resolution",function(){return i=!a})}e(),n.on("change:view",e),t.on("select2:select",function(e){a=!0;var e=e.params.data,t=(e.new&&(o(),s(e)),n.getView().getProjection().getUnits()),e=+e.id,e=(0,l.getResolutionFromScale)(e,t);n.getView().setResolution(e)})},e._setScales=function(e){var t=e.getView().getProjection().getUnits(),e=e.getView().getResolution(),n=parseInt((0,u.getScaleFromResolution)(e,t));this.scales=i.PRINT_SCALES.map(function(e){return e.value}).filter(function(e){return e<n}),this.scales.unshift(n),this._createControl()},e._createControl=function(){var e,t=document.createElement("div"),n=document.createElement("select"),r=document.createElement("optgroup");r.label="",this.scales.forEach(function(e,t){var n=document.createElement("option");n.value=e,n.text="1:"+e,n.selected=0===t,r.appendChild(n)}),n.appendChild(r),this.isMobile||((e=document.createElement("optgroup")).label="Custom",n.appendChild(e)),t.appendChild(n),this.element=t,$(this.element).css("height","20px")},e.setMap=function(e){e&&(this._setScales(e),this.layout(e),ol.control.Control.prototype.setMap.call(this,e))}},{"app/constant":5,"core/i18n/i18n.service":12,"utils/getResolutionFromScale":394,"utils/getScaleFromResolution":395}],64:[function(e,t,n){var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=e("services/gui"),a=(i=i)&&i.__esModule?i:{default:i};var o=e("utils").sameOrigin,s=e("g3w-ol/controls/onclickcontrol");function l(){var e=r({name:"maptoimage",tipLabel:"Screenshot",label:"",toggled:!1,visible:!0,layers:[]},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{});this.layers=e.layers,s.call(this,e),this.setVisible(this.checkVisible(this.layers)),this.isVisible()&&(a.default.getService("map").onafter("loadExternalLayer",this._addLayer.bind(this)),a.default.getService("map").onafter("unloadExternalLayer",this._removeLayer.bind(this)))}ol.inherits(l,s);i=l.prototype;function u(e){var t,n=void 0;return!((t=e).getVisible&&!t.getVisible()||e instanceof ol.layer.Vector)&&((t=e)instanceof ol.layer.Tile||t instanceof ol.layer.Image?(n=e.getSource().getUrl())&&!o(n,location):!(!(t=e).getConfig().source||!t.getConfig().source.external)&&(n=e.getConfig().source.url)&&!o(n,location))}i._addLayer=function(e){var t=this;this.layers.push(e),this.change(this.layers),e.on("change:visible",function(){return t.change(t.layers)})},i._removeLayer=function(t){this.layers=this.layers.filter(function(e){return e!==t}),this.change(this.layers)},i.change=function(){this.setVisible(this.checkVisible(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]))},i.checkVisible=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return this.isVisible()&&!e.some(u)},t.exports=l},{"g3w-ol/controls/onclickcontrol":57,"services/gui":302,utils:404}],65:[function(e,t,n){var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=u(e("store/application-state")),a=u(e("services/gui")),o=e("utils/mergeOptions"),s=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/StreetView.vue")),l=u(e("core/g3w-component"));function u(e){return e&&e.__esModule?e:{default:e}}function c(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n={offline:!1,visible:!0,name:"streetview",tipLabel:"StreetView",clickmap:!0,label:"",interactionClass:f},r=(this.key=i.default.keys.vendorkeys.google,this.keyError,this.key&&d.get({url:h+"streetview?location=0,0&size=456x456&key="+this.key}).catch(function(e){return t.keyError=e.responseText}),$script(h+"js?"+(this.key?"key="+this.key:"")),this._sv=null,this._panorama=null,this._map=null,this._projection=null,this._lastposition=null,this._streetViewFeature=new ol.Feature,new ol.source.Vector({features:[]}));this.active=!1,this._layer=new ol.layer.Vector({source:r,style:function(e){var e=e.getGeometry().getCoordinates(),t=(this._lastposition=this._lastposition||e,e[0]-this._lastposition[0]),n=e[1]-this._lastposition[1],n=-Math.atan2(n,t),t=[new ol.style.Style({text:new ol.style.Text({text:"",font:"bold 18px icomoon",fill:new ol.style.Fill({color:"#ffffff"})})}),new ol.style.Style({image:new ol.style.Icon({src:"/static/client/images/streetviewarrow.png",rotation:n})})];return this._lastposition=e,t}}),e=(0,o.mergeOptions)(e,n),p.call(this,e)}var d=e("utils").XHR,p=e("g3w-ol/controls/interactioncontrol"),f=e("g3w-ol/interactions/pickcoordinatesinteraction"),h="https://maps.googleapis.com/maps/api/",e=(ol.inherits(c,p),c.prototype);e.setProjection=function(e){this._projection=e},e.setPosition=function(e){var n,t=this,r=this;this.active=!0;this._sv||(this._sv=new google.maps.StreetViewService),this._sv.getPanorama({location:e},function(e,t){r._panorama=new google.maps.StreetViewPanorama(document.getElementById("streetview"),{imageDateControl:!0}),r._panorama.addListener("position_changed",function(){var e;r.isToggled()&&(e=ol.proj.transform([this.getPosition().lng(),this.getPosition().lat()],"EPSG:4326",r._projection.getCode()),r._streetViewFeature.setGeometry(new ol.geom.Point(e)),(n=r._map.getPixelFromCoordinate(e))[0]+15>r._map.getSize()[0]||n[1]+15>r._map.getSize()[1]||n[0]<15||n[1]<15)&&r._map.getView().setCenter(e)}),e&&e.location&&(r._panorama.setPov({pitch:0,heading:0}),r._panorama.setPosition(e.location.latLng))}).then(function(e){void 0===e&&a.default.closeContent()}).catch(function(){return t.toggle()})},e.setMap=function(e){var t=this;this._map=e,p.prototype.setMap.call(this,e),this.setProjection(this._map.getView().getProjection()),this._map.addLayer(this._layer),this._interaction.on("picked",function(e){e=e.coordinate;t.showStreetView(e),t._autountoggle&&t.toggle()})},e.showStreetView=function(e){var t=ol.proj.transform(e,this._map.getView().getProjection().getCode(),"EPSG:4326"),t=r(t,2),n=t[0],t=t[1];this.key?(a.default.setContent({title:"StreetView",content:new l.default({internalComponent:new(Vue.extend(s))({keyError:this.keyError})})}),this.keyError||this.setPosition({lng:n,lat:t})):(this._streetViewFeature.setGeometry(new ol.geom.Point(e)),window.open("https://www.google.com/maps/@?api=1&map_action=pano&viewpoint="+t+","+n))},e.clearMarker=function(){this._streetViewFeature.setGeometry(null)},e.clear=function(){this._layer.getSource().clear(),this._streetViewFeature.setGeometry(null),this.clearMarker(),this._panorama=null,this.active&&a.default.closeContent(),this.active=!1},e.toggle=function(e){p.prototype.toggle.call(this,e),this.isToggled()?this._layer.getSource().addFeatures([this._streetViewFeature]):this.clear()},t.exports=c},{"components/StreetView.vue":234,"core/g3w-component":8,"g3w-ol/controls/interactioncontrol":53,"g3w-ol/interactions/pickcoordinatesinteraction":71,"services/gui":302,"store/application-state":310,utils:404,"utils/mergeOptions":417}],66:[function(e,t,n){function r(e){this._startCoordinate=null;var t={name:"zoombox",tipLabel:"Zoom to box",label:"",interactionClass:ol.interaction.DragBox};e=Object.assign({},e,t),i.call(this,e)}var i=e("g3w-ol/controls/interactioncontrol");ol.inherits(r,i),(t.exports=r).prototype.setMap=function(e){var n=this;i.prototype.setMap.call(this,e),this._interaction.on("boxstart",function(e){return n._startCoordinate=e.coordinate}),this._interaction.on("boxend",function(e){var t=n._startCoordinate,e=e.coordinate,t=ol.extent.boundingExtent([t,e]);n.dispatchEvent({type:"zoomend",extent:t}),n._startCoordinate=null,n._autountoggle&&n.toggle()})}},{"g3w-ol/controls/interactioncontrol":53}],67:[function(e,t,n){function r(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.geometryType="Polygon",i.call(this,e)}var i=e("g3w-ol/interactions/measureinteraction");ol.inherits(r,i),t.exports=r},{"g3w-ol/interactions/measureinteraction":70}],68:[function(e,t,n){function r(e,t,n,r){this.type=e,this.features=n,this.coordinate=r}function i(e){ol.interaction.Pointer.call(this,{handleDownEvent:i.handleDownEvent_,handleMoveEvent:i.handleMoveEvent_,handleUpEvent:i.handleUpEvent_,handleEvent:i.handleEvent_}),this.previousCursor_=void 0,this.startCursor_=void 0,this.lastCoordinate_=null,this.features_=void 0!==e.features?e.features:null,this.layer_=void 0!==e.layer?e.layer:null,this.map_=null}ol.inherits(i,ol.interaction.Pointer),i.handleEvent_=function(e){return"keydown"!=e.type?ol.interaction.Pointer.handleEvent.call(this,e):this.features_.getArray().length&&46==e.originalEvent.keyCode?(this.dispatchEvent(new r("deleteend",this.layer_,this.features_,event.coordinate)),!0):void 0},i.handleDownEvent_=function(e){return this.lastFeature_=this.featuresAtPixel_(e.pixel,e.map),!!this.lastFeature_&&(i.handleMoveEvent_.call(this,e),this.dispatchEvent(new r("deleteend",this.layer_,this.features_,e.coordinate)),!0)},i.handleMoveEvent_=function(e){var n=this,t=(this.map_=e.map,this.map_.getTargetElement());void 0===this.startCursor_&&(this.startCursor_=t.style.cursor),this.map_.forEachFeatureAtPixel(e.pixel,function(e,t){return e=t==n.layer_?e:null})?(this.previousCursor_=t.style.cursor,t.style.cursor="pointer"):(t.style.cursor=void 0!==this.previousCursor_?this.previousCursor_:"",this.previousCursor_=void 0)},i.prototype.featuresAtPixel_=function(e,t){var n=null,t=t.forEachFeatureAtPixel(e,function(e){return e});return n=this.features_&&this.features_.getArray().includes(t)?t:n},i.prototype.clear=function(){this.map_&&(this.map_.getTargetElement().style.cursor=this.startCursor_)},t.exports=i},{}],69:[function(e,t,n){function r(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.geometryType="LineString",i.call(this,e)}var i=e("g3w-ol/interactions/measureinteraction");ol.inherits(r,i),t.exports=r},{"g3w-ol/interactions/measureinteraction":70}],70:[function(e,t,n){function r(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(this._helpTooltip,this._measureTooltipElement,this._measureTooltip,this._featureGeometryChangelistener,this._poinOnMapMoveListener,this.testTooltip,this._helpTooltipElement,this._helpMsg=e.help,this._projection=e.projection,this.feature=e.feature,e.drawColor||"rgba(0, 0, 0, 0.5)"),t=((0,l.needUseSphereMethods)(this._projection),new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ol.style.Stroke({color:t,lineDash:[10,10],width:3}),image:new ol.style.Circle({radius:5,stroke:new ol.style.Stroke({color:"rgba(0, 0, 0, 0.7)"}),fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"})})})),e=e.geometryType||"LineString",n=new ol.source.Vector;this._map=null,this._feature=null,this._layer=new ol.layer.Vector({source:n,style:function(){return[new ol.style.Style({stroke:new ol.style.Stroke({lineDash:[10,10],width:3}),fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"})})]}}),ol.interaction.Draw.call(this,{source:n,type:e,style:t}),this.set("beforeRemove",this.clear),this.set("layer",this._layer),this.on("drawstart",this._drawStart),this.on("drawend",this._drawEnd)}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=e("utils/createMeasureTooltip"),o=e("utils/setMeasureTooltipStatic"),s=e("utils/removeMeasureTooltip"),l=e("utils/needUseSphereMethods"),u=e("core/i18n/i18n.service").t,e=(ol.inherits(r,ol.interaction.Draw),r.prototype);e.setDrawMessage=function(e){this._helpMsg=e},e.clear=function(){this._layer.getSource().clear(),this._clearMessagesAndListeners(),this._map&&((0,s.removeMeasureTooltip)(i({map:this._map},this.measureTooltip)),this.measureTooltip=null,this._map.removeLayer(this._layer))},e._clearMessagesAndListeners=function(){this._feature=null,this._map&&(this._measureTooltipElement=null,this._helpTooltipElement.innerHTML="",this._helpTooltipElement.classList.add("hidden"),ol.Observable.unByKey(this._featureGeometryChangelistener),ol.Observable.unByKey(this._poinOnMapMoveListener),$(document).off("keydown",this._keyDownEventHandler))},e._removeLastPoint=function(e){var t=this._feature.getGeometry();46===e.keyCode&&(t instanceof ol.geom.Polygon&&2<t.getCoordinates()[0].length||t instanceof ol.geom.LineString&&1<t.getCoordinates().length)&&this.removeLastPoint()},e._drawStart=function(e){var n=this;this._map=this.getMap(),this._map.removeLayer(this._layer),this._feature=e.feature,this.feature&&this._feature.setGeometry(this.feature.getGeometry()),this._keyDownEventHandler=this._removeLastPoint.bind(this),$(document).on("keydown",this._keyDownEventHandler),this._layer.getSource().clear(),this._poinOnMapMoveListener=this._map.on("pointermove",function(e){var t;e.dragging||n._feature&&n._helpMsg&&(t=u(n._helpMsg),n._helpTooltipElement.innerHTML=t,n._helpTooltip.setPosition(e.coordinate),n._helpTooltipElement.classList.remove("hidden"))}),this._createHelpTooltip(),this._createMeasureTooltip()},e._drawEnd=function(){(0,o.setMeasureTooltipStatic)(this.measureTooltip.tooltip),this._clearMessagesAndListeners(),this._map.addLayer(this._layer)},e._createHelpTooltip=function(){this._helpTooltipElement&&this._helpTooltipElement.parentNode.removeChild(this._helpTooltipElement),this._helpTooltip&&this._map.removeOverlay(this._helpTooltip),this._helpTooltipElement=document.createElement("div"),this._helpTooltipElement.className="mtooltip hidden",this._helpTooltip=new ol.Overlay({element:this._helpTooltipElement,offset:[15,0],positioning:"center-left"}),this._map.addOverlay(this._helpTooltip)},e._createMeasureTooltip=function(){this.measureTooltip&&(0,s.removeMeasureTooltip)(i({},this.measureTooltip,{map:this._map})),this.measureTooltip=(0,a.createMeasureTooltip)({map:this._map,feature:this._feature})},t.exports=r},{"core/i18n/i18n.service":12,"utils/createMeasureTooltip":348,"utils/needUseSphereMethods":420,"utils/removeMeasureTooltip":431,"utils/setMeasureTooltipStatic":438}],71:[function(e,t,n){function r(e,t){this.type=e,this.coordinate=t}function i(e){this.previousCursor_=null,this._centerMap=null,ol.interaction.Pointer.call(this,{handleDownEvent:i.handleDownEvent_,handleUpEvent:i.handleUpEvent_,handleMoveEvent:i.handleMoveEvent_})}var a="picked";ol.inherits(i,ol.interaction.Pointer),i.handleDownEvent_=function(e){var t=this;return this._centerMap=e.map.getView().getCenter(),setTimeout(function(){t._centerMap===e.map.getView().getCenter()&&i.handleUpEvent_.call(t,e)},300),!1},i.handleUpEvent_=function(e){return this.dispatchEvent(new r(a,e.coordinate)),!1},i.handleMoveEvent_=function(e){return e.map.getTargetElement().style.cursor="pointer",!0},i.prototype.shouldStopEvent=function(){return!1},i.prototype.setActive=function(e){var t=this.getMap();t&&(t.getTargetElement().style.cursor=""),ol.interaction.Pointer.prototype.setActive.call(this,e)},i.prototype.setMap=function(e){e||(this.getMap().getTargetElement().style.cursor=""),ol.interaction.Pointer.prototype.setMap.call(this,e)},t.exports=i},{}],72:[function(e,t,n){function r(e,t,n,r){this.type=e,this.feature=r,this.coordinate=t,this.layer=n}function i(){var n=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(ol.interaction.Pointer.call(this,{handleDownEvent:i.handleDownEvent_,handleUpEvent:i.handleUpEvent_,handleMoveEvent:i.handleMoveEvent_}),e.features);this.features_=Array.isArray(t)&&t.length&&t||null,this.layers_=e.layers||null,this.pickedFeature_=null,this.pickedLayer_=null,this.layerFilter_=function(e){var t=n.layers_.includes(e);return n.pickedLayer_=t&&e,t}}var a="picked";ol.inherits(i,ol.interaction.Pointer),i.handleDownEvent_=function(e){return this.pickedFeature_=this.featuresAtPixel_(e.pixel,e.map),this.pickedFeature_},i.handleUpEvent_=function(e){return this.pickedFeature_&&this.dispatchEvent(new r(a,e.coordinate,this.pickedLayer_,this.pickedFeature_)),!0},i.handleMoveEvent_=function(e){var t=this.featuresAtPixel_(e.pixel,e.map);e.map.getTargetElement().style.cursor=t?"pointer":""},i.prototype.featuresAtPixel_=function(e,t){var n=this,r=null,t=t.forEachFeatureAtPixel(e,function(e){return!n.features_||-1<n.features_.indexOf(e)?e:null},{layerFilter:this.layerFilter_,hitTolerance:isMobile&&isMobile.any?10:0});return r=t?t:r},i.prototype.shouldStopEvent=function(){return!1},i.prototype.setMap=function(e){e||(this.getMap().getTargetElement().style.cursor=""),ol.interaction.Pointer.prototype.setMap.call(this,e)},t.exports=i},{}],73:[function(e,t,n){var c=e("g3w-ol/layers/rasters"),e={OSM:{}};e.OSM.get=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.title,n=e.id,e=e.url;return new ol.layer.Tile({source:new ol.source.OSM({url:e}),id:n||"osm",title:t||"OSM",basemap:!0})},e.TMS={get:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.visible,n=void 0!==t&&t,t=e.url,r=void 0===t?null:t,t=e.source_type,i=e.minZoom,a=e.maxZoom,o=e.projection,s=e.attributions,e=e.crossOrigin,l=void 0===e?"anonymous":e,u=void 0;switch(void 0===t?"xyz":t){case"xyz":u=c.XYZLayer({url:r,visible:n,minZoom:i,maxZoom:a,attributions:s,projection:o,crossOrigin:l});break;case"arcgismapserver":u=c.TiledArgisMapServer({url:r,visible:n,projection:o,attributions:s})}return u}},e.WMS={get:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.url,n=e.projection,r=e.attributions,i=e.layers,a=e.singleTile,e=e.opacity;return c.WMSLayer({url:t,projection:n,attributions:r,layers:i,tiled:void 0!==a&&a,opacity:void 0===e?1:e})}},e.WMTS={get:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.url,n=e.layer,r=(e.visible,e.attributions),i=e.matrixSet,a=e.projection,o=e.requestEncoding,s=e.style,s=void 0===s?"default":s,l=e.format,l=void 0===l?"image/png":l,u=e.opacity,u=void 0===u?.7:u,c=e.grid,e=e.grid_extent;if(i){for(var d=a.getExtent(),p=new Array(14),f=ol.extent.getWidth(d)/256,h=new Array(14),g=0;g<14;++g)p[g]=f/Math.pow(2,g),h[g]=g;return new ol.layer.Tile({opacity:u,source:new ol.source.WMTS({url:t,projection:a,layer:n,matrixSet:i,requestEncoding:o,format:l,attributions:r,tileGrid:new ol.tilegrid.WMTS({origin:ol.extent.getTopLeft(d),resolutions:p,matrixIds:h}),style:s})})}if(c&&e)return u=ol.tilegrid.createXYZ({extent:e}).getResolutions(),new ol.layer.Tile({source:new ol.source.WMTS({url:t,layer:n,matrixSet:c,format:l||"png",projection:a,tileGrid:new ol.tilegrid.WMTS({origin:ol.extent.getTopLeft(e),resolutions:u,matrixIds:u.map(function(e,t){return t})}),style:s,transparent:!1})})}},e.BING={},e.BING.get=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.imagerySet||"Aerial";return new ol.layer.Tile({name:t,visible:!1,preload:1/0,source:new ol.source.BingMaps({imagerySet:t,key:e.key}),basemap:!0})},t.exports=e},{"g3w-ol/layers/rasters":74}],74:[function(e,t,n){function g(e){var a=void 0===(t=e.method)?"GET":t,t=void 0===(t=e.type)?"image":t,e=void 0===(e=e.sourceOptions)?{}:e;window.URL=window.URL||window.webkitURL,e[t+"LoadFunction"]=function(t,e){var n=new XMLHttpRequest,r=e.split("?"),r=o(r,2),i=r[0],r=r[1];n.open(a,"POST"===a&&i||e),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),n.responseType="blob",n.onload=function(){var e=this.response;void 0!==e?t.getImage().src=window.URL.createObjectURL(e):t.setState(ol.TileState.ERROR)},n.onerror=function(){image.setState(ol.TileState.ERROR)},n.send("POST"===a&&r)}}var o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},v=(0,e("utils/getDPI").getDPI)(),r={};r.TiledWMSLayer=function(e,t){return"mapproxy"===e.cache_provider?r.TiledMapProxyWMSLayer(e):r._WMSLayer({layerObj:e,extraParams:t||{},tiled:!0})},r.TiledMapProxyWMSLayer=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=ol.tilegrid.createXYZ({extent:e.cache_grid_extent}).getResolutions();return new ol.layer.Tile({source:new ol.source.WMTS({url:e.url,layer:e.cache_layer,matrixSet:e.cache_grid,format:e.cache_format||"png",projection:e.layers[0].getProjection(),tileGrid:new ol.tilegrid.WMTS({origin:ol.extent.getTopLeft(e.cache_grid_extent),resolutions:t,matrixIds:t.map(function(e,t){return t})}),style:e.style||"",transparent:!1})})},r.WMSLayer=function(e){return r._WMSLayer({layerObj:e,extraParams:1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},method:2<arguments.length&&void 0!==arguments[2]?arguments[2]:"GET"})},r.ImageArgisMapServer=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return new ol.layer.Image({source:new ol.source.ImageArcGISRest({ratio:e.ratio,params:{FORMAT:e.format},url:e.url})})},r.TiledArgisMapServer=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.url,n=e.visible,n=void 0===n||n,r=e.extent,i=e.projection,a=e.attributions,e=e.crossOrigin,t=new ol.source.TileArcGISRest({url:t,projection:i,attributions:a,crossOrigin:e});return new ol.layer.Tile({extent:r,visible:n,source:t})},r._WMSLayer=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layerObj,n=e.method,n=void 0===n?"GET":n,r=e.extraParams,e=e.tiled,e=void 0!==e&&e,i=t.iframe_internal,i=void 0!==i&&i,a=t.layers,o=t.version,s=t.sld_version,l=t.id,u=t.name,c=t.opacity,c=void 0===c?1:c,d=t.visible,p=t.extent,f=t.maxResolution,h=t.format,a={LAYERS:void 0===a?"":a,VERSION:void 0===o?"1.3.0":o,TRANSPARENT:!0,SLD_VERSION:void 0===s?"1.1.0":s,DPI:v},o=(void 0!==h&&(a.FORMAT=h),{url:t.url,params:Object.assign({},a,r),ratio:1,projection:t.projection?t.projection.getCode():null}),s=(!i&&"POST"!==n||g({method:n,sourceOptions:o,type:"image"}),{id:l,name:u,opacity:c,visible:d,extent:p,maxResolution:f});return new(e?(s.source=new ol.source.TileWMS(o),ol.layer.Tile):(s.source=new ol.source.ImageWMS(o),ol.layer.Image))(s)},r.XYZLayer=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.iframe_internal||!1,n=e.url,r=e.projection,i=e.maxZoom,a=e.minZoom,o=e.visible,o=void 0===o||o,s=e.crossOrigin,e=e.cache_provider;if(n)return n={url:n,maxZoom:i,minZoom:a,projection:r,crossOrigin:s},t&&g({method:1<arguments.length&&void 0!==arguments[1]?arguments[1]:"GET",type:"tile",sourceOptions:n}),"degrees"!==r.getUnits()&&"mapproxy"!==e||(a=r.getExtent(),(s=ol.tilegrid.createXYZ({extent:a,maxZoom:i}).getResolutions()).splice(0,1),n.tileGrid=new ol.tilegrid.TileGrid({extent:a,resolutions:s})),new ol.layer.Tile({visible:o,projection:r,source:new ol.source.XYZ(n)})},t.exports=r},{"utils/getDPI":377}],75:[function(e,t,n){function r(){if(!(i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).crs)return null;var e=(i=i.crs).epsg,t=i.proj4,n=void 0!==(n=i.geographic)&&n,r=void 0!==(r=i.axisinverted)&&r,i=i.extent;t&&proj4.defs(e,t),this._axisOrientation=r?"neu":"enu",ol.proj.Projection.call(this,{code:e,extent:i,axisOrientation:this._axisOrientation,units:n?"degrees":"m"})}ol.inherits(r,ol.proj.Projection);var i=r.prototype;i.getAxisOrientation=function(){return this._axisOrientation},i.isInvertedAxisOrientation=function(){return"neu"===this._axisOrientation},i.getOlProjection=function(){},t.exports=r},{}],76:[function(e,t,n){var a=e("app/constant"),o=e("utils/normalizeEpsg"),r=e("g3w-ol/projection/projection"),s=e("utils").XHR;t.exports={isRegistered:function(e){return ol.proj.get(e)},get:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=this.isRegistered(e.epsg);return t||(t=new r({crs:e}),ol.proj.addProjection(t),ol.proj.proj4.register(proj4),t)},registerProjection:function(e){var i=this;return new Promise(function(n,t){var r=i.isRegistered(e);r?n(r):s.get({url:""+a.API_BASE_URLS.CRS+e.split(":")[1]}).then(function(e){var t=e.result,e=e.data;t&&(e.epsg=(0,o.normalizeEpsg)(e.epsg),r=i.get(e),ol.proj.proj4.register(proj4),n(r))}).catch(function(e){return t(e)})})}}},{"app/constant":5,"g3w-ol/projection/projection":75,utils:404,"utils/normalizeEpsg":422}],77:[function(e,t,n){var e=e("components/g3w-catalog"),e=(e=e)&&e.__esModule?e:{default:e};t.exports=e.default},{"components/g3w-catalog":243}],78:[function(e,t,n){var e=e("components/g3w-changemapmenu"),e=(e=e)&&e.__esModule?e:{default:e};t.exports=e.default},{"components/g3w-changemapmenu":244}],79:[function(e,t,n){var e=e("core/g3w-component"),e=(e=e)&&e.__esModule?e:{default:e};t.exports=e.default},{"core/g3w-component":8}],80:[function(e,t,n){var r=l(e("components/FieldText.vue")),i=l(e("components/FieldLink.vue")),a=l(e("components/FieldImage.vue")),o=l(e("components/FieldGeo.vue")),s=l(e("components/FieldMedia.vue")),e=l(e("components/FieldVue.vue"));function l(e){return e&&e.__esModule?e:{default:e}}r={simple_field:r.default,text_field:r.default,link_field:i.default,image_field:a.default,geo_field:o.default,photo_field:a.default,media_field:s.default,vue_field:e.default};t.exports=r},{"components/FieldGeo.vue":143,"components/FieldImage.vue":144,"components/FieldLink.vue":145,"components/FieldMedia.vue":146,"components/FieldText.vue":147,"components/FieldVue.vue":148}],81:[function(e,t,n){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("store/catalog-layers"),a=(i=i)&&i.__esModule?i:{default:i};var o=e("./fields"),s=e("utils").toRawType,l=/^(https?:\/\/[^\s]+)/g,u=/[^\s]+.(png|jpg|jpeg|gif)$/g,c="simple",d="geo",p="link",f="photo",h="image",g="vue";t.exports={getType:function(e){var t=e.type;return"vue"!==t&&((e=!(e=e.value)||"Object"!==s(e)||e.coordinates||e.vue?e:e.value)?"object"==(void 0===e?"undefined":r(e))?e.coordinates?t=d:e.vue&&(t=g):t=e&&Array.isArray(e)?e.length&&e[0].photo?f:c:e.toString().toLowerCase().match(u)?f:e.toString().match(l)?p:c:t=c),t+"_field"},isSimple:function(e){return c+"_field"===this.getType(e)},isLink:function(e){return p+"_field"===this.getType(e)},isImage:function(e){return h+"_field"===this.getType(e)},isPhoto:function(e){return f+"_field"===this.getType(e)},isVue:function(e){return g+"_field"===this.getType(e)},add:function(e){var t=e.type,e=e.field;o[t]=e},remove:function(e){delete o[e]},changeConfigFieldType:function(e){var t=e.layerId,e=e.field,e=void 0===e?{}:e;a.default.getLayerById(t).changeConfigFieldType(e)},resetConfigFieldType:function(e){var t=e.layerId,e=e.field,e=void 0===e?{}:e;a.default.getLayerById(t).resetConfigField(e)}}},{"./fields":80,"store/catalog-layers":311,utils:404}],82:[function(e,t,n){var r=e("services/data"),p=(r=r)&&r.__esModule?r:{default:r},f=e("utils/convertFeatureToGEOJSON");function i(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var r=e("utils"),a=r.inherit,s=r.base;function l(){var e=this;this.state=null,this.eventBus=new Vue,this.force={update:!1,valid:!1},this.layer,this.setters={setInitForm:function(){this._setInitForm(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},setFormStructure:function(e){this.state.formstructure=e},setFormFields:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];this.state.fields=e,this.handleFieldsWithExpression(e)},setupFields:function(){this._setupFields()},setFormData:function(e){this.setFormFields(e)},setField:function(e){},setState:function(e){this._setState(e)},addActionsForForm:function(e){},postRender:function(e){}},s(this),this.init=function(){this._setInitForm(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},this._setInitForm=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.fields,n=e.feature,r=e.parentData,i=e.layer,a=e.title,a=void 0===a?"Form":a,o=e.formId,s=e.name,l=e.buttons,l=void 0===l?{}:l,u=e.context_inputs,c=e.isnew,d=e.footer,d=void 0===d?{}:d,p=e.headerComponent;this.layer=i,this.feature=n.clone(),this.title=a,this.formId=o,this.name=s,this.buttons=l,this.context_inputs=u,this.parentData=r,this.headerComponent=p,this.state={layerid:i.getId(),loading:!1,components:[],disabledcomponents:[],component:null,headers:[],currentheaderid:null,fields:null,buttons:this.buttons,disabled:!1,isnew:c,valid:!0,update:n.isNew(),tovalidate:{},feature:n,componentstovalidate:{},footer:d,ready:!1},this.force.update=n.isNew(),this.filter_expression_fields_dependencies={},this.default_expression_fields_dependencies={},this.default_expression_fields_on_update=[],this.listenChangeInput=!0,this.setFormFields(t),this.layer&&e.formStructure&&this.setFormStructure(this.layer.getLayerEditingFormStructure(t))},this.eventBus.$on("set-loading-form",function(){return e.state.loading=0<arguments.length&&void 0!==arguments[0]&&arguments[0]})}a(l,e("core/g3wobject"));r=l.prototype;r.setReady=function(){this.state.ready=0<arguments.length&&void 0!==arguments[0]&&arguments[0]},r.changeInput=function(e){!0===this.listenChangeInput&&(this.evaluateFilterExpressionFields(e),this.evaluateDefaultExpressionFields(e),this.isValid(e),this.isUpdated(e))},r.isUpdated=function(e){this.state.update=this.force.update||(this.state.update?!!this.state.fields.find(function(e){return e.update}):e.update)},r.setUpdate=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).force;this.force.update=void 0!==t&&t,this.state.update=this.force.update||e,!1===this.state.update&&this.state.fields.forEach(function(e){e._value=e.value})},r.evaluateDefaultExpressionFields=function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=this.default_expression_fields_dependencies[e.name];n&&(this.feature.set(e.name,e.value),n.forEach(function(e){l._getDefaultExpression({parentData:t.parentData,qgs_layer_id:t.layer.getId(),field:t._getField(e),feature:t.feature})}))},r.evaluateFilterExpressionFields=function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=this.filter_expression_fields_dependencies[e.name];n&&((e=this._getField(e.name))&&this.feature.set(e.name,e.value),n.forEach(function(e){l._getFilterExpression({parentData:t.parentData,qgs_layer_id:t.layer.getId(),field:t._getField(e),feature:t.feature})}))},r._handleFieldWithFilterExpression=function(t,e){var n,r,i=this;e&&(n=void 0===(n=e.referencing_fields)?[]:n,e=void 0===(e=e.referenced_columns)?[]:e,r=new Set,[].concat(o(e),o(n)).forEach(function(e){return r.add(e)}),r.forEach(function(e){void 0===i.filter_expression_fields_dependencies[e]&&(i.filter_expression_fields_dependencies[e]=[]),i.filter_expression_fields_dependencies[e].push(t.name)}),l._getFilterExpression({parentData:this.parentData,qgs_layer_id:this.layer.getId(),field:t,feature:this.feature}))},r._handleFieldWithDefaultExpression=function(t,e){var n,r,i,a=this;e&&(n=void 0===(n=e.referencing_fields)?[]:n,r=void 0===(r=e.referenced_columns)?[]:r,(e=void 0!==(e=e.apply_on_update)&&e)||this.state.isnew)&&(i=new Set,[].concat(o(r),o(n)).forEach(function(e){return i.add(e)}),e&&(this.default_expression_fields_on_update.push(t),i.forEach(function(e){void 0===a.default_expression_fields_dependencies[e]&&(a.default_expression_fields_dependencies[e]=[]),a.default_expression_fields_dependencies[e].push(t.name)})),this.state.isnew)&&l._getDefaultExpression({field:t,feature:this.feature,qgs_layer_id:this.layer.getId(),parentData:this.parentData})},r.handleFieldsWithExpression=function(){var n=this;(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(e){var t=e.input.options,t=void 0===t?{}:t;n._handleFieldWithFilterExpression(e,t.filter_expression),n._handleFieldWithDefaultExpression(e,t.default_expression)}),Object.keys(this.filter_expression_fields_dependencies).forEach(function(e){n.evaluateFilterExpressionFields({name:e})})},r.setCurrentFormPercentage=function(e){this.layer.setFormPercentage(e)},r.setLoading=function(){this.state.loading=0<arguments.length&&void 0!==arguments[0]&&arguments[0]},r.setValidComponent=function(e){var t=e.id,e=e.valid;this.state.componentstovalidate[t]=e,this.isValid()},r.getValidComponent=function(e){return this.state.componentstovalidate[e]},r.isValid=function(e){var t,n=this;if(e){if(!e.validate.mutually||e.validate.required||e.validate.empty||(e.validate._valid=e.validate.valid,e.validate.mutually_valid=e.validate.mutually.reduce(function(e,t){return e&&n.state.tovalidate[t].validate.empty},!0),e.validate.valid=e.validate.mutually_valid&&e.validate.valid),e.validate.mutually&&!e.validate.required&&e.validate.empty){e.value=null,e.validate.mutually_valid=!0,e.validate.valid=!0,e.validate._valid=!0;for(var r=[],i=e.validate.mutually.length;i--;){var a=e.validate.mutually[i];this.state.tovalidate[a].validate.empty||r.push(a)}r.length<2&&r.forEach(function(e){n.state.tovalidate[e].validate.mutually_valid=!0,n.state.tovalidate[e].validate.valid=!0,setTimeout(function(){n.state.tovalidate[e].validate.valid=n.state.tovalidate[e].validate._valid,n.state.valid=n.state.valid&&n.state.tovalidate[e].validate.valid})})}e.validate.mutually||e.validate.empty||!e.validate.min_field&&!e.validate.max_field||(t=e.validate.min_field||e.validate.max_field,e.validate.valid=e.validate.min_field?this.state.tovalidate[e.validate.min_field].validate.empty||+e.value>+this.state.tovalidate[e.validate.min_field].value:this.state.tovalidate[e.validate.max_field].validate.empty||+e.value<+this.state.tovalidate[e.validate.max_field].value,e.validate.valid&&(this.state.tovalidate[t].validate.valid=!0))}this.state.valid=Object.values(this.state.tovalidate).reduce(function(e,t){return e&&t.validate.valid},!0)&&Object.values(this.state.componentstovalidate).reduce(function(e,t){return e&&t},!0)},r.addComponents=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;this.addComponent(o)}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}},r.addComponent=function(e){var t,n,r,i,a,o,s;e&&(t=e.id,n=e.title,r=e.name,i=e.icon,a=e.valid,o=e.headerComponent,s=void 0===(s=e.header)||s,void 0!==a&&(this.state.componentstovalidate[t]=a,this.state.valid=this.state.valid&&a,this.eventBus.$emit("add-component-validate",{id:t,valid:a})),s&&(this.state.headers.push({title:n,name:r,id:t,icon:i,component:o}),this.state.currentheaderid=this.state.currentheaderid||t),this.state.components.push(e))},r.replaceComponent=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,e=e.component,n=this.state.components.findIndex(function(e){return e.id===t});this.state.components.splice(n,1,e)},r.disableComponent=function(e){var t=e.id;e.disabled?this.state.disabledcomponents.push(t):this.state.disabledcomponents=this.state.disabledcomponents.filter(function(e){return disabledId!==t})},r.setCurrentComponentById=function(t){if(-1===this.state.disabledcomponents.indexOf(t))return this.setIdHeader(t),this.state.component=this.state.components.find(function(e){return e.id===t}).component,this.state.component},r.setRootComponent=function(){this.state.component=this.state.components.find(function(e){return e.root}).component},r.getRootComponent=function(){return this.state.components.find(function(e){return e.root}).component},r.isRootComponent=function(e){return this.getRootComponent()==e},r.getComponentById=function(t){return this.state.components.find(function(e){return e.id===t})},r.setComponent=function(e){this.state.component=e},r.addedComponentTo=function(){this.state.addedcomponentto[0<arguments.length&&void 0!==arguments[0]?arguments[0]:"body"]=!0},r.addToValidate=function(e){this.state.tovalidate[e.name]=e,this.state.ready&&this.isValid(e)},r.removeToValidate=function(e){delete this.state.tovalidate[e.name],this.isValid()},r.getState=function(){return this.state},r._setState=function(e){this.state=e},r.getFields=function(){return this.state.fields},r._getField=function(t){return this.state.fields.find(function(e){return e.name===t})},r.getEventBus=function(){return this.eventBus},r.setIdHeader=function(e){this.state.currentheaderid=e},r.getContext=function(){return this.context_inputs.context},r.getSession=function(){return this.getContext().session},r.getInputs=function(){return this.context_inputs.inputs},r.handleRelation=function(e){e.relationId,e.feature},r.clearAll=function(){this.eventBus.$off("addtovalidate"),this.eventBus.$off("set-main-component"),this.eventBus.$off("set-loading-form"),this.eventBus.$off("component-validation"),this.eventBus.$off("disable-component")},r.saveDefaultExpressionFieldsNotDependencies=i(function*(){var i=this;if(0!==this.default_expression_fields_on_update.length){this.listenChangeInput=!1;for(var a=[],e=[],t=function*(n){for(var r=Object.keys(i.default_expression_fields_dependencies).filter(function(t){return i.default_expression_fields_on_update.find(function(e){return e.name===t})&&i.default_expression_fields_dependencies[t].find(function(e){return e===i.default_expression_fields_on_update[n].name})}),e=0;e<r.length;e++)yield*function*(t){if(void 0!==a.find(function(e){return e===r[t]}))return"continue";try{var e=yield l._getDefaultExpression({field:i._getField(r[t]),feature:i.feature,qgs_layer_id:i.layer.getId(),parentData:i.parentData});i.feature.set(r[t],e),a.push(r[t])}catch(e){}}(e)},n=0;n<this.default_expression_fields_on_update.length;n++)yield*t(n);this.default_expression_fields_on_update.forEach(function(t){void 0===a.find(function(e){return e===t.name})&&e.push(l._getDefaultExpression({field:t,feature:i.feature,qgs_layer_id:i.layer.getId(),parentData:i.parentData}))});try{yield Promise.allSettled(e)}catch(e){}this.listenChangeInput=!0}}),l._getFilterExpression=i(function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.field,n=e.feature,r=e.qgs_layer_id,e=e.parentData,i=t.input.options,a=i.key,o=i.value,s=i.layer_id,s=void 0===s?r:s,l=i.filter_expression,i=i.loading;if(l){i.state="loading";try{var u=yield p.default.getData("expression:expression",{inputs:{field_name:t.name,layer_id:s,qgs_layer_id:r,form_data:(0,f.convertFeatureToGEOJSON)(n),parent:e&&{form_data:(0,f.convertFeatureToGEOJSON)(e.feature),qgs_layer_id:e.qgs_layer_id,formatter:0},formatter:0,expression:l.expression},outputs:!1});if("select_autocomplete"===t.input.type){t.input.options.values=[];for(var c=[],d=0;d<u.length;d++)c.push({key:u[d].properties[a],value:u[d].properties[o]});c.sort(function(e,t){e=e.key,t=t.key;return"string"==typeof e&&(e=e.toLowerCase(),t=t.toLowerCase()),e<t?-1:t<e?1:0}),t.input.options.values=c}return u}catch(e){return Promise.reject(e)}finally{i.state="ready"}}}),l._getDefaultExpression=i(function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.field,n=e.feature,r=e.qgs_layer_id,e=e.parentData,i=t.input.options,a=i.layer_id,a=void 0===a?r:a,o=i.default_expression,s=i.loading,i=i.default;if(o){s.state="loading";try{var l=yield p.default.getData("expression:expression_eval",{inputs:{field_name:t.name,layer_id:a,qgs_layer_id:r,form_data:(0,f.convertFeatureToGEOJSON)(n),formatter:0,expression:o.expression,parent:e&&{form_data:(0,f.convertFeatureToGEOJSON)(e.feature),qgs_layer_id:e.qgs_layer_id,formatter:0}},outputs:!1});return t.value=l}catch(e){return void 0!==i&&(t.value=i),Promise.reject(e)}finally{s.state="ready"}}}),t.exports=l},{"core/g3wobject":11,"services/data":300,utils:404,"utils/convertFeatureToGEOJSON":332}],83:[function(e,t,n){var e=e("components/g3w-form"),e=(e=e)&&e.__esModule?e:{default:e};t.exports=e.default},{"components/g3w-form":246}],84:[function(e,t,n){var r=e("utils"),i=r.inherit,a=r.base;function o(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.state.input.options.values.find(function(e){return!1===e.checked});e.validatorOptions={values:e.state.input.options.values.map(function(e){return e})},null!==e.state.value||e.state.forceNull||(e.state.value=t.value),a(this,e)}i(o,e("gui/inputs/service"));r=o.prototype;r.convertCheckedToValue=function(t){t=null!=t&&t;var e=this.state.input.options.values.find(function(e){return e.checked===t});return this.state.value=e.value,this.state.value},r.convertValueToChecked=function(){var e,t=this.state.value;return null!=t&&(void 0===(e=this.state.input.options.values.find(function(e){return e.value==t}))&&(e=this.state.input.options.values.find(function(e){return!1===e.checked}),this.state.value=e.value),e.checked)},t.exports=o},{"gui/inputs/service":107,utils:404}],85:[function(e,t,n){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/InputCheckbox.vue"));e=Vue.extend(e);t.exports=e},{"components/InputCheckbox.vue":171}],86:[function(e,t,n){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/InputColor.vue"));e=Vue.extend(e);t.exports=e},{"components/InputColor.vue":172}],87:[function(e,t,n){var r=e("services/application"),i=(r=r)&&r.__esModule?r:{default:r};var r=e("utils"),a=r.inherit,o=r.base,s=r.convertQGISDateTimeFormatToMoment;function l(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.validatorOptions={},o(this,e)}a(l,e("gui/inputs/service"));r=l.prototype;r.getLocale=function(){var e=i.default.getConfig();return e.user.i18n||"en"},r.convertQGISDateTimeFormatToMoment=function(e){return s(e)},r.setValidatorOptions=function(e){this.validatorOptions=e},t.exports=l},{"gui/inputs/service":107,"services/application":298,utils:404}],88:[function(e,t,n){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/InputDateTimePicker.vue"));e=Vue.extend(e);t.exports=e},{"components/InputDateTimePicker.vue":173}],89:[function(e,t,n){var r=e("utils"),i=r.base;function a(){i(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}(0,r.inherit)(a,e("gui/inputs/service")),t.exports=a},{"gui/inputs/service":107,utils:404}],90:[function(e,t,n){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/InputFloat.vue"));e=Vue.extend(e);t.exports=e},{"components/InputFloat.vue":174}],91:[function(e,t,n){var r=o(e("store/application-state")),i=o(e("components/InputBase.vue")),a=e("mixins");function o(e){return e&&e.__esModule?e:{default:e}}function s(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var l=e("./services"),e={props:["state"],mixins:[a.baseInputMixin],components:{baseinput:i.default},watch:{notvalid:function(e){e&&this.service.setErrorMessage()},"state.value":function(){var e=this;void 0!==this.state.input.options.default_expression&&setTimeout(function(){return e.change()})}},created:function(){var e=this;this.service=new l[this.state.input.type]({state:this.state}),this.$watch(function(){return r.default.language},s(function*(){e.state.visible&&(e.state.visible=!1,e.service.setErrorMessage(),yield e.$nextTick(),e.state.visible=!0)})),this.state.editable&&this.state.validate.required&&this.service.validate(),this.$emit("addinput",this.state),this.state.value_from_default_value&&this.$emit("changeinput",this.state)},destroyed:function(){this.$emit("removeinput",this.state)}};t.exports=e},{"./services":108,"components/InputBase.vue":170,mixins:290,"store/application-state":310}],92:[function(e,t,n){e={text_input:e("./text/vue/text"),texthtml_input:e("./texthtml/vue/texthtml"),textarea_input:e("./textarea/vue/textarea"),integer_input:e("./integer/vue/integer"),string_input:e("./text/vue/text"),float_input:e("./float/vue/float"),radio_input:e("./radio/vue/radio"),check_input:e("./checkbox/vue/checkbox"),range_input:e("./range/vue/range"),datetimepicker_input:e("./datetimepicker/vue/datetimepicker"),unique_input:e("./unique/vue/unique"),select_input:e("./select/vue/select"),media_input:e("./media/vue/media"),select_autocomplete_input:e("./select/vue/select"),picklayer_input:e("./picklayer/vue/picklayer"),color_input:e("./color/vue/color"),slider_input:e("./sliderrange/vue/sliderrange"),lonlat_input:e("./lonlat/vue/lonlat")};t.exports=e},{"./checkbox/vue/checkbox":85,"./color/vue/color":86,"./datetimepicker/vue/datetimepicker":88,"./float/vue/float":90,"./integer/vue/integer":94,"./lonlat/vue/lonlat":96,"./media/vue/media":98,"./picklayer/vue/picklayer":100,"./radio/vue/radio":102,"./range/vue/range":104,"./select/vue/select":106,"./sliderrange/vue/sliderrange":110,"./text/vue/text":111,"./textarea/vue/textarea":112,"./texthtml/vue/texthtml":113,"./unique/vue/unique":115}],93:[function(e,t,n){var r=e("utils"),i=r.base;function a(){i(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}(0,r.inherit)(a,e("gui/inputs/service")),t.exports=a},{"gui/inputs/service":107,utils:404}],94:[function(e,t,n){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/InputInteger.vue"));e=Vue.extend(e);t.exports=e},{"components/InputInteger.vue":177}],95:[function(e,t,n){var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=e("services/gui"),a=(i=i)&&i.__esModule?i:{default:i};var i=e("utils"),o=i.base;function s(){var t=this;o(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),this.coordinatebutton,this.mapService=a.default.getComponent("map").getService(),this.mapEpsg=this.mapService.getCrs(),this.mapControlToggleEventHandler=function(e){e.target.isToggled()&&e.target.isClickMap()&&t.coordinatebutton.active&&t.toggleGetCoordinate()},this.map=a.default.getComponent("map").getService().getMap(),this.outputEpsg=this.state.epsg||this.mapEpsg,this.eventMapKey}(0,i.inherit)(s,e("gui/inputs/service"));i=s.prototype;i.setCoordinateButtonReactiveObject=function(e){this.coordinatebutton=e},i.validate=function(){this.state.values.lon<-180?this.state.values.lon=-180:180<this.state.values.lon&&(this.state.values.lon=180),this.state.values.lat<-90?this.state.values.lon=-90:90<this.state.values.lat&&(this.state.values.lon=90),this.state.validate.valid=!Number.isNaN(+this.state.values.lon)},i.toggleGetCoordinate=function(){this.coordinatebutton.active=!this.coordinatebutton.active,this.coordinatebutton.active?this.startToGetCoordinates():this.stopToGetCoordinates()},i.startToGetCoordinates=function(){var n=this;this.mapService.deactiveMapControls(),this.mapService.on("mapcontrol:toggled",this.mapControlToggleEventHandler),this.eventMapKey=this.map.on("click",function(e){e.originalEvent.stopPropagation(),e.preventDefault();var e=n.mapEpsg!==n.outputEpsg?ol.proj.transform(e.coordinate,n.mapEpsg,n.outputEpsg):e.coordinate,e=(n.state.value=[e],r(e,2)),t=e[0],e=e[1];n.state.values.lon=t,n.state.values.lat=e})},i.stopToGetCoordinates=function(){ol.Observable.unByKey(this.eventMapKey),this.mapService.off("mapcontrol:toggled",this.mapControlToggleEventHandler)},i.clear=function(){this.stopToGetCoordinates()},t.exports=s},{"gui/inputs/service":107,"services/gui":302,utils:404}],96:[function(e,t,n){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/InputLonLat.vue"));e=Vue.extend(e);t.exports=e},{"components/InputLonLat.vue":178}],97:[function(e,t,n){var r=e("utils"),i=r.inherit,a=r.base;function o(){a(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}i(o,e("gui/inputs/service")),t.exports=o},{"gui/inputs/service":107,utils:404}],98:[function(e,t,n){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/InputMedia.vue"));e=Vue.extend(e);t.exports=e},{"components/InputMedia.vue":179}],99:[function(e,t,n){var s=r(e("store/map-layers")),l=r(e("services/gui")),u=e("utils/getQueryLayersPromisesByCoordinates");function r(e){return e&&e.__esModule?e:{default:e}}var i=e("g3w-ol/interactions/pickfeatureinteraction"),a=e("g3w-ol/interactions/pickcoordinatesinteraction");function o(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.pick_type=e.pick_type||"wms",this.ispicked=!1,this.fields=e.fields||[e.value],this.layerId=e.layer_id,this.mapService=l.default.getService("map"),this.interaction="map"===this.pick_type?new i({layers:[this.mapService.getLayerById(this.layerId)]}):new a}e=o.prototype;e.isPicked=function(){return this.ispicked},e.escKeyUpHandler=function(e){var t=e.keyCode,e=e.data.owner;27===t&&e.unpick()},e.unbindEscKeyUp=function(){$(document).unbind("keyup",this.escKeyUpHandler)},e.bindEscKeyUp=function(){$(document).on("keyup",{owner:this},this.escKeyUpHandler)},e.pick=function(){var o=this;return new Promise(function(n,r){o.bindEscKeyUp();function i(e){var t;e?(t=e.getProperties(),o.fields.filter(function(e){return e}).forEach(function(e){return a[e]=t[e]}),n(a)):r(),o.ispicked=!1,o.unpick()}var a={};o.ispicked=!0;l.default.setModal(!1),o.mapService.addInteraction(o.interaction),o.interaction.once("picked",function(e){var t;"map"===o.pick_type?(t=e.feature,i(t)):"wms"===o.pick_type&&(t=s.default.getLayerById(o.layerId))&&(0,u.getQueryLayersPromisesByCoordinates)([t],{map:o.mapService.getMap(),feature_count:1,coordinates:e.coordinate}).then(function(e){e=e[0].data,e=void 0===e?[]:e,e=e.length&&e[0].features[0]||null;i(e)})})})},e.unpick=function(){this.mapService.removeInteraction(this.interaction),l.default.setModal(!0),this.unbindEscKeyUp(),this.ispicked=!1},e.clear=function(){this.isPicked()&&this.unpick(),this.mapService=this.interaction=this.field=null},t.exports=o},{"g3w-ol/interactions/pickcoordinatesinteraction":71,"g3w-ol/interactions/pickfeatureinteraction":72,"services/gui":302,"store/map-layers":315,"utils/getQueryLayersPromisesByCoordinates":391}],100:[function(e,t,n){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/InputPickLayer.vue"));e=Vue.extend(e);t.exports=e},{"components/InputPickLayer.vue":180}],101:[function(e,t,n){var r=e("utils"),i=r.inherit,a=r.base;function o(){a(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}i(o,e("gui/inputs/service")),t.exports=o},{"gui/inputs/service":107,utils:404}],102:[function(e,t,n){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/InputRadio.vue"));e=Vue.extend(e);t.exports=e},{"components/InputRadio.vue":181}],103:[function(e,t,n){var r=e("utils"),i=r.inherit,a=r.base,r=e("gui/inputs/service"),o=e("utils/validators");function s(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.state.input.options.values[0],n=t.min,t=t.max,e=(e.state.info="[MIN: "+n+" - MAX: "+t+"]",a(this,e),o.get("range",{min:+n,max:+t}));this.setValidator(e)}i(s,r),r.prototype.isValueInRange=function(e,t,n){return e<=n&&t<=e},t.exports=s},{"gui/inputs/service":107,utils:404,"utils/validators":453}],104:[function(e,t,n){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/InputRange.vue"));e=Vue.extend(e);t.exports=e},{"components/InputRange.vue":182}],105:[function(e,t,n){var o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=e("store/catalog-layers"),i=(r=r)&&r.__esModule?r:{default:r};var r=e("utils"),a=r.inherit,s=r.base;function l(){s(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),this.layer=null}a(l,e("gui/inputs/service"));r=l.prototype;r._getLayerById=function(e){return i.default.getLayerById(e)},r.addValue=function(e){this.state.input.options.values.push(e)},r.getKeyByValue=function(){var r=this,e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).search,t=this.state.input.options,i=t.value,a=t.key;return new Promise(function(n,t){r.getData({key:i,value:a,search:e}).then(function(e){var e=o(e,1)[0],t=e.$value,e=e.text;r.addValue({key:t,value:e}),n(r.state.input.options.values)}).catch(function(e){t(e)})})},r.getData=function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=t.layer_id,r=void 0===n?this.state.input.options.layer_id:n,n=t.key,i=void 0===n?this.state.input.options.key:n,n=t.value,a=void 0===n?this.state.input.options.value:n,n=t.search,o=(i+"|"+n).trim();return new Promise(function(t,n){e._layer||(e._layer=e._getLayerById(r)),e._layer.getDataTable({suggest:o,ordering:i}).then(function(e){e=e.features.map(function(e){return{text:e.properties[i],id:e.properties[a],$value:e.properties[a]}});t(e)}).fail(function(e){return n(e)})})},t.exports=l},{"gui/inputs/service":107,"store/catalog-layers":311,utils:404}],106:[function(e,t,n){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/InputSelect.vue"));e=Vue.extend(e);t.exports=e},{"components/InputSelect.vue":183}],107:[function(e,t,n){var r=e("utils/validators"),i=e("utils").toRawType,a=e("core/i18n/i18n.service").t;function o(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(this.state=e.state||{},this.setValue(this.state.value),this.setEmpty(this.state.value),this.state.type),e=e.validatorOptions||this.state.input.options||{};this._validator=r.get(t,e),this.setErrorMessage()}e=o.prototype;e.getState=function(){return this.state},e.getValue=function(){return this.state.value},e.setValue=function(e){var t,n;null==e&&(t=(e=this.state.input.options).default,Array.isArray(e)&&(e[0].default?t=e[0].default:Array.isArray(e.values)&&0<e.values.length&&(t=e.values[0]&&(e.values[0].value||e.values[0]))),(n=this.state.get_default_value&&null!=t)&&void 0===e.default_expression&&(this.state.value=t),this.state.value_from_default_value=n)},e.addValueToValues=function(e){this.state.input.options.values.unshift(e)},e._getValidatorType=function(){return this.state.type},e.setState=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.state=_.isObject(e)?e:{}},e.getValidator=function(){return this._validator},e.setValidator=function(e){this._validator=e},e.setEmpty=function(){this.state.validate.empty=!(Array.isArray(this.state.value)&&this.state.value.length||!_.isEmpty(_.trim(this.state.value)))},e.validate=function(){return this.state.validate.empty?(this.state.validate.empty=!0,this.state.value=null,this.state.validate.unique=!0,this.state.validate.valid=!this.state.validate.required&&this._validator.validate(this.state.value)):("integer"!==this.state.input.type&&"float"!==this.state.input.type||(+this.state.value<0?(this.state.value=null,this.state.validate.empty=!0,this.state.validate.valid=!this.state.validate.required):this.state.validate.valid=this._validator.validate(this.state.value)),this.state.validate.exclude_values&&this.state.validate.exclude_values.size?this.state.validate.valid=!this.state.validate.exclude_values.has(this.state.value):this.state.validate.valid=this._validator.validate(this.state.value)),this.state.validate.valid},e.setErrorMessage=function(){var e;this.state.validate.error?this.state.validate.message=a(this.state.validate.error):(e=void 0,this.state.validate.mutually&&!this.state.validate.mutually_valid?this.state.validate.message=a("sdk.form.inputs.input_validation_mutually_exclusive")+" ( "+this.state.validate.mutually.join(",")+" )":this.state.validate.max_field?this.state.validate.message=a("sdk.form.inputs.input_validation_max_field")+" ("+this.state.validate.max_field+")":this.state.validate.min_field?this.state.validate.message=a("sdk.form.inputs.input_validation_min_field")+" ("+this.state.validate.min_field+")":this.state.validate.unique&&this.state.validate.exclude_values&&this.state.validate.exclude_values.size?this.state.validate.message=""+a("sdk.form.inputs.input_validation_exclude_values"):this.state.validate.required?(e=a("sdk.form.inputs.input_validation_error")+" ( "+a("sdk.form.inputs."+this.state.type)+" )",this.state.info&&(e=e+"\n                 <div>\n                  <b>"+this.state.info+"</b>\n                 </div>         \n      "),this.state.validate.message=this.state.info||e):this.state.validate.message=this.state.info)},e.setUpdate=function(){var e=this.state,t=e.value,e=e._value;"media"===this.state.input.type&&"Object"!==i(t)&&"Object"!==i(e)?this.state.update=t.value!=e.value:"datetimepicker"===this.state.input.type?this.state.update=(null!==t?t.toUpperCase():t)!=(e&&e.toUpperCase()):this.state.update=t!=e},t.exports=o},{"core/i18n/i18n.service":12,utils:404,"utils/validators":453}],108:[function(e,t,n){e={text:e("./service"),textarea:e("./service"),texthtml:e("./service"),integer:e("./integer/service"),string:e("./service"),float:e("./float/service"),radio:e("./radio/service"),check:e("./checkbox/service"),range:e("./range/service"),datetimepicker:e("./datetimepicker/service"),unique:e("./unique/service"),select:e("./select/service"),media:e("./media/service"),select_autocomplete:e("./select/service"),picklayer:e("./service"),color:e("./service"),slider:e("./sliderrange/service"),lonlat:e("./lonlat/service")};t.exports=e},{"./checkbox/service":84,"./datetimepicker/service":87,"./float/service":89,"./integer/service":93,"./lonlat/service":95,"./media/service":97,"./radio/service":101,"./range/service":103,"./select/service":105,"./service":107,"./sliderrange/service":109,"./unique/service":114}],109:[function(e,t,n){var r=e("utils"),i=r.base,r=r.inherit,a=e("gui/inputs/service"),o=e("utils/validators");function s(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.state,e=(e.state.info="[MIN: "+t.input.options.min+" - MAX: "+t.input.options.max+"]",i(this,e),o.get("range",{min:+t.input.options.min,max:+t.input.options.max}));this.setValidator(e),this.validate=function(){this.state.value=+this.state.value,this.state.validate.valid=this.state.value>=this.state.input.options.min||this.state.value<=this.state.input.options.max}}r(s,a),s.prototype.changeInfoMessage=function(){this.state.info="[MIN: "+this.state.input.options.min+" - MAX: "+this.state.input.options.max+"]"},t.exports=s},{"gui/inputs/service":107,utils:404,"utils/validators":453}],110:[function(e,t,n){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/InputSliderRange.vue"));e=Vue.extend(e);t.exports=e},{"components/InputSliderRange.vue":184}],111:[function(e,t,n){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/InputText.vue"));e=Vue.extend(e);t.exports=e},{"components/InputText.vue":185}],112:[function(e,t,n){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/InputTextArea.vue"));e=Vue.extend(e);t.exports=e},{"components/InputTextArea.vue":186}],113:[function(e,t,n){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/InputTextHtml.vue"));e=Vue.extend(e);t.exports=e},{"components/InputTextHtml.vue":187}],114:[function(e,t,n){var r=e("utils"),i=r.inherit,a=r.base;function o(){a(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}i(o,e("gui/inputs/service")),t.exports=o},{"gui/inputs/service":107,utils:404}],115:[function(e,t,n){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/InputUnique.vue"));e=Vue.extend(e);t.exports=e},{"components/InputUnique.vue":188}],116:[function(e,t,N){var c=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},n=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e};function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var m=e("app/constant"),u=h(e("services/data")),d=h(e("store/map-layers")),p=h(e("store/projects")),i=h(e("services/application")),s=h(e("store/map-controls")),y=h(e("services/gui")),a=h(e("components/MapControlZoomHistory.vue")),G=h(e("components/MapControlGeocoding.vue")),D=e("utils/createVectorLayerFromFile"),B=e("utils/createWMSLayer"),f=e("utils/createSelectedStyle"),l=e("utils/getMapLayersByFilter"),V=e("utils/getGeoTIFFfromServer"),U=e("utils/getScaleFromResolution"),z=e("utils/getResolutionFromScale");function h(e){return e&&e.__esModule?e:{default:e}}function g(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}function v(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var b=e("utils"),q=b.inherit,Y=b.base,W=b.copyUrl,H=b.uniqueId,Q=b.throttle,Z=b.createFilterFromString,b=e("core/g3wobject"),w=e("g3w-ol/layers/bases"),x=e("core/layers/vectorlayer"),S=e("g3w-ol/controls/control"),L=e("g3w-ol/controls/resetcontrol"),K=e("g3w-ol/controls/querycontrol"),C=e("g3w-ol/controls/zoomboxcontrol"),X=e("g3w-ol/controls/querybboxcontrol"),J=e("g3w-ol/controls/querybypolygoncontrol"),ee=e("g3w-ol/controls/geolocationcontrol"),te=e("g3w-ol/controls/streetviewcontrol"),ne=e("g3w-ol/controls/addlayers"),re=e("g3w-ol/controls/lengthcontrol"),ie=e("g3w-ol/controls/areacontrol"),ae=e("g3w-ol/controls/mousepositioncontrol"),oe=e("g3w-ol/controls/scalecontrol"),se=e("g3w-ol/controls/onclickcontrol"),le=e("g3w-ol/controls/screenshotcontrol"),ue=e("g3w-ol/controls/geoscreenshotcontrol"),ce=e("g3w-ol/controls/querybydrawpolygoncontrol"),de=e("g3w-ol/controls/interactioncontrol"),E={zoomtoextent:A(),zoom:A(),scaleline:A(),overview:A(),zoomhistory:R("zoomhistory"),geocoding:R("nominatim"),reset:L,zoombox:C,query:K,querybbox:X,querybypolygon:J,geolocation:ee,streetview:te,addlayers:ne,length:re,area:ie,mouseposition:ae,scale:oe,onclick:se,ontoggle:de,screenshot:le,geoscreenshot:ue,querybydrawpolygon:ce},T=(E.nominatim=E.geocoding,n(k,[{key:"destroy",value:function(){this.map&&(this.map.dispose(),this.map=null)}},{key:"getView",value:function(){return this.map.getView()}},{key:"updateMap",value:function(e){}},{key:"updateView",value:function(){}},{key:"getMap",value:function(){return this.map}},{key:"setTarget",value:function(e){this.map.setTarget(e)}},{key:"zoomTo",value:function(e,t){var n=this.map.getView();n.setCenter(e),n.setZoom(t)}},{key:"goTo",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=this.map.getView(),r="boolean"!=typeof t.animate||t.animate,t=t.zoom||!1;r?n.animate({duration:300,center:e},t?{zoom:t,duration:300}:{duration:300,resolution:n.getResolution()}):n.setCenter(e),t&&!r&&n.setZoom(t)}},{key:"goToRes",value:function(a){var o=this,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(e){var t=o.map.getView(),n="boolean"!=typeof s.animate||s.animate,r=s.resolution||t.getResolution(),i=t.on("change:center",function(){ol.Observable.unByKey(i),setTimeout(e,500)});n?t.animate({duration:200,center:a},{duration:200,resolution:r}):(t.setCenter(a),t.setResolution(r))})}},{key:"fit",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=this.map.getView();"boolean"==typeof t.animate&&!t.animate||(n.animate({duration:200,center:n.getCenter()}),n.animate({duration:200,resolution:n.getResolution()})),delete t.animate,n.fit(e,o({},t,{constrainResolution:void 0===t.constrainResolution||t.constrainResolution,size:this.map.getSize()}))}},{key:"getZoom",value:function(){return this.map.getView().getZoom()}},{key:"getResolution",value:function(){return this.map.getView().getResolution()}},{key:"getCenter",value:function(){return this.map.getView().getCenter()}},{key:"getBBOX",value:function(){return this.map.getView().calculateExtent(this.map.getSize())}},{key:"getLayerByName",value:function(t){return this.map.getLayers().find(function(e){return t===e.get("name")})}},{key:"removeLayerByName",value:function(e){e=this.getLayerByName(e);e&&this.map.removeLayer(e)}},{key:"getActiveLayers",value:function(){return this.map.getLayers().filter(function(e){e=e.getProperties();return e.visible&&!0!==e.basemap})}},{key:"removeLayers",value:function(){this.map.getLayers().clear()}},{key:"getLayersNoBase",value:function(){return this.map.getLayers().filter(function(e){return!e.getProperties().basemap})}},{key:"addBaseLayer",value:function(e){this.map.addLayer(e?w[e]:w.BING.Aerial)}},{key:"changeBaseLayer",value:function(e){this.map.getLayers().insertAt(0,this.getLayerByName(e))}}]),k);function k(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=this,n=k;if(!(t instanceof n))throw new TypeError("Cannot call a class as a function");t=ol.control.defaults({attribution:!1,zoom:!1}),n=ol.interaction.defaults().extend([new ol.interaction.DragRotate]);n.removeAt(1),this.map=new ol.Map({controls:t,interactions:n,ol3Logo:!1,view:e.view instanceof ol.View?e.view:new ol.View(e.view),keyboardEventTarget:document,target:e.id})}function M(){function e(t,e){e&&r.getMapLayers().forEach(function(e){return e.update(r.state,t)})}var r=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.state={mapUnits:"m",bbox:[],hidemaps:[],resolution:null,center:null,loading:!1,hidden:!0,scale:0,mapcontrolsalignement:"rv",mapcontrolDOM:null,mapcontrolready:!1,mapcontrolSizes:{height:47,width:47,minWidth:47,minHeight:47},mapControl:{grid:[],length:0,currentIndex:0,update:!0,disabled:!1},map_info:{info:null,style:null},mapunits:["metric"]},this.id="MapService",this._ready=new Promise(function(e,t){r.once("viewerset",function(){d.default.getLayersStores().forEach(r._setUpEventsKeysToLayersStore.bind(r)),d.default.onafter("addLayersStore",r._setUpEventsKeysToLayersStore.bind(r)),d.default.onafter("removeLayersStore",r._removeEventsKeysToLayersStore.bind(r)),e()})}),this.viewer=null,this.target=t.target||"map",this.layersCount=0,this.maps_container=t.maps_container||"g3w-maps",this._layersStoresEventKeys={},this._keyEvents={ol:[],g3wobject:[],eventemitter:[]},this.project=null,this._mapControls=[],this._changeMapMapControls=[],this._mapLayers=[],this._externalMapLayers=[],this._externalLayers=[],this._externalInteractions=[],this.mapBaseLayers={},this.defaultsLayers={mapcenter:new ol.layer.Vector({source:new ol.source.Vector,style:new ol.style.Style({image:new ol.style.Icon({opacity:1,src:"/static/client/images/mapcentermarker.svg",scale:.8})})}),_style:{highlightLayer:{color:void 0},selectionLayer:{color:"red"}},highlightLayer:new ol.layer.Vector({source:new ol.source.Vector,style:function(e){var t=[],e=e.getGeometry().getType(),e=(0,f.createSelectedStyle)({geometryType:e,color:r.defaultsLayers._style.highlightLayer.color,fill:!1});return t.push(e),t}}),selectionLayer:new ol.layer.Vector({source:new ol.source.Vector,style:function(e){var t=[],e=e.getGeometry().getType(),e=(0,f.createSelectedStyle)({geometryType:e,color:r.defaultsLayers._style.selectionLayer.color,fill:!1});return t.push(e),t}})},this.layersExtraParams={},this._greyListenerKey=null,this._drawShadow={type:"coordinate",outer:[],inner:[],scale:null,rotation:null},this.config=t.config||i.default.getConfig(),this._howManyAreLoading=0,this._layersLoadingError=!1,this._incrementLoaders=function(){0===r._howManyAreLoading&&(r.emit("loadstart"),y.default.showSpinner({container:$("#map-spinner"),id:"maploadspinner",style:"transparent"})),r._howManyAreLoading+=1},this._decrementLoaders=function(){--r._howManyAreLoading,0===r._howManyAreLoading&&(r.emit("loadend"),y.default.hideSpinner("maploadspinner"))},this._mapLayerLoadError=function(){r._layersLoadingError||(y.default.notify.warning("sdk.errors.layers.load"),r._layersLoadingError=!0),r._decrementLoaders()},t.project?this.project=t.project:(this.project=p.default.getCurrentProject(),t=p.default.onafter("setCurrentProject",function(e){r.removeLayers(),r._removeListeners();function t(){r._resetView(),r._setupAllLayers(),r._checkMapControls(),r.setUpMapOlEvents(),r.setupCustomMapParamsToLegendUrl()}var n=r.project.getId()===e.getId();r.project=e;i.default.isIframe()&&t(),n?t():r.getMap().once("change:size",t)}),this._keyEvents.g3wobject.push({who:p.default,setter:"setCurrentProject",key:t})),this._setupListeners(),this._marker=null,this._bboxLayer=new ol.layer.Vector({source:new ol.source.Vector({})}),this.debounces={setupCustomMapParamsToLegendUrl:{fnc:function(){r._setupCustomMapParamsToLegendUrl.apply(r,arguments)},delay:1e3}},this.setters={setupControls:function(){return this._setupControls()},addHideMap:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=(e.ratio,e.layers,e.mainview,e.switchable),e=void 0!==e&&e,e={id:"hidemap_"+Date.now(),map:null,switchable:e};return this.state.hidemaps.push(e),e},updateMapView:function(e,t,n){this.state.bbox=e,this.state.resolution=t,this.state.center=n,this.updateMapLayers()},setHidden:function(e){this.state.hidden=e},setupViewer:function(e,t){0!==e&&0!==t&&(this.viewer&&(this.viewer.destroy(),this.viewer=null),this._setupViewer(e,t),this.state.bbox=this.viewer.getBBOX(),this.state.resolution=this.viewer.getResolution(),this.state.center=this.viewer.getCenter(),this._setupAllLayers(),this.setUpMapOlEvents(),this.emit("viewerset"))},controlClick:function(e){},loadExternalLayer:function(e){},unloadExternalLayer:function(e){}},this._onCatalogSelectLayer=function(e){s.default.catalogSelectedLayer(e)},this.on("cataloglayerselected",this._onCatalogSelectLayer),this._keyEvents.eventemitter.push({event:"cataloglayerselected",listener:this._onCatalogSelectLayer});this.on("extraParamsSet",e),this._keyEvents.eventemitter.push({event:"extraParamsSet",listener:e}),Y(this)}q(M,b);var P,O,F,I,C=M.prototype,j=(C.isReady=function(){return this._ready},C.setUpMapOlEvents=function(){var t=this,n=this.project.getContextBaseLegend(),e=(this._keyEvents.ol.forEach(function(e){return ol.Observable.unByKey(e)}),this.viewer.map.getView().on("change:resolution",function(e){t._updateMapView(),n&&t.setupCustomMapParamsToLegendUrl()}));this._keyEvents.ol.push(e),n?(e=this.viewer.map.on("moveend",function(e){return t.setupCustomMapParamsToLegendUrl()}),this._keyEvents.ol.push(e)):this.setupCustomMapParamsToLegendUrl()},C.clear=function(){var n=this;Object.keys(this._keyEvents).forEach(function(e){switch(e){case"ol":n._keyEvents[e].forEach(function(e){return ol.Observable.unByKey(e)});break;case"g3wobject":n._keyEvents[e].forEach(function(e){var t=e.who,n=e.setter,e=e.key;t.un(n,e)});break;case"eventemitter":n._keyEvents[e].forEach(function(e){var t=e.event,e=e.listener;n.removeListener(t,e)})}}),this._keyEvents=null,d.default.getLayersStores().forEach(this._removeEventsKeysToLayersStore.bind(this))},C.showMapSpinner=function(){y.default.showSpinner({container:$("#map-spinner"),id:"maploadspinner",style:"transparent"})},C.hideMapSpinner=function(){y.default.hideSpinner("maploadspinner")},C.getScaleFromExtent=function(e){e=this.getMap().getView().getResolutionForExtent(e,this.getMap().getSize());return(0,U.getScaleFromResolution)(e,this.getMapUnits())},C._addHideMap=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.ratio,n=e.layers,r=void 0===n?[]:n,n=e.mainview,e=void 0!==n&&n,i=this.state.hidemaps[this.state.hidemaps.length-1],n=this.getMap().getView(),a={projection:n.getProjection(),center:n.getCenter(),resolution:this.getResolution()},e=new T({id:i.id,view:e?n:a});i.map=e.getMap(),t&&(n=i.map.getSize(),e=(a=c(n,2))[0],a[1],i.map.setSize([e,e*t]));for(var o=0;o<r.length;o++){var s=r[o];i.map.addLayer(s)}return i.map},C.removeHideMap=function(e){for(var t=void 0,n=0;n<this.state.hidemaps.length;n++)if(e===this.state.hidemaps[n].id){t=n;break}void 0!==t&&this.state.hidemaps.splice(t,1)},C._showHideMapElement=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.map,e=e.show;void 0!==e&&e?$(t.getTargetElement()).addClass("show"):$(t.getTargetElement()).removeClass("show")},C.createMapImage=function(){var r=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=e.map;e.background;return new Promise(function(t,n){try{var e=r.getMapCanvas(i);navigator.msSaveBlob?t(e.msToBlob()):e.toBlob(function(e){return t(e)})}catch(e){n(e)}})},C.getApplicationAttribution=function(){var e=this.config.group,t=e.header_terms_of_use_link,e=e.header_terms_of_use_text;return!!e&&(t?'<a href="'+t+'">'+e+"</a>":'<span class="skin-color" style="font-weight: bold">'+e+"</span>")},C.slaveOf=function(e,t){},C.setLayersExtraParams=function(e,t){this.layersExtraParams=_.assign(this.layersExtraParams,e),this.emit("extraParamsSet",e,t)},C.getProject=function(){return this.project},C.getMap=function(){try{return this.viewer.map}catch(e){}},C.getMapCanvas=function(e){return $(e?e.getViewport():$("#"+this.maps_container+" .g3w-map").last().children(".ol-viewport")[0]).children("canvas")[0]},C.getProjection=function(){return this.project.getProjection()},C.isMapHidden=function(){return this.state.hidden},C.isAxisOrientationInverted=function(){return"neu"===this.getProjection().getAxisOrientation()},C.getCrs=function(){return this.getProjection().getCode()},C.getViewerElement=function(){return this.viewer.map.getTargetElement()},C.getViewport=function(){return this.viewer.map.getViewport()},C.getResolution=function(){return this.viewer.map.getView().getResolution()},C.getEpsg=function(){return this.viewer.map.getView().getProjection().getCode()},C.getGetFeatureInfoUrlForLayer=function(e,t,n,r,i){return this.getMapLayerForLayer(e).getGetFeatureInfoUrl(t,n,r,i)},C.showMarker=function(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1e3;this._marker.setPosition(e),setTimeout(function(){return t._marker.setPosition()},n)},C.getLayerByName=function(t){return this.getMap().getLayers().getArray().find(function(e){return e.get("name")===t})},C.getLayerById=function(t){return this.getMap().getLayers().getArray().find(function(e){return e.get("id")===t})},C.getVectorLayerFeaturesFromCoordinates=function(e,t){var n=void 0,r=[],i=this.getMap(),a=this.getLayerById(e);if(Array.isArray(t)){if(2===t.length){e=i.getPixelFromCoordinate(t);i.forEachFeatureAtPixel(e,function(e){return r.push(e)},{layerFilter:function(e){return e===a}})}else if(4===t.length)switch(n=ol.geom.Polygon.fromExtent(t),a.constructor){case x:r=a.getIntersectedFeatures(n);break;case ol.layer.Vector:a.getSource().getFeatures().forEach(function(e){n.intersectsExtent(e.getGeometry().getExtent())&&r.push(e)})}}else if(t instanceof ol.geom.Polygon||t instanceof ol.geom.MultiPolygon)switch(n=t,a.constructor){case x:r=a.getIntersectedFeatures(n);break;case ol.layer.Vector:a.getSource().getFeatures().forEach(function(e){n.intersectsExtent(e.getGeometry().getExtent())&&r.push(e)})}return r},C.getQueryLayerByCoordinates=function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.layer,i=t.coordinates;return new Promise(function(t,n){r.query({coordinates:i,mapProjection:e.getProjection(),resolution:e.getResolution()}).then(function(e){return t(e)}).fail(function(e){return n(e)})})},C.getQueryLayerPromiseByCoordinates=function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.layer,i=t.coordinates;return new Promise(function(t,n){r.query({coordinates:i,mapProjection:e.getProjection(),resolution:e.getResolution()}).then(function(e){return t(e)}).fail(function(e){return n(e)})})},C.activeMapControl=function(t){var e=this._mapControls.find(function(e){return t===e.type}).control;e.isToggled()||e.toggle()},C.createMapControl=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.id,r=t.visible,i=t.add,i=void 0===i||i,a=t.toggled,t=t.options,a=E[e]?new E[e](o({type:e,toggled:void 0!==a&&a},void 0===t?{}:t)):void 0;return void 0===r&&(r=!a.isVisible||a.isVisible()),a&&this.addControl(n||e,e,a,i,r),a},C.addScaleLineUnits=function(){var t=this;(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(e){return t.state.mapunits.push(e)})},C.changeScaleLineUnit=function(e){var t=this.getMapControlByType({type:"scaleline"});t&&t.getOlControl().setUnits(e)},C.showAddLayerModal=function(){this.emit("addexternallayer")},C._checkMapControls=function(){this._changeMapMapControls.forEach(function(e){var t=e.control,e=e.getLayers;t.change(e())})},C._setupControls=function(){var e,u=this;if(this.getMapLayers().forEach(function(e){return e.getSource().setAttributions(u.getApplicationAttribution())}),(this.getApplicationAttribution()||(0,l.getMapLayersByFilter)({BASELAYER:!0}).length)&&(e=new ol.control.Attribution({collapsible:!1,target:"map_footer_left"}),this.getMap().addControl(e)),this.config&&this.config.mapcontrols)return e=Array.isArray(this.config.mapcontrols)?this.config.mapcontrols.reduce(function(e,t){return e[t]={},e},{}):this.config.mapcontrols,Object.entries(e).forEach(function(e){var t,n,r,i,a,e=c(e,2),o=e[0],e=e[1],s=void 0===e?{}:e,l=void 0;switch(o){case"reset":isMobile.any||(l=new L({type:"reset"})),u.addControl(o,l,!1);break;case"zoom":l=u.createMapControl(o,{options:{zoomInLabel:"",zoomOutLabel:""}});break;case"zoombox":isMobile.any||(l=u.createMapControl(o,{})).on("zoomend",function(e){u.viewer.fit(e.extent)});break;case"zoomtoextent":l=u.createMapControl(o,{options:{label:"",extent:u.project.state.initextent}});break;case"mouseposition":isMobile.any||(t="m"===u.getProjection().getUnits()?["X","Y"]:["Lng","Lat"],n=u.getCrs(),l=u.createMapControl(o,{add:!1,options:{coordinateFormat:function(e){return ol.coordinate.format(e,""+t[0]+": {x}, "+t[1]+": {y} ["+n+"]",4)},undefinedHTML:!1,projection:u.getCrs()}}),"EPSG:4326"!==u.getEpsg()&&(r=u.getEpsg(),i=["Lng","Lat"],a=u.getCrs(),l=u.createMapControl(o,{add:!1,options:{target:"mouse-position-control-epsg-4326",coordinateFormat:function(e){return e=ol.proj.transform(e,r,"EPSG:4326"),ol.coordinate.format(e,""+i[0]+": {x}, "+i[1]+": {y} ["+a+"]",4)},undefinedHTML:!1,projection:u.getCrs()}})));break;case"screenshot":case"geoscreenshot":isMobile.any||(l=u.createMapControl(o,{options:{layers:[].concat(v(d.default.getLayers()),v(u._externalLayers)),onclick:u._handlePrint.bind(u,o)}}));break;case"scale":l=u.createMapControl(o,{add:!1,options:{coordinateFormat:ol.coordinate.createStringXY(4),projection:u.getCrs(),isMobile:isMobile.any}});break;case"query":l=u.createMapControl(o,{add:!0,toggled:!0});break;case"querybypolygon":case"querybbox":case"querybydrawpolygon":isMobile.any||(l=u.createMapControl(o,{options:{spatialMethod:"intersects"}}));break;case"streetview":l=u.createMapControl(o,{});break;case"scaleline":l=u.createMapControl(o,{add:!1,options:{position:"br"}});break;case"overview":!isMobile.any&&u.config.overviewproject&&u.config.overviewproject.gid&&p.default.getProject(u.config.overviewproject.gid).then(function(e){var n=u.getMap(),r=new ol.View(u._calculateViewOptions({project:e,width:200,height:150}));r.on("change:center",function(){var e=r.getCenter(),t=n.getView().constrainCenter(e);t[0]===e[0]&&t[1]===e[1]||r.setCenter(t)}),l=u.createMapControl(o,{add:!1,options:{view:r,position:"bl",collapsed:!1,className:"ol-overviewmap ol-custom-overviewmap",collapseLabel:$('<span class="'+y.default.getFontClass("arrow-left")+'"></span>')[0],label:$('<span class="'+y.default.getFontClass("arrow-right")+'"></span>')[0],layers:u.getOverviewMapLayers(e)}}),document.querySelector(".g3w-map-controls-left-bottom").style.left="230px",new MutationObserver(function(e){e.forEach(function(e){"class"===e.attributeName&&(document.querySelector(".g3w-map-controls-left-bottom").style.left=e.target.classList.contains("ol-collapsed")?"50px":"230px")})}).observe(document.querySelector(".ol-custom-overviewmap"),{attributes:!0})});break;case"geocoding":case"nominatim":l=u.createMapControl(o,{add:!1,options:{config:s}});break;case"geolocation":(l=u.createMapControl(o)).on("click",Q(function(e){return u.showMarker(e.coordinates)}));break;case"addlayers":isMobile.any||(l=u.createMapControl(o,{})).on("addlayer",function(){return u.emit("addexternallayer")});break;case"length":isMobile.any||(l=u.createMapControl(o,{options:{tipLabel:"sdk.mapcontrols.measures.length.tooltip",interactionClassOptions:{projection:u.getProjection(),help:"sdk.mapcontrols.measures.length.help"}}}));break;case"area":isMobile.any||(l=u.createMapControl(o,{options:{tipLabel:"sdk.mapcontrols.measures.area.tooltip",interactionClassOptions:{projection:u.getProjection(),help:"sdk.mapcontrols.measures.area.help"}}}));break;case"zoomhistory":l=u.createMapControl(o,{add:!1}),u._addControlToMapControlsLeftBottom(l)}}),this.getMapControls()},C.setZIndexLayer=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,e=e.zindex,e=void 0===e?this.getMap().getLayers().getLength():e;t&&t.setZIndex(e)},C.getLayerZindex=function(e){return e&&e.getZIndex()},C.getCenter=function(){return this.getMap().getView().getCenter()},C.zoomToFid=g(function*(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"").split(1<arguments.length&&void 0!==arguments[1]?arguments[1]:"|"),e=c(e,2),t=e[0],e=e[1];void 0===t&&void 0===e||(t=(e=void 0===(t=(yield u.default.getData("search:fids",{inputs:{layer:this.project.getLayerById(t),fids:[e]},outputs:{show:{loading:!1,condition:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).data,e=void 0===e?[]:e;return e[0]&&0<e[0].features.length}}}})).data)?[]:t)[0]&&e[0].features[0])&&(yield this.zoomToFeatures([t]))}),C.handleZoomToFeaturesUrlParameter=g(function*(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).zoom_to_features,e=void 0===e?"":e;try{var t,n,r,i,a=e.split(":"),o=c(a,2),s=o[0],l=o[1];s&&l&&(n=(t=this.project.getLayers().find(function(e){return s===e.id||s===e.name||s===e.origname}))&&this.project.getLayerById(t.id),i=(r=t&&(yield u.default.getData("search:features",{inputs:{layer:n,filter:Z({layer:n,filter:l})},outputs:{show:{loading:!1}}})))&&r.data&&r.data[0]&&r.data[0].features)&&this.zoomToFeatures(i)}catch(e){}}),C.getMapExtent=function(){var e=this.getMap();return e.getView().calculateExtent(e.getSize())},C.addMapExtentUrlParameterToUrl=function(e,t){return(e=new URL(e)).searchParams.set("map_extent",(void 0!==t&&this.getEpsg()!==t?ol.proj.transformExtent(this.getMapExtent(),this.getEpsg(),t):this.getMapExtent()).toString()),e.toString()},C.getMapExtentUrl=function(){var e=new URL(location.href);return e.searchParams.set("map_extent",this.getMapExtent().toString()),e.toString()},C.createCopyMapExtentUrl=function(){W(this.getMapExtentUrl())},C._setMapControlsGrid=function(e){var t,n=this.state.mapControl.grid;e<2?(t=n[n.length-1],n.push({rows:2*t.rows,columns:2})):2===e?n.length?(t=n[n.length-1],n.push({rows:t.columns,columns:t.rows})):n.push({rows:1,columns:2}):3===e?(t=n[n.length-1],n.push({rows:2*t.rows,columns:e})):(n.push({rows:n.length+1+(Number.isInteger(e)?0:1),columns:Number.isInteger(e)?e:parseInt(e)+1}),t=Number.isInteger(e)?e:parseInt(e),this._setMapControlsGrid(t/2))},C._setMapControlsInsideContainerLenght=function(){var t=this;this.state.mapControl.length=1,this._mapControls.forEach(function(e){t.state.mapControl.length+=e.mapcontrol?"zoom"===e.id?2:1:0,e.control.changelayout&&e.control.changelayout(t.getMap())}),this.state.mapControl.length+=this.state.mapControl.length%2,this.state.mapControl.grid=[],this._setMapControlsGrid(this.state.mapControl.length)},C.filterableLayersAvailable=function(){return(0,l.getMapLayersByFilter)({FILTERABLE:!0,SELECTED_OR_ALL:!0},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).filter(function(e){return"wfs"===e.getProvider("filter").getName()})},C.setMapControlsAlignement=function(){this.state.mapcontrolsalignement=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"rv"},C.getMapControlsAlignement=function(){return this.state.mapcontrolsalignement},C.isMapControlsVerticalAlignement=function(){return-1!==this.state.mapcontrolsalignement.indexOf("v")},C.setMapControlsVerticalAlignement=function(){this.state.mapcontrolsalignement=this.state.mapcontrolsalignement[0]+"v"},C.setMapControlsHorizontalAlignement=function(){this.state.mapcontrolsalignement=this.state.mapcontrolsalignement[0]+"h"},C.flipControlsHorizontally=function(){this.state.mapcontrolsalignement="r"===this.state.mapcontrolsalignement[0]?"l"+this.state.mapcontrolsalignement[1]:"r"+this.state.mapcontrolsalignement[1]},C.flipMapControlsVertically=function(){this.state.mapcontrolsalignment="v"===this.state.mapcontrolsalignement[1]?this.state.mapcontrolsalignement[0]+"h":this.state.mapcontrolsalignement[0]+"v"},C.setMapControlsContainer=function(e){this.state.mapcontrolDOM=e},C._updateMapControlsLayout=function(){var r,i=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.width,a=e.height;0==t||0==a?this.state.mapcontrolDOM.css("z-index",0):this.state.mapcontrolDOM.css("z-index",1),this.state.mapcontrolready&&this.state.mapControl.update&&(r={changed:!1,space:!1},this._mapControls.forEach(function(e){return e.control.changelayout?e.control.changelayout(i.getMap()):null}),this.isMapControlsVerticalAlignement()?function e(){var t=i.state.mapControl.grid[i.state.mapControl.currentIndex].columns*i.state.mapcontrolSizes.minWidth,n=document.getElementsByClassName(".ol-control-b"+i.getMapControlsAlignement()[0]),n=n.length?$(n[n.length-1]).getBoundingClientRect().top:a,n=0<n?n-t:a-t;n<10?(i.state.mapControl.currentIndex=i.state.mapControl.currentIndex===i.state.mapControl.grid.length-1?i.state.mapControl.currentIndex:i.state.mapControl.currentIndex+1,r.changed=!0):15+(0<i.state.mapControl.currentIndex?i.state.mapControl.grid[i.state.mapControl.currentIndex-1].columns*i.state.mapcontrolSizes.minWidth-t:t)<n&&(r.changed=!0,r.space=!0,i.state.mapControl.currentIndex=0===i.state.mapControl.currentIndex?i.state.mapControl.currentIndex:i.state.mapControl.currentIndex-1),r.changed&&(t=i.state.mapControl.grid[i.state.mapControl.currentIndex].columns*i.state.mapcontrolSizes.minWidth,n=i.state.mapControl.grid[i.state.mapControl.currentIndex].rows*i.state.mapcontrolSizes.minWidth,i.state.mapcontrolDOM.css("height",t+"px"),i.state.mapcontrolDOM.css("width",n+"px"),r.changed=!1,r.space)&&setTimeout(e)}():isMobile.any&&this.setMapControlsAlignement("rv"))},C._setMapControlVisible=function(e){var t=e.control,e=e.visible;t&&t.setVisible(void 0===e||e)},C._addControlToMapControls=function(e){1<arguments.length&&void 0!==arguments[1]&&!arguments[1]&&(e.element.style.display="none"),$(".g3w-map-controls").append(e.element)},C._addControlToMapControlsLeftBottom=function(e){1<arguments.length&&void 0!==arguments[1]&&!arguments[1]&&(e.element.style.display="none"),$(".g3w-map-controls-left-bottom").append(e.element)},C.getMapControlByType=function(){var t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).type,e=this._mapControls.find(function(e){return t===e.type});return e&&e.control},C.addControl=function(e,t,n){var r=this,i=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],a=!(4<arguments.length&&void 0!==arguments[4])||arguments[4],o=(this.state.mapcontrolready=!1,this.viewer.map.addControl(n),n.on("toggled",function(e){return r.emit("mapcontrol:toggled",e)}),this._mapControls.push({id:e,type:t,control:n,visible:a,mapcontrol:i&&a}),n.on("controlclick",function(e){var e=e.target,t=e.isClickMap&&e.isClickMap()||!1;t&&r._externalInteractions.forEach(function(e){return e.setActive(!1)}),r.controlClick(e,{clickmap:t})}),$(n.element).find("button"));o.tooltip({placement:"bottom",container:"body",trigger:y.default.isMobile()?"click":"hover"}),y.default.isMobile()&&o.on("shown.bs.tooltip",function(){var e=this;setTimeout(function(){return $(e).tooltip("hide")},600)}),i?this._addControlToMapControls(n,a):(o=$("#"+this.getMap().getTarget()),this._updateMapControlsLayout({width:o.width(),height:o.height()})),s.default.registerControl(t,n),this._setMapControlsInsideContainerLenght(),this.state.mapcontrolready=!0},C.showControl=function(e){this.showControls([e])},C.hideControl=function(e){this.hideControls([e])},C.showControls=function(e){this.toggleControls(!0,e)},C.hideControls=function(e){this.toggleControls(!1,e)},C.showAllControls=function(){this.toggleControls(!0)},C.hideAllControls=function(){this.toggleControls(!1)},C.toggleControls=function(t,n){this._removeControls(),this._mapControls.forEach(function(e){(!n||-1<n.indexOf(e.type))&&(e.visible=t)}),this._layoutControls()},C._layoutControls=function(){var t=this;this._mapControls.forEach(function(e){e.visible&&t.viewer.map.addControl(e.control)})},C.getMapControls=function(){return this._mapControls},C.removeControlById=function(n){var r=this;this._mapControls.find(function(e,t){if(n===e.id)return r._mapControls.splice(t,1),t=e.control,r.viewer.map.removeControl(t),t.hideControl&&t.hideControl(),!0})},C.removeControl=function(n){var r=this;this._mapControls.find(function(e,t){if(n===e.type)return r._mapControls.splice(t,1),t=e.control,r.viewer.map.removeControl(t),t.hideControl&&t.hideControl(),!0})},C._removeControls=function(){var t=this;this._mapControls.forEach(function(e){return t.viewer.map.removeControl(e.control)})},C._unToggleControls=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).close,t=void 0===e||e;this._mapControls.forEach(function(e){e.control.isToggled&&e.control.isToggled()&&(e.control.toggle(!1),t)&&y.default.closeContent()})},C.deactiveMapControls=function(){this._unToggleControls({close:!1})},C.disableClickMapControls=function(){var t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this._mapControls.forEach(function(e){e=e.control;!!e.isClickMap&&e.isClickMap()&&(e.isToggled()&&e.toggle(),e[t?"disable":"enable"]())})},C.addMapLayers=function(e){var t=this;e.reverse().forEach(function(e){return t.addMapLayer(e)})},C._setupCustomMapParamsToLegendUrl=function(){var t,e,n,r=this;0<arguments.length&&void 0!==arguments[0]&&!arguments[0]||(e=(t=this.getMap())&&t.getSize().filter(function(e){return 0<e})||null,n=e&&2===e.length?t.getView().calculateExtent(e):this.project.state.initextent,this.getMapLayers().forEach(function(e){e.setupCustomMapParamsToLegendUrl&&e.setupCustomMapParamsToLegendUrl({crs:r.getEpsg(),bbox:"neu"===t.getView().getProjection().getAxisOrientation()?[n[1],n[0],n[3],n[2]]:n})}),this.emit("change-map-legend-params"))},C.addMapLayer=function(e){this._mapLayers.push(e),this.addLayerToMap(e)},C.getMapLayerByLayerId=function(t){return this.getMapLayers().find(function(e){return e.getLayerConfigs().find(function(e){return t===e.getId()})})},C.getMapLayers=function(){return this._mapLayers},C.getBaseLayers=function(){return this.mapBaseLayers},C.getMapLayerForLayer=function(t){return this.getMapLayers().find(function(e){return"layer_"+t.getMultiLayerId()===e.getId()})},C.getProjectLayer=function(e){return d.default.getLayerById(e)},C._setSettings=function(){var e=m.MAP_SETTINGS.ZOOM,t=this.getScaleFromExtent(this.project.state.initextent);e.maxScale=e.maxScale>t?t:e.maxScale},C._resetView=function(){var e=this.viewer.map.getSize(),e=c(e,2),t=e[0],e=e[1],n=this.project.state.extent,t=ol.extent.getWidth(n)/t,e=ol.extent.getHeight(n)/e,t=Math.max(t,e)>this.viewer.map.getView().getMaxResolution()?Math.max(t,e):this.viewer.map.getView().getMaxResolution(),e=new ol.View({extent:n,projection:this.viewer.map.getView().getProjection(),center:this.viewer.map.getView().getCenter(),resolution:this.viewer.map.getView().getResolution(),maxResolution:t});this._setSettings(),this.viewer.map.setView(e)},C._calculateViewOptions=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.project,n=e.width,r=e.height,e=e.map_extent,e=e?e.split(",").map(function(e){return+e}):t.state.initextent,t=t.state.extent;return{extent:t,projection:this.getProjection(),center:ol.extent.getCenter(e),maxResolution:Math.max(ol.extent.getWidth(t)/n,ol.extent.getHeight(t)/r),resolution:Math.max(ol.extent.getWidth(e)/n,ol.extent.getHeight(e)/r)}},C._setupViewer=function(e,t){var n=this,r=new URLSearchParams(location.search),i=+(r.get("showmarker")||0),a=r.get("iframetype"),o=r.get("map_extent"),s=r.get("zoom_to_fid"),l=r.get("ztf"),u={lat:parseFloat(r.get("lat")),lon:parseFloat(r.get("lon")),x:parseFloat(r.get("x")),y:parseFloat(r.get("y"))};new Promise(function(t){setTimeout(g(function*(){var e=void 0;s?yield n.zoomToFid(s):l?yield n.handleZoomToFeaturesUrlParameter({zoom_to_features:l}):isNaN(u.lat)||isNaN(u.lon)?isNaN(u.x)||isNaN(u.y)||(e=new ol.geom.Point([u.x,u.y])):e=new ol.geom.Point(ol.proj.transform([u.lon,u.lat],"EPSG:4326",n.getEpsg())),e&&e.getExtent()&&(yield n.zoomToGeometry(e)),t()}))}).then(function(){1==i&&n.defaultsLayers.mapcenter.getSource().addFeature(new ol.Feature({geometry:new ol.geom.Point(n.getCenter())}))}),"map"===a&&(this.config.mapcontrols={}),this.viewer=new T({id:this.target,view:this._calculateViewOptions({width:e,height:t,project:this.project,map_extent:o})}),this._setSettings(),this.state.size=this.viewer.map.getSize(),this.state.mapUnits=this.viewer.map.getView().getProjection().getUnits(),this.config.background_color&&$("#"+this.target).css("background-color",this.config.background_color),$(this.viewer.map.getViewport()).prepend('<div id="map-spinner" style="position:absolute; top: 50%; right: 50%"></div>'),this.viewer.map.getInteractions().forEach(function(e){return n._watchInteraction(e)}),this.viewer.map.getInteractions().on("add",function(e){return n._watchInteraction(e.element)}),this.viewer.map.getInteractions().on("remove",function(e){}),this._marker=new ol.Overlay({position:null,positioning:"center-center",element:document.getElementById("marker"),stopEvent:!1}),this.viewer.map.addOverlay(this._marker),this.viewer.map.getLayers().on("add",function(e){n.moveDefaultLayersOnTop(n.setLayerZIndex({layer:e.element,zindex:e.element.get("basemap")||"bottom"===e.element.get("position")?0:void 0}))}),this.viewer.map.getLayers().on("remove",function(e){e.element.getZIndex()===n.layersCount&&n.layersCount--})},C.getMapUnits=function(){return this.state.mapUnits},C._removeListeners=function(){this._setBaseLayerListenerKey&&this.project.un("setBaseLayer",this._setBaseLayerListenerKey)},C._removeEventsKeysToLayersStore=function(n){var e=n.getId();this._layersStoresEventKeys[e]&&(this._layersStoresEventKeys[e].forEach(function(e){Object.entries(e).forEach(function(e){var e=c(e,2),t=e[0],e=e[1];return n.un(t,e)})}),delete this._layersStoresEventKeys[e])},C._setUpEventsKeysToLayersStore=function(e){var t=this,n=e.getId();this._layersStoresEventKeys[n]=[],this._layersStoresEventKeys[n].push({addLayer:e.onafter("addLayer",function(e){"vector"===e.getType()&&t.addLayerToMap(e.getMapLayer())})}),this._layersStoresEventKeys[n].push({removeLayer:e.onafter("removeLayer",function(e){"vector"===e.getType()&&t.viewer.map.removeLayer(e.getOLLayer())})})},C._setupListeners=function(){var e=this;this._setBaseLayerListenerKey=this.project.onafter("setBaseLayer",function(){e.updateMapLayers()})},C._setupAllLayers=function(){this._setupBaseLayers(),this._setupMapLayers(),this._setupVectorLayers();var e=this.getMap();e.addLayer(this.defaultsLayers.mapcenter),e.addLayer(this.defaultsLayers.selectionLayer),e.addLayer(this.defaultsLayers.highlightLayer)},C._setupBaseLayers=function(){var n=this,e=(0,l.getMapLayersByFilter)({BASELAYER:!0});e.forEach(function(e){var t=e.getMapLayer();n.registerMapLayerListeners(t),n.mapBaseLayers[e.getId()]=t}),Object.values(e.length?this.mapBaseLayers:{}).reverse().forEach(function(e){e.update(n.state,n.layersExtraParams),n.addLayerToMap(e)})},C._setupMapLayers=function(){var i=this,e=(0,l.getMapLayersByFilter)({BASELAYER:!1,VECTORLAYER:!1}),n=(this._setMapProjectionToLayers(e),{}),a=[];Object.entries(_.groupBy(e,function(e){var t=e.getMultiLayerId();return e.isQtimeseries()?(n[t]=void 0===n[t]?0:n[t]+1,t+"_"+n[t]):void 0===n[t]?t:t+"_"+(n[t]+1)})).forEach(function(e){var e=c(e,2),t=e[0],e=e[1],n=e[0]||[],r=n.getMapLayer({id:"layer_"+t,projection:i.getProjection(),format:1===e.length?n.getFormat():null},1===e.length?{}:i.layersExtraParams);e.reverse().forEach(function(e){return r.addLayer(e)}),a.push(r),i.registerMapLayerListeners(r)}),this.addMapLayers(a),this.updateMapLayers()},C._setupVectorLayers=function(){var t=this,e=(0,l.getMapLayersByFilter)({VECTORLAYER:!0});this._setMapProjectionToLayers(e),e.forEach(function(e){t.addLayerToMap(e.getMapLayer())})},C.moveDefaultLayersOnTop=function(e){this.setZIndexLayer({layer:this.defaultsLayers.mapcenter,zindex:e+1}),this.setZIndexLayer({layer:this.defaultsLayers.highlightLayer,zindex:e+1}),this.setZIndexLayer({layer:this.defaultsLayers.selectionLayer,zindex:e+2})},C.removeDefaultLayers=function(){this.defaultsLayers.mapcenter.getSource().clear(),this.defaultsLayers.highlightLayer.getSource().clear(),this.defaultsLayers.selectionLayer.getSource().clear(),this.getMap().removeLayer(this.defaultsLayers.mapcenter),this.getMap().removeLayer(this.defaultsLayers.highlightLayer),this.getMap().removeLayer(this.defaultsLayers.selectionLayer)},C.setDefaultLayerStyle=function(e){e&&this.defaultsLayers[e]&&(this.defaultsLayers._style[e]=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{})},C.resetDefaultLayerStyle=function(e){e&&this.defaultsLayers[e]&&(this.defaultsLayers._style[e]={color:"highlightLayer"===e?void 0:"red"})},C.removeLayers=function(){this._removeBaseLayers(),this._removeMapLayers(),this.removeExternalLayers(),this.removeDefaultLayers()},C.removeAllLayers=function(){this.viewer.removeLayers()},C.setLayerZIndex=function(e){var t=e.layer,e=e.zindex,e=void 0===e?this.layersCount+=1:e;return t.setZIndex(e),this.emit("set-layer-zindex",{layer:t,zindex:e}),e},C.addLayerToMap=function(e){e=e.getOLLayer();e&&this.getMap().addLayer(e)},C._setMapProjectionToLayers=function(e){var t=this;e.forEach(function(e){return e.setMapProjection(t.getProjection())})},C.createMapLayer=function(e){e.setMapProjection(this.getProjection());var t=e.getMapLayer({id:"layer_"+e.getMultiLayerId(),projection:this.getProjection()},this.layersExtraParams);return t.addLayer(e),t},C.getOverviewMapLayers=function(r){var i=e("core/layers/map/wmslayer"),a=[];return Object.entries(_.groupBy(r.getLayersStore().getLayers({GEOLAYER:!0,BASELAYER:!1}),function(e){return e.getMultiLayerId()})).forEach(function(e){var e=c(e,2),t=e[0],e=e[1],n=new i({url:r.getWmsUrl(),id:"overview_layer_"+t,tiled:e[0].state.tiled});e.reverse().forEach(function(e){return n.addLayer(e)}),a.push(n.getOLLayer(!0))}),a.reverse()},C.updateMapLayer=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{force:!1},n=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).showSpinner,n=void 0===n||n;return t.force&&(t.g3w_time=Date.now()),n!==e.showSpinnerWhenLoading&&this[(e.showSpinnerWhenLoading=n)?"registerMapLayerLoadingEvents":"unregisterMapLayerLoadingEvents"](e),e.update(this.state,t),e},C.updateMapLayers=function(){var t=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.getMapLayers().forEach(function(e){return t.updateMapLayer(e,n)}),Object.values(this.getBaseLayers()).forEach(function(e){return e.update(t.state,t.layersExtraParams)})},C.registerMapLayerListeners=function(t){var n=this,e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];this.registerMapLayerLoadingEvents(t),e&&t.layers&&Array.isArray(t.layers)&&t.layers.forEach(function(e){e.onbefore("change",function(){return n.updateMapLayer(t,{force:!0})}),e.on("filtertokenchange",function(){return n.updateMapLayer(t,{force:!0})})})},C.registerMapLayerLoadingEvents=function(e){e.on("loadstart",this._incrementLoaders),e.on("loadend",this._decrementLoaders),e.on("loaderror",this._mapLayerLoadError)},C.unregisterMapLayerLoadingEvents=function(e){e.off("loadstart",this._incrementLoaders),e.off("loadend",this._decrementLoaders),e.off("loaderror",this._mapLayerLoadError)},C.unregisterMapLayerListeners=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this.unregisterMapLayerLoadingEvents(e),t&&e.layers&&Array.isArray(e.layers)&&e.layers.forEach(function(e){e.un("change"),e.removeEvent("filtertokenchange")})},C.setTarget=function(e){this.target=e},C.getCurrentToggledMapControl=function(){var e=this._mapControls.find(function(e){e=e.control;return e&&e.isToggled&&e.isToggled()});return e&&e.control},C.addInteraction=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{active:!0,close:!0},n=t.active,n=void 0===n||n,r=this.getCurrentToggledMapControl(),i=r&&r.isToggled&&r.isToggled()||!1;return(!r||!r.isClickMap||r.isClickMap())&&n&&this._unToggleControls(t),this.getMap().addInteraction(e),e.setActive(n),this._externalInteractions.push(e),{control:r,toggled:i}},C.removeInteraction=function(t){t&&t.setActive(!1),this.viewer.map.removeInteraction(t),this._externalInteractions=this._externalInteractions.filter(function(e){return t!==e})},C._watchInteraction=function(e){var t=this;e.on("change:active",function(e){e.target instanceof ol.interaction.Pointer&&e.target.getActive()&&t.emit("mapcontrol:active",e.target)})},C.showMapInfo=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.info,e=e.style;this.state.map_info.info=t,this.state.map_info.style=e||this.state.map_info.style},C.hideMapInfo=function(){this.state.map_info.info=null,this.state.map_info.style=null},C.zoomTo=function(e){this.viewer.zoomTo(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:6)},C.goTo=function(e,t){this.viewer.goTo(e,{zoom:t||6})},C.goToRes=(P=g(function*(e,t){yield this.viewer.goToRes(e,{resolution:t})}),function(e,t){return P.apply(this,arguments)}),C.getGeometryAndExtentFromFeatures=function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=void 0,n=void 0,r=void 0,i=void 0,a=[],o=0;o<e.length;o++){var s,l=e[o],u=l.getGeometry?l.getGeometry():l.geometry;u&&(u instanceof ol.geom.Geometry?(s=[].concat(v(u.getExtent())),t=t?ol.extent.extend(t,s):s,n=n||u.getType(),i=u.getCoordinates(),n.includes("Multi")?a=[].concat(v(a),v(i)):a.push(i)):(s=l.bbox,t=t?ol.extent.extend(t,s):s,n=u.type,i=u.coordinates),n.includes("Multi")?a=[].concat(v(a),v(i)):a.push(i))}try{var c=n.includes("Multi")?n:"Multi"+n,r=new ol.geom[c](a);void 0===t&&(t=r.getExtent())}catch(e){}return{extent:t,geometry:r}},C.highlightFeatures=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=this.getGeometryAndExtentFromFeatures(e).geometry;t.zoom=!1,this.highlightGeometry(n,t)},C.zoomToGeometry=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{highlight:!1},n=e&&e.getExtent();return t.highlight&&n&&(t.highLightGeometry=e),this.zoomToExtent(n,t)},C.zoomToFeatures=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{highlight:!1},n=this.getGeometryAndExtentFromFeatures(e),r=n.geometry,n=n.extent;return t.highlight&&n&&(t.highLightGeometry=r),this.zoomToExtent(n,t)},C.zoomToExtent=(O=g(function*(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(!e)return Promise.resolve();yield this.goToRes(ol.extent.getCenter(e),this.getResolutionForZoomToExtent(e,{force:t.force||!1})),t.highLightGeometry&&(yield this.highlightGeometry(t.highLightGeometry,{zoom:!1,duration:t.duration}))}),function(e){return O.apply(this,arguments)}),C.zoomToProjectInitExtent=function(){return this.zoomToExtent(this.project.state.initextent)},C.compareExtentWithProjectMaxExtent=function(e){return ol.extent.containsExtent(this.project.state.extent,e)?e:this.project.state.extent},C.getResolutionForZoomToExtent=function(e){var t,n,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{force:!1},i=this.getMap();return!1===ol.extent.containsExtent(this.project.state.extent,e)?i.getView().getResolutionForExtent(this.project.state.extent,i.getSize()):(t=i.getView().getResolutionForExtent(e,i.getSize()),!0===r.force?t:(r=void 0,(i=i.getView().getResolution())<(r=(n=(0,z.getResolutionFromScale)(m.MAP_SETTINGS.ZOOM.maxScale,this.getMapUnits()))<t?t:n)&&t<i?i:r))},C.goToBBox=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.getEpsg();e=t===this.getEpsg()?e:ol.proj.transformExtent(e,t,this.getEpsg()),this.viewer.fit(this.compareExtentWithProjectMaxExtent(e))},C.goToWGS84=function(e,t){e=ol.proj.transform(e,"EPSG:4326",this.project.state.crs.epsg),this.goTo(e,t)},C.extentToWGS84=function(e){return ol.proj.transformExtent(e,this.project.state.crs.epsg,"EPSG:4326")},!(C.getResolutionForMeters=function(e){var t=this.viewer.map.getViewport();return e/Math.max(t.clientWidth,t.clientHeight)}));function A(){function e(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};switch(this._control=null,this.positionCode=e.position||"tl",e.type){case"zoom":this._control=new ol.control.Zoom(e);break;case"zoomtoextent":this._control=new ol.control.ZoomToExtent(e);break;case"scaleline":this._control=new ol.control.ScaleLine(e);break;case"overview":this._control=new ol.control.OverviewMap(e)}$(this._control.element).addClass("ol-control-"+this.positionCode),this.offline=!0,this.getOlControl=function(){return this._control},this.getPosition=function(e){return{top:-1<(e=e||this.positionCode).indexOf("t"),left:-1<e.indexOf("l")}},this.layout=function(e){var t,n;e&&(e=$(e.getViewport()).find(".ol-control-"+this.positionCode)).length&&(t=this.getPosition(),e=e.last(),n=t.left?e.position().left:e.position().right,t=t.left?"left":"right",n=$(this.element).position()[t]+n+e[0].offsetWidth+2,$(this.element).css(t,n+"px"))},this.changelayout=function(){},this.showHide=function(){$(this.element).toggle()},this.setMap=function(e){this.layout(e),this._control.setMap(e)},ol.control.Control.call(this,{element:this._control.element})}return ol.inherits(e,ol.control.Control),e}function R(i){function e(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t={name:i},n=y.default.getService("map").getProject(),r=void 0;switch(i){case"zoomhistory":r=Vue.extend(a.default),t.element=new r,t.tipLabel="sdk.mapcontrols.addlayer.tooltip";break;case"nominatim":case"geocoding":r=Vue.extend(G.default),t.element=new r({propsData:o({},e.config,{placeholder:(void 0!==e.placeholder?e.placeholder:"mapcontrols.geocoding.placeholder")||"Citt, indirizzo ... ",noresults:(void 0!==e.noresults?e.noresults:"mapcontrols.geocoding.noresults")||"Nessun risultato ",limit:e.limit||5,viewbox:void 0!==e.bbox?e.bbox:n.state.initextent||n.state.extent,mapCrs:void 0!==e.mapCrs?e.mapCrs:n.state.crs.epsg})}),t.offline=!1}t.element=t.element.$mount().$el,S.call(this,t)}return ol.inherits(e,S),e}C.setSelectionFeatures=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"add",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.feature,t=t.color,r=(t&&this.setDefaultLayerStyle("selectionLayer",{color:t}),this.defaultsLayers.selectionLayer.getSource());switch(e){case"add":r.addFeature(n);break;case"remove":r.removeFeature(n);break;case"update":r.getFeatureById(n.getId()).setGeometry(n.getGeometry());break;case"clear":r.clear()}},C.clearSelectionFeatures=function(){this.defaultsLayers.selectionLayer.getSource().clear()},C.setSelectionLayerVisible=function(){this.defaultsLayers.selectionLayer.setVisible(!(0<arguments.length&&void 0!==arguments[0])||arguments[0])},C.highlightGeometry=function(e){var t,n=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=r.duration||m.MAP_SETTINGS.ANIMATION.duration,a=this.defaultsLayers.highlightLayer,o="function"==typeof r.hide?r.hide:null,s="boolean"!=typeof r.highlight||r.highlight,l="boolean"!=typeof r.zoom||r.zoom,u=e instanceof ol.geom.Geometry?e:(new ol.format.GeoJSON).readGeometry(e);return this.clearHighlightGeometry(),this.setDefaultLayerStyle("highlightLayer",{color:r.color}),new Promise((t=g(function*(e){if(l&&(yield n.zoomToExtent(u.getExtent())),!s)return e();r.style&&a.setStyle(r.style),a.getSource().addFeature(new ol.Feature({geometry:u}));function t(){a.getSource().clear(),r.style&&a.setStyle(function(e){return[(0,f.createSelectedStyle)({geometryType:e.getGeometry().getType(),color:r.color,fill:!1})]}),o||(j=!1),e()}o&&o(t),i&&i!==1/0&&!o&&(j=!0,setTimeout(t,i))}),function(e){return t.apply(this,arguments)}))},C.clearHighlightGeometry=function(){j||this.defaultsLayers.highlightLayer.getSource().clear(),this.resetDefaultLayerStyle("highlightLayer")},C.refreshMap=function(){this.updateMapLayers(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{force:!0})},C.layout=function(e){var t=e.width,e=e.height,n=document.getElementById(this.target),n=(n&&(n.style.height=e+"px",n.style.width=t+"px"),t<=0||e<=0);this.viewer?n||(this.getMap().updateSize(),this.state.hidemaps.forEach(function(e){return e.map.updateSize()}),this._updateMapView()):(this.setupViewer(t,e),this.viewer&&(this.setupControls(),this.emit("ready"))),this.setHidden(n),this._mapControls.length&&this._updateMapControlsLayout({width:t,height:e})},C._removeBaseLayers=function(){var t=this;Object.keys(this.mapBaseLayers).forEach(function(e){return t.viewer.map.removeLayer(t.mapBaseLayers[e].getOLLayer())})},C._removeMapLayers=function(){var t=this;this.getMapLayers().forEach(function(e){t.unregisterMapLayerListeners(e),t.viewer.map.removeLayer(e.getOLLayer())}),this._mapLayers=[]},C.getMapBBOX=function(){return this.viewer.getBBOX()},C._updateMapView=function(){this.updateMapView(this.viewer.getBBOX(),this.viewer.getResolution(),this.viewer.getCenter(),this.getMap().getSize())},C.getMapSize=function(){return this.viewer.map.getSize()},C.setInnerGreyCoverScale=function(e){this._drawShadow.scale=e},C._resetDrawShadowInner=function(){this._drawShadow={type:"coordinate",outer:[],inner:[],scale:null,rotation:null}},C.setInnerGreyCoverBBox=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=this.viewer.map,n=e.type||"coordinate",r=e.inner||null,i=e.rotation,e=e.scale,a=void 0,o=void 0;if(r){switch(n){case"coordinate":a=t.getPixelFromCoordinate([r[0],r[1]]),o=t.getPixelFromCoordinate([r[2],r[3]]);break;case"pixel":a=[r[0],r[1]],o=[r[2],r[3]]}var n=a[1]*ol.has.DEVICE_PIXEL_RATIO,s=a[0]*ol.has.DEVICE_PIXEL_RATIO,l=o[1]*ol.has.DEVICE_PIXEL_RATIO,u=o[0]*ol.has.DEVICE_PIXEL_RATIO;this._drawShadow.inner[0]=s,this._drawShadow.inner[1]=n,this._drawShadow.inner[2]=u,this._drawShadow.inner[3]=l}_.isNil(e)?this._drawShadow.scale=this._drawShadow.scale||1:this._drawShadow.scale=e,_.isNil(i)?this._drawShadow.rotation=this._drawShadow.rotation||0:this._drawShadow.rotation=i,this._drawShadow.outer&&t.render()},C.startDrawGreyCover=function(o){var s=this,e=this.viewer.map,l=void 0,u=void 0,c=void 0,d=void 0,p=void 0;this.stopDrawGreyCover();this._greyListenerKey=e.on("postcompose",function(e){var t=e.context,e=s.getMap().getSize(),n=e[1]*ol.has.DEVICE_PIXEL_RATIO,r=e[0]*ol.has.DEVICE_PIXEL_RATIO;if(s._drawShadow.outer=[0,0,r,n],t.restore(),t.beginPath(),t.moveTo(0,0),t.lineTo(r,0),t.lineTo(r,n),t.lineTo(0,n),t.lineTo(0,0),t.closePath(),s._drawShadow.inner.length&&(t.save(),l=s._drawShadow.inner[0],c=s._drawShadow.inner[3],u=s._drawShadow.inner[2],d=s._drawShadow.inner[1],p=s._drawShadow.rotation,s._drawShadow.scale,t.translate((u+l)/2,(d+c)/2),t.rotate(p*Math.PI/180),t.moveTo(-(u-l)/2,(d-c)/2),t.lineTo((u-l)/2,(d-c)/2),t.lineTo((u-l)/2,-(d-c)/2),t.lineTo(-(u-l)/2,-(d-c)/2),t.lineTo(-(u-l)/2,(d-c)/2),t.closePath()),t.fillStyle="rgba(0, 5, 25, 0.40)",t.fill(),o){t.font="bold 25px Arial",t.fillStyle="#ffffff",t.textAlign="center";for(var i=o.split("\n"),a=0;a<i.length;a++)t.fillText(i[a],r/2,n/2+30*a)}t.restore()})},C.stopDrawGreyCover=function(){this._greyListenerKey&&(ol.Observable.unByKey(this._greyListenerKey),this._greyListenerKey=null,this._drawShadow.inner.length)&&this._resetDrawShadowInner(),this.getMap().render()},C.removeExternalLayers=function(){var t=this;this._externalLayers.forEach(function(e){t.removeExternalLayer(e.get("name"))}),this._externalLayers=[]},C.changeLayerVisibility=function(e){var t=e.id,e=(e.external,e.visible),n=this.getLayerById(t);n&&(n.setVisible(e),this.emit("change-layer-visibility",{id:t,visible:e}))},C.changeLayerOpacity=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,e=e.opacity,e=void 0===e?1:e,n=this.getLayerById(t);n&&(n.setOpacity(e),this.emit("change-layer-opacity",{id:t,opacity:e}))},C.changeLayerMapPosition=function(e){var t=e.id,e=e.position,e=void 0===e?m.MAP_SETTINGS.LAYER_POSITIONS.default:e,n=this.getLayerById(t);switch(e){case"top":n.setZIndex(this.layersCount);break;case"bottom":n.setZIndex(0)}this.emit("change-layer-position-map",{id:t,position:e})},C.removeExternalLayer=function(e){var n=this,r=this.getLayerByName(e),t=(y.default.getService("queryresults").unregisterVectorLayer(r),this.viewer.map.removeLayer(r),r._type||"vector");y.default.getService("catalog").removeExternalLayer({name:e,type:t}),"wms"==t&&(this._externalMapLayers=this._externalMapLayers.filter(function(e){var t=e.getId()===r.id;return t&&n.unregisterMapLayerListeners(e,r.projectLayer),!t})),this._externalLayers=this._externalLayers.filter(function(e){return e.get("id")!==r.get("id")}),this.unloadExternalLayer(r),this.emit("remove-external-layer",e)},C.addExternalWMSLayer=function(){var i=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=e.url,o=e.layers,s=e.name,t=e.epsg,t=void 0===t?this.getEpsg():t,n=e.position,l=void 0===n?m.MAP_SETTINGS.LAYER_POSITIONS.default:n,u=e.opacity,n=e.visible,c=void 0===n||n,d=ol.proj.get(t);return new Promise(function(e,t){var n=(0,B.createWMSLayer)({name:s,url:a,layers:o,projection:d}),r=n.wmslayer,n=n.olLayer;r.once("loadend",function(){e(r)}),r.once("loaderror",function(e){t(e)}),i.addExternalLayer(n,{position:l,opacity:u,visible:c}),i.addExternalMapLayer(r,!1)})},C.getExternalLayers=function(){return this._externalLayers},C.addExternalMapLayer=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this._externalMapLayers.push(e),this.registerMapLayerListeners(e,t)},C.addExternalLayer=(F=g(function*(a){var o=this,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},t=void 0,n=void 0,r=void 0,i=void 0,s=void 0,l=e.position,u=void 0===l?m.MAP_SETTINGS.LAYER_POSITIONS.default:l,l=e.opacity,c=void 0===l?1:l,l=e.visible,d=void 0===l||l,p=this.viewer.map,f=y.default.getService("catalog"),h=y.default.getService("queryresults");if(a instanceof ol.layer.Vector){l=void 0;void 0===a.get("id")&&a.set("id",H()),(t=a).filter={active:!1},t.selection={active:!1,features:[]};try{var g=a.getStyle(),l=g._g3w_options?g._g3w_options.color:"blue"}catch(e){l="blue"}n=t.get("name")||t.get("id"),i="vector",a={id:a.get("id"),name:n,projectLayer:!1,title:n,removable:!0,external:!0,crs:e.crs,type:e.type,_type:i,download:e.download||!1,downloadUrl:e.downloadUrl,visible:d,checked:!0,position:u,opacity:c,color:l,filter:t.filter,selection:t.selection,tochighlightable:!1}}else a instanceof ol.layer.Image?(i="wms",n=a.get("name"),a.id=a.get("id"),a.removable=!0,a.projectLayer=!1,a.name=n,a.title=n,a._type=i,a.opacity=c,a.position=u,a.external=!0,a.checked=d):(n=a.name,i=a.type,s=a.crs,r=a.data,a.color);function v(e,t){var n,r,i;return e?(n=void 0,"vector"===t&&((r=e.getSource().getFeatures()).length&&(i=0,r.forEach(function(e){e.setId(i++)}),a.geometryType=r[0].getGeometry().getType(),a.selected=!1),n=e.getSource().getExtent(),a.bbox={minx:n[0],miny:n[1],maxx:n[2],maxy:n[3]}),e.set("position",u),e.setOpacity(c),e.setVisible(d),p.addLayer(e),o._externalLayers.push(e),h.registerVectorLayer(e),f.addExternalLayer({layer:a,type:t}),n&&p.getView().fit(n),o.loadExternalLayer(e),Promise.resolve(e)):Promise.reject()}if(this.getLayerByName(n))y.default.notify.warning("layer_is_added",!1);else switch(i){case"vector":return v(t,i);case"wms":return v(a,i);default:return v(t=yield(0,D.createVectorLayerFromFile)({name:n,type:i,crs:s,mapCrs:mapCrs,data:r,style:void 0}))}}),function(e){return F.apply(this,arguments)}),C.setExternalLayerStyle=function(e,t){e="rgba("+(e=e.rgba).r+","+e.g+","+e.b+","+e.a+")";var r={Point:new ol.style.Style({image:new ol.style.Circle({fill:new ol.style.Fill({color:e}),radius:5,stroke:new ol.style.Stroke({color:e,width:1})})}),LineString:new ol.style.Style({stroke:new ol.style.Stroke({color:e,width:3})}),Polygon:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255,255,255,0.5)"}),stroke:new ol.style.Stroke({color:e,width:3})}),MultiPoint:new ol.style.Style({image:new ol.style.Circle({fill:new ol.style.Fill({color:e}),radius:5,stroke:new ol.style.Stroke({color:e,width:1})})}),MultiLineString:new ol.style.Style({stroke:new ol.style.Stroke({color:e,width:3})}),MultiPolygon:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255,255,255,0.5)"}),stroke:new ol.style.Stroke({color:e,width:3})})};return function(e,t){var n=e.getStyleFunction();return n?n.call(e,t):r[e.getGeometry().getType()]}},C._handlePrint=(I=g(function*(e){var t=i.default.setDownload(!0);try{var n=yield this.createMapImage();"screenshot"===e?saveAs(n,"map_"+Date.now()+".png"):saveAs(yield(0,V.getGeoTIFFfromServer)({url:"/"+this.project.getType()+"/api/asgeotiff/"+this.project.getId()+"/",method:"POST",params:{image:n,csrfmiddlewaretoken:this.getCookie("csrftoken"),bbox:this.getMapBBOX().toString()}}),"map_"+Date.now()+".tif")}catch(e){y.default.showUserMessage({type:"SecurityError"===e.name?"warning":"alert",message:"SecurityError"===e.name?"mapcontrols.screenshot.securityError":"mapcontrols.screenshot.error",autoclose:!1})}return i.default.setDownload(!1,t),!0}),function(e){return I.apply(this,arguments)}),C.getCookie=function(e){return Vue.cookie.get(e)},t.exports={MapService:M,ControlsFactory:{create:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return E[e.type]?new E[e.type](e):void 0}}}},{"app/constant":5,"components/MapControlGeocoding.vue":193,"components/MapControlZoomHistory.vue":194,"core/g3wobject":11,"core/layers/map/wmslayer":29,"core/layers/vectorlayer":41,"g3w-ol/controls/addlayers":47,"g3w-ol/controls/areacontrol":48,"g3w-ol/controls/control":50,"g3w-ol/controls/geolocationcontrol":51,"g3w-ol/controls/geoscreenshotcontrol":52,"g3w-ol/controls/interactioncontrol":53,"g3w-ol/controls/lengthcontrol":54,"g3w-ol/controls/mousepositioncontrol":56,"g3w-ol/controls/onclickcontrol":57,"g3w-ol/controls/querybboxcontrol":58,"g3w-ol/controls/querybydrawpolygoncontrol":59,"g3w-ol/controls/querybypolygoncontrol":60,"g3w-ol/controls/querycontrol":61,"g3w-ol/controls/resetcontrol":62,"g3w-ol/controls/scalecontrol":63,"g3w-ol/controls/screenshotcontrol":64,"g3w-ol/controls/streetviewcontrol":65,"g3w-ol/controls/zoomboxcontrol":66,"g3w-ol/layers/bases":73,"services/application":298,"services/data":300,"services/gui":302,"store/map-controls":314,"store/map-layers":315,"store/projects":317,utils:404,"utils/createSelectedStyle":352,"utils/createVectorLayerFromFile":356,"utils/createWMSLayer":358,"utils/getGeoTIFFfromServer":383,"utils/getMapLayersByFilter":386,"utils/getResolutionFromScale":394,"utils/getScaleFromResolution":395}],117:[function(e,t,n){var e=e("components/g3w-map"),e=(e=e)&&e.__esModule?e:{default:e};t.exports=e.default},{"components/g3w-map":247}],118:[function(e,t,n){var e=e("components/g3w-metadata"),e=(e=e)&&e.__esModule?e:{default:e};t.exports=e.default},{"components/g3w-metadata":248}],119:[function(e,t,n){var e=e("core/g3w-panel"),e=(e=e)&&e.__esModule?e:{default:e};t.exports=e.default},{"core/g3w-panel":10}],120:[function(e,t,n){var e=e("components/g3w-print"),e=(e=e)&&e.__esModule?e:{default:e};t.exports=e.default},{"components/g3w-print":249}],121:[function(e,t,n){var e=e("components/g3w-projectsmenu"),e=(e=e)&&e.__esModule?e:{default:e};t.exports=e.default},{"components/g3w-projectsmenu":250}],122:[function(e,t,n){var e=e("components/g3w-querybuilder"),e=(e=e)&&e.__esModule?e:{default:e};t.exports=e.default},{"components/g3w-querybuilder":251}],123:[function(e,t,N){var s=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e};function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p=o(e("services/gui")),f=e("app/constant"),u=o(e("store/projects")),c=o(e("services/data")),h=o(e("store/catalog-layers")),g=o(e("components/QueryResultsActionDownloadFormats.vue")),v=o(e("components/QueryResultsActionQueryPolygonCSVAttributes.vue")),d=o(e("services/application")),n=e("core/layers/utils/addToSelection"),a=e("core/layers/utils/removeFromSelection"),m=e("utils/getAlphanumericPropertiesFromFeature"),y=e("utils/createFeatureFromGeometry"),b=e("utils/createFeatureFromBBOX"),w=e("utils/createFeatureFromCoordinates"),x=e("utils/intersects"),S=e("utils/within"),L=e("utils/printAtlas");function o(e){return e&&e.__esModule?e:{default:e}}function C(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var T=e("utils"),k=T.noop,M=T.downloadFile,P=T.throttle,O=T.getUniqueDomId,F=T.copyUrl,I=e("core/i18n/i18n.service").t,j=e("core/layers/layer"),G=e("core/g3wobject"),D=e("core/layers/vectorlayer"),A=e("gui/relations/vue/relationspage"),B=e("g3w-ol/interactions/pickcoordinatesinteraction"),T=e("util-deprecate"),R=new Vue,e=function(){var n,a,o,e=r,t=G;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);function r(){var t;if(this instanceof r)return(t=function(e,t){if(e)return!t||"object"!=typeof t&&"function"!=typeof t?e:t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(this,(r.__proto__||Object.getPrototypeOf(r)).call(this)))._changeLayerResult=t.setters.changeLayerResult,t._addComponent=t.setters.addComponent,t._currentLayerIds=[],t.unlistenerlayeractionevents=[],t._actions={highlightgeometry:t.highlightGeometry.bind(t),clearHighlightGeometry:t.clearHighlightGeometry.bind(t)},t._relations=[],t._atlas=[],t.plotLayerIds=[],t.state={zoomToResult:!0,components:[],layers:[],changed:!1,query:null,type:"ows",layersactions:{},actiontools:{},currentactiontools:{},currentactionfeaturelayer:{},layeractiontool:{},layersFeaturesBoxes:{},layerscustomcomponents:{}},t._vectorLayers=[],t._addFeaturesLayerResultInteraction={id:null,interaction:null,mapcontrol:null,toggleeventhandler:null},t._asyncFnc={todo:k,zoomToLayerFeaturesExtent:{async:!1},goToGeometry:{async:!1}},t.resultsQueryLayer=new ol.layer.Vector({source:new ol.source.Vector,style:function(e){var t=new ol.style.Fill({color:"rgba(0, 0, 255, 0.7)"}),n=new ol.style.Stroke({color:"blue",width:3});return"Point"===e.getGeometry().getType()?new ol.style.Style({text:new ol.style.Text({fill:t,stroke:n,text:"",font:'900 3em "Font Awesome 5 Free"',offsetY:-15})}):new ol.style.Style({stroke:n})}}),u.default.onafter("setCurrentProject",function(e){t._project=e,t._setRelations(e),t._setAtlasActions(e),t.state.download_data=!1,t.plotLayerIds=[]}),t._project=u.default.getCurrentProject(),t._projectLayerIds=t._project.getConfigLayers().map(function(e){return e.id}),t._setRelations(t._project),t._setAtlasActions(t._project),p.default.onbefore("setContent",function(e){t.mapService=t.mapService||d.default.getApplicationService("map"),100===e.perc&&p.default.isMobile()&&(t._asyncFnc.zoomToLayerFeaturesExtent.async=!0,t._asyncFnc.goToGeometry.async=!0)}),t;throw new TypeError("Cannot call a class as a function")}return e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t),i(r,[{key:"addLayersPlotIds",value:function(){this.plotLayerIds=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]}},{key:"getPlotIds",value:function(){return this.plotLayerIds}},{key:"findPlotId",value:function(t){return this.plotLayerIds.find(function(e){return e==t})}},{key:"registerCustomComponent",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,t=void 0===t?O():t,n=e.layerId,r=e.component,i=e.type,i=void 0===i?"feature":i,e=e.position,e=void 0===e?"after":e;return void 0===this.state.layerscustomcomponents[n]&&(this.state.layerscustomcomponents[n]={layer:{before:[],after:[]},feature:{before:[],after:[]}}),this.state.layerscustomcomponents[n][i][e].push({id:t,component:r}),t}},{key:"unRegisterCustomComponent",value:function(e){function t(e){return e.id!==n}var n=e.id,r=e.layerId,i=e.type,e=e.position,a=this.state.layerscustomcomponents[r][i];e?a[e]=a[e].filter(t):Object.keys(a[e]).forEach(function(e){a[e]=a[e].filter(t)})}},{key:"addFeatureLayerToResult",value:function(e,t){this.state.layersFeaturesBoxes[this.getBoxId(e,t)].collapsed=!0}},{key:"updateLayerResultFeatures",value:function(e){var n,r=this,i=this._getLayer(e.id),t=this._getLayerFeatures(e),a=this._getExternalLayer(e.id);i&&0<this._getLayerFeatures(i).length&&(n=this._getFeaturesIds(i.features,a),t.forEach(function(e){var t=r._getFeatureId(e,a);n.some(function(e){return e===t})?(r._removeLayerFeatureBox(i,e),i.features=r._getLayerFeatures(i).filter(function(e){return r._getFeatureId(e,a)!==t})):i.features.push(e)}),this._getLayerFeatures(i).forEach(function(e){return r._toggleLayerFeatureBox(i,e,1<r._getLayerFeatures(i).length)})),this.checkIfLayerHasNoFeatures(i),1===this.state.layers.length&&this.highlightFeaturesPermanently(this.state.layers[0]),this.changeLayerResult(i)}},{key:"checkIfLayerHasNoFeatures",value:function(t){var e=this;t&&0===this._getLayerFeatures(t).length&&setTimeout(function(){e.state.layers=e.state.layers.filter(function(e){return e.id!==t.id}),e.clearHighlightGeometry(t),e.removeAddFeaturesLayerResultInteraction({toggle:!0})})}},{key:"getBoxId",value:function(e,t,n){return null!=n?e.id+"_"+t.id+"_"+n:e.id+"_"+t.id}},{key:"setActionsForLayers",value:function(e){var a=this;(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{add:!1}).add||(this.unlistenerlayeractionevents=[],e.forEach(function(e){var n={},r={},t=(a._getLayerFeatures(e).forEach(function(e,t){r[t]=n[t]=null}),a.state.layeractiontool[e.id]=Vue.observable({component:null,config:null}),a.state.currentactiontools[e.id]=Vue.observable(n),a.state.currentactionfeaturelayer[e.id]=Vue.observable(r),e.external||!!e.source&&"wms"===e.source.type),i=(a.state.layersactions[e.id]||(a.state.layersactions[e.id]=[]),"__g3w_marker"===e.id);e.hasgeometry&&a._setActionGoToGeometry(e),a._relations&&a._relations[e.id]&&a._setActionShowQueryAndPlotsRelations(e),a.getAtlasByLayerId(e.id).length&&a._setActionPrintAtlas(e),1===e.downloads.length&&a._setActionDownloadFeature(e),1<e.downloads.length&&a._setActionMultiDownloadFeature(e),!1!==t&&!i||a._setActionRemoveFeatureFromResult(e),e.toc&&void 0!==e.selection.active&&a._setActionSelection(e),!1===t&&e.hasgeometry&&a._setActionLinkZoomToFid(e),e.editable&&!1===e.inediting&&a._setActionEditing(e)}),this.addActionsForLayers(this.state.layersactions,this.state.layers))}},{key:"createActionState",value:function(e){var t=e.layer,e=e.dynamicProperties,n=(void 0===e?["toggled"]:e).reduce(function(e,t){return e[t]={},e},{});return t.features.map(function(e,t){Object.keys(n).forEach(function(e){n[e][t]=null})}),Vue.observable(n)}},{key:"getActionLayerById",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,n=e.id;if(this.state.layersactions[t.id])return this.state.layersactions[t.id].find(function(e){return e.id===n})}},{key:"setCurrentActionLayerFeatureTool",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,n=e.action,r=e.index,e=e.component,e=void 0===e?null:e,i=this.state.currentactiontools[t.id],t=this.state.currentactionfeaturelayer[t.id];t[r]=e?n:null,i[r]=e,i[r]&&n.id!==t[r].id&&t[r].toggleable&&(t[r].state.toggled[r]=!1)}},{key:"addCurrentActionToolsLayer",value:function(e){var t=e.id,n=e.layer,r=e.config,e=e.action;n&&(this.state.actiontools[t]=E({},n.id,void 0===r?{}:r),e)&&(this.state.layersactions[n.id]=this.state.layersactions[n.id]||[],this.state.layersactions[n.id].push(e))}},{key:"resetCurrentActionToolsLayer",value:function(r){var i=this;this._getLayerFeatures(r).forEach(function(e,t){var n=i.state.currentactiontools[r.id];void 0!==n&&(void 0===n[t]&&Vue.set(n,t,null),n[t]=null)})}},{key:"setLayerActionTool",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,n=e.component,e=e.config,e=void 0===e?null:e;this.state.layeractiontool[t.id].component=void 0===n?null:n,this.state.layeractiontool[t.id].config=e}},{key:"copyZoomToFidUrl",value:function(e,t,n){var r=new URL(location.href);r.searchParams.set("zoom_to_fid",e.id+"|"+t.attributes[f.G3W_FID]),F(r.toString()),n.hint_changed=!0}},{key:"clear",value:function(){this.runAsyncTodo(),this.unlistenerEventsActions(),this.mapService.clearHighlightGeometry(),this.resultsQueryLayer.getSource().clear(),this.removeAddFeaturesLayerResultInteraction({toggle:!0}),this._asyncFnc=null,this._asyncFnc={todo:k,zoomToLayerFeaturesExtent:{async:!1},goToGeometry:{async:!1}},this.clearState(),this.closeComponent(),this.removeQueryResultLayerFromMap()}},{key:"getCurrentLayersIds",value:function(){return this._currentLayerIds}},{key:"runAsyncTodo",value:function(){this._asyncFnc.todo()}},{key:"setZoomToResults",value:function(){this.state.zoomToResult=!(0<arguments.length&&void 0!==arguments[0])||arguments[0]}},{key:"highlightFeaturesPermanently",value:function(e){this.mapService.highlightFeatures(e.features,{duration:1/0})}},{key:"isOneLayerResult",value:function(){return 1===this.state.layers.length}},{key:"removeAddFeaturesLayerResultInteraction",value:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).toggle,e=void 0!==e&&e,t=this._addFeaturesLayerResultInteraction;null!==t.toggleeventhandler&&this.mapService.off("mapcontrol:toggled",t.toggleeventhandler),null!==t.interaction&&this.mapService.removeInteraction(t.interaction),null!==t.mapcontrol&&t.mapcontrol.toggle(e),t.interaction=null,t.id=null,t.toggleeventhandler=null,t.mapcontrol=null}},{key:"addLayerFeaturesToResultsAction",value:function(t){var n,r,i=this,a=this._addFeaturesLayerResultInteraction,e=![null,t.id].includes(a.id),o=e&&this.state.layers.find(function(e){return e.id===a.id});e&&o&&(o.addfeaturesresults.active=!1),e&&a.interaction&&this.mapService.removeInteraction(a.interaction),a.id=t.id,t.addfeaturesresults.active=!t.addfeaturesresults.active,!1===t.addfeaturesresults.active?this.removeAddFeaturesLayerResultInteraction({toggle:!0}):(this.activeMapInteraction(),n=this._getExternalLayer(t.id),a.mapcontrol=a.mapcontrol||this.mapService.getCurrentToggledMapControl()||null,a.interaction=new B,this.mapService.addInteraction(a.interaction,{close:!1}),a.interaction.on("picked",(r=C(function*(e){e=e.coordinate;n?i.setQueryResponse({data:[i.getVectorLayerFeaturesFromQueryRequest(i._vectorLayers.find(function(e){return t.id===e.get("id")}),{coordinates:e})],query:{coordinates:e}},{add:!0}):yield c.default.getData("query:coordinates",{inputs:{coordinates:e,query_point_tolerance:i._project.getQueryPointTolerance(),layerIds:[t.id],multilayers:!1},outputs:{show:{add:!0}}})}),function(e){return r.apply(this,arguments)})),a.toggleeventhandler=function(e){e.target.isToggled()&&e.target.isClickMap()&&(t.addfeaturesresults.active=!1)},this.mapService.once("mapcontrol:toggled",a.toggleeventhandler))}},{key:"deactiveQueryInteractions",value:function(){this.state.layers.forEach(function(e){e.addfeaturesresults&&(e.addfeaturesresults.active=!1)}),this.removeAddFeaturesLayerResultInteraction()}},{key:"zoomToLayerFeaturesExtent",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};t.highlight=!this.isOneLayerResult(),this._asyncFnc.zoomToLayerFeaturesExtent.async?this._asyncFnc.todo=this.mapService.zoomToFeatures.bind(this.mapService,this._getLayerFeatures(e),t):this.mapService.zoomToFeatures(this._getLayerFeatures(e),t)}},{key:"clearState",value:function(){this.state.layers.splice(0),this.state.query=null,this.state.querytitle="",this.state.changed=!1,this._clearActions(),this.state.layersFeaturesBoxes={},this.removeAddFeaturesLayerResultInteraction()}},{key:"_clearActions",value:function(){Object.values(this.state.layersactions).forEach(function(e){return e.forEach(function(e){return e.clear&&e.clear()})}),this.state.layersactions={},this.state.actiontools={},this.state.layeractiontool={},this.state.currentactiontools={}}},{key:"getState",value:function(){return this.state}},{key:"setState",value:function(e){this.state=e}},{key:"_setRelations",value:function(e){e=e.getRelations();this._relations=e?_.groupBy(e,"referencedLayer"):[]}},{key:"getAtlasByLayerId",value:function(t){return this._atlas.filter(function(e){return e.atlas.qgs_layer_id===t})}},{key:"_setAtlasActions",value:function(e){this._atlas=e.getPrint().filter(function(e){return e.atlas})||[]}},{key:"setTitle",value:function(e){this.state.querytitle=e||""}},{key:"_responseToLayer",value:function(e){var t,n=e.layer,r=e.features,i=e.rawdata,a=e.error,e=Array.isArray(r)&&0<r.length;if(!1!==e||void 0!==i){var e=n instanceof j,o=n instanceof ol.layer.Vector,s="string"==typeof n||n instanceof String,l=void 0;if(s)l=j.LayerTypes.VECTOR;else if(e)try{l=n.getSourceType()}catch(a){}var u=-1===[j.SourceTypes.WMS,j.SourceTypes.WCS,j.SourceTypes.WMST].indexOf(l),c=s&&n.split("_"),d=(e?n.getId():void 0)||(o?n.get("id"):void 0)||(s?n:void 0),l=this._parseLayerObjAttributes(n,r,l),p=o||s;return E(t={id:d,attributes:l,external:p,features:this._parseLayerObjFeatures(r,i,p),hasgeometry:this._hasLayerObjGeometry(r,i),hasImageField:this._hasLayerObjImageField(r,i,l),loading:!1,show:!0,expandable:!0,addfeaturesresults:{active:!1}},g.default.name,{active:!1}),E(t,"editable",e&&n.isEditable()),E(t,"inediting",e&&n.isInEditing()),E(t,"source",e?n.getSource():void 0),E(t,"infoformat",e?n.getInfoFormat():void 0),E(t,"infoformats",e?n.getInfoFormats():[]),E(t,"downloads",e?n.getDownloadableFormats():[]),E(t,"formStructure",e?this._parseLayerObjFormStructure(n,r,i,l):void 0),E(t,"relationsattributes",e||o||s?[]:void 0),E(t,"filter",e&&u?n.state.filter:{}),E(t,"selection",(e&&u?n.state.selection:void 0)||(o?n.selection:void 0)||{}),E(t,"title",(e?n.getTitle():void 0)||(o?n.get("name"):void 0)||(s&&c?4<c.length?c.slice(0,c.length-4).join(" "):n:void 0)),E(t,"atlas",this.getAtlasByLayerId(d)),E(t,"rawdata",i||null),E(t,"error",a||""),E(t,"toc",p||n.state.toc),t}}},{key:"_hasLayerObjGeometry",value:function(e,t){var n=this;return Array.isArray(e)&&!t&&e.some(function(e){if(n.getFeaturePropertiesAndGeometry(e).geometry)return!0})}},{key:"_hasLayerObjImageField",value:function(e,t,n){return Array.isArray(e)&&e.length&&!t&&n.some(function(e){if("image"===e.type)return!0})}},{key:"_parseLayerObjFeatures",value:function(e,t,n){var r=this,i=[];return t||e.forEach(function(e){var t=r.getFeaturePropertiesAndGeometry(e);i.push({id:n?e.getId():t.id,attributes:t.properties,geometry:t.geometry,selection:t.selection,show:!0})}),i}},{key:"_parseLayerObjFormStructure",value:function(e,t,n,r){var i=e.hasFormStructure()&&e.getLayerEditingFormStructure();if(!1!==(i&&this._relations&&this._relations.length)){function o(e){if(e.nodes){var t=!0,n=!1,r=void 0;try{for(var i,a=e.nodes[Symbol.iterator]();!(t=(i=a.next()).done);t=!0)o(i.value)}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}}else e.name&&(e.relation=!0)}var a=!0,s=!1,l=void 0;try{for(var u,c=i[Symbol.iterator]();!(a=(u=c.next()).done);a=!0)o(u.value)}catch(e){s=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(s)throw l}}var d={structure:i,fields:e.getFields().filter(function(e){return e.show})};return!n&&Array.isArray(t)&&t.length&&r.forEach(function(t){e.getFields().some(function(e){return e.name===t.name})&&d.fields.push(t)}),d}}},{key:"_parseLayerObjAttributes",value:function(e,t,n){var r=this,i=void 0;if(!t||!t.length)return[];e instanceof j&&"ows"!==this.state.type&&(i=e.getAttributes()),e instanceof j&&"ows"===this.state.type&&(i=e.getAttributes().map(function(e){e=l({},e);return e.name=e.name.replace(/ /g,"_"),e})),e instanceof ol.layer.Vector&&(i=e.getProperties()),("string"==typeof e||e instanceof String)&&(i=t[0]?t[0].getProperties():[]);var a=e instanceof j?i.filter(function(e){try{return"_"===e.name[0]||Number.isInteger(+e.name[0])}catch(e){return!1}}).map(function(e){return{alias:e.name.replace(/_/,""),name:e.name}}):[];return a.length&&t.forEach(function(e){return r._setSpecialAttributesFeatureProperty(a,e)}),this._parseAttributes(i,t[0],n)}},{key:"_setSpecialAttributesFeatureProperty",value:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=arguments[1];0!==t.length&&(e=Object.keys(n.getProperties()),t.forEach(function(t){e.find(function(e){if(e===t.alias)return n.set(t.name,n.get(e)),!0})}))}},{key:"getFeaturePropertiesAndGeometry",value:function(e){var t=e instanceof ol.Feature;return{selection:e.selection,properties:t?e.getProperties():e.properties,geometry:t?e.getGeometry():e.geometry,id:t?e.getId():e.id}}},{key:"_parseAttributes",value:function(e,t,n){var r,i=(0,m.getAlphanumericPropertiesFromFeature)(Object.keys(this.getFeaturePropertiesAndGeometry(t).properties));return e&&0<e.length?e.filter(function(e){return-1<i.indexOf(e.name)}):(r=[j.SourceTypes.GDAL,j.SourceTypes.WMS,j.SourceTypes.WCS,j.SourceTypes.WMST,j.SourceTypes.POSTGRESRASTER],i.map(function(e){return{name:e,label:e,show:f.G3W_FID!==e&&(void 0===n||-1!==r.indexOf(n)),type:"varchar"}}))}},{key:"trigger",value:(o=C(function*(t,e,n,r,i){var a;this._actions[t]&&this._actions[t](e,n,r),e&&this.state.layersactions[e.id]&&(a=this.state.layersactions[e.id].find(function(e){return e.id===t}))&&(yield this.triggerLayerAction(a,e,n,r,i))}),function(e,t,n,r,i){return o.apply(this,arguments)})},{key:"triggerLayerAction",value:(a=C(function*(e,t,n,r,i){e.cbk&&(yield e.cbk(t,n,e,r,i)),e.route&&(t=e.route.replace(/{(\w*)}/g,function(e,t){return n.attributes.hasOwnProperty(t)?n.attributes[t]:""}))&&""!==t&&p.default.goto(t)}),function(e,t,n,r,i){return a.apply(this,arguments)})},{key:"registerVectorLayer",value:function(e){-1===this._vectorLayers.indexOf(e)&&this._vectorLayers.push(e)}},{key:"unregisterVectorLayer",value:function(t){var n=this;this._vectorLayers=this._vectorLayers.filter(function(e){return n.state.layers=n.state.layers&&n.state.layers.filter(function(e){return e.id!==t.get("id")}),e!==t})}},{key:"getVectorLayerFeaturesFromQueryRequest",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=e.coordinates,r=e.bbox,i=e.geometry,e=e.filterConfig,a=void 0===e?{}:e,o=[],e=n&&Array.isArray(n),s=r&&Array.isArray(r);if(e&&this.mapService.viewer.map.forEachFeatureAtPixel(this.mapService.viewer.map.getPixelFromCoordinate(n),function(e,t){o.push(e)},{layerFilter:function(e){return e===t}}),((i=s&&!e?ol.geom.Polygon.fromExtent(r):i)instanceof ol.geom.Polygon||i instanceof ol.geom.MultiPolygon)&&!e)switch(t.constructor){case D:o=t.getIntersectedFeatures(i);break;case ol.layer.Vector:t.getSource().getFeatures().forEach(function(e){var t=void 0;switch(a.spatialMethod){case"intersects":t=(0,x.intersects)(i,e.getGeometry());break;case"within":t=(0,S.within)(i,e.getGeometry());break;default:t=i.intersectsExtent(e.getGeometry().getExtent())}!0===t&&o.push(e)})}return{features:o,layer:t}}},{key:"_printSingleAtlas",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.atlas,n=void 0===t?{}:t,t=e.features,e=void 0===t?[]:t,r=n.atlas&&n.atlas.field_name?n.atlas.field_name:"$id";return(0,L.printAtlas)({field:r,values:e.map(function(e){return e.attributes["$id"===r?f.G3W_FID:r]}),template:n.name,download:!0}).then(function(e){e=e.url;p.default.downloadWrapper(M,{url:e,filename:n.name,mime_type:"application/pdf"})})}},{key:"showChart",value:function(e,t,n){this.emit("show-chart",e,t,n)}},{key:"hideChart",value:function(e){this.emit("hide-chart",e)}},{key:"showRelationsChart",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],n=arguments[2],r=arguments[3],i=arguments[4],a=arguments[5];r.state.toggled[i]=!r.state.toggled[i],r.state.toggled[i]?this.emit("show-chart",e,a,{relations:this._relations[t.id],fid:n.attributes[f.G3W_FID],height:400}):this.hideChart(a)}},{key:"printAtlas",value:function(e,t){var r,n=this,i=t?[t]:e.features,a=this.getAtlasByLayerId(e.id);a.length<=1?this._printSingleAtlas({features:i,atlas:a[0]}):(r="",a.forEach(function(e,t){var n=O();r=(r+='<input id="'+n+'" g3w_atlas_index="'+t+'" class="magic-radio" type="radio" name="template" value="'+e.name+'"/>')+'<label for="'+n+'">'+e.name+"</label><br>"}),p.default.showModalDialog({title:I("sdk.atlas.template_dialog.title"),message:r,buttons:{success:{label:"OK",className:"skin-button",callback:function(){var e=$('input[name="template"]:checked').attr("g3w_atlas_index");if(void 0===e)return!1;n._printSingleAtlas({features:i,atlas:a[e]})}}}}))}},{key:"showLayerDownloadFormats",value:function(e){var t=g.default.name;e[t].active=!e[t].active,this.setLayerActionTool({layer:e,component:e[t].active?g.default:null,config:e[t].active?this.state.actiontools[t][e.id]:null})}},{key:"downloadFeatures",value:(n=C(function*(t,n){var e,r,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],a=this,o=arguments[3],s=arguments[4],l=(i&&!Array.isArray(i)&&(i=[i]),this.state.query),u=void 0===l?{}:l,c={fids:i.map(function(e){return e.attributes[f.G3W_FID]}).join(",")},d=(e=C(function*(){1<i.length&&(n[g.default.name].active=0<arguments.length&&void 0!==arguments[0]&&arguments[0],a.setLayerActionTool({layer:n})),yield p.default.downloadWrapper(function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,n=e.type,e=e.data;return h.default.getLayerById(t.id).getDownloadFilefromDownloadDataType(n,{data:e})||Promise.resolve()},{layer:n,type:t,data:c});var e=a.state.layersactions[n.id].find(function(e){return"downloads"===e.id});1<i.length&&void 0===e&&(n[t].active=!1,a.setLayerActionTool({layer:n})),1<i.length&&void 0!==e&&(n[g.default.name].active=!1),i.length<=1&&void 0===e&&(o.state.toggled[s]=!1),i.length<=1&&void 0!==e&&(e.state.toggled[s]=!1),i.length<=1&&a.setCurrentActionLayerFeatureTool({index:s,action:o,layer:n})}),function(){return e.apply(this,arguments)});"polygon"!==u.type?yield d():(l=this.state.layersactions[n.id].find(function(e){return"downloads"===e.id}),r={choices:[{id:O(),type:"feature",label:"sdk.mapcontrols.querybypolygon.download.choiches.feature.label"},{id:O(),type:"polygon",label:"sdk.mapcontrols.querybypolygon.download.choiches.feature_polygon.label"}],download:function(e){"polygon"===e?(c.sbp_qgs_layer_id=n.id,c.sbp_fid=u.fid):(delete c.sbp_fid,delete c.sbp_qgs_layer_id),d(!0)}},1===i.length&&void 0===l&&(o.state.toggled[s]=!0),1===i.length&&(this.state.actiontools[v.default.name]=this.state.actiontools[n.id]||{},this.state.actiontools[v.default.name][n.id]=r,this.setCurrentActionLayerFeatureTool({layer:n,index:s,action:o,component:v.default})),void 0===l&&1!==i.length&&(n[t].active=!n[t].active),1!==i.length&&(l=l||n[t].active&&void 0===l,this.setLayerActionTool({layer:n,component:l?v.default:null,config:l?r:null})))}),function(e,t){return n.apply(this,arguments)})},{key:"downloadGpx",value:function(){var e=this,t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).id,n=arguments[1];h.default.getLayerById(t).getGpx({fid:n?n.attributes[f.G3W_FID]:null}).catch(function(e){p.default.notify.error(I("info.server_error"))}).finally(function(){e.layerMenu.loading.shp=!1,e._hideMenu()})}},{key:"downloadXls",value:function(){var e=this,t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).id,n=arguments[1];h.default.getLayerById(t).getXls({fid:n?n.attributes[f.G3W_FID]:null}).catch(function(e){p.default.notify.error(I("info.server_error"))}).finally(function(){e.layerMenu.loading.shp=!1,e._hideMenu()})}},{key:"listenClearSelection",value:function(n,r){var e,t,i=this;n.external?n.features.forEach(function(t){var e=n.selection.features.find(function(e){return t.id===e.getId()});t.selection=e?e.selection:{selected:!1}}):((e=h.default.getLayerById(n.id)).on("unselectionall",t=function(){n.features.forEach(function(e,t){return i.state.layersactions[n.id].find(function(e){return e.id===r}).state.toggled[t]=!1})}),this.unlistenerlayeractionevents.push({layer:e,event:"unselectionall",handler:t}))}},{key:"unlistenerEventsActions",value:function(){this.unlistenerlayeractionevents.forEach(function(e){return e.layer.off(e.event,e.handler)}),this.unlistenerlayeractionevents=[]}},{key:"addRemoveFilter",value:function(e){h.default.getLayerById(e.id).toggleFilterToken()}},{key:"saveFilter",value:function(e){h.default.getLayerById(e.id).saveFilter()}},{key:"checkFeatureSelection",value:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=t.layer,r=t.feature,i=t.index,t=t.action;n.external?t.state.toggled[i]=r.selection.selected:r&&(e=h.default.getLayerById(n.id),t.state.toggled[i]=e.getFilterActive()&&null==e.getCurrentFilter()||e.hasSelectionFid(r?this._getFeatureId(r,n.external):null))}},{key:"removeQueryResultLayerFromMap",value:function(){this.resultsQueryLayer.getSource().clear(),this.mapService.getMap().removeLayer(this.resultsQueryLayer)}},{key:"addQueryResultLayerToMap",value:function(e){this.resultsQueryLayer.getSource().addFeature(e),this.mapService.getMap().addLayer(this.resultsQueryLayer)}},{key:"addQueryResultsLayerToMap",value:function(e){e=e.feature;this.removeQueryResultLayerFromMap(),this.addQueryResultLayerToMap(e),this.mapService.setZIndexLayer({layer:this.resultsQueryLayer})}},{key:"showCoordinates",value:function(e){this.addQueryResultsLayerToMap({feature:(0,w.createFeatureFromCoordinates)(e)})}},{key:"showBBOX",value:function(e){this.addQueryResultsLayerToMap({feature:(0,b.createFeatureFromBBOX)(e)})}},{key:"showGeometry",value:function(e){e&&this.addQueryResultsLayerToMap({feature:(0,y.createFeatureFromGeometry)({geometry:e})})}},{key:"goToGeometry",value:function(e,t){var n,r=this;t.geometry&&(n={mapServiceMethod:this.isOneLayerResult()?"zoomToFeatures":"highlightGeometry",firstParam:this.isOneLayerResult()?[t]:t.geometry,options:this.isOneLayerResult()?{}:{layerId:e.id,duration:1500}},this._asyncFnc.goToGeometry.async?this._asyncFnc.todo=this.mapService[n.mapServiceMethod].bind(this.mapService,n.firstParam,n.options):setTimeout(function(){return r.mapService[n.mapServiceMethod](n.firstParam,n.options)}))}},{key:"saveLayerResult",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,e=e.type;this.downloadFeatures(void 0===e?"csv":e,t,t.features)}},{key:"highlightGeometry",value:function(e,t){t.geometry&&this.mapService.highlightGeometry(t.geometry,{layerId:e.id,zoom:!1,duration:1/0})}},{key:"clearHighlightGeometry",value:function(e){this.mapService.clearHighlightGeometry(),this.isOneLayerResult()&&this.highlightFeaturesPermanently(e)}},{key:"showRelation",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.relation,n=e.layerId,e=e.feature,r=this._project.getRelationById(t.name);p.default.pushContent({content:new A({currentview:"relation",relations:[r],chartRelationIds:this.findPlotId(r.referencingLayer)?[r.referencingLayer]:[],nmRelation:this._project.getRelationById(t.nmRelationId),layer:{id:n},feature:e}),crumb:{title:r.name},title:r.name,closable:!1})}},{key:"showQueryRelations",value:function(e,t,n){p.default.changeCurrentContentOptions({crumb:{title:e.title}}),p.default.pushContent({content:new A({relations:n.relations,chartRelationIds:n.chartRelationIds,feature:t,layer:e}),backonclose:!0,title:f.LIST_OF_RELATIONS_TITLE,id:f.LIST_OF_RELATIONS_ID,crumb:{title:f.LIST_OF_RELATIONS_TITLE,trigger:null},closable:!1})}},{key:"_getLayer",value:function(t){return this.state.layers.find(function(e){return e.id===t})}},{key:"_getExternalLayer",value:function(e){return(this._getLayer(e)||{}).external}},{key:"_getFeatureId",value:function(e,t){return t?e.id:e.attributes[f.G3W_FID]}},{key:"_getFeaturesIds",value:function(e,t){var n=this;return e.map(function(e){return n._getFeatureId(e,t)})}},{key:"_getLayerFeatures",value:function(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).features||[]}},{key:"_toggleLayerFeatureBox",value:function(e,t,n){var e=this.getBoxId(e,t),r=e&&this.state.layersFeaturesBoxes[e];r&&setTimeout(function(){return r.collapsed=n})}},{key:"_removeLayerFeatureBox",value:function(e,t){var n=this;setTimeout(function(){return delete n.state.layersFeaturesBoxes[n.getBoxId(e,t)]})}},{key:"_setActionGoToGeometry",value:function(e){this.state.layersactions[e.id].push({id:"gotogeometry",download:!1,mouseover:!0,class:p.default.getFontClass("marker"),hint:"sdk.mapcontrols.query.actions.zoom_to_feature.hint",cbk:P(this.goToGeometry.bind(this))})}},{key:"_setActionShowQueryAndPlotsRelations",value:function(e){var n=this,t=this._relations[e.id].filter(function(e){return"MANY"===e.type}),r=[];t.forEach(function(t){var e=n.plotLayerIds.find(function(e){return e===t.referencingLayer});e&&r.push(e)}),0<t.length&&this.state.layersactions[e.id].push({id:"show-query-relations",download:!1,class:p.default.getFontClass("relation"),hint:"sdk.mapcontrols.query.actions.relations.hint",cbk:this.showQueryRelations,relations:t,chartRelationIds:r}),0<r.length&&this.state.layersactions[e.id].push({id:"show-plots-relations",download:!1,opened:!0,class:p.default.getFontClass("chart"),state:this.createActionState({layer:e}),hint:"sdk.mapcontrols.query.actions.relations_charts.hint",cbk:P(this.showRelationsChart.bind(this,r))})}},{key:"_setActionPrintAtlas",value:function(e){this.state.layersactions[e.id].push({id:"printatlas",download:!0,class:p.default.getFontClass("print"),hint:"sdk.tooltips.atlas",cbk:this.printAtlas.bind(this)})}},{key:"_setActionDownloadFeature",value:function(e){var i=this,t=s(e.downloads,1)[0],a=this.downloadFeatures.bind(this,t);e[t]=Vue.observable({active:!1}),this.state.layersactions[e.id].push({id:"download_"+t+"_feature",download:!0,state:this.createActionState({layer:e}),class:p.default.getFontClass("download"),hint:"sdk.tooltips.download_"+t,cbk:function(e,t,n,r){n.state.toggled[r]=!n.state.toggled[r],n.state.toggled[r]?a(e,t,n,r):i.setCurrentActionLayerFeatureTool({index:r,action:n,layer:e})}})}},{key:"_setActionMultiDownloadFeature",value:function(e){var a=this,t=[];e.downloads.forEach(function(i){t.push({id:"download_"+i+"_feature",download:!0,format:i,class:p.default.getFontClass(i),hint:"sdk.tooltips.download_"+i,cbk:function(e,t,n,r){a.downloadFeatures(i,e,t,n,r),"polygon"!==a.state.query.type&&(n=a.state.layersactions[e.id].find(function(e){return"downloads"===e.id})).cbk(e,t,n,r)}})}),this.state.actiontools[g.default.name]=this.state.actiontools[g.default.name]||{},this.state.actiontools[g.default.name][e.id]={downloads:t},this.state.layersactions[e.id].push({id:"downloads",download:!0,class:p.default.getFontClass("download"),state:this.createActionState({layer:e}),toggleable:!0,hint:"Downloads",change:function(e){var n=this;e.features.forEach(function(e,t){void 0===n.state.toggled[t]?R.$set(n.state.toggled,t,!1):n.state.toggled[t]=!1})},cbk:function(e,t,n,r){n.state.toggled[r]=!n.state.toggled[r],a.setCurrentActionLayerFeatureTool({layer:e,index:r,action:n,component:n.state.toggled[r]?g.default:null})}})}},{key:"_setActionRemoveFeatureFromResult",value:function(e){this.state.layersactions[e.id].push({id:"removefeaturefromresult",download:!1,mouseover:!0,class:p.default.getFontClass("minus-square"),style:{color:"red"},hint:"sdk.mapcontrols.query.actions.remove_feature_from_results.hint",cbk:this.removeFeatureLayerFromResult.bind(this)})}},{key:"_setActionSelection",value:function(r){var i=this;this.state.layersactions[r.id].push({id:"selection",download:!1,class:p.default.getFontClass("success"),hint:"sdk.mapcontrols.query.actions.add_selection.hint",state:this.createActionState({layer:r}),init:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.feature,n=e.index,e=e.action;void 0!==r.selection.active&&i.checkFeatureSelection({layer:r,index:n,feature:t,action:e})},change:function(e){var n=this;e.features.forEach(function(e,t){void 0===n.state.toggled[t]&&R.$set(n.state.toggled,t,!1)})},cbk:P(this.addToSelection.bind(this))}),this.listenClearSelection(r,"selection")}},{key:"_setActionLinkZoomToFid",value:function(e){this.state.layersactions[e.id].push({id:"link_zoom_to_fid",download:!1,class:p.default.getFontClass("link"),hint:"sdk.mapcontrols.query.actions.copy_zoom_to_fid_url.hint",hint_change:{hint:"sdk.mapcontrols.query.actions.copy_zoom_to_fid_url.hint_change",duration:1e3},cbk:this.copyZoomToFidUrl.bind(this)})}},{key:"_setActionEditing",value:function(e){var n=this;this.state.layersactions[e.id].push({id:"editing",class:p.default.getFontClass("pencil"),hint:"Editing",cbk:function(e,t){n.editFeature({layer:e,feature:t})}})}}]),r}();e.prototype.addRemoveFeaturesToLayerResult=T(e.prototype.updateLayerResultFeatures,"[G3W-CLIENT] QueryResultsService::addRemoveFeaturesToLayerResult(layer) is deprecated"),e.prototype.downloadApplicationWrapper=T(p.default.downloadWrapper,"[G3W-CLIENT] QueryResultsService::downloadApplicationWrapper(downloadFnc, options) is deprecated"),e.prototype.selectionFeaturesLayer=T(n.addToSelection,"[G3W-CLIENT] QueryResultsService::selectionFeaturesLayer(layer) is deprecated"),e.prototype.clearSelectionExtenalLayer=T(n.addToSelection,"[G3W-CLIENT] QueryResultsService::clearSelectionExtenalLayer(layer) is deprecated"),e.prototype.init=e.prototype.clearState,e.prototype.reset=e.prototype.clearState,e.prototype.addToSelection=n.addToSelection,e.prototype.removeFromSelection=a.removeFromSelection,e.prototype.setters={setQueryResponse:function(r){var i,a,o=this,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{add:!1};if(r.data||(r.data=[]),r.query||(r.query={external:{add:!1,filter:{SELECTED:!1}}}),r.query.external||(r.query.external={add:!1,filter:{SELECTED:!1}}),!1===e.add&&(this.clearState(),this.state.query=r.query,this.state.type=r.type),!0===r.query.external.add&&!1===e.add&&(i=p.default.getService("catalog"),a=r.query.external.filter.SELECTED,this._vectorLayers.forEach(function(e){var t=e.get("id"),n=!!(i.state.external.vector.find(function(e){return e.id===t})||{}).selected;!e.getVisible()||n!==a&&void 0!==a||r.data["__g3w_marker"===t?"unshift":"push"](o.getVectorLayerFeaturesFromQueryRequest(e,r.query))})),!1===e.add)switch(this.state.query.type){case"coordinates":this.showCoordinates(this.state.query.coordinates);break;case"bbox":this.showBBOX(this.state.query.bbox);break;case"polygon":case"drawpolygon":this.showGeometry(this.state.query.geometry)}var t=[];r.data.forEach(function(e){[].concat(e).forEach(function(e){e=o._responseToLayer(e);e&&t.push(e)})}),this.setLayersData(t,e)},setLayersData:function(e){var n=this,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{add:!1};!1===t.add&&(this._currentLayerIds=e.map(function(e){return e.id}),e.sort(function(e,t){return n._projectLayerIds.indexOf(e.id)>n._projectLayerIds.indexOf(t.id)?1:-1})),e.forEach(function(e){t.add?n.updateLayerResultFeatures(e):n.state.layers.push(e)}),this.setActionsForLayers(e,{add:t.add}),this.state.changed=!0},addComponent:function(e){this.state.components.push(e)},addActionsForLayers:function(e,t){},postRender:function(e){},closeComponent:function(){},changeLayerResult:function(t){this.state.layersactions[t.id].forEach(function(e){return e.change&&e.change(t)}),this.resetCurrentActionToolsLayer(t)},activeMapInteraction:function(){},editFeature:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.layer,e.feature},openCloseFeatureResult:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.open,e.layer,e.feature,e.container},removeFeatureLayerFromResult:function(e,t){this.updateLayerResultFeatures({id:e.id,external:e.external,features:[t]})}},t.exports=e},{"app/constant":5,"components/QueryResultsActionDownloadFormats.vue":216,"components/QueryResultsActionQueryPolygonCSVAttributes.vue":218,"core/g3wobject":11,"core/i18n/i18n.service":12,"core/layers/layer":21,"core/layers/utils/addToSelection":39,"core/layers/utils/removeFromSelection":40,"core/layers/vectorlayer":41,"g3w-ol/interactions/pickcoordinatesinteraction":71,"gui/relations/vue/relationspage":125,"services/application":298,"services/data":300,"services/gui":302,"store/catalog-layers":311,"store/projects":317,"util-deprecate":"util-deprecate",utils:404,"utils/createFeatureFromBBOX":339,"utils/createFeatureFromCoordinates":340,"utils/createFeatureFromGeometry":342,"utils/getAlphanumericPropertiesFromFeature":374,"utils/intersects":406,"utils/printAtlas":427,"utils/within":454}],124:[function(e,t,n){var e=e("components/g3w-queryresults"),e=(e=e)&&e.__esModule?e:{default:e};t.exports=e.default},{"components/g3w-queryresults":252}],125:[function(e,t,n){var e=e("components/g3w-relationspage"),e=(e=e)&&e.__esModule?e:{default:e};t.exports=e.default},{"components/g3w-relationspage":253}],126:[function(e,t,n){e=e("components/g3w-search");t.exports=e.SearchPanel},{"components/g3w-search":254}],127:[function(e,t,n){e=e("components/g3w-search");t.exports=e.SearchComponent},{"components/g3w-search":254}],128:[function(e,t,n){var e=e("components/g3w-spatialbookmarks"),e=(e=e)&&e.__esModule?e:{default:e};t.exports=e.default},{"components/g3w-spatialbookmarks":255}],129:[function(e,t,n){var e=e("components/g3w-tools"),e=(e=e)&&e.__esModule?e:{default:e};t.exports=e.default},{"components/g3w-tools":256}],130:[function(e,t,n){var e=e("components/g3w-contentsviewer"),e=(e=e)&&e.__esModule?e:{default:e};t.exports=e.default},{"components/g3w-contentsviewer":245}],131:[function(e,t,n){var e=e("components/g3w-wms"),e=(e=e)&&e.__esModule?e:{default:e};t.exports=e.default},{"components/g3w-wms":257}],132:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var s=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=d(e("vue-cookie-law")),i=d(e("components/HeaderItem.vue")),a=d(e("store/projects")),l=d(e("services/application")),u=d(e("services/gui")),o=e("mixins"),c=e("app/constant");function d(e){return e&&e.__esModule?e:{default:e}}function p(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var f=e("utils").uniqueId,h=e("core/i18n/i18n.service").t;if("undefined"==typeof jQuery)throw new Error("LayoutManager requires jQuery");$.LayoutManager=$.LayoutManager||{options:{navbarMenuSlimscroll:!0,navbarMenuSlimscrollWidth:"0px",navbarMenuHeight:"200px",animationSpeed:"fast",sidebarToggleSelector:"[data-toggle='offcanvas']",sidebarPushMenu:!0,sidebarSlimScroll:!1,sidebarExpandOnHover:!1,enableBoxRefresh:!0,enableFastclick:!0,enableControlSidebar:!0,controlSidebarOptions:{toggleBtnSelector:"[data-toggle='control-sidebar']",selector:".control-sidebar",slide:!0},enableBoxWidget:!0,boxWidgetOptions:{boxWidgetIcons:{collapse:"fa-minus",open:"fa-plus",remove:"fa-times"},boxWidgetSelectors:{remove:'[data-widget="remove"]',collapse:'[data-widget="collapse"]'}},directChat:{enable:!0,contactToggleSelector:'[data-widget="chat-pane-toggle"]'},colors:{lightBlue:"#3c8dbc",red:"#f56954",green:"#00a65a",aqua:"#00c0ef",yellow:"#f39c12",blue:"#0073b7",navy:"#001F3F",teal:"#39CCCC",olive:"#3D9970",lime:"#01FF70",orange:"#FF851B",fuchsia:"#F012BE",purple:"#8E24AA",maroon:"#D81B60",black:"#222222",gray:"#d2d6de"},screenSizes:{xs:480,sm:768,md:992,lg:1200}},_init:function(){"use strict";return $.LayoutManager.layout={activate:function(){var e=this;e.fix(),e.fixSidebar(),$(window,".wrapper").resize(function(){e.fix(),e.fixSidebar()})},fix:function(){var e,t=$(".main-header").outerHeight()+$(".main-footer").outerHeight(),n=$(window).height(),r=$(".sidebar").height();$("body").hasClass("fixed")?($(".content-wrapper, .right-side").css("min-height",n-$(".main-footer").outerHeight()),$(".content-wrapper, .right-side").css("height",n-$(".main-footer").outerHeight())):(e=void 0,e=r<=n?($(".content-wrapper, .right-side").css("min-height",n-t),n-t):($(".content-wrapper, .right-side").css("min-height",r),r),void 0!==(n=$($.LayoutManager.options.controlSidebarOptions.selector))&&n.height()>e&&$(".content-wrapper, .right-side").css("min-height",n.height()))},fixSidebar:function(){$("body").hasClass("fixed")?(void 0===$.fn.slimScroll&&window.console&&window.console.error("Error: the fixed layout requires the slimscroll plugin!"),$.LayoutManager.options.sidebarSlimScroll&&!isMobile.any?void 0!==$.fn.slimScroll&&($("#g3w-sidebar").slimScroll({destroy:!0}).height("auto"),$("#g3w-sidebar").slimScroll({touchScrollStep:50,height:$(window).height()-$(".navbar-header").height()-10+"px",color:"rgba(255,255,255,0.7)",size:"3px"})):($(".sidebar").css({height:$(window).height()-$(".navbar-header").height()+"px"}),$(".sidebar").css("overflow-y","auto"))):void 0!==$.fn.slimScroll&&$(".sidebar").slimScroll({destroy:!0}).height("auto")}},$.LayoutManager.pushMenu={activate:function(e){var t=$.LayoutManager.options.screenSizes;$(e).on("click",function(e){e.preventDefault(),$(window).width()>t.sm-1?$("body").hasClass("sidebar-collapse")?$("body").removeClass("sidebar-collapse").trigger("expanded.pushMenu"):$("body").addClass("sidebar-collapse").trigger("collapsed.pushMenu"):$("body").hasClass("sidebar-open")?$("body").removeClass("sidebar-open").removeClass("sidebar-collapse").trigger("collapsed.pushMenu"):$("body").addClass("sidebar-open").trigger("expanded.pushMenu")}),($.LayoutManager.options.sidebarExpandOnHover||$("body").hasClass("fixed")&&$("body").hasClass("sidebar-mini"))&&this.expandOnHover()},expandOnHover:function(){var e=this,t=$.LayoutManager.options.screenSizes.sm-1;$(".main-sidebar").hover(function(){$("body").hasClass("sidebar-mini")&&$("body").hasClass("sidebar-collapse")&&$(window).width()>t&&e.expand()},function(){$("body").hasClass("sidebar-mini")&&$("body").hasClass("sidebar-expanded-on-hover")&&$(window).width()>t&&e.collapse()})},expand:function(){$("body").removeClass("sidebar-collapse").addClass("sidebar-expanded-on-hover")},collapse:function(){$("body").hasClass("sidebar-expanded-on-hover")&&$("body").removeClass("sidebar-expanded-on-hover").addClass("sidebar-collapse")}},$.LayoutManager.tree=function(e){var a=this,o=$.LayoutManager.options.animationSpeed;$(document).on("click",e+" li a",function(e){var t,n,r=$(this),i=r.next();i.is(".treeview-menu")&&i.is(":visible")?i.slideUp(o,function(){i.parent("li.treeview").removeClass("active"),i.removeClass("menu-open")}):i.is(".treeview-menu")&&!i.is(":visible")&&(t=r.parents("ul").first(),r=(n=r.parent("li")).siblings(),t.height(),t.find("li.header").outerHeight(),n.outerHeight(),r.not(".header").each(function(e,t){$(t).find("a").outerHeight()}),t.find("ul.treeview-menu:visible").slideUp(o).removeClass("menu-open"),i.slideDown(o,function(){i.addClass("menu-open"),t.find("li.treeview.active").removeClass("active"),n.addClass("active"),a.layout.fix()})),i.is(".treeview-menu")&&e.preventDefault()})},$.LayoutManager.floatBar=$.LayoutManager.controlSidebar={activate:function(){var t=this,n=$.LayoutManager.options.controlSidebarOptions,r=$(n.selector),e=($(n.toggleBtnSelector).on("click",function(e){e.preventDefault(),r.hasClass("control-sidebar-open")||$("body").hasClass("control-sidebar-open")?t.close(r,n.slide):t.open(r,n.slide)}),$(".control-sidebar-bg"));t._fix(e),$("body").hasClass("fixed")?t._fixForFixed(r):$(".content-wrapper, .right-side").height()<r.height()&&t._fixForContent(r)},open:function(e,t){(t?e:$("body")).addClass("control-sidebar-open")},close:function(e,t){(t?e:$("body")).removeClass("control-sidebar-open")},_fix:function(e){var t=this;$("body").hasClass("layout-boxed")?(e.css("position","absolute"),e.height($(".wrapper").height()),$(window).resize(function(){t._fix(e)})):e.css({position:"fixed",height:"auto"})},_fixForFixed:function(e){e.css({position:"fixed","max-height":"100%","padding-bottom":"50px"})},_fixForContent:function(e){$(".content-wrapper, .right-side").css("min-height",e.height())}},$.LayoutManager.boxWidget={selectors:$.LayoutManager.options.boxWidgetOptions.boxWidgetSelectors,icons:$.LayoutManager.options.boxWidgetOptions.boxWidgetIcons,animationSpeed:$.LayoutManager.options.animationSpeed,activate:function(e){var t=this;e=e||document,$(e).on("click",t.selectors.collapse,function(e){e.preventDefault(),t.collapse($(this))}),$(e).on("click",t.selectors.remove,function(e){e.preventDefault(),t.remove($(this))})},collapse:function(e){var t=e.parents(".box").first(),n=t.find("> .box-body, > .box-footer, > form  >.box-body, > form > .box-footer");t.hasClass("collapsed-box")?(e.find(".btn-collapser").removeClass(this.icons.open).addClass(this.icons.collapse),n.slideDown(this.animationSpeed,function(){t.removeClass("collapsed-box")})):(e.find(".btn-collapser").removeClass(this.icons.collapse).addClass(this.icons.open),n.slideUp(this.animationSpeed,function(){t.addClass("collapsed-box")}))},remove:function(e){e.parents(".box").first().slideUp(this.animationSpeed)}},$.LayoutManager},addRefreshButton:function(){"use strict";return $.fn.boxRefresh=function(e){var n=$.extend({trigger:".refresh-btn",source:"",onLoadStart:function(e){return e},onLoadDone:function(e){return e}},e),r=$('<div class="overlay"><div class="fa fa-refresh fa-spin"></div></div>');return this.each(function(){var t;""===n.source?window.console&&window.console.log("Please specify a source first - boxRefresh()"):(t=$(this)).find(n.trigger).first().on("click",function(e){e.preventDefault(),(e=t).append(r),n.onLoadStart.call(e),t.find(".box-body").load(n.source,function(){var e;(e=t).find(r).remove(),n.onLoadDone.call(e)})})})},$.LayoutManager},activateBox:function(){"use strict";return $.fn.activateBox=function(){$.LayoutManager.boxWidget.activate(this)},$.LayoutManager},listCustomPlugin:function(){"use strict";return $.fn.todolist=function(e){var t=$.extend({onCheck:function(e){return e},onUncheck:function(e){return e}},e);return this.each(function(){void 0!==$.fn.iCheck?($("input",this).on("ifChecked",function(){var e=$(this).parents("li").first();e.toggleClass("done"),t.onCheck.call(e)}),$("input",this).on("ifUnchecked",function(){var e=$(this).parents("li").first();e.toggleClass("done"),t.onUncheck.call(e)})):$("input",this).on("change",function(){var e=$(this).parents("li").first();e.toggleClass("done"),($("input",e).is(":checked")?t.onCheck:t.onUncheck).call(e)})})},$.LayoutManager},setup:function(){"use strict";$("body").removeClass("hold-transition"),"undefined"!=typeof LayoutManagerOptions&&$.extend(!0,$.LayoutManager.options,LayoutManagerOptions);var e=$.LayoutManager.options;return $.LayoutManager._init(),$.LayoutManager.layout.activate(),$.LayoutManager.tree(".sidebar"),e.enableControlSidebar&&$.LayoutManager.controlSidebar.activate(),e.navbarMenuSlimscroll&&void 0!==$.fn.slimscroll&&$(".navbar .menu").slimscroll({height:e.navbarMenuHeight,alwaysVisible:!1,size:e.navbarMenuSlimscrollWidth}).css("width","100%"),e.sidebarPushMenu&&$.LayoutManager.pushMenu.activate(e.sidebarToggleSelector),e.enableBoxWidget&&$.LayoutManager.boxWidget.activate(),e.enableFastclick&&"undefined"!=typeof FastClick&&FastClick.attach(document.body),e.directChat.enable&&$(document).on("click",e.directChat.contactToggleSelector,function(){$(this).parents(".direct-chat").first().toggleClass("direct-chat-contacts-open")}),$('.btn-group[data-toggle="btn-toggle"]').each(function(){var t=$(this);$(this).find(".btn").on("click",function(e){t.find(".btn.active").removeClass("active"),$(this).addClass("active"),e.preventDefault()})}),$.LayoutManager.addRefreshButton().activateBox().listCustomPlugin()},loading:function(e){$("#initerror").remove(),(e=!_.isBoolean(e)||e)?$("body").append('\n          <div id="startingspinner">\n          <div class="double-bounce1"></div>\n          <div class="double-bounce2"></div>\n          </div>'):$("#startingspinner").remove()}};var g,v,m,y=$.LayoutManager,e=(n.default={name:"app",mixins:[o.resizeMixin],data:function(){return{customcredits:!1,appState:l.default.getState(),current_custom_modal_content:null,language:null,cookie_law_buttonText:h("cookie_law.buttonText")}},components:{HeaderItem:i.default,CookieLaw:r.default},computed:{app:function(){return this.appState.gui.app},languages:function(){var e;return 1<(e=Array.isArray(this.appconfig.i18n)&&this.appconfig.i18n||[]).length&&e},currentProject:function(){return a.default.getCurrentProject()},appconfig:function(){return l.default.getConfig()},isIframe:function(){return!!this.appconfig.group.layout.iframe},urls:function(){return this.appconfig.urls},staticurl:function(){return this.urls.staticurl},powered_by:function(){return this.appconfig.group.powered_by},clienturl:function(){return this.urls.clienturl},g3w_suite_logo:function(){return this.clienturl+"images/g3wsuite_logo.png"},credits_logo:function(){return this.clienturl+"images/logo_gis3w_156_85.png"},logo_url:function(){var e=this.currentProject.getThumbnail();return e||""+this.appconfig.mediaurl+this.appconfig.logo_img},logo_link:function(){return this.getLogoLink()||"#"},logo_link_target:function(){return this.getLogoLink()?"_blank":""},project_title:function(){return this.currentProject.getState().name},user:function(){return this.appconfig.user&&this.appconfig.user.username?this.appconfig.user:null},login_url:function(){return this.appconfig.user.login_url},numberOfProjectsInGroup:function(){return this.appconfig.projects.length},hasRelatedMaps:function(){return 1<this.appconfig.macrogroups.length+this.appconfig.groups.length+this.appconfig.projects.length},frontendurl:function(){return this.urls.frontendurl},main_title:function(){var e=this.appconfig.main_map_title,t=this.appconfig.group.name||this.appconfig.group.slug;return e?e+" - "+t:t}},methods:{templateResultLanguages:function(e){return e.id?$('\n        <div style="font-weight: bold; display:flex; align-items: center; justify-content: space-around;">\n          <img src="'+this.staticurl+"img/flags/"+e.element.value.toLowerCase()+'.png" />\n          <span style="margin-left: 5px;">'+e.text+"</span> \n        </span>"):e.text},resize:(m=p(function*(){var e;this.isIframe||(yield this.$nextTick(),e=0<this.$refs.navbar_toggle.offsetWidth?this.$refs.navbar.offsetWidth-this.$refs.navbar_toggle.offsetWidth:this.$refs.mainnavbar.offsetWidth-this.$refs["app-navbar-nav"].offsetWidth,this.$refs.main_title_project_title.style.maxWidth=e-this.logoWidth-15+"px")}),function(){return m.apply(this,arguments)}),showCustomModalContent:function(t){var e=this.custom_modals.find(function(e){return e.id===t}).content;this.current_custom_modal_content=e},closePanel:function(){sidebarService.closePanel()},getLogoLink:function(){return this.appconfig.logo_link||null},openProjectsMenu:function(){u.default.openProjectsMenu()},initDialogMessages:(v=p(function*(){var a=this.currentProject.getMessages();if(a)for(var o=this.currentProject.getId(),e=function*(e){var t=a.items[e],n=l.default.getLocalItem(c.LOCAL_ITEM_IDS.MESSAGES.id)||c.LOCAL_ITEM_IDS.MESSAGES.value;if(void 0===n[o]&&(n[o]=[]),void 0!==n[o].find(function(e){return e===t.id}))return"continue";var r=new(Vue.extend({data:function(){return{id:f(),checked:!1}},template:'\n            <div style="display: flex; margin-top: 10px;">\n              <input :id="id"\n                v-model="checked"\n                class="magic-checkbox"\n                type="checkbox"/>\n              <label :for="id" v-t="\'dont_show_again\'"/>\n            </div>\n          '})),i=document.createElement("div");i.append.apply(i,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}((new DOMParser).parseFromString(t.body,"text/html").body.childNodes)),i.append(r.$mount().$el),yield new Promise(function(e){u.default.showModalDialog({title:t.title,message:i,size:"large",closeButton:!1,className:"g3w-modal-project-message "+Object.entries(a.levels).find(function(e){e=s(e,2);e[0];return e[1]===t.level})[0],buttons:{close:{label:h("close"),className:"btn-secondary",callback:function(){r.checked&&(n[o].push(t.id),l.default.setLocalItem({id:c.LOCAL_ITEM_IDS.MESSAGES.id,data:n})),e()}}}})})},t=0;t<a.items.length;t++)yield*e(t)}),function(){return v.apply(this,arguments)}),openChangeMapMenu:function(){u.default.openChangeMapMenu()}},watch:{language:function(e,t){t&&(l.default.changeLanguage(e),this.cookie_law_buttonText=h("cookie_law.buttonText"))}},beforeCreate:function(){this.delayType="debounce",this.delayTime=0},created:function(){var n=this;this.language=this.appconfig._i18n.language,this.custom_modals=[],this.custom_header_items_position={0:[],1:[],2:[],3:[],4:[]},this.customlinks=Array.isArray(this.appconfig.header_custom_links)?this.appconfig.header_custom_links.filter(function(e){var t;return null!==e&&(t=e.id=f(),"modal"===e.type&&n.custom_modals.push({id:t,content:e.content}),t=4<(t=+(e.position||0))?4:t<0||Number.isNaN(t)?0:t,n.custom_header_items_position[t].push(e),!0)}):[],this.appconfig.credits&&$.get(this.appconfig.credits).then(function(e){return n.customcredits="None"!==e&&e})},mounted:(g=p(function*(){var e=this,t=(this.initDialogMessages(),this.logoWidth=0,yield this.$nextTick(),this.isIframe?[]:this.$refs.mainnavbar.getElementsByTagName("ul")),n=t.length;this.rightNavbarWidth=15;for(var r=0;r<n;r++)this.rightNavbarWidth+=t.item(r).offsetWidth;function i(){$(y.options.controlSidebarOptions.selector).css("max-height",$(window).innerHeight()),$(".g3w-sidebarpanel").css("height",$(window).height()-$("#main-navbar").height())}this.language=this.appconfig.user.i18n,yield this.$nextTick(),this.isIframe||this.$refs.img_logo.addEventListener("load",function(){e.logoWidth=e.$refs.img_logo.offsetWidth+15,e.resize()},{once:!0}),y.loading(!1),y.setup(),y.pushMenu.expandOnHover(),y.controlSidebar._fix($(".control-sidebar-bg")),y.controlSidebar._fix($(".control-sidebar")),i(),$(window).resize(function(){i(),$("#g3w-modal-overlay").css("height",$(window).height())}),document.body.classList.toggle("is-mobile",this.isMobile())}),function(){return g.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default),"function"==typeof t.exports?t.exports.options:t.exports);e.render=function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{directives:[{name:"disabled",rawName:"v-disabled",value:n.app.disabled,expression:"app.disabled"}],staticClass:"wrapper"},[t("cookie-law",{attrs:{theme:"dark-lime",buttonText:n.cookie_law_buttonText}},[t("div",{directives:[{name:"t",rawName:"v-t",value:"cookie_law.message",expression:"'cookie_law.message'"}],attrs:{slot:"message"},slot:"message"})]),n._v(" "),n.isIframe?n._e():t("header",{staticClass:"main-header"},[t("nav",{ref:"navbar",staticClass:"navbar navbar-inverse navbar-fixed-top",attrs:{role:"navigation"}},[t("div",{staticClass:"container-fluid"},[t("div",{staticClass:"navbar-header"},[t("button",{ref:"navbar_toggle",staticClass:"navbar-toggle",attrs:{type:"button","data-toggle":"collapse","data-target":"#main-navbar"}},[t("i",{class:n.g3wtemplate.getFontClass("ellips-v"),staticStyle:{"font-size":"1.3em"}})]),n._v(" "),t("a",{staticClass:"sidebar-toggle",attrs:{id:"g3w-small-screen-hamburger-sidebar",href:"#","data-toggle":"offcanvas",role:"button"}},[t("i",{class:n.g3wtemplate.getFontClass("bars"),staticStyle:{"font-size":"1.3em"}})]),n._v(" "),t("div",{staticClass:"logo-wrapper",class:{mobile:n.isMobile()}},[n.logo_url?t("a",{staticClass:"project_logo_link",attrs:{href:n.logo_link,target:n.logo_link_target}},[t("img",{ref:"img_logo",staticClass:"img-responsive",staticStyle:{"max-width":"250px"},attrs:{src:n.logo_url}})]):n._e(),n._v(" "),t("div",{ref:"main_title_project_title",staticClass:"project_title_content"},[t("div",{staticClass:"main_title"},[n._v(n._s(n.main_title))]),n._v(" "),t("div",{staticClass:"sub_title"},[n._v(n._s(n.project_title))])])])]),n._v(" "),t("div",{ref:"mainnavbar",staticClass:"collapse navbar-collapse",staticStyle:{"text-align":"center",overflow:"hidden",margin:"0 0"},attrs:{id:"main-navbar"}},[t("navbarleftitems"),n._v(" "),t("navbarrightitems"),n._v(" "),t("ul",{ref:"app-navbar-nav",staticClass:"nav navbar-nav navbar-right app-navbar-nav"},[n.user?n._e():t("li",{staticClass:"dropdown user user-menu"},[t("a",{attrs:{href:n.login_url}},[t("i",{class:n.g3wtemplate.getFontClass("sign-in"),attrs:{"aria-hidden":"true"}}),n._v(" "),t("span",{directives:[{name:"t",rawName:"v-t",value:"sign_in",expression:"'sign_in'"}]})])]),n._v(" "),n._l(n.custom_header_items_position[0],function(e){return t("header-item",{key:e.id,attrs:{state:e},on:{"show-custom-modal-content":n.showCustomModalContent}})}),n._v(" "),n.hasRelatedMaps?t("li",{staticClass:"dropdown user",attrs:{id:"changemaps"}},[t("a",{staticClass:"dropdown-toggle",attrs:{href:"#","data-toggle":"dropdown"},on:{click:function(e){return e.stopPropagation(),n.openChangeMapMenu(e)}}},[t("i",{class:n.g3wtemplate.getFontClass("change-map"),attrs:{"aria-hidden":"true"}}),n._v(" "),t("span",{directives:[{name:"t",rawName:"v-t",value:"changemap",expression:"'changemap'"}]})])]):n._e(),n._v(" "),n._l(n.custom_header_items_position[1],function(e){return t("header-item",{key:e.id,attrs:{state:e},on:{"show-custom-modal-content":n.showCustomModalContent}})}),n._v(" "),n.user?t("li",{staticClass:"dropdown user user-menu"},[t("a",{staticClass:"dropdown-toggle",attrs:{href:"#","data-toggle":"dropdown"}},[t("i",{class:n.g3wtemplate.getFontClass("user")}),n._v(" "),t("span",{staticClass:"hidden-xs"},[n._v(n._s(n.user.username))])]),n._v(" "),t("ul",{staticClass:"dropdown-menu"},[t("li",{staticClass:"user-header"},[t("p",[n._v("\n                    "+n._s(n.user.first_name)+" "+n._s(n.user.last_name)+"\n                  ")])]),n._v(" "),t("li",{staticClass:"user-footer"},[n.user.admin_url?t("div",{staticClass:"pull-left"},[t("a",{staticClass:"btn btn-default btn-flat skin-color bold",attrs:{href:n.user.admin_url}},[t("i",{class:n.g3wtemplate.getFontClass("folder")}),n._v(" Admin\n                    ")])]):n._e(),n._v(" "),t("div",{staticClass:"pull-right"},[t("a",{directives:[{name:"t",rawName:"v-t",value:"logout",expression:"'logout'"}],staticClass:"btn btn-default btn-flat skin-color bold",attrs:{href:n.user.logout_url}},[t("i",{class:n.g3wtemplate.getFontClass("sign-out"),staticStyle:{"margin-right":"2px"}})])])])])]):n._e(),n._v(" "),n._l(n.custom_header_items_position[2],function(e){return t("header-item",{key:e.id,attrs:{state:e},on:{"show-custom-modal-content":n.showCustomModalContent}})}),n._v(" "),t("li",{staticClass:"dropdown user user-menu"},[t("a",{staticClass:"dropdown-toggle",attrs:{href:"#","data-toggle":"modal","data-target":"#credits"}},[t("i",{class:n.g3wtemplate.getFontClass("credits"),attrs:{"aria-hidden":"true"}}),n._v(" "),t("span",[n._v("Credits")])])]),n._v(" "),n._l(n.custom_header_items_position[3],function(e){return t("header-item",{key:e.id,attrs:{state:e},on:{"show-custom-modal-content":n.showCustomModalContent}})}),n._v(" "),n.languages?t("li",{staticClass:"g3w-languages"},[t("select",{directives:[{name:"select2",rawName:"v-select2",value:"language",expression:"'language'"},{name:"model",rawName:"v-model",value:n.language,expression:"language"}],staticClass:"form-control",staticStyle:{cursor:"pointer",width:"130px"},attrs:{templateSelection:n.templateResultLanguages,templateResult:n.templateResultLanguages},on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});n.language=e.target.multiple?t:t[0]}}},n._l(n.languages,function(e){return t("option",{key:e[0],domProps:{value:e[0],selected:e[0]===n.language&&"selected"}},[n._v("\n                  "+n._s(e[1])+"\n                ")])}),0)]):n._e(),n._v(" "),n.frontendurl?t("li",{staticClass:"dropdown"},[t("a",{attrs:{href:n.frontendurl}},[t("span",[t("i",{class:n.g3wtemplate.getFontClass("home")}),n._v(" Home\n                ")])])]):n._e(),n._v(" "),n._l(n.custom_header_items_position[4],function(e){return t("header-item",{key:e.id,attrs:{state:e},on:{"show-custom-modal-content":n.showCustomModalContent}})})],2)],1)])])]),n._v(" "),t("sidebar"),n._v(" "),t("div",{staticClass:"content-wrapper",style:{paddingTop:n.isIframe?0:null}},[t("viewport",{attrs:{appState:n.appState}})],1),n._v(" "),t("floatbar"),n._v(" "),t("div",{staticClass:"control-sidebar-bg"}),n._v(" "),t("div",{staticClass:"modal fade modal-fullscreen force-fullscreen",attrs:{id:"full-screen-modal",tabindex:"-1",role:"dialog","data-backdrop":"static","data-keyboard":"false","aria-labelledby":"full-screen-modal","aria-hidden":"true"}}),n._v(" "),t("div",{staticClass:"modal fade",attrs:{id:"credits"}},[t("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[t("div",{staticClass:"modal-content"},[t("div",{staticClass:"modal-header"},[n._m(0),n._v(" "),t("div",{staticStyle:{display:"flex","flex-direction":"column","justify-content":"space-around","justify-items":"center","align-items":"center"}},[n.customcredits?t("div",{staticClass:"customcredits",domProps:{innerHTML:n._s(n.customcredits)}}):n._e(),n._v(" "),n.powered_by?t("div",[t("div",{staticClass:"g3w-credits-block"},[t("div",{directives:[{name:"t",rawName:"v-t",value:"credits.g3wSuiteFramework",expression:"'credits.g3wSuiteFramework'"}],staticClass:"credit-title-logo",staticStyle:{"background-color":"#95ad36",padding:"5px","border-radius":"3px",color:"#ffffff"}}),n._v(" "),t("a",{attrs:{target:"_blank",href:"https://g3wsuite.it/"}},[t("img",{staticClass:"g3w-suite-logo",attrs:{src:n.g3w_suite_logo,alt:""}})]),n._v(" "),t("div",{directives:[{name:"t",rawName:"v-t",value:"credits.g3wSuiteDescription",expression:"'credits.g3wSuiteDescription'"}],staticStyle:{"margin-top":"10px"}})]),n._v(" "),t("div",{directives:[{name:"t",rawName:"v-t:pre",value:"credits.productOf",expression:"'credits.productOf'",arg:"pre"}],staticClass:"credit-title-logo g3w-credits-block",staticStyle:{"font-size":"1em",display:"flex","justify-content":"center"}},[t("a",{staticStyle:{"text-align":"center!important"},attrs:{href:"http://www.gis3w.it",target:"_blank"}},[t("img",{staticClass:"img-responsive center-block",staticStyle:{"margin-left":"5px"},attrs:{width:"60",src:n.credits_logo,alt:""}})])]),n._v(" "),t("address",{staticStyle:{"line-height":"1.3","text-align":"center","margin-top":"5px",display:"flex","justify-content":"center"},attrs:{id:"address-credits"}},[t("span",{staticStyle:{padding:"2px"}},[t("span",{class:n.g3wtemplate.getFontClass("marker"),staticStyle:{color:"#95ad36","font-weight":"bold"},attrs:{"aria-hidden":"true"}}),n._v(" Montecatini Terme - Italy\n                ")]),n._v(" "),t("span",{staticStyle:{padding:"2px"}},[t("span",{class:n.g3wtemplate.getFontClass("mobile"),staticStyle:{color:"#95ad36"},attrs:{"aria-hidden":"true"}}),n._v("  +39 393 8534336\n                ")]),n._v(" "),t("span",{staticStyle:{padding:"2px"}},[t("span",{class:n.g3wtemplate.getFontClass("mail"),staticStyle:{color:"#95ad36"},attrs:{"aria-hidden":"true"}}),n._v(" "),t("a",{staticStyle:{color:"#000000"},attrs:{href:"mailto:info@gis3w.it"}},[n._v(" info@gis3w.it")])])])]):n._e()])])])])]),n._v(" "),t("div",{staticClass:"modal fade",attrs:{id:"custom_modal"}},[t("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[t("div",{staticClass:"modal-content",domProps:{innerHTML:n._s(n.current_custom_modal_content)}})])])],1)},e.staticRenderFns=[function(){var e=this.$createElement,e=this._self._c||e;return e("button",{staticClass:"close",staticStyle:{color:"#ffffff","font-weight":"bold",opacity:"1",position:"absolute",right:"25px",top:"20px"},attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[e("span",{attrs:{"aria-hidden":"true"}},[this._v("")])])}]},{"app/constant":5,"components/HeaderItem.vue":169,"core/i18n/i18n.service":12,mixins:290,"services/application":298,"services/gui":302,"store/projects":317,utils:404,"vue-cookie-law":"vue-cookie-law"}],133:[function(e,t,n){function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=e("services/gui"),o=(u=u)&&u.__esModule?u:{default:u},l=e("utils").getUniqueDomId,n.default={name:"c3xyline",props:{showdata:{type:Boolean,default:!0}},data:function(){return{id:"graphline"+l(),selectitems:[],data:[],components:[],config:{data:{columns:[["x"],["y"]]}},size:{width:0,height:0}}},methods:{addComponent:function(e){this.components.push(e)},addComponents:function(){var t=this;(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(e){return t.addComponent(e)})},setConfig:function(){this.config=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}},setDataOffset:function(e){for(var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=this.getData(),r=0;r<n.length;r++)n[r].value+=e;t&&this.resize()},getSelectedItems:function(){return this.selectitems},selectItem:function(e){this.chart.select(["y"],[e])},unselectItem:function(e){this.chart.unselect(["y"],[e])},selectItems:function(){this.chart.select([y],0<arguments.length&&void 0!==arguments[0]?arguments[0]:[])},unselectItems:function(){this.chart.unselect(["y"],0<arguments.length&&void 0!==arguments[0]?arguments[0]:[])},unselectAll:function(){this.chart.unselect()},selectAll:function(){this.chart.select()},getData:function(){return this.data},resize:(s=i(function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.width,e=e.height;yield this.$nextTick(),this.chart.resize({width:t,height:e||$("#"+this.id).height()-4})}),function(){return s.apply(this,arguments)}),_setAllowedSpace:function(){this.components&&this.components.length&&(this.size.height=document.querySelector(".g3wform_content").offsetHeight-this.$el.offsetHeight-document.querySelector(".g3wform_header").offsetHeight-50)},_setMaxMin:function(e){var t=e.value,n=e.max,e=e.min,n=t?+t:+n;(e=t?+t:+e)<this.chart.axis.min().y?this.chart.axis.min(e):n>this.chart.axis.max().y?this.chart.axis.max(n):(t=this.data.map(function(e){return+e.value}),this.chart.axis.max(Math.max.apply(Math,r(t))),this.chart.axis.min(Math.min.apply(Math,r(t)))),this.resize()},changeItems:function(e){1===e.length?this._setMaxMin(e[0].value):this._setMaxMin({max:Math.max.apply(Math,r(e.map(function(e){return+e.value}))),min:Math.min.apply(Math,r(e.map(function(e){return+e.value})))}),this.resize()},changeItem:function(e){var t=e.item,e=e.render,e=void 0===e||e;this._setMaxMin({value:t.value}),e&&this.resize()}},mounted:function(){var t=this;this.$nextTick(function(){o.default.on("resize",t.resize);var n=t;t.config.data.onselected=function(e){n.selectitems=[].concat(r(n.selectitems),[e])},t.config.data.onunselected=function(t){n.selectitems=n.selectitems.filter(function(e){return e.index!==t.index})},t.chart=c3.generate(a({bindto:"#"+t.id},t.config)),(t.chart.data()[0]?t.chart.data()[0].values:[]).forEach(function(e){return t.data.push(e)}),t._setAllowedSpace(),t.$emit("chart-ready",t.chart)})},beforeDestroy:function(){this.data=this.selectitems=null,this.chart.destroy(),this.chart=null,o.default.off("resize",this.resize)}},t.exports.__esModule&&(t.exports=t.exports.default);var a,o,s,l,u="function"==typeof t.exports?t.exports.options:t.exports;u.render=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"chart_wrapper",staticStyle:{height:"100%",width:"100%"}},[n("div",{staticStyle:{height:"100%","min-height":"200px","background-color":"#ffffff"},attrs:{id:t.id}}),t._v(" "),t._l(t.components,function(e){return n("div",[n("divider"),t._v(" "),n(e,{tag:"component",attrs:{data:t.data,selectitems:t.selectitems,size:t.size},on:{"change-item":t.changeItem,"change-items":t.changeItems,"select-item":t.selectItem,"select-all":t.selectAll,"unselect-all":t.unselectAll,"unselect-item":t.unselectItem}})],1)})],2)},u.staticRenderFns=[]},{"services/gui":302,utils:404}],134:[function(e,t,n){var r,i,a,o,s,l,u,c,d,p,f,h,g,v;e("vueify/lib/insert-css").insert(".g3w-catalog-layers-group>div[data-v-f931b03a]{border:1px solid #ffffff33;margin:5px}.g3w-catalog-layers-group>div>h4[data-v-f931b03a]{margin:5px;font-weight:700}");function m(e){return e&&e.__esModule?e:{default:e}}function y(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}function _(e,t){return t||0===t?""+e+t:null}Object.defineProperty(n,"__esModule",{value:!0}),l=e("app/eventbus"),u=m(e("store/catalog-layers")),c=m(e("store/projects")),d=m(e("store/map-controls")),p=m(e("services/application")),f=m(e("services/gui")),h=m(e("components/CatalogChangeMapThemes.vue")),g=m(e("components/CatalogLayerContextMenu.vue")),v=m(e("components/CatalogProjectContextMenu.vue")),e=m(e("components/CatalogTristateTree.vue")),n.default={name:"catalog",data:function(){return{state:this.$options.service.state||{},showlegend:!1,currentBaseLayer:null,activeTab:"layers",loading:!1}},components:{CatalogChangeMapThemes:h.default,CatalogLayerContextMenu:g.default,CatalogProjectContextMenu:v.default,CatalogTristateTree:e.default},computed:{project:function(){return c.default.state.currentProject},title:function(){return this.project.state.name},baselayers:function(){return this.project.state.baselayers},hasBaseLayers:function(){return 0<this.project.state.baselayers.length},hasLayers:function(){var t=0;return this.state.layerstrees.forEach(function(e){return t+=e.tree.length}),0<this.state.external.vector.length||0<t||0<this.state.layersgroups.length}},methods:{onLegendError:function(e){e.error=!0,e.loading=!1},onLegendLoad:function(e){e.loading=!1},getLegendSrc:function(){var r=this,i=0<arguments.length&&void 0!==arguments[0]&&arguments[0];"tab"===this.state.legend.place&&this.state.layerstrees.forEach(function(e){var t,n=r._traverseVisibleLayers(e.tree);r.showlegend=r.showlegend||0<n.length,e.tree.forEach((t=y(function*(e){try{i&&(e.legendurls&&0===e.legendurls.length||n.some(function(e){return e.legend.change})||c.default.getCurrentProject().getContextBaseLegend())&&n.filter(function(e){return e.legend.change}).forEach(function(e){return e.legend.change=!1}),e.legendurls=yield r._getLegendSrc(n)}catch(e){}}),function(e){return t.apply(this,arguments)}))})},_traverseVisibleLayers:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=!0,r=!1,i=void 0;try{for(var a,o=e[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;null!==s.id&&void 0!==s.id&&s.visible&&s.geolayer&&!s.exclude_from_legend&&t.push(s),null!==s.nodes&&void 0!==s.nodes&&(t=t.concat(this._traverseVisibleLayers(s.nodes,t)))}}catch(e){r=!0,i=e}finally{try{!n&&o.return&&o.return()}finally{if(r)throw i}}return t},_getLegendSrc:(s=y(function*(e){var i,a=this,o=[],e=e.filter(function(e){return e.geolayer}),s={GET:{},POST:{}};for(i in e.forEach(function(e){var t=s[e.source&&e.source.url||e.external?"GET":e.ows_method],n=u.default.getLayerById(e.id),r=n?n.getLegendUrl(a.state.legend.config,{all:!c.default.getCurrentProject().getContextBaseLegend(),format:"image/png",categories:e.categories}):void 0;void 0!==n&&(e.source&&e.source.url?t[r]=[]:(t[n=r.split("LAYER=")[0].split("LEGEND_ON=")[0].split("LEGEND_OFF=")[0]]||(t[n]=[]),t[n].unshift({layerName:r.split("LAYER=")[1],style:(Array.isArray(e.styles)&&e.styles.find(function(e){return e.current})||{name:!1}).name,legend_on:(r.split("LAYER=")[0].split("LEGEND_ON=")[1]||"").replace("&",""),legend_off:(r.split("LAYER=")[0].split("LEGEND_ON=")[0].split("LEGEND_OFF=")[1]||"").replace("&","")})))}),s)for(var t in s[i])yield*function*(e){var t={loading:!0,url:null,error:!1},n=(o.push(t),{LAYERS:[],STYLES:[],LEGEND_ON:[],LEGEND_OFF:[]}),r=((s[i][e]||[]).reduce(function(e,t){return n.LAYERS.push(t.layerName),n.STYLES.push(t.style),t.legend_on&&n.LEGEND_ON.push(t.legend_on),t.legend_off&&n.LEGEND_OFF.push(t.legend_off),n},n),[_("LAYERS=",n.LAYERS.join(",")),_("STYLES=",n.STYLES.join(",")),_("LEGEND_ON=",n.LEGEND_ON.join(",")),_("LEGEND_OFF=",n.LEGEND_OFF.join(",")),_("filtertoken=",p.default.getFilterToken())].filter(function(e){return e}).join("&"));try{t.url="GET"===i?e+(s[i][e].length?r:""):URL.createObjectURL(yield(yield fetch(e.split("?")[0],{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},body:e.split("?")[1].split("&").filter(function(e){return e.split("=")[0]}).map(function(e){return e.split("=")[0]+"="+encodeURIComponent(e.split("=")[1])}).join("&")+"&"+r})).blob())}catch(e){}t.loading=!1}(t);return o}),function(e){return s.apply(this,arguments)}),changeMapTheme:(o=y(function*(e){f.default.closeContent(),p.default.changeProjectView(!0),this.state.layerstrees[0].checked=!0;var t=(yield c.default.getCurrentProject().setLayersTreePropertiesFromMapTheme({map_theme:e,rootNode:this.state.layerstrees[0],layerstree:this.state.layerstrees[0].tree[0].nodes})).layers,n=(p.default.changeProjectView(!1),Object.keys(t).filter(function(e){return t[e].style})),r=(yield this.project.getMapThemeFromThemeName(e)).styles;n.forEach(function(e){t[e].visible||((e=u.default.getLayerById(e)).clearCategories(),e.change())}),n.forEach(function(e){return l.CatalogEventBus.$emit("layer-change-style",{layerId:e,style:r[e]})})}),function(e){return o.apply(this,arguments)}),onTabClick:function(e){e.target.attributes["aria-controls"]&&(this.activeTab=e.target.attributes["aria-controls"].value)},setBaseLayer:function(e){this.currentBaseLayer=e,this.project.setBaseLayer(e),p.default.setBaseLayerId(e)},getSrcBaseLayerImage:function(e){var t="nobaselayer.png";switch(e&&e.servertype||e){case"OSM":t="osm.png";break;case"Bing":t="bing"+e.source.subtype+".png";break;case"TMS":case"WMTS":t=e.icon||t}return(e||{}).icon?t:f.default.getResourcesUrl()+"images/"+t},onUnSelectionLayer:function(e,t){f.default.getService("queryresults").removeFromSelection(t,e)},onActiveFilterTokenLayer:(a=y(function*(e,t){t.filter.active=yield u.default.getLayersStore(e).getLayerById(t.id).toggleFilterToken()}),function(e,t){return a.apply(this,arguments)}),onTreeNodeVisible:function(e){f.default.getService("map").emit("cataloglayervisible",e)},onTreeNodeSelected:function(e,t){var n=u.default.getLayersStore(e).getLayerById(t.id);n.isSelected()||f.default.getService("catalog").setSelectedExternalLayer({layer:null,type:"vector",selected:!1}),setTimeout(function(){u.default.getLayersStore(e).selectLayer(t.id,!n.isSelected()),f.default.getService("map").emit("cataloglayerselected",n)})},onTreeNodeExternalSelected:function(e){f.default.getService("catalog").setSelectedExternalLayer({layer:e,type:"vector",selected:!e.selected}).then(function(){e.selected&&u.default.getLayersStores().forEach(function(e){e.selectLayer(null,!1)})})},onRegisterControl:function(e,t){var n=this;"querybbox"===e&&t.getInteraction().on("propertychange",function(e){"active"===e.key&&(n.state.highlightlayers=!e.oldValue)})}},watch:{"state.external.wms":function(e,t){t&&0===e.length&&(this.activeTab=this.project.state.catalog_tab||"layers")},project:{handler:(i=y(function*(e,t){var n=this,r=e.state.catalog_tab||"layers";this.loading="baselayers"===r,yield this.$nextTick(),setTimeout(function(){n.loading=!1,n.activeTab=r},"baselayers"===r?500:0)}),function(e,t){return i.apply(this,arguments)}),immediate:!1},activeTab:function(e){"legend"===e&&this.getLegendSrc(!0)}},created:function(){l.CatalogEventBus.$on("unselectionlayer",this.onUnSelectionLayer),l.CatalogEventBus.$on("activefiltertokenlayer",this.onActiveFilterTokenLayer),l.CatalogEventBus.$on("treenodevisible",this.onTreeNodeVisible),l.CatalogEventBus.$on("treenodeselected",this.onTreeNodeSelected),l.CatalogEventBus.$on("treenodeexternalselected",this.onTreeNodeExternalSelected),l.CatalogEventBus.$on("layer-change-style",this.getLegendSrc),d.default.onafter("registerControl",this.onRegisterControl)},beforeMount:function(){this.currentBaseLayer=this.project.state.initbaselayer},mounted:(r=y(function*(){var e=this;yield this.$nextTick(),c.default.getCurrentProject().getContextBaseLegend()?f.default.getService("map").on("change-map-legend-params",function(){e.getLegendSrc()}):this.getLegendSrc()}),function(){return r.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"tabbable-panel catalog",attrs:{id:"catalog"},on:{contextmenu:function(e){e.preventDefault(),e.stopPropagation()}}},[r("div",{staticClass:"tabbable-line"},[r("ul",{staticClass:"nav nav-tabs catalalog-nav-tabs",attrs:{role:"tablist"},on:{"!click":function(e){return n.onTabClick(e)}}},[n.hasLayers?r("li",{class:{active:"layers"===n.activeTab},attrs:{role:"presentation"}},[r("a",{directives:[{name:"t",rawName:"v-t",value:"data",expression:"'data'"}],attrs:{href:"#layers","aria-controls":"layers",role:"tab","data-toggle":"tab","data-i18n":"tree"}})]):n._e(),n._v(" "),n.state.external.wms.length?r("li",{class:{active:"externalwms"===n.activeTab},attrs:{role:"presentation"}},[r("a",{directives:[{name:"t",rawName:"v-t",value:"externalwms",expression:"'externalwms'"}],attrs:{href:"#externalwms","aria-controls":"externalwms",role:"tab","data-toggle":"tab","data-i18n":"externalwms"}})]):n._e(),n._v(" "),n.hasBaseLayers?r("li",{class:{active:"baselayers"===n.activeTab},attrs:{role:"presentation"}},[r("a",{directives:[{name:"t",rawName:"v-t",value:"baselayers",expression:"'baselayers'"}],attrs:{href:"#baselayers","aria-controls":"baselayers",role:"tab","data-toggle":"tab","data-i18n":"baselayers"}})]):n._e(),n._v(" "),"tab"===n.state.legend.place&&n.showlegend?r("li",{class:{active:"legend"===n.activeTab},attrs:{role:"presentation"}},[r("a",{directives:[{name:"t",rawName:"v-t",value:"legend",expression:"'legend'"}],attrs:{href:"#legend","aria-controls":"legend",role:"tab","data-toggle":"tab","data-i18n":"legend"}})]):n._e()]),n._v(" "),r("div",{staticClass:"tab-content catalog-tab-content"},[r("bar-loader",{attrs:{loading:n.loading}}),n._v(" "),r("div",{staticClass:"tab-pane",class:{active:"layers"===n.activeTab},attrs:{id:"layers",role:"tabpanel"}},[r("helpdiv",{attrs:{message:"catalog_items.helptext"}}),n._v(" "),r("div",{staticStyle:{margin:"2px"},attrs:{id:"g3w-catalog-toc-layers-toolbar"}},[r("catalog-change-map-themes",{key:n.project.state.gid,attrs:{map_themes:n.project.state.map_themes,layerstrees:n.state.layerstrees},on:{"change-map-theme":n.changeMapTheme}})],1),n._v(" "),n._l(n.state.layerstrees,function(t){return r("ul",{key:t.storeid,staticClass:"tree-root root project-root"},n._l(t.tree,function(e){return r("catalog-tristate-tree",{key:e.id,staticClass:"item",attrs:{highlightlayers:n.state.highlightlayers,layerstree:e,parentFolder:!1,root:!0,legendplace:n.state.legend.place,parent_mutually_exclusive:!1,storeid:t.storeid}})}),1)}),n._v(" "),n.state.external.vector.length?r("ul",{staticClass:"g3w-external_layers-group"},n._l(n.state.external.vector,function(e){return r("catalog-tristate-tree",{key:e.id,staticClass:"item",attrs:{externallayers:n.state.external.vector,layerstree:e}})}),1):n._e(),n._v(" "),n._l(n.state.layersgroups,function(e){return r("ul",{staticClass:"g3w-catalog-layers-group"},[r("div",[r("h4",[n._v(n._s(e.title))]),n._v(" "),n._l(e.nodes,function(e){return r("catalog-tristate-tree",{staticClass:"item",attrs:{layerstree:e}})})],2)])})],2),n._v(" "),n.state.external.wms.length?r("div",{staticClass:"tab-pane",class:{active:"externalwms"===n.activeTab},attrs:{id:"externalwms",role:"tabpanel"}},[r("ul",{staticClass:"g3w-external_wms_layers-group"},n._l(n.state.external.wms,function(e){return r("catalog-tristate-tree",{key:e.id,staticClass:"item",attrs:{externallayers:n.state.external.wms,layerstree:e}})}),1)]):n._e(),n._v(" "),n.hasBaseLayers?r("div",{staticClass:"tab-pane baselayers",class:{active:"baselayers"===n.activeTab||!n.hasLayers},attrs:{id:"baselayers",role:"tabpanel"}},[r("ul",{class:{mobile:n.isMobile()},style:{gridTemplateColumns:"repeat(auto-fill, minmax("+(4<n.baselayers.length?80:120)+"px, 1fr))"},attrs:{id:"baselayers-content"}},[n._l(n.baselayers,function(t){return t.fixed?n._e():r("li",{key:t.title},[r("img",{staticClass:"img-responsive img-thumbnail baselayer",style:{opacity:n.currentBaseLayer===t.id?1:.5},attrs:{src:n.getSrcBaseLayerImage(t)},on:{click:function(e){return e.stopPropagation(),n.setBaseLayer(t.id)}}}),n._v(" "),r("div",{staticClass:"baseselayer-text text-center g3w-long-text"},[n._v(n._s(t.title))])])}),n._v(" "),r("li",{on:{click:function(e){return e.stopPropagation(),n.setBaseLayer(null)}}},[r("img",{staticClass:"img-responsive img-thumbnail baselayer",style:{opacity:null===n.currentBaseLayer?1:.5},attrs:{src:n.getSrcBaseLayerImage(null)}}),n._v(" "),r("div",{directives:[{name:"t",rawName:"v-t",value:"nobaselayer",expression:"'nobaselayer'"}],staticClass:"baseselayer-text text-center g3w-long-text"})])],2)]):n._e(),n._v(" "),n._l(n.state.layerstrees,function(e){return"tab"===n.state.legend.place?r("div",{key:e.id,staticClass:"tab-pane",class:{active:"legend"===n.activeTab},attrs:{role:"tabpanel",id:"legend"}},n._l(e.tree,function(e){return r("div",{staticClass:"legend-item"},n._l(e.legendurls,function(t){return r("figure",[r("bar-loader",{attrs:{loading:t.loading}}),n._v(" "),r("img",{directives:[{name:"show",rawName:"v-show",value:!t.loading&&!t.error,expression:"!url.loading && !url.error"}],attrs:{src:t.url},on:{error:function(e){return n.onLegendError(t)},load:function(e){return n.onLegendLoad(t)}}}),n._v(" "),r("divider")],1)}),0)}),0):n._e()})],2)]),n._v(" "),r("catalog-layer-context-menu",{attrs:{external:n.state.external}}),n._v(" "),r("catalog-project-context-menu")],1)},n.staticRenderFns=[],n._scopeId="data-v-f931b03a"},{"app/eventbus":46,"components/CatalogChangeMapThemes.vue":135,"components/CatalogLayerContextMenu.vue":136,"components/CatalogProjectContextMenu.vue":138,"components/CatalogTristateTree.vue":139,"services/application":298,"services/gui":302,"store/catalog-layers":311,"store/map-controls":314,"store/projects":317,"vueify/lib/insert-css":2}],135:[function(e,t,n){var i,r,a,o,s,l,u,c,d;e("vueify/lib/insert-css").insert("#g3w-catalog-toc-views[data-v-06d0cd43]{margin-bottom:5px;border-bottom:2px solid}.g3w-map-theme-anchor[data-v-06d0cd43]{padding:0;margin-bottom:5px}.g3w-map-theme-anchor>section[data-v-06d0cd43]{display:flex;flex-wrap:wrap;align-items:center;padding:5px}.add-map-theme[data-v-06d0cd43]{border-top:2px solid;margin:5px 0}.add-map-theme-input[data-v-06d0cd43]{width:100%}#g3w-catalog-views[data-v-06d0cd43]{display:none}#g3w-catalog-views.menu-open[data-v-06d0cd43]{display:block}.current_map_theme[data-v-06d0cd43]{overflow:hidden;white-space:normal;text-overflow:ellipsis}.choose_map_theme[data-v-06d0cd43]{color:#ccc!important;font-weight:700}.project_map_theme[data-v-06d0cd43]{font-weight:700;padding:3px;border-bottom:1px solid #fff}.user_map_theme[data-v-06d0cd43]{font-weight:700;padding:5px 3px;display:flex;justify-content:space-between;align-self:baseline;border-bottom:1px solid #fff}");function p(e){return e&&e.__esModule?e:{default:e}}function f(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),i=p(e("store/projects")),r=p(e("./InputText.vue")),a=p(e("services/gui")),o=p(e("store/application-state")),c=e("core/i18n/i18n.service").t,d={node:["id","name","visible","expanded"],group:["name","checked","expanded","mutually-exclusive"]},n.default={name:"changemapthemes",components:{InputText:r.default},props:{map_themes:{type:Object,default:{project:[],custom:[]}},layerstrees:{type:Array}},data:function(){var e=Object.values(this.map_themes).flat().find(function(e){return e.default});return{active_theme:e&&e.theme||null,collapsed:"collapsed"===i.default.getCurrentProject().state.toc_themes_init_status,custom_theme:{name:"add-user-theme",label:"sdk.catalog.choose_map_theme_input_label",i18nLabel:!0,value:null,editable:!0,type:"varchar",input:{type:"text",options:{}},visible:!0,validate:{valid:!1,required:!0,error:"sdk.catalog.invalid_map_theme_name"}},show_form:!1}},methods:{_getMapThemeParams:function(){function i(e,n){return d[e].reduce(function(e,t){return e[t]=n[t],e},{})}var a={layerstree:[],styles:{}};return function n(e,r){e.forEach(function(e){var t;void 0!==e.id&&(a.styles[e.id]=e.styles.find(function(e){return e.current}).name,r.push(i("node",e))),Array.isArray(e.nodes)&&((t=i("group",e)).nodes=[],r.push(t),n(e.nodes,t.nodes))})}(this.layerstrees[0].tree[0].nodes,a.layerstree),a},saveTheme:(u=f(function*(){try{var e=this._getMapThemeParams();(yield i.default.getCurrentProject().saveMapTheme(this.custom_theme.value,e)).result&&(this.map_themes.custom.push({theme:this.custom_theme.value,styles:e.styles}),a.default.showUserMessage({type:"success",message:"sdk.catalog.saved_map_theme",autoclose:!0}),this.show_form=!1,this.active_theme=this.custom_theme.value,yield this.$nextTick(),this.custom_theme.value=null)}catch(e){}}),function(){return u.apply(this,arguments)}),updateTheme:(l=f(function*(t){try{var e=this._getMapThemeParams(),n=(yield i.default.getCurrentProject().saveMapTheme(t,e),this.map_themes.custom.find(function(e){return t===e.theme}));n.styles=e.styles,n.layerstree=e.layerstree,a.default.showUserMessage({type:"success",message:"sdk.catalog.updated_map_theme",autoclose:!0})}catch(e){}}),function(e){return l.apply(this,arguments)}),deleteTheme:function(t){var n,r=this;a.default.dialog.confirm(c("sdk.catalog.question_delete_map_theme"),(n=f(function*(e){if(e)try{(yield i.default.getCurrentProject().deleteMapTheme(t)).result&&(r.map_themes.custom=r.map_themes.custom.filter(function(e){return e.theme!==t}),a.default.showUserMessage({type:"success",message:"sdk.catalog.delete_map_theme",autoclose:!0}),t===r.active_theme)&&(r.active_theme=null)}catch(e){}}),function(e){return n.apply(this,arguments)}))}},watch:{active_theme:{immediate:!1,handler:function(e){null!==e&&e!==this.custom_theme.value&&this.$emit("change-map-theme",e)}},"custom_theme.value":function(t){var e=this;setTimeout(function(){e.custom_theme.validate.valid=!!t&&!e.map_themes.custom.find(function(e){return e.theme===t.trim()})},200)},show_form:(s=f(function*(e){this.custom_theme.value=null,e&&(yield this.$nextTick(),Array.from(this.$refs.add_map_theme_input.$el.children).forEach(function(e){return e.classList.remove("col-sm-12")}))}),function(e){return s.apply(this,arguments)})},created:function(){this.logged=void 0!==o.default.user.id}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("ul",{staticClass:"sidebar-menu"},[r("li",{staticClass:"treeview sidebaritem skin-border-color",attrs:{id:"g3w-catalog-toc-views"}},[r("a",{staticClass:"g3w-map-theme-anchor",attrs:{href:"#"}},[r("section",[r("i",{class:n.g3wtemplate.getFontClass("caret-down"),staticStyle:{padding:"3px"}}),n._v(" "),r("i",{class:n.g3wtemplate.getFontClass("eye"),staticStyle:{padding:"0 0 0 4px"}}),n._v(" "),n.active_theme?r("span",{staticClass:"current_map_theme treeview-label g3w-long-text"},[r("span",{directives:[{name:"t",rawName:"v-t:pre",value:"sdk.catalog.current_map_theme_prefix",expression:"'sdk.catalog.current_map_theme_prefix'",arg:"pre"}],staticStyle:{color:"#ccc !important"}},[n._v(":")]),n._v(" "),r("span",{staticClass:"skin-color",staticStyle:{"font-size":"1.1em"}},[n._v(n._s(n.active_theme))])]):r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.choose_map_theme",expression:"'sdk.catalog.choose_map_theme'"}],staticClass:"choose_map_theme treeview-label"})])]),n._v(" "),n.show_form?r("div",{staticClass:"add-map-theme skin-border-color"},[r("div",{staticStyle:{display:"flex","justify-content":"end","padding-top":"5px"}},[r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"close",expression:"'close'",arg:"left",modifiers:{create:!0}}],staticClass:"sidebar-button sidebar-button-icon",class:n.g3wtemplate.getFontClass("close"),staticStyle:{padding:"2px",margin:"2px"},on:{click:function(e){e.stopPropagation(),n.show_form=!1}}})]),n._v(" "),r("div",{staticClass:"container add-map-theme-input"},[r("input-text",{ref:"add_map_theme_input",attrs:{state:n.custom_theme}})],1),n._v(" "),r("div",{staticStyle:{"margin-top":"5px"}},[r("button",{directives:[{name:"t",rawName:"v-t",value:"add",expression:"'add'"},{name:"disabled",rawName:"v-disabled",value:!n.custom_theme.validate.valid,expression:"!custom_theme.validate.valid"}],staticClass:"sidebar-button-run btn btn-block",on:{click:function(e){return e.stopPropagation(),n.saveTheme(e)}}})])]):r("ul",{staticClass:"treeview-menu",class:{"menu-open":!n.collapsed},attrs:{id:"g3w-catalog-views"}},[0<(n.map_themes.project||[]).length?r("li",{attrs:{id:"g3w-catalog-views-project"}},[r("ul",{staticStyle:{padding:"0"}},[r("li",[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.project_map_theme",expression:"'sdk.catalog.project_map_theme'"}],staticClass:"project_map_theme"})]),n._v(" "),r("li",{staticStyle:{padding:"5px 5px 5px 17px"}},n._l(n.map_themes.project,function(t,e){return r("div",{key:t.theme},[r("input",{directives:[{name:"model",rawName:"v-model",value:n.active_theme,expression:"active_theme"}],staticClass:"magic-radio",attrs:{type:"radio",name:"radio",id:"g3w-map_theme-"+e},domProps:{value:t.theme,checked:t.default,checked:n._q(n.active_theme,t.theme)},on:{change:function(e){n.active_theme=t.theme}}}),n._v(" "),r("label",{staticStyle:{display:"flex","justify-content":"space-between"},attrs:{for:"g3w-map_theme-"+e}},[r("span",{staticClass:"g3w-long-text"},[n._v(n._s(t.theme))])])])}),0)])]):n._e(),n._v(" "),n.logged?r("li",{attrs:{id:"g3w-catalog-views-user"}},[r("ul",{staticStyle:{padding:"0"}},[r("li",[r("div",{staticClass:"user_map_theme"},[r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.user_map_theme",expression:"'sdk.catalog.user_map_theme'"}]}),n._v(" "),r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"add",expression:"'add'",arg:"left",modifiers:{create:!0}}],staticClass:"action sidebar-button sidebar-button-icon",class:n.g3wtemplate.getFontClass("plus"),staticStyle:{"margin-left":"auto",padding:"5px"},on:{click:function(e){e.stopPropagation(),n.show_form=!n.show_form}}})])]),n._v(" "),r("li",{staticStyle:{padding:"5px 5px 5px 17px"}},n._l(n.map_themes.custom,function(t,e){return r("div",{key:t.theme,staticStyle:{display:"flex","justify-content":"space-between"}},[r("span",[r("input",{directives:[{name:"model",rawName:"v-model",value:n.active_theme,expression:"active_theme"}],staticClass:"magic-radio",attrs:{type:"radio",name:"radio",id:"g3w-map_theme-"+e+"-user"},domProps:{value:t.theme,checked:t.default,checked:n._q(n.active_theme,t.theme)},on:{change:function(e){n.active_theme=t.theme}}}),n._v(" "),r("label",{attrs:{for:"g3w-map_theme-"+e+"-user"}},[r("span",{staticClass:"g3w-long-text"},[n._v(n._s(t.theme))])])]),n._v(" "),r("span",{staticClass:"g3w-custom-map-theme-tools"},[r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top.create",value:"update",expression:"'update'",arg:"top",modifiers:{create:!0}},{name:"disabled",rawName:"v-disabled",value:n.active_theme!==t.theme,expression:"active_theme !== map_theme.theme"}],staticClass:"action sidebar-button sidebar-button-icon",staticStyle:{padding:"5px"},on:{click:function(e){return e.stopPropagation(),n.updateTheme(t.theme)}}},[r("i",{staticClass:"skin-color",class:n.g3wtemplate.getFontClass("save")})]),n._v(" "),r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top.create",value:"cancel",expression:"'cancel'",arg:"top",modifiers:{create:!0}}],staticClass:"action sidebar-button sidebar-button-icon",staticStyle:{padding:"5px"},on:{click:function(e){return e.stopPropagation(),n.deleteTheme(t.theme)}}},[r("i",{class:n.g3wtemplate.getFontClass("trash"),staticStyle:{color:"red"}})])])])}),0)])]):n._e()])])])},e.staticRenderFns=[],e._scopeId="data-v-06d0cd43"},{"./InputText.vue":185,"core/i18n/i18n.service":12,"services/gui":302,"store/application-state":310,"store/projects":317,"vueify/lib/insert-css":2}],136:[function(e,t,n){var r,i,a,o,s,l,u,c,d,p,f,h,g,v,m,y,_,b,w;e("vueify/lib/insert-css").insert("li .item-text[data-v-7828b5c0]{font-weight:700}");function x(e){return e&&e.__esModule?e:{default:e}}function S(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=e("vue-color"),a=x(e("components/LayerOpacityPicker.vue")),o=e("app/eventbus"),s=x(e("store/catalog-layers")),l=x(e("services/application")),u=x(e("services/gui")),c=x(e("components/Table.vue")),d=e("utils/downloadFile"),_=e("core/i18n/i18n.service").t,b=e("shp-write"),w=15,n.default={name:"catalog-layer-context-menu",props:{external:{type:Object}},data:function(){return{layerMenu:{show:!1,top:0,left:0,tooltip:!1,name:"",layer:null,loading:{data_table:!1,shp:!1,csv:!1,gpx:!1,gpkg:!1,xls:!1},colorMenu:{show:!1,top:0,left:0,color:null},stylesMenu:{show:!1,top:0,left:0,style:null,default:null},filtersMenu:{show:!1,top:0,left:0,style:null,default:null},metadatainfoMenu:{show:!1,top:0,left:0}}}},computed:{layers_url:function(){return l.default.getCurrentProject().getState().layers_url}},components:{"chrome-picker":i.Chrome,"layer-opacity-picker":a.default},methods:{addLayerMenuItem:function(){this.layerMenu=r({},this.layerMenu,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},_hideMenu:function(){this.layerMenu.show=!1,this.layerMenu.styles=!1,this.layerMenu.loading.data_table=!1,this.layerMenu.loading.shp=!1,this.layerMenu.loading.csv=!1,this.layerMenu.loading.gpx=!1,this.layerMenu.loading.gpkg=!1,this.layerMenu.loading.xls=!1,this.layerMenu.loading.geotiff=!1,this.layerMenu.loading.unknow=!1},closeLayerMenu:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._hideMenu(),this.showColorMenu(!1),e.show=!1},onbeforeDestroyChangeColor:function(){this.$refs.color_picker.$off()},onChangeColor:function(e){var t=u.default.getService("map"),t=(this.layerMenu.layer.color=e,t.getLayerByName(this.layerMenu.name)),n=t.getStyle();n._g3w_options.color=e,t.setStyle(n)},canShowWmsUrl:function(e){e=s.default.getLayerById(e);return!!e&&!(e.isType("table")||!e.getFullWmsUrl())},canShowWfsUrl:function(e){e=s.default.getLayerById(e);return e&&!e.isType("table")&&e.isWfsActive()},canDownloadXls:function(e){e=s.default.getLayerById(e);return!!e&&e.isXlsDownlodable()},canDownloadGpx:function(e){e=s.default.getLayerById(e);return!!e&&e.isGpxDownlodable()},canDownloadGpkg:function(e){e=s.default.getLayerById(e);return!!e&&e.isGpkgDownlodable()},canDownloadCsv:function(e){e=s.default.getLayerById(e);return!!e&&e.isCsvDownlodable()},canDownloadGeoTIFF:function(e){e=s.default.getLayerById(e);return!!e&&e.isGeoTIFFDownlodable()},canDownloadShp:function(e){e=s.default.getLayerById(e);return!!e&&e.isShpDownlodable()},getWmsUrl:function(e){return s.default.getLayerById(e).getCatalogWmsUrl()},getWfsUrl:function(e){return s.default.getLayerById(e).getCatalogWfsUrl()},getWfs3Url:function(e){return s.default.getLayerById(e).getCatalogWfs3Url()},copyUrl:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=t.evt,r=t.layerId,t=this["get"+t.type+"Url"](r),r=document.createElement("a"),t=(r.href=t,document.createElement("input"));t.value=r.href,document.body.appendChild(t),t.select(),document.execCommand("copy"),$(n.target).attr("data-original-title",_("sdk.catalog.menu.wms.copied")).tooltip("show"),$(n.target).attr("title",this.copywmsurltooltip).tooltip("fixTitle"),document.body.removeChild(t),r=null,setTimeout(function(){$('[data-toggle="tooltip"]').tooltip("destroy"),e._hideMenu()},600)},downloadGeoTIFF:function(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=l.default.setDownload(!0);this.layerMenu.loading.geotiff=!0,s.default.getLayerById(e).getGeoTIFF({data:n?{map_extent:u.default.getService("map").getMapExtent().toString()}:void 0}).catch(function(e){return u.default.notify.error(_("info.server_error"))}).finally(function(){t.layerMenu.loading.geotiff=!1,l.default.setDownload(!1,r),t._hideMenu()})},downloadShp:function(e){var t=this,n=l.default.setDownload(!0);this.layerMenu.loading.shp=!0,s.default.getLayerById(e).getShp().catch(function(e){return u.default.notify.error(_("info.server_error"))}).finally(function(){t.layerMenu.loading.shp=!1,l.default.setDownload(!1,n),t._hideMenu()})},downloadCsv:function(e){var t=this,n=l.default.setDownload(!0);this.layerMenu.loading.csv=!0,s.default.getLayerById(e).getCsv().catch(function(e){return u.default.notify.error(_("info.server_error"))}).finally(function(){t.layerMenu.loading.csv=!1,l.default.setDownload(!1,n),t._hideMenu()})},downloadXls:function(e){var t=this,n=l.default.setDownload(!0);this.layerMenu.loading.xls=!0,s.default.getLayerById(e).getXls().catch(function(e){return u.default.notify.error(_("info.server_error"))}).finally(function(){t.layerMenu.loading.xls=!1,l.default.setDownload(!1,n),t._hideMenu()})},downloadGpx:function(e){var t=this,n=l.default.setDownload(!0);this.layerMenu.loading.gpx=!0,s.default.getLayerById(e).getGpx().catch(function(e){return u.default.notify.error(_("info.server_error"))}).finally(function(){t.layerMenu.loading.gpx=!1,l.default.setDownload(!1,n),t._hideMenu()})},downloadGpkg:function(e){var t=this,n=l.default.setDownload(!0);this.layerMenu.loading.gpkg=!0,s.default.getLayerById(e).getGpkg().catch(function(e){return u.default.notify.error(_("info.server_error"))}).finally(function(){t.layerMenu.loading.gpkg=!1,l.default.setDownload(!1,n),t._hideMenu()})},changeLayerMapPosition:function(e){var t=e.position,e=e.layer;e.position!==t&&(e.position=t,u.default.getService("map").changeLayerMapPosition({id:e.id,position:t}),this._hideMenu())},setWMSOpacity:function(e){var t=e.id,t=void 0===t?this.layerMenu.layer.id:t,e=e.value;this.layerMenu.layer.opacity=e,u.default.getService("map").changeLayerOpacity({id:t,opacity:e})},zoomToLayer:function(e){u.default.getService("map").goToBBox([e.bbox.minx,e.bbox.miny,e.bbox.maxx,e.bbox.maxy],e.epsg),this._hideMenu()},canZoom:function(e){return e.bbox&&[e.bbox.minx,e.bbox.miny,e.bbox.maxx,e.bbox.maxy].find(function(e){return 0<e})},getGeometryType:function(t){var e,n=void 0;return 1<arguments.length&&void 0!==arguments[1]&&arguments[1]?(e=this.external.vector.find(function(e){return e.id===t}))&&(n=e.geometryType):n=s.default.getLayerById(t).config.geometrytype,n=n&&"NoGeometry"!==n?n:""},downloadExternal:function(e){this.layerMenu.loading.unknow=!0,(0,d.downloadFile)({url:e}),this.layerMenu.loading.unknow=!1},downloadExternalShapefile:(y=S(function*(t){var n="EPSG:4326",e=(this.layerMenu.loading.shp=!0,u.default.getService("map").getLayerByName(t.name).getSource().getFeatures()),r=(n!==t.crs&&(e=e.map(function(e){e=e.clone();return e.getGeometry().transform(t.crs,n),e})),t.name.split("."+t.type)[0]);b.download((new ol.format.GeoJSON).writeFeaturesObject(e,{featureProjection:n}),{folder:r,types:{point:r,mulipoint:r,polygon:r,multipolygon:r,line:r,polyline:r,multiline:r}}),yield this.$nextTick(),this.layerMenu.loading.shp=!1,this._hideMenu()}),function(e){return y.apply(this,arguments)}),showAttributeTable:function(e){var t=this;this.layerMenu.loading.data_table=!1,u.default.closeContent(),this.layerMenu.loading.data_table=!0,new(Vue.extend(c.default))({layerId:e,onShow:function(){t.layerMenu.loading.data_table=!1,t._hideMenu()}})},startEditing:function(){var t=this,n=void 0;s.default.getLayersStores().forEach(function(e){if(n=e.getLayerById(t.layerMenu.layer.id))return n.getLayerForEditing(),!1})},setCurrentLayerStyle:function(n){var e,t,r=this,i=!1;this.layerMenu.layer.styles.forEach(function(e,t){t===n?(r.layerMenu.stylesMenu.style=e.name,i=!e.current,e.current=!0):e.current=!1}),i&&(e=this.layerMenu.layer.id,t=s.default.getLayerById(e))&&(o.CatalogEventBus.$emit("layer-change-style",{layerId:e,style:this.layerMenu.stylesMenu.style}),t.change()),this.closeLayerMenu(this.layerMenu.stylesMenu)},setCurrentLayerFilter:(m=S(function*(e){var t=null===this.layerMenu.layer.filter.current||this.layerMenu.layer.filter.current.fid!==e.fid,n=s.default.getLayerById(this.layerMenu.layer.id);t?yield n.applyFilter(e):yield n.deleteFilterToken(),n.change(),this.closeLayerMenu(this.layerMenu.filtersMenu)}),function(e){return m.apply(this,arguments)}),deleteFilter:(v=S(function*(e){var t=s.default.getLayerById(this.layerMenu.layer.id),n=e===this.layerMenu.layer.fid;t&&(yield t.deleteFilterToken(e),n&&t.change(),this.closeLayerMenu(this.layerMenu.filtersMenu))}),function(e){return v.apply(this,arguments)}),showSubMenuContext:(g=S(function*(e){var t,n,r,i=e.menu,a=e.bool,e=e.evt;"string"==typeof i&&(i=this.layerMenu[i]),a&&(t=$(e.target),i.top=t.offset().top,i.left=t.offset().left+t.width()+(t.outerWidth()-t.width())/2+w,t=$(this.$refs["layer-menu"]),n=(e=$(e.target)).children("ul").height(),r=t.height(),i.maxHeight=r<=n?r:null,i.overflowY=r<=n?"scroll":null,i.top=(r<=n?t:e).offset().top,i.left=this.isMobile()?0:e.offset().left+e.width()+(e.outerWidth()-e.width())/2+w,yield this.$nextTick()),i.show=a}),function(e){return g.apply(this,arguments)}),showStylesMenu:(h=S(function*(e,t){this.showSubMenuContext({bool:e,evt:t,menu:this.layerMenu.stylesMenu})}),function(e,t){return h.apply(this,arguments)}),showMetadataInfo:(f=S(function*(e,t){e&&(t=$(t.target),this.layerMenu.metadatainfoMenu.top=t.offset().top,this.layerMenu.metadatainfoMenu.left=t.offset().left+t.width()+(t.outerWidth()-t.width())/2+w,yield this.$nextTick()),this.layerMenu.metadatainfoMenu.show=e}),function(e,t){return f.apply(this,arguments)}),showColorMenu:function(e,t){var n;e&&(t=$(t.target),n=$(this.$refs["layer-menu"]),this.layerMenu.colorMenu.top=n.offset().top,this.layerMenu.colorMenu.left=t.offset().left+t.width()+(t.outerWidth()-t.width())/2-w),this.layerMenu.colorMenu.show=e},onShowLayerContextMenu:(p=S(function*(e,t){this._hideMenu(),yield this.$nextTick(),this.layerMenu.left=t.x,this.layerMenu.name=e.name,this.layerMenu.layer=e,this.layerMenu.show=!0,this.layerMenu.colorMenu.color=e.color,yield this.$nextTick(),this.layerMenu.top=$(t.target).offset().top-$(this.$refs["layer-menu"]).height()+$(t.target).height()/2,$('.catalog-menu-wms[data-toggle="tooltip"]').tooltip()}),function(e,t){return p.apply(this,arguments)}),canOpenAttributeTable:function(e){return e.openattributetable},isExternalLayer:function(e){return!e.projectLayer},getStyleName:function(e){return e.name+(e.name===this.layerMenu.layer.defaultstyle&&1<this.layerMenu.layer.styles.length?" ("+_("default")+")":"")},isExternalWMSLayer:function(e){return!e.projectLayer&&"wms"===e._type},isExternalVectorLayer:function(e){return!e.projectLayer&&"wms"!==e._type},canShowStylesMenu:function(e){return e.geolayer&&e.styles&&1<e.styles.length},canShowFiltersMenu:function(e){return e.filters&&0<e.filters.length},hasMetadataInfo:function(e){return e.metadata&&e.metadata.abstract},canShowOpacityPicker:function(e){return e.geolayer&&e.visible}},created:function(){o.CatalogEventBus.$on("show-layer-context-menu",this.onShowLayerContextMenu),o.CatalogEventBus.$on("hide-layer-context-menu",this._hideMenu)}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var n=this,e=n.$createElement,r=n._self._c||e;return n.layerMenu.show?r("ul",{directives:[{name:"click-outside",rawName:"v-click-outside",value:n.closeLayerMenu,expression:"closeLayerMenu"}],ref:"layer-menu",staticClass:"catalog-context-menu",style:{top:n.layerMenu.top+"px",left:n.layerMenu.left+"px"},attrs:{id:"layer-context-menu",tabindex:"-1"}},[r("li",{staticClass:"title"},[r("div",[n._v(n._s(n.layerMenu.layer.title))]),n._v(" "),r("div",{staticStyle:{"font-weight":"normal","font-size":"0.8em"}},[n._v("\n      "+n._s(n.getGeometryType(n.layerMenu.layer.id,n.layerMenu.layer.external))+"\n    ")])]),n._v(" "),n.isExternalLayer(n.layerMenu.layer)?r("li",[r("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"}},[r("layerspositions",{staticStyle:{display:"flex","flex-direction":"column","justify-content":"space-between"},attrs:{position:n.layerMenu.layer.position},on:{"layer-position-change":function(e){return n.changeLayerMapPosition({position:e,layer:n.layerMenu.layer})}}})],1)]):n._e(),n._v(" "),n.hasMetadataInfo(n.layerMenu.layer)?r("li",{on:{mouseleave:function(e){return e.target!==e.currentTarget?null:n.showMetadataInfo(!1)},mouseover:function(e){return e.target!==e.currentTarget?null:n.showMetadataInfo(!0,e)}}},[r("span",{staticClass:"menu-icon skin-color-dark",class:n.g3wtemplate.getFontClass("info")}),n._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"Metadata",expression:"'Metadata'"}],staticClass:"item-text"}),n._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:n.layerMenu.metadatainfoMenu.show,expression:"layerMenu.metadatainfoMenu.show"}],staticStyle:{position:"fixed","background-color":"#FFFFFF",color:"#000000","padding-left":"0","border-radius":"0 3px 3px 0"},style:{top:n.layerMenu.metadatainfoMenu.top+"px",left:n.layerMenu.metadatainfoMenu.left+1+"px"}},[r("div",{staticClass:"layer-menu-metadata-info",staticStyle:{padding:"5px"},domProps:{innerHTML:n._s(n.layerMenu.layer.metadata.abstract)}})])]):n._e(),n._v(" "),n.canShowStylesMenu(n.layerMenu.layer)?r("li",{staticClass:"menu-icon",on:{mouseleave:function(e){return e.target!==e.currentTarget?null:n.showStylesMenu(!1,e)},mouseover:function(e){return e.target!==e.currentTarget?null:n.showStylesMenu(!0,e)}}},[r("span",{staticClass:"menu-icon skin-color-dark",class:n.g3wtemplate.getFontClass("palette")}),n._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"catalog_items.contextmenu.styles",expression:"'catalog_items.contextmenu.styles'"}],staticClass:"item-text"}),n._v(" "),r("span",{staticClass:"menu-icon",class:n.g3wtemplate.getFontClass("arrow-right"),staticStyle:{position:"absolute",right:"0","margin-top":"3px"}}),n._v(" "),r("ul",{directives:[{name:"show",rawName:"v-show",value:n.layerMenu.stylesMenu.show,expression:"layerMenu.stylesMenu.show"}],staticStyle:{position:"fixed","padding-left":"0","background-color":"#FFFFFF",color:"#000000"},style:{top:n.layerMenu.stylesMenu.top+"px",left:n.layerMenu.stylesMenu.left+"px",maxHeight:n.layerMenu.stylesMenu.maxHeight+"px",overflowY:n.layerMenu.stylesMenu.overflowY}},n._l(n.layerMenu.layer.styles,function(e,t){return r("li",{key:e.name,on:{click:function(e){return e.stopPropagation(),n.setCurrentLayerStyle(t)}}},[e.current?r("span",{class:n.g3wtemplate.getFontClass("circle"),staticStyle:{"font-size":"0.8em"}}):n._e(),n._v(" "),r("span",[n._v(n._s(n.getStyleName(e)))])])}),0)]):n._e(),n._v(" "),n.canShowOpacityPicker(n.layerMenu.layer)?r("li",{staticClass:"menu-icon",staticStyle:{"padding-right":"0"}},[r("layer-opacity-picker",{attrs:{layer:n.layerMenu.layer},on:{"init-menu-item":n.addLayerMenuItem,"show-menu-item":n.showSubMenuContext}})],1):n._e(),n._v(" "),n.canZoom(n.layerMenu.layer)?r("li",{on:{click:function(e){return e.preventDefault(),e.stopPropagation(),n.zoomToLayer(n.layerMenu.layer)}}},[r("span",{staticClass:"menu-icon skin-color-dark",class:n.g3wtemplate.getFontClass("search")}),n._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"catalog_items.contextmenu.zoomtolayer",expression:"'catalog_items.contextmenu.zoomtolayer'"}],staticClass:"item-text"})]):n._e(),n._v(" "),n.canOpenAttributeTable(n.layerMenu.layer)?r("li",{on:{click:function(e){return e.preventDefault(),e.stopPropagation(),n.showAttributeTable(n.layerMenu.layer.id)}}},[r("bar-loader",{attrs:{loading:n.layerMenu.loading.data_table}}),n._v(" "),r("span",{staticClass:"menu-icon skin-color-dark",class:n.g3wtemplate.getFontClass("list")}),n._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"catalog_items.contextmenu.open_attribute_table",expression:"'catalog_items.contextmenu.open_attribute_table'"}],staticClass:"item-text"})],1):n._e(),n._v(" "),n.isExternalVectorLayer(n.layerMenu.layer)?r("li",{on:{click:function(e){e.preventDefault(),e.stopPropagation()},mouseleave:function(e){return e.target!==e.currentTarget?null:n.showColorMenu(!1,e)},mouseover:function(e){return e.target!==e.currentTarget?null:n.showColorMenu(!0,e)}}},[r("span",{directives:[{name:"t",rawName:"v-t",value:"catalog_items.contextmenu.vector_color_menu",expression:"'catalog_items.contextmenu.vector_color_menu'"}],staticClass:"item-text"}),n._v(" "),r("span",{staticClass:"menu-icon skin-color-dark",class:n.g3wtemplate.getFontClass("arrow-right"),staticStyle:{position:"absolute",right:"0","margin-top":"3px"}}),n._v(" "),n.layerMenu.colorMenu.show?r("ul",{staticStyle:{position:"fixed"},style:{top:n.layerMenu.colorMenu.top+"px",left:n.layerMenu.colorMenu.left+"px"}},[r("li",{staticStyle:{padding:"0"}},[r("chrome-picker",{ref:"color_picker",staticStyle:{width:"100%"},on:{click:function(e){e.preventDefault(),e.stopPropagation()},"hook:beforeDestroy":n.onbeforeDestroyChangeColor,input:n.onChangeColor},model:{value:n.layerMenu.colorMenu.color,callback:function(e){n.$set(n.layerMenu.colorMenu,"color",e)},expression:"layerMenu.colorMenu.color"}})],1)]):n._e()]):n._e(),n._v(" "),n.isExternalVectorLayer(n.layerMenu.layer)&&n.layerMenu.layer.downloadUrl?r("li",{directives:[{name:"download",rawName:"v-download"}],on:{click:function(e){e.preventDefault(),e.stopPropagation()}}},[r("div",{on:{click:function(e){return e.preventDefault(),e.stopPropagation(),n.downloadExternal(n.layerMenu.layer.downloadUrl)}}},[r("bar-loader",{attrs:{loading:n.layerMenu.loading.unknow}}),n._v(" "),r("span",{staticClass:"menu-icon skin-color-dark",class:n.g3wtemplate.getFontClass("download")}),n._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.unknow",expression:"'sdk.catalog.menu.download.unknow'"}],staticClass:"item-text"})],1)]):n._e(),n._v(" "),n.isExternalVectorLayer(n.layerMenu.layer)&&!n.layerMenu.layer.downloadUrl?r("li",{directives:[{name:"download",rawName:"v-download"}],on:{click:function(e){e.preventDefault(),e.stopPropagation()}}},[r("div",{on:{click:function(e){return e.preventDefault(),e.stopPropagation(),n.downloadExternalShapefile(n.layerMenu.layer)}}},[r("bar-loader",{attrs:{loading:n.layerMenu.loading.shp}}),n._v(" "),r("span",{staticClass:"menu-icon skin-color-dark",class:n.g3wtemplate.getFontClass("shapefile")}),n._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.shp",expression:"'sdk.catalog.menu.download.shp'"}],staticClass:"item-text"})],1)]):n._e(),n._v(" "),n.isExternalWMSLayer(n.layerMenu.layer)?r("li",{on:{click:function(e){e.preventDefault(),e.stopPropagation()}}},[r("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.setwmsopacity",expression:"'sdk.catalog.menu.setwmsopacity'"}],staticClass:"item-text"}),n._v(" "),r("span",{staticStyle:{"font-weight":"bold","margin-left":"5px"}},[n._v(n._s(n.layerMenu.layer.opacity))])]),n._v(" "),r("range",{attrs:{value:n.layerMenu.layer.opacity,min:0,max:1,step:.1,sync:!0},on:{changed:n._hideMenu,"change-range":n.setWMSOpacity}})],1):n._e(),n._v(" "),n.canDownloadGeoTIFF(n.layerMenu.layer.id)?r("li",{directives:[{name:"download",rawName:"v-download"}]},[r("div",{on:{click:function(e){return e.preventDefault(),e.stopPropagation(),n.downloadGeoTIFF(n.layerMenu.layer.id)}}},[r("bar-loader",{attrs:{loading:n.layerMenu.loading.geotiff}}),n._v(" "),r("span",{staticClass:"menu-icon skin-color-dark",class:n.g3wtemplate.getFontClass("geotiff")}),n._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.geotiff",expression:"'sdk.catalog.menu.download.geotiff'"}],staticClass:"item-text"})],1)]):n._e(),n._v(" "),n.canDownloadGeoTIFF(n.layerMenu.layer.id)?r("li",{directives:[{name:"download",rawName:"v-download"}]},[r("div",{staticStyle:{position:"relative"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),n.downloadGeoTIFF(n.layerMenu.layer.id,!0)}}},[r("bar-loader",{attrs:{loading:n.layerMenu.loading.geotiff}}),n._v(" "),r("span",{staticClass:"menu-icon skin-color-dark",class:n.g3wtemplate.getFontClass("geotiff"),staticStyle:{color:"#777"}}),n._v(" "),r("span",{staticClass:"menu-icon skin-color-dark",class:n.g3wtemplate.getFontClass("crop"),staticStyle:{position:"absolute",left:"-7px",bottom:"8px","font-size":"1.2em"}}),n._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.geotiff_map_extent",expression:"'sdk.catalog.menu.download.geotiff_map_extent'"}],staticClass:"item-text"})],1)]):n._e(),n._v(" "),n.canDownloadShp(n.layerMenu.layer.id)?r("li",{directives:[{name:"download",rawName:"v-download"}]},[r("div",{on:{click:function(e){return e.preventDefault(),e.stopPropagation(),n.downloadShp(n.layerMenu.layer.id)}}},[r("bar-loader",{attrs:{loading:n.layerMenu.loading.shp}}),n._v(" "),r("span",{staticClass:"menu-icon skin-color-dark",class:n.g3wtemplate.getFontClass("shapefile")}),n._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.shp",expression:"'sdk.catalog.menu.download.shp'"}],staticClass:"item-text"})],1)]):n._e(),n._v(" "),n.canDownloadGpx(n.layerMenu.layer.id)?r("li",[r("div",{directives:[{name:"download",rawName:"v-download"}],on:{click:function(e){return e.preventDefault(),e.stopPropagation(),n.downloadGpx(n.layerMenu.layer.id)}}},[r("bar-loader",{attrs:{loading:n.layerMenu.loading.gpx}}),n._v(" "),r("span",{staticClass:"menu-icon skin-color-dark",class:n.g3wtemplate.getFontClass("gpx")}),n._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.gpx",expression:"'sdk.catalog.menu.download.gpx'"}],staticClass:"item-text"})],1)]):n._e(),n._v(" "),n.canDownloadGpkg(n.layerMenu.layer.id)?r("li",[r("div",{directives:[{name:"download",rawName:"v-download"}],on:{click:function(e){return e.preventDefault(),e.stopPropagation(),n.downloadGpkg(n.layerMenu.layer.id)}}},[r("bar-loader",{attrs:{loading:n.layerMenu.loading.gpkg}}),n._v(" "),r("span",{staticClass:"menu-icon skin-color-dark",class:n.g3wtemplate.getFontClass("gpkg")}),n._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.gpkg",expression:"'sdk.catalog.menu.download.gpkg'"}],staticClass:"item-text"})],1)]):n._e(),n._v(" "),n.canDownloadCsv(n.layerMenu.layer.id)?r("li",[r("div",{directives:[{name:"download",rawName:"v-download"}],on:{click:function(e){return e.preventDefault(),e.stopPropagation(),n.downloadCsv(n.layerMenu.layer.id)}}},[r("bar-loader",{attrs:{loading:n.layerMenu.loading.csv}}),n._v(" "),r("span",{staticClass:"menu-icon skin-color-dark",class:n.g3wtemplate.getFontClass("csv")}),n._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.csv",expression:"'sdk.catalog.menu.download.csv'"}],staticClass:"item-text"})],1)]):n._e(),n._v(" "),n.canDownloadXls(n.layerMenu.layer.id)?r("li",{directives:[{name:"download",rawName:"v-download"}]},[r("div",{on:{click:function(e){return e.preventDefault(),e.stopPropagation(),n.downloadXls(n.layerMenu.layer.id)}}},[r("bar-loader",{attrs:{loading:n.layerMenu.loading.xls}}),n._v(" "),r("span",{staticClass:"menu-icon skin-color-dark",class:n.g3wtemplate.getFontClass("xls")}),n._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.xls",expression:"'sdk.catalog.menu.download.xls'"}],staticClass:"item-text"})],1)]):n._e(),n._v(" "),n.canShowFiltersMenu(n.layerMenu.layer)?r("li",{staticClass:"menu-icon",on:{mouseleave:function(e){return e.target!==e.currentTarget?null:n.showSubMenuContext({menu:"filtersMenu",bool:!1,evt:e})},mouseover:function(e){return e.target!==e.currentTarget?null:n.showSubMenuContext({menu:"filtersMenu",bool:!0,evt:e})}}},[r("span",{staticClass:"menu-icon skin-color-dark",class:n.g3wtemplate.getFontClass("filter")}),n._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"catalog_items.contextmenu.filters",expression:"'catalog_items.contextmenu.filters'"}],staticClass:"item-text"}),n._v(" "),r("span",{staticClass:"menu-icon",class:n.g3wtemplate.getFontClass("arrow-right"),staticStyle:{position:"absolute",right:"0","margin-top":"3px"}}),n._v(" "),r("ul",{directives:[{name:"show",rawName:"v-show",value:n.layerMenu.filtersMenu.show,expression:"layerMenu.filtersMenu.show"}],staticStyle:{position:"fixed","padding-left":"0","background-color":"#FFFFFF",color:"#000000"},style:{top:n.layerMenu.filtersMenu.top+"px",left:n.layerMenu.filtersMenu.left+"px",maxHeight:n.layerMenu.filtersMenu.maxHeight+"px",overflowY:n.layerMenu.filtersMenu.overflowY}},n._l(n.layerMenu.layer.filters,function(t){return r("li",{key:t.fid,staticStyle:{display:"flex","justify-content":"space-between","align-items":"baseline"},on:{click:function(e){return e.stopPropagation(),n.setCurrentLayerFilter(t)}}},[n.layerMenu.layer.filter.current&&n.layerMenu.layer.filter.current.fid===t.fid?r("span",{class:n.g3wtemplate.getFontClass("circle"),staticStyle:{"font-size":"0.5em","margin-right":"3px","justify-self":"flex-start"}}):n._e(),n._v(" "),r("span",{staticStyle:{"margin-right":"5px"}},[n._v(n._s(t.name))]),n._v(" "),r("span",{staticClass:"skin-border-color",class:n.g3wtemplate.getFontClass("trash"),staticStyle:{color:"red",right:"0","padding-left":"10px","border-left":"2px solid"},on:{click:function(e){return e.stopPropagation(),n.deleteFilter(t.fid)}}})])}),0)]):n._e(),n._v(" "),n.canShowWmsUrl(n.layerMenu.layer.id)?r("li",[r("div",{staticStyle:{display:"flex","max-width":"300px","align-items":"center"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),n.copyUrl({evt:e,layerId:n.layerMenu.layer.id,type:"Wms"})}}},[r("span",{staticClass:"menu-icon skin-color-dark",class:n.g3wtemplate.getFontClass("map")}),n._v(" "),r("div",{staticStyle:{display:"inline-flex","justify-content":"space-between",width:"100%","align-items":"baseline"}},[r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.catalog.menu.wms.copy",expression:"'sdk.catalog.menu.wms.copy'"}],staticClass:"item-text catalog-menu-wms skin-tooltip-top",attrs:{"data-toggle":"tooltip","data-container":"body"}},[n._v("WMS URL")]),n._v(" "),r("span",{staticClass:"bold catalog-menu-wms wms-url-tooltip skin-tooltip-top skin-color-dark",class:n.g3wtemplate.getFontClass("eye"),attrs:{"data-placement":"top","data-toggle":"tooltip","data-container":"body",title:n.getWmsUrl(n.layerMenu.layer.id)}})])])]):n._e(),n._v(" "),n.canShowWfsUrl(n.layerMenu.layer.id)?r("li",[r("div",{staticStyle:{display:"flex","max-width":"300px","align-items":"center"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),n.copyUrl({evt:e,layerId:n.layerMenu.layer.id,type:"Wfs"})}}},[r("span",{staticClass:"menu-icon skin-color-dark",class:n.g3wtemplate.getFontClass("map")}),n._v(" "),r("div",{staticStyle:{display:"inline-flex","justify-content":"space-between",width:"100%","align-items":"baseline"}},[r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.catalog.menu.wms.copy",expression:"'sdk.catalog.menu.wms.copy'"}],staticClass:"item-text catalog-menu-wms skin-tooltip-top",attrs:{"data-toggle":"tooltip","data-container":"body"}},[n._v("WFS URL")]),n._v(" "),r("span",{staticClass:"bold catalog-menu-wms wms-url-tooltip skin-tooltip-top skin-color-dark",class:n.g3wtemplate.getFontClass("eye"),attrs:{"data-placement":"top","data-toggle":"tooltip","data-container":"body",title:n.getWfsUrl(n.layerMenu.layer.id)}})])])]):n._e(),n._v(" "),n.canShowWfsUrl(n.layerMenu.layer.id)?r("li",[r("div",{staticStyle:{display:"flex","max-width":"300px","align-items":"center"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),n.copyUrl({evt:e,layerId:n.layerMenu.layer.id,type:"Wfs3"})}}},[r("span",{staticClass:"menu-icon skin-color-dark",class:n.g3wtemplate.getFontClass("map")}),n._v(" "),r("div",{staticStyle:{display:"inline-flex","justify-content":"space-between",width:"100%","align-items":"baseline"}},[r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.catalog.menu.wms.copy",expression:"'sdk.catalog.menu.wms.copy'"}],staticClass:"item-text catalog-menu-wms skin-tooltip-top",attrs:{"data-toggle":"tooltip","data-container":"body"}},[n._v("WFS 3 URL")]),n._v(" "),r("span",{staticClass:"bold catalog-menu-wms wms-url-tooltip skin-tooltip-top skin-color-dark",class:n.g3wtemplate.getFontClass("eye"),attrs:{"data-placement":"top","data-toggle":"tooltip","data-container":"body",title:n.getWfs3Url(n.layerMenu.layer.id)}})])])]):n._e(),n._v(" "),n.layers_url?r("li",[r("div",[r("span",{staticClass:"menu-icon skin-color-dark"},[r("svg",{staticStyle:{height:"14px","vertical-align":"-1.5px",fill:"currentColor"},attrs:{xmlns:"http://www.w3.org/2000/svg","xml:space":"preserve",viewBox:"0 0 32 32"}},[r("path",{attrs:{d:"m17.61 17.63 4.36-.02-4-3.98h-4.36v4l4 4.45z"}}),n._v(" "),r("path",{attrs:{d:"m31.61 27.22-7.62-7.6-4.38.01v4.33l7.24 7.67h4.76z"}}),n._v(" "),r("path",{attrs:{d:"M18 25.18c-.68.16-1.17.2-1.9.2a9.77 9.77 0 0 1-9.68-9.88c0-5.57 4.4-9.78 9.68-9.78s9.48 4.2 9.48 9.78c0 .91-.15 1.96-.36 2.8l4.88 4.65a15 15 0 0 0 1.95-7.48C32.05 6.87 25.19.44 16 .44 6.86.44 0 6.84 0 15.47c0 8.68 6.86 15.2 16 15.2 2.36 0 4.23-.3 6.2-1.1L18 25.18z"}})])]),n._v(" "),r("b",[r("a",{staticStyle:{color:"initial"},attrs:{href:n.layers_url,target:"_blank"}},[n._v("Layers settings")])])])]):n._e()]):n._e()},e.staticRenderFns=[],e._scopeId="data-v-7828b5c0"},{"app/eventbus":46,"components/LayerOpacityPicker.vue":189,"components/Table.vue":235,"core/i18n/i18n.service":12,"services/application":298,"services/gui":302,"shp-write":"shp-write","store/catalog-layers":311,"utils/downloadFile":366,"vue-color":"vue-color","vueify/lib/insert-css":2}],137:[function(e,t,n){var r,i,a,o,s,l,u,c,d,p,f;e("vueify/lib/insert-css").insert(".layer-legend[data-v-fc3d03ea]{padding-left:36px}");function h(e){return e&&e.__esModule?e:{default:e}}function g(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),c=h(e("services/gui")),d=e("app/eventbus"),p=h(e("store/catalog-layers")),f=h(e("store/projects")),e=h(e("mixins/click")),n.default={name:"catalog-layer-legend",props:{legendplace:{type:String},layer:{type:Object}},data:function(){return{loading:!1,categories:[],currentstyle:this.layer.styles.find(function(e){return!0===e.current}).name}},mixins:[e.default],computed:{showfeaturecount:function(){return void 0!==this.layer.featurecount},externallegend:function(){return"wms"===this.layer.source.type},legend:function(){return this.layer.legend},show:function(){return this.layer.expanded&&this.layer.visible&&("toc"===this.legendplace||"tab"===this.legendplace&&this.layer.categories)}},methods:{onCategoryClick:function(){this.handleClick({1:function(){},2:function(){}},this)},showCategoryMenu:function(){this.$emit("showmenucategory")},getWmsSourceLayerLegendUrl:function(){return this.getProjectLayer().getLegendUrl({width:16,height:16})},getProjectLayer:function(){return p.default.getLayerById(this.layer.id)},isDisabled:function(e){return this.categories[e].disabled},showHideLayerCategory:function(e){this.categories[e].checked=!this.categories[e].checked,this.getProjectLayer().change(),"tab"===this.legendplace?this.layer.legend.change=!0:this.categories[e].checked&&this.mapReady&&this.setLayerCategories(!1)},setError:function(){this.legend.error=!0,this.legend.loading=!1},urlLoaded:(u=g(function*(){this.legend.loading=!1}),function(){return u.apply(this,arguments)}),onChangeLayerLegendStyle:(l=g(function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(this.loading=!0,!this.externallegend){try{void 0!==e.style&&e.layerId===this.layer.id&&(yield this.setLayerCategories(!0),yield this.getProjectLayer().getStyleFeatureCount(e.style),this.currentstyle=e.style,this.dynamic)&&(yield this.setLayerCategories(!1))}catch(e){}this.loading=!1}}),function(){return l.apply(this,arguments)}),setLayerCategories:(s=g(function*(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];try{var t,n,r=this.getProjectLayer(),i=r.getCategories();e&&i?this.categories=i:(n=void 0===(t=(yield r.getLegendGraphic({all:e})).nodes)?[]:t,e?this._setAllLayerCategories(n):this._updateLayerCategories(n,i))}catch(e){this.setError()}}),function(){return s.apply(this,arguments)}),_setAllLayerCategories:function(e){var t=this.getProjectLayer(),a=[];e.forEach(function(e){var t=e.icon,n=e.title,r=e.ruleKey,i=e.checked,e=e.symbols,e=void 0===e?[]:e;t?a.push({icon:t,title:n,ruleKey:r,checked:i,disabled:!1}):e.forEach(function(e){e._checked=e.checked,e.disabled=!1,a.push(e)})}),t.setCategories(a),this.categories=a},_updateLayerCategories:function(e,i){this.getProjectLayer().setCategories(i),this.categories=i,e.length?e.forEach(function(e){var t=e.icon,n=e.title,e=e.symbols,r=t?[{icon:t,title:n}]:void 0===e?[]:e;i.forEach(function(t){var e=r.find(function(e){return e.icon===t.icon&&e.title===t.title}),n=void 0===t.checked||t.checked;t.disabled=n&&void 0===e})}):i.forEach(function(e){return e.disabled=void 0===e.checked||e.checked})},onChangeMapLegendParams:(o=g(function*(){this.mapReady=!0,this.layer.visible&&!1===this.externallegend&&("toc"===this.legendplace||this.layer.categories)&&this.setLayerCategories(!1)}),function(){return o.apply(this,arguments)}),runInitLayerVisibleAction:(a=g(function*(){yield this.setLayerCategories(!0),this.dynamic&&(yield this.setLayerCategories(!1),c.default.getService("map").on("change-map-legend-params",this.onChangeMapLegendParams)),this.initialize=!0}),function(){return a.apply(this,arguments)})},watch:{"layer.visible":(i=g(function*(e){e=e&&!1===this.externallegend;e&&!1===this.initialize&&(yield this.runInitLayerVisibleAction()),e&&!1!==this.initialize&&(yield this.setLayerCategories(!this.dynamic))}),function(e){return i.apply(this,arguments)})},created:(r=g(function*(){this.initialize=!1,this.dynamic=f.default.getCurrentProject().getContextBaseLegend(),this.mapReady=!1,d.CatalogEventBus.$on("layer-change-style",this.onChangeLayerLegendStyle),!1===this.externallegend&&!0===this.layer.visible&&(yield this.runInitLayerVisibleAction())}),function(){return r.apply(this,arguments)}),beforeDestroy:function(){d.CatalogEventBus.$off("layer-change-style",this.onChangeLayerLegendStyle)}},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var n=this,e=n.$createElement,r=n._self._c||e;return n.show?r("div",{staticClass:"layer-legend",on:{click:function(e){e.stopPropagation(),e.preventDefault()}}},[n.legend?r("bar-loader",{attrs:{loading:n.legend.loading}}):n._e(),n._v(" "),n.externallegend?r("figure",[r("img",{attrs:{src:n.getWmsSourceLayerLegendUrl()}})]):r("figure",{directives:[{name:"disabled",rawName:"v-disabled",value:n.loading,expression:"loading"}]},[r("bar-loader",{attrs:{loading:n.loading}}),n._v(" "),n._l(n.categories,function(e,t){return r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.disabled,expression:"category.disabled"}],staticStyle:{display:"flex","align-items":"center",width:"100%"},on:{contextmenu:function(e){return e.preventDefault(),e.stopPropagation(),n.showCategoryMenu(e)}}},[e.ruleKey?r("span",{class:n.g3wtemplate.getFontClass(e.checked?"check":"uncheck"),staticStyle:{"padding-right":"3px"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),n.showHideLayerCategory(t)}}}):n._e(),n._v(" "),"toc"===n.legendplace?r("img",{attrs:{src:e.icon&&"data:image/png;base64,"+e.icon},on:{error:function(e){return n.setError()},load:function(e){return n.urlLoaded()}}}):n._e(),n._v(" "),"tab"===n.legendplace&&e.ruleKey||"toc"===n.legendplace?r("span",{staticClass:"g3w-long-text",staticStyle:{"padding-left":"3px"},on:{click:function(e){return e.stopPropagation(),n.onCategoryClick(e)}}},[r("span",[n._v(n._s(e.title))]),n._v(" "),n.showfeaturecount&&void 0!==e.ruleKey?r("span",{staticStyle:{"font-weight":"bold"}},[n._v("\n          ["+n._s(n.layer.stylesfeaturecount[n.currentstyle][e.ruleKey])+"]\n        ")]):n._e()]):n._e()])})],2)],1):n._e()},n.staticRenderFns=[],n._scopeId="data-v-fc3d03ea"},{"app/eventbus":46,"mixins/click":286,"services/gui":302,"store/catalog-layers":311,"store/projects":317,"vueify/lib/insert-css":2}],138:[function(e,t,n){var r,i,a,o;e("vueify/lib/insert-css").insert("#project-context-menu[data-v-5db8b798]{background:#fafafa;border:1px solid #bdbdbd;border-radius:3px;display:block;list-style:none;margin:0;padding:0;position:fixed;min-width:150px;z-index:999999;color:#000;outline:none}li .item-text[data-v-5db8b798]{font-weight:700}");function s(e){return e&&e.__esModule?e:{default:e}}function l(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),i=s(e("store/projects")),a=e("app/eventbus"),o=s(e("services/application")),n.default={name:"catalog-project-context-menu",props:{external:{type:Object}},data:function(){return{menu:{title:i.default.getCurrentProject().getName(),show:!1,top:0,left:0,layers:{show:!1,top:0,left:0}}}},computed:{edit_url:function(){return o.default.getCurrentProject().getState().edit_url}},methods:{_hideMenu:function(){this.menu.show=!1},closeLayerMenu:function(){this._hideMenu()},showAdminLayers:function(){},onShowProjectContextMenu:(r=l(function*(e){this._hideMenu(),yield this.$nextTick(),this.menu.left=e.x,this.menu.show=!0,yield this.$nextTick(),this.menu.top=$(e.target).offset().top-$(this.$refs["project-context-menu"]).height()+$(e.target).height()/2}),function(e){return r.apply(this,arguments)})},created:function(){a.CatalogEventBus.$on("show-project-context-menu",this.onShowProjectContextMenu),a.CatalogEventBus.$on("hide-project-context-menu",this._hideMenu)}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this,t=e.$createElement,t=e._self._c||t;return e.edit_url&&e.menu.show?t("ul",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.closeLayerMenu,expression:"closeLayerMenu"}],ref:"project-context-menu",staticClass:"catalog-context-menu",style:{top:e.menu.top+"px",left:e.menu.left+"px"},attrs:{id:"project-context-menu",tabindex:"-1"}},[t("li",{staticClass:"title"},[t("div",[e._v("G3W-ADMIN "+e._s(e.menu.title))])]),e._v(" "),t("li",[t("div",[t("span",{staticClass:"menu-icon skin-color-dark"},[t("svg",{staticStyle:{height:"14px","vertical-align":"-1.5px",fill:"currentColor"},attrs:{xmlns:"http://www.w3.org/2000/svg","xml:space":"preserve",viewBox:"0 0 32 32"}},[t("path",{attrs:{d:"m17.61 17.63 4.36-.02-4-3.98h-4.36v4l4 4.45z"}}),e._v(" "),t("path",{attrs:{d:"m31.61 27.22-7.62-7.6-4.38.01v4.33l7.24 7.67h4.76z"}}),e._v(" "),t("path",{attrs:{d:"M18 25.18c-.68.16-1.17.2-1.9.2a9.77 9.77 0 0 1-9.68-9.88c0-5.57 4.4-9.78 9.68-9.78s9.48 4.2 9.48 9.78c0 .91-.15 1.96-.36 2.8l4.88 4.65a15 15 0 0 0 1.95-7.48C32.05 6.87 25.19.44 16 .44 6.86.44 0 6.84 0 15.47c0 8.68 6.86 15.2 16 15.2 2.36 0 4.23-.3 6.2-1.1L18 25.18z"}})])]),e._v(" "),t("b",[t("a",{staticStyle:{color:"initial"},attrs:{href:e.edit_url,target:"_blank"}},[e._v("Project settings")])])])])]):e._e()},e.staticRenderFns=[],e._scopeId="data-v-5db8b798"},{"app/eventbus":46,"services/application":298,"store/projects":317,"vueify/lib/insert-css":2}],139:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}function a(t){t.nodes.forEach(function(e){void 0===e.id?a({nodes:e.nodes,visible:t.visible&&e.checked}):e.parentGroup.checked&&e.checked&&s.default.getLayerById(e.id).setVisible(t.visible)})}Object.defineProperty(n,"__esModule",{value:!0}),o=e("app/eventbus"),s=r(e("store/catalog-layers")),l=r(e("services/gui")),u=r(e("mixins/click")),c=r(e("components/CatalogLayerLegend.vue")),p=e("utils").downloadFile,n.default={name:"catalog-tristate-tree",props:["layerstree","storeid","legend","legendplace","highlightlayers","parent_mutually_exclusive","parentFolder","externallayers","root","parent"],components:{CatalogLayerLegend:c.default},mixins:[u.default],data:function(){return{expanded:this.layerstree.expanded,isGroupChecked:!0,controltoggled:!1,n_childs:null,filtered:!1}},computed:{showfeaturecount:function(){return void 0!==this.layerstree.featurecount},showLegendLayer:function(){return!this.layerstree.exclude_from_legend},showLayerTocLegend:function(){return!this.isGroup&&this.showLegendLayer&&this.layerstree.geolayer},isGroup:function(){return!!this.layerstree.nodes},legendlayerposition:function(){return this.showLegendLayer&&this.layerstree.legend?this.legendplace:"tab"},showscalevisibilityclass:function(){return!this.isGroup&&this.layerstree.scalebasedvisibility},showScaleVisibilityToolip:function(){return this.showscalevisibilityclass&&this.layerstree.disabled&&this.layerstree.checked},isTable:function(){return!this.isGroup&&!this.layerstree.geolayer&&!this.layerstree.external},isHidden:function(){return this.layerstree.hidden&&!0===this.layerstree.hidden},selected:function(){this.layerstree.selected=(!this.layerstree.disabled||!this.layerstree.selected)&&this.layerstree.selected},isHighLight:function(){return this._isHighLightProjectLayer||this._isHighLightExternalLayer},isInGrey:function(){return!this.isGroup&&!this.isTable&&!this.layerstree.external&&(!this.layerstree.visible||this.layerstree.disabled)},getFeatureCount:function(){return Object.values(this.layerstree.featurecount).reduce(function(e,t){return e+ +t},0)},_isHighLightProjectLayer:function(){return this.highlightlayers&&!this.isGroup&&s.default.getLayerById(this.layerstree.id).getTocHighlightable()&&this.layerstree.visible},_isHighLightExternalLayer:function(){return this.layerstree.external&&this.layerstree.visible&&this.layerstree._type&&!0===this.layerstree.tochighlightable}},watch:{"layerstree.checked":function(){this.isGroup?this.handleGroupChecked(this.layerstree):this.handleLayerChecked(this.layerstree)}},methods:{removeCurrentFilter:function(){return s.default.getLayerById(this.layerstree.id).deleteFilterToken()},handleGroupChecked:function(t){if(t.checked)for(var n=!t.parentGroup||t.parentGroup.checked,e=t.parentGroup&&t.parentGroup.mutually_exclusive,r=(e||a({nodes:t.nodes,visible:n}),e&&t.parentGroup.nodes.forEach(function(e){e.checked=e.groupId===t.groupId,e.checked&&a({nodes:e.nodes,visible:n})}),t.parentGroup);r;)r.checked=r.root||r.checked,r=r.parentGroup;else t.nodes.forEach(function(e){void 0===e.id?a({nodes:e.nodes,visible:!1}):e.checked&&s.default.getLayerById(e.id).setVisible(!1)})},handleLayerChecked:function(t){if(t.projectLayer){for(var e=s.default.getLayerById(t.id),n=t.checked,r=(e.setVisible(!!n&&!t.disabled),n&&t.parentGroup.mutually_exclusive&&t.parentGroup.nodes.forEach(function(e){return e.checked=e.id===t.id}),t.parentGroup);n&&r;)r.checked=!0,r=r.parentGroup;o.CatalogEventBus.$emit("treenodevisible",e)}else t.visible=t.checked,l.default.getService("map").changeLayerVisibility({id:t.id,visible:t.checked})},saveFilter:function(e){s.default.getLayerById(e.id).saveFilter()},toggleFilterLayer:function(){o.CatalogEventBus.$emit("activefiltertokenlayer",this.storeid,this.layerstree)},clearSelection:function(){o.CatalogEventBus.$emit("unselectionlayer",this.storeid,this.layerstree)},toggle:function(){this.layerstree.checked=!this.layerstree.checked},expandCollapse:function(){this.layerstree.expanded=!this.layerstree.expanded},select:function(){void 0!==this.layerstree.selected&&(this.layerstree.external&&!1===this.layerstree.projectLayer?o.CatalogEventBus.$emit("treenodeexternalselected",this.layerstree):this.isGroup||this.isTable||o.CatalogEventBus.$emit("treenodeselected",this.storeid,this.layerstree))},maybeZoomToLayer:function(e){this.canZoom(this.layerstree)&&l.default.getService("map").goToBBox([e.bbox.minx,e.bbox.miny,e.bbox.maxx,e.bbox.maxy],e.epsg)},canZoom:function(e){return e.bbox&&[e.bbox.minx,e.bbox.miny,e.bbox.maxx,e.bbox.maxy].find(function(e){return 0<e})},onTreeItemClick:function(){var e=this;this.handleClick({1:function(){return!e.isTable&&!e.isGroup&&e.select()},2:function(){return!e.isTable&&e.maybeZoomToLayer(e.layerstree)}},this)},triClass:function(){return this.g3wtemplate.getFontClass(this.layerstree.checked?"check":"uncheck")},downloadExternalLayer:function(e){e.file?p(e.file):e.url},removeExternalLayer:function(e,t){l.default.getService("map").removeExternalLayer(e,wms)},showContextMenu:function(e){!this.isGroup&&(this.layerstree.openattributetable||this.layerstree.downloadable||this.layerstree.geolayer||this.layerstree.external)?(o.CatalogEventBus.$emit("hide-project-context-menu"),o.CatalogEventBus.$emit("show-layer-context-menu",this.layerstree,e)):this.isGroup&&!0===this.layerstree.root&&(o.CatalogEventBus.$emit("hide-layer-context-menu"),o.CatalogEventBus.$emit("show-project-context-menu",e))}},created:function(){this.isGroup&&!this.layerstree.checked&&this.handleGroupChecked(this.layerstree),this.isGroup&&!this.root&&this.parent_mutually_exclusive&&!this.layerstree.mutually_exclusive&&this.layerstree.nodes.forEach(function(e){e.id&&(e.uncheckable=!0)})},mounted:(d=i(function*(){yield this.$nextTick(),$("span.scalevisibility").tooltip()}),function(){return d.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default);var o,s,l,u,c,d,p,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.isGroup||!t.layerstree.projectLayer||t.layerstree.toc?n("li",{staticClass:"tree-item",class:{selected:(!t.isGroup||!t.isTable)&&t.layerstree.selected,itemmarginbottom:!t.isGroup,disabled:t.isInGrey,group:t.isGroup},style:{marginLeft:t.isGroup?"0":"5px"},on:{contextmenu:function(e){return e.preventDefault(),e.stopPropagation(),t.showContextMenu(e)},click:function(e){return e.stopPropagation(),t.onTreeItemClick(e)}}},[t.isGroup?n("span",{staticClass:"root collapse-expande-collapse-icon",class:[{bold:t.isGroup},t.g3wtemplate.getFontClass(t.layerstree.expanded?"caret-down":"caret-right")],staticStyle:{"padding-right":"2px"},on:{click:function(e){return e.stopPropagation(),t.expandCollapse(e)}}}):t._e(),t._v(" "),t.isGroup?n("span",{class:[t.triClass()],staticStyle:{color:"#ffffff"},on:{click:function(e){return e.stopPropagation(),t.toggle()}}}):t.isTable?n("span",{directives:[{name:"show",rawName:"v-show",value:!t.layerstree.hidden,expression:"!layerstree.hidden"}],class:[t.parentFolder?"child":"root",t.g3wtemplate.getFontClass("table")],staticStyle:{"padding-left":"18px"}}):[t.layerstree.external&&t.layerstree.removable?n("span",{class:t.g3wtemplate.getFontClass("trash"),staticStyle:{color:"red","padding-left":"1px"},on:{click:function(e){return e.stopPropagation(),t.removeExternalLayer(t.layerstree.name,t.layerstree._type)}}}):t._e(),t._v(" "),t.layerstree.external&&t.layerstree.download?n("span",{class:t.g3wtemplate.getFontClass("download"),staticStyle:{color:"#ffffff","margin-left":"5px"},on:{click:function(e){return t.downloadExternalLayer(t.layerstree.download)}}}):t._e(),t._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:!t.layerstree.hidden,expression:"!layerstree.hidden"}],staticClass:"checkbox-layer",class:t.parentFolder?"child":"root"},["toc"===t.legendlayerposition||!t.isGroup&&t.layerstree.categories?n("span",{staticClass:"collapse-expande-collapse-icon",class:t.g3wtemplate.getFontClass(t.layerstree.visible&&t.layerstree.expanded?"caret-down":"caret-right"),on:{click:function(e){return e.target!==e.currentTarget?null:(e.stopPropagation(),t.expandCollapse(e))}}}):t._e(),t._v(" "),n("span",{class:[t.g3wtemplate.getFontClass(t.layerstree.checked?"check":"uncheck"),{"toc-added-external-layer":!t.layerstree.legend&&t.layerstree.external}],style:{paddingLeft:"toc"===t.legendlayerposition||!t.isGroup&&t.layerstree.categories?"5px":!t.layerstree.legend&&t.layerstree.external?"1px":"18px"},on:{click:function(e){return e.stopPropagation(),t.toggle()}}})])],t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.layerstree.hidden||t.isGroup,expression:"!layerstree.hidden || isGroup"}],staticClass:"tree-node-title",class:{disabled:!t.layerstree.external&&(t.layerstree.disabled||t.layerstree.id&&!t.layerstree.visible),bold:t.isGroup}},[n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip.text",value:t.showScaleVisibilityToolip?"minscale:"+t.layerstree.minscale+" - maxscale:"+t.layerstree.maxscale:"",expression:"showScaleVisibilityToolip ? `minscale:${layerstree.minscale} - maxscale:${layerstree.maxscale}` : ''",modifiers:{text:!0}}],staticClass:"skin-tooltip-top g3w-long-text",class:{highlightlayer:t.isHighLight,scalevisibility:t.showscalevisibilityclass},attrs:{"data-placement":"top","current-tooltip":t.showScaleVisibilityToolip?"minscale:"+t.layerstree.minscale+" - maxscale: "+t.layerstree.maxscale:""}},[t.isGroup||t.layerstree.external||null===t.layerstree.filter.current?t._e():n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top.create.text",value:t.layerstree.filter.current.name,expression:"layerstree.filter.current.name",arg:"top",modifiers:{create:!0,text:!0}}],staticStyle:{cursor:"pointer"},attrs:{"current-tooltip":t.layerstree.filter.current.name},on:{click:function(e){return e.stopPropagation(),t.removeCurrentFilter(e)}}},[n("span",{class:t.g3wtemplate.getFontClass("filter"),staticStyle:{color:"red"}})]),t._v(" "),n("span",[t._v(t._s(t.layerstree.title))]),t._v(" "),!t.isGroup&&t.showfeaturecount?n("span",{staticStyle:{"font-weight":"bold"}},[t._v("\n        ["+t._s(t.getFeatureCount)+"]\n      ")]):t._e()]),t._v(" "),!t.isGroup&&t.layerstree.selection?n("div",[t.layerstree.selection.active?n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"layer_selection_filter.tools.clear",expression:"'layer_selection_filter.tools.clear'",modifiers:{create:!0}}],staticClass:"action-button skin-tooltip-left selection-filter-icon",class:t.g3wtemplate.getFontClass("clear"),attrs:{"data-placement":"left","data-toggle":"tooltip","data-container":"body"},on:{click:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"caputure",void 0,e.key,void 0)?null:(e.preventDefault(),e.stopPropagation(),t.clearSelection(e))}}}):t._e(),t._v(" "),t.layerstree.external||!t.layerstree.selection.active&&!t.layerstree.filter.active?t._e():n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"layer_selection_filter.tools.filter",expression:"'layer_selection_filter.tools.filter'",modifiers:{create:!0}}],staticClass:"action-button skin-tooltip-left selection-filter-icon",class:[t.g3wtemplate.getFontClass("filter"),t.layerstree.filter.active?"active":""],attrs:{"data-placement":"left","data-toggle":"tooltip","data-container":"body"},on:{click:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"caputure",void 0,e.key,void 0)?null:(e.preventDefault(),e.stopPropagation(),t.toggleFilterLayer(e))}}}),t._v(" "),!t.layerstree.external&&t.layerstree.selection.active&&t.layerstree.filter.active?n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"layer_selection_filter.tools.savefilter",expression:"'layer_selection_filter.tools.savefilter'",modifiers:{create:!0}}],staticClass:"action-button skin-tooltip-left selection-filter-icon",class:t.g3wtemplate.getFontClass("save"),attrs:{"data-placement":"left","data-toggle":"tooltip"},on:{click:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"caputure",void 0,e.key,void 0)?null:(e.preventDefault(),e.stopPropagation(),t.saveFilter(t.layerstree))}}}):t._e()]):t._e()]),t._v(" "),t.showLayerTocLegend?n("catalog-layer-legend",{attrs:{legendplace:t.legendplace,layer:t.layerstree}}):t._e(),t._v(" "),t.isGroup?n("ul",{directives:[{name:"show",rawName:"v-show",value:t.layerstree.expanded,expression:"layerstree.expanded"}],staticClass:"tree-content-items group",class:["g3w-lendplace-"+t.legendplace]},t._l(t.layerstree.nodes,function(e){return n("span",{key:e.id||e.groupId},[n("catalog-tristate-tree",{attrs:{root:!1,legendConfig:t.legend,legendplace:t.legendplace,highlightlayers:t.highlightlayers,parentFolder:t.isGroup,layerstree:e,storeid:t.storeid,parent:t.layerstree,parent_mutually_exclusive:!!t.layerstree.mutually_exclusive}})],1)}),0):t._e()],2):t._e()},e.staticRenderFns=[]},{"app/eventbus":46,"components/CatalogLayerLegend.vue":137,"mixins/click":286,"services/gui":302,"store/catalog-layers":311,utils:404}],140:[function(e,t,n){var r,i,a,o,s,l,u,c,d,p,f,h,g,v,m,y,_;e("vueify/lib/insert-css").insert("#g3w-change-map-menu[data-v-9eb2df56]{width:100%;position:relative}.g3w-change-map-menu-container[data-v-9eb2df56]{height:100%;display:grid;grid-template-columns:repeat(auto-fill,minmax(30%,1fr));grid-gap:1em;overflow-y:auto}.menu-item[data-v-9eb2df56]{margin-bottom:20px;margin-top:20px}.menu-item-image[data-v-9eb2df56]{cursor:pointer;position:relative;overflow:hidden;padding-bottom:50%;opacity:.7}.menu-item-image[data-v-9eb2df56]:hover{opacity:1}.menu-item-image img[data-v-9eb2df56]{position:absolute;top:0;bottom:0;left:0;right:0;margin:auto}.menu-item-content[data-v-9eb2df56]{padding:15px;background:hsla(0,0%,100%,.3)}.menu-item-text[data-v-9eb2df56]{position:relative;overflow:hidden;height:100%;text-align:justify}.menu-item-title[data-v-9eb2df56]{text-align:center;font-weight:700;background:hsla(0,0%,100%,.5);padding:5px}");function b(e){return e&&e.__esModule?e:{default:e}}function w(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function x(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=x(function*(e){return o[e]=o[e]||(yield _.get({url:encodeURI("/"+l.default.getApplicationUser().i18n+c.API_BASE_URLS.ABOUT.group+e+"/")})),o[e]}),o=function(e){return r.apply(this,arguments)},i=x(function*(e){return s[e]=s[e]||(yield _.get({url:encodeURI("/"+l.default.getApplicationUser().i18n+c.API_BASE_URLS.ABOUT.projects.replace("__G3W_GROUP_ID__",e))})),s[e]}),s=function(e){return i.apply(this,arguments)},l=b(e("services/application")),u=b(e("store/projects")),c=e("app/constant"),y=e("g3w-ol/projection/projections"),_=e("utils").XHR,n.default={name:"change-map-menu",data:function(){return{state:null,loading:!1,current:"projects",items:[],parent:null,steps:[],curr_group:null}},methods:{back:(m=x(function*(){var e=this.steps.pop(),t=0<this.steps.length,n=t&&this.steps[this.steps.length-1];return t&&void 0!==n.macrogroup_id||!t&&void 0===e&&Array.isArray(this.parent.macrogroup_id)&&0<this.parent.macrogroup_id.length?(e=(t?n:this.parent).macrogroup_id,this.showMacroGroups(e,!t)):t&&void 0===n.macrogroup_id?this.showGroups(n,!1):t?void 0:this.showRoot()}),function(){return m.apply(this,arguments)}),showMacroGroups:(v=x(function*(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if(1===t.length)return this.parent=this.macrogroups.find(function(e){return e.id===t[0]}),yield this.showGroups(this.parent);this.items=this.macrogroups.filter(function(e){return t.includes(e.id)}),this.current="macrogroups",this.parent={macrogroup_id:t,title:null,name:null},e&&this.steps.push(this.parent)}),function(){return v.apply(this,arguments)}),showGroups:(g=x(function*(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];try{this.loading=!0,this.parent=e,this.items=yield o(e.id),this.current="groups"}catch(e){this.items=[]}finally{t&&this.steps.push(this.parent),this.loading=!1}}),function(e){return g.apply(this,arguments)}),showProjects:(h=x(function*(e){var t=this;try{this.loading=!0,this.parent=e,this.items=this.parent.id===this.curr_group?u.default.getListableProjects():yield s(e.id,function(e){return t.setItemImageSrc({item:e,type:"project"})}),this.current="projects"}catch(e){this.items=[]}finally{this.steps.push(this.parent),this.loading=!1}}),function(e){return h.apply(this,arguments)}),showRoot:function(){this.current="root",this.items=[].concat(w(this.macrogroups),w(this.groups)),this.steps=[]},changeMapProject:(f=x(function*(t){var n=void 0,r=u.default.getBaseUrl(),e=this.parent.srid?"EPSG:"+this.parent.srid:this.parent.crs.epsg;yield y.registerProjection(e);try{new URL(r),n=""+r+(t.url||t.map_url.replace(/^\//,""))}catch(e){n=""+location.origin+r+(t.url||t.map_url.replace(/^\//,""))}return l.default.changeMapProject({url:n,epsg:e})}),function(e){return f.apply(this,arguments)}),trigger:(p=x(function*(e){switch(this.current){case"root":return void 0===e.srid?this.showGroups(e):this.showProjects(e);case"macrogroups":return this.showGroups(e);case"groups":return yield this.showProjects(e);case"projects":return yield this.changeMapProject(e)}}),function(e){return p.apply(this,arguments)}),setItemImageSrc:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.item;switch(e.type){case"project":t.thumbnail=this._setSrc(t.thumbnail);break;case"group":t.header_logo_img=this._setSrc(t.header_logo_img);break;case"macrogroup":t.logo_img=this._setSrc(t.logo_img);break;case"net_error":t.thumbnail||t.logo_img?t.thumbnail=""+l.default.getConfig().urls.clienturl+c.LOGO_GIS3W:t.header_logo_img&&(t.header_logo_img=""+l.default.getConfig().urls.clienturl+c.LOGO_GIS3W)}},_setSrc:function(e){var t=this.$options.host||"",n=u.default.config.mediaurl,r=l.default.getConfig().urls.clienturl,i=e&&-1!==e.indexOf(n),a=e&&-1===e.indexOf("static")&&-1===e.indexOf("media");return""+t+(e?i?e:a?""+n+e:""+r+c.LOGO_GIS3W:""+r+c.LOGO_GIS3W)}},created:(d=x(function*(){var n=this,e=l.default.getConfig();this.items=u.default.getListableProjects(),this.parent=u.default.getCurrentProjectGroup(),this.curr_group=this.parent.id,this.macrogroups=e.macrogroups,this.groups=e.groups,Object.entries({project:this.items,magrocroup:this.macrogroups,group:this.groups}).forEach(function(e){var e=a(e,2),t=e[0];return e[1].forEach(function(e){return n.setItemImageSrc({item:e,type:t})})})}),function(){return d.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{attrs:{id:"g3w-change-map-menu"}},["root"!==this.current?[r("div",{staticClass:"skin-background-color",staticStyle:{display:"flex","align-items":"center",color:"#ffffff"}},[r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:bottom.create",value:"change_session",expression:"'change_session'",arg:"bottom",modifiers:{create:!0}},{name:"disabled",rawName:"v-disabled",value:n.loading,expression:"loading"}],staticStyle:{"font-size":"2em",margin:"5px",cursor:"pointer",padding:"3px",border:"2px solid #ffffff","border-radius":"3px"},on:{click:function(e){return e.stopPropagation(),n.back(e)}}},[r("i",{class:n.g3wtemplate.getFontClass("reply"),staticStyle:{color:"#FFFFFF"}})]),n._v(" "),n.parent?r("div",{staticStyle:{margin:"auto"}},[r("h3",{staticStyle:{"font-weight":"bold"}},[n._v("\n          "+n._s(n.parent.title||n.parent.name)+"\n        ")])]):n._e()])]:n._e(),n._v(" "),n.items.length?r("div",{staticClass:"g3w-change-map-menu-container"},n._l(n.items,function(t){return r("div",{key:t.name,staticClass:"menu-item"},[r("div",{staticClass:"menu-item-image",on:{click:function(e){return e.stopPropagation(),n.trigger(t)}}},[r("img",{staticClass:"img-responsive",attrs:{src:t.thumbnail||t.header_logo_img||t.logo_img,alt:"logo"},on:{error:function(e){return n.setItemImageSrc({item:t,type:"net_error"})}}})]),n._v(" "),r("div",{staticClass:"menu-item-content"},[r("div",{staticClass:"menu-item-text"},[r("h4",{staticClass:"menu-item-title"},[n._v("\n            "+n._s(t.title)+"\n          ")]),n._v(" "),r("div",{domProps:{innerHTML:n._s(t.description)}})])])])}),0):[r("h3",{directives:[{name:"t",rawName:"v-t",value:" no_other_"+n.current,expression:"` no_other_${current}`"}],staticStyle:{"font-weight":"bold"}})]],2)},e.staticRenderFns=[],e._scopeId="data-v-9eb2df56"},{"app/constant":5,"g3w-ol/projection/projections":76,"services/application":298,"store/projects":317,utils:404,"vueify/lib/insert-css":2}],141:[function(e,t,n){e("vueify/lib/insert-css").insert(".field[data-v-6783d4c4]{background-color:transparent!important;padding-top:3px;padding-bottom:3px;display:flex;align-items:center}.value[data-v-6783d4c4]{position:relative}.field div[data-v-6783d4c4]{padding-left:3px;padding-right:3px}.field_value[data-v-6783d4c4]{padding-left:0!important}");Object.defineProperty(n,"__esModule",{value:!0}),n.default={name:"field",props:["state"]},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("div",{staticClass:"field",style:{fontSize:e.isMobile()&&"0.8em"}},[e.state.label?t("div",{staticClass:"col-sm-6  field_label"},[e._t("label",[e._v(e._s(e.state.label))])],2):e._e(),e._v(" "),t("div",{staticClass:"field_value",class:[e.state.label?"col-sm-6":null]},[e._t("field",[t("span",{staticStyle:{"word-wrap":"break-word"},domProps:{innerHTML:e._s(e.state.value)}})])],2)])},e.staticRenderFns=[],e._scopeId="data-v-6783d4c4"},{"vueify/lib/insert-css":2}],142:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=e("gui/fields/fieldsservice"),e=e("gui/fields/fields"),n.default={name:"g3w-field",props:{state:{required:!0},feature:{type:Object}},components:r({},e),created:function(){this.type=i.getType(this.state)}},t.exports.__esModule&&(t.exports=t.exports.default);var r,i,n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this.$createElement;return(this._self._c||e)(this.type,{tag:"component",attrs:{feature:this.feature,state:this.state}})},n.staticRenderFns=[],n._scopeId="data-v-46843712"},{"gui/fields/fields":80,"gui/fields/fieldsservice":81}],143:[function(e,t,n){e("vueify/lib/insert-css").insert(".show-hide-geo[data-v-3362679d]{color:#3c8dbc;cursor:pointer;font-size:1.2em}");Object.defineProperty(n,"__esModule",{value:!0}),e=e("mixins"),n.default={name:"g3w-geospatial",props:{data:{}},mixins:[e.geoMixin],data:function(){return{layerId:"table_layer_"+Date.now(),visible:!1,id:"geo_table_"+Date.now()}}},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",{staticClass:"geo-content"},[e("span",{staticClass:"show-hide-geo",class:[t.visible?t.g3wtemplate.font["eye-close"]:t.g3wtemplate.font.eye],on:{click:function(e){return e.stopPropagation(),t.showLayer()}}})])},n.staticRenderFns=[],n._scopeId="data-v-3362679d"},{mixins:290,"vueify/lib/insert-css":2}],144:[function(e,t,n){e("vueify/lib/insert-css").insert(".img-responsive[data-v-70d2a0b2]{cursor:pointer}");Object.defineProperty(n,"__esModule",{value:!0}),r=(r=r=e("components/Field.vue"))&&r.__esModule?r:{default:r},i=e("utils").toRawType,n.default={name:"field-image",props:["state"],data:function(){return{galleryId:"gallery_"+Date.now(),active:null,value:(void 0!==this.state.value.mime_type?this.state.value:this.state).value}},components:{Field:r.default},computed:{values:function(){return Array.isArray(this.value)?this.value:[this.value]}},methods:{getSrc:function(e){return"Object"===i(e)?e.photo:e},showGallery:function(e){this.active=e,"Object"===i(this.value)&&(this.value.active=!0),$("#"+this.galleryId).modal("show")},getGalleryImages:function(){var t=this;return this.values.map(function(e){return{src:t.getSrc(e)}})}}},t.exports.__esModule&&(t.exports=t.exports.default);var r,i,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("field",{attrs:{state:n.state}},[r("div",{staticStyle:{"text-align":"left"},attrs:{slot:"field"},slot:"field"},[n._l(n.values,function(e,t){return r("img",{staticClass:"img-responsive",staticStyle:{"max-height":"50px"},attrs:{src:n.getSrc(e)},on:{click:function(e){return n.showGallery(t)}}})}),n._v(" "),r("g3w-images-gallery",{attrs:{id:n.galleryId,active:n.active,images:n.getGalleryImages()}})],2)])},e.staticRenderFns=[],e._scopeId="data-v-70d2a0b2"},{"components/Field.vue":141,utils:404,"vueify/lib/insert-css":2}],145:[function(e,t,n){e("vueify/lib/insert-css").insert(".field_link[data-v-156f65de]{max-width:100%}");Object.defineProperty(n,"__esModule",{value:!0}),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e=(e=e=e("components/Field.vue"))&&e.__esModule?e:{default:e},n.default={name:"field-link",props:["state"],data:function(){return{value:null}},components:{Field:e.default},methods:{openLink:function(e){window.open(e,"_blank")}},created:function(){this.value=(this.state.value&&"object"===r(this.state.value)?this.state.value:this.state).value}},t.exports.__esModule&&(t.exports=t.exports.default);var r,n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("field",{attrs:{state:t.state}},[e("button",{directives:[{name:"t",rawName:"v-t",value:"info.link_button",expression:"'info.link_button'"}],staticClass:"btn skin-button field_link",attrs:{slot:"field"},on:{click:function(e){return t.openLink(t.value)}},slot:"field"})])},n.staticRenderFns=[],n._scopeId="data-v-156f65de"},{"components/Field.vue":141,"vueify/lib/insert-css":2}],146:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),e=e("mixins"),n.default={name:"g3w-media",mixins:[e.mediaMixin],props:["state"],computed:{type:function(){return this.getMediaType(this.state.mime_type).type},value:function(){return this.state.value}}},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,t=e._self._c||t;return e.value?t("div",{staticClass:"preview"},[t("a",{attrs:{href:e.value,target:"_blank"}},[t("div",{staticClass:"previewtype",class:e.type},[t("i",{staticClass:"fa-2x",class:e.g3wtemplate.font[e.type]})])]),e._v(" "),t("div",{staticClass:"filename"},[e._v(e._s(e.filename))]),e._v(" "),e._t("default")],2):e._e()},n.staticRenderFns=[],n._scopeId="data-v-7b8309b0"},{mixins:290}],147:[function(e,t,n){e("vueify/lib/insert-css").insert(".field_text_table[data-v-db21acde]{background-color:transparent!important}.field_text_table .field_label[data-v-db21acde]{font-weight:700}");Object.defineProperty(n,"__esModule",{value:!0}),e=(e=e=e("components/Field.vue"))&&e.__esModule?e:{default:e},n.default={name:"field-text",props:["state"],components:{Field:e.default},created:function(){}},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this.$createElement;return(this._self._c||e)("field",{attrs:{state:this.state}})},n.staticRenderFns=[],n._scopeId="data-v-db21acde"},{"components/Field.vue":141,"vueify/lib/insert-css":2}],148:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),e=(e=e=e("components/Field.vue"))&&e.__esModule?e:{default:e},n.default={name:"vuefield",props:{feature:{type:Object},state:{type:Object,default:{value:null,vueoptions:{component:{}}}}},components:{Field:e.default}},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this.$createElement,e=this._self._c||e;return e("field",{attrs:{state:this.state}},[e("div",{attrs:{slot:"field"},slot:"field"},[e(this.state.vueoptions.component,{tag:"component",attrs:{feature:this.feature,value:this.state.value}})],1)])},n.staticRenderFns=[],n._scopeId="data-v-67a07f52"},{"components/Field.vue":141}],149:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),e=e("services/floatbar"),r=(e=e)&&e.__esModule?e:{default:e},n.default={name:"Floatbar",data:function(){return{stack:r.default.stack.state}},computed:{panelsinstack:function(){return 0<this.stack.contentsdata.length},panelname:function(){var e=void 0;return e=this.stack.contentsdata.length?this.stack.contentsdata.slice(-1)[0].content.getTitle():e},closable:function(){return r.default.closable}},watch:{"stack.contentsdata":function(){var n=$("#g3w-floatbarpanel-placeholder").children();n.forEach(function(e,t){t==n.length-1?$(e).show():$(e).hide()})}},methods:{closePanel:function(){r.default.closePanel()}}},t.exports.__esModule&&(t.exports=t.exports.default);var r,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("aside",{staticClass:"control-sidebar control-sidebar-light"},[t("a",{directives:[{name:"show",rawName:"v-show",value:e.panelsinstack,expression:"panelsinstack"}],staticClass:"floatbar-aside-toggle",attrs:{href:"#","data-toggle":"control-sidebar",role:"button"}},[t("span",{staticClass:"sr-only"},[e._v("Expand")])]),e._v(" "),t("div",{staticStyle:{position:"absolute"},attrs:{id:"floatbar-spinner"}}),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.panelsinstack,expression:"panelsinstack"}],staticClass:"g3w-sidebarpanel"},[e.closable?t("div",{staticClass:"row"},[t("div",{staticClass:"col-xs-12 col-sm-12 col-md-12"},[t("button",{staticClass:"pull-right close-panel-button",class:e.g3wtemplate.getFontClass("close"),on:{click:e.closePanel}})])]):e._e(),e._v(" "),e.panelname?t("div",[t("h4",{staticClass:"g3w-floatbarpanel-name"},[e._v(e._s(e.panelname))])]):e._e(),e._v(" "),t("div",{staticClass:"g3w-floatbarpanel-placeholder",attrs:{id:"g3w-floatbarpanel-placeholder"}})])])},e.staticRenderFns=[],e._scopeId="data-v-29b017dd"},{"services/floatbar":301}],150:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),o=r(e("components/FormHeader.vue")),e=r(e("components/FormFooter.vue")),n.default={name:"g3w-form",data:function(){return{state:{},switchcomponent:!1,body:{components:{before:[],after:[]}}}},components:{g3wformheader:o.default,G3wFormFooter:e.default},transitions:{addremovetransition:"showhide"},methods:{isRootComponent:function(e){return this.$options.service.isRootComponent(e)},backToRoot:function(){this.$options.service.setRootComponent()},handleRelation:function(e){this.$options.service.handleRelation(e)},disableComponent:function(e){var t=e.id,e=e.disabled;this.$options.service.disableComponent({id:t,disabled:void 0!==e&&e})},resizeForm:function(e){this.$options.service.setCurrentFormPercentage(e)},switchComponent:function(e){this.switchcomponent=!0,this.$options.service.setCurrentComponentById(e)},changeInput:function(e){return this.$options.service.changeInput(e)},addToValidate:function(e){this.$options.service.addToValidate(e)},removeToValidate:function(e){this.$options.service.removeToValidate(e)},reloadLayout:function(){var e,t,n=$(this.$el).height();n&&(t=$(this.$refs.g3w_form_footer.$el),e=$(this.$refs.g3wform_body),t=t.height()?t.height()+50:50,n=n-($(this.$refs.g3wformheader.$el).height()+t),e.height(n))}},updated:(a=i(function*(){var e=this;yield this.$nextTick(),this.switchcomponent&&setTimeout(function(){return e.switchcomponent=!1},0)}),function(){return a.apply(this,arguments)}),created:function(){var n=this;this.$options.service.getEventBus().$on("set-main-component",function(){n.switchComponent(0)}),this.$options.service.getEventBus().$on("component-validation",function(e){var t=e.id,e=e.valid;n.$options.service.setValidComponent({id:t,valid:e})}),this.$options.service.getEventBus().$on("addtovalidate",this.addToValidate),this.$options.service.getEventBus().$on("disable-component",this.disableComponent)},mounted:function(){this.$options.service.isValid(),this.$options.service.setReady(!0)},beforeDestroy:function(){this.$options.service.clearAll()}},t.exports.__esModule&&(t.exports=t.exports.default);var a,o,n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"g3wform_content",staticStyle:{position:"relative"}},[n("bar-loader",{attrs:{loading:t.state.loading}}),t._v(" "),n("g3wformheader",{ref:"g3wformheader",attrs:{currentid:t.state.currentheaderid,headers:t.state.headers,update:t.state.update,valid:t.state.valid},on:{"resize-form":t.resizeForm,clickheader:t.switchComponent}}),t._v(" "),n("div",{ref:"g3wform_body",staticClass:"g3wform_body"},[t._l(t.body.components.before,function(e){return n(e,{tag:"component",attrs:{fields:t.state.fields}})}),t._v(" "),n("keep-alive",[n(t.state.component,{tag:"component",attrs:{handleRelation:t.handleRelation,state:t.state},on:{"hook:activated":t.reloadLayout,addtovalidate:t.addToValidate,removetovalidate:t.removeToValidate,changeinput:t.changeInput}})],1),t._v(" "),t._l(t.body.components.after,function(e){return n(e,{tag:"component",attrs:{fields:t.state.fields}})})],2),t._v(" "),n("g3w-form-footer",{ref:"g3w_form_footer",attrs:{isRootComponent:t.isRootComponent,backToRoot:t.backToRoot,state:t.state}})],1)},n.staticRenderFns=[]},{"components/FormFooter.vue":152,"components/FormHeader.vue":153}],151:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),e=(e=e=e("components/InputG3WFormInputs.vue"))&&e.__esModule?e:{default:e},n.default=Vue.extend({name:"form-body",props:["state","handleRelation"],data:function(){return{show:!0}},components:{G3wFormInputs:e.default},methods:{addToValidate:function(e){this.$emit("addtovalidate",e)},removeToValidate:function(e){this.$emit("removetovalidate",e)},changeInput:function(e){this.$emit("changeinput",e)}},computed:{hasFormStructure:function(){return!!this.state.formstructure}}}),t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("div",[t("form",{staticClass:"form-horizontal g3w-form"},[t("div",{staticClass:"box-primary"},[t("div",{staticClass:"box-body"},[e.hasFormStructure?[t("tabs",{attrs:{layerid:e.state.layerid,feature:e.state.feature,handleRelation:e.handleRelation,contenttype:"editing",addToValidate:e.addToValidate,changeInput:e.changeInput,removeToValidate:e.removeToValidate,tabs:e.state.formstructure,fields:e.state.fields}})]:[t("g3w-form-inputs",{attrs:{state:e.state,addToValidate:e.addToValidate,removeToValidate:e.removeToValidate,changeInput:e.changeInput},on:{changeinput:e.changeInput,addinput:e.addToValidate,removeinput:e.removeToValidate}})]],2)])])])},n.staticRenderFns=[]},{"components/InputG3WFormInputs.vue":176}],152:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},n.default=Vue.extend({name:"form-footer",props:{state:{type:Object},backToRoot:{type:Function,default:function(){}},isRootComponent:{type:Function}},data:function(){return this.originalbuttons=this.state.buttons.map(function(e){return i({},e)}),{id:"footer",active:!0,show:!0}},computed:{enableSave:function(){return this.state.valid&&this.state.update}},methods:{exec:function(e){e instanceof Function?e(this.state.fields):function(){this.state.fields}()},btnEnabled:function(e){var t=e.enabled,e=e.type;return(void 0===t||t)&&("save"!==e||"save"===e&&this.enableSave)},isValid:function(){return this.state.valid}},watch:{"state.component":function(e){this.show=this.isRootComponent(e)},"state.update":{immediate:!0,handler:function(n){var r=this;this.state.buttons.find(function(e,t){e.eventButtons&&e.eventButtons.update&&(e.eventButtons.update[n]?r.state.buttons.splice(t,1,i({},e,e.eventButtons.update[n])):r.state.buttons.splice(t,1,r.originalbuttons[t]))})}}},activated:function(){this.active=!0},deactivated:function(){this.active=!1}}),t.exports.__esModule&&(t.exports=t.exports.default);var i,n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"form-group g3wform_footer"},[n.show?[n._t("default",[r("div",{staticStyle:{margin:"3px","font-weight":"bold"}},[n._v("\n        * "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.form.footer.required_fields",expression:"'sdk.form.footer.required_fields'"}]}),n._v(" "),n.state.footer.message?r("div",{style:[n.state.footer.style]},[n._v("\n          "+n._s(n.state.footer.message)+"\n        ")]):n._e()]),n._v(" "),n._l(n.state.buttons,function(t){return r("button",{directives:[{name:"disabled",rawName:"v-disabled",value:!n.btnEnabled(t),expression:"!btnEnabled(button)"},{name:"t",rawName:"v-t",value:t.title,expression:"button.title"}],key:t.id,staticClass:"btn ",class:[t.class],attrs:{update:n.state.update,valid:n.state.valid},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),n.exec(t.cbk)}}})})])]:[r("button",{directives:[{name:"t",rawName:"v-t",value:"back",expression:"'back'"}],staticClass:"btn skin-button",on:{click:function(e){return!e.type.indexOf("key")&&n._k(e.keyCode,"prevet",void 0,e.key,void 0)?null:(e.stopPropagation(),n.backToRoot(e))}}})]],2)},n.staticRenderFns=[]},{}],153:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=Vue.extend({name:"form-header",props:{headers:{type:Array,default:[]},currentid:{type:String},update:{type:Boolean},valid:{type:Boolean}},methods:{click:function(e){e!==this.currentid&&1<this.headers.length&&this.$emit("clickheader",e)},resizeForm:function(e){this.$emit("resize-form",e)}}}),t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"g3wform_header box-header with-border",staticStyle:{display:"flex","flex-direction":"column"}},[r("section",{staticClass:"g3wform_header_content"},n._l(n.headers,function(t){return r("span",{key:t.id,staticClass:"title",class:[{item_selected:n.currentid===t.id&&1<n.headers.length},[1<n.headers.length?"tabs":"one"]],staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"},style:{fontSize:n.isMobile()&&"1em !important"},on:{click:function(e){return e.stopPropagation(),n.click(t.id)}}},[t.icon?r("span",{staticStyle:{"margin-right":"5px"}},[r("i",{class:t.icon})]):n._e(),n._v(" "),r("span",{directives:[{name:"t",rawName:"v-t:pre",value:t.title,expression:"header.title",arg:"pre"}],staticClass:"g3w-long-text"},[n._v(n._s(t.name))]),n._v(" "),r(t.component,{tag:"component",attrs:{valid:n.valid,update:n.update}})],1)}),0)])},n.staticRenderFns=[]},{}],154:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default={name:"bar-loader",props:["loading","color"]},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this.$createElement,e=this._self._c||e;return this.loading?e("div",{staticClass:"bar-loader",style:{backgroundColor:this.color||"#FFFFFF",border:0}}):this._e()},n.staticRenderFns=[]},{}],155:[function(e,t,n){function r(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),u=e("store/application-state"),i=(u=u)&&u.__esModule?u:{default:u},l=e("utils").getUniqueDomId,n.default={name:"datetime",props:{type:{type:String,default:"date"},format:{type:String,default:"YYYY-MM-DD"},minDate:{default:!1},maxDate:{default:!1},enabledDates:{default:!1},value:{},label:{default:"Date"}},data:function(){return{datetimevalue:this.value}},methods:{changeInput:function(e){},change:function(e){e=moment(e).format(this.format);this.$emit("change",e)}},mounted:(s=r(function*(){var t=this;yield this.$nextTick(),this.datetimeinputelement=$(this.$refs.iddatetimepicker),this.datetimeinputelement.datetimepicker({minDate:this.minDate,maxDate:this.maxDate,defaultDate:this.datetimevalue,useCurrent:!1,allowInputToggle:!0,enabledDates:this.enabledDates,showClose:!0,format:this.format,locale:i.default.language,toolbarPlacement:"top",widgetPositioning:{horizontal:"right"}}),this.datetimeinputelement.on("dp.change",function(e){e=e.date;t.change(e)}),this.datetimeinputelement.on("dp.hide",function(e){}),i.default.ismobile&&setTimeout(function(){return datetimeinputelement.blur()})}),function(){return s.apply(this,arguments)}),watch:{value:function(e){this.datetimevalue=e,this.datetimeinputelement.data("DateTimePicker").date(e)},minDate:(o=r(function*(e){this.datetimeinputelement.data("DateTimePicker").minDate(e)}),function(e){return o.apply(this,arguments)}),maxDate:(a=r(function*(e){this.datetimeinputelement.data("DateTimePicker").maxDate(e)}),function(e){return a.apply(this,arguments)}),enabledDates:function(e){this.datetimeinputelement.data("DateTimePicker").enabledDates(e)}},created:function(){this.id=l()}},t.exports.__esModule&&(t.exports=t.exports.default);var i,a,o,s,l,u="function"==typeof t.exports?t.exports.options:t.exports;u.render=function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("div",{ref:"datimecontainer"},[t("label",{directives:[{name:"t",rawName:"v-t",value:e.label,expression:"label"}],staticStyle:{display:"block"},attrs:{for:e.id}}),e._v(" "),t("div",{staticClass:"form-group"},[t("div",{ref:"iddatetimepicker",staticClass:"input-group date"},[t("input",{ref:"idinputdatetimepiker",staticClass:"form-control",attrs:{id:e.id,type:"text"},on:{change:e.changeInput}}),e._v(" "),t("span",{staticClass:"input-group-addon caret"},[t("span",{staticClass:"datetimeinput",class:e.g3wtemplate.getFontClass("time"===e.type?"time":"calendar")})])])])])},u.staticRenderFns=[],u._scopeId="data-v-e7683bf8"},{"store/application-state":310,utils:404}],156:[function(e,t,n){e("vueify/lib/insert-css").insert(".divider[data-v-6409ddc0]{display:block;position:relative;padding:0;margin-bottom:5px;height:0;width:100%;max-height:0;font-size:1px;line-height:0;clear:both;border:none;border-bottom:2px solid #eee}");Object.defineProperty(n,"__esModule",{value:!0}),n.default={name:"divider"},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this.$createElement;return(this._self._c||e)("span",{staticClass:"divider"})},e.staticRenderFns=[],e._scopeId="data-v-6409ddc0"},{"vueify/lib/insert-css":2}],157:[function(e,t,n){e("vueify/lib/insert-css").insert('.modal-content[data-v-38db7d79]{background:hsla(0,0%,100%,.6);border-radius:3px}.modal-dialog[data-v-38db7d79]{display:inline-block;text-align:left;vertical-align:middle}.modal[data-v-38db7d79]{text-align:center;padding:0!important}.modal[data-v-38db7d79]:before{content:"";display:inline-block;height:100%;vertical-align:middle;margin-right:-4px}.carousel .carousel-control span[data-v-38db7d79]{color:#3c8dbc}');Object.defineProperty(n,"__esModule",{value:!0}),e=e("store/projects"),r=(e=e)&&e.__esModule?e:{default:e},n.default={name:"g3w-images-gallery",props:{images:{type:Array,default:[]},id:{type:String,default:"gallery"},active:{type:Number}},data:function(){return{carouselId:"carousel_"+Date.now()}},methods:{isActive:function(e){return e===this.active},isRelativePath:function(e){return _.startsWith(e,"/")||_.startsWith(e,"http")?e:r.default.getConfig().mediaurl+e}}},t.exports.__esModule&&(t.exports=t.exports.default);var r,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"modal fade modal-fullscreen force-fullscreen",attrs:{id:n.id,tabindex:"-1",role:"dialog","aria-labelledby":"","aria-hidden":"true"}},[r("div",{staticClass:"modal-dialog"},[r("div",{staticClass:"modal-content"},[r("div",{staticClass:"modal-body"},[r("div",{staticClass:"carousel slide",attrs:{id:n.carouselId,"data-interval":"false"}},[r("div",{staticClass:"carousel-inner"},n._l(n.images,function(e,t){return r("div",{staticClass:"item",class:n.active==t?"active":""},[r("img",{staticStyle:{margin:"auto"},attrs:{src:n.isRelativePath(e.src)}})])}),0),n._v(" "),1<n.images.length?r("a",{staticClass:"left carousel-control",attrs:{href:"#"+n.carouselId,role:"button","data-slide":"prev"}},[r("span",{class:n.g3wtemplate.getFontClass("arrow-left")})]):n._e(),n._v(" "),1<n.images.length?r("a",{staticClass:"right carousel-control",attrs:{href:"#"+n.carouselId,role:"button","data-slide":"next"}},[r("span",{class:n.g3wtemplate.getFontClass("arrow-left")})]):n._e()])])])])])},e.staticRenderFns=[],e._scopeId="data-v-38db7d79"},{"store/projects":317,"vueify/lib/insert-css":2}],158:[function(e,t,n){e("vueify/lib/insert-css").insert(".show-hide-geo[data-v-ea8dc510]{color:#3c8dbc;cursor:pointer;font-size:1.2em}");Object.defineProperty(n,"__esModule",{value:!0}),e=e("mixins"),n.default={name:"g3w-geospatial",props:{data:{}},mixins:[e.geoMixin],data:function(){return{layerId:"table_layer_"+Date.now(),visible:!1,id:"geo_table_"+Date.now()}}},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",{staticClass:"geo-content"},[e("span",{staticClass:"show-hide-geo",class:t.g3wtemplate.getFontClass(t.visible?"eye-close":"eye"),on:{click:function(e){return e.stopPropagation(),t.showLayer(e)}}})])},n.staticRenderFns=[],n._scopeId="data-v-ea8dc510"},{mixins:290,"vueify/lib/insert-css":2}],159:[function(e,t,n){e("vueify/lib/insert-css").insert(".help_div_container[data-v-5d3720b7]{color:#fff;text-align:justify;position:relative;border-radius:3px;margin:5px 2px;white-space:pre-line;background-color:#384246!important}.help_icon[data-v-5d3720b7]{text-align:center;font-size:.7em;margin-top:-4px;margin-left:-4px;background-color:#222d32;font-weight:700;color:#fff;position:absolute;top:0;left:0;width:15px;height:15px;box-shadow:0 3px 5px rgba(0,0,0,.5);border:1px solid #fff;border-radius:50%}.g3w-help-message-content[data-v-5d3720b7]{max-height:200px;padding:10px;overflow-y:auto}");Object.defineProperty(n,"__esModule",{value:!0}),n.default={name:"helpdiv",props:{message:{type:String,required:!0},type:{type:String,default:"info"}}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this.$createElement,e=this._self._c||e;return e("div",{staticClass:"help_div_container"},[e("span",{staticClass:"help_icon"},[this._v("i")]),this._v(" "),e("div",{directives:[{name:"t",rawName:"v-t",value:this.message,expression:"message"}],staticClass:"g3w-help-message-content"})])},e.staticRenderFns=[],e._scopeId="data-v-5d3720b7"},{"vueify/lib/insert-css":2}],160:[function(e,t,n){e("vueify/lib/insert-css").insert(".img-responsive[data-v-b7d14a7c]{cursor:pointer}.g3w-image[data-v-b7d14a7c]{padding-left:0!important;min-width:100px;max-width:100%;cursor:pointer}");Object.defineProperty(n,"__esModule",{value:!0}),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e=(e=e=e("components/GlobalGallery.vue"))&&e.__esModule?e:{default:e},n.default={name:"g3w-image",props:{value:{}},data:function(){return{galleryId:"gallery_"+Date.now(),active:null}},components:{"g3w-images-gallery":e.default},computed:{values:function(){return Array.isArray(this.value)?this.value:[this.value]}},methods:{getSrc:function(e){return"object"===(void 0===e?"undefined":r(e))?e.photo:e},showGallery:function(e){this.active=e,"object"===r(this.value)&&(this.value.active=!0),$("#"+this.galleryId).modal("show")},getGalleryImages:function(){var t=this;return this.values.map(function(e){return{src:t.getSrc(e)}})}}},t.exports.__esModule&&(t.exports=t.exports.default);var r,n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"container-fluid"},[r("div",{staticClass:"row"},n._l(n.values,function(e,t){return r("div",{staticClass:"g3w-image col-md-6 col-sm-12"},[r("img",{staticClass:"img-thumbnail",attrs:{src:n.getSrc(e)},on:{click:function(e){return e.stopPropagation(),n.showGallery(t)}}})])}),0),n._v(" "),r("g3w-images-gallery",{attrs:{id:n.galleryId,active:n.active,images:n.getGalleryImages()}})],1)},n.staticRenderFns=[],n._scopeId="data-v-b7d14a7c"},{"components/GlobalGallery.vue":157,"vueify/lib/insert-css":2}],161:[function(e,t,n){e("vueify/lib/insert-css").insert(".g3w-layer-positions[data-v-026784c2]{display:flex;flex-direction:column;margin:5px 0}.g3w-layer-positions-info-message[data-v-026784c2]{margin-bottom:5px;font-weight:700}.g3w-layer-positions-checkboxes[data-v-026784c2]{display:flex;justify-content:space-between}");Object.defineProperty(n,"__esModule",{value:!0}),r=e("app/constant"),i=e("utils").getUniqueDomId,n.default={name:"layerspositions",props:{position:{type:String,default:r.MAP_SETTINGS.LAYER_POSITIONS.default}},data:function(){return{layerpositions:r.MAP_SETTINGS.LAYER_POSITIONS.getPositions()}},methods:{change:function(){this.$emit("layer-position-change",this.position)}},created:function(){var t=this;this.ids={layerpositions:i()},this.layerpositions.forEach(function(e){return t.ids[e]=i()}),this.change()}},t.exports.__esModule&&(t.exports=t.exports.default);var r,i,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"g3w-layer-positions",attrs:{id:n.ids.layerpositions}},[r("div",{directives:[{name:"t",rawName:"v-t",value:"layer_position.message",expression:"`layer_position.message`"}],staticClass:"g3w-layer-positions-info-message"}),n._v(" "),r("div",{staticClass:"g3w-layer-positions-checkboxes"},n._l(n.layerpositions,function(t){return r("div",{key:t},[r("input",{directives:[{name:"model",rawName:"v-model",value:n.position,expression:"position"}],staticClass:"form-control magic-radio",attrs:{type:"radio",id:n.ids[t]},domProps:{value:t,checked:n.position===t,checked:n._q(n.position,t)},on:{change:[function(e){n.position=t},n.change]}}),n._v(" "),r("label",{directives:[{name:"t",rawName:"v-t",value:"layer_position."+t,expression:"`layer_position.${layerposition}`"}],attrs:{for:n.ids[t]}})])}),0)])},e.staticRenderFns=[],e._scopeId="data-v-026784c2"},{"app/constant":5,utils:404,"vueify/lib/insert-css":2}],162:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default={name:"progressbar",props:["progress"]},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,t=e._self._c||t;return null!==e.progress&&void 0!==e.progress?t("div",{staticStyle:{margin:"5px 0 5px 0",width:"100%",backgroundColor:"#FFFFFF",border:"0",borderRadius:"3px"}},[t("div",{staticClass:"skin-background-color",staticStyle:{display:"flex",justifyContent:"center",fontWeight:"bold"},style:{width:e.progress<10?10:e.progress}},[t("span",[e._v(e._s(e.progress))])])]):e._e()},n.staticRenderFns=[]},{}],163:[function(e,t,n){var r,i;e("vueify/lib/insert-css").insert(".min-max-label[data-v-a8bbacb8]{align-self:end;font-weight:700}");function a(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),i=e("utils").debounce,n.default={name:"range",props:{id:{default:void 0},label:{type:String,default:""},min:{type:Number,default:0},max:{type:Number,default:10},step:{type:Number,default:1},labelValue:{},value:{default:0},sync:{type:Boolean,default:!1},showValue:{type:Boolean,default:!1},unit:{type:String,default:""}},data:function(){return{state:{value:this.value}}},methods:{changeBackGround:function(e){this.$refs["range-input"].style.backgroundSize=(e?100*(e-this.min)/(this.max-this.min):0)+"% 100%"},setValue:function(e){this.changedValue(e)},change:function(e){this.changedValue(+e.target.value)},emitChangeValue:function(e){this.state.value=e,this.$emit("change-range",{id:this.id,value:e})}},watch:{value:function(e){this.state.value=e},"state.value":function(e){this.changeBackGround(e),this.sync&&this.emitChangeValue(e)}},created:function(){var t=this;this.changedValue=this.sync?function(){return t.$emit("changed")}:i(function(e){t.emitChangeValue(e)})},mounted:(r=a(function*(){yield this.$nextTick(),this.changeBackGround(this.value)}),function(){return r.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",[e("section",{staticStyle:{display:"flex","justify-content":"space-between","font-weight":"bold"}},[e("section",{staticStyle:{"align-self":"flex-end"}},[e("span",{staticClass:"min-max-label"},[t._v(t._s(t.min))]),t._v(" "),e("span",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(t.unit))])]),t._v(" "),e("div",{staticStyle:{display:"flex","flex-direction":"column",margin:"0 3px"}},[e("label",{directives:[{name:"t",rawName:"v-t",value:t.label,expression:"label"}],staticClass:"skin-color",staticStyle:{display:"block"},attrs:{for:t.id}}),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.state.value,expression:"state.value"}],ref:"range-input",attrs:{type:"range",id:t.id,min:t.min,max:t.max,step:t.step},domProps:{value:t.state.value},on:{change:t.change,__r:function(e){return t.$set(t.state,"value",e.target.value)}}})]),t._v(" "),e("section",{staticStyle:{"align-self":"flex-end"}},[e("span",{staticClass:"min-max-label"},[t._v(t._s(t.max))]),t._v(" "),e("span",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(t.unit))])])]),t._v(" "),t.showValue?[e("span",[t._v(t._s(t.state.value))]),t._v(" "),e("span",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(t.unit))])]:t._e()],2)},e.staticRenderFns=[],e._scopeId="data-v-a8bbacb8"},{utils:404,"vueify/lib/insert-css":2}],164:[function(e,t,n){function r(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),e=e("services/gui"),o=(e=e)&&e.__esModule?e:{default:e},n.default={name:"g3w-resize",props:{show:{type:Boolean,required:!0,default:!0},orientation:{type:String,default:"h"},where:{type:String,default:"document"},moveFnc:{type:Function,default:function(e){}}},computed:{style:function(){return{minWidth:"5px",backgroundColor:"#dddddd",cursor:"v"===this.orientation?"ns-resize":"col-resize"}}},methods:{wrapMoveFnc:function(e){this.moveFnc(e)},start:function(){this.domElementMoveListen.addEventListener("mousemove",this.wrapMoveFnc),this.domElementMoveListen.addEventListener("mouseup",this.stop,{once:!0})},stop:(a=r(function*(){this.domElementMoveListen.removeEventListener("mousemove",this.wrapMoveFnc),yield this.$nextTick(),o.default.emit("resize")}),function(){return a.apply(this,arguments)})},mounted:(i=r(function*(){this.domElementMoveListen="content"===this.where?document.getElementById("g3w-view-content"):document}),function(){return i.apply(this,arguments)}),destroyed:function(){this.domElementMoveListen=null}},t.exports.__esModule&&(t.exports=t.exports.default);var i,a,o,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],style:t.style,attrs:{id:t.$attrs.id},on:{mousedown:function(e){return e.stopPropagation(),t.start(e)}}})},e.staticRenderFns=[]},{"services/gui":302}],165:[function(e,t,n){function r(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),e=e("services/gui"),a=(e=e)&&e.__esModule?e:{default:e},n.default={name:"resize-icon",props:{type:{type:String,default:"h"}},data:function(){return{show:void 0!==this.type}},watch:{type:(i=r(function*(){this.show=!1,yield this.$nextTick(),this.show=!0}),function(){return i.apply(this,arguments)})},methods:{toggleFull:function(){a.default.toggleFullViewContent(),a.default.emit("resize")},resetToDefault:function(){a.default.resetToDefaultContentPercentage(),a.default.emit("resize")}}},t.exports.__esModule&&(t.exports=t.exports.default);var i,a,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this.$createElement,e=this._self._c||e;return e("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[this.show?e("i",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:bottom.create",value:"enlange_reduce",expression:"'enlange_reduce'",arg:"bottom",modifiers:{create:!0}}],staticClass:"action-button skin-color-dark",class:this.g3wtemplate.getFontClass("resize-"+this.type),staticStyle:{cursor:"pointer","margin-right":"3px"},on:{click:this.toggleFull}}):this._e(),this._v(" "),e("i",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"reset_default",expression:"'reset_default'",arg:"left",modifiers:{create:!0}}],staticClass:"action-button skin-color-dark",class:this.g3wtemplate.getFontClass("resize-default"),staticStyle:{cursor:"pointer"},on:{click:this.resetToDefault}})])},e.staticRenderFns=[]},{"services/gui":302}],166:[function(e,t,n){e("vueify/lib/insert-css").insert(".br[data-v-8413fc94]{border-radius:8px}.card[data-v-8413fc94]{width:80%;padding:10px 20px;margin:50px auto}.item[data-v-8413fc94]{height:15px;background:#ccc;margin-top:15px}.item-light[data-v-8413fc94]{background:#ddd}.text80[data-v-8413fc94]{width:80%}.chart-wrapper[data-v-8413fc94]{height:50px;display:flex;align-items:baseline;margin-bottom:20px}.chart-item[data-v-8413fc94]{height:100%;width:15px;background:#ccc;margin-right:10px}.chart-item-80[data-v-8413fc94]{height:80%}");Object.defineProperty(n,"__esModule",{value:!0}),n.default={name:"skeleton"},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this.$createElement;this._self._c;return this._m(0)},e.staticRenderFns=[function(){var e=this.$createElement,e=this._self._c||e;return e("div",{staticClass:"card br"},[e("div",{staticClass:"chart-wrapper"},[e("div",{staticClass:"chart-item br"}),this._v(" "),e("div",{staticClass:"chart-item chart-item-80 item-light br"}),this._v(" "),e("div",{staticClass:"chart-item br"}),this._v(" "),e("div",{staticClass:"chart-item br chart-item-80"})]),this._v(" "),e("div",{staticClass:"item br text80"}),this._v(" "),e("div",{staticClass:"item item-light br"}),this._v(" "),e("div",{staticClass:"item br"}),this._v(" "),e("div",{staticClass:"item item-light br text80"})])}],e._scopeId="data-v-8413fc94"},{"vueify/lib/insert-css":2}],167:[function(e,t,n){var r,i,a,o,s,l,u,c;e("vueify/lib/insert-css").insert(".formquerytabs[data-v-2cbd8ce7]{overflow:hidden!important;display:flex;flex-wrap:wrap}.formquerytabs>li[data-v-2cbd8ce7]{flex:1;display:flex}.formquerytabs>li>a[data-v-2cbd8ce7]{font-weight:700;flex:1}.tab-content[data-v-2cbd8ce7]{//margin-top:10px}.nav-tabs>li>a.mobile[data-v-2cbd8ce7]{padding:5px 10px}.tab_a[data-v-2cbd8ce7]{padding:5px;margin-right:0!important;//border:1px solid #eee;border-bottom:0;margin-bottom:3px;border-radius:3px 3px 0 0}.formquerytabs li a.tab_a.group-title[data-v-2cbd8ce7]{color:inherit!important;font-weight:600;font-size:1em!important;padding:.25em}");function d(e){return e&&e.__esModule?e:{default:e}}function p(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),r=d(e("services/data")),i=d(e("components/GlobalTabsNode.vue")),a=d(e("services/gui")),o=e("utils/getFormDataExpressionRequestFromFeature"),s=e("utils/convertFeatureToGEOJSON"),e=e("utils"),c=e.getUniqueDomId,e=e.noop,n.default={name:"tabs",props:{group:{type:Boolean,default:!1},contenttype:{default:"query"},layerid:{required:!0},tabs:{required:!0},feature:{required:!0},fields:{required:!0},addToValidate:{type:Function,default:e},removeToValidate:{type:Function,default:e},changeInput:{type:Function,default:e},showRelationByField:{type:Boolean,default:!0},handleRelation:{type:Function,default:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.relation,n=e.layerId,e=e.feature;return a.default.getService("queryresults").showRelation({relation:t,layerId:n,feature:e})}}},data:function(){return{ids:[]}},computed:{required_fields:function(){return"editing"===this.contenttype&&this.fields.filter(function(e){return e.validate.required}).map(function(e){return e.name})},show:function(){return this.tabs.reduce(function(e,t){return e||void 0===t.visible||!!t.visible},!1)}},methods:{setVisibility:(u=p(function*(e){e.visible=yield r.default.getData("expression:expression_eval",{inputs:{qgs_layer_id:this.layerid,form_data:("editing"===this.contenttype?s.convertFeatureToGEOJSON:o.getFormDataExpressionRequestFromFeature)(this.feature||{}),expression:e.visibility_expression.expression,formatter:"query"===this.contenttype?1:0},outputs:!1})}),function(e){return u.apply(this,arguments)}),setEditingRequireTab:function(e){var t=this;return void 0===e.nodes?-1!==this.required_fields.indexOf(e.field_name):!!e.nodes.find(function(e){return t.setEditingRequireTab(e)})},getField:function(t){return this.fields.find(function(e){return t===e.name})}},components:{Node:i.default},created:(l=p(function*(){var n,t,a=this;this.unwatch=[],this.tabs.forEach((n=p(function*(i,e){i.visibility_expression&&(void 0===i.visible&&a.$set(i,"visible",0),yield a.setVisibility(i)),"editing"===a.contenttype&&(void 0===i.required&&(i.required=a.setEditingRequireTab(i)),i.visibility_expression)&&i.visibility_expression.referenced_columns.forEach(function(t){var n,r=a.fields.find(function(e){return t===e.name});a.unwatch.push(a.$watch(function(){return r.value},(n=p(function*(e){a.feature.set(r.name,e),yield a.setVisibility(i)}),function(e){return n.apply(this,arguments)})))}),a.ids.push("tab_"+c())}),function(e,t){return n.apply(this,arguments)})),this.root_tabs=[],this.group?this.root_tabs=[this.tabs]:(t=[],this.tabs.forEach(function(e){e.nodes?t.push(e):(t.length&&(a.root_tabs.push([].concat(t)),t.splice(0)),a.root_tabs.push({nodes:[e]}))}),t.length&&this.root_tabs.push(t))}),function(){return l.apply(this,arguments)}),beforeDestroy:function(){this.unwatch.forEach(function(e){return e()}),this.unwatch=null}},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var n=this,e=n.$createElement,r=n._self._c||e;return n.show?r("div",{staticClass:"tabs-wrapper"},[n._l(n.root_tabs,function(e){return[Array.isArray(e)?[r("ul",{staticClass:"formquerytabs nav nav-tabs"},[n._l(e,function(e,t){return[void 0===e.visible||e.visible?r("li",{class:{active:0===t}},[r("a",{staticClass:"tab_a",class:{mobile:n.isMobile(),"group-title":n.group},style:{fontSize:n.isMobile()?"1.0em":(n.group?"1.1":"1.2")+"em"},attrs:{"data-toggle":"tab",href:"#"+n.ids[t]}},[n._v("\n               "+n._s(e.name)+" "),"editing"===n.contenttype&&e.required?r("span",{staticStyle:{"padding-left":"3px","font-size":"1.1em"}},[n._v("*")]):n._e()])]):n._e()]})],2),n._v(" "),r("div",{staticClass:"tab-content",class:{editing:"editing"===n.contenttype}},[n._l(e,function(e,t){return[void 0===e.visible||e.visible?r("div",{staticClass:"tab-pane fade",class:{"in active":0===t},attrs:{id:n.ids[t]}},[r("node",{attrs:{showRelationByField:n.showRelationByField,handleRelation:n.handleRelation,feature:n.feature,layerid:n.layerid,contenttype:n.contenttype,addToValidate:n.addToValidate,removeToValidate:n.removeToValidate,changeInput:n.changeInput,fields:n.fields,showTitle:!1,node:e}})],1):n._e()]})],2)]:r("node",{attrs:{showRelationByField:n.showRelationByField,handleRelation:n.handleRelation,feature:n.feature,layerid:n.layerid,contenttype:n.contenttype,addToValidate:n.addToValidate,removeToValidate:n.removeToValidate,changeInput:n.changeInput,fields:n.fields,showTitle:!1,node:e}})]})],2):n._e()},n.staticRenderFns=[],n._scopeId="data-v-2cbd8ce7"},{"components/GlobalTabsNode.vue":168,"services/data":300,"services/gui":302,utils:404,"utils/convertFeatureToGEOJSON":332,"utils/getFormDataExpressionRequestFromFeature":382,"vueify/lib/insert-css":2}],168:[function(e,t,n){var r,i,a;e("vueify/lib/insert-css").insert(".tab-node[data-v-9685e2ee]{min-width:0;overflow:hidden}.title[data-v-9685e2ee]{font-weight:700;width:100%;color:#fff;padding:3px;margin-top:5px;margin-bottom:5px;border-radius:2px}.node-row[data-v-9685e2ee]{margin-bottom:0;column-gap:2px;margin-top:0;display:grid;grid-auto-columns:minmax(0,1fr);grid-auto-flow:column}.row.mobile[data-v-9685e2ee]{margin-bottom:0!important}");function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0}),r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=o(e("components/InputG3W.vue")),a=o(e("store/projects")),e=e("gui/fields/fields"),n.default={name:"node",props:["contenttype","node","fields","showTitle","addToValidate","removeToValidate","changeInput","layerid","feature","showRelationByField","handleRelation"],components:r({G3wInput:i.default},e),data:function(){return{context:this.contenttype,editing_required:!1}},computed:{filterNodes:function(){var e=this;return this.node.nodes&&this.node.nodes.filter(function(t){return"group"===e.getNodeType(t)||(!t.nodes&&t.name&&"group"!=e.getNodeType(t)?t.relation=!0:!!e.fields.find(function(e){return(t.field_name&&t.field_name.replace(/ /g,"_"))===e.name||t.relation}))})||[]},nodesLength:function(){return this.filterNodes.length},rows:function(){var e=1;return 0===this.nodesLength?e=0:this.columnNumber<=this.nodesLength&&(e=Math.floor(this.nodesLength/this.columnNumber)+this.nodesLength%this.columnNumber),e},columnNumber:function(){var e=parseInt(this.node.columncount)?parseInt(this.node.columncount):1;return e>this.nodesLength?this.nodesLength:e},showGroupTile:function(){return this.showTitle&&this.node.showlabel&&this.node.groupbox}},methods:{loadingRelation:function(e){return a.default.getCurrentProject().getLayerById(this.layerid).getRelationById(e.name)||{loading:!1}},isRelationDisabled:function(e){return void 0===this.getRelationName(e.name)||"editing"===this.contenttype&&this.isRelationChildLayerNotEditable(e)},getRelationName:function(e){e=a.default.getCurrentProject().getRelationById(e);return e&&e.name},isRelationChildLayerNotEditable:function(e){e.nmRelationId;var e=e.name,t=a.default.getCurrentProject(),e=t.getRelationById(e).referencingLayer;return!t.getLayerById(e).isEditable()},getNodes:function(e){e=(e-1)*this.columnNumber;return this.filterNodes.slice(e,this.columnNumber+e)},getNode:function(e,t){return this.getNodes(e)[t-1]},getField:function(t){return t.relation?t:this.fields.find(function(e){return(t.field_name&&t.field_name.replace(/ /g,"_"))===e.name})},getNodeType:function(e){var t=e.groupbox||e.nodes?"group":e.relation?"relation":"field";return"field"==t&&[void 0,""].includes(e.alias)&&(e.alias=e.field_name),t},getComponent:function(e){if(!e.relation)return e.query?e.input.type:"g3w-input"}}},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var r=this,e=r.$createElement,i=r._self._c||e;return i("div",{staticClass:"tab-node group"},[r.showGroupTile?i("h5",{staticClass:"title group-title",class:{mobile:r.isMobile()},style:{fontSize:r.isMobile()?"1em":"1.1em"}},[r._v(r._s(r.node.name)+"\n  ")]):r._e(),r._v(" "),r._l(r.rows,function(n){return i("div",{staticClass:"node-row",class:{mobile:r.isMobile()}},[r._l(r.columnNumber,function(t){return[r.getNode(n,t)?["field"===r.getNodeType(r.getNode(n,t))?i(r.getComponent(r.getField(r.getNode(n,t))),{tag:"component",staticStyle:{padding:"5px 3px 5px 3px"},attrs:{state:r.getField(r.getNode(n,t)),changeInput:r.changeInput,addToValidate:r.addToValidate,removeToValidate:r.removeToValidate,feature:r.feature},on:{changeinput:r.changeInput,addinput:r.addToValidate,removeinput:r.removeToValidate}}):["group"===r.getNodeType(r.getNode(n,t))?i("tabs",r._b({staticClass:"sub-group",staticStyle:{width:"100% !important"},attrs:{group:!0,tabs:[r.getNode(n,t)]}},"tabs",r.$props,!1)):[r.showRelationByField?i("div",{directives:[{name:"disabled",rawName:"v-disabled",value:r.isRelationDisabled(r.getNode(n,t))||r.loadingRelation(r.getNode(n,t)).loading,expression:"isRelationDisabled(getNode(row, column)) || loadingRelation(getNode(row, column)).loading"}],style:{cursor:r.showRelationByField&&"pointer"},on:{click:function(e){e.stopPropagation(),r.handleRelation({relation:r.getNode(n,t),feature:r.feature,layerId:r.layerid})}}},[i("bar-loader",{attrs:{loading:r.loadingRelation(r.getNode(n,t)).loading}}),r._v(" "),i("div",{staticStyle:{display:"flex","align-items":"center"}},[i("div",{staticClass:"query_relation_field"},[i("i",{class:r.g3wtemplate.font["query"===r.context?"relation":"pencil"]})]),r._v(" "),i("span",{staticClass:"query_relation_field_message g3w-long-text"},[i("span",{staticStyle:{"text-transform":"uppercase"}},[r._v(" "+r._s(r.getRelationName(r.getNode(n,t).name)))])])])],1):r._e()]]]:r._e()]})],2)})],2)},n.staticRenderFns=[],n._scopeId="data-v-9685e2ee"},{"components/InputG3W.vue":175,"gui/fields/fields":80,"store/projects":317,"vueify/lib/insert-css":2}],169:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default={name:"header-item",props:["state"],methods:{showCustomModal:function(e){this.$emit("show-custom-modal-content",e)}},created:function(){this.state.type=this.state.type||"link"}},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("li",{staticClass:"customheaderlink dropdown user user-menu",attrs:{title:t.state.title}},["link"===t.state.type?e("a",{staticClass:"dropdown-toggle",class:{imagelink:!!t.state.img},attrs:{href:t.state.url,target:t.state.target}},[t.state.img?e("img",{staticStyle:{"max-height":"20px"},attrs:{src:t.state.img}}):e("span",[t.state.i18n?e("span",{directives:[{name:"t",rawName:"v-t",value:t.state.title,expression:"state.title"}]}):e("span",[t._v(t._s(t.state.title))])])]):"modal"===t.state.type?e("a",{staticClass:"dropdown-toggle",staticStyle:{cursor:"pointer"},attrs:{"data-toggle":"modal","data-target":"#custom_modal"},on:{click:function(e){return e.stopPropagation(),t.showCustomModal(t.state.id)}}},[e("span",[t._v(t._s(t.state.title))])]):t._e()])},n.staticRenderFns=[]},{}],170:[function(e,t,n){e("vueify/lib/insert-css").insert(".control-label[data-v-cb533ff6]{text-align:left!important;padding-top:0!important;margin-bottom:3px}");Object.defineProperty(n,"__esModule",{value:!0}),r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},e=e("mixins"),n.default=r({name:"InputBase",props:["state"]},e.baseInputMixin),t.exports.__esModule&&(t.exports=t.exports.default);var r,n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return t.state.visible?e("div",{staticClass:"form-group"},[t._t("label",[e("label",{directives:[{name:"disabled",rawName:"v-disabled",value:!t.editable,expression:"!editable"},{name:"t",rawName:"v-t",value:t.state.i18nLabel?t.state.label:"",expression:"state.i18nLabel ? state.label : ''"}],staticClass:"col-sm-12 control-label",attrs:{for:t.state.name}},[t._v(t._s(t.state.i18nLabel?"":t.state.label)+"\n\n      "),t.state.validate&&t.state.validate.required?e("span",[t._v("*")]):t._e(),t._v(" "),t.showhelpicon?e("i",{staticClass:"skin-color",class:t.g3wtemplate.font.info,staticStyle:{"margin-left":"3px",cursor:"pointer"},on:{click:function(e){return e.stopPropagation(),t.showHideHelp(e)}}}):t._e(),t._v(" "),t._t("label-action")],2)]),t._v(" "),e("div",{staticClass:"col-sm-12"},[t._t("loading",["loading"===t.loadingState?e("div",{staticStyle:{position:"relative",width:"100%"},attrs:{slot:"loading"},slot:"loading"},[e("bar-loader",{attrs:{loading:"true"}})],1):t._e()]),t._v(" "),t._t("body"),t._v(" "),t._t("message",[t.notvalid?e("p",{staticClass:"g3w-long-text error-input-message",staticStyle:{margin:"0"},domProps:{innerHTML:t._s(t.state.validate.message)}}):t.state.info?e("p",{staticStyle:{margin:"0"},domProps:{innerHTML:t._s(t.state.info)}}):t._e()]),t._v(" "),t.state.help&&this.state.help.visible?e("div",{staticClass:"g3w_input_help skin-background-color extralighten",domProps:{innerHTML:t._s(t.state.help.message)}}):t._e()],2)],2):t._e()},n.staticRenderFns=[],n._scopeId="data-v-cb533ff6"},{mixins:290,"vueify/lib/insert-css":2}],171:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),r=e("mixins"),i=e("gui/inputs/input"),a=e("utils").getUniqueDomId,n.default={name:"input-checkbox",mixins:[i,r.widgetMixins],data:function(){return{value:null,label:null,id:a()}},methods:{setLabel:function(){this.label=this.service.convertCheckedToValue(this.value)},setValue:function(){this.value=this.service.convertValueToChecked()},changeCheckBox:function(){this.setLabel(),this.widgetChanged()},stateValueChanged:function(){this.setValue(),this.setLabel()}},created:function(){this.value=this.state.forceNull?this.value:this.service.convertValueToChecked()},mounted:function(){this.state.forceNull||this.setLabel()}},t.exports.__esModule&&(t.exports=t.exports.default);var r,i,a,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var i=this,e=i.$createElement,e=i._self._c||e;return e("baseinput",{attrs:{state:i.state}},[e("div",{directives:[{name:"disabled",rawName:"v-disabled",value:!i.editable,expression:"!editable"}],staticStyle:{height:"20px","margin-top":"8px"},attrs:{slot:"body"},slot:"body"},[e("input",{directives:[{name:"model",rawName:"v-model",value:i.value,expression:"value"}],staticClass:"magic-checkbox",class:{"input-error-validation":i.notvalid},staticStyle:{width:"100%"},attrs:{tabIndex:i.tabIndex,type:"checkbox",id:i.id},domProps:{checked:Array.isArray(i.value)?-1<i._i(i.value,null):i.value},on:{change:[function(e){var t,n=i.value,e=e.target,r=!!e.checked;Array.isArray(n)?(t=i._i(n,null),e.checked?t<0&&(i.value=n.concat([null])):-1<t&&(i.value=n.slice(0,t).concat(n.slice(t+1)))):i.value=r},i.changeCheckBox]}}),i._v(" "),e("label",{attrs:{for:i.id}},[i._v(i._s(i.label))])])])},e.staticRenderFns=[]},{"gui/inputs/input":91,mixins:290,utils:404}],172:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),e=e("gui/inputs/input"),n.default={name:"input-color",mixins:[e]},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("baseinput",{attrs:{state:t.state}},[e("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!t.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:t.state.value,expression:"state.value"}],staticClass:"form-control",class:{"input-error-validation":t.notvalid},staticStyle:{cursor:"pointer"},attrs:{slot:"body",placeholder:t.state.default,type:"color",tabIndex:t.tabIndex,field:t.state.name,id:t.state.name},domProps:{value:t.state.value},on:{change:t.change,input:function(e){e.target.composing||t.$set(t.state,"value",e.target.value)}},slot:"body"})])},n.staticRenderFns=[]},{"gui/inputs/input":91}],173:[function(e,t,n){function r(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),i=e("store/application-state"),u=(i=i)&&i.__esModule?i:{default:i},i=e("mixins"),s=e("gui/inputs/input"),l=e("utils").getUniqueDomId,n.default={name:"input-datetime-picker",mixins:[s,i.resizeMixin],data:function(){var e=l();return{widget_container:{top:0,left:0},iddatetimepicker:"datetimepicker_"+e,idinputdatetimepiker:"inputdatetimepicker_"+e}},methods:{resize:function(){var e=$("#"+this.iddatetimepicker);e&&e.data("DateTimePicker")&&e.data("DateTimePicker").hide()},timeOnly:function(){return!this.state.input.options.formats[0].date},onDatePickerChange:function(){var e=$("#"+this.idinputdatetimepiker).val();this.state.value=_.isEmpty(_.trim(e))?null:moment(e,this.datetimedisplayformat).format(this.datetimefieldformat),this.change()},onDatePickerShow:function(e){var n=this;this.widget_container.top=0,this.widget_container.left=0,setTimeout(function(){var e=n.$refs.datetimepicker_body.getBoundingClientRect(),t=n.$refs.datimewidget_container.querySelector(".bootstrap-datetimepicker-widget").getBoundingClientRect();n.widget_container.top=e.top+(e.top<t.height?e.height+Math.abs(e.top-t.height)+20:0),n.widget_container.left=e.left-Math.max(e.width,t.width),n.$emit("datetimepickershow")})},onDatePickerHide:function(e){this.$emit("datetimepickershow")}},watch:{"state.value":(o=r(function*(e){e!==$("#"+this.idinputdatetimepiker).val()&&(e=null!==e?moment(e,this.datetimefieldformat).format(this.datetimedisplayformat):e,yield this.$nextTick(),$("#"+this.idinputdatetimepiker).val(e))}),function(e){return o.apply(this,arguments)})},mounted:(a=r(function*(){var e=this,t=this.state.input.options,n=t.formats,t=t.layout,t=void 0===t?{vertical:"top",horizontal:"left"}:t,n=(void 0===n?[]:n)[0],r=n.minDate,i=n.maxDate,a=n.fieldformat,o=n.enabledDates,s=n.disabledDates,l=n.displayformat,n=n.useCurrent,l=(yield this.$nextTick(),this.datetimedisplayformat=this.service.convertQGISDateTimeFormatToMoment(l),this.datetimefieldformat=this.service.convertQGISDateTimeFormatToMoment(a),this.service.setValidatorOptions({fielddatetimeformat:this.datetimefieldformat}),moment(this.state.value,this.datetimefieldformat,!0).isValid()?moment(this.state.value,this.datetimefieldformat).toDate():null);$("#"+this.iddatetimepicker).datetimepicker({defaultDate:l,format:this.datetimedisplayformat,ignoreReadonly:!0,allowInputToggle:!0,enabledDates:o,disabledDates:s,useCurrent:n,toolbarPlacement:"top",minDate:r,maxDate:i,widgetParent:$(this.$refs.datimewidget_container),widgetPositioning:{vertical:t.vertical||"top",horizontal:t.horizontal||"left"},showClose:!0,locale:this.service.getLocale()}),$("#"+this.iddatetimepicker).on("dp.change",this.onDatePickerChange),$("#"+this.iddatetimepicker).on("dp.show",this.onDatePickerShow),$("#"+this.iddatetimepicker).on("dp.hide",this.onDatePickerHide),u.default.ismobile&&setTimeout(function(){$("#"+e.idinputdatetimepiker).blur()})}),function(){return a.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default);var i,u,a,o,s,l,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("baseinput",{attrs:{state:e.state}},[t("div",{ref:"datetimepicker_body",attrs:{slot:"body"},slot:"body"},[t("div",{ref:"datimewidget_container",style:{top:e.widget_container.top+"px",left:e.widget_container.left+"px",position:"fixed",zIndex:1e4}}),e._v(" "),t("div",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"}],staticClass:"input-group date",attrs:{id:e.iddatetimepicker}},[t("input",{staticClass:"form-control",class:{"input-error-validation":e.notvalid},attrs:{type:"text",id:e.idinputdatetimepiker,tabIndex:e.tabIndex,readonly:!e.editable||e.isMobile()?"readonly":null}}),e._v(" "),t("span",{staticClass:"input-group-addon caret"},[t("span",{class:[e.g3wtemplate.getFontClass(e.timeOnly()?"time":"calendar")]})])])])])},e.staticRenderFns=[]},{"gui/inputs/input":91,mixins:290,"store/application-state":310,utils:404}],174:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),e=e("gui/inputs/input"),n.default={name:"input-float",mixins:[e]},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("baseinput",{attrs:{state:t.state}},[e("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!t.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:t.state.value,expression:"state.value"}],staticClass:"form-control",class:{"input-error-validation":t.notvalid},staticStyle:{width:"100%"},attrs:{slot:"body",tabIndex:t.tabIndex,type:"number",step:t.state.step||1,placeholder:t.state.default},domProps:{value:t.state.value},on:{change:t.change,input:[function(e){e.target.composing||t.$set(t.state,"value",e.target.value)},t.change]},slot:"body"})])},n.staticRenderFns=[]},{"gui/inputs/input":91}],175:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},e=e("gui/inputs/inputs"),n.default={name:"g3w-input",props:{state:{required:!0},addToValidate:{type:Function,required:!0},removeToValidate:{type:Function,required:!0},changeInput:{type:Function,required:!0}},components:r({},e),computed:{type:function(){if("child"!==this.state.type)return this.state.input.type?this.state.input.type+"_input":this.state.type+"_input"}},created:function(){"child"===this.state.type||this.state.input.options||(this.state.input.options={})}},t.exports.__esModule&&(t.exports=t.exports.default);var r,n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.state.visible?n("div",["child"!==t.state.type?n("div",[n(t.type,{tag:"component",attrs:{changeInput:t.changeInput,addToValidate:t.addToValidate,removeToValidate:t.removeToValidate,state:t.state},on:{changeinput:t.changeInput,addinput:t.addToValidate,removeinput:t.removeToValidate}}),t._v(" "),n("divider")],1):n("div",{staticClass:"skin-border-color field-child",staticStyle:{"border-top":"2px solid"}},[n("h4",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(t.state.label))]),t._v(" "),n("div",[t._v(" "+t._s(t.state.description)+" ")]),t._v(" "),t._l(t.state.fields,function(e){return n("g3w-input",{key:e.name,attrs:{state:e,changeInput:t.changeInput,addToValidate:t.addToValidate,removeToValidate:t.removeToValidate},on:{changeinput:t.changeInput,addinput:t.addToValidate,removeinput:t.removeToValidate}})})],2)]):t._e()},n.staticRenderFns=[],n._scopeId="data-v-0fece3a7"},{"gui/inputs/inputs":92}],176:[function(e,t,n){e("vueify/lib/insert-css").insert("#g3w-for-inputs-required-inputs-message[data-v-06573254]{margin-bottom:5px;font-weight:700;text-align:center;display:flex;align-items:center;justify-content:center}.box-body[data-v-06573254]{padding:5px}");Object.defineProperty(n,"__esModule",{value:!0}),e=(e=e=e("components/InputG3W.vue"))&&e.__esModule?e:{default:e},n.default={name:"g3w-form-inputs",props:{state:{type:Object,default:{fields:[]}},addToValidate:{type:Function},changeInput:{type:Function},show_required_field_message:{type:Boolean,default:!1},removeToValidate:{type:Function}},components:{G3wInput:e.default}},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("form",{staticClass:"form-horizontal g3w-form"},[n("div",{staticClass:"box-primary"},[n("div",{staticClass:"box-body"},[t._l(t.state.fields,function(e){return[n("g3w-input",{attrs:{state:e,removeToValidate:t.removeToValidate,addToValidate:t.addToValidate,changeInput:t.changeInput},on:{addToValidate:t.addToValidate,changeInput:t.changeInput}})]})],2),t._v(" "),t.show_required_field_message?n("div",{attrs:{id:"g3w-for-inputs-required-inputs-message"}},[n("span",{staticClass:"hide-cursor-caret-color"},[t._v("*")]),t._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.form.footer.required_fields",expression:"'sdk.form.footer.required_fields'"}],staticClass:"hide-cursor-caret-color"})]):t._e()])])},n.staticRenderFns=[],n._scopeId="data-v-06573254"},{"components/InputG3W.vue":175,"vueify/lib/insert-css":2}],177:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),e=e("gui/inputs/input"),n.default={name:"input-integer",mixins:[e]},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("baseinput",{attrs:{state:t.state}},[e("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!t.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:t.state.value,expression:"state.value"}],staticClass:"form-control",class:{"input-error-validation":t.notvalid},staticStyle:{width:"100%"},attrs:{slot:"body",placeholder:t.state.default,tabIndex:t.tabIndex,type:"number"},domProps:{value:t.state.value},on:{change:t.change,input:[function(e){e.target.composing||t.$set(t.state,"value",e.target.value)},t.change]},slot:"body"})])},n.staticRenderFns=[]},{"gui/inputs/input":91}],178:[function(e,t,n){function r(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),a=e("utils").getUniqueDomId,e=e("gui/inputs/input"),n.default={name:"input-lonlat",mixins:[e],data:function(){return{lonId:a(),latId:a(),coordinatebutton:{active:!1}}},computed:{getCoordinateActive:function(){return this.service.state.getCoordinateActive}},methods:{toggleGetCoordinate:function(){this.service.toggleGetCoordinate()},changeLonLat:function(){this.change(),this.setValue()},setValue:function(){this.state.value=[[+this.state.values.lon,+this.state.values.lat]]}},created:function(){this.state.values=this.state.values||{lon:0,lat:0},this.setValue(),this.service.setCoordinateButtonReactiveObject(this.coordinatebutton)},mounted:(i=r(function*(){var e=this;yield this.$nextTick(),this.$nextTick(function(){$(e.$refs["g3w-input-lat-lon"]).tooltip({trigger:"hover"})})}),function(){return i.apply(this,arguments)}),destroyed:function(){this.service.clear()}},t.exports.__esModule&&(t.exports=t.exports.default);var i,a,n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",{staticStyle:{position:"relative"}},[e("div",{staticStyle:{display:"flex","justify-content":"flex-end",height:"35px","margin-right":"12px","margin-bottom":"5px"}},[e("button",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.form.inputs.tooltips.lonlat",expression:"'sdk.form.inputs.tooltips.lonlat'"}],ref:"g3w-input-lat-lon",staticClass:"action skin-tooltip-left skin-color skin-border-color",class:t.g3wtemplate.font.crosshairs,staticStyle:{"border-radius":"5px","font-weight":"bold","font-size":"20px",cursor:"pointer"},style:{border:t.coordinatebutton.active?"2px solid":0},attrs:{"data-placement":"left","data-container":"body","data-toggle":"tooltip"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.toggleGetCoordinate(e)}}})]),t._v(" "),e("baseinput",{attrs:{state:t.state}},[e("label",{staticClass:"col-sm-4 control-label",attrs:{slot:"label",for:t.lonId},slot:"label"},[t._v(t._s(t.state.labels.lon)+"\n      "),t.state.validate&&t.state.validate.required?e("span",[t._v("*")]):t._e()]),t._v(" "),e("div",{attrs:{slot:"body"},slot:"body"},[e("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!t.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:t.state.values.lon,expression:"state.values.lon"}],staticClass:"form-control",class:{"input-error-validation":t.notvalid},staticStyle:{width:"100%","margin-bottom":"5px"},attrs:{id:t.lonId,tabIndex:t.tabIndex,type:"number",min:"-180",max:"180",placeholder:"Lon"},domProps:{value:t.state.values.lon},on:{change:t.changeLonLat,input:function(e){e.target.composing||t.$set(t.state.values,"lon",e.target.value)}}})])]),t._v(" "),e("baseinput",{attrs:{state:t.state}},[e("label",{staticClass:"col-sm-4 control-label",attrs:{slot:"label",for:t.latId},slot:"label"},[t._v(t._s(t.state.labels.lat)+"\n      "),t.state.validate&&t.state.validate.required?e("span",[t._v("*")]):t._e()]),t._v(" "),e("div",{attrs:{slot:"body"},slot:"body"},[e("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!t.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:t.state.values.lat,expression:"state.values.lat"}],staticClass:"form-control",class:{"input-error-validation":t.notvalid},staticStyle:{width:"100%","margin-bottom":"5px"},attrs:{id:t.latId,tabIndex:t.tabIndex,type:"number",min:"-90",max:"90",placeholder:"Lon"},domProps:{value:t.state.values.lat},on:{change:t.changeLonLat,input:function(e){e.target.composing||t.$set(t.state.values,"lat",e.target.value)}}})])])],1)},n.staticRenderFns=[]},{"gui/inputs/input":91,utils:404}],179:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),r=e("services/gui"),i=(r=r)&&r.__esModule?r:{default:r},r=e("gui/inputs/input"),a=e("utils").getUniqueDomId,o=e("core/i18n/i18n.service").t,e=e("gui/fields/fields").media_field,n.default={name:"input-media",mixins:[r],components:{"g3w-media":e},data:function(){return{data:{value:null,mime_type:null},mediaid:"media_"+a(),loading:!1}},methods:{onClick:function(e){document.getElementById(this.mediaid).click()},createImage:function(e,t){var n=new FileReader;n.onload=function(e){t.value=e.target.result},n.readAsDataURL(e)},checkFileSrc:function(e){return e=_.isNil(e)?"":e},clearMedia:function(){this.data.value=this.data.mime_type=this.state.value=null,this.change()}},created:function(){this.state.value&&(this.data.value=this.state.value.value,this.data.mime_type=this.state.value.mime_type)},mounted:function(){var n=this,r=this.state.name,e={name:r,csrfmiddlewaretoken:this.$cookie.get("csrftoken")};this.$nextTick(function(){$("#"+n.mediaid).fileupload({dataType:"json",formData:e,start:function(){n.loading=!0},done:function(e,t){t=t.result[r];t&&(n.data.value=t.value,n.data.mime_type=t.mime_type,n.state.value=n.data,n.change())},fail:function(){i.default.notify.error(o("info.server_error"))},always:function(){n.loading=!1}})})},beforeDestroy:function(){$("#"+this.mediaid).fileupload("destroy")}},t.exports.__esModule&&(t.exports=t.exports.default);var r,i,a,o,n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("baseinput",{attrs:{state:t.state}},[e("div",{directives:[{name:"disabled",rawName:"v-disabled",value:!t.editable,expression:"!editable"}],attrs:{slot:"body"},slot:"body"},[e("div",{staticClass:"g3w_input_button skin-border-color",staticStyle:{"border-style":"solid","border-width":"2px","border-radius":"4px",width:"100%",cursor:"pointer","text-align":"center"},on:{click:t.onClick}},[e("i",{staticClass:"fa-2x skin-color",class:t.g3wtemplate.getFontClass("file-upload"),staticStyle:{padding:"5px"}},[e("input",{class:{"input-error-validation":t.notvalid},staticStyle:{display:"none"},attrs:{id:t.mediaid,name:t.state.name,tabIndex:t.tabIndex,"data-url":t.state.input.options.uploadurl,type:"file"}})])]),t._v(" "),e("bar-loader",{attrs:{loading:t.loading}}),t._v(" "),e("g3w-media",{attrs:{state:t.data}},[e("div",{staticClass:"clearmedia",on:{click:function(e){return t.clearMedia()}}},[e("i",{staticClass:"g3w-icon",class:t.g3wtemplate.font["trash-o"]})])])],1)])},n.staticRenderFns=[]},{"core/i18n/i18n.service":12,"gui/fields/fields":80,"gui/inputs/input":91,"services/gui":302,utils:404}],180:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),r=e("gui/inputs/input"),i=e("gui/inputs/picklayer/service"),n.default={name:"input-picklayer",mixins:[r],methods:{pickLayer:function(){var t=this;this.pickservice.pick().then(function(e){return t.state.value=e}).catch(function(){})},unpick:function(){var e=this;setTimeout(function(){return!e.pickservice.isPicked()&&e.pickservice.unpick()},200)}},created:function(){this.pickservice=new i(this.state.input.options)},beforeDestroy:function(){this.pickservice.clear(),this.pickservice=null}},t.exports.__esModule&&(t.exports=t.exports.default);var r,i,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("baseinput",{attrs:{state:t.state}},[e("div",{attrs:{slot:"body"},slot:"body"},[e("span",{staticClass:"skin-color",class:t.g3wtemplate.font.crosshairs,staticStyle:{left:"0",top:"7px",position:"absolute"}}),t._v(" "),e("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!t.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:t.state.value,expression:"state.value"}],staticClass:"form-control",class:{"input-error-validation":t.notvalid},staticStyle:{width:"100%"},style:{cursor:t.editable?"pointer":null},attrs:{readonly:"readonly",tabIndex:t.tabIndex},domProps:{value:t.state.value},on:{input:[function(e){e.target.composing||t.$set(t.state,"value",e.target.value)},t.change],click:t.pickLayer,blur:t.unpick}})])])},e.staticRenderFns=[]},{"gui/inputs/input":91,"gui/inputs/picklayer/service":99}],181:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),r=e("gui/inputs/input"),i=e("utils").getUniqueDomId,n.default={name:"input-radio",mixins:[r],data:function(){return{ids:[i(),i()],name:"name_"+i(),radio_value:this.state.value}},watch:{radio_value:function(){this.state.value=this.radio_value,this.change()}}},t.exports.__esModule&&(t.exports=t.exports.default);var r,i,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("baseinput",{attrs:{state:n.state}},[r("div",{attrs:{slot:"body"},slot:"body"},n._l(n.state.input.options.values,function(t,e){return r("span",{key:t.key},[r("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!n.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:n.radio_value,expression:"radio_value"}],staticClass:"magic-radio",class:{"input-error-validation":n.notvalid},staticStyle:{width:"100%"},attrs:{id:n.ids[e],name:n.name,tabIndex:n.tabIndex,type:"radio"},domProps:{value:t.value,checked:n._q(n.radio_value,t.value)},on:{change:function(e){n.radio_value=t.value}}}),n._v(" "),r("label",{attrs:{for:n.ids[e]}},[n._v(n._s(t.key))])])}),0)])},e.staticRenderFns=[]},{"gui/inputs/input":91,utils:404}],182:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),e=e("gui/inputs/input"),n.default={name:"input-range",mixins:[e],data:function(){var e=this.state.input.options.values[0];return{min:e.min,max:e.max,step:e.Step}},methods:{checkValue:function(){var e=_.isEmpty(_.trim(this.state.value));e&&!this.state.validate.required&&(this.state.value=this.state.input.options.values[0].default),this.state.validate.valid=!this.state.validate.required,e||(this.state.validate.valid=this.service.getValidator().validate(this.state.value)),this.change()}}},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("baseinput",{attrs:{state:t.state}},[e("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!t.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:t.state.value,expression:"state.value"}],staticClass:"form-control",class:{"input-error-validation":t.notvalid},staticStyle:{width:"100%","padding-right":"5px"},attrs:{slot:"body",tabIndex:t.tabIndex,type:"number",step:t.step},domProps:{value:t.state.value},on:{keydown:[function(e){if(!e.type.indexOf("key")&&69!==e.keyCode)return null;e.preventDefault()},function(e){if(!e.type.indexOf("key")&&13!==e.keyCode)return null;e.stopPropagation()}],change:t.checkValue,blur:t.checkValue,input:function(e){e.target.composing||t.$set(t.state,"value",e.target.value)}},slot:"body"})])},n.staticRenderFns=[]},{"gui/inputs/input":91}],183:[function(e,t,n){var y,_,b,r,w,i,a,o,s,l,x,S,L,u;e("vueify/lib/insert-css").insert(".g3w-input-pick-layer[data-v-6b3d29b0]{cursor:pointer;position:relative;top:2px;font-size:1.2em}");function c(e){return e&&e.__esModule?e:{default:e}}function C(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),y=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},_=c(e("store/catalog-layers")),b=c(e("store/map-layers")),r=c(e("services/gui")),w=c(e("store/projects")),i=e("mixins"),x=e("utils").createSingleFieldParameter,S=e("gui/inputs/picklayer/service"),L=e("core/layers/layer"),e=e("gui/inputs/input"),u=null,n.default={name:"input-select",mixins:[e,i.selectMixin,i.select2Mixin],data:function(){return{showPickLayer:!1,picked:!1,filterFields:[],isFilterFieldsReady:!1}},computed:{showNullOption:function(){return[void 0,!0].includes(this.state.nullOption)},select2NullValue:function(){return this.showNullOption&&u}},methods:{pickLayerValue:(l=C(function*(){try{var e,t;this.picked?this.pickLayerInputService.unpick():(this.picked=!0,e=yield this.pickLayerInputService.pick(),this.autocomplete&&(this.state.input.options.values.splice(0,this.state.input.options.values.length,{key:e[this.state.input.options.key],value:e[this.state.input.options.value]}),yield this.$nextTick()),t=e[this.state.input.options.value],this.select2.val(t).trigger("change"),yield this.changeSelect(t),r.default.showUserMessage({type:"success",autoclose:!0})),this.picked=!1}catch(e){r.default.showUserMessage({type:"warning",message:"sdk.form.inputs.messages.errors.picklayer",autoclose:!0}),this.picked=!1}}),function(){return l.apply(this,arguments)}),setAndListenSelect2Change:function(){var t=this;this.select2.on("select2:select",function(e){e=e.params.data.$value||e.params.data.id,e=t.showNullOption&&e===u?null:e.toString();t.changeSelect(e)})}},watch:{"state.input.options.values":(s=C(function*(e){var t,n=this;yield this.$nextTick(),this.autocomplete||(t=void 0,e=(t=0===e.length||void 0===(e=e.find(function(e){return e.value==n.state.value}))?u:e.value)!=this.state.value,this.state.value=t,this.setValue(),e&&this.change())}),function(e){return s.apply(this,arguments)})},created:(o=C(function*(){var s=this,e=(this.unwatch,this.filterFieldsUnwatches,this.state.input.options),t=e.filter_fields,r=void 0===t?[]:t,t=e.relation_reference,n=e.relation_id,e=e.chain_filters,l=void 0!==e&&e;if(void 0!==t&&t&&Array.isArray(r)&&0<r.length){this.setLoading(!0),this.isFilterFieldsReady=!1;var e=w.default.getCurrentProject().getRelationById(n),t=e.referencedLayer,n=e.referencingLayer,e=e.fieldRef,u=e.referencingField,c=e.referencedField,d=_.default.getLayerById(n),p=_.default.getLayerById(t),i=p.getFields();if(null!==this.state.value)try{var a=(yield p.getFilterData({formatter:0,field:x({field:c[0],value:this.state.value})})).data,o=void 0===a?[]:a;this.state.input.options.values=((yield d.getFilterData({fformatter:u[0],order:u[0],ffield:r.map(function(t,e){var n=void 0===o[0].features[0].get(t)?"null":o[0].features[0].get(t);return s.filterFields.push({id:t,values:[{key:"["+i.find(function(e){return e.name===t}).label+"]",value:"null"}],value:n,disabled:l&&0<e&&"null"===s.filterFields[r[e-1]]}),x({field:t,value:n})}).join("|AND,")})).data||[]).map(function(e){var e=y(e,2),t=e[0];return{key:e[1],value:t}}),l?((yield p.getFilterData({unique:r[0],ordering:r[0],formatter:0})).forEach(function(e){return s.filterFields[0].values.push({key:e,value:e})}),(yield Promise.allSettled(r.slice(1).map(function(e,t){return p.getFilterData({unique:r[t+1],ordering:r[t+1],formatter:0,field:s.filterFields.slice(0,t+1).filter(function(e){return"null"!==e.value}).map(function(e){return x({field:e.id,value:e.value})}).join("|AND,")})}))).forEach(function(e,t){var n=e.status,e=e.value;"fulfilled"===n&&e.forEach(function(e){return s.filterFields[t+1].values.push({key:e,value:e})})})):(yield Promise.allSettled(r.map(function(e){return p.getFilterData({unique:e,ordering:e,formatter:0})}))).forEach(function(e,t){var n=e.status,e=e.value;"fulfilled"===n&&e.forEach(function(e){return s.filterFields[t].values.push({key:e,value:e})})})}catch(e){}else(yield Promise.allSettled(r.map(function(t,e){return s.filterFields.push({id:t,values:[{key:"["+i.find(function(e){return e.name===t}).label+"]",value:"null"}],value:"null",disabled:l&&0<e}),p.getFilterData({unique:t,formatter:0,ordering:t})}))).forEach(function(e,t){var n=e.status,e=e.value;"fulfilled"===n&&e.forEach(function(e){return s.filterFields[t].values.push({key:e,value:e})})});this.filterFieldsUnwatches=this.filterFields.map(function(e,o){return s.$watch(function(){return e.value},(t=C(function*(e){if(s.setLoading(!0),l){for(var t=o+1;t<s.filterFields.length;t++)s.filterFields[t].value="null",s.filterFields[t].values=[s.filterFields[t].values[0]],s.filterFields[t].disabled="null"===e;try{var n,r=s.filterFields.slice(0,o+1).filter(function(e){return"null"!==e.value}).map(function(e){return x({field:e.id,value:e.value})}).join("|AND,"),i=(yield p.getFilterData({field:r})).data,a=void 0===i?[]:i;a[0]&&a[0].features&&(n=[],a[0].features.forEach(function(e){n.push(e.get(c)),o<s.filterFields.length-1&&(e=e.get(s.filterFields[o+1].id),s.filterFields[o+1].values.push({key:e,value:e}))}))}catch(e){}}s.state.input.options.values=((yield d.getFilterData({fformatter:u[0],ordering:u[0],ffield:s.filterFields.filter(function(e){return"null"!==e.value}).map(function(e){return x({field:e.id,value:e.value})}).join("|AND,")})).data||[]).map(function(e){var e=y(e,2),t=e[0];return{key:e[1],value:t}}),0<s.state.input.options.values.length&&(s.state.value=s.state.input.options.values[0].value,s.select2.val(s.state.value).trigger("change"),yield s.changeSelect(s.state.value)),s.setLoading(!1)}),function(e){return t.apply(this,arguments)}));var t}),this.setLoading(!1),this.isFilterFieldsReady=!0}if("select_autocomplete"===this.state.input.type){e=this.state.input.options.layer_id;try{var f,h,g,v,m=b.default.getLayerById(e).getEditingLayer()||_.default.getLayerById(e);this.showPickLayer=m&&L.LayerTypes.TABLE!==m.getType(),this.showPickLayer&&(h=(f=this.state.input.options).key,g=f.value,v=f.layer_id,this.pickLayerInputService=new S({layer_id:v,fields:[g,h],pick_type:m.isStarted&&m.isStarted()?"map":null}))}catch(e){}}}),function(){return o.apply(this,arguments)}),mounted:(a=C(function*(){var r=this,e=(yield this.$nextTick(),$(this.$refs.select)),t=this.getLanguage(),n=void 0===this.state.dropdownParent&&$("#g3w-view-content");this.autocomplete?(this.select2=e.select2({minimumInputLength:1,dropdownParent:n,allowClear:this.showNullOption,placeholder:"",language:t,ajax:{delay:250,transport:function(e,t,n){e=e.data.term;$(".select2-results__option.loading-results").siblings().hide(),r.resetValues(),r.service.getData({search:e}).then(function(e){return t(e)}).catch(function(e){return n(e)})},processResults:function(e,t){return t.page=t.page||1,{results:e,pagination:{more:!1}}}}}),this.state.value&&(this.state.input.options.values.splice(0),yield this.service.getKeyByValue({search:this.state.value})),this.showNullOption&&this.select2.on("select2:unselect",function(){r.changeSelect(null)})):this.select2=e.select2({language:t,dropdownParent:n,minimumResultsForSearch:this.isMobile()?-1:null}),this.setAndListenSelect2Change(),this.setValue()}),function(){return a.apply(this,arguments)}),beforeDestroy:function(){this.pickLayerInputService&&(this.pickLayerInputService.clear(),this.pickLayerInputService=null),this.unwatch&&(this.unwatch(),this.unwatch=null),this.filterFieldsUnwatches&&(this.filterFieldsUnwatches.forEach(function(e){return e()}),this.filterFieldsUnwatches=null)}},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("baseinput",{attrs:{state:n.state}},[n.showPickLayer?r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.form.inputs.tooltips.picklayer",expression:"'sdk.form.inputs.tooltips.picklayer'"},{name:"disabled",rawName:"v-disabled",value:n.disabled,expression:"disabled"}],staticClass:"g3w-input-pick-layer skin-color",class:n.g3wtemplate.font.crosshairs,attrs:{slot:"label-action","data-placement":"top"},on:{click:function(e){return e.stopPropagation(),n.pickLayerValue(e)}},slot:"label-action"}):n._e(),n._v(" "),r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:n.disabled,expression:"disabled"}],attrs:{slot:"body",tabIndex:n.tabIndex},slot:"body"},[0<n.filterFields.length&&n.isFilterFieldsReady?r("div",{staticClass:"g3w-relation-reference-fields-content"},[n._l(n.filterFields,function(e,t){return[r("select",{directives:[{name:"select2",rawName:"v-select2",value:"filterFields",expression:"'filterFields'"}],ref:"filterField_"+e.id,refInFor:!0,staticClass:"form-control",staticStyle:{width:"100%"},attrs:{select2_value:e.value,indexItem:t,id:e.id,disabled:e.disabled}},n._l(e.values,function(e){var t=e.key,e=e.value;return r("option",{domProps:{value:n.getValue(e)}},[n._v("\n            "+n._s(t)+"\n          ")])}),0)]}),n._v(" "),r("divider")],2):n._e(),n._v(" "),r("select",{ref:"select",staticClass:"form-control",staticStyle:{width:"100%"}},[n.showNullOption?r("option",{domProps:{value:n.select2NullValue}}):n._e(),n._v(" "),n._l(n.state.input.options.values,function(e){var t=e.key,e=e.value;return r("option",{key:n.getValue(e),domProps:{value:n.getValue(e)}},[n._v("\n          "+n._s(t)+"\n      ")])})],2)]),n._v(" "),"error"===n.loadingState?r("p",{directives:[{name:"t",rawName:"v-t",value:"server_error",expression:"'server_error'"}],staticClass:"error-input-message",attrs:{slot:"message"},slot:"message"}):n._e()])},n.staticRenderFns=[],n._scopeId="data-v-6b3d29b0"},{"core/layers/layer":21,"gui/inputs/input":91,"gui/inputs/picklayer/service":99,mixins:290,"services/gui":302,"store/catalog-layers":311,"store/map-layers":315,"store/projects":317,utils:404,"vueify/lib/insert-css":2}],184:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),e=e("gui/inputs/input"),n.default={name:"input-slider-range",mixins:[e],watch:{"state.input.options.min":function(){this.service.changeInfoMessage()},"state.input.options.max":function(){this.service.changeInfoMessage()}}},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("baseinput",{attrs:{state:t.state}},[e("div",{attrs:{slot:"body"},slot:"body"},[e("span",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(t.state.value))]),t._v(" "),e("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!t.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:t.state.value,expression:"state.value"}],class:{"input-error-validation":t.notvalid},staticStyle:{width:"100%","padding-right":"5px"},attrs:{slot:"body",tabIndex:t.tabIndex,min:t.state.input.options.min,max:t.state.input.options.max,type:"range",step:t.state.input.options.step},domProps:{value:t.state.value},on:{change:t.change,__r:function(e){return t.$set(t.state,"value",e.target.value)}},slot:"body"})])])},n.staticRenderFns=[]},{"gui/inputs/input":91}],185:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),e=e("gui/inputs/input"),n.default={name:"input-text",mixins:[e]},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("baseinput",{attrs:{state:t.state}},[e("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!t.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:t.state.value,expression:"state.value"}],staticClass:"form-control",class:{"input-error-validation":t.notvalid},attrs:{slot:"body",placeholder:t.state.default,tabIndex:t.tabIndex,field:t.state.name,id:t.state.name},domProps:{value:t.state.value},on:{keyup:function(e){t.isMobile()?t.mobileChange(e):t.change()},input:function(e){e.target.composing||t.$set(t.state,"value",e.target.value)}},slot:"body"})])},n.staticRenderFns=[]},{"gui/inputs/input":91}],186:[function(e,t,n){e("vueify/lib/insert-css").insert("textarea[data-v-3ac5abe4]{resize:none;border:1px solid #ccc}");Object.defineProperty(n,"__esModule",{value:!0}),e=e("gui/inputs/input"),n.default={name:"input-textarea",mixins:[e]},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("baseinput",{attrs:{state:t.state}},[e("textarea",{directives:[{name:"disabled",rawName:"v-disabled",value:!t.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:t.state.value,expression:"state.value"}],class:{"input-error-validation":t.notvalid},staticStyle:{"max-width":"100%","min-width":"100%"},attrs:{slot:"body",placeholder:t.state.default,rows:"3",tabIndex:t.tabIndex},domProps:{value:t.state.value},on:{keydown:function(e){e.stopPropagation()},input:[function(e){e.target.composing||t.$set(t.state,"value",e.target.value)},t.change],change:t.change},slot:"body"})])},n.staticRenderFns=[],n._scopeId="data-v-3ac5abe4"},{"gui/inputs/input":91,"vueify/lib/insert-css":2}],187:[function(e,t,n){e("vueify/lib/insert-css").insert('button.ql-html{width:40px!important}button.ql-html:after{content:"html"}');function r(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),e("utils").getUniqueDomId;var i,e=e("gui/inputs/input"),n=(n.default={name:"input-html",mixins:[e],methods:{setupTableCustomTools:function(){var e=this.$el.querySelector(".ql-column-left"),e=(e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-caret-left-square" viewBox="0 0 16 16"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M10.205 12.456A.5.5 0 0 0 10.5 12V4a.5.5 0 0 0-.832-.374l-4.5 4a.5.5 0 0 0 0 .748l4.5 4a.5.5 0 0 0 .537.082z"/></svg>',e.title="Add column left",this.$el.querySelector(".ql-column-right")),e=(e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-caret-right-square" viewBox="0 0 16 16"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M5.795 12.456A.5.5 0 0 1 5.5 12V4a.5.5 0 0 1 .832-.374l4.5 4a.5.5 0 0 1 0 .748l-4.5 4a.5.5 0 0 1-.537.082z"/></svg>',e.title="Add column right",this.$el.querySelector(".ql-column-remove")),e=(e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-square" viewBox="0 0 16 16"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/></svg>',e.title="Remove column",this.$el.querySelector(".ql-row-above")),e=(e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-caret-up-square" viewBox="0 0 16 16"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M3.544 10.705A.5.5 0 0 0 4 11h8a.5.5 0 0 0 .374-.832l-4-4.5a.5.5 0 0 0-.748 0l-4 4.5a.5.5 0 0 0-.082.537z"/></svg>',e.title="Add row above",this.$el.querySelector(".ql-row-below")),e=(e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-caret-down-square" viewBox="0 0 16 16"><path d="M3.626 6.832A.5.5 0 0 1 4 6h8a.5.5 0 0 1 .374.832l-4 4.5a.5.5 0 0 1-.748 0l-4-4.5z"/><path d="M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm15 0a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2z"/></svg>',e.title="Add row below",this.$el.querySelector(".ql-row-remove"));e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-dash-square" viewBox="0 0 16 16"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M4 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 4 8z"/></svg>',e.title="Remove row"}},created:function(){this.edit_state={edit:!1,show_html:!1},this.state.edit_states||(this.state.edit_states=[]),this.state.edit_states.push(this.edit_state)},mounted:(i=r(function*(){var p=this;yield this.$nextTick(),this.quill=new Quill(this.$refs.quill_editor,{modules:{table:!0,toolbar:{container:[[{header:[1,2,3,4,5,6,!1]}],[{align:""},{align:"center"},{align:"right"},{align:"justify"}],[{color:[]},{background:[]}],["bold","italic","underline",{list:"ordered"},{list:"bullet"},"link","clean","html"],["table","column-left","column-right","column-remove","row-above","row-below","row-remove"]],handlers:{html:function(){p.edit_state.show_html=!p.edit_state.show_html,p.edit_state.show_html?p.quill.container.firstChild.innerText=p.quill.container.firstChild.innerHTML:p.quill.container.firstChild.innerHTML=p.quill.container.firstChild.innerText;var e=!0,t=!1,n=void 0;try{for(var r,i=p.$el.querySelectorAll(".ql-formats")[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var a=r.value,o=!0,s=!1,l=void 0;try{for(var u,c=a.children[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var d=u.value;d.classList.contains("ql-html")?d.classList.toggle("skin-color"):d.classList.toggle("g3w-disabled")}}catch(e){s=!0,l=e}finally{try{!o&&c.return&&c.return()}finally{if(s)throw l}}}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}},"column-left":function(){return p.table.insertColumnLeft()},"column-right":function(){return p.table.insertColumnRight()},"column-remove":function(){return p.table.deleteColumn()},"row-above":function(){return p.table.insertRowAbove()},"row-below":function(){return p.table.insertRowBelow()},"row-remove":function(){return p.table.deleteRow()}}}},theme:"snow"}),this.quill.container.firstChild.innerHTML=this.state.value,this.table=this.quill.getModule("table"),this.setupTableCustomTools(),this.handler=function(){p.state.value=p.edit_state.show_html?p.quill.container.firstChild.innerText:p.quill.container.firstChild.innerHTML,p.edit_state.edit=!0,p.change(),setTimeout(function(){return p.edit_state.edit=!1})},this.quill.on("text-change",this.handler)}),function(){return i.apply(this,arguments)}),watch:{"state.value":function(e){this.edit_state.edit||(this.edit_state.show_html?this.quill.container.firstChild.innerText=e:this.quill.container.firstChild.innerHTML=e)}},beforeDestroy:function(){this.quill.off("text-change",this.handler),this.handler=null,this.quill=null,this.edit_state.edit=!1,this.edit_state.show_html=!1}},t.exports.__esModule&&(t.exports=t.exports.default),"function"==typeof t.exports?t.exports.options:t.exports);n.render=function(){var e=this.$createElement,e=this._self._c||e;return e("baseinput",{directives:[{name:"disabled",rawName:"v-disabled",value:!this.editable,expression:"!editable"}],attrs:{state:this.state}},[e("div",{ref:"quill_editor",staticClass:"form-control",style:{border:this.novalid?"1px solid reed":"1px solid #ccc"},attrs:{slot:"body"},on:{keydown:function(e){e.stopPropagation()}},slot:"body"})])},n.staticRenderFns=[]},{"gui/inputs/input":91,utils:404,"vueify/lib/insert-css":2}],188:[function(e,t,n){function r(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),i=e("mixins"),s=e("gui/inputs/input"),l=e("utils").getUniqueDomId,n.default={name:"input-unique",mixins:[s,i.selectMixin],data:function(){return{id:"unique_"+l()}},watch:{"state.input.options.values":(o=r(function*(e){this.state.value=this.state.value||null,null!==this.state.value&&-1===e.indexOf(this.state.value)&&this.service.addValueToValues(this.state.value),yield this.$nextTick(),this.state.value&&this.select2.val(this.state.value).trigger("change")}),function(e){return o.apply(this,arguments)})},mounted:(a=r(function*(){var t=this;yield this.$nextTick(),this.state.input.options.editable&&(this.select2=$("#"+this.id).select2({dropdownParent:$("#g3w-view-content"),tags:!0,language:this.getLanguage()}),this.select2.val(this.state.value).trigger("change"),this.select2.on("select2:select",function(e){e=e.params.data.$value||e.params.data.id;t.changeSelect(e)}))}),function(){return a.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default);var i,a,o,s,l,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("baseinput",{attrs:{state:t.state}},[n("select",{directives:[{name:"disabled",rawName:"v-disabled",value:!t.editable,expression:"!editable"}],staticClass:"form-control",staticStyle:{width:"100%"},attrs:{slot:"body",id:t.id,tabIndex:t.tabIndex},slot:"body"},[n("option",{attrs:{value:"null"}}),t._v(" "),t._l(t.state.input.options.values,function(e){return n("option",{key:e,domProps:{value:t.getValue(e)}},[t._v(t._s(t.getValue(e)))])})],2)])},e.staticRenderFns=[]},{"gui/inputs/input":91,mixins:290,utils:404}],189:[function(e,t,n){var r,i,a;e("vueify/lib/insert-css").insert("li .item-text[data-v-41231f64]{font-weight:700}");function o(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),s=e("store/catalog-layers"),i=(s=s)&&s.__esModule?s:{default:s},a=e("app/eventbus"),n.default={name:"Layeropacitypicker",props:{layer:{type:Object,required:!0}},data:function(){return{menu:{show:!1,top:0,left:0,overflowY:"none",style:null,default:null}}},methods:{setLayerOpacity:function(e){var t=e.id,t=void 0===t?this.layer.id:t,e=e.value;this.layer.opacity!=e&&(this.layer.opacity=e,e=i.default.getLayerById(t))&&(a.CatalogEventBus.$emit("layer-change-opacity",{layerId:t}),e.change())},showLayerOpacityMenu:(r=o(function*(e,t){this.$emit("show-menu-item",{menu:this.menu,bool:e,evt:t})}),function(e,t){return r.apply(this,arguments)})},created:function(){this.$emit("init-menu-item",{layerOpacity:this.menu})}},t.exports.__esModule&&(t.exports=t.exports.default);var s="function"==typeof t.exports?t.exports.options:t.exports;s.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",{on:{mouseleave:function(e){return e.target!==e.currentTarget?null:t.showLayerOpacityMenu(!1,e)},mouseover:function(e){return e.target!==e.currentTarget?null:t.showLayerOpacityMenu(!0,e)}}},[e("span",{staticClass:"menu-icon skin-color-dark",class:t.g3wtemplate.getFontClass("slider")}),t._v(" "),e("span",{directives:[{name:"t",rawName:"v-t",value:"catalog_items.contextmenu.layer_opacity",expression:"'catalog_items.contextmenu.layer_opacity'"}],staticClass:"item-text"}),t._v(" "),e("span",{staticClass:"menu-icon",class:t.g3wtemplate.getFontClass("arrow-right"),staticStyle:{position:"absolute",right:"0","margin-top":"3px"}}),t._v(" "),e("ul",{directives:[{name:"show",rawName:"v-show",value:t.layer&&t.menu.show,expression:"layer && menu.show"}],style:{top:t.menu.top+"px",left:t.menu.left-15+"px",maxHeight:t.menu.maxHeight+"px",overflowY:t.menu.overflowY,paddingLeft:0,position:"fixed",backgroundColor:"#FFF",color:"#000"}},[e("li",[e("range",{attrs:{value:t.layer.opacity,min:0,max:100,step:1,sync:!1,showValue:!0,unit:"%"},on:{"change-range":t.setLayerOpacity}})],1)])])},s.staticRenderFns=[],s._scopeId="data-v-41231f64"},{"app/eventbus":46,"store/catalog-layers":311,"vueify/lib/insert-css":2}],190:[function(e,t,n){var r,i;e("vueify/lib/insert-css").insert(".g3w-map-controls-left-bottom[data-v-70e886b4]{position:absolute;bottom:75px;left:10px;z-index:1}");function a(e){return e&&e.__esModule?e:{default:e}}function o(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),i=a(e("components/MapAddLayer.vue")),e=a(e("components/MapFooter.vue")),n.default={name:"g3w-map",data:function(){var e=this.$options.service;return{target:this.$options.service.target,maps_container:this.$options.service.maps_container,hidemaps:e.state.hidemaps,map_info:e.state.map_info,service:e}},components:{addlayer:i.default,MapFooter:e.default},computed:{mapcontrolsalignement:function(){return this.service.state.mapcontrolsalignement},disableMapControls:function(){return this.service.state.mapControl.disabled}},methods:{showHideControls:function(){this.service.getMapControls().forEach(function(e){return"scaleline"!==e.type&&e.control.showHide()})}},mounted:(r=o(function*(){var i=this;this.crs=this.service.getCrs(),yield this.$nextTick(),this.service.setMapControlsContainer($(this.$refs["g3w-map-controls"])),this.service.onafter("addHideMap",o(function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.ratio,n=e.layers,n=void 0===n?[]:n,r=e.mainview,r=void 0!==r&&r,e=e.switchable,e=void 0!==e&&e;yield i.$nextTick(),i.service._addHideMap({ratio:t,layers:n,mainview:r,switchable:e})}))}),function(){return r.apply(this,arguments)}),destroyed:function(){this.service.clear()}},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:e.maps_container}},[e._l(e.hidemaps,function(e){return n("div",{key:e.id,staticClass:"g3w-map hidemap",attrs:{id:e.id}})}),e._v(" "),n("div",{staticClass:"g3w-map",attrs:{id:e.target}},[n("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.disableMapControls,expression:"disableMapControls"}],ref:"g3w-map-controls",staticClass:"g3w-map-controls",class:e.mapcontrolsalignement,staticStyle:{display:"flex"}}),e._v(" "),e.map_info.info?n("div",{ref:"g3w-map-info",style:e.map_info.style,attrs:{id:"g3w-map-info"}},[e._v("\n      "+e._s(e.map_info.info)+"\n    ")]):e._e(),e._v(" "),e._m(0),e._v(" "),n("addlayer",{attrs:{service:e.service}}),e._v(" "),n("div",{staticClass:"g3w-map-controls-left-bottom"})],1),e._v(" "),n("map-footer",{attrs:{service:e.service}})],2)},n.staticRenderFns=[function(){var e=this.$createElement,e=this._self._c||e;return e("div",{staticStyle:{display:"none"}},[e("div",{attrs:{id:"marker"}})])}],n._scopeId="data-v-70e886b4"},{"components/MapAddLayer.vue":191,"components/MapFooter.vue":195,"vueify/lib/insert-css":2}],191:[function(e,t,n){function r(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),i=e("vue-color"),a=e("app/constant"),o=e("utils/createVectorLayerFromFile"),s=e("utils/createStyleFunctionToVectorLayer"),p=e("g3w-ol/projection/projections"),f=["zip","geojson","GEOJSON","kml","kmz","KMZ","KML","json","gpx","gml","csv"],h=[",",";"],i.Chrome.mounted=r(function*(){yield this.$nextTick(),$(".vue-color__chrome__toggle-btn").remove(),$(".vue-color__editable-input__label").remove(),$(".vue-color__chrome__saturation-wrap").css("padding-bottom","100px"),$(".vue-color__chrome").css({"box-shadow":"0 0 0 0",border:"1px solid #97A1A8"})}),n.default={name:"map-add-layer",props:["service"],data:function(){var t=this.service.getCrs();return void 0===a.EPSG.find(function(e){return t===e})&&a.EPSG.unshift(t),{vectorLayer:null,options:a.EPSG,error:!1,error_message:null,position:null,loading:!1,fields:[],field:null,accepted_extension:f.map(function(e){return"."+e}).join(","),csv:{valid:!1,loading:!1,headers:[],x:null,y:null,separators:h,separator:h[0]},layer:{name:null,type:null,crs:null,mapCrs:null,color:{hex:"#194d33",rgba:{r:25,g:77,b:51,a:1},a:1},data:null,visible:!0,title:null,id:null,external:!0}}},components:{"chrome-picker":i.Chrome},computed:{csv_extension:function(){return"csv"===this.layer.type},add:function(){return this.layer.data||this.csv.valid}},methods:{setLayerMapPosition:function(e){this.position=e},setError:function(e){this.error_message="sdk.errors."+e,this.error=!0},clearError:function(){this.error=!1,this.error_message=null},onChangeColor:function(e){this.layer.color=e},onAddLayer:(d=r(function*(r){var a=this,i=new FileReader,e=r.target.files[0].name,t=(t=r.target.files[0].name.split("."))[t.length-1].toLowerCase(),o=$(this.$refs.input_file);if(f.includes(t))if(this.clearError(),this.layer.mapCrs=this.service.getEpsg(),this.layer.name=e,this.layer.title=e,this.layer.id=e,this.layer.type=t,"csv"===this.layer.type)i.onload=function(e){o.val(null);function t(e){var t=null,n=(a.csv.loading=!0,r.split(e));return 1<n.length?(a.csv.headers=n,a.fields=n,a.csv.x=n[0],a.csv.y=n[1],t={headers:n,separator:e,x:a.csv.x,y:a.csv.y,values:i},a.csv.valid=!0):(a.csv.headers=a.fields=[],a.vectorLayer=null,a.csv.valid=!1,a.fields.splice(0)),a.csv.loading=!1,t}var e=e.target.result.split(/\r\n|\n/).filter(function(e){return e}),e=(e=e,Array.isArray(e)?e:Array.from(e)),r=e[0],i=e.slice(1);a.layer.data=t(a.csv.separator),a.$watch("csv.separator",function(e){return a.layer.data=t(e)})},i.readAsText(r.target.files[0]);else{e=new Promise(function(t,e){var n;["zip","kmz"].includes(a.layer.type)?(n=r.target.files[0],o.val(null),t(n)):(i.onload=function(e){e=e.target.result;o.val(null),t(e)},i.readAsText(r.target.files[0]))});this.layer.data=yield e;try{this.fields.splice(0),yield this.createVectorLayer(),this.fields=this.vectorLayer.get("_fields")}catch(e){}}else this.setError("unsupported_format")}),function(e){return d.apply(this,arguments)}),createVectorLayer:(c=r(function*(){try{this.vectorLayer=yield(0,o.createVectorLayerFromFile)(this.layer),yield this.$nextTick()}catch(e){this.setError("add_external_layer")}}),function(){return c.apply(this,arguments)}),addLayer:(u=r(function*(){if(this.layer.data||this.csv.valid){var e=this.layer.crs;try{try{yield p.registerProjection(e)}catch(e){return void this.setError(e)}this.loading=!0,this.vectorLayer=yield(0,o.createVectorLayerFromFile)(this.layer),this.vectorLayer.setStyle((0,s.createStyleFunctionToVectorLayer)({color:this.layer.color,field:this.field})),yield this.service.addExternalLayer(this.vectorLayer,{crs:this.layer.crs,type:this.layer.type,position:this.position}),$(this.$refs.modal_addlayer).modal("hide"),this.clear()}catch(e){this.setError("add_external_layer")}this.loading=!1}}),function(){return u.apply(this,arguments)}),clear:function(){this.clearError(),this.loading=!1,this.layer.name=null,this.layer.title=null,this.layer.id=null,this.layer.type=null,this.layer.crs=this.service.getCrs(),this.layer.color={hex:"#194d33",rgba:{r:25,g:77,b:51,a:1},a:1},this.layer.data=null,this.vectorLayer=null,this.fields=[],this.field=null,this.csv.valid=!1},clearLayer:function(){this.clear()}},watch:{"csv.x":function(e){[void 0,null].includes(e)||(this.layer.data.x=e)},"csv.y":function(e){[void 0,null].includes(e)||(this.layer.data.y=e)}},created:function(){var e=this;this.layer.crs=this.service.getCrs(),this.service.on("addexternallayer",function(){return e.modal.modal("show")})},mounted:(l=r(function*(){var e=this;yield this.$nextTick(),this.modal=$("#modal-addlayer").modal("hide"),this.modal.on("hide.bs.modal",function(){return e.clear()})}),function(){return l.apply(this,arguments)}),beforeDestroy:function(){this.clear(),this.modal.modal("hide"),this.modal.remove()}},t.exports.__esModule&&(t.exports=t.exports.default);var i,a,o,s,l,u,c,d,p,f,h,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{ref:"modal_addlayer",staticClass:"modal fade",attrs:{id:"modal-addlayer",role:"dialog"}},[t("div",{staticClass:"modal-dialog"},[t("div",{staticClass:"modal-content"},[t("div",{staticClass:"modal-header"},[t("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal"}},[n._v("")]),n._v(" "),t("h4",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.header",expression:"'mapcontrols.add_layer_control.header'"}],staticClass:"modal-title",staticStyle:{"font-weight":"bold"}})]),n._v(" "),t("div",{staticClass:"modal-body"},[t("div",{staticClass:"form-group"},[t("label",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.select_projection",expression:"'mapcontrols.add_layer_control.select_projection'"}],attrs:{for:"projection-layer"}}),n._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:n.layer.crs,expression:"layer.crs"}],staticClass:"form-control",attrs:{id:"projection-layer"},on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});n.$set(n.layer,"crs",e.target.multiple?t:t[0])}}},n._l(n.options,function(e){return t("option",{domProps:{value:e}},[n._v(n._s(e))])}),0)]),n._v(" "),t("layerspositions",{on:{"layer-position-change":function(e){return n.setLayerMapPosition(e)}}}),n._v(" "),t("p",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.select_color",expression:"'mapcontrols.add_layer_control.select_color'"}],staticStyle:{"font-weight":"700"}}),n._v(" "),t("chrome-picker",{staticStyle:{width:"100%",margin:"auto"},on:{input:n.onChangeColor},model:{value:n.layer.color,callback:function(e){n.$set(n.layer,"color",e)},expression:"layer.color"}}),n._v(" "),t("bar-loader",{attrs:{loading:n.loading}}),n._v(" "),t("form",{attrs:{id:"addcustomlayer"}},[t("input",{ref:"input_file",attrs:{type:"file",title:" ",accept:n.accepted_extension},on:{change:function(e){return n.onAddLayer(e)}}}),n._v(" "),t("h4",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.drag_layer",expression:"'mapcontrols.add_layer_control.drag_layer'"}]}),n._v(" "),n.layer.name?t("h4",{staticClass:"skin-color",staticStyle:{"font-weight":"bold"}},[n._v(n._s(n.layer.name))]):n._e(),n._v(" "),t("div",[t("i",{staticClass:"fa-5x",class:n.g3wtemplate.getFontClass("cloud-upload"),attrs:{"aria-hidden":"true"}})]),n._v(" "),t("p",{staticStyle:{"font-weight":"bold"}},[n._v("[.gml, .geojson, .kml, .kmz ,.gpx, .csv, .zip(shapefile)]")])]),n._v(" "),n.csv_extension?t("div",{staticStyle:{padding:"15px",border:"1px solid grey","border-radius":"3px"}},[t("bar-loader",{attrs:{loading:n.csv.loading}}),n._v(" "),t("div",{staticClass:"select_field"},[t("label",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.select_csv_separator",expression:"'mapcontrols.add_layer_control.select_csv_separator'"}],attrs:{for:"g3w-select-field-layer"}}),n._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:n.csv.separator,expression:"csv.separator"}],staticClass:"form-control",attrs:{id:"g3w-select-separator"},on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});n.$set(n.csv,"separator",e.target.multiple?t:t[0])}}},n._l(n.csv.separators,function(e){return t("option",{key:e,domProps:{value:e}},[n._v(n._s(e))])}),0),n._v(" "),t("div",{staticClass:"select_field",class:{"g3w-disabled":!n.csv.headers||0===n.csv.headers.length}},[t("label",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.select_csv_x_field",expression:"'mapcontrols.add_layer_control.select_csv_x_field'"}],attrs:{for:"g3w-select-x-field"}}),n._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:n.csv.x,expression:"csv.x"}],staticClass:"form-control",attrs:{id:"g3w-select-x-field"},on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});n.$set(n.csv,"x",e.target.multiple?t:t[0])}}},n._l(n.csv.headers,function(e){return t("option",{key:e,domProps:{value:e}},[n._v(n._s(e))])}),0)]),n._v(" "),t("div",{staticClass:"select_field",class:{"g3w-disabled":!n.csv.headers||0===n.csv.headers.length}},[t("label",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.select_csv_y_field",expression:"'mapcontrols.add_layer_control.select_csv_y_field'"}],attrs:{for:"g3w-select-y-field"}}),n._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:n.csv.y,expression:"csv.y"}],staticClass:"form-control",attrs:{id:"g3w-select-y-field"},on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});n.$set(n.csv,"y",e.target.multiple?t:t[0])}}},n._l(n.csv.headers,function(e){return t("option",{key:e,domProps:{value:e}},[n._v(n._s(e))])}),0)])])],1):n._e(),n._v(" "),t("div",{staticClass:"select_field",class:{"g3w-disabled":!n.fields||0===n.fields.length}},[t("label",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.select_field_to_show",expression:"'mapcontrols.add_layer_control.select_field_to_show'"}],attrs:{for:"g3w-select-field-layer"}}),n._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:n.field,expression:"field"}],staticClass:"form-control",attrs:{id:"g3w-select-field-layer"},on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});n.field=e.target.multiple?t:t[0]}}},[t("option",{domProps:{value:null}},[n._v("---")]),n._v(" "),n._l(n.fields,function(e){return t("option",{key:e,domProps:{value:e}},[n._v(n._s(e))])})],2)]),n._v(" "),n.error?t("div",{directives:[{name:"t",rawName:"v-t",value:n.error_message,expression:"error_message"}],staticStyle:{"font-weight":"bold","font-size":"1.2em","background-color":"orange",padding:"10px","text-align":"center"}}):n._e(),n._v(" "),t("div",{staticClass:"modal-footer"},[t("button",{directives:[{name:"t",rawName:"v-t",value:"add",expression:"'add'"}],staticClass:"btn btn-success pull-left",attrs:{type:"button",disabled:!n.add},on:{click:function(e){return e.stopPropagation(),n.addLayer(e)}}}),n._v(" "),t("button",{directives:[{name:"t",rawName:"v-t",value:"close",expression:"'close'"}],staticClass:"btn btn-default",attrs:{type:"button","data-dismiss":"modal"}})])],1)])])])},e.staticRenderFns=[]},{"app/constant":5,"g3w-ol/projection/projections":76,"utils/createStyleFunctionToVectorLayer":354,"utils/createVectorLayerFromFile":356,"vue-color":"vue-color"}],192:[function(e,t,n){function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){var n=e.className,r=e.customClass,i=e.tipLabel,a=e.label;return{functional:!0,render:function(e){var t;return e("div",{class:(o(t={},n,!!n),o(t,"ol-unselectable",!0),o(t,"ol-control",!0),t)},[e("button",{attrs:{type:"button"},directives:[{name:"t-tooltip",value:i}]},[a,e("i",{class:o({},r,!!r)})])])}}}},{}],193:[function(e,t,n){var a,c,d,p,s,o,l,f,r,u,h,g,i,v,m,y,_;e("vueify/lib/insert-css").insert('li[data-v-547bdae4]:not(.skin-background-color){display:flex;align-items:center;gap:10px}li.gcd-icon-poi .gcd-city[data-v-547bdae4],li.gcd-icon-poi .gcd-country[data-v-547bdae4],li.gcd-icon-poi .gcd-road[data-v-547bdae4],li.gcd-icon-road .gcd-icon[data-v-547bdae4],li.gcd-icon-road .gcd-name[data-v-547bdae4],li.gcd-icon-road .gcd-type[data-v-547bdae4]{display:none}#gcd-search[data-v-547bdae4]{z-index:1;width:2.5em;height:100%;border-radius:0;background-color:var(--skin-color,#fff)}#gcd-trash[data-v-547bdae4],#markers-visibility-layer[data-v-547bdae4],#show-markers-results[data-v-547bdae4]{z-index:1;border-radius:0!important;color:#fff;border-left:1px solid #fff}#gcd-trash[data-v-547bdae4]{color:red}#gcd-input-query[data-v-547bdae4]{font-weight:700}.gcd-txt-reset[data-v-547bdae4]:after{content:"\\d7";display:inline-block;font-weight:700;font-size:2em;cursor:pointer;color:var(--skin-color)}.gcd-txt-reset[data-v-547bdae4]{z-index:1;width:2.5em;height:100%;line-height:100%;border:none;background-color:transparent;display:inline-block;vertical-align:middle;outline:0;cursor:pointer}.gcd-txt-input[data-v-547bdae4]:focus{outline:none}.gcd-txt-input[data-v-547bdae4]{z-index:1;border:0;width:100%;height:100%;padding:5px;text-indent:6px;background-color:transparent;font-family:inherit;font-size:1em}.gcd-txt-control[data-v-547bdae4]{position:relative;display:flex;justify-content:flex-end;height:40px;background-color:#fff;overflow:hidden;border-radius:2px;box-shadow:0 2px 4px rgba(0,0,0,.2);width:100%;border:2px solid var(--skin-color)}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.gcd-road[data-v-547bdae4]{font-size:.875em;font-weight:500}.gcd-city[data-v-547bdae4]{font-size:1em;font-weight:700}.gcd-country[data-v-547bdae4]{font-size:.75em}.gcd-spin[data-v-547bdae4]:after{animation:spin .7s linear infinite}.gcd-hidden[data-v-547bdae4]{display:none!important}li.skin-background-color[data-v-547bdae4]{position:sticky;top:0}li.selected[data-v-547bdae4]{background-color:#f7fabf!important}li.gcd-noresult[data-v-547bdae4]:hover{background-color:transparent!important}li.gcd-noresult[data-v-547bdae4]{font-weight:700;color:#384247;margin:10px;border-bottom:0!important}\n.ol-geocoder{box-sizing:border-box;position:absolute;max-width:300px;height:4.375em;top:7px;left:45px;width:50%;height:6px;font-size:1.1em}@media (max-width:767px){.ol-geocoder{left:10px}}.ol-geocoder>ul>li:hover{background-color:#eee}.ol-geocoder>ul>li{width:100%;overflow:hidden;padding:0;min-height:30px;padding-left:3px;border-bottom:2px solid var(--skin-color);min-height:20px;padding:10px}.ol-geocoder>ul{box-shadow:0 3px 5px rgba(0,0,0,.3);border-radius:3px!important;width:100%;max-height:200px;padding:0;margin-top:3px;background-color:#fff;border-top:none;overflow-x:hidden;overflow-y:auto;transition:max-height .3s ease-in;margin-bottom:0}.ol-geocoder>ul>li>a{display:block;text-decoration:none;padding:3px 5px;color:#000}.ol-geocoder>ul>li:last-child{border-bottom:0!important}');function b(e){return e&&e.__esModule?e:{default:e}}function w(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},d=b(e("services/gui")),p=b(e("store/application-state")),s=b(e("components/QueryResultsActionChooseLayer.vue")),o=e("store"),l=b(e("store/catalog-layers")),f=e("utils"),r=e("utils/flattenObject"),u=e("utils/addZValueToOLFeatureGeometry"),h=e("utils/isPointGeometryType"),g=e("utils/convertSingleMultiGeometry"),v=e("g3w-ol/projection/projections"),m=window.initConfig.group.mapcontrols.geocoding?window.initConfig.group.mapcontrols.geocoding.providers:{},Object.keys(m).forEach(function(e){var t=document.createElement("script");t.src=window.initConfig.staticurl+"client/geocoding-providers/"+e+".js",t.async=!0,document.head.appendChild(t)}),y=new ol.layer.Vector({id:"__g3w_marker",name:"Geocoding",source:new ol.source.Vector,style:function(e){return"__g3w_marker_coordinates"===e.getId()?new ol.style.Style({text:new ol.style.Text({offsetY:-15,text:"",font:'900 3em "Font Awesome 5 Free"',stroke:new ol.style.Stroke({color:"red",width:3}),fill:new ol.style.Fill({color:"rgba(255, 0,0, 0.7)"})})}):[new ol.style.Style({image:new ol.style.Icon({opacity:1,src:"/static/client/images/pushpin.svg",scale:.8})}),new ol.style.Style({image:new ol.style.RegularShape({stroke:new ol.style.Stroke({color:[0,0,0,0]}),points:4,radius:50,angle:Math.PI/4})})]}}),_=!1,n.default={data:function(){return{results:[],disabled:!1,results_panel_open:!1}},props:{placeholder:{type:String,required:!0},noresults:{type:String,required:!0},limit:{type:Number,required:!0},viewbox:{required:!0},mapCrs:{required:!0},providers:{type:Object,default:{}}},computed:{is_layer_visible:function(){return y.getVisible()},features:function(){return y.getSource().getFeatures()},has_providers:function(){return 0<Object.keys(this.providers).length},extent:function(){return ol.proj.transformExtent(0<Object.keys(this.providers).filter(function(e){return"nominatim"!=e}).length?d.default.getService("map").getMapExtent():this.viewbox,this.mapCrs,"EPSG:4326")}},methods:{_showMarker:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=d.default.getService("map");e=t?ol.proj.transform(e,"EPSG:4326",n.getEpsg()):e,n.zoomToGeometry(new ol.geom.Point(e))},_hideMarker:function(){y.getSource().clear(),!1===this.is_layer_visible&&this.toggleLayerVisibility()},toggleLayerVisibility:function(){y.setVisible(!this.is_layer_visible)},clearResults:function(){this.$data.results.splice(0),y.getSource().getFeatureById("__g3w_marker_coordinates")&&y.getSource().removeFeature(y.getSource().getFeatureById("__g3w_marker_coordinates"))},clearMarkers:function(){_=!0,this._hideMarker(),this.$data.results.forEach(function(e){return e.__selected=!1});var t=d.default.getService("queryresults").getState().layers.find(function(e){return e.id===y.get("id")});t&&t.features.forEach(function(e){d.default.getService("queryresults").removeFeatureLayerFromResult(t,e)}),_=!1},clear:function(){this.clearResults(),this.clearMarkers()},query:function(l){var n,u=this;return new Promise((n=w(function*(e,t){function n(e){return"Number"===(0,f.toRawType)(e)&&!Number.isNaN(e)}var r=null,i=!1,a=(l||"").split(","),a=c(a,3),o=a[0],s=a[1],a=a[2],a=a&&(yield v.registerProjection("EPSG:"+a.trim()));n(+o)&&n(+s)&&(r=[+o,+s]);try{a&&(r=ol.proj.transform(r,a.getCode(),"EPSG:4326"),i=!0)}catch(e){}r&&((o=y.getSource()).getFeatureById("__g3w_marker_coordinates")&&o.removeFeature(o.getFeatureById("__g3w_marker_coordinates")),(s=new ol.Feature({geometry:new ol.geom.Point(i?ol.proj.transform(r,"EPSG:4326",d.default.getService("map").getEpsg()):r),lon:r[0],lat:r[1]})).setId("__g3w_marker_coordinates"),y.getSource().addFeature(s),u._showMarker(r,i),e(r)),r||(u.clearResults(),u.$refs.reset.classList.add("gcd-spin"),a=yield Promise.allSettled(Object.entries(u.providers).map(function(e){var e=c(e,2),t=e[0],e=e[1],e=void 0===e?{}:e;return m[t].fetch({url:e.url,icon:e.icon,query:l,lang:p.default.language||"it-IT",limit:u.limit,extent:u.extent})})),u._showResults(a.filter(function(e){return"fulfilled"===e.status})),u.$refs.reset.classList.remove("gcd-spin"))}),function(e,t){return n.apply(this,arguments)}))},_showResults:function(){var n=this;(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(t){n.$data.results.push({__heading:!0,provider:t.value.provider,label:n.providers[t.value.provider].label||t.value.label}),t.value.results&&t.value.results.length?t.value.results.forEach(function(e){n.$data.results.push((0,r.flattenObject)(a({},e,{provider:t.value.provider,__uid:(0,f.uniqueId)(),__icon:n.providers[t.value.provider].icon||t.value.icon,__selected:!1})))}):n.$data.results.push({__no_results:!(t.value.results&&t.value.results.length)})})},onQuery:function(e){"Enter"!==e.key&&13!==e.which&&13!==e.keyCode||(e.preventDefault(),this.query(e.target.value.trim()))},onValue:function(e){this.$refs.reset.classList.toggle("gcd-hidden",0===e.target.value.trim().length)},onReset:function(){this.$refs.input.focus(),this.$refs.input.value="",this.$refs.reset.classList.add("gcd-hidden"),this.clearResults()},_removeItem:function(t){var e,n=(this.$data.results||[]).find(function(e){return t===e.__uid});this.features.length&&(e=y.getSource()).removeFeature(e.getFeatureById(t)),n&&(n.__selected=!1),0===this.features.length&&this._hideMarker(),_||this.showMarkerResults(void 0,0===this.features.length)},_createOlMarker:function(e){var t=e.__uid,n=(e.__icon,e.__selected,function(e,t){var n,r={};for(n in e)0<=t.indexOf(n)||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(e,["__uid","__icon","__selected"])),e=new ol.Feature(a({geometry:new ol.geom.Point(ol.proj.transform([parseFloat(e.lon),parseFloat(e.lat)],"EPSG:4326",d.default.getService("map").getEpsg()))},n));return e.setId(t),e},onItemClick:function(e,t){if(t.lat&&t.lon){e.preventDefault();try{var n,r=y.getSource();r.getFeatureById(t.__uid)?this._removeItem(t.__uid):(n=this._createOlMarker(t),r.addFeature(n),d.default.getService("map").zoomToFeatures([n]),t.__selected=!0,this.showMarkerResults([n]))}catch(e){}}},showMarkerResults:function(e){this.$data.results_panel_open&&(1<arguments.length&&void 0!==arguments[1]&&arguments[1])?d.default.closeContent():(d.default.getCurrentContent()&&d.default.closeContent(),d.default.showQueryResults("Geocoding",{data:[{layer:y,features:e||y.getSource().getFeatures()}]}),this.$data.results_panel_open=!0)},_editItem:(i=w(function*(e,r){var t=o.PluginsRegistry.getPlugin("editing");if(t){this.$data.disabled=!0;try{var n=l.default.getLayerById(e).getGeometryType(),i=(0,u.addZValueToOLFeatureGeometry)({geometryType:n,feature:new ol.Feature(a({},Object.entries(r.attributes).reduce(function(e,t){return a({},e,(e={},n=t[0].replace(r.attributes.provider+"_","").toLowerCase(),t=t[1],n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e));var n},{}),r.attributes,{geometry:(0,g.convertSingleMultiGeometry)(r.geometry,n)}))});yield t.getApi().addLayerFeature({layerId:e,feature:i})}catch(e){}this.$data.disabled=!1}}),function(e,t){return i.apply(this,arguments)})},created:function(){var a=this,o=d.default.getService("queryresults"),e=d.default.getService("map");e.getMap().addLayer(y),e.on("set-layer-zindex",function(e){var t=e.layer,e=e.zindex;t.get("id")!==y.get("id")&&y.setZIndex(e+1)}),o.registerVectorLayer(y),d.default.on("closecontent",function(){a.$data.results_panel_open=!1}),d.default.onafter("setContent",function(){a.$data.results_panel_open&&(a.$data.results_panel_open=!1)}),o.onafter("removeFeatureLayerFromResult",function(e,t){y.get("id")===e.id&&a._removeItem(t.id)}),o.onafter("addActionsForLayers",function(e,t){var i,t=t.find(function(e){return y.get("id")===e.id});!t||(i=l.default.getLayers({EDITABLE:!0,GEOLAYER:!0}).filter(function(e){return(0,h.isPointGeometryType)(e.getGeometryType())}).map(function(e){return{id:e.getId(),name:e.getName(),inediting:e.isInEditing()}})).find(function(e){return e.inediting})||o.addCurrentActionToolsLayer({id:s.default.name,layer:t,action:{id:"choose_layer",class:d.default.getFontClass("pencil"),state:o.createActionState({layer:t}),toggleable:!0,hint:"Choose a layer",cbk:function(e,t,n,r){1===i.length?a._editItem(i[0].id,t):(n.state.toggled[r]=!n.state.toggled[r],o.setCurrentActionLayerFeatureTool({layer:e,index:r,action:n,component:n.state.toggled[r]?s.default:null}))}},config:{layers:i,icon:"pencil",label:"mapcontrols.geocoding.choose_layer",nolayers:"mapcontrols.geocoding.nolayers",cbk:a._editItem}})})},destroyed:function(){d.default.getService("queryresults").unregisterVectorLayer(y)}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var n=this,e=n.$createElement,r=n._self._c||e;return n.has_providers?r("div",{class:["ol-geocoder",{"g3w-disabled":n.$data.disabled}]},[r("div",{staticClass:"gcd-txt-control"},[r("input",{directives:[{name:"t-placeholder",rawName:"v-t-placeholder",value:n.placeholder,expression:"placeholder"}],ref:"input",staticClass:"gcd-txt-input",attrs:{type:"text",id:"gcd-input-query",autocomplete:"off"},on:{keyup:n.onQuery,input:n.onValue}}),n._v(" "),r("button",{ref:"reset",staticClass:"gcd-txt-reset gcd-hidden",attrs:{type:"button",id:"gcd-input-reset",title:"Reset search"},on:{click:function(e){return e.stopPropagation(),n.onReset(e)}}}),n._v(" "),r("button",{staticClass:"btn",attrs:{type:"button",id:"gcd-search",title:"Submit search"},on:{click:function(e){return e.stopPropagation(),n.query(n.$refs.input.value)}}},[r("i",{class:n.g3wtemplate.getFontClass("search"),staticStyle:{color:"#fff"},attrs:{"aria-hidden":"true"}})]),n._v(" "),0<n.features.length?r("button",{staticClass:"btn skin-background-color",attrs:{type:"button",id:"gcd-trash",title:"Clear markers selection"},on:{click:function(e){return e.stopPropagation(),n.clearMarkers(e)}}},[r("i",{class:n.g3wtemplate.getFontClass("trash"),attrs:{"aria-hidden":"true"}})]):n._e(),n._v(" "),0<n.features.length?r("button",{staticClass:"btn skin-background-color",attrs:{type:"button",id:"markers-visibility-layer",title:"Toggle markers visibility"},on:{click:function(e){return e.stopPropagation(),n.toggleLayerVisibility(e)}}},[r("i",{class:n.g3wtemplate.getFontClass(n.is_layer_visible?"eye-close":"eye"),attrs:{"aria-hidden":"true"}})]):n._e(),n._v(" "),0<n.features.length?r("button",{staticClass:"btn skin-background-color",attrs:{type:"button",id:"show-markers-results",title:"Toggle sidebar panel"},on:{click:function(e){return e.stopPropagation(),n.showMarkerResults(void 0,!0)}}},[r("code",{style:{opacity:n.$data.results_panel_open?.5:void 0}},[n._v("\n      "+n._s(99<n.features.length?"99+":n.features.length)+"\n    ")])]):n._e()]),n._v(" "),r("ul",{ref:"result",staticClass:"gcd-txt-result"},n._l(n.$data.results,function(t,e){return r("li",{key:t.__uid,class:[t.provider,t.__icon?"gcd-icon-"+t.__icon:"",t.__heading?"skin-background-color":"",t.__no_results?"gcd-noresult":"",t.__selected?"selected":""],on:{click:function(e){return e.stopPropagation(),n.onItemClick(e,t)}}},[t.__heading?r("div",{staticStyle:{display:"flex","justify-content":"space-between",padding:"5px"}},[r("span",{staticStyle:{color:"#FFF","font-weight":"bold"}},[n._v(n._s(t.label))])]):t.__no_results?r("span",{directives:[{name:"t",rawName:"v-t",value:n.noresults,expression:"noresults"}]}):[r("span",{class:n.g3wtemplate.getFontClass(t.__selected?"check":"uncheck"),staticStyle:{color:"#000",padding:"5px"}}),n._v(" "),"road"===t.__icon?r("i",{staticClass:"fa fa-road",staticStyle:{color:"black"},attrs:{"aria-hidden":"true"}}):"poi"===t.__icon?r("img",{staticClass:"gcd-icon",attrs:{src:"/static/client/images/pushpin.svg",width:"24",height:"24"}}):n._e(),n._v(" "),r("a",{attrs:{href:"",draggable:"false"}},[t.type?r("div",{staticClass:"gcd-type"},[n._v(n._s(t.type))]):n._e(),n._v(" "),t.name?r("div",{staticClass:"gcd-name"},[n._v(n._s(t.name))]):n._e(),n._v(" "),t.address_name?r("div",{staticClass:"gcd-road"},[n._v(n._s(t.address_name))]):n._e(),n._v(" "),t.address_road||t.address_building||t.address_house_number?r("div",{staticClass:"gcd-road"},[n._v(n._s(t.address_building)+" "+n._s(t.address_road)+" "+n._s(t.address_house_number))]):n._e(),n._v(" "),t.address_city||t.address_town||t.address_village?r("div",{staticClass:"gcd-city"},[n._v(n._s(t.address_postcode)+" "+n._s(t.address_city)+" "+n._s(t.address_town)+" "+n._s(t.address_village))]):n._e(),n._v(" "),t.address_state||t.address_country?r("div",{staticClass:"gcd-country"},[n._v(n._s(t.address_state)+" "+n._s(t.address_country))]):n._e()])]],2)}),0)]):n._e()},e.staticRenderFns=[],e._scopeId="data-v-547bdae4"},{"components/QueryResultsActionChooseLayer.vue":215,"g3w-ol/projection/projections":76,"services/gui":302,store:313,"store/application-state":310,"store/catalog-layers":311,utils:404,"utils/addZValueToOLFeatureGeometry":320,"utils/convertSingleMultiGeometry":335,"utils/flattenObject":368,"utils/isPointGeometryType":411,"vueify/lib/insert-css":2}],194:[function(e,t,n){e("vueify/lib/insert-css").insert(".ol-zoom-history[data-v-5ba4faea]{display:flex!important;gap:5px}");Object.defineProperty(n,"__esModule",{value:!0}),a=e("services/gui"),r=(a=a)&&a.__esModule?a:{default:a},i=e("utils").debounce,n.default={name:"MapControlZoomHistory",data:function(){return{history:{index:0,items:[]}}},methods:{last:function(){this.history.index--,this.setMapExtent()},next:function(){this.history.index++,this.setMapExtent()},setMapExtent:function(){r.default.getService("map").getMap().getView().fit(this.history.items[this.history.index])}},computed:{hasEmptyHistory:function(){return 0===this.history.index&&1===this.history.items.length||this.history.items.length-1===this.history.index}},created:function(){var t=this,n=r.default.getService("map").getMap(),e=n.getView();this.history.items.push(e.calculateExtent(n.getSize())),this.changeKeyEvent=e.on("change",i(function(e){t.history.index!==t.history.items.length-1&&t.history.items.splice(t.history.index-t.history.items.length+1),t.history.items.push(e.target.calculateExtent(n.getSize())),t.history.index++},600))},beforeDestroy:function(){ol.Observable.unByKey(this.changeKeyEvent)}},t.exports.__esModule&&(t.exports=t.exports.default);var r,i,a="function"==typeof t.exports?t.exports.options:t.exports;a.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",{staticClass:"ol-zoom-history ol-unselectable ol-control"},[e("div",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top.create",value:"sdk.mapcontrols.zoomhistory.zoom_last",expression:"'sdk.mapcontrols.zoomhistory.zoom_last'",arg:"top",modifiers:{create:!0}}]},[e("button",{directives:[{name:"disabled",rawName:"v-disabled",value:0===t.history.index,expression:"history.index === 0"}],attrs:{type:"button"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.last(e)}}},[e("i",{class:t.g3wtemplate.getFontClass("reply")})])]),t._v(" "),e("div",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top.create",value:"sdk.mapcontrols.zoomhistory.zoom_next",expression:"'sdk.mapcontrols.zoomhistory.zoom_next'",arg:"top",modifiers:{create:!0}}]},[e("button",{directives:[{name:"disabled",rawName:"v-disabled",value:t.hasEmptyHistory,expression:"hasEmptyHistory"}],attrs:{type:"button"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.next(e)}}},[e("i",{class:t.g3wtemplate.getFontClass("share")})])])])},a.staticRenderFns=[],a._scopeId="data-v-5ba4faea"},{"services/gui":302,utils:404,"vueify/lib/insert-css":2}],195:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0}),i=r(e("components/MapFooterRight.vue")),e=r(e("components/MapFooterLeft.vue")),n.default={name:"Mapfooter",props:{service:{type:Object}},components:{MapFooterRight:i.default,MapFooterLeft:e.default}},t.exports.__esModule&&(t.exports=t.exports.default);var i,n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this.$createElement,e=this._self._c||e;return e("div",{staticClass:"skin-border-color",attrs:{id:"map_footer"}},[e("map-footer-left"),this._v(" "),e("map-footer-right",{attrs:{service:this.service}})],1)},n.staticRenderFns=[]},{"components/MapFooterLeft.vue":196,"components/MapFooterRight.vue":197}],196:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default={name:"Mapfooter"},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this.$createElement;this._self._c;return this._m(0)},n.staticRenderFns=[function(){var e=this.$createElement,e=this._self._c||e;return e("div",{staticStyle:{display:"flex"},attrs:{id:"map_footer_left"}},[e("a",{staticStyle:{"margin-left":"5px","align-self":"center","box-shadow":"0 1px 4px 0 rgba(0,0,0,.1), 0 4px 8px 0 rgba(0,0,0,.3)"},attrs:{href:"https://g3wsuite.it/",target:"_blank"}},[e("img",{attrs:{height:"15",src:"/static/client/images/g3wsuite_logo.png",alt:""}})])])}]},{}],197:[function(e,t,n){function r(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),e=e("store/application-state"),a=(e=e)&&e.__esModule?e:{default:e},n.default={name:"map-footer-right",props:{service:{type:Object}},data:function(){return{mouse:{switch_icon:!1,epsg_4326:!1,tooltip:null},mapunit:a.default.map.unit}},computed:{showmapunits:function(){return 1<this.service.state.mapunits.length}},methods:{createCopyMapExtentUrl:function(){this.service.createCopyMapExtentUrl()},switchMapsCoordinateTo4326:function(){this.mouse.epsg_4326=!this.mouse.epsg_4326}},watch:{mapunit:function(e){a.default.map.unit=e,this.service.changeScaleLineUnit(e)}},mounted:(i=r(function*(){var e=this;this.service.once("ready",function(){e.mouse.switch_icon=e.service.getMapControlByType({type:"mouseposition"})&&"EPSG:4326"!==e.service.getEpsg(),e.mouse.tooltip="ESPG "+e.service.getCrs().split(":")[1]+" <--\x3e WGS84"})}),function(){return i.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default);var i,a,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{staticStyle:{display:"flex"},attrs:{id:"map_footer_right"}},[t("div",{attrs:{id:"scale-control"}}),n._v(" "),n.mouse.switch_icon&&!n.isMobile()?t("div",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top.create",value:n.mouse.tooltip,expression:"mouse.tooltip",arg:"top",modifiers:{create:!0}}],attrs:{id:"switch-mouse-coordinate"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),n.switchMapsCoordinateTo4326(e)}}},[t("span",{staticClass:"skin-color-dark hide-cursor-caret-color",class:n.g3wtemplate.getFontClass("mouse")})]):n._e(),n._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:!n.mouse.epsg_4326,expression:"!mouse.epsg_4326"}],attrs:{id:"mouse-position-control"}}),n._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:n.mouse.epsg_4326,expression:"mouse.epsg_4326"}],attrs:{id:"mouse-position-control-epsg-4326"}}),n._v(" "),n.showmapunits?t("div",{attrs:{id:"scale-line-units"}},[t("select",{directives:[{name:"model",rawName:"v-model",value:n.mapunit,expression:"mapunit"}],staticClass:"skin-color-dark",staticStyle:{padding:"5px 2px","font-weight":"bold",border:"0",cursor:"pointer"},on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});n.mapunit=e.target.multiple?t:t[0]}}},n._l(n.service.state.mapunits,function(e){return t("option",{directives:[{name:"t",rawName:"v-t",value:"sdk.mapcontrols.scaleline.units."+e,expression:"`sdk.mapcontrols.scaleline.units.${unit}`"}],staticStyle:{"font-weight":"bold"},domProps:{value:e,selected:n.mapunit===e}})}),0)]):n._e(),n._v(" "),t("div",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top.create",value:"sdk.tooltips.copy_map_extent_url",expression:"'sdk.tooltips.copy_map_extent_url'",arg:"top",modifiers:{create:!0}}],staticStyle:{"background-color":"#eeeeee"},attrs:{id:"permalink"}},[t("span",{staticClass:"skin-color-dark",class:n.g3wtemplate.getFontClass("link"),on:{click:function(e){return e.stopPropagation(),n.createCopyMapExtentUrl(e)}}})])])},e.staticRenderFns=[]},{"store/application-state":310}],198:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default={name:"metadata",data:function(){return{state:null}}},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this.$createElement;return(this._self._c||e)("div")},n.staticRenderFns=[]},{}],199:[function(e,t,n){e("vueify/lib/insert-css").insert('.layer_header[data-v-fee105a8]{padding:5px;margin-bottom:0;margin-top:0;cursor:pointer}.layer-name[data-v-fee105a8]{font-weight:700}.layer-header-icon[data-v-fee105a8]{margin-right:10px;color:#999}.layer_header span.open-close[data-v-fee105a8]{position:absolute;right:5px;color:#999}.metadata-label[data-v-fee105a8]{font-weight:700;font-size:1.1em}.row[data-v-fee105a8]{padding:10px;border-bottom:1px solid #e2e2e2}.nav-tabs[data-v-fee105a8]{border-bottom:0 solid #ddd}.nav-tabs>li.active>a[data-v-fee105a8],.nav-tabs>li.active>a[data-v-fee105a8]:focus,.nav-tabs>li.active>a[data-v-fee105a8]:hover{border-width:0}.nav-tabs>li>a[data-v-fee105a8]{border:none;color:#aeaeae}.nav-tabs>li.active>a[data-v-fee105a8],.nav-tabs>li>a[data-v-fee105a8]:hover{border:none;background:transparent}.nav-tabs>li>a[data-v-fee105a8]:after{content:"";height:2px;position:absolute;width:100%;left:0;bottom:-1px;transition:all .25s ease 0s;transform:scale(0)}.nav-tabs>li.active>a[data-v-fee105a8]:after,.nav-tabs>li:hover>a[data-v-fee105a8]:after{transform:scale(1)}.tab-nav>li>a[data-v-fee105a8]:after{background:#21527d none repeat scroll 0 0;color:#fff}.tab-content[data-v-fee105a8]{margin:10px;background-color:#eee;overflow:auto}.spatial-tab[data-v-fee105a8]{font-weight:700}');Object.defineProperty(n,"__esModule",{value:!0}),e=e("mixins"),n.default={name:"layer",mixins:[e.metadataMixin],props:{state:{}},data:function(){return{show:!1}},computed:{isSpatial:function(){return"NoGeometry"!==this.state.geometrytype}},methods:{showHideInfo:function(){this.show=!this.show}},mounted:function(){}},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"row-info"},[r("h4",{staticClass:"layer_header",attrs:{"data-toggle":"collapse","data-target":"#"+n.state.id},on:{click:n.showHideInfo}},[r("i",{staticClass:"layer-header-icon action-button nohover",class:n.g3wtemplate.font[n.isSpatial?"map":"table"],attrs:{"aria-hidden":"true"}}),n._v(" "),r("span",{staticClass:"layer-name"},[n._v(n._s(n.state.name))]),n._v(" "),r("span",{staticClass:"action-button nohover open-close",class:n.g3wtemplate.getFontClass(n.show?"minus":"plus")})]),n._v(" "),r("div",{staticClass:"collapse",attrs:{id:n.state.id}},[r("ul",{staticClass:"metadata-nav-tabs nav nav-tabs",attrs:{role:"tablist"}},[r("li",{staticClass:"active spatial-tab",attrs:{role:"presentation"}},[r("a",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.groups.general",expression:"'sdk.metadata.groups.layers.groups.general'"}],attrs:{href:"#layer_general_"+n.state.id,"aria-controls":"general",role:"tab","data-toggle":"tab"}})]),n._v(" "),n.isSpatial?r("li",{staticClass:"spatial-tab",attrs:{role:"presentation"}},[r("a",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.groups.spatial",expression:"'sdk.metadata.groups.layers.groups.spatial'"}],attrs:{href:"#layer_spatial_"+n.state.id,"aria-controls":"profile",role:"tab","data-toggle":"tab"}})]):n._e()]),n._v(" "),r("div",{staticClass:"tab-content"},[r("div",{staticClass:"tab-pane active",attrs:{role:"tabpanel",id:"layer_general_"+n.state.id}},[r("div",{staticClass:"container-fluid"},[n.findAttributeFormMetadataAttribute("title")?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.title",expression:"'sdk.metadata.groups.layers.fields.subfields.title'"}],staticClass:"col-md-2 col-sm-12 metadata-label"}),n._v(" "),r("div",{staticClass:"col-md-10 col-sm-12 value"},[n._v(n._s(n.state.metadata.title))])]):n._e(),n._v(" "),n.findMetadataAttribute("name")?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.name",expression:"'sdk.metadata.groups.layers.fields.subfields.name'"}],staticClass:"col-md-2 col-sm-12 metadata-label"}),n._v(" "),r("div",{staticClass:"col-md-10 col-sm-12 value"},[n._v(n._s(n.state.name))])]):n._e(),n._v(" "),n.findMetadataAttribute("source")?r("div",{staticClass:"row metadata-layer-source"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.source",expression:"'sdk.metadata.groups.layers.fields.subfields.source'"}],staticClass:"col-md-2 col-sm-12 metadata-label metadata-layer-source-value-key"}),n._v(" "),r("div",{staticClass:"col-md-10 col-sm-12 value metadata-layer-source-value"},[n._v(n._s(n.state.source.type))])]):n._e(),n._v(" "),n.findAttributeFormMetadataAttribute("abstract")?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.abstract",expression:"'sdk.metadata.groups.layers.fields.subfields.abstract'"}],staticClass:"col-md-2 col-sm-12 metadata-label"}),n._v(" "),r("div",{staticClass:"col-md-10 col-sm-12 value",domProps:{innerHTML:n._s(n.state.metadata.abstract)}})]):n._e(),n._v(" "),n.findAttributeFormMetadataAttribute("keywords")?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.keywords",expression:"'sdk.metadata.groups.layers.fields.subfields.keywords'"}],staticClass:"col-md-2 col-sm-12 metadata-label"}),n._v(" "),r("div",{staticClass:"col-md-10 col-sm-12 value"},[r("div",[n._v(n._s(n.state.metadata.keywords.join(", ")))])])]):n._e(),n._v(" "),n.findAttributeFormMetadataAttribute("metadataurl")&&n.state.metadata.metadataurl.onlineresources?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.metadataurl",expression:"'sdk.metadata.groups.layers.fields.subfields.metadataurl'"}],staticClass:"col-md-2 col-sm-12 metadata-label"}),n._v(" "),r("div",{staticClass:"col-md-10 col-sm-12 value"},[r("a",{attrs:{href:n.state.metadata.metadataurl.onlineresources}},[n._v(n._s(n.state.metadata.metadataurl.onlineresources))])])]):n._e(),n._v(" "),n.findAttributeFormMetadataAttribute("dataurl")&&n.state.metadata.dataurl.onlineresources?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.dataurl",expression:"'sdk.metadata.groups.layers.fields.subfields.dataurl'"}],staticClass:"col-md-2 col-sm-12 metadata-label"}),n._v(" "),r("div",{staticClass:"col-md-10 col-sm-12 value"},[r("a",{attrs:{href:n.state.metadata.dataurl.onlineresources}},[n._v(n._s(n.state.metadata.dataurl.onlineresources))])])]):n._e(),n._v(" "),n.findAttributeFormMetadataAttribute("attributes")?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.attributes",expression:"'sdk.metadata.groups.layers.fields.subfields.attributes'"}],staticClass:"col-md-2 col-sm-12 metadata-label"}),n._v(" "),r("div",{staticClass:"col-md-10 col-sm-12 value",staticStyle:{overflow:"auto"}},[r("table",{staticClass:"table table-striped",staticStyle:{"background-color":"#eeeeee !important"}},[r("thead",[r("tr",n._l(n.state.metadata.attributes[0],function(e,t){return r("th",[n._v(n._s(t))])}),0)]),n._v(" "),r("tbody",n._l(n.state.metadata.attributes,function(e){return r("tr",n._l(e,function(e,t){return r("td",[n._v(n._s(e))])}),0)}),0)])])]):n._e()])]),n._v(" "),r("div",{staticClass:"tab-pane",attrs:{role:"tabpanel",id:"layer_spatial_"+n.state.id}},[r("div",{staticClass:"container-fluid"},[n.findMetadataAttribute("crs")?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.crs",expression:"'sdk.metadata.groups.layers.fields.subfields.crs'"}],staticClass:"col-sm-2 metadata-label"}),n._v(" "),r("div",{staticClass:"col-sm-10 value"},[n._v(n._s(n.state.crs.epsg))])]):n._e(),n._v(" "),n.findMetadataAttribute("geometrytype")?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.geometrytype",expression:"'sdk.metadata.groups.layers.fields.subfields.geometrytype'"}],staticClass:"col-sm-2 metadata-label"}),n._v(" "),r("div",{staticClass:"col-sm-10 value"},[n._v(n._s(n.state.geometrytype))])]):n._e(),n._v(" "),n.findMetadataAttribute("bbox")?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.bbox",expression:"'sdk.metadata.groups.layers.fields.subfields.bbox'"}],staticClass:"col-sm-2 metadata-label"}),n._v(" "),r("div",{staticClass:"col-sm-10 value"},n._l(n.state.bbox,function(e,t){return r("p",[r("span",{staticStyle:{"font-weight":"bold","margin-right":"5px"}},[n._v(n._s(t))]),n._v(" "),r("span",[n._v(n._s(e))])])}),0)]):n._e(),n._v(" "),n.findAttributeFormMetadataAttribute("crs")?r("div",{staticClass:"row"},[r("div",{staticClass:"col-sm-2 metadata-label"},[n._v("CRS")]),n._v(" "),r("div",{staticClass:"col-sm-10 value"},n._l(n.state.metadata.crs,function(e){return r("div",[r("span",[n._v(n._s(e))])])}),0)]):n._e()])])])])])},n.staticRenderFns=[],n._scopeId="data-v-fee105a8"},{mixins:290,"vueify/lib/insert-css":2}],200:[function(e,t,n){var r,i,a,o;e("vueify/lib/insert-css").insert(".metadata-nav-bar li a[data-v-0e556a34]{text-align:center}.metadata-nav-bar li a i[data-v-0e556a34]{margin-right:5px}.metadata-item-tab[data-v-0e556a34]{margin-right:10px;border-radius:3px;margin-bottom:10px}.metadata-body[data-v-0e556a34]{overflow-y:auto;overflow-x:hidden;padding-left:0;padding-right:0}.tab-title[data-v-0e556a34]{position:absolute;bottom:10px;right:auto}.row-info[data-v-0e556a34]{margin:0!important;padding-top:10px;padding-bottom:10px;border-bottom:1px solid #eee}.row-info .label[data-v-0e556a34]{font-weight:700}.h_90[data-v-0e556a34]{height:90%}.h_100[data-v-0e556a34]{height:100%}#project-catalog[data-v-0e556a34]{position:relative;overflow:auto}.nav-tabs-wrapper[data-v-0e556a34]{display:inline-block;margin-bottom:-6px;margin-left:1.25%;margin-right:1.25%;position:relative;width:100%}.nav-tabs[data-v-0e556a34]{border-bottom:0 none}.nav-stacked[data-v-0e556a34]{font-size:1.2em;font-weight:700;padding:10px 0}.nav-stacked li a[data-v-0e556a34]{color:#fff}.left-vertical-tabs[data-v-0e556a34]{padding-left:0!important}");function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0}),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=s(e("components/MetadataLayer.vue")),a=s(e("components/MetadataProjectTabContent.vue")),o=s(e("components/MetadataProjectBBoxContent.vue")),e=s(e("components/MetadataProjectContactsContent.vue")),n.default={name:"project",data:function(){return{state:this.$options.state,iconsClass:{info:this.g3wtemplate.getFontClass("info-circle"),globe:this.g3wtemplate.getFontClass("globe"),bars:this.g3wtemplate.getFontClass("bars")}}},components:{"metadata-layer":i.default,"metadata-tab-content":a.default,"metadata-bbox-content":o.default,"metadata-contacts-content":e.default},methods:{isArrayorObject:function(e){return Array.isArray(e)||"object"===(void 0===e?"undefined":r(e))},setComponent:function(e){var t=void 0;switch(e){case"extent":t="metadata-bbox-content";break;case"contactinformation":t="metadata-contacts-content";break;default:t="metadata-tab-content"}return t}}},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{attrs:{id:"project-catalog"}},[r("div",{class:n.isMobile()?"mobile":null,staticStyle:{padding:"0"},attrs:{id:"project-catalog-container"}},[r("ul",{staticClass:"nav nav-tabs metadata-nav-bar",attrs:{role:"tablist"}},[r("li",{staticClass:"active"},[r("a",{staticClass:"metadata-item-tab general",attrs:{"data-toggle":"tab",href:"#general"}},[r("i",{staticClass:"action-button nohover",class:n.g3wtemplate.getFontClass("info"),attrs:{"aria-hidden":"true"}}),n._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.general.title",expression:"'sdk.metadata.groups.general.title'"}],staticStyle:{"font-weight":"bold"}})])]),n._v(" "),r("li",[r("a",{staticClass:"metadata-item-tab spatial",attrs:{"data-toggle":"tab",href:"#spatial"}},[r("i",{staticClass:"action-button nohover",class:n.iconsClass.globe,attrs:{"aria-hidden":"true"}}),n._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.spatial.title",expression:"'sdk.metadata.groups.spatial.title'"}],staticStyle:{"font-weight":"bold"}})])]),n._v(" "),r("li",[r("a",{staticClass:"metadata-item-tab layers",attrs:{"data-toggle":"tab",href:"#metadata_layers"}},[r("i",{staticClass:"action-button nohover",class:n.iconsClass.bars,attrs:{"aria-hidden":"true"}}),n._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.title",expression:"'sdk.metadata.groups.layers.title'"}],staticStyle:{"font-weight":"bold"}})])])])]),n._v(" "),r("div",{staticClass:"col-sm-12 metadata-body tab-content"},[r("div",{staticClass:"tab-pane fade in active",attrs:{id:"general"}},[n._l(n.state.groups.general,function(e,t){return r("div",{staticClass:"row h_100 row-info"},[r(n.setComponent(t),{tag:"component",attrs:{data:e,fieldName:t}})],1)})],2),n._v(" "),r("div",{staticClass:"tab-pane fade",attrs:{id:"spatial"}},[r("div",[n._l(n.state.groups.spatial,function(e,t){return r("div",{staticClass:"row row-info"},[r(n.setComponent(t),{tag:"component",attrs:{data:e,fieldName:t}})],1)})],2)]),n._v(" "),r("div",{staticClass:"tab-pane fade",attrs:{id:"metadata_layers"}},n._l(n.state.groups.layers.layers.value,function(e){return r("metadata-layer",{attrs:{state:e}})}),1)])])},n.staticRenderFns=[],n._scopeId="data-v-0e556a34"},{"components/MetadataLayer.vue":199,"components/MetadataProjectBBoxContent.vue":201,"components/MetadataProjectContactsContent.vue":202,"components/MetadataProjectTabContent.vue":203,"vueify/lib/insert-css":2}],201:[function(e,t,n){e("vueify/lib/insert-css").insert(".metadata-label[data-v-b715e0e8]{font-weight:700;font-size:1.1em}.bbox-labels[data-v-b715e0e8]{font-weight:700}");Object.defineProperty(n,"__esModule",{value:!0}),n.default={name:"metadata-bbox",props:{data:{}},data:function(){return{bboxlabels:["MINX","MINY","MAXX","MAXY"]}}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"wrap-content-tab"},[r("div",{directives:[{name:"t",rawName:"v-t",value:n.data.label,expression:"data.label"}],staticClass:"col-sm-2 metadata-label"}),n._v(" "),r("div",{staticClass:"col-sm-10 value",staticStyle:{"margin-top":"0"}},n._l(n.data.value,function(e,t){return r("div",[r("span",{staticClass:"bbox-labels"},[n._v(n._s(n.bboxlabels[t]))]),n._v(" "+n._s(e)+"\n      ")])}),0)])},e.staticRenderFns=[],e._scopeId="data-v-b715e0e8"},{"vueify/lib/insert-css":2}],202:[function(e,t,n){e("vueify/lib/insert-css").insert(".metadata-label[data-v-60ad65fc]{font-weight:700;font-size:1.1em}.metadata-contact-label[data-v-60ad65fc]{font-weight:700}.contact-icon[data-v-60ad65fc]{margin-right:3px}.row[data-v-60ad65fc]{margin-bottom:5px}");Object.defineProperty(n,"__esModule",{value:!0}),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n.default={name:"metadatacontatcs",props:{data:{}},data:function(){return{iconsClass:{contactelectronicmailaddress:this.g3wtemplate.getFontClass("mail"),personprimary:this.g3wtemplate.getFontClass("user"),contactvoicetelephone:this.g3wtemplate.getFontClass("mobile")}}},methods:{sanitizeValue:function(e){return null!=e&&("object"===(void 0===e?"undefined":r(e))?e=Object.keys(e).length?e:"":Array.isArray(e)&&(e=e.length?e:"")),e},geti18n:function(e){}}},t.exports.__esModule&&(t.exports=t.exports.default);var r,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"wrap-content-tab"},[r("div",{directives:[{name:"t",rawName:"v-t",value:n.data.label,expression:"data.label"}],staticClass:"col-sm-2 metadata-label"}),n._v(" "),r("div",{staticClass:"col-sm-10 value",staticStyle:{"margin-top":"0"}},n._l(n.data.value,function(e,t){return r("div",[r("div",{staticClass:"row"},[r("div",{staticClass:"col-sm-2 metadata-contact-label"},[r("i",{staticClass:"contact-icon",class:n.iconsClass[t],attrs:{"aria-hidden":"true"}}),n._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.general.fields.subfields.contactinformation."+t,expression:"`sdk.metadata.groups.general.fields.subfields.contactinformation.${key}`"}]})]),n._v(" "),r("div",{staticClass:"col-sm-10"},["personprimary"===t?n._l(e,function(e,t){return r("div",[r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.general.fields.subfields.contactinformation."+t,expression:"`sdk.metadata.groups.general.fields.subfields.contactinformation.${key}`"}],staticClass:"metadata-contact-label"}),n._v(" "),r("span",[n._v(n._s(e))])])}):r("div",["contactelectronicmailaddress"===t?[r("a",{staticStyle:{"font-weight":"bold"},attrs:{href:"mailto: "+n.sanitizeValue(e)}},[n._v(n._s(n.sanitizeValue(e)))])]:[n._v("\n              "+n._s(n.sanitizeValue(e))+"\n            ")]],2)],2)])])}),0)])},e.staticRenderFns=[],e._scopeId="data-v-60ad65fc"},{"vueify/lib/insert-css":2}],203:[function(e,t,n){e("vueify/lib/insert-css").insert(".metadata-label[data-v-6b130710]{font-weight:700;font-size:1.1em}");Object.defineProperty(n,"__esModule",{value:!0}),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n.default={name:"metadata-tab-content",props:{data:{},fieldName:{}},computed:{arrayToString:function(){return this.data.value.join(", ")}},methods:{isArrayorObject:function(e){return Array.isArray(e)||"object"===(void 0===e?"undefined":r(e))}}},t.exports.__esModule&&(t.exports=t.exports.default);var r,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"wrap-content-tab"},[r("div",{directives:[{name:"t",rawName:"v-t",value:n.data.label,expression:"data.label"}],staticClass:"col-sm-2 metadata-label"}),n._v(" "),"keywords"===n.fieldName?r("div",{staticClass:"col-sm-10 value"},[n._v("\n    "+n._s(n.arrayToString)+"\n  ")]):"wms_url"===n.fieldName?r("div",{staticClass:"col-sm-10 value",staticStyle:{"margin-top":"0"}},[r("span",[n._v(n._s(n.data.value))])]):!n.isArrayorObject(n.data.value)||"abstract"===n.fieldName?r("div",{staticClass:"col-sm-10 value",staticStyle:{"margin-top":"0"}},[r("span",{domProps:{innerHTML:n._s(n.data.value)}})]):r("div",{staticClass:"col-sm-10 value",staticStyle:{"margin-top":"0"}},n._l(n.data.value,function(e,t){return r("div",[r("span",[n._v(n._s(e))])])}),0)])},e.staticRenderFns=[],e._scopeId="data-v-6b130710"},{"vueify/lib/insert-css":2}],204:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),e=e("services/navbaritems"),r=(e=e)&&e.__esModule?e:{default:e},n.default={name:"NavbaritemLeft",data:function(){return{items:r.default.state.items.right}}},t.exports.__esModule&&(t.exports=t.exports.default);var r,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this.$createElement,t=this._self._c||e;return t("ul",{staticClass:"nav navbar-nav navbar-left"},this._l(this.items,function(e){return t(e,{key:e.id,tag:"li"})}),1)},e.staticRenderFns=[],e._scopeId="data-v-2c7478a1"},{"services/navbaritems":304}],205:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),e=e("services/navbaritems"),r=(e=e)&&e.__esModule?e:{default:e},n.default={name:"navbar-item-right",data:function(){return{items:r.default.state.items.right}}},t.exports.__esModule&&(t.exports=t.exports.default);var r,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this.$createElement,t=this._self._c||e;return t("ul",{staticClass:"nav navbar-nav navbar-right"},this._l(this.items,function(e){return t(e,{key:e.id,tag:"li"})}),1)},e.staticRenderFns=[],e._scopeId="data-v-c140951c"},{"services/navbaritems":304}],206:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default={name:"download-notify"},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this.$createElement,e=this._self._c||e;return e("div",{directives:[{name:"download",rawName:"v-download.show",modifiers:{show:!0}}],staticClass:"skin-color",attrs:{id:"download_notification",title:"DOWNLOAD"}},[e("bar-loader",{attrs:{loading:"true"}}),this._v(" "),e("i",{class:this.g3wtemplate.getFontClass("download"),staticStyle:{padding:"3px"}})],1)},n.staticRenderFns=[]},{}],207:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default={name:"online-notify"},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this.$createElement,e=this._self._c||e;return e("div",{directives:[{name:"online",rawName:"v-online:hide",arg:"hide"}],staticStyle:{color:"#999"},attrs:{id:"offline_notification"}},[e("i",{class:this.g3wtemplate.getFontClass("wifi")}),this._v(" "),e("div",{staticStyle:{"font-weight":"bold","font-size":"0.4em"}},[this._v("offline")])])},n.staticRenderFns=[]},{}],208:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default={name:"plugins-notify"},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this.$createElement,e=this._self._c||e;return e("div",{directives:[{name:"plugins",rawName:"v-plugins"}],staticStyle:{color:"#994b10"},attrs:{id:"plugins_notification"}},[e("bar-loader",{attrs:{loading:"true"}}),this._v(" "),e("i",{class:this.g3wtemplate.getFontClass("plugin")})],1)},n.staticRenderFns=[]},{}],209:[function(e,t,n){var a,u,o,s,r,l,c,d,p,f,h,i,g,v,m,y,_,b,w,x,S,L,C,E;e("vueify/lib/insert-css").insert(".print-labels-content[data-v-9e025612]{margin-top:5px;color:#fff}.print-labels-content>span.skin-color[data-v-9e025612]{font-weight:700;font-size:1.1em;display:block;border-bottom:2px solid #fff;margin-bottom:5px}.print-labels-content>.labels-input-content[data-v-9e025612]{max-height:120px;overflow-y:auto}.g3w-search-form>.box-footer[data-v-9e025612]{background-color:transparent}#printbutton[data-v-9e025612]{width:100%;font-weight:700}.form-group>label[data-v-9e025612]{display:block}#fid-print-atals-instruction[data-v-9e025612]{margin-top:5px;color:#fff}#fids_intruction[data-v-9e025612]{white-space:pre-line}#fids_examples_values[data-v-9e025612]{margin-top:3px;font-weight:700}\n#print.treeview-menu .select2.select2-container{display:block}");function T(e){return e&&e.__esModule?e:{default:e}}function k(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=e("app/constant"),s=T(e("core/g3w-component")),r=T(e("store/application-state")),l=T(e("store/catalog-layers")),c=T(e("store/projects")),d=T(e("services/application")),p=T(e("services/gui")),f=e("utils/getScaleFromResolution"),h=e("utils/getResolutionFromScale"),i=e("utils/getMetersFromDegrees"),g=e("utils/downloadFile"),v=e("utils/printAtlas"),m=e("utils/print"),y=e("utils/promisify"),_=T(e("mixins/resize")),b=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/PrintPage.vue")),E=e("core/i18n/i18n.service").t,n.default={name:"print",mixins:[_.default],data:function(){return this.init(),{state:this.state||{},disabled:!1,atlas_values:[]}},computed:{has_maps:function(){return 0<(this.state.maps||[]).length},has_autocomplete:function(){return!(!this.state.atlas||!this.state.atlas.field_name)}},methods:{init:function(){this._init=void 0!==this._init&&this._init,this._moveKey=this._moveKey||null,this._page=this._page||null,this._resolutions=this._resolutions||{};var e=c.default.getCurrentProject().getPrint()||[],t=0<e.length;this.state=Object.assign(this.state||{},{visible:t,print:e,loading:!1,downloading:!1,url:null,layers:!0,maps:t?e[0].maps:void 0,labels:t?e[0].labels:void 0,template:t?e[0].name:void 0,atlas:t?e[0].atlas:void 0,rotation:t?0:void 0,inner:[0,0,0,0],scales:[],scale:t?null:void 0,dpis:o.PRINT_RESOLUTIONS,dpi:o.PRINT_RESOLUTIONS[0],formats:o.PRINT_FORMATS,format:o.PRINT_FORMATS[0].value}),this.print_extent=null},resize:function(){this.select2&&!r.default.ismobile&&this.select2.select2("close")},changeTemplate:(C=k(function*(){var e,t,n=this;this.state.template&&(yield this.$nextTick(),this.select2&&(this.select2.select2("destroy"),this.select2.off(),this.select2=null),this.disabled=!1,e=this.state.atlas||0===this.state.maps.length,t=this.state.print.find(function(e){return e.name===n.state.template}),Object.assign(this.state,{maps:t.maps,atlas:t.atlas,labels:t.labels}),this.atlas_values=[],this.state.atlas?(this._clearPrint(),this.initSelect2Field()):e?this.showPrintArea(!0):this._setPrintArea(),yield this.$nextTick())}),function(){return C.apply(this,arguments)}),changeScale:function(){this.state.scale&&this._setPrintArea()},changeRotation:function(){this.state.rotation=0<=this.state.rotation?Math.min(this.state.rotation||0,360):Math.max(this.state.rotation||0,-360),p.default.getService("map").setInnerGreyCoverBBox({rotation:this.state.rotation})},getOverviewExtent:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.xmin,n=e.xmax,r=e.ymin,e=e.ymax;return(p.default.getService("map").isAxisOrientationInverted()?[r,t,e,n]:[t,r,n,e]).join()},getPrintExtent:function(){var e=p.default.getService("map").viewer.map;try{var t=e.getCoordinateFromPixel([this.state.inner[0],this.state.inner[1]]),n=u(t,2),r=n[0],i=n[1],a=e.getCoordinateFromPixel([this.state.inner[2],this.state.inner[3]]),o=u(a,2),s=o[0],l=o[1];this.print_extent=(p.default.getService("map").isAxisOrientationInverted()?[i,r,l,s]:[r,i,s,l]).join()}catch(e){}return this.print_extent},print:(L=k(function*(){var e,t=this,n=!!this.state.atlas,r=void 0,i=void 0;this.state.loading=!0;try{p.default.disableSideBar(!0),this._page&&(yield(0,y.promisify)(p.default.closeContent())),n&&(i=d.default.setDownload(!0),yield(0,g.downloadFile)({url:(yield(0,v.printAtlas)({template:this.state.template,field:this.state.atlas.field_name||"$id",values:this.atlas_values,download:!0})).url,filename:this.state.template,mime_type:"application/pdf"})),n||(this.state.url=null,this.state.layers=!0,this._page=new s.default({service:{state:this.state},vueComponentObject:b}),p.default.setContent({content:this._page,title:"print",perc:100}),e=yield(0,m.print)({rotation:this.state.rotation,dpi:this.state.dpi,template:this.state.template,scale:this.state.scale,format:this.state.format,labels:this.state.labels,is_maps_preset_theme:this.state.maps.some(function(e){return void 0!==e.preset_theme}),maps:this.state.maps.map(function(e){return{name:e.name,preset_theme:e.preset_theme,scale:(e.overview?e:t.state).scale,extent:e.overview?t.getOverviewExtent(e.extent):t.getPrintExtent()}})},c.default.getCurrentProject().getOwsMethod()),this.state.url=e.url,this.state.layers=e.layers,this._page.getInternalComponent().$on("hook:mounted",function(){return t.state.loading=!1}),this._page.unmount=function(){p.default.getService("map").viewer.map.once("postrender",t._setPrintArea.bind(t));var e=s.default.prototype.unmount.call(t._page);return t._page=null,e})}catch(e){r=e,this.state.loading=!1,p.default.disableSideBar(!1)}this.state.loading=!1,i&&d.default.setDownload(!1,i),!n&&this.state.layers||p.default.disableSideBar(!1),r&&(p.default.notify.error(r||E("info.server_error")),p.default.closeContent())}),function(){return L.apply(this,arguments)}),showPrintArea:function(n){var r=this,e=!n;e&&this.select2&&this.select2.val(null).trigger("change"),e&&(this.atlas_values=[],this.print_extent=null),p.default.closeContent().then(function(e){setTimeout(function(){var t=e.getService();t.getMap().once("postrender",function(e){if(!n)return r._clearPrint();r._moveKey=t.viewer.map.on("moveend",r._setPrintArea.bind(r)),r._initPrintConfig(),void 0===r.state.atlas&&(r._setPrintArea(),t.startDrawGreyCover())}),t.getMap().renderSync()})})},_setPrintArea:function(){if(!this.has_maps)return this._clearPrint();var e=p.default.getService("map").viewer.map,t=e.getSize(),e=e.getView().getResolution(),n=this.state.maps.find(function(e){return!e.overview}),r=n.h,n=n.w,e="m"===p.default.getService("map").getMapUnits()?e:(0,i.getMetersFromDegrees)(e),n=n/1e3*parseFloat(this.state.scale)/e/2,r=r/1e3*parseFloat(this.state.scale)/e/2,e=t[0]/2,t=t[1]/2;this.state.inner=[e-n,t+r,e+n,t-r],p.default.getService("map").setInnerGreyCoverBBox({type:"pixel",inner:this.state.inner,rotation:this.state.rotation})},_clearPrint:function(){ol.Observable.unByKey(this._moveKey),this._moveKey=null,p.default.getService("map").stopDrawGreyCover()},_setScales:function(e){var t=this,n=p.default.getService("map").getMapUnits(),r=(0,f.getScaleFromResolution)(e,n),e=o.PRINT_SCALES.sort(function(e,t){return t.value-e.value}),i=e.filter(function(e){return e.value<r}),e=e.findLast(function(e){return e.value>=r});this.state.scales=(e?[e]:[]).concat(i),this.state.scales.forEach(function(e){return t._resolutions[e.value]=(0,h.getResolutionFromScale)(e.value,n)})},_initPrintConfig:function(){var n=this,e=p.default.getService("map").viewer.map.getView(),r=(this._initialized||(this._setScales(e.getMaxResolution()),this._initialized=!0),e.getResolution());Object.entries(this._resolutions).find(function(e){var e=u(e,2),t=e[0],e=e[1];if(r<=e)return n.state.scale=t,!0})},reload:function(){var e,t=this,n=(this.state.print=c.default.getCurrentProject().state.print||[],0<this.state.print.length),r=this._initialized;this.state.template=n?this.state.print[0].name:this.state.template,n&&!r&&this.init(),n?(this._initPrintConfig(),(e=p.default.getService("map")).on("changeviewaftercurrentproject",function(){t.state.scales=o.PRINT_SCALES,t._setScales(e.viewer.map.getView().getMaxResolution())})):this._clearPrint()},initSelect2Field:function(){var r,i=this;this.select2=$("#print_atlas_autocomplete").select2({width:"100%",multiple:!0,dropdownParent:$(this.$refs.print_atlas),minimumInputLength:1,ajax:{delay:500,transport:(r=k(function*(e,t,n){try{t({results:(yield l.default.getLayerById(i.state.atlas.qgs_layer_id).getFilterData({suggest:i.state.atlas.field_name+"|"+e.data.q,unique:i.state.atlas.field_name})).map(function(e){return{id:e,text:e}})})}catch(e){n(e)}}),function(e,t,n){return r.apply(this,arguments)})},matcher:function(e,t){e=e.term&&e.term.toLowerCase();return""===(e||"").toString().trim()?t:t.text.toLowerCase().includes(e)&&void 0!==t.text?a({},t):null},language:{noResults:function(){return E("sdk.search.no_results")},errorLoading:function(){return E("sdk.search.error_loading")},searching:function(){return E("sdk.search.searching")},inputTooShort:function(e){return E("sdk.search.autocomplete.inputshort.pre")+" "+(e.minimum-e.input.length)+" "+E("sdk.search.autocomplete.inputshort.post")}}}),this.select2.on("select2:select",function(e){i.atlas_values.push(e.params.data.id)}),this.select2.on("select2:unselect",function(t){i.atlas_values=i.atlas_values.filter(function(e){return e!=t.params.data.id})})}},watch:{has_autocomplete:(S=k(function*(e){e&&(yield this.$nextTick(),this.initSelect2Field())}),function(e){return S.apply(this,arguments)}),atlas_values:{immediate:!0,handler:(x=k(function*(e){var i,a,t=this;!this._skip_atlas_check&&this.state.atlas&&(this.has_autocomplete?this.disabled=0===e.length:(i=function(e){return e&&Number.isInteger(+e)&&0<=+e&&+e<t.state.atlas.feature_count||null},a=new Set,(e=(e?e[0]:"")||"").split(",").filter(function(e){return e}).forEach(function(e){if(-1===e.indexOf("-")&&null!==i(e))a.add(e);else{var e=e.split("-"),r=e.filter(function(e){return null!==i(e)});if(r.length===e.length&&r.reduce(function(e,t,n){return e&&(0===n||r[n-1]<=t)},!0)){for(var t=1;t<r.length;t++)for(var n=r[t-1];n<r[t];n++)a.add(n+"");a.add(r[r.length-1])}}}),this._skip_atlas_check=!0,this.atlas_values=Array.from(a),yield this.$nextTick(),this._skip_atlas_check=!1,this.disabled=""===e.trim()))}),function(e){return x.apply(this,arguments)})},"state.url":(w=k(function*(e){var t=this;if(e){var n=void 0;try{yield this.$nextTick();var n=setTimeout(function(){p.default.disableSideBar(!1),t.state.downloading=!1,p.default.showUserMessage({type:"alert",message:"timeout"})},o.TIMEOUT),r=yield fetch(e);if(!r.ok)throw r.statusText}catch(e){p.default.notify.error(e||E("info.server_error")),p.default.closeContent()}finally{clearTimeout(n),p.default.disableSideBar(!1),this.state.downloading=!1}}}),function(e){return w.apply(this,arguments)})}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("ul",{staticClass:"treeview-menu",attrs:{id:"print"}},[r("li",[r("form",{staticClass:"g3w-search-form form-horizonal"},[r("div",{staticClass:"box-body"},[r("transition",{attrs:{duration:500,name:"fade"}},[r("bar-loader",{attrs:{loading:n.state.loading}})],1),n._v(" "),r("helpdiv",{attrs:{message:"sdk.print.help"}}),n._v(" "),r("label",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.template",expression:"'sdk.print.template'"}],attrs:{for:"templates"}}),n._v(" "),r("select",{directives:[{name:"select2",rawName:"v-select2",value:"state.template",expression:"'state.template'"}],staticClass:"form-control",style:{marginBottom:this.state.atlas&&"10px"},attrs:{id:"templates",select2_value:n.state.template},on:{change:n.changeTemplate}},n._l(n.state.print,function(e){return r("option",{domProps:{value:e.name}},[n._v(n._s(e.name))])}),0),n._v(" "),n.state.atlas?n._e():[r("label",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.scale",expression:"'sdk.print.scale'"}],attrs:{for:"scale"}}),n._v(" "),r("select",{directives:[{name:"disabled",rawName:"v-disabled",value:!n.has_maps,expression:"!has_maps"},{name:"select2",rawName:"v-select2",value:"state.scale",expression:"'state.scale'"}],staticClass:"form-control",attrs:{id:"scale",select2_value:n.state.scale},on:{change:n.changeScale}},n._l(n.state.scales,function(e){return r("option",{domProps:{value:e.value}},[n._v(n._s(e.label))])}),0),n._v(" "),r("label",{attrs:{for:"dpi"}},[n._v("dpi")]),n._v(" "),r("select",{directives:[{name:"select2",rawName:"v-select2",value:"state.dpi",expression:"'state.dpi'"}],staticClass:"form-control",attrs:{id:"dpi",select2_value:n.state.dpi,createTag:!0}},n._l(n.state.dpis,function(e){return r("option",[n._v(n._s(e))])}),0),n._v(" "),r("label",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.rotation",expression:"'sdk.print.rotation'"}],attrs:{for:"rotation"}}),n._v(" "),r("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!n.has_maps,expression:"!has_maps"},{name:"model",rawName:"v-model",value:n.state.rotation,expression:"state.rotation"}],staticClass:"form-control",attrs:{id:"rotation",min:"-360",max:"360",type:"number"},domProps:{value:n.state.rotation},on:{input:[function(e){e.target.composing||n.$set(n.state,"rotation",e.target.value)},n.changeRotation]}}),n._v(" "),r("label",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.format",expression:"'sdk.print.format'"}],attrs:{for:"format"}}),n._v(" "),r("select",{directives:[{name:"select2",rawName:"v-select2",value:"state.format",expression:"'state.format'"}],staticClass:"form-control",attrs:{id:"format",select2_value:n.state.format}},n._l(n.state.formats,function(e){return r("option",{domProps:{value:e.value}},[n._v(n._s(e.label))])}),0)],n._v(" "),n.state.atlas?r("div",{ref:"print_atlas",staticClass:"form-group",staticStyle:{width:"100%"}},[n.has_autocomplete?[r("label",{attrs:{for:"print_atlas_autocomplete"}},[r("span",[n._v(n._s(n.state.atlas.field_name))])]),n._v(" "),r("select",{staticClass:"form-control",attrs:{id:"print_atlas_autocomplete",name:n.state.atlas.field_name}})]:[r("label",[r("span",[n._v("fids [max: "+n._s(n.state.atlas.feature_count-1)+"]")])]),n._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:n.atlas_values,expression:"atlas_values"}],staticClass:"form-control",domProps:{value:n.atlas_values},on:{keydown:function(e){if(!e.type.indexOf("key")&&n._k(e.keyCode,"space",32,e.key,[" ","Spacebar"]))return null;e.preventDefault()},input:function(e){e.target.composing||(n.atlas_values=e.target.value)}}}),n._v(" "),r("div",{attrs:{id:"fid-print-atals-instruction"}},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.fids_instruction",expression:"'sdk.print.fids_instruction'"}],attrs:{id:"fids_intruction"}}),n._v(" "),r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.fids_example",expression:"'sdk.print.fids_example'"}],attrs:{id:"fids_examples_values"}})])]],2):n._e(),n._v(" "),n.state.labels&&0<n.state.labels.length?r("div",{staticClass:"print-labels-content"},[r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.labels",expression:"'sdk.print.labels'"}],staticClass:"skin-color"}),n._v(" "),r("div",{staticClass:"labels-input-content"},n._l(n.state.labels,function(t){return r("span",{key:t.id},[r("label",{attrs:{for:"g3w_label_id_input_"+t.id}},[n._v(" "+n._s(t.id))]),n._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"label.text"}],staticClass:"form-control",attrs:{id:"g3w_label_id_input_"+t.id},domProps:{value:t.text},on:{input:function(e){e.target.composing||n.$set(t,"text",e.target.value)}}})])}),0)]):n._e()],2),n._v(" "),r("div",{staticClass:"box-footer"},[r("span",[r("button",{directives:[{name:"disabled",rawName:"v-disabled",value:n.disabled,expression:"disabled"},{name:"download",rawName:"v-download"},{name:"t",rawName:"v-t",value:"create_print",expression:"'create_print'"}],staticClass:"sidebar-button-run btn",attrs:{id:"printbutton"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),n.print(e)}}})])])])])])},e.staticRenderFns=[],e._scopeId="data-v-9e025612"},{"app/constant":5,"components/PrintPage.vue":210,"core/g3w-component":8,"core/i18n/i18n.service":12,"mixins/resize":293,"services/application":298,"services/gui":302,"store/application-state":310,"store/catalog-layers":311,"store/projects":317,"utils/downloadFile":366,"utils/getMetersFromDegrees":387,"utils/getResolutionFromScale":394,"utils/getScaleFromResolution":395,"utils/print":426,"utils/printAtlas":427,"utils/promisify":428,"vueify/lib/insert-css":2}],210:[function(e,t,n){var r,i,a,o;e("vueify/lib/insert-css").insert("#print-output[data-v-184574a6]{height:100%;position:relative}#print-output>iframe[data-v-184574a6]{border:0;width:100%;height:100%}.g3w-print-image-output[data-v-184574a6]{display:flex;flex-direction:column;position:relative;height:100%}#g3w-print-header[data-v-184574a6]{display:flex;justify-content:flex-end;align-items:flex-end;margin-top:5px;margin-bottom:5px}#g3w-print-header button[data-v-184574a6]{font-weight:700}.g3w-print-url[data-v-184574a6]{height:100%;width:100%;position:relative;overflow-y:auto}.g3w-print-url>img[data-v-184574a6]{height:auto;max-width:100%}#print-output>h4[data-v-184574a6]{font-weight:700}");function s(e){return e&&e.__esModule?e:{default:e}}function l(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),i=s(e("store/projects")),a=s(e("services/gui")),o=e("utils/imageToDataURL"),n.default={name:"print-page",data:function(){var e=this.$options.service.state||{};return{state:e,format:e.format}},methods:{downloadImage:(r=l(function*(){var e=this;try{a.default.disableSideBar(!0),this.state.downloading=!0,["jpg","png","svg"].includes(this.format)&&(yield(0,o.imageToDataURL)({src:this.state.url,type:"image/"+this.format}),setTimeout(function(){a.default.disableSideBar(!1),e.state.downloading=!1}))}catch(e){}}),function(){return r.apply(this,arguments)})},beforeDestroy:function(){this.state.url&&"POST"===i.default.getCurrentProject().getOwsMethod()&&window.URL.revokeObjectURL(this.state.url)}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",{attrs:{id:"print-output"}},[e("transition",{attrs:{duration:500,name:"fade"}},[e("bar-loader",{attrs:{loading:t.state.loading&&t.state.layers}})],1),t._v(" "),t.state.layers?[["pdf","geopdf"].includes(t.format)?e("iframe",{ref:"out",attrs:{src:t.state.url}}):e("div",{staticClass:"g3w-print-image-output"},[e("div",{attrs:{id:"g3w-print-header"}},[e("div",{class:{"g3w-disabled":!(!t.state.downloading||!t.state.layers)}},[e("a",{attrs:{href:t.state.url,download:"download."+t.format}},[e("button",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"sdk.print.download_image",expression:"'sdk.print.download_image'",modifiers:{create:!0}}],staticClass:"btn skin-button skin-tooltip-left",class:t.g3wtemplate.getFontClass("download"),attrs:{"data-placement":"left","data-toggle":"tooltip","data-container":"body",role:"button"},on:{click:function(e){return e.stopPropagation(),t.downloadImage(e)}}})])])]),t._v(" "),t.state.url?e("div",{staticClass:"g3w-print-url"},[e("img",{ref:"out",attrs:{src:t.state.url}})]):t._e()])]:e("h4",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.no_layers",expression:"'sdk.print.no_layers'"}]})],2)},e.staticRenderFns=[],e._scopeId="data-v-184574a6"},{"services/gui":302,"store/projects":317,"utils/imageToDataURL":403,"vueify/lib/insert-css":2}],211:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0}),i=r(e("store/projects")),a=r(e("services/gui")),o=e("core/i18n/i18n.service").t,s="/static/client/images/FakeProjectThumb.png",n.default={name:"projects-menu",data:function(){return{state:null,loading:!1}},methods:{trigger:function(e){e.cbk?this._initCallback(e):e.href?window.open(e.href,"_blank"):e.route&&a.default.goto(e.route)},_initCallback:function(e){var t=this;this._toggleModal(!0),e.cbk.call(e,{gid:e.gid}).then(function(e){e.then(function(e){e&&(document.title=e.state.html_page_title)}).fail(function(){a.default.notify.error("<h4>"+o("error_map_loading")+"</h4><h5>"+o("check_internet_connection_or_server_admin")+"</h5>")}).always(function(){t._toggleModal(!1)})})},_toggleModal:function(e){a.default.showFullModal({show:e}),a.default.setLoadingContent(e)},logoSrc:function(e){var t=this.$options.host||"",n=e&&-1!==e.indexOf(i.default.config.mediaurl),r=e&&-1===e.indexOf("static")&&-1===e.indexOf("media");return""+t+(e?n?e:r?""+i.default.config.mediaurl+e:s:s)}}},t.exports.__esModule&&(t.exports=t.exports.default);var i,a,o,s,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"container",attrs:{id:"menu-projects"}},[r("div",{staticClass:"row row-equal"},[n._l(n.state.menuitems,function(t){return r("div",{key:t.title,staticClass:"col-xs-12 col-sm-4 project-menu",on:{click:function(e){return n.trigger(t)}}},[r("div",{staticClass:"project-menu-item-image"},[r("img",{staticClass:"img-responsive",attrs:{src:n.logoSrc(t.thumbnail)}})]),n._v(" "),r("div",{staticClass:"project-menu-item-content"},[r("div",{staticClass:"project-menu-item-text"},[r("h4",{staticClass:"project-menu-item-title"},[n._v(n._s(t.title))]),n._v(" "),r("div",{domProps:{innerHTML:n._s(t.description)}})])])])}),n._v(" "),n.state.menuitems.length?n._e():r("div",{staticStyle:{"margin-left":"15px"}},[r("h2",{directives:[{name:"t",rawName:"v-t",value:"no_other_projects",expression:"'no_other_projects'"}]})])],2)])},e.staticRenderFns=[]},{"core/i18n/i18n.service":12,"services/gui":302,"store/projects":317}],212:[function(e,t,n){var i,u,c,d,p,r,f,h,a,o,s,l,g,v,m,y;e("vueify/lib/insert-css").insert("#query_builder[data-v-81e8d74e]{flex-wrap:nowrap!important}#querybuilder-manual[data-v-81e8d74e]{display:flex;justify-content:space-between;align-items:stretch;border:0}#querybuilder-manual>span[data-v-81e8d74e]{cursor:pointer;font-size:1.2em;background-color:#fff;color:#000;padding:8px}#query_builder_operators[data-v-81e8d74e]{margin-top:auto!important}#query_builder_expression_content>textarea[data-v-81e8d74e]{width:100%;resize:none;height:100px;color:#000}");function _(e){return e&&e.__esModule?e:{default:e}}function b(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function w(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),i=e("app/constant"),u=_(e("store/application-state")),c=_(e("store/catalog-layers")),d=_(e("store/projects")),p=_(e("services/application")),r=_(e("services/data")),f=_(e("services/gui")),h=e("utils/getUniqueDomId"),a=e("utils/createFilterFromString"),o=e("utils/XHR"),y=e("core/i18n/i18n.service").t,n.default={name:"query-builder",data:function(){return{edit:void 0!==this.$options.options,currentlayer:null,message:"",filter:void 0!==this.$options.options?this.$options.options.filter:"",loading:{test:!1,values:!1},values:[],manual:!0,manualvalue:null,select:{field:null,value:null}}},computed:{fields:function(){return this.currentlayer?this.currentlayer.fields:[]},disabled:function(){return!this.filter}},watch:{"select.field":function(){this.values=[],this.manual=!0}},methods:{addToExpression:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.value;switch(e.type){case"operator":t=" "+t+" ";break;case"field":t='"'+t+'"';break;case"value":t="'"+t+"'"}t&&(this.filter=""+this.filter+t)},all:(m=w(function*(){this.loading.values=!0;try{var e,t=this.currentlayer.id,n=this.select.field,r=u.default.querybuilder.cache;r[t]=r[t]||{},void 0!==r[t][n]?this.values=r[t][n]:((e=yield o.XHR.get({url:c.default.getLayerById(t).getUrl("data"),params:{ordering:n,unique:n}})).result&&(r[t][n]=r[t][n]||e.data),this.values=r[t][n]||[])}catch(e){}this.loading.values=!1,yield this.$nextTick(),this.manualvalue=null,this.manual=!1}),function(){return m.apply(this,arguments)}),reset:function(){this.filter="",this.message="",this.filterElement.previous=null,this.filterElement.current=null,this.filterElement.operator=null},test:(v=w(function*(){var e=yield this.run(!1),e=e.length&&e[0].features.length;this.message=void 0!==e?" "+e:"",yield this.$nextTick()}),function(){return v.apply(this,arguments)}),run:(g=w(function*(){var t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];try{this.loading.test=!0;var e=c.default.getLayerById(this.currentlayer.id);return(yield r.default.getData("search:features",{inputs:{layer:e,filter:(0,a.createFilterFromString)({layer:e,filter:this.filter}),feature_count:100},outputs:t})).data}catch(e){t||(f.default.showUserMessage({type:"alert",message:"sdk.querybuilder.error_run",autoclose:!0}),this.message=y("sdk.querybuilder.error_test"))}finally{this.loading.test=!1}}),function(){return g.apply(this,arguments)}),save:(l=w(function*(){var e,t,n,r=this.projectId||d.default.getCurrentProject().getId(),i=this.edit&&this.$options.options.id,a=p.default.getLocalItem("QUERYBUILDERSEARCHES");try{var o,s={layerId:this.currentlayer.id,filter:this.filter,layerName:c.default.getLayerById(this.currentlayer.id).getName(),name:i?this.edit&&this.$options.options.name:yield new Promise(function(t,n){f.default.dialog.confirm(y("sdk.querybuilder.additem"),function(e){return e?t(e):n()})}),id:i||(0,h.getUniqueDomId)()};i?-1!==(o=a[r].findIndex(function(e){return e.id===s.id}))&&(a[r][o]=s):(f.default.getService("search").addQueryBuilderSearch(s),void 0===a?(n=[s],(t=r)in(e={})?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,a=e):a[r]=[].concat(b(a[r]||[]),[s]))}catch(e){return}var l=u.default.querybuilder.searches;p.default.setLocalItem({id:"QUERYBUILDERSEARCHES",data:a}),setTimeout(function(){a[r].forEach(function(e){return l[r].push(e)})},0),l[r].splice(0),f.default.showUserMessage({type:"success",message:y("sdk.querybuilder.messages.changed"),autoclose:!0})}),function(){return l.apply(this,arguments)})},created:function(){var t=this,r=(this.filterElement={current:null,previous:null,operator:null},d.default.getCurrentProject());this.layers=r.getLayers().filter(function(e){return!e.baselayer&&Array.isArray(e.fields)}).map(function(e){var n=[];return r.getRelationsByLayerId({layerId:e.id,type:"ONE"}).forEach(function(t){var e=r.getLayerById(t.referencingLayer);t.customPrefix=void 0===t.customPrefix?e.getName()+"_":t.customPrefix,n=[].concat(b(n),b(e.getFields().map(function(e){return""+t.customPrefix+e.name})))}),{id:e.id,label:e.name,fields:e.fields.filter(function(e){return e.show}).map(function(e){return{label:e.label,name:e.name}}).filter(function(e){return-1===n.indexOf(e)})}}),this.operators=Object.values(i.FILTER_OPERATORS),this.currentlayer=this.edit?this.layers.find(function(e){return e.id===t.$options.options.layerId}):this.layers[0]},mounted:(s=w(function*(){var t=this;yield this.$nextTick(),this.select2=$("#query_builder_layers_select").select2({width:"100%"}),this.edit&&(this.select2.val(this.layers.indexOf(this.currentlayer)),this.select2.trigger("change")),this.select2.on("select2:select",function(e){t.currentlayer=t.layers[e.params.data.id],t.select.field=null,t.select.value=null,t.reset()})}),function(){return s.apply(this,arguments)}),beforeDestroy:function(){this.select2.select2("destroy"),this.select2=null}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"form-group",attrs:{id:"query_builder"}},[r("div",{attrs:{id:"query_builder_header"}}),n._v(" "),r("div",{staticClass:"margin-between-element",attrs:{id:"query_builder_layers"}},[r("label",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.layers",expression:"'sdk.querybuilder.panel.layers'"}],staticClass:"querybuilder-title"}),n._v(" "),r("select",{staticClass:"form-control",attrs:{id:"query_builder_layers_select"}},n._l(n.layers,function(e,t){return r("option",{key:e.label,staticClass:"bold",domProps:{value:t}},[n._v(n._s(e.label))])}),0)]),n._v(" "),r("div",{staticClass:"margin-between-element",attrs:{id:"query_builder_fields"}},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.fields",expression:"'sdk.querybuilder.panel.fields'"}],staticClass:"querybuilder-title",attrs:{id:"query_builder_fields_title"}}),n._v(" "),r("div",{staticClass:"querybuilder-content",attrs:{id:"query_builder_fields_content"}},[r("table",{staticClass:"table table-striped content-table"},[r("tbody",n._l(n.fields,function(t){return r("tr",{key:t.name,class:{"skin-background-color lighten":n.select.field===t.name},staticStyle:{cursor:"pointer"},on:{click:function(e){n.select.field=t.name},dblclick:function(e){return n.addToExpression({value:t.name,type:"field"})}}},[r("th",{attrs:{scope:"row"}},[n._v(n._s(t.label))])])}),0)])])]),n._v(" "),r("div",{staticClass:"margin-between-element",attrs:{id:"query_builder_values"}},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.values",expression:"'sdk.querybuilder.panel.values'"}],staticClass:"querybuilder-title",attrs:{id:"query_builder_values_title"}}),n._v(" "),n.manual?r("div",{staticClass:"margin-between-element",attrs:{id:"querybuilder-manual"}},[r("input",{directives:[{name:"model",rawName:"v-model",value:n.manualvalue,expression:"manualvalue"}],staticClass:"form-control",domProps:{value:n.manualvalue},on:{input:function(e){e.target.composing||(n.manualvalue=e.target.value)}}}),n._v(" "),r("span",{class:n.g3wtemplate.getFontClass("plus"),on:{click:function(e){n.manualvalue&&n.addToExpression({value:n.manualvalue,type:"value"})}}})]):r("div",{staticClass:"querybuilder-content margin-between-element",attrs:{id:"query_builder_values_content"}},[r("bar-loader",{attrs:{loading:n.loading.values}}),n._v(" "),r("table",{staticClass:"table table-striped content-table"},[r("tbody",[n._l(n.values,function(t){return r("tr",{key:t,class:{"skin-background-color lighten":n.select.value===t},staticStyle:{cursor:"pointer"},on:{click:function(e){n.select.value=t},dblclick:function(e){return n.addToExpression({value:t,type:"value"})}}},[r("th",{attrs:{scope:"row"}},[n._v(n._s(t))])])}),n._v(" "),n._m(0)],2)])],1),n._v(" "),r("div",{staticClass:"content-end skin-color",attrs:{id:"query_builder_values_buttons"}},[r("button",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.button.manual",expression:"'sdk.querybuilder.panel.button.manual'"}],staticClass:"query_builder_button btn btn-secondary bold",class:{"skin-border-color":n.manual},attrs:{id:"query_builder_values_buttons_sample"},on:{click:function(e){n.manual=!0}}}),n._v(" "),r("button",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.button.all",expression:"'sdk.querybuilder.panel.button.all'"}],staticClass:"query_builder_button btn btn-secondary bold",class:{"skin-border-color":!n.manual},attrs:{id:"query_builder_values_buttons_all",disabled:null===n.select.field},on:{click:n.all}})])]),n._v(" "),r("div",{staticClass:"margin-between-element",attrs:{id:"query_builder_operators"}},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.operators",expression:"'sdk.querybuilder.panel.operators'"}],staticClass:"querybuilder-title",attrs:{id:"query_builder_operators_title"}}),n._v(" "),r("div",{staticClass:"content-wrap",attrs:{id:"query_builder_operators_content"}},n._l(n.operators,function(t){return r("button",{key:t,staticClass:"query_builder_button btn btn-secondary skin-color bold",on:{click:function(e){return n.addToExpression({value:t,type:"operator"})}}},[n._v(n._s(t))])}),0)]),n._v(" "),r("div",{attrs:{id:"query_builder_footer"}},[r("div",{attrs:{id:"query_builder_expression"}},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.expression",expression:"'sdk.querybuilder.panel.expression'"}],staticClass:"querybuilder-title",attrs:{id:"query_builder_expression_title"}}),n._v(" "),r("div",{attrs:{id:"query_builder_expression_content"}},[r("textarea",{directives:[{name:"model",rawName:"v-model",value:n.filter,expression:"filter"}],domProps:{value:n.filter},on:{input:function(e){e.target.composing||(n.filter=e.target.value)}}})])]),n._v(" "),r("div",{staticClass:"margin-between-element",attrs:{id:"query_builder_message"}},[r("bar-loader",{attrs:{loading:n.loading.test}}),n._v(" "),r("span",{directives:[{name:"show",rawName:"v-show",value:n.message,expression:"message"},{name:"t",rawName:"v-t",value:"sdk.querybuilder.messages.number_of_features",expression:"'sdk.querybuilder.messages.number_of_features'"}],staticClass:"bold skin-color"}),n._v(" "),r("span",{staticClass:"bold skin-color"},[n._v(n._s(n.message))])],1),n._v(" "),r("div",{staticClass:"content-end margin-between-element",attrs:{id:"query_builder_footer_buttons"}},[r("button",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.button.test",expression:"'sdk.querybuilder.panel.button.test'"}],staticClass:"query_builder_button btn btn-secondary bold",attrs:{disabled:n.disabled},on:{click:n.test}}),n._v(" "),r("button",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.button.clear",expression:"'sdk.querybuilder.panel.button.clear'"}],staticClass:"query_builder_button btn btn-secondary bold",on:{click:n.reset}}),n._v(" "),r("button",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.button.run",expression:"'sdk.querybuilder.panel.button.run'"}],staticClass:"query_builder_button btn btn-secondary bold",attrs:{disabled:n.disabled},on:{click:n.run}}),n._v(" "),r("button",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.button.save",expression:"'sdk.querybuilder.panel.button.save'"}],staticClass:"query_builder_button btn btn-secondary bold",attrs:{disabled:n.disabled},on:{click:n.save}})])])])},e.staticRenderFns=[function(){var e=this.$createElement,e=this._self._c||e;return e("tr",[e("th",{attrs:{scope:"row"}})])}],e._scopeId="data-v-81e8d74e"},{"app/constant":5,"core/i18n/i18n.service":12,"services/application":298,"services/data":300,"services/gui":302,"store/application-state":310,"store/catalog-layers":311,"store/projects":317,"utils/XHR":319,"utils/createFilterFromString":345,"utils/getUniqueDomId":397,"vueify/lib/insert-css":2}],213:[function(e,t,n){var c,r,i,a,o,s,l,u,d,p,f;e("vueify/lib/insert-css").insert(".feature_attributes tr[data-v-09a18998]{line-height:1.8em}");function h(e){return e&&e.__esModule?e:{default:e}}function g(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},r=e("mixins"),i=h(e("components/QueryResultsTableAttributeFieldValue.vue")),a=h(e("components/QueryResultsActionInfoFormats.vue")),o=h(e("components/QueryResultsHeaderFeatureBody.vue")),s=h(e("components/QueryResultsHeaderFeatureActionsBody.vue")),l=e("utils"),f=["varchar","integer","float","bigint","date"],n.default={name:"queryresults",data:function(){return{state:this.$options.service.state,headerExpandActionCellWidth:10,headerActionsCellWidth:10}},mixins:[r.fieldsMixin],components:{TableAttributeFieldValue:i.default,infoformats:a.default,"header-feature-body":o.default,HeaderFeatureActionsBody:s.default},computed:{onelayerresult:function(){return 1===this.state.layers.length},hasLayers:function(){return this.hasResults||!!this.state.components.length},hasResults:function(){return 0<this.state.layers.length},info:function(){if(this.state.query){var e=this.state.query;switch(e.type){case"coordinates":return{icon:"marker",message:"  "+e.coordinates[0]+", "+e.coordinates[1]};case"bbox":return{icon:"square",message:"  ["+e.bbox.join(" , ")+"]"};case"polygon":case"drawpolygon":return{icon:"draw",message:e.layerName?e.layerName+" "+(void 0!==e.fid?" - Feature Id: "+e.fid:""):" "}}}else this.state.search;return{icon:null,message:null}}},methods:{showLayer:function(e){return e.show&&(this.layerHasFeatures(e)||e.rawdata||Array.isArray(e.infoformats)&&0<e.infoformats.length)},getLayerCustomComponents:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"feature";return this.state.layerscustomcomponents[e]&&this.state.layerscustomcomponents[e][t]&&this.state.layerscustomcomponents[e][t][2<arguments.length&&void 0!==arguments[2]?arguments[2]:"after"]||[]},getLayerField:function(e){var t=e.layer,n=e.feature,r=e.fieldName,e=t.attributes.find(function(e){return r===e.name});return c({},e,{label:null,value:n.attributes[r]})},getQueryFields:function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e.formStructure.fields[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var l=o.value,u=c({},l);u.query=!0,u.value=t.attributes[l.name],u.input={type:""+this.getFieldType(u)},n.push(u)}}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n},getColSpan:function(e){return this.attributesSubsetLength(e)+ +!this.hasLayerOneFeature(e)},getDownloadActions:function(e){return this.state.layersactions[e.id].find(function(e){return e.formats})},addLayerFeaturesToResults:function(e){this.$options.service.addLayerFeaturesToResultsAction(e)},showDownloadAction:function(e){var t=e.target.children[0].style.display;e.target.children[0].style.display="none"===t?"inline-block":"none"},printAtlas:function(e){this.$options.service.printAtlas(e)},showLayerDownloadFormats:function(e){this.$options.service.showLayerDownloadFormats(e)},saveLayerResult:function(e){this.$options.service.saveLayerResult({layer:e,type:1<arguments.length&&void 0!==arguments[1]?arguments[1]:"csv"})},hasLayerOneFeature:function(e){return 1===e.features.length},saveFilter:function(e){this.$options.service.saveFilter(e)},addRemoveFilter:function(e){this.$options.service.addRemoveFilter(e)},getContainerFromFeatureLayer:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,e=e.index;return $("#"+t.id+"_"+e+" > td")},hasOneLayerAndOneFeature:function(e){return this.hasLayerOneFeature(e)},hasFormStructure:function(e){return!!e.formStructure},layerHasFeatures:function(e){return Array.isArray(e.features)&&0<e.features.length},selectionFeaturesLayer:function(e){this.$options.service.selectionFeaturesLayer(e)},layerHasActions:function(e){return 0<this.state.layersactions[e.id].length},featureHasActions:function(e,t){return this.geometryAvailable(t)},geometryAvailable:function(e){return!!e.geometry},extractAttributesFromFirstTabOfFormStructureLayers:function(r){var i=this,a=new Set;return r.formStructure.structure.length&&r.formStructure.structure.forEach(function e(t){var n;t.nodes?t.nodes.forEach(e):(n=r.formStructure.fields.find(function(e){return e.name===t.field_name}))&&("ows"===i.state.type&&((n=c({},n)).name=n.name.replace(/ /g,"_")),a.add(n))}),Array.from(a)},attributesSubset:function(e){var e=this.hasFormStructure(e)?this.extractAttributesFromFirstTabOfFormStructureLayers(e):e.attributes,t=e.filter(function(e){return e.show&&-1!==f.indexOf(e.type)}),e=Math.min(3,e.length);return t.slice(0,e)},relationsAttributesSubset:function(e){var n=[],e=(_.forEach(e,function(e,t){Array.isArray(e)||n.push({label:t,value:e})}),Math.min(3,n.length));return n.slice(0,e)},relationsAttributes:function(e){var n=[];return _.forEach(e,function(e,t){n.push({label:t,value:e})}),n},attributesSubsetLength:function(e){return this.attributesSubset(e).length},cellWidth:function(e,t){var n=3+this.state.layersactions[t.id].length,r=this.attributesSubsetLength(t),n=n-r,t=(90-(t.hasgeometry?10:0))/3;return e===r-1&&0<n?t*(1+n):t},featureBoxColspan:function(e){var t=this.attributesSubsetLength(e);return e.expandable&&(t+=1),e.hasgeometry&&(t+=1),t},relationsAttributesSubsetLength:function(e){return this.relationsAttributesSubset(e).length},getLayerFormStructure:function(e){return e.formStructure.structure.map(function(e){return Vue.observable(structuredClone(e))})},isAttributeOrTab:function(e,t){var n=void 0!==t.field_name;return{type:n?"field":"tab",item:n&&this.getLayerAttributeFromStructureItem(e,t.field_name)||[t]}},getLayerAttributeFromStructureItem:function(e,t){return e.attributes.find(function(e){return t===e.name})},getLayerFeatureBox:function(n,r,e){var i=this,t=this.getBoxId(n,r,e);return void 0===this.state.layersFeaturesBoxes[t]&&(this.state.layersFeaturesBoxes[t]=Vue.observable({collapsed:!0}),this.$watch(function(){return i.state.layersFeaturesBoxes[t].collapsed},function(e){var t=n.features.findIndex(function(e){return r.id===e.id}),t=i.getContainerFromFeatureLayer({layer:n,index:t});i.$options.service.openCloseFeatureResult({open:!e,layer:n,feature:r,container:t})}),this.state.layersFeaturesBoxes[t].collapsed=1<n.features.length),this.state.layersFeaturesBoxes[t]},collapsedFeatureBox:function(e,t,n){e=this.state.layersFeaturesBoxes[this.getBoxId(e,t,n)];return!e||e.collapsed},showFeatureInfo:function(e,t){t=this.state.layersFeaturesBoxes[t];this.$options.service.emit("show-query-feature-info",{layer:e,tabs:this.hasFormStructure(e),show:!!t&&!t.collapsed})},getBoxId:function(e,t,n){return this.$options.service.getBoxId(e,t,n)},toggleFeatureBox:(p=g(function*(e,t,n){t=this.getBoxId(e,t,n);this.state.layersFeaturesBoxes[t].collapsed=!this.state.layersFeaturesBoxes[t].collapsed,yield this.$nextTick(),this.showFeatureInfo(e,t)}),function(e,t,n){return p.apply(this,arguments)}),toggleFeatureBoxAndZoom:function(e,t,n){this.hasLayerOneFeature(e)||this.toggleFeatureBox(e,t,n)},trigger:(d=g(function*(e,t,n,r){e.opened&&"none"===$("#"+t.id+"_"+r).css("display")&&(this.toggleFeatureBox(t,n),yield this.$nextTick()),yield this.$options.service.trigger(e.id,t,n,r,this.getContainerFromFeatureLayer({layer:t,index:r}))}),function(e,t,n,r){return d.apply(this,arguments)}),showFullPhoto:function(e){this.$options.service.showFullPhoto(e)},openLink:function(e){window.open(e,"_blank")},isJSON:function(e){return!this.isVue(e)&&this.isSimple(e)&&"Object"===(0,l.toRawType)(e.value)}},watch:{"state.layers":(u=g(function*(){var e,t,a=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];n.forEach(function(i){i.attributes.length<=3&&!i.hasImageField&&(i.expandable=!1),i.features.forEach(function(r){a.getLayerFeatureBox(i,r),r.attributes.relations&&r.attributes.relations.forEach(function(n){n.elements.forEach(function(e,t){return a.state.layersFeaturesBoxes[i.id+"_"+r.id+"_"+n.name+t]={collapsed:!0}})})})}),this.onelayerresult&&this.hasLayerOneFeature(n[0])&&(n=(e=n[0]).features[0],t=this.getBoxId(e,n),this.$options.service.onceafter("postRender",function(){a.showFeatureInfo(e,t)})),requestAnimationFrame(function(){return a.$options.service.postRender(a.$el)}),yield this.$nextTick()}),function(){return u.apply(this,arguments)}),onelayerresult:function(e){e&&this.$options.service.highlightFeaturesPermanently(this.state.layers[0])}},created:function(){var t=this;this.zoomToLayerFeaturesExtent=(0,l.throttle)(function(e){t.$options.service.zoomToLayerFeaturesExtent(e,{highlight:!0})})},beforeDestroy:function(){this.state.zoomToResult=!0},destroyed:function(){this.$options.service.clear()}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var a=this,e=a.$createElement,o=a._self._c||e;return o("div",{staticClass:"queryresults-wrapper",attrs:{id:"search-results"}},[a.info.message?o("div",{staticClass:"skin-color",staticStyle:{"font-weight":"bold","margin-bottom":"3px","font-size":"1.1em"}},[a.info.icon?o("span",{staticClass:"action-button skin-tooltip-bottom",class:a.g3wtemplate.getFontClass(a.info.icon)}):a._e(),a._v(" "),o("span",[a._v(a._s(a.info.message))])]):a._e(),a._v(" "),o("div",{staticClass:"queryresults-container"},[a.state.layers.length?[a.hasLayers?o("ul",{staticClass:"queryresults",staticStyle:{position:"relative"},attrs:{id:"queryresults"}},[a._l(a.state.layers,function(r){return o("li",{directives:[{name:"show",rawName:"v-show",value:a.showLayer(r),expression:"showLayer(layer)"}]},[o("bar-loader",{attrs:{loading:r.loading}}),a._v(" "),o("div",{staticClass:"box box-primary"},[o("div",{staticClass:"box-header with-border",class:{mobile:a.isMobile()},attrs:{"data-widget":"collapse"}},[o("div",{staticClass:"box-title query-layer-title",style:{fontSize:a.isMobile()&&"1em !important"}},[a._v(a._s(r.title)+"\n                "),o("span",{directives:[{name:"show",rawName:"v-show",value:!r.rawdata,expression:"!layer.rawdata"}],staticClass:"query-layer-feature-count"},[a._v("("+a._s(r.features.length)+")")])]),a._v(" "),o("div",{staticClass:"box-features-action",on:{click:function(e){e.stopPropagation()}}},[o("infoformats",{attrs:{layer:r}}),a._v(" "),1<r.features.length?[r.hasgeometry?o("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"sdk.mapcontrols.query.actions.zoom_to_features_extent.hint",expression:"'sdk.mapcontrols.query.actions.zoom_to_features_extent.hint'",arg:"left",modifiers:{create:!0}}],staticClass:"action-button",on:{click:function(e){return e.stopPropagation(),a.zoomToLayerFeaturesExtent(r)}}},[o("span",{staticClass:"action-button-icon",class:a.g3wtemplate.getFontClass("marker")})]):a._e(),a._v(" "),r.atlas.length?o("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"sdk.mapcontrols.query.actions.atlas.hint",expression:"'sdk.mapcontrols.query.actions.atlas.hint'",arg:"left",modifiers:{create:!0}},{name:"download",rawName:"v-download"}],staticClass:"action-button",on:{click:function(e){return e.stopPropagation(),a.printAtlas(r)}}},[o("span",{staticClass:"action-button-icon",class:a.g3wtemplate.getFontClass("print")})]):a._e(),a._v(" "),1===r.downloads.length?[o("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"sdk.mapcontrols.query.actions.download_features_"+r.downloads[0]+".hint",expression:"`sdk.mapcontrols.query.actions.download_features_${layer.downloads[0]}.hint`",arg:"left",modifiers:{create:!0}},{name:"download",rawName:"v-download"}],staticClass:"action-button",class:{toggled:r[r.downloads[0]].active}},[o("span",{staticClass:"action-button-icon",class:a.g3wtemplate.getFontClass("download"),on:{click:function(e){return e.stopPropagation(),a.saveLayerResult(r,r.downloads[0])}}})])]:1<r.downloads.length?[o("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"Downloads",expression:"'Downloads'",arg:"left",modifiers:{create:!0}},{name:"download",rawName:"v-download"}],staticClass:"action-button",class:{toggled:r.downloadformats.active}},[o("span",{staticClass:"action-button-icon",class:a.g3wtemplate.getFontClass("download"),on:{click:function(e){return e.stopPropagation(),a.showLayerDownloadFormats(r)}}})])]:a._e()]:a._e(),a._v(" "),r.external||r.source&&"wms"!==r.source.type?o("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"sdk.mapcontrols.query.actions.add_features_to_results.hint",expression:"'sdk.mapcontrols.query.actions.add_features_to_results.hint'",arg:"left",modifiers:{create:!0}}],staticClass:"action-button",class:{toggled:r.addfeaturesresults.active},on:{click:function(e){return e.stopPropagation(),a.addLayerFeaturesToResults(r)}}},[o("span",{staticClass:"action-button-icon",class:a.g3wtemplate.getFontClass("plus-square")})]):a._e(),a._v(" "),r.toc&&"__g3w_marker"!==r.id&&1<r.features.length&&(r.external||r.source&&"wms"!==r.source.type)?o("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"sdk.mapcontrols.query.actions.add_selection.hint",expression:"'sdk.mapcontrols.query.actions.add_selection.hint'",arg:"left",modifiers:{create:!0}}],staticClass:"action-button skin-tooltip-left",class:{toggled:r.selection.active},on:{click:function(e){return e.stopPropagation(),a.selectionFeaturesLayer(r)}}},[o("span",{staticClass:"action-button-icon",class:a.g3wtemplate.getFontClass("success")})]):a._e(),a._v(" "),!r.external&&r.selection.active?[o("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"layer_selection_filter.tools.filter",expression:"'layer_selection_filter.tools.filter'",arg:"left",modifiers:{create:!0}}],staticClass:"action-button skin-tooltip-left",class:{toggled:r.filter.active},on:{click:function(e){return e.stopPropagation(),a.addRemoveFilter(r)}}},[o("span",{staticClass:"action-button-icon",class:a.g3wtemplate.getFontClass("filter")})]),a._v(" "),r.filter.active&&(null===r.filter.current||r.selection.active)?o("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"layer_selection_filter.tools.savefilter",expression:"'layer_selection_filter.tools.savefilter'",arg:"left",modifiers:{create:!0}}],staticClass:"action-button skin-tooltip-left",on:{click:function(e){return e.stopPropagation(),a.saveFilter(r)}}},[o("span",{staticClass:"action-button-icon",class:a.g3wtemplate.getFontClass("save")})]):a._e()]:a._e()],2),a._v(" "),o("button",{staticClass:"btn btn-box-tool",attrs:{"data-widget":"collapse"}},[o("i",{staticClass:"btn-collapser skin-color",class:a.g3wtemplate.font.minus})])]),a._v(" "),a.state.layeractiontool[r.id].component?[o("div",{staticClass:"g3w-layer-action-tools with-border",class:{mobile:a.isMobile()},staticStyle:{padding:"5px"}},[o(a.state.layeractiontool[r.id].component,{tag:"component",attrs:{layer:r,config:a.state.layeractiontool[r.id].config}})],1)]:a._e(),a._v(" "),a._l(a.getLayerCustomComponents(r.id,"layer","before"),function(e){e=e.component;return o(e,{tag:"component",attrs:{layer:r}})}),a._v(" "),o("div",{staticClass:"box-body",class:{mobile:a.isMobile()}},[r.rawdata?[o("div",{staticClass:"queryresults-text-html",class:{text:"text/plain"===r.infoformat},domProps:{innerHTML:a._s(r.rawdata)}})]:a.hasFormStructure(r)?[o("table",{staticClass:"table",class:{mobile:a.isMobile()}},[o("tbody",[a._l(r.features,function(n,e){return n.show?[o("header-feature-actions-body",{attrs:{colspan:a.getColSpan(r),actions:a.state.layersactions[r.id],layer:r,feature:n,index:e,onelayerresult:a.onelayerresult,trigger:a.trigger,toggleFeatureBoxAndZoom:a.toggleFeatureBoxAndZoom,hasLayerOneFeature:a.hasLayerOneFeature,boxLayerFeature:a.getLayerFeatureBox(r,n),attributesSubset:a.attributesSubset,getLayerField:a.getLayerField}}),a._v(" "),o("tr",{staticClass:"g3w-feature-result-action-tools"},[a.state.currentactiontools[r.id][e]?[o("td",{attrs:{colspan:a.getColSpan(r)}},[o(a.state.currentactiontools[r.id][e],{tag:"component",attrs:{colspan:a.getColSpan(r),layer:r,feature:n,featureIndex:e,config:a.state.actiontools[a.state.currentactiontools[r.id][e].name][r.id]}})],1)]:a._e()],2),a._v(" "),a.hasLayerOneFeature(r)?a._e():o("tr",{staticStyle:{"font-weight":"bold","text-align":"center"}},[a._l(a.attributesSubset(r),function(e,t){return o("td",{staticClass:"centered"},[a._v("\n                            "+a._s(a.getLayerFeatureBox(r,n).collapsed?e.label:"")+"\n                          ")])}),a._v(" "),o("td",{staticClass:"collapsed",class:{noAttributes:0===a.attributesSubset(r).length},staticStyle:{"text-align":"end"},on:{click:function(e){return e.stopPropagation(),a.toggleFeatureBoxAndZoom(r,n)}}},[o("span",{staticClass:"fa link morelink skin-color",class:a.g3wtemplate.font[a.getLayerFeatureBox(r,n).collapsed?"plus":"minus"]})])],2),a._v(" "),!a.hasLayerOneFeature(r)&&a.getLayerFeatureBox(r,n).collapsed?o("header-feature-body",{attrs:{actions:a.state.layersactions[r.id],layer:r,feature:n,index:e,onelayerresult:a.onelayerresult,trigger:a.trigger,toggleFeatureBoxAndZoom:a.toggleFeatureBoxAndZoom,hasLayerOneFeature:a.hasLayerOneFeature,boxLayerFeature:a.getLayerFeatureBox(r,n),attributesSubset:a.attributesSubset,getLayerField:a.getLayerField}}):a._e(),a._v(" "),a._l(a.getLayerCustomComponents(r.id,"feature","before"),function(e){e=e.component;return o("tr",[o("td",{attrs:{colspan:a.getColSpan(r)}},[o(e,{tag:"component",attrs:{layer:r,feature:n}})],1)])}),a._v(" "),o("tr",{directives:[{name:"show",rawName:"v-show",value:!a.collapsedFeatureBox(r,n)||a.hasOneLayerAndOneFeature(r),expression:"!collapsedFeatureBox(layer,feature) || hasOneLayerAndOneFeature(layer)"}],staticClass:"featurebox-body",attrs:{id:r.id+"_"+e}},[o("td",{attrs:{colspan:a.getColSpan(r)}},[o("tabs",{attrs:{fields:a.getQueryFields(r,n),layerid:r.id,feature:n,tabs:a.getLayerFormStructure(r)}})],1)]),a._v(" "),a._l(a.getLayerCustomComponents(r.id,"feature","after"),function(e){e=e.component;return o("tr",[o("td",{attrs:{colspan:a.getColSpan(r)}},[o(e,{tag:"component",attrs:{layer:r,feature:n}})],1)])})]:a._e()})],2)])]:[o("table",{staticClass:"table",class:{mobile:a.isMobile()}},a._l(r.features,function(n,e){return n.show?o("tbody",{key:n.id},[o("header-feature-actions-body",{attrs:{colspan:a.getColSpan(r),actions:a.state.layersactions[r.id],layer:r,feature:n,index:e,onelayerresult:a.onelayerresult,trigger:a.trigger,toggleFeatureBoxAndZoom:a.toggleFeatureBoxAndZoom,hasLayerOneFeature:a.hasLayerOneFeature,boxLayerFeature:a.getLayerFeatureBox(r,n),attributesSubset:a.attributesSubset,getLayerField:a.getLayerField}}),a._v(" "),o("tr",{staticClass:"g3w-feature-result-action-tools"},[a.state.currentactiontools[r.id][e]?[o("td",{attrs:{colspan:a.getColSpan(r)}},[o(a.state.currentactiontools[r.id][e],{tag:"component",attrs:{colspan:a.getColSpan(r),layer:r,feature:n,featureIndex:e,config:a.state.actiontools[a.state.currentactiontools[r.id][e].name][r.id]}})],1)]:a._e()],2),a._v(" "),a.hasLayerOneFeature(r)?a._e():o("tr",{staticStyle:{"font-weight":"bold","text-align":"center"}},[a._l(a.attributesSubset(r),function(e,t){return o("td",{staticClass:"centered"},[a._v("\n                        "+a._s(a.getLayerFeatureBox(r,n).collapsed?e.label:"")+"\n                      ")])}),a._v(" "),o("td",{staticClass:"collapsed",class:{noAttributes:0===a.attributesSubset(r).length},staticStyle:{"text-align":"end"},on:{click:function(e){return e.stopPropagation(),a.toggleFeatureBoxAndZoom(r,n)}}},[o("span",{staticClass:"fa link morelink skin-color",class:a.g3wtemplate.font[a.getLayerFeatureBox(r,n).collapsed?"plus":"minus"]})])],2),a._v(" "),!a.hasLayerOneFeature(r)&&a.getLayerFeatureBox(r,n).collapsed?o("header-feature-body",{attrs:{actions:a.state.layersactions[r.id],layer:r,feature:n,index:e,onelayerresult:a.onelayerresult,trigger:a.trigger,toggleFeatureBoxAndZoom:a.toggleFeatureBoxAndZoom,hasLayerOneFeature:a.hasLayerOneFeature,boxLayerFeature:a.getLayerFeatureBox(r,n),attributesSubset:a.attributesSubset,getLayerField:a.getLayerField}}):a._e(),a._v(" "),a._l(a.getLayerCustomComponents(r.id,"feature","before"),function(e){e=e.component;return o("tr",[o("td",{attrs:{colspan:a.getColSpan(r)}},[o(e,{tag:"component",staticClass:"box-body",attrs:{layer:r,feature:n}})],1)])}),a._v(" "),o("tr",{directives:[{name:"show",rawName:"v-show",value:!a.collapsedFeatureBox(r,n)||a.hasOneLayerAndOneFeature(r),expression:"!collapsedFeatureBox(layer,feature) || hasOneLayerAndOneFeature(layer)"}],staticClass:"featurebox-body",attrs:{id:r.id+"_"+e}},[o("td",{attrs:{colspan:a.getColSpan(r)}},[o("table",{staticClass:"feature_attributes"},[a._l(r.attributes.filter(function(e){return e.show}),function(i){return[a.isJSON(a.getLayerField({layer:r,feature:n,fieldName:i.name}))?[a._l(a.getLayerField({layer:r,feature:n,fieldName:i.name}).value,function(n,r){var e;return a._l("object"==typeof n?n:((e={})[r]=n,e),function(e,t){return o("tr",{staticStyle:{"padding-top":"10px","padding-bottom":"10px"}},[o("td",{staticClass:"attr-label"},[a._v(a._s(i.label)+"."),"object"==typeof n?[a._v(a._s(r)+".")]:a._e(),a._v(a._s(t))],2),a._v(" "),o("td",{staticClass:"attr-value"},[a._v(a._s(e))])])})})]:o("tr",[o("td",{staticClass:"attr-label"},[a._v(a._s(i.label))]),a._v(" "),o("td",{staticClass:"attr-value",attrs:{attribute:i.name}},[o("table-attribute-field-value",{attrs:{feature:n,field:a.getLayerField({layer:r,feature:n,fieldName:i.name})}})],1)])]})],2)])]),a._v(" "),a._l(a.getLayerCustomComponents(r.id,"feature","after"),function(e){e=e.component;return o("tr",[o("td",{attrs:{colspan:"getColSpan(layer)"}},[o(e,{tag:"component",staticClass:"box-body",attrs:{layer:r,feature:n}})],1)])})],2):o("tbody")}),0)]],2),a._v(" "),a._l(a.getLayerCustomComponents(r.id,"layer","after"),function(e){e=e.component;return o("div",{staticClass:"box-body",class:{mobile:a.isMobile()}},[o(e,{tag:"component",attrs:{layer:r}})],1)})],2)],1)}),a._v(" "),a._l(a.state.components,function(e){return o("li",[o(e,{tag:"component",on:{showresults:function(e){return a.showResults()}}})],1)})],2):a._e()]:[a.state.changed?o("div",{staticClass:"query-results-not-found"},[o("h4",{directives:[{name:"t",rawName:"v-t",value:"info.no_results",expression:"'info.no_results'"}],staticClass:"skin-color",staticStyle:{"font-weight":"bold","text-align":"center"}})]):a._e()]],2)])},e.staticRenderFns=[],e._scopeId="data-v-09a18998"},{"components/QueryResultsActionInfoFormats.vue":217,"components/QueryResultsHeaderFeatureActionsBody.vue":220,"components/QueryResultsHeaderFeatureBody.vue":221,"components/QueryResultsTableAttributeFieldValue.vue":222,mixins:290,utils:404,"vueify/lib/insert-css":2}],214:[function(e,t,n){function r(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),s=e("core/i18n/i18n.service").t,n.default={name:"action",data:function(){return{show:!0}},props:{featureIndex:{type:Number},feature:{type:Object},layer:{type:Object},trigger:{type:Function},action:{type:Object,required:!0}},methods:{clickAction:(a=r(function*(e,t,n,r,i){var a,o;yield this.trigger(e,t,n,r),e.hint_change&&(a=$(i.target).parent(),o=a.attr("data-original-title"),a.attr("data-original-title",s(e.hint_change.hint)),a.tooltip("show"),setTimeout(function(){a.attr("data-original-title",o),a.tooltip("show")},e.hint_change.duration||600)),this.$emit("action-clicked",e)}),function(e,t,n,r,i){return a.apply(this,arguments)})},created:(i=r(function*(){var e;this.action.init&&this.action.init({layer:this.layer,feature:this.feature,index:this.featureIndex,action:this.action}),"function"==typeof this.action.condition&&(e=this.action.condition({layer:this.layer,feature:this.feature}),this.show=e instanceof Promise?yield e:e)}),function(){return i.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default);var i,a,s,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return t.show?e("span",{directives:[{name:"download",rawName:"v-download",value:t.action.download,expression:"action.download"},{name:"t-tooltip",rawName:"v-t-tooltip:top.create",value:t.action.hint,expression:"action.hint",arg:"top",modifiers:{create:!0}}],staticClass:"action-button",class:{toggled:t.action.state&&t.action.state.toggled[t.featureIndex]},on:{contextmenu:function(e){e.preventDefault(),e.stopPropagation()},click:function(e){return e.stopPropagation(),t.clickAction(t.action,t.layer,t.feature,t.featureIndex,e)}}},[e("span",{class:"action-button-icon "+t.action.class,staticStyle:{padding:"2px"},style:t.action.style})]):t._e()},e.staticRenderFns=[]},{"core/i18n/i18n.service":12}],215:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default={name:"choose_layer",props:{featureIndex:{type:Number},feature:{type:Object},layer:{type:Object},config:{type:Object,default:{icon:"pencil",label:"Choose a Layer",nolayers:"No layers found",layers:[],cbk:function(){}}}},data:function(){return{layerId:null}},computed:{has_layers:function(){return this.config.layers&&0<this.config.layers.length}},created:function(){this.has_layers&&(this.layerId=this.config.layers[0].id)}},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"action-choose-layer"},[n("label",{directives:[{name:"t",rawName:"v-t",value:t.config.label,expression:"config.label"}]}),t._v(" "),n("div",{staticStyle:{width:"100%",display:"flex"},on:{click:function(e){e.preventDefault(),e.stopPropagation()}}},[n("select",{directives:[{name:"select2",rawName:"v-select2",value:"layerId",expression:"'layerId'"}],staticClass:"form-control",staticStyle:{"flex-grow":"1"},attrs:{search:!1,disabled:!t.has_layers}},[t._l(t.config.layers,function(e){return n("option",{key:e.id,domProps:{value:e.id}},[n("b",[t._v(t._s(e.name))])])}),t._v(" "),t.has_layers?t._e():n("option",{directives:[{name:"t",rawName:"v-t",value:t.config.nolayers,expression:"config.nolayers"}]})],2),t._v(" "),t.has_layers?n("button",{staticClass:"btn skin-button",staticStyle:{"border-radius":"0 3px 3px 0"},on:{click:function(e){return e.stopPropagation(),t.config.cbk(t.layerId,t.feature)}}},[n("span",{class:t.g3wtemplate.getFontClass(t.config.icon)})]):t._e()])])},n.staticRenderFns=[]},{}],216:[function(e,t,n){function r(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),n.default={name:"downloadformats",data:function(){return{download_format:this.config.downloads[0].format}},props:{featureIndex:{type:Number},feature:{type:Object},layer:{type:Object},config:{type:Object,default:null}},methods:{download:(i=r(function*(){var t=this;try{var e=this.config.downloads.find(function(e){return e.format===t.download_format});yield e.cbk(this.layer,this.feature||this.layer.features,e,this.featureIndex)}catch(e){}}),function(){return i.apply(this,arguments)})}},t.exports.__esModule&&(t.exports=t.exports.default);var i,n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"g3w-download-formats-content",staticStyle:{width:"100%",display:"flex"},on:{click:function(e){e.preventDefault(),e.stopPropagation()}}},[n("select",{directives:[{name:"select2",rawName:"v-select2",value:"download_format",expression:"'download_format'"}],staticClass:"form-control",staticStyle:{"flex-grow":"1"},attrs:{search:!1}},t._l(t.config.downloads,function(e){return n("option",{directives:[{name:"download",rawName:"v-download"}],key:e.id,domProps:{value:e.format}},[n("span",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(e.format))])])}),0),t._v(" "),n("button",{directives:[{name:"download",rawName:"v-download"}],staticClass:"btn skin-button",staticStyle:{"border-radius":"0 3px 3px 0"},on:{click:function(e){return e.stopPropagation(),t.download(e)}}},[n("span",{class:t.g3wtemplate.getFontClass("download")})])])},n.staticRenderFns=[]},{}],217:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=r(e("store/catalog-layers")),s=r(e("services/gui")),l=e("utils/getAlphanumericPropertiesFromFeature"),d=e("utils/parsers").response,n.default={name:"Infoformats",props:{layer:{type:Object,required:!0}},data:function(){return{infoformat:this.layer.infoformat}},computed:{infoformats:function(){return this.layer.infoformats||[]},hasInfo:function(){return this.infoformats.length}},methods:{reloadLayerDataWithChangedContentType:(c=i(function*(e){this.layer.loading=!0,this.$el.disabled=!0;try{var t=yield this.projectLayer.changeProxyDataAndReloadFromServer("wms",{headers:{"Content-Type":e},params:{INFO_FORMAT:e}}),n=(this.layer.infoformat=e,this.projectLayer.setInfoFormat(this.layer.infoformat),d.get(e)({layers:[this.projectLayer],response:t})),r=a(n,1)[0];r.features?this.__parsedata(r):this.__parserawdata(r)}catch(e){}this.layer.loading=!1,this.$el.disabled=!1}),function(e){return c.apply(this,arguments)}),__parsedata:function(e){var r=this,i=s.default.getService("queryresults");this.layer.rawdata=null,e.features.forEach(function(e){var e=i.getFeaturePropertiesAndGeometry(e),t=e.id,n=e.geometry,e=e.properties;0===r.layer.attributes.length&&(r.layer.hasgeometry=!!n,i.setActionsForLayers([r.layer]),(0,l.getAlphanumericPropertiesFromFeature)(e).forEach(function(e){r.layer.attributes.push({name:e,label:e,show:!0})})),r.layer.features.push({id:t,attributes:e,geometry:n,show:!0})})},__parserawdata:(u=i(function*(e){this.layer.features.splice(0),yield this.$nextTick(),this.layer.rawdata=e.rawdata}),function(e){return u.apply(this,arguments)})},watch:{infoformat:function(e){this.reloadLayerDataWithChangedContentType(e)}},created:function(){this.projectLayer=o.default.getLayerById(this.layer.id)},beforeDestroy:function(){this.projectLayer&&this.projectLayer.clearProxyData("wms"),this.projectLayer=null}},t.exports.__esModule&&(t.exports=t.exports.default);var a,o,s,l,u,c,d,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.hasInfo?n("select",{directives:[{name:"select2",rawName:"v-select2",value:"infoformat",expression:"'infoformat'"}],staticClass:"skin-color",attrs:{select2_value:t.infoformat,search:!1}},t._l(t.infoformats,function(e){return n("option",{key:e,domProps:{value:e}},[t._v("\n    "+t._s(e)+"\n  ")])}),0):t._e()},e.staticRenderFns=[]},{"services/gui":302,"store/catalog-layers":311,"utils/getAlphanumericPropertiesFromFeature":374,"utils/parsers":425}],218:[function(e,t,n){e("vueify/lib/insert-css").insert(".g3w-polygonattributes-types-title[data-v-7fd19c11]{font-weight:700;padding:3px;color:#fff;margin:0 0 5px}.g3w-polygonattributes-types-content[data-v-7fd19c11]{display:flex;justify-content:space-between;padding:3px;border-radius:3px;border:1px solid #f4f4f4}");Object.defineProperty(n,"__esModule",{value:!0}),a=e("store/application-state"),r=(a=a)&&a.__esModule?a:{default:a},i=e("core/i18n/i18n.service").t,n.default={name:"queryresults-querypolygonaddattributes",props:{layer:{type:Object},config:{type:Object,default:null}},data:function(){return{type:this.config.choices[0].type}},created:function(){var t=this;this.unwatch=this.$watch(function(){return r.default.language},function(){t.config.choices.forEach(function(e){return $(t.$refs[e.type]).text(i(e.label))}),$(t.$refs.g3w_select_feature_featurepolygon).select2().trigger("change")})},beforeDestroy:function(){this.unwatch&&this.unwatch(),this.unwatch=null}},t.exports.__esModule&&(t.exports=t.exports.default);var r,i,a="function"==typeof t.exports?t.exports.options:t.exports;a.render=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{width:"100%"}},[n("h5",{directives:[{name:"t",rawName:"v-t",value:"sdk.mapcontrols.querybypolygon.download.title",expression:"'sdk.mapcontrols.querybypolygon.download.title'"}],staticClass:"skin-background-color g3w-polygonattributes-types-title"}),t._v(" "),n("div",{staticClass:"g3w-polygonattributes-types-content"},[n("select",{directives:[{name:"select2",rawName:"v-select2",value:"type",expression:"'type'"}],ref:"g3w_select_feature_featurepolygon",staticClass:"form-control",staticStyle:{width:"100%"},attrs:{search:!1}},t._l(t.config.choices,function(e){return n("option",{directives:[{name:"t",rawName:"v-t",value:e.label,expression:"choice.label"}],key:e.type,ref:e.type,refInFor:!0,domProps:{value:e.type}})}),0),t._v(" "),n("button",{staticClass:"btn skin-button",staticStyle:{"border-radius":"0 3px 3px 0"},on:{click:function(e){return e.stopPropagation(),t.config.download(t.type)}}},[n("span",{class:t.g3wtemplate.getFontClass("download")})])])])},a.staticRenderFns=[],a._scopeId="data-v-7fd19c11"},{"core/i18n/i18n.service":12,"store/application-state":310,"vueify/lib/insert-css":2}],219:[function(e,t,n){e("vueify/lib/insert-css").insert(".g3w-feature-actions[data-v-ec80a64e]{padding:3px}");Object.defineProperty(n,"__esModule",{value:!0}),e=(e=e=e("components/QueryResultsAction.vue"))&&e.__esModule?e:{default:e},n.default={name:"actions",props:{featureIndex:{type:Number},feature:{type:Object},layer:{type:Object},trigger:{type:Function},actions:{type:Array,default:[]},colspan:{type:Number}},components:{action:e.default}},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.actions.length?n("td",{staticClass:"g3w-feature-actions skin-background-color lighten",staticStyle:{padding:"3px"},attrs:{colspan:t.colspan}},t._l(t.actions,function(e){return n("action",t._b({key:e.id,attrs:{action:e}},"action",t.$props,!1))}),1):t._e()},n.staticRenderFns=[],n._scopeId="data-v-ec80a64e"},{"components/QueryResultsAction.vue":214,"vueify/lib/insert-css":2}],220:[function(e,t,n){e("vueify/lib/insert-css").insert(".noAttributes[data-v-164045ac]{display:flex;justify-content:flex-end}");Object.defineProperty(n,"__esModule",{value:!0}),r=(r=r=e("components/QueryResultsActions.vue"))&&r.__esModule?r:{default:r},e=e("mixins"),n.default={name:"headerfeaturebody",mixins:[e.fieldsMixin],props:{toggleFeatureBoxAndZoom:{type:Function},trigger:{type:Function},hasLayerOneFeature:{type:Function},boxLayerFeature:{type:Object},getLayerField:{type:Function},attributesSubset:{type:Function},layer:{type:Object},feature:{type:Object},index:{type:Number},actions:{type:Array},colspan:{type:Number}},components:{actions:r.default}},t.exports.__esModule&&(t.exports=t.exports.default);var r,n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("tr",{staticClass:"featurebox-header",on:{mouseover:function(e){return t.trigger({id:"highlightgeometry"},t.layer,t.feature,t.index)},mouseout:function(e){return t.trigger({id:"clearHighlightGeometry"},t.layer,t.feature,t.index)}}},[e("actions",{attrs:{colspan:t.colspan,layer:t.layer,featureIndex:t.index,trigger:t.trigger,feature:t.feature,actions:t.actions}})],1)},n.staticRenderFns=[],n._scopeId="data-v-164045ac"},{"components/QueryResultsActions.vue":219,mixins:290,"vueify/lib/insert-css":2}],221:[function(e,t,n){e("vueify/lib/insert-css").insert(".noAttributes[data-v-137530c7]{display:flex;justify-content:flex-end}");Object.defineProperty(n,"__esModule",{value:!0}),r=(r=r=e("components/QueryResultsActions.vue"))&&r.__esModule?r:{default:r},e=e("mixins"),n.default={name:"headerfeaturebody",mixins:[e.fieldsMixin],props:{toggleFeatureBoxAndZoom:{type:Function},trigger:{type:Function},hasLayerOneFeature:{type:Function},boxLayerFeature:{type:Object},getLayerField:{type:Function},attributesSubset:{type:Function},layer:{type:Object},feature:{type:Object}},components:{actions:r.default}},t.exports.__esModule&&(t.exports=t.exports.default);var r,n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("tr",[t._l(t.attributesSubset(t.layer),function(e){return n("td",{staticClass:"attribute"},[t.isLink(t.getLayerField({layer:t.layer,feature:t.feature,fieldName:e.name}))?n("span",{staticClass:"skin-color",class:t.g3wtemplate.getFontClass("link")}):t.isPhoto(t.getLayerField({layer:t.layer,feature:t.feature,fieldName:e.name}))||t.isImage(t.getLayerField({layer:t.layer,feature:t.feature,fieldName:e.name}))?n("span",{staticClass:"skin-color",class:t.g3wtemplate.getFontClass("image")}):n("span",[t._v(t._s(t.feature.attributes[e.name]))])])}),t._v(" "),t.hasLayerOneFeature(t.layer)?t._e():n("td")],2)},n.staticRenderFns=[],n._scopeId="data-v-137530c7"},{"components/QueryResultsActions.vue":219,mixins:290,"vueify/lib/insert-css":2}],222:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0}),i=r(e("components/FieldLink.vue")),a=r(e("components/FieldVue.vue")),e=e("mixins"),n.default={name:"tableattributefieldvalue",props:{field:{type:Object},feature:{type:Object}},mixins:[e.fieldsMixin],components:{"g3w-link":i.default,"g3w-vue":a.default}},t.exports.__esModule&&(t.exports=t.exports.default);var i,a,n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,t=e._self._c||t;return e.isVue(e.field)?t("g3w-vue",{attrs:{feature:e.feature,state:e.field}}):e.isSimple(e.field)?t("span",{domProps:{innerHTML:e._s(e.field.value)}}):e.isPhoto(e.field)||e.isImage(e.field)?t("g3w-image",{attrs:{value:e.field.value}}):e.isLink(e.field)?t("g3w-link",{attrs:{state:{value:e.field.value}}}):e._e()},n.staticRenderFns=[],n._scopeId="data-v-0a32e30e"},{"components/FieldLink.vue":145,"components/FieldVue.vue":148,mixins:290}],223:[function(e,t,n){var r,i,a,o,s,l,u,c,d,p,f,h,g,v,m;e("vueify/lib/insert-css").insert(".query-relation[data-v-20ddbb22]{margin-top:3px}.query-relation>.header[data-v-20ddbb22]{padding:3px;display:flex;justify-content:space-between;align-items:center;width:100%;margin:0!important}.query-relation>.header>.g3w-long-text[data-v-20ddbb22]{border-radius:3px;font-size:1.3em}.query-relation.mobile>.header>.g3w-long-text[data-v-20ddbb22]{font-size:1em}.relations-table-tools[data-v-20ddbb22]{font-size:1.1em;margin-bottom:3px}.relations-table-tools>.action-button[data-v-20ddbb22]{padding:5px}.relation-wrapper[data-v-20ddbb22]{display:flex;justify-content:space-between;margin-bottom:5px;margin-top:3px;height:95%}.back-button[data-v-20ddbb22]{font-size:.8em}.header-component[data-v-20ddbb22]{width:100%;display:flex;margin-left:auto;margin-bottom:5px;margin-right:4px}.table-tools[data-v-20ddbb22]{display:flex;justify-content:space-between}.relationtable .table-tools .action-button[data-v-20ddbb22]:hover{background-color:transparent}.relationtable.dataTable tbody tr.selected[data-v-20ddbb22]{background-color:#e4e4e4!important}.relationtable.dataTable tbody tr.selected .row-wrap-tabs .tabs-wrapper[data-v-20ddbb22]{background-color:#fff!important}#chart_content[data-v-20ddbb22]{padding-bottom:5px;margin-bottom:5px;margin-left:8px}.dataTables_scrollBody[data-v-20ddbb22]{font-weight:700;margin-top:10px;font-size:1.1em;display:flex;justify-content:space-between}");function y(e){return e&&e.__esModule?e:{default:e}}function _(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),r=e("app/constant"),i=y(e("components/FieldG3W.vue")),a=y(e("components/QueryResultsActionDownloadFormats.vue")),o=y(e("store/catalog-layers")),s=y(e("services/gui")),l=e("mixins"),u=e("app/eventbus"),c=e("utils"),m=void 0,n.default={name:"relation",props:{table:{},feature:{default:null},relation:{},previousview:{},showChartButton:{},cardinality:{}},inject:["relationnoback"],mixins:[l.fieldsMixin,l.resizeMixin],components:{Field:i.default},data:function(){return{fields:null,chart:!1,headercomponent:null,downloadButton:null,downloadLayer:{state:null,config:{downloads:[]}}}},computed:{showTools:function(){return[!!this.isEditable,!!this.table.formStructure,!!this.isGeoLayer].filter(Boolean).length},showrelationslist:function(){return"relations"===this.previousview&&!this.relationnoback},one:function(){return"ONE"===this.relation.type}},methods:{zoomToGeometry:function(e){e&&s.default.getService("map").zoomToGeometry(new ol.geom[e.type](e.coordinates),{highlight:!0})},createTable:(v=_(function*(){var t=this,n=o.default.getLayerById(this.table.layerId),e=(this.isEditable=n.isEditable()&&!n.isInEditing(),this.isGeoLayer=void 0!==this.table.features.find(function(e){return e.geometry}),n.isDownloadable()?n.getDownloadableFormats():[]);0<e.length&&(this.downloadButton={toggled:!1,tooltip:1<e.length?"Downloads":"sdk.tooltips.download_"+e[0],handler:1<e.length?_(function*(){t.downloadButton.toggled=!t.downloadButton.toggled,t.downloadLayer.state=t.downloadLayer.state||n.state,t.downloadLayer.config.downloads=t.downloadLayer.config.downloads.length?t.downloadLayer.config.downloads:e.map(function(e){return{id:e,format:e,cbk:function(){t.saveRelation(n.getDownloadUrl(e)),t.headercomponent=null},download:!0}}),t.headercomponent=t.downloadButton.toggled?a.default:null}):function(){return t.saveRelation(n.getDownloadUrl(e[0]))}}),u.RelationEventBus.$on("reload",function(){t.reloadLayout()}),this.showChart=(0,c.throttle)(_(function*(){t.chart=!t.chart,yield t.$nextTick(),t.chartContainer=t.chartContainer||$("#chart_content"),t.$emit(t.chart?"show-chart":"hide-chart",t.chartContainer,{relations:[t.relation],fid:t.feature.attributes[r.G3W_FID]})})),yield this.$nextTick(),m=s.default.getSize({element:"sidebar",what:"width"}),this.relation.title=this.relation.name,this.one||(this.relationDataTable=$(this.$refs.relationtable).DataTable({pageLength:10,bLengthChange:!0,scrollResize:!0,scrollCollapse:!0,scrollX:!0,responsive:!0,order:[this.showTools?1:0,"asc"],columnDefs:[{orderable:this.showTools,targets:0}],autoWidth:!1}),this.tableHeaderHeight=$(".query-relation  div.dataTables_scrollHeadInner").height()),s.default.on("pop-content",function(){return setTimeout(function(){return t.resize()})})}),function(){return v.apply(this,arguments)}),resize:(g=_(function*(){var e;this.$refs.query_relation&&"none"!==this.$refs.query_relation.parentNode.style.display&&((e=$(this.$refs.query_relation).find("div.dataTables_scrollBody")).height($(".content").height()-this.tableHeaderHeight-$(".content_breadcrumb").outerHeight()-$(".navbar-header").outerHeight()-$(".close-panel-block").outerHeight()-$(this.$refs["relation-header"]).outerHeight()-$(".dataTables_filter").last().outerHeight()-$(".dataTables_paginate.paging_simple_numbers").outerHeight()-$(".dataTables_scrollHead").last().outerHeight()),this.table.rowFormStructure&&$(".row-wrap-tabs > .tabs-wrapper").width(e.width()-$(this.$refs.relationtable).find("tr.selected > td").outerWidth()-20),this.reloadLayout())}),function(){return g.apply(this,arguments)}),saveRelation:function(e){this.$emit("save-relation",e),this.downloadButton.toggled=!1},showFormStructureRow:(h=_(function*(e,t){this.table.rowFormStructure=this.table.rowFormStructure===t?null:t,this.fields=this.getRowFields(t),yield this.$nextTick(),$("#relationtable_wrapper div.dataTables_scrollBody").css("overflow-x",this.table.rowFormStructure?"hidden":"auto"),this.resize()}),function(e,t){return h.apply(this,arguments)}),editFeature:function(e){s.default.getService("queryresults").editFeature({layer:{id:this.table.layerId,attributes:this.table.fields},feature:this.table.features[e]})},getRowFields:function(n){var r=this;return this.table.fields.map(function(e,t){return e.value=n[t],e.query=!0,e.input={type:""+r.getFieldType(e)},e})},reloadLayout:function(){this.relationDataTable&&this.relationDataTable.columns.adjust()},back:function(){this.$parent.setRelationsList()},fieldIs:function(e,t){return this.getFieldType(t)===e},is:function(e,t){return this.fieldIs(e,t)},moveFnc:function(e){var t=$(".sidebar-collapse").length?0:m,e=e.pageX+2-t;this.$refs.tablecontent.style.width=e+"px",this.$refs.chartcontent.style.width=$(this.$refs.relationwrapper).width()-e-10+"px"}},watch:{table:{immediate:!0,handler:function(e){e&&e.rows.length&&this.createTable()}},chart:(f=_(function*(){yield this.$nextTick(),this.resize()}),function(){return f.apply(this,arguments)}),headercomponent:(p=_(function*(){yield this.$nextTick(),this.resize()}),function(){return p.apply(this,arguments)})},beforeCreate:function(){this.delayType="debounce"},beforeDestroy:(d=_(function*(){this.relationDataTable&&(this.relationDataTable.destroy(),this.relationDataTable=null,this.chartContainer&&this.$emit("hide-chart",this.chartContainer),this.chartContainer=null,this.tableHeaderHeight=null,s.default.off("pop-content",this.resize))}),function(){return d.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var r=this,e=r.$createElement,i=r._self._c||e;return r.table?i("div",{ref:"query_relation",staticClass:"query-relation",class:r.isMobile()?"mobile":null},[i("div",{ref:"relation-header",staticClass:"header skin-background-color lighten"},[i("div",{staticClass:"g3w-long-text"},[r.showrelationslist?i("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:right.create",value:"sdk.relations.back_to_relations",expression:"'sdk.relations.back_to_relations'",arg:"right",modifiers:{create:!0}}],staticClass:"action-button-icon action-button back-button",class:r.g3wtemplate.getFontClass("exit"),on:{click:function(e){return e.stopPropagation(),r.back(e)}}}):r._e(),r._v(" "),i("b",{staticClass:"relation-tile skin-color"},[r._v(" "+r._s(r.relation.name)+" ")])]),r._v(" "),r.table.rows.length?i("div",{staticClass:"relations-table-tools"},[r.downloadButton?i("span",{directives:[{name:"download",rawName:"v-download"},{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:r.downloadButton.tooltip,expression:"downloadButton.tooltip",arg:"left",modifiers:{create:!0}}],staticClass:"action-button-icon action-button",class:[r.g3wtemplate.getFontClass("download"),{"toggled-white":r.downloadButton.toggled}],on:{click:function(e){return e.stopPropagation(),r.downloadButton.handler(e)}}}):r._e(),r._v(" "),r.showChartButton?i("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:bottom.create",value:"sdk.tooltips.show_chart",expression:"'sdk.tooltips.show_chart'",arg:"bottom",modifiers:{create:!0}}],staticClass:"action-button-icon action-button",class:[r.g3wtemplate.getFontClass("chart"),r.chart?"toggled-white":""],on:{click:function(e){return e.stopPropagation(),r.showChart(e)}}}):r._e()]):r._e()]),r._v(" "),r.table.rows.length?i("div",{ref:"relationwrapper",staticClass:"relation-wrapper"},[i("div",{ref:"tablecontent",style:{width:r.chart?"70%":"100%",marginRight:r.chart?"8px":"3px",position:"relative"},attrs:{id:"table_content"}},[r.headercomponent?i("div",{staticClass:"header-component"},[i(r.headercomponent,{tag:"component",attrs:{layer:r.downloadLayer.state,config:r.downloadLayer.config}})],1):r._e(),r._v(" "),i("table",{ref:"relationtable",staticClass:"hover relationtable table table-striped row-border"},[i("thead",[i("tr",{staticStyle:{height:"0! important"}},[r.showTools?i("th",{style:{minWidth:30*this.showTools+"px",padding:"0 !important"}}):r._e(),r._v(" "),r._l(r.table.columns,function(e){return i("th",[r._v(r._s(e))])})],2)]),r._v(" "),i("tbody",r._l(r.table.rows,function(t,n){return i("tr",{key:r.table.rows_fid[n],class:{selected:r.table.rowFormStructure===t}},[r.showTools?i("td",{staticClass:"table-tools"},[r.table.features[n].geometry?i("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:right.create",value:"sdk.tooltips.relations.zoomtogeometry",expression:"'sdk.tooltips.relations.zoomtogeometry'",arg:"right",modifiers:{create:!0}}],staticClass:"action-button row-form skin-color",class:r.g3wtemplate.getFontClass("marker"),on:{click:function(e){return e.stopPropagation(),r.zoomToGeometry(r.table.features[n].geometry)}}}):r._e(),r._v(" "),r.table.formStructure?i("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:right.create",value:"sdk.tooltips.relations."+(r.table.rowFormStructure===t?"form_to_row":"row_to_form"),expression:"`sdk.tooltips.relations.${table.rowFormStructure === row ? 'form_to_row' : 'row_to_form'}`",arg:"right",modifiers:{create:!0}}],staticClass:"action-button row-form skin-color",class:r.g3wtemplate.getFontClass(r.table.rowFormStructure===t?"minus":"table"),attrs:{"current-tooltip":"sdk.tooltips.relations."+(r.table.rowFormStructure===t?"form_to_row":"row_to_form")},on:{click:function(e){return e.stopPropagation(),r.showFormStructureRow(e,t)}}}):r._e(),r._v(" "),r.isEditable?i("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:right.create",value:"Edit",expression:"'Edit'",arg:"right",modifiers:{create:!0}}],staticClass:"action-button row-form skin-color",class:r.g3wtemplate.getFontClass("pencil"),on:{click:function(e){return e.stopPropagation(),r.editFeature(n)}}}):r._e()]):r._e(),r._v(" "),r.table.formStructure&&r.table.rowFormStructure===t?i("td",{staticClass:"row-wrap-tabs",attrs:{colspan:r.table.columns.length}},[i("tabs",{attrs:{layerid:r.table.layerId,feature:r.table.features[n],fields:r.fields,tabs:r.table.formStructure}})],1):r._l(t,function(e){return i("td",[i("field",{attrs:{state:{value:e}}})],1)})],2)}),0)])]),r._v(" "),i("g3w-resize",{staticClass:"skin-border-color lighten",staticStyle:{"border-style":"solid","border-width":"0 1px 0 1px"},attrs:{show:r.chart,moveFnc:r.moveFnc,where:"content"}}),r._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:r.chart,expression:"chart"}],ref:"chartcontent",style:{width:r.chart?"30%":"0"},attrs:{id:"chart_content"}})],1):i("div",{staticClass:"dataTables_scrollBody"},[i("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.relations.no_relations_found",expression:"'sdk.relations.no_relations_found'"}]})])]):r._e()},e.staticRenderFns=[],e._scopeId="data-v-20ddbb22"},{"app/constant":5,"app/eventbus":46,"components/FieldG3W.vue":142,"components/QueryResultsActionDownloadFormats.vue":216,mixins:290,"services/gui":302,"store/catalog-layers":311,utils:404,"vueify/lib/insert-css":2}],224:[function(e,t,n){var r,i,a;e("vueify/lib/insert-css").insert(".relation-grid-item[data-v-02f56b7e]{min-width:0;min-height:80px;border:2px solid;cursor:pointer;border-radius:4px;background-color:#fff;display:flex;align-items:center}.relation-grid-item[data-v-02f56b7e]:hover{background-color:transparent}.query-relations[data-v-02f56b7e]{overflow-y:auto}.query-relations>.header[data-v-02f56b7e]{margin-bottom:10px;border-radius:4px;padding:5px}.query-relations>.query-relations-content[data-v-02f56b7e]{display:grid;grid-template-columns:repeat(2,auto);grid-column-gap:5px;grid-row-gap:5px}.relation-grid-item>.g3w-long-text[data-v-02f56b7e]{font-weight:700;padding:5px}");function o(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},n.default={name:"relations",props:["relations","feature","loading"],methods:{showRelation:(i=o(function*(e){yield this.$parent.showRelation(e)}),function(e){return i.apply(this,arguments)}),featureInfo:function(){var n=[],r=0;return Object.entries(this.feature.attributes).forEach(function(e){var e=a(e,2),t=e[0],e=e[1];if(2<r)return!1;e&&_.isString(e)&&-1===e.indexOf("/")&&(n.push({key:t,value:e}),r++)}),n}},mounted:(r=o(function*(){1===this.relations.length&&(this.relations[0].noback=!0,yield this.showRelation(this.relations[0]))}),function(){return r.apply(this,arguments)}),beforeDestroy:function(){1===this.relations.length&&delete this.relations[0].noback}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"query-relations"},[r("div",{staticClass:"header skin-background-color lighten"},[r("div",{staticClass:"skin-color-dark"},[r("span",{directives:[{name:"t",rawName:"v-t:pre",value:"sdk.relations.list_of_relations_feature",expression:"'sdk.relations.list_of_relations_feature'",arg:"pre"}],staticStyle:{"font-size":"1.1em"}}),n._v(" "),n._l(n.featureInfo(),function(e){return r("span",[r("b",[n._v(n._s(e.key))]),n._v(": "+n._s(e.value))])})],2)]),n._v(" "),r("div",{staticClass:"query-relations-content"},n._l(n.relations,function(t){return r("div",{staticClass:"skin-border-color relation-grid-item",on:{click:function(e){return e.stopPropagation(),n.showRelation(t)}}},[r("span",{staticClass:"skin-color g3w-long-text"},[n._v(n._s(t.name))])])}),0)])},e.staticRenderFns=[],e._scopeId="data-v-02f56b7e"},{"vueify/lib/insert-css":2}],225:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}function l(e,t){var n=t,r=(r=0<arguments.length&&void 0!==e?e:[])||[],n=f.default.getCurrentProject().getLayerById(n),i=Object.keys(r[0]?r[0].attributes:{}),a=n.getTableHeaders().filter(function(e){return-1!==i.indexOf(e.name)});return{columns:a.map(function(e){return e.label}),rows:r.map(function(t){return a.map(function(e){return t.attributes[e.name]})}),rows_fid:r.map(function(e){return e.attributes[u.G3W_FID]}),features:r,fields:a.length?a:null,formStructure:n.getLayerEditingFormStructure(),rowFormStructure:null,layerId:n.getId()}}Object.defineProperty(n,"__esModule",{value:!0}),a=r(e("services/gui")),o=r(e("components/Relations.vue")),s=r(e("components/Relation.vue")),u=e("app/constant"),c=e("app/eventbus"),d=e("utils/getFeaturesFromResponseVectorApi"),p=r(e("services/relations")),f=r(e("services/application")),m=void 0,n.default={name:"relation-page",data:function(){var e=this.$options,t=e.table,t=void 0===t?null:t,n=e.relation,n=void 0===n?null:n,r=e.relations,r=void 0===r?[]:r,i=e.nmRelation,a=e.feature,a=void 0===a?null:a,o=e.currentview,o=void 0===o?"relations":o,s=e.chartRelationIds,s=void 0===s?[]:s,e=e.layer;return{loading:!1,state:null,error:!1,table:t?l(t):null,previousview:o,showChartButton:!1,feature:a,currentview:o,relation:n,relations:r,nmRelation:i,chartRelationIds:s,layer:e}},provide:function(){return{relationnoback:1===this.$options.relations.length}},components:{relations:o.default,relation:s.default},methods:{saveRelations:(v=i(function*(e){var t=f.default.setDownload(!0);try{yield p.default.save(Object.assign(m,{type:e}))}catch(e){a.default.showUserMessage({type:"alert",message:e||"info.server_error",closable:!0})}f.default.setDownload(!1,t)}),function(e){return v.apply(this,arguments)}),reloadLayout:function(){c.RelationEventBus.$emit("reload")},showChart:function(e,t){a.default.getService("queryresults").showChart([this.relation.referencingLayer],e,t)},hideChart:function(e){a.default.getService("queryresults").hideChart(e)},showRelation:(g=i(function*(e){a.default.setLoadingContent(!0),this.loading=!0;var t=(this.relation=e).referencingLayer;try{m={layer:this.$options.layer,fid:this.feature.attributes[u.G3W_FID],relation:e};var n=yield p.default.getRelations(m),r=(0,d.getFeaturesFromResponseVectorApi)(n,{type:"result"});this.nmRelation&&(t=this.nmRelation.referencedLayer,r=yield p.default.getRelationsNM({nmRelation:this.nmRelation,features:r})),this.showChartButton=!!this.chartRelationIds.find(function(e){return t===e}),this.table=l(r,t),a.default.changeCurrentContentOptions({title:e.name,crumb:{title:e.name}}),yield this.$nextTick(),this.previousview=this.currentview,this.currentview="relation"}catch(e){}a.default.setLoadingContent(!1),this.loading=!0}),function(e){return g.apply(this,arguments)}),setRelationsList:function(){this.previousview="relation",this.currentview="relations",a.default.changeCurrentContentOptions({crumb:{title:u.LIST_OF_RELATIONS_TITLE}}),this.loading=!1}},beforeMount:function(){("relation"===this.currentview||1===this.relations.length&&"ONE"===this.relations[0].type)&&this.showRelation(this.relations[0])},mounted:(h=i(function*(){this.relations.sort(function(e,t){e=e.name,t=t.name;return e<t?-1:t<e?1:0}),yield this.$nextTick(),this.error&&requestAnimationFrame(function(){return a.default.popContent()}),this.error=!1}),function(){return h.apply(this,arguments)}),created:function(){this.$on("resize-component",this.reloadLayout)}},t.exports.__esModule&&(t.exports=t.exports.default);var a,o,s,u,c,d,p,f,h,g,v,m,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("div",{staticClass:"query-relations-page"},[t(e.currentview,{ref:e.currentview,tag:"component",attrs:{loading:e.loading,previousview:e.previousview,showChartButton:e.showChartButton,relations:e.relations,relation:e.relation,nmRelation:e.nmRelation,feature:e.feature,table:e.table},on:{"save-relation":e.saveRelations,"show-chart":e.showChart,"hide-chart":e.hideChart}})],1)},e.staticRenderFns=[]},{"app/constant":5,"app/eventbus":46,"components/Relation.vue":223,"components/Relations.vue":224,"services/application":298,"services/gui":302,"services/relations":305,"utils/getFeaturesFromResponseVectorApi":381}],226:[function(e,t,n){var r,i,a,o,s,l,u,c,d,p,f,h,g;e("vueify/lib/insert-css").insert(".querybuliserch-tools[data-v-3edc3c4e]{display:flex;align-items:baseline}.querybuliserch-tools>i[data-v-3edc3c4e]{margin-right:14px;margin-left:1px}.querybuliserch-tools>span[data-v-3edc3c4e]{white-space:pre-wrap}.querybuliserch-tools>div[data-v-3edc3c4e]{margin-left:auto}.querybuliserch-tools>div i[data-v-3edc3c4e]{padding:3px;font-size:1.3em}.querybuildsearch-info[data-v-3edc3c4e]{margin-top:5px}");function v(e){return e&&e.__esModule?e:{default:e}}function m(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),r=v(e("core/g3w-panel")),i=v(e("store/catalog-layers")),a=v(e("store/projects")),o=v(e("services/application")),s=v(e("services/data")),l=v(e("services/gui")),u=e("utils/createFilterFromString"),c=v(e("components/Tool.vue")),d=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/QueryBuilder.vue")),g=e("core/i18n/i18n.service").t,n.default={name:"search",data:function(){return{state:this.state||{}}},components:{"g3w-tool":c.default},computed:{show:function(){return 0<this.state.searches.length+this.state.tools.length+this.state.querybuildersearches.length}},methods:{showPanel:function(){this.$options.service.showPanel(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},remove:(h=m(function*(t,e){try{yield new Promise(function(t,n){l.default.dialog.confirm(g("sdk.querybuilder.delete"),function(e){return(e?t:n)()})});var n=o.default.getLocalItem("QUERYBUILDERSEARCHES"),r=a.default.getCurrentProject().getId(),i=(n&&n[r]||[]).filter(function(e){return e.id!==t.id});i.length?n[r]=i:delete n[r],Object.keys(n).length?o.default.setLocalItem({id:"QUERYBUILDERSEARCHES",data:n}):o.default.removeLocalItem("QUERYBUILDERSEARCHES"),this.$options.service.removeItem({type:"querybuilder",index:e})}catch(e){}}),function(e,t){return h.apply(this,arguments)}),edit:function(e){e={id:e.id,name:e.name,layerId:e.layerId,filter:e.filter,title:"Query Builder",show:!0};e.internalPanel=new(Vue.extend(d))(e),new r.default(e)},run:(f=m(function*(e){e.qbloading=!0;try{var t=i.default.getLayerById(e.layerId);yield s.default.getData("search:features",{inputs:{layer:t,filter:(0,u.createFilterFromString)({layer:t,filter:e.filter}),feature_count:100},outputs:!0})}catch(e){l.default.showUserMessage({type:"alert",message:"sdk.querybuilder.error_run",autoclose:!0})}e.qbloading=!1}),function(e){return f.apply(this,arguments)})},mounted:(p=m(function*(){yield this.$nextTick(),$(".icon-search-action").tooltip()}),function(){return p.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var r=this,e=r.$createElement,i=r._self._c||e;return r.show?i("ul",{staticClass:"treeview-menu g3w-search g3w-tools menu-items",attrs:{id:"g3w-search"}},[r._l(r.state.searches,function(t){return i("li",{staticClass:"menu-item",on:{click:function(e){return e.stopPropagation(),r.showPanel(t)}}},[i("i",{class:r.g3wtemplate.getFontClass("empty-circle")}),r._v(" "),i("span",[r._v(r._s(t.name))])])}),r._v(" "),r._l(r.state.tools,function(e){return i("li",[i("g3w-tool",{attrs:{tool:e}})],1)}),r._v(" "),r._l(r.state.querybuildersearches,function(t,n){return i("li",{key:t.id},[i("div",{staticStyle:{position:"relative"}},[i("bar-loader",{attrs:{loading:t.qbloading}}),r._v(" "),i("div",{staticClass:"querybuliserch-tools"},[i("i",{class:r.g3wtemplate.getFontClass("filter")}),r._v(" "),i("span",[r._v(r._s(t.name))]),r._v(" "),i("div",[i("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.querybuilder.search.run",expression:"'sdk.querybuilder.search.run'"}],staticClass:"icon-search-action skin-tooltip-bottom",attrs:{"data-placement":"bottom","data-toggle":"tooltip","data-container":"body"}},[i("i",{class:r.g3wtemplate.getFontClass("run"),staticStyle:{color:"green"},on:{click:function(e){return e.stopPropagation(),r.run(t)}}})]),r._v(" "),i("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.querybuilder.search.info",expression:"'sdk.querybuilder.search.info'"}],staticClass:"icon-search-action skin-tooltip-bottom",attrs:{"data-placement":"bottom","data-toggle":"tooltip","data-container":"body"}},[i("i",{class:r.g3wtemplate.getFontClass("info"),staticStyle:{color:"#FFF"},on:{click:function(e){e.stopPropagation(),t.qbshowinfo=!t.qbshowinfo}}})]),r._v(" "),i("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.querybuilder.search.edit",expression:"'sdk.querybuilder.search.edit'"}],staticClass:"icon-search-action skin-tooltip-bottom",attrs:{"data-placement":"bottom","data-toggle":"tooltip","data-container":"body"}},[i("i",{class:r.g3wtemplate.getFontClass("pencil"),staticStyle:{color:"#307095"},on:{click:function(e){return e.stopPropagation(),r.edit(t)}}})]),r._v(" "),i("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.querybuilder.search.delete",expression:"'sdk.querybuilder.search.delete'"}],staticClass:"icon-search-action skin-tooltip-bottom",attrs:{"data-placement":"bottom","data-toggle":"tooltip","data-container":"body"}},[i("i",{class:r.g3wtemplate.getFontClass("trash"),staticStyle:{color:"red"},on:{click:function(e){return e.stopPropagation(),r.remove(t,n)}}})])])]),r._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.qbshowinfo,expression:"search.qbshowinfo"}],staticClass:"querybuildsearch-info"},[i("div",[i("span",{staticStyle:{"font-weight":"bold","white-space":"pre"}},[r._v("LAYER: ")]),r._v(" "),i("span",{staticStyle:{"white-space":"pre-wrap"}},[r._v(r._s(t.layerName))])]),r._v(" "),i("div",[i("span",{staticStyle:{"font-weight":"bold"}},[r._v("EXPRESSION: ")]),r._v(" "),i("span",{staticStyle:{"white-space":"pre-wrap"}},[r._v(r._s(t.filter))])])])],1)])})],2):r._e()},e.staticRenderFns=[],e._scopeId="data-v-3edc3c4e"},{"components/QueryBuilder.vue":212,"components/Tool.vue":238,"core/g3w-panel":10,"core/i18n/i18n.service":12,"services/application":298,"services/data":300,"services/gui":302,"store/catalog-layers":311,"store/projects":317,"utils/createFilterFromString":345,"vueify/lib/insert-css":2}],227:[function(e,t,n){var l,d,p,r,i,a,f,h,o,s,u,c,g,v,m,y;e("vueify/lib/insert-css").insert(".search-label[data-v-51de5286]{width:100%;display:flex;justify-content:space-between}");function _(e){return e&&e.__esModule?e:{default:e}}function b(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function w(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},d=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},p=e("app/constant"),r=_(e("store/application-state")),i=_(e("services/application")),a=e("utils/convertQGISDateTimeFormatToMoment"),f=e("utils/createSingleFieldParameter"),h=e("utils/getDataForSearchInput"),o=_(e("mixins/resize")),m=e("core/i18n/i18n.service").t,y=[],n.default={mixins:[o.default],data:function(){return{state:this.$options.service.state,allvalue:p.SEARCH_ALLVALUE}},computed:{layers_url:function(){return i.default.getCurrentProject().getState().layers_url},is_superuser:function(){return i.default.getConfig().user.is_superuser}},methods:{resize:function(){y.forEach(function(e){return!r.default.ismobile&&e.select2("close")})},getLabelOperator:function(e){return"[ "+p.FILTER_EXPRESSION_OPERATORS[e]+" ]"},onFocus:(v=w(function*(e){var t;this.isMobile()&&(t=$(e.target).position().top-10,yield this.$nextTick(),setTimeout(function(){return $(".sidebar").scrollTop(t)},500))}),function(e){return v.apply(this,arguments)}),changeInput:(g=w(function*(r){function i(e){return[p.SEARCH_ALLVALUE,null,void 0].includes(e)||""===e.toString().trim()}function a(e){return"autocompletefield"===e.type}var t,o=r.attribute,s=this.state.forminputs.find(function(e){return e.attribute===o}),e=this.state.forminputs.filter(function(e){return e.dependance===o}),l=(s&&void 0!==r.dvalues[s.value]?r.dvalues[s.value]:r.dvalues)[c],u=this.state,c=r.value;try{this.state.searching=!0,void 0===(c="numberfield"===r.type?c||0===c?c:null:c)&&(c=p.SEARCH_ALLVALUE),["textfield","textField"].includes(r.type)||(c=c.trim()),r.value=c,yield Promise.allSettled(e.map((t=w(function*(e){var t,n;e.value="selectfield"===e.type?p.SEARCH_ALLVALUE:null,e.values=Array.from(new Set([].concat(b(a(e)||i(c)?[]:[e.values[0]]),b(!a(e)&&i(c)?e._values:[]),b(r.dependance&&l&&l[e.attribute]||[])))),e.disabled=!!i(c)&&e.dependance_strict,a(e)||i(c)||r.dependance&&l||(u.loading[o]=!0,(t=yield u.search_layers[0].getFilterData({fformatter:e.attribute,ordering:e.attribute,field:h.getDataForSearchInput.field({state:u,field:o,fields:void 0!==c?[(0,f.createSingleFieldParameter)({field:o,value:c,operator:s.operator})]:[]})})).data=(t.data||[]).map(function(e){e=d(e,2),e[0],e=e[1];return{key:e,value:e}}),e.dependance_strict||"selectfield"!==e.type||(n=e._values).push.apply(n,b(e.values)),1===e.values.length&&(n=e.values).push.apply(n,b(t.data)),r.dependance?(r.dvalues[s.value]=r.dvalues[s.value]||{},r.dvalues[s.value][c]=r.dvalues[s.value][c]||{},r.dvalues[s.value][e.attribute]=e.values.slice(1)):(r.dvalues[c]=r.dvalues[c]||{},r.dvalues[c][e.attribute]=e.values.slice(1)),e.disabled=!1)}),function(e){return t.apply(this,arguments)})))}catch(e){}finally{this.state.loading[o]=!1,this.state.searching=!1}}),function(e){return g.apply(this,arguments)}),doSearch:function(e){e.preventDefault(),this.$options.service.run()},initDateTimeField:(c=w(function*(t){var n=this;"datetimefield"===t.type&&(yield this.$nextTick(),t.options.format.fieldformat=(0,a.convertQGISDateTimeFormatToMoment)(t.options.format.fieldformat),t.options.format.displayformat=(0,a.convertQGISDateTimeFormatToMoment)(t.options.format.displayformat),$(this.$refs["date_"+t.id]).datetimepicker({defaultDate:null,format:t.options.format.displayformat,ignoreReadonly:!0,allowInputToggle:!0,toolbarPlacement:"top",widgetPositioning:{vertical:"bottom",horizontal:"left"},showClose:!0,locale:r.default.language||"en"}),$(this.$refs["date_"+t.id]).on("dp.change",function(){var e=$("#"+t.id).val();t.value=e.trim()?moment(e,t.options.format.displayformat).format(t.options.format.fieldformat):null,n.changeInput(t)}),r.default.ismobile)&&setTimeout(function(){$("#"+t.id).blur()})}),function(e){return c.apply(this,arguments)}),initSelect2Field:(u=w(function*(r){var e,t,n,i,a,o,s=this;["selectfield","autocompletefield"].includes(r.type)&&(yield this.$nextTick(),e=r.options.numdigaut,n=(t="autocompletefield"===r.type)?{delay:500,transport:(i=w(function*(e,t,n){try{t({results:(yield(0,h.getDataForSearchInput)({state:s.state,field:r.attribute,suggest:r.attribute+"|"+e.data.q})).map(function(e){return{id:e.value,text:e.key}})})}catch(e){n(e)}}),function(e,t,n){return i.apply(this,arguments)})}:null,a=$("#"+r.id).select2({ajax:n,width:"100%",dropdownParent:$(".g3w-search-form:visible"),minimumInputLength:t?e&&!Number.isNaN(+e)&&0<+e&&+e||2:0,allowClear:t,placeholder:t?"":null,matcher:function(e,t){e=e.term&&e.term.toLowerCase();return""===(e||"").toString().trim()?t:t.text.toLowerCase().includes(e)&&void 0!==t.text?l({},t):null},language:{noResults:function(){return m("sdk.search.no_results")},errorLoading:function(){return m("sdk.search.error_loading")},searching:function(){return m("sdk.search.searching")},inputTooShort:function(e){return m("sdk.search.autocomplete.inputshort.pre")+" "+(e.minimum-e.input.length)+" "+m("sdk.search.autocomplete.inputshort.post")}}}),y.push(a),a.on("select2:select select2:unselecting",function(e){"select2:select"!==e.type&&!t||(r.value=e.params.data?""+e.params.data.id:p.SEARCH_ALLVALUE,s.changeInput(r))}),this.$watch(function(){return r.value},(o=w(function*(e,t){e!==t&&e===p.SEARCH_ALLVALUE&&a.val(e).trigger("change")}),function(e,t){return o.apply(this,arguments)})),a.val(r.value).trigger("change"))}),function(e){return u.apply(this,arguments)})},mounted:(s=w(function*(){yield this.state.mounted;var e=!0,t=!1,n=void 0;try{for(var r,i=this.state.forminputs[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var a=r.value;yield this.initSelect2Field(a),yield this.initDateTimeField(a)}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}}),function(){return s.apply(this,arguments)}),beforeDestroy:function(){y.forEach(function(e){e.select2("destroy"),e.off()}),y.splice(0)}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:n.state.searching,expression:"state.searching"}],staticClass:"g3w-search-panel form-group"},[r("h4",[r("b",[n._v(n._s(n.state.title))])]),n._v(" "),n._t("tools"),n._v(" "),n._t("form",[r("form",{staticClass:"g3w-search-form"},[n._l(n.state.forminputs,function(t){return r("div",{key:t.id,staticClass:"form-group"},["numberfield"===t.type||"textfield"===t.type&&"Range"===t.widget_type?r("div",{staticClass:"numeric"},[r("label",{staticClass:"search-label",attrs:{for:t.id}},[r("span",[n._v(n._s(t.label||t.attribute))]),n._v(" "),r("span",{staticClass:"skin-color"},[n._v(n._s(n.getLabelOperator(t.operator)))])]),n._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"input.value"}],staticClass:"form-control",attrs:{type:"number",min:"0",id:t.id},domProps:{value:t.value},on:{change:function(e){return n.changeInput(t)},input:[function(e){e.target.composing||n.$set(t,"value",e.target.value)},function(e){return n.changeInput(t)}]}})]):["textfield","textField"].includes(t.type)?r("div",{staticClass:"form-item-search text"},[r("label",{staticClass:"search-label",attrs:{for:t.id}},[r("span",[n._v(n._s(t.label||t.attribute))]),n._v(" "),r("span",{staticClass:"skin-color"},[n._v(n._s(n.getLabelOperator(t.operator)))])]),n._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"input.value"}],staticClass:"form-control",attrs:{type:"text",id:t.id},domProps:{value:t.value},on:{focus:n.onFocus,change:function(e){return n.changeInput(t)},input:function(e){e.target.composing||n.$set(t,"value",e.target.value)}}})]):["selectfield","autocompletefield"].includes(t.type)?r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:n.state.loading[t.dependance]||t.loading||t.disabled,expression:"state.loading[input.dependance] || input.loading || input.disabled"}],staticClass:"text"},[r("label",{staticClass:"search-label",attrs:{for:t.id}},[r("span",[n._v(n._s(t.label||t.attribute))]),n._v(" "),r("span",{staticClass:"skin-color"},[n._v(n._s(n.getLabelOperator(t.operator)))])]),n._v(" "),t.dependance?r("bar-loader",{attrs:{loading:n.state.loading[t.dependance]||t.loading}}):n._e(),n._v(" "),r("select",{directives:[{name:"disabled",rawName:"v-disabled",value:t.disabled||t.loading,expression:"input.disabled || input.loading"}],staticClass:"form-control",attrs:{name:t.attribute,id:t.id}},n._l(t.values,function(e){return r("option",{key:e.value,domProps:{value:e.value}},[e.value===n.allvalue?r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.search.all",expression:"'sdk.search.all'"}]}):r("span",[n._v(n._s(e.key))])])}),0)],1):"datetimefield"===t.type?r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:n.state.loading[t.dependance]||!1,expression:"state.loading[input.dependance] || false"}],staticClass:"text"},[r("label",{staticClass:"search-label",attrs:{for:t.id}},[r("span",[n._v(n._s(t.label||t.attribute))]),n._v(" "),r("span",{staticClass:"skin-color"},[n._v(n._s(n.getLabelOperator(t.operator)))])]),n._v(" "),r("div",{ref:"date_"+t.id,refInFor:!0,staticClass:"input-group date"},[r("input",{staticClass:"form-control",attrs:{id:t.id,type:"text"}}),n._v(" "),r("span",{staticClass:"input-group-addon skin-color"},[r("span",{class:n.g3wtemplate.getFontClass(t.options.format.time?"time":"calendar")})])])]):n._e(),n._v(" "),r("sub",[n._v(n._s(t.options.description))]),n._v(" "),n.is_superuser?r("sub",[t.options.description?r("br"):n._e(),n._v(" "),r("span",{staticClass:"skin-color"},[n._v(n._s(t.type))]),n._v(" | "),r("span",{staticClass:"skin-color"},[n._v(n._s(t.widget_type))]),n._v(" "),t.options.value?[n._v(': { key: "'+n._s(t.options.key)+'", value: "'+n._s(t.options.value)+' }"')]:n._e(),n._v(" "),t.options.layer_id?[r("br"),r("span",{staticClass:"skin-color"},[n._v("layer_id:")]),n._v(' "'+n._s(t.options.layer_id)+'"')]:n._e(),n._v(" "),t.dependance?[r("br"),r("span",{staticClass:"skin-color"},[n._v("depends_on:")]),n._v(' "'+n._s(t.dependance)+'"')]:n._e(),n._v(" "),t.dependance?[r("br"),r("span",{staticClass:"skin-color"},[n._v("strict:")]),n._v(" "+n._s(t.dependance_strict))]:n._e()],2):n._e(),n._v(" "),t.logicop?r("div",{staticClass:"search-logicop skin-border-color"},[r("h4",[n._v(n._s(t.logicop))])]):n._e()])}),n._v(" "),r("div",{staticClass:"form-group"},[r("button",{directives:[{name:"t",rawName:"v-t",value:"dosearch",expression:"'dosearch'"}],staticClass:"sidebar-button-run btn btn-block pull-right",attrs:{id:"dosearch","data-i18n":"dosearch"},on:{click:function(e){return e.stopPropagation(),n.doSearch(e)}}})])],2)]),n._v(" "),n._t("footer"),n._v(" "),n.layers_url?r("div",{staticStyle:{"padding-top":"5em"}},[r("b",[r("a",{attrs:{href:n.layers_url,target:"_blank"}},[n._v("Edit in admin")])])]):n._e()],2)},e.staticRenderFns=[],e._scopeId="data-v-51de5286"},{"app/constant":5,"core/i18n/i18n.service":12,"mixins/resize":293,"services/application":298,"store/application-state":310,"utils/convertQGISDateTimeFormatToMoment":334,"utils/createSingleFieldParameter":353,"utils/getDataForSearchInput":378,"vueify/lib/insert-css":2}],228:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0}),i=r(e("store/application-state")),a=e("app/eventbus"),o=r(e("services/sidebar")),s=e("app/constant"),l=e("core/i18n/i18n.service").t,n.default={name:"Sidebar",data:function(){return{components:o.default.state.components,panels:o.default.stack.state.contentsdata,bOpen:!0,bPageMode:!1,header:l("main navigation"),state:o.default.state,zIndex:s.ZINDEXES.usermessage.tool+2}},computed:{title:function(){return this.state.gui.title},disabled:function(){return i.default.gui.sidebar.disabled},panelsinstack:function(){return 0<this.panels.length},showmainpanel:function(){return 0<this.components.length&&!this.panelsinstack},componentname:function(){return this.components.length?this.components.slice(-1)[0].getTitle():""},panelname:function(){return this.panels.length?this.panels.slice(-1)[0].content.getTitle():""}},methods:{closePanel:function(){o.default.closePanel()},closeAllPanels:function(){o.default.closeAllPanels()}},created:function(){this.iframe=i.default.iframe,a.SidebarEventBus.$on("sidebaritemclick",function(){return $(".sidebar-toggle").click()})}},t.exports.__esModule&&(t.exports=t.exports.default);var i,a,o,s,l,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("aside",[t("div",{staticClass:"main-sidebar",class:{iframe:e.iframe}},[t("div",{staticClass:"sidebar",class:{"g3w-disabled":e.disabled},attrs:{id:"g3w-sidebar"}},[t("div",{attrs:{id:"disable-sidebar"}}),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.panelsinstack,expression:"panelsinstack"}],staticClass:"g3w-sidebarpanel"},[t("div",{staticStyle:{overflow:"hidden","line-height":"14px","font-size":"1.5em"},attrs:{id:"g3w-sidebarpanel-header-placeholder"}},[t("div",{staticStyle:{display:"flex"},style:{justifyContent:e.state.gui.title?"space-between":"flex-end"}},[e.title?t("h4",{directives:[{name:"t",rawName:"v-t",value:e.title,expression:"title"}],staticStyle:{display:"inline-block","font-weight":"bold"}}):e._e(),e._v(" "),t("div",[1<e.panels.length?t("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"back",expression:"'back'",modifiers:{create:!0}}],staticClass:"skin-tooltip-left g3w-span-button close-pane-button fa-stack",attrs:{"data-placement":"left","data-toggle":"tooltip","data-container":"body"},on:{click:e.closePanel}},[t("i",{staticClass:"fa-stack-1x panel-button",class:e.g3wtemplate.getFontClass("circle")}),e._v(" "),t("i",{staticClass:"fa-stack-1x panel-icon",class:e.g3wtemplate.getFontClass("arrow-left")})]):e._e(),e._v(" "),t("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"close",expression:"'close'",modifiers:{create:!0}}],staticClass:"skin-tooltip-left g3w-span-button close-pane-button fa-stack",attrs:{"data-placement":"left","data-toggle":"tooltip","data-container":"body"},on:{click:e.closeAllPanels}},[t("i",{staticClass:"fa-stack-1x panel-button",class:e.g3wtemplate.getFontClass("circle")}),e._v(" "),t("i",{staticClass:"fa-stack-1x panel-icon",class:e.g3wtemplate.getFontClass("close")})])])])]),e._v(" "),t("div",{staticClass:"g3w-sidebarpanel-placeholder",attrs:{id:"g3w-sidebarpanel-placeholder"}})]),e._v(" "),t("div",{attrs:{id:"g3w-sidebarcomponents-content"}},[t("ul",{directives:[{name:"show",rawName:"v-show",value:e.showmainpanel,expression:"showmainpanel"}],staticClass:"sidebar-menu",class:{"g3w-disabled":e.state.disabled},attrs:{id:"g3w-sidebarcomponents"}})])])]),e._v(" "),t("a",{staticClass:"sidebar-aside-toggle",class:{"g3w-disabled":e.disabled,iframe:e.iframe},style:{zIndex:e.zIndex},attrs:{href:"#","data-toggle":"offcanvas",role:"button"}},[t("i",{class:e.g3wtemplate.getFontClass("bars")})])])},e.staticRenderFns=[],e._scopeId="data-v-b2170cb4"},{"app/constant":5,"app/eventbus":46,"core/i18n/i18n.service":12,"services/sidebar":307,"store/application-state":310}],229:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),r=e("app/eventbus"),e=(e=e=e("components/SidebarItemAction.vue"))&&e.__esModule?e:{default:e},n.default={name:"SidebarItem",data:function(){return{info:this.$options.info||{state:null,style:null,class:null},main:!0,component:this.$options.component,active:!1,title:"",open:!1,icon:null,iconColor:null,collapsible:null}},components:{SidebarItemAction:e.default},methods:{onClickItem:function(e){var t=this;this.component.isolate&&e.stopPropagation(),this.component.isolate||(this.$options.service.state.components.forEach(function(e){e!==t.component&&e.getOpen()&&e.click({open:e.isolate})}),!this.component.collapsible&&isMobile.any&&r.SidebarEventBus.$emit("sidebaritemclick")),this.component.setOpen(!this.component.state.open)}},created:function(){var e=this;this.component.openClose=function(){return e.$refs.anchor_click.click()}}},t.exports.__esModule&&(t.exports=t.exports.default);var r,n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("li",{directives:[{name:"show",rawName:"v-show",value:t.state.visible,expression:"state.visible"},{name:"disabled",rawName:"v-disabled",value:t.state.disabled,expression:"state.disabled"}],staticClass:"treeview sidebaritem",class:{active:t.open},attrs:{id:t.component.id}},[n("bar-loader",{attrs:{loading:t.state.loading}}),t._v(" "),n("a",{ref:"anchor_click",staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"},attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.onClickItem(e)}}},[n("div",[n("i",{class:t.icon,style:{color:t.iconColor}}),t._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:t.title,expression:"title"}],staticClass:"treeview-label"})]),t._v(" "),n("div",[t.info.state?n("span",{class:t.info.class,staticStyle:{position:"absolute",right:"5px","font-weight":"bold"},style:t.info.style,attrs:{title:t.info.tooltip}},[t._v(t._s(t.info.state))]):t._e(),t._v(" "),t._l(t.actions,function(e){return n("sidebar-item-action",{key:e.id,attrs:{component:t.component.internalComponent,action:e}})})],2),t._v(" "),t.collapsible?n("i",{staticClass:"pull-right",class:t.g3wtemplate.getFontClass("angle-left")}):t._e()]),t._v(" "),n("div",{attrs:{id:"g3w-sidebarcomponent-placeholder"}})],1)},n.staticRenderFns=[],n._scopeId="data-v-2f606059"},{"app/eventbus":46,"components/SidebarItemAction.vue":230}],230:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default={name:"Sidebaritemaction",props:{action:{type:Object,required:!0},component:{type:Object}},methods:{triggerAction:function(){this.action.fnc(this.component)}}},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var t=this,e=t.$createElement;return(t._self._c||e)("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:t.action.tooltip,expression:"action.tooltip",arg:"left",modifiers:{create:!0}}],staticClass:"action skin-tooltip-left",class:t.action.class,staticStyle:{"font-weight":"bold",padding:"3px"},style:t.action.style,on:{click:function(e){return e.stopPropagation(),t.triggerAction(e)}}})},n.staticRenderFns=[]},{}],231:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),e=(e=e=e("components/SpatialBookMarkItem.vue"))&&e.__esModule?e:{default:e},n.default={name:"spatial-bookmark-group",props:{group:{type:Object,required:!0}},components:{SpatialBookMarkItem:e.default}},t.exports.__esModule&&(t.exports=t.exports.default);n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("li",[n("div",{staticStyle:{"font-weight":"bold",width:"100%"},style:{borderBottom:t.group.expanded?"2px solid #2c3b41":"none"},on:{click:function(e){e.stopPropagation(),t.group.expanded=!t.group.expanded}}},[n("span",{class:t.g3wtemplate.getFontClass(t.group.expanded?"caret-down":"caret-right"),staticStyle:{"margin-right":"5px"}}),t._v(" "),n("span",[t._v(t._s(t.group.name))])]),t._v(" "),n("ul",{directives:[{name:"show",rawName:"v-show",value:t.group.expanded,expression:"group.expanded"}],staticStyle:{"margin-left":"10px"}},t._l(t.group.nodes,function(e){return n("spatial-book-mark-item",{attrs:{bookmark:e}})}),1)])},n.staticRenderFns=[]},{"components/SpatialBookMarkItem.vue":232}],232:[function(e,t,n){var r,i,a;e("vueify/lib/insert-css").insert(".spatial-bookmark[data-v-fab34912]{display:flex;align-items:baseline;justify-content:space-between;padding:5px!important}");function o(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),s=e("services/gui"),r=(s=s)&&s.__esModule?s:{default:s},a=e("g3w-ol/projection/projections"),n.default={name:"spatial-bookmark-item",props:{bookmark:{type:Object,required:!0}},methods:{removeBookMark:function(){},gotoSpatialBookmark:(i=o(function*(e){var t=e.extent,e=e.crs;e.epsg!==r.default.getService("map").getEpsg().split("EPSG:")[1]&&(e=yield a.registerProjection("EPSG:"+e.epsg),t=ol.proj.transformExtent(t,e,r.default.getService("map").getProjection())),r.default.getService("map").zoomToExtent(t,{force:!0})}),function(e){return i.apply(this,arguments)})}},t.exports.__esModule&&(t.exports=t.exports.default);var s="function"==typeof t.exports?t.exports.options:t.exports;s.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("li",{staticClass:"spatial-bookmark",on:{click:function(e){return e.stopPropagation(),t.gotoSpatialBookmark(t.bookmark)}}},[e("div",[e("span",{class:t.g3wtemplate.getFontClass("bookmark"),staticStyle:{"margin-right":"5px","font-size":"0.7em"}}),t._v(" "),e("span",{staticClass:"g3w-long-text"},[t._v(t._s(t.bookmark.name))])]),t._v(" "),t.bookmark.removable?e("span",{staticClass:"sidebar-button sidebar-button-icon",staticStyle:{color:"red",margin:"5px",cursor:"pointer"},on:{click:function(e){return e.stopPropagation(),t.$emit("remove-bookmark",t.bookmark.id)}}},[e("i",{class:t.g3wtemplate.getFontClass("trash")})]):t._e()])},s.staticRenderFns=[],s._scopeId="data-v-fab34912"},{"g3w-ol/projection/projections":76,"services/gui":302,"vueify/lib/insert-css":2}],233:[function(e,t,n){var r,i,a,o,s,l,u,c,d,p,f;e("vueify/lib/insert-css").insert(".content-bookmarks{font-weight:700;color:#fff;padding:5px;border-bottom:1px solid #fff;margin-bottom:2px}");function h(e){return e&&e.__esModule?e:{default:e}}function g(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),r=e("app/constant"),i=h(e("services/gui")),a=h(e("services/application")),o=h(e("store/projects")),s=h(e("components/SpatialBookMarkGroup.vue")),l=h(e("components/SpatialBookMarkItem.vue")),u=h(e("components/InputText.vue")),d=e("utils").uniqueId,p=e("core/i18n/i18n.service").t,f=a.default.getLocalItem(r.LOCAL_ITEM_IDS.SPATIALBOOKMARKS.id),n.default={name:"spatial-bookmarks",components:{SpatialBookMarkGroup:s.default,SpatialBookMarkItem:l.default,InputText:u.default},data:function(){var e=o.default.getCurrentProject();return void 0===f[e.getId()]&&(f[e.getId()]=[]),{showaddform:!1,project:{bookmarks:e.getSpatialBookmarks()||[]},user:{bookmarks:f[e.getId()]},addbookmarkinput:{name:"add-bookmark",label:p("sdk.spatialbookmarks.input.name"),i18nLabel:!0,value:null,editable:!0,type:"varchar",input:{type:"text",options:{}},visible:!0,validate:{valid:!1,required:!0}}}},computed:{hasProjectbookmarks:function(){return 0<this.project.bookmarks.length}},methods:{addBookMark:function(){this.user.bookmarks.push({id:d(),name:this.addbookmarkinput.value,extent:i.default.getService("map").getMapExtent(),removable:!0,crs:{epsg:+i.default.getService("map").getCrs().split("EPSG:")[1]}}),this.saveUserBookMarks(),this.showaddform=!1},removeBookMark:function(t){this.user.bookmarks=this.user.bookmarks.filter(function(e){return t!==e.id}),this.saveUserBookMarks()},saveUserBookMarks:function(){f[o.default.getCurrentProject().getId()]=this.user.bookmarks,a.default.setLocalItem({id:r.LOCAL_ITEM_IDS.SPATIALBOOKMARKS.id,data:f})},showAddForm:function(){this.addbookmarkinput.value=null,this.showaddform=!0}},watch:{showaddform:(c=g(function*(e){if(e){yield this.$nextTick();for(var t=0;t<this.$refs.add_bookmark_input.$el.children.length;t++)this.$refs.add_bookmark_input.$el.children[t].classList.remove("col-sm-12")}}),function(e){return c.apply(this,arguments)})},created:function(){var e=this;this.$on("close",function(){return e.showaddform=!1})}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ul",{staticClass:"treeview-menu g3w-spatial-bookmarks menu-items",class:{"g3w-tools":!t.showaddform},attrs:{id:"g3w-spatial-bookmarks"}},[t.showaddform?[n("li",[n("div",{staticStyle:{display:"flex","justify-content":"end"}},[n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"close",expression:"'close'",arg:"left",modifiers:{create:!0}}],staticClass:"sidebar-button sidebar-button-icon",class:t.g3wtemplate.getFontClass("close"),staticStyle:{padding:"5px",margin:"3px"},on:{click:function(e){e.stopPropagation(),t.showaddform=!1}}})]),t._v(" "),n("helpdiv",{attrs:{message:"sdk.spatialbookmarks.helptext"}}),t._v(" "),n("div",{staticClass:"container add-bookmark-input",staticStyle:{padding:"5px",width:"100%"}},[n("input-text",{ref:"add_bookmark_input",attrs:{state:t.addbookmarkinput}})],1),t._v(" "),n("div",{staticStyle:{"margin-top":"5px"}},[n("button",{directives:[{name:"t",rawName:"v-t",value:"add",expression:"'add'"},{name:"disabled",rawName:"v-disabled",value:!t.addbookmarkinput.validate.valid,expression:"!addbookmarkinput.validate.valid"}],staticClass:"sidebar-button-run btn btn-block",on:{click:function(e){return e.stopPropagation(),t.addBookMark(e)}}})])],1)]:[t.hasProjectbookmarks?[n("div",{staticClass:"content-bookmarks"},[n("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.spatialbookmarks.sections.project.title",expression:"'sdk.spatialbookmarks.sections.project.title'"}]})]),t._v(" "),t._l(t.project.bookmarks,function(e){return[e.nodes?n("spatial-book-mark-group",{attrs:{group:e}}):n("spatial-book-mark-item",{attrs:{bookmark:e}})]})]:t._e(),t._v(" "),n("div",{staticClass:"content-bookmarks",staticStyle:{display:"flex","justify-content":"space-between","align-items":"center","margin-top":"10px"}},[n("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.spatialbookmarks.sections.user.title",expression:"'sdk.spatialbookmarks.sections.user.title'"}],staticStyle:{"font-weight":"bold",color:"#ffffff"}}),t._v(" "),n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"add",expression:"'add'",arg:"left",modifiers:{create:!0}}],staticClass:"sidebar-button sidebar-button-icon",class:t.g3wtemplate.getFontClass("plus"),staticStyle:{padding:"5px",cursor:"pointer"},on:{click:function(e){return e.stopPropagation(),t.showAddForm(e)}}})]),t._v(" "),t._l(t.user.bookmarks,function(e){return n("spatial-book-mark-item",{attrs:{bookmark:e},on:{"remove-bookmark":t.removeBookMark}})})]],2)},e.staticRenderFns=[]},{"app/constant":5,"components/InputText.vue":185,"components/SpatialBookMarkGroup.vue":231,"components/SpatialBookMarkItem.vue":232,"core/i18n/i18n.service":12,"services/application":298,"services/gui":302,"store/projects":317,utils:404,"vueify/lib/insert-css":2}],234:[function(e,t,n){e("vueify/lib/insert-css").insert("#streetview-error-key[data-v-06dad624]{display:flex;justify-content:center;align-items:center;font-weight:700;height:100%;padding:10px;background-color:#fff}");Object.defineProperty(n,"__esModule",{value:!0}),n.default={name:"streetview",data:function(){return{state:null}}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this.$createElement,e=this._self._c||e;return e("div",{attrs:{id:"streetview"}},[this.$options.keyError?e("div",{attrs:{id:"streetview-error-key"}},[e("span",{staticClass:"skin-color"},[this._v(this._s(this.$options.keyError))])]):this._e()])},e.staticRenderFns=[],e._scopeId="data-v-06dad624"},{"vueify/lib/insert-css":2}],235:[function(e,t,n){var i,o,a,s,l,f,r,u,c,d,p,h,g,v,m,y,_,b,w,x,S,L,C,E,T,M,P,O,F;e("vueify/lib/insert-css").insert(".geometry[data-v-b4d834d0]{cursor:pointer}#noheaders[data-v-b4d834d0]{background-color:#fff;font-weight:700;margin-top:10px}input.form-control.column-search[data-v-b4d834d0]{font-weight:400}");function I(e){return e&&e.__esModule?e:{default:e}}function j(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}function A(e){var t=void 0;return e.attributes&&(t=e.geometry),e.geometry&&(t=(0,p.coordinatesToGeometry)(e.geometry.type,e.geometry.coordinates)),{attributes:e.attributes||e.properties,geometry:t}}function R(){$(".dataTables_info, .dataTables_length").hide(),$(".dataTables_paginate").css({display:"flex","justify-content":"space-between","font-size":"0.8em","margin-top":"5px"}),$(".dataTables_filter").css("float","right"),$(".dataTables_paginate").css("margin","0")}Object.defineProperty(n,"__esModule",{value:!0}),i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=I(e("components/TableSelectRow.vue")),a=I(e("components/TableToolbar.vue")),s=I(e("components/FieldG3W.vue")),l=I(e("store/catalog-layers")),f=I(e("services/gui")),r=e("mixins"),u=e("utils/debounce"),c=I(e("core/g3w-component")),d=I(e("services/data")),p=e("utils/coordinatesToGeometry"),h=e("utils/noop"),g=I(e("core/g3w-object")),v=e("utils/getUniqueDomId"),m=e("core/i18n/i18n.service").t,y=e("core/layers/layer").SELECTION_STATE,_=[10,25,50],O=void 0,F=[],n.default={name:"G3WTable",mixins:[r.resizeMixin],components:{SelectRow:o.default,Field:s.default},data:function(){var n=this,r=[];return this.layer.isGeoLayer()||this.layer.getRelations().getArray().forEach(function(e){var t=l.default.getLayerById(e.getFather());n.layer.getId()!==e.getFather()&&t.isGeoLayer()&&r.push({layer:t,father_fields:e.getFatherField(),fields:e.getChildField(),features:{}})}),{service:this.service||void 0,layer:this.layer||void 0,state:this.service.state,table:null,selectedRow:null,relationsGeometry:r,paginationfilter:!1,selectedfeaturesfid:this.layer.getSelectionFids(),formatter:1,allfeaturesnumber:void 0,nopaginationsfilter:[],currentPage:0,_async:Object.assign({state:!1,fnc:h.noop},this._async||{}),getAll:!this.service.state.pagination,geolayer:this.layer.isGeoLayer(),paginationParams:{}}},methods:{get_check_id:function(e){return e&&(this.get_check_id.cached_id=(0,v.getUniqueDomId)()),this.get_check_id.cached_id},getField:function(e,t){return{value:e.attributes[t.name],label:void 0}},getDataFromBBOX:(P=j(function*(){var e=this,t=f.default.getService("map"),n=(this.service.state.tools.geolayer.active=!this.service.state.tools.geolayer.active,this.service.state.tools.geolayer.active),r=this.mapBBoxEventHandlerKey;n&&this.service.state.pagination&&(r.cb=function(){e.service.state.tools.geolayer.in_bbox=e.service.state.tools.geolayer.active?t.getMapBBOX().join(","):void 0,e.service.emit("ajax-reload")}),n&&!this.service.state.pagination&&(r.cb=j(function*(){e.service.state.tools.geolayer.in_bbox=e.service.state.tools.geolayer.active?t.getMapBBOX().join(","):void 0,e.filterChangeHandler({type:"in_bbox"})})),n&&(r.key=t.getMap().on("moveend",r.cb)),r.cb&&r.cb(),n||this.resetMapBBoxEventHandlerKey()}),function(){return P.apply(this,arguments)}),toggleFilterToken:(M=j(function*(){yield this.layer.toggleFilterToken()}),function(){return M.apply(this,arguments)}),clearAllSelection:function(){this.layer.clearSelectionFids()},switchSelection:(T=j(function*(){var n=this,e=this.service.state.pagination,r=this.nopaginationsfilter,i=!e&&r.length?[]:void 0,a=!1;e&&this.service.state.features.forEach(function(e){e.selected=!e.selected,a=e.selected}),e&&!this.getAll&&(yield this.getAllFeatures()),this.service.state.selectAll=e&&this.paginationfilter?a:this.service.state.selectAll,!e&&r.length&&(this.service.state.features.forEach(function(e,t){-1!==r.indexOf(t)&&i.push(e),e.selected=!e.selected,n.layer[e.selected?"includeSelectionFid":"excludeSelectionFid"](e.id),a=a||e.selected}),this.service.state.tools.show=a),e||r.length||this.service.state.features.forEach(function(e){e.selected=!e.selected}),!e&&r.length||this.layer.invertSelectionFids(),e||this.checkSelectAll(i),!e&&r.length||(this.service.state.tools.show=0<this.selectedfeaturesfid.size)}),function(){return T.apply(this,arguments)}),selectAllRow:(E=j(function*(){var e,n,r,i=this;this.state.features.length&&(this.service.state.selectAll=!this.service.state.selectAll,e=this.service.state.pagination,n=this.nopaginationsfilter,r=!1,!e&&n.length&&(this.service.state.features.forEach(function(e,t){-1!==n.indexOf(t)&&(e.selected=i.service.state.selectAll,i.layer[e.selected?"includeSelectionFid":"excludeSelectionFid"](e.id),r=r||e.selected)}),this.service.state.tools.show=r),e||n.length||(this.service.state.tools.show=this.service.state.selectAll,this.layer[this.service.state.selectAll?"setSelectionFidsAll":"clearSelectionFids"](),this.service.state.features.forEach(function(e){return e.selected=i.service.state.selectAll})),e&&this.paginationfilter&&this.service.state.featurescount>=this.service.state.allfeatures&&this.service.state.features.forEach(function(e){e.selected=i.service.state.selectAll,i.layer[e.selected?"includeSelectionFid":"excludeSelectionFid"](e.id)}),e&&this.paginationfilter&&this.service.state.featurescount<this.service.state.allfeatures&&(yield this.getAllFeatures({search:this.paginationParams.search,ordering:this.paginationParams.ordering,formatter:this.paginationParams.formatter,in_bbox:this.paginationParams.in_bbox})).forEach(function(e){!i.getAll&&i.geolayer&&e.geometry&&i.layer.addOlSelectionFeature({id:e.id,feature:A(e)}),i.layer[i.service.state.selectAll?"includeSelectionFid":"excludeSelectionFid"](e.id)}),e&&this.service.state.features.forEach(function(e){return e.selected=i.service.state.selectAll}),!e||this.paginationfilter||this.getAll||(yield this.getAllFeatures()),e&&!this.paginationfilter&&this.layer[this.service.state.selectAll?"setSelectionFidsAll":"clearSelectionFids"](),e)&&(this.service.state.tools.show=this.service.state.selectAll||0<this.selectedfeaturesfid.size)}),function(){return E.apply(this,arguments)}),zoomAndHighLightFeature:(C=j(function*(a){var r,o,s,i=this,l=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],e=f.default.getService("map");a.geometry&&this._async.state?this._async.fnc=e.highlightGeometry.bind(e,a.geometry,{zoom:l}):a.geometry&&!this._async.state?e.highlightGeometry(a.geometry,{zoom:l}):!a.geometry&&0<!this.relationsGeometry.length||a.geometry||(r=[],o=[],s=[],this.relationsGeometry.forEach(function(e){var t=e.layer,n=e.father_fields,r=e.fields,e=e.features,i=r.map(function(e){return a.attributes[e]}),r=(s.push(i),void 0);l&&void 0===e[k]&&(r=d.default.getData("search:features",{inputs:{layer:t,formatter:1,filter:n.reduce(function(e,t,n){return e=e+(0<n?"|AND,":"")+t+"|eq|"+encodeURIComponent(i[n])},"")},outputs:!1})),o.push(r)}),(yield Promise.allSettled(o)).forEach(function(e,t){var n=e.status,e=e.value;"fulfilled"===n&&(n=i.relationsGeometry[t],t=s[t].join("__"),e=e&&e.data[0],void 0===n.features[t]&&(n.features[t]=e&&e.features||[]),n.features[t].forEach(function(e){return r.push(e)}))}),l?e.zoomToFeatures(r,{highlight:!0}):e.highlightFeatures(r))}),function(e){return C.apply(this,arguments)}),addRemoveSelectedFeature:function(e){e.selected=!e.selected;var t=this.selectedfeaturesfid,n=this.nopaginationsfilter,r=this.allfeaturesnumber,i=this.service.state.selectAll,a=this.service.state.pagination,o=this.service.state.features,s=this.service.state.tools&&this.service.state.tools.filter&&this.service.state.tools.filter.active,l=!i&&t.has(y.EXCLUDE),u=!i&&!l;i&&(this.service.state.selectAll=!1),i&&this.layer.excludeSelectionFid(e.id,a),(l||u)&&this.layer[e.selected?"includeSelectionFid":"excludeSelectionFid"](e.id),!s&&(l&&1===t.size||u&&t.size===r)&&this.layer.setSelectionFidsAll(),l&&1!==t.size&&t.size===o.length+1&&this.layer.clearSelectionFids(),this.service.state.tools.show=0<t.size,(l&&1===t.size||u&&t.size===r||!a&&n.length&&n.length===o.filter(function(e){return e.selected}).length)&&(this.service.state.selectAll=!0)},reloadLayout:(L=j(function*(){yield this.$nextTick(),O&&O.columns.adjust()}),function(){return L.apply(this,arguments)}),hasHeaders:function(){return!!this.state.headers.length},createdContentBody:function(){var a=this;F=F.filter(function(e){return e.$destroy(),!1}),O.rows().nodes().each(function(r,e){var i;$(r).css("cursor","pointer"),a.state.features.length&&(i=a.state.features[e],$(r).addClass("feature_attribute"),i.selected&&$(r).addClass("selected"),$(r).on("click",function(){i.geometry&&a.zoomAndHighLightFeature(i)}),$(r).on("mouseover",function(){i.geometry&&a.zoomAndHighLightFeature(i,!1)}),$(r).children().each(function(e,t){var e=a.state.headers[e],n=void 0;null===e?((n=new(Vue.extend(o.default))({propsData:{feature:i}})).$on("selected",function(e){return a.addRemoveSelectedFeature(e)}),a.$watch(function(){return i.selected},function(e){return e?$(r).addClass("selected"):$(r).removeClass("selected")})):(n=new(Vue.extend(s.default))({propsData:{state:{value:i.attributes[e.name]}}}),F.push(n)),$(t).html(n.$mount().$el)}))}),setTimeout(function(){return a.reloadLayout()},0)},resize:(S=j(function*(){yield this.$nextTick(),$("#open_attribute_table div.dataTables_scrollBody").height($(".content").height()-$("#open_attribute_table div.dataTables_scrollHeadInner").height()-130)}),function(){return S.apply(this,arguments)}),setFilteredFeature:function(e){var t=this,n=this.nopaginationsfilter=e;0===e.length||e.length===this.allfeaturesnumber?this.checkSelectAll():this.checkSelectAll(n.map(function(e){return t.service.state.features[e]}))},checkSelectAll:function(e){e=void 0===e?this.service.state.features:e,this.service.state.selectAll=this.selectedfeaturesfid.has(y.ALL)||e.length&&e.reduce(function(e,t){return e&&t.selected},!0)},getAllFeatures:function(i){var a=this;return f.default.setLoadingContent(!0),new Promise(function(r,e){a.layer.getDataTable(i||{}).then(function(e){var t,n=a.geolayer&&e.features;n&&!i&&(t=a.service.state.features.map(function(e){return e.id}),e.features.forEach(function(e){-1===t.indexOf(e.id)&&e.geometry&&a.layer.addOlSelectionFeature({id:e.id,feature:A(e)})}),a.getAll=!0),n&&r(e.features)}).fail(function(){return e()}).always(function(){return f.default.setLoadingContent(!1)})})},getData:function(){var o=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.start,s=void 0===t?0:t,t=e.order,l=void 0===t?[]:t,t=e.length,u=void 0===t?this.service.state.pageLength:t,t=e.columns,c=void 0===t?[]:t,t=e.search,d=void 0===t?{value:null}:t,t=e.firstCall,p=void 0!==t&&t;return f.default.setLoadingContent(!0),this.layer.setAttributeTablePageLength(u),new Promise(function(n,t){var e,r,i,a;o.service.state.headers.length?(e=d.value&&0<d.value.length?d.value:null,o.service.state.features.splice(0),l.length||l.push({column:1,dir:"asc"}),r=("asc"===l[0].dir?"":"-")+o.service.state.headers[l[0].column].name,o.currentPage=0===s||o.service.state.pagination&&o.service.state.tools.filter.active?1:s/u+1,i=o.service.state.tools.geolayer.in_bbox,a=o.service.state.pagination?c.filter(function(e){return e.search&&e.search.value}).map(function(e){return e.name+"|ilike|"+e.search.value+"|and"}).join(","):void 0,o.paginationParams={field:a||void 0,page:o.currentPage,page_size:u,search:e,in_bbox:i,formatter:o.formatter,ordering:r},o.layer.getDataTable(o.service.state.pagination?o.paginationParams:{ordering:r,in_bbox:i,formatter:o.formatter}).then(function(e){var t=e.features,t=void 0===t?[]:t;o.service.state.allfeatures=e.count||o.service.state.features.length,o.service.state.featurescount=t.length,o.allfeaturesnumber=void 0===o.allfeaturesnumber?e.count:o.allfeaturesnumber,o.paginationfilter=e.count!==o.allfeaturesnumber,o.service.state.pagination=p?o.service.state.tools.filter.active||t.length<o.allfeaturesnumber:o.service.state.pagination,(t||[]).forEach(function(e){var t={id:e.id,selected:o.layer.hasSelectionFid(e.id),attributes:e.attributes||e.properties,geometry:o.geolayer&&e.geometry||void 0},n=o.geolayer&&e.geometry,r=n&&o.layer.getOlSelectionFeature(e.id);n&&!r&&o.layer.addOlSelectionFeature({id:e.id,feature:A(e)}),o.service.state.features.push(t)}),o.service.state.tools.show=o.layer.getFilterActive()||0<o.selectedfeaturesfid.size,o.checkSelectAll(),n({data:o.service.state.features.map(function(e){var t=e.attributes||e.properties,n=[null];return o.service.state.headers.filter(function(e){return e}).forEach(function(e){e.value=t[e.name],n.push(e.value)}),n}),recordsFiltered:e.count,recordsTotal:e.count})}).fail(function(e){f.default.notify.error(m("info.server_error")),t(e)}).always(function(){f.default.setLoadingContent(!1)})):n({data:[],recordsTotal:0,recordsFiltered:0})})},clearAllServiceSelection:function(){this.state.features.forEach(function(e){return e.selected=!1}),this.state.tools.show=!1,this.state.selectAll=!1},clearService:function(){var e=this;this.layer.off("unselectionall",this.clearAllServiceSelection),this.layer.off("filtertokenchange",this.filterChangeHandler),this.resetMapBBoxEventHandlerKey(),this.allfeaturesnumber=null,this._async.state&&setTimeout(function(){e._async.fnc(),e._async.state=!1,e._async.fnc=h.noop})},resetMapBBoxEventHandlerKey:function(){var e=this.mapBBoxEventHandlerKey;ol.Observable.unByKey(e.key),e.key=null,e.cb=null},filterChangeHandler:(x=j(function*(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).type;this.allfeaturesnumber=void 0,!1!=("in_bbox"===e||!this.selectedfeaturesfid.has(y.ALL))&&(e=[],this.service.state.pagination||(this.service.state.features.splice(0),this.service.state.pagination=!1,e=(yield this.getData()).data||[]),this.service.emit("redraw",e))}),function(){return x.apply(this,arguments)}),onGUIContent:function(e){this._async=this._async||{},this._async.state=100===e.perc}},beforeCreate:function(){this.delayType="debounce",this.layer=l.default.getLayerById(this.$options.layerId),this.service=new g.default,this.service.state={pageLengths:_,pageLength:this.layer.getAttributeTablePageLength()||_[0],features:[],title:this.layer.getTitle(),headers:[null].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(this.layer.getTableHeaders())),geometry:!0,loading:!1,allfeatures:0,pagination:!0,selectAll:!1,nofilteredrow:!1,tools:{geolayer:{show:this.layer.isGeoLayer(),active:!1,in_bbox:void 0},show:!1,filter:this.layer.state.filter}}},created:(w=j(function*(){var t=this,n=(this.mapBBoxEventHandlerKey={key:null,cb:null},this.g3wComponent=new c.default({id:"openattributetable",service:this.service,internalComponent:this}));n.layout=function(){n.internalComponent.reloadLayout()},this.service.on("redraw",function(){n.layout()}),n.on("unmount",function(){t.clearService()}),this.clearAllServiceSelection=this.clearAllServiceSelection.bind(this),this.filterChangeHandler=this.filterChangeHandler.bind(this),this.onGUIContent=this.onGUIContent.bind(this),f.default.onbefore("setContent",this.onGUIContent),this.layer.on("unselectionall",this.clearAllServiceSelection),this.layer.on("filtertokenchange",this.filterChangeHandler),n.show=j(function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};try{f.default.closeOpenSideBarComponent(),yield t.getData({firstCall:!0}),f.default.showContent({content:n,perc:50,split:f.default.isMobile()?"h":"v",push:!1,title:e.title})}catch(e){f.default.notify.error(m("info.server_error"))}finally{n.emit("show")}}),n.on("show",function(){t.isMobile()&&f.default.hideSidebar(),t.$options.onShow()}),n.show({title:this.layer.getName()})}),function(){return w.apply(this,arguments)}),mounted:(b=j(function*(){var n,r=this;this.setContentKey=f.default.onafter("setContent",this.resize),yield this.$nextTick(),this.first=!1,O=$(this.$refs.attribute_table).DataTable(i({scrollX:!0,processing:!1,scrollCollapse:!0,sSearch:!1,order:[1,"asc"],dom:'l<"#g3w-table-toolbar">frtip',columnDefs:[{targets:0,orderable:!1,searchable:!1,width:"1%"}],lengthMenu:this.state.pageLengths,pageLength:this.state.pageLength},this.state.pagination?{columns:this.state.headers,ajax:(0,u.debounce)(function(e,t){var n;$("#open_attribute_table table tr").each(function(e){$(e).off("click"),$(e).off("mouseover")}),r.getData(e).then((n=j(function*(e){t(e),yield r.$nextTick(),r.createdContentBody(),r.isMobile()&&R()}),function(e){return n.apply(this,arguments)})).catch(console.warn)},800),serverSide:!0,deferLoading:this.state.allfeatures}:{searchDelay:600})),this.state.pagination?this.service.on("ajax-reload",O.ajax.reload):(O.on("search.dt",(0,u.debounce)(function(){r.setFilteredFeature(O.rows({search:"applied"})[0])},600)),O.on("length.dt",function(e,t,n){r.layer.setAttributeTablePageLength(n)})),this.changeColumn=(0,u.debounce)((n=j(function*(e,t){O.columns(t).search(e.target.value.trim()).draw(),r.state.pagination||r.setFilteredFeature(O.rows({search:"applied"})[0])}),function(e,t){return n.apply(this,arguments)})),this.isMobile()&&R(),$("#g3w-table-toolbar").html(new(Vue.extend(a.default))({propsData:{tools:this.state.tools,geolayer:this.state.geolayer,switchSelection:this.switchSelection,clearAllSelection:this.clearAllSelection,toggleFilterToken:this.toggleFilterToken,getDataFromBBOX:this.getDataFromBBOX}}).$mount().$el),this.service.on("redraw",function(e){O.clear(),O.draw(!1),setTimeout(function(){O.rows.add(e),O.draw(!1),r.createdContentBody(),r.isMobile()&&R()})})}),function(){return b.apply(this,arguments)}),beforeDestroy:function(){this.clearService(),this.service.off("ajax-reload"),this.service.off("redraw"),f.default.un("setContent",this.setContentKey),O.destroy(!0),O=null}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var r=this,e=r.$createElement,i=r._self._c||e;return i("div",{staticStyle:{"margin-top":"5px"},attrs:{id:"open_attribute_table"}},[r.hasHeaders()?i("table",{ref:"attribute_table",staticClass:"table table-striped row-border compact nowrap",staticStyle:{width:"100%"},attrs:{id:"layer_attribute_table"}},[i("thead",[i("tr",[i("th"),r._v(" "),r._l(r.state.headers,function(e,t){return 0<t?i("th",[i("input",{staticClass:"form-control column-search",staticStyle:{height:"25px","min-width":"40px",padding:"2px"},attrs:{type:"text",placeholder:e.name},on:{keyup:function(e){return r.changeColumn(e,t)}}})]):r._e()})],2),r._v(" "),i("tr",r._l(r.state.headers,function(e,t){return i("th",[i("span",0===t?[i("input",{staticClass:"magic-checkbox",attrs:{type:"checkbox",id:"attribute_table_select_all_rows",disabled:r.state.nofilteredrow||0===r.state.features.length},domProps:{checked:r.state.selectAll}}),r._v(" "),i("label",{staticStyle:{"margin-bottom":"0 !important"},attrs:{for:"attribute_table_select_all_rows"},on:{"!click":function(e){return e.stopPropagation(),e.preventDefault(),r.selectAllRow(e)}}},[i("span",{staticStyle:{padding:"5px"}})])]:[r._v(r._s(e.label))])])}),0)]),r._v(" "),i("tbody",{attrs:{id:"table_body_attributes"}},r._l(r.state.features,function(n,e){return i("tr",{key:n.id,staticClass:"feature_attribute",class:[e%2==1?"odd":"pair",{geometry:!!n.geometry},{selected:n.selected}],staticStyle:{cursor:"pointer"},attrs:{role:"row",selected:r.selectedRow===e},on:{mouseover:function(e){return r.zoomAndHighLightFeature(n,!1)},click:function(e){return r.zoomAndHighLightFeature(n,!0)}}},r._l(r.state.headers,function(e,t){return i("td",{attrs:{"tab-index":1}},[0===t?i("select-row",{attrs:{feature:n},on:{selected:r.addRemoveSelectedFeature}}):i("field",{attrs:{feature:n,state:r.getField(n,e)}})],1)}),0)}),0)]):i("div",{directives:[{name:"t",rawName:"v-t",value:"dataTable.no_data",expression:"'dataTable.no_data'"}],attrs:{id:"noheaders"}})])},e.staticRenderFns=[],e._scopeId="data-v-b4d834d0"},{"components/FieldG3W.vue":142,"components/TableSelectRow.vue":236,"components/TableToolbar.vue":237,"core/g3w-component":8,"core/g3w-object":9,"core/i18n/i18n.service":12,"core/layers/layer":21,mixins:290,"services/data":300,"services/gui":302,"store/catalog-layers":311,"utils/coordinatesToGeometry":337,"utils/debounce":360,"utils/getUniqueDomId":397,"utils/noop":421,"vueify/lib/insert-css":2}],236:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),r=e("utils").getUniqueDomId,n.default={name:"select-row",props:{feature:{required:!0}},data:function(){return{id:r()}},methods:{select:function(){this.$emit("selected",this.feature)}},destroyed:function(){this.$off("selected")}},t.exports.__esModule&&(t.exports=t.exports.default);var r,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("span",[e("input",{staticClass:"magic-checkbox",attrs:{type:"checkbox",id:t.id},domProps:{checked:t.feature.selected}}),t._v(" "),e("label",{attrs:{for:t.id},on:{"!click":function(e){return e.stopPropagation(),e.preventDefault(),t.select(e)}}},[e("span")])])},e.staticRenderFns=[]},{utils:404}],237:[function(e,t,n){e("vueify/lib/insert-css").insert(".action-button[data-v-4f671d73]{padding:4px}.action-button.toggled[data-v-4f671d73]{border:1px solid #ccc}");Object.defineProperty(n,"__esModule",{value:!0}),e=e("store/application-state"),r=(e=e)&&e.__esModule?e:{default:e},n.default={name:"g3w-table-toolbar",props:{tools:{type:Object},switchSelection:{type:Function},clearAllSelection:{type:Function},toggleFilterToken:{type:Function},getDataFromBBOX:{type:Function}},computed:{disableMapTool:function(){return!this.tools.geolayer.active&&r.default.gui.layout[r.default.gui.layout.__current].rightpanel.height_100}}},t.exports.__esModule&&(t.exports=t.exports.default);var r,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",{staticStyle:{display:"flex","justify-content":"space-between",padding:"1px"}},[t.tools.geolayer.show?e("div",{directives:[{name:"disabled",rawName:"v-disabled",value:t.disableMapTool,expression:"disableMapTool"},{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"layer_selection_filter.tools.show_features_on_map",expression:"'layer_selection_filter.tools.show_features_on_map'",modifiers:{create:!0}}],staticClass:"skin-color action-button skin-tooltip-right",class:[t.g3wtemplate.getFontClass("map"),t.tools.geolayer.active?"toggled":""],attrs:{"data-placement":"right","data-toggle":"tooltip","data-container":"body"},on:{click:function(e){return e.stopPropagation(),t.getDataFromBBOX(e)}}}):t._e(),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.tools.show,expression:"tools.show"},{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"layer_selection_filter.tools.clear",expression:"'layer_selection_filter.tools.clear'",modifiers:{create:!0}}],staticClass:"skin-color action-button skin-tooltip-right",class:t.g3wtemplate.getFontClass("clear"),attrs:{"data-placement":"right","data-toggle":"tooltip","data-container":"body"},on:{click:function(e){return e.stopPropagation(),t.clearAllSelection(e)}}}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.tools.show,expression:"tools.show"},{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"layer_selection_filter.tools.invert",expression:"'layer_selection_filter.tools.invert'",modifiers:{create:!0}}],staticClass:"skin-color action-button skin-tooltip-right",class:[t.g3wtemplate.getFontClass("invert"),t.tools.filter.active?"g3w-disabled":""],attrs:{"data-placement":"right","data-toggle":"tooltip","data-container":"body"},on:{click:function(e){return e.stopPropagation(),t.switchSelection(e)}}}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.tools.show,expression:"tools.show"},{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"layer_selection_filter.tools.filter",expression:"'layer_selection_filter.tools.filter'",modifiers:{create:!0}}],staticClass:"skin-color action-button skin-tooltip-right",class:[t.g3wtemplate.getFontClass("filter"),t.tools.filter.active?"toggled":""],attrs:{"data-placement":"right","data-toggle":"tooltip","data-container":"body"},on:{click:function(e){return e.stopPropagation(),t.toggleFilterToken(e)}}})])},e.staticRenderFns=[],e._scopeId="data-v-4f671d73"},{"store/application-state":310,"vueify/lib/insert-css":2}],238:[function(e,t,n){var r,i;e("vueify/lib/insert-css").insert(".tool_disabled[data-v-31811884]{cursor:not-allowed}.tool_disabled>span[data-v-31811884]{color:#777}.tool_type[data-v-31811884]{cursor:pointer;vertical-align:center;position:absolute;right:0;top:0;padding:5px}");function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0}),r=a(e("services/application")),i=a(e("services/gui")),n.default={name:"g3w-tool",props:["tool"],methods:{showToolStateMessage:function(){i.default.showModalDialog({title:this.tool.state.type.toUpperCase(),message:this.tool.state.message})}},computed:{disabled:function(){return!this.tool.offline&&!r.default.getState().online||this.tool.loading||this.tool.disabled}}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var a=this,e=a.$createElement,e=a._self._c||e;return e("div",["checkbox"===a.tool.type?e("div",{staticClass:"checkbox"},[e("label",[e("input",{directives:[{name:"model",rawName:"v-model",value:a.tool.isCheck,expression:"tool.isCheck"}],staticStyle:{cursor:"pointer"},attrs:{id:a.tool.layerName,type:"checkbox"},domProps:{value:a.tool.layerName,checked:Array.isArray(a.tool.isCheck)?-1<a._i(a.tool.isCheck,a.tool.layerName):a.tool.isCheck},on:{click:function(e){return a.tool.action(a.tool)},change:function(e){var t,n,r=a.tool.isCheck,e=e.target,i=!!e.checked;Array.isArray(r)?(t=a.tool.layerName,n=a._i(r,t),e.checked?n<0&&a.$set(a.tool,"isCheck",r.concat([t])):-1<n&&a.$set(a.tool,"isCheck",r.slice(0,n).concat(r.slice(n+1)))):a.$set(a.tool,"isCheck",i)}}}),a._v("\n      "+a._s(a.tool.name)+"\n    ")])]):e("div",{staticClass:"tool",class:{tool_disabled:a.disabled},staticStyle:{position:"relative"},on:{click:function(e){a.disabled||a.tool.action(a.tool)}}},[e("bar-loader",{attrs:{loading:a.tool.loading}}),a._v(" "),e("i",{class:a.g3wtemplate.getFontClass(a.tool.icon||"caret-right")}),a._v(" "),a.tool.html?e("span",[e("i",{class:a.tool.html.icon}),a._v("\n      "+a._s(a.tool.html.text||a.tool.name)+"\n    ")]):e("span",{directives:[{name:"t",rawName:"v-t",value:a.tool.name,expression:"tool.name"}]}),a._v(" "),a.tool.state.type?e("span",{staticClass:"tool_type",style:{color:{alert:"red",info:"blue",warning:"orange"}[a.tool.state.type]},on:{click:function(e){return e.stopPropagation(),a.showToolStateMessage(e)}}},[e("i",{class:a.g3wtemplate.getFontClass(a.tool.state.type)})]):a._e()],1)])},e.staticRenderFns=[],e._scopeId="data-v-31811884"},{"services/application":298,"services/gui":302,"vueify/lib/insert-css":2}],239:[function(e,t,n){var s,l,r,i,a,u,c;e("vueify/lib/insert-css").insert(".usermessage-content[data-v-57c4f706]{color:#fff;z-index:1000;position:absolute;line-height:normal;padding:3px;min-width:250px;box-shadow:0 3px 5px rgba(0,0,0,.3);-moz-box-shadow:0 3px 5px rgba(0,0,0,.3)}.usermessage-content.mobile[data-v-57c4f706]{padding:0;min-width:100%}.usermessage-header-content[data-v-57c4f706]{display:flex;align-items:baseline;justify-content:space-between;width:100%}.usermessage-header-icontype[data-v-57c4f706]{padding:10px 0 0 5px;font-weight:700;font-size:1.3em}.usermessage-content.mobile .usermessage-header-icontype[data-v-57c4f706]{padding:0 0 0 5px;font-size:1.1em}.usermessage-header-title[data-v-57c4f706],.usermessage-header-title h4[data-v-57c4f706]{font-weight:700;text-align:center}.usermessage-content.mobile .usermessage-header-title h4[data-v-57c4f706]{margin:0}.usermessage-header-subtitle[data-v-57c4f706]{font-weight:700;margin:5px}.usermessage-header-right[data-v-57c4f706]{padding:5px}.usermessage-header-right-item[data-v-57c4f706]{font-weight:700!important;font-size:1.2em;cursor:pointer}.usermessage-message[data-v-57c4f706]{width:100%;padding:0 0 3px 10px;max-height:100px;font-size:1.1em;align-self:flex-start;overflow-y:auto}");function o(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=e("app/constant"),e=e("services/gui"),i=(e=e)&&e.__esModule?e:{default:e},u={success:{backgroundColor:"#62ac62",color:"#FFFFFF"},info:{backgroundColor:"#44a0bb",color:"#FFFFFF"},warning:{backgroundColor:"#f29e1d",color:"#FFFFFF"},alert:{backgroundColor:"#c34943",color:"#FFFFFF"},tool:{backgroundColor:"#FFFFFF",color:"#222d32"},loading:{backgroundColor:"#FFFFFF",color:"#222d32",fontWeight:"bold"}},c={success:{},info:{},warning:{},alert:{},tool:{"z-index":r.ZINDEXES.usermessage.tool,left:"40px"},loading:{}},n.default={name:"usermessage",props:{id:{},type:{type:String,default:"info"},title:{type:String,default:null},subtitle:{type:String,default:null},position:{type:String,default:"top"},size:{type:String,default:"fullpage"},message:{type:String,default:""},textMessage:{type:Boolean,default:!1},autoclose:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},duration:{type:Number,default:2e3},closable:{type:Boolean,default:!0}},computed:{showheader:function(){return"loading"!==this.type}},methods:{addClassMobile:function(){return this.isMobile()&&!i.default.isSidebarVisible()},closeUserMessage:function(){this.$emit("close-usermessage")},hideShow:function(){}},created:function(){var e,t,n,r=this.position.split("-"),r=l(r,2),i=r[0],r=r[1],a="100%";switch(this.size){case"small":a="25%";break;case"medium":a="50%";break;default:a="100%"}var i="center"===i?{top:0,bottom:0,maxHeight:"20%"}:(n=50,(t=i)in(e={})?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e),o=s({},i,{width:a});if(r)switch(o.width="25%",r){case"center":o.left="0",o.right="0",o.margin="auto";break;case"right":o.right=0}this.style=s({},u[this.type],o,c[this.type])},mounted:(a=o(function*(){var e,t=this;this.autoclose&&(yield this.$nextTick(),e=setTimeout(function(){t.closeUserMessage(),clearTimeout(e)},this.duration))}),function(){return a.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("div",{staticClass:"usermessage-content",class:{mobile:e.addClassMobile()},style:e.style,attrs:{id:e.id}},[e.showheader?t("div",{staticClass:"usermessage-header-content"},[t("i",{staticClass:"usermessage-header-icontype",class:e.g3wtemplate.getFontClass(e.type)}),e._v(" "),t("div",{staticClass:"usermessage-header-title"},[e._t("header",[e.title?t("h4",{directives:[{name:"t",rawName:"v-t",value:e.title,expression:"title"}]}):t("h4",[e._v(" "+e._s(e.type.toUpperCase()))]),e._v(" "),e.subtitle?t("h5",{directives:[{name:"t",rawName:"v-t",value:e.subtitle,expression:"subtitle"}],staticClass:"usermessage-header-subtitle"}):e._e()])],2),e._v(" "),t("div",{staticClass:"usermessage-header-right"},[!e.autoclose&&e.closable?t("div",{on:{click:e.closeUserMessage}},[t("i",{staticClass:"usermessage-header-right-item",class:e.g3wtemplate.getFontClass("close")})]):e._e()])]):e._e(),e._v(" "),e._t("body",[e.textMessage?t("div",{staticClass:"usermessage-message"},[e._v(e._s(e.message))]):t("div",{directives:[{name:"t",rawName:"v-t",value:e.message,expression:"message"}],staticClass:"usermessage-message"})]),e._v(" "),e._t("footer")],2)},e.staticRenderFns=[],e._scopeId="data-v-57c4f706"},{"app/constant":5,"services/gui":302,"vueify/lib/insert-css":2}],240:[function(e,t,n){var r,i,a,o,s,l,u,c;e("vueify/lib/insert-css").insert(".content_breadcrumb[data-v-466a54cc]{font-size:1.2em;padding:0 3px;border-radius:3px}");function d(e){return e&&e.__esModule?e:{default:e}}function p(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(n,"__esModule",{value:!0}),i=d(e("components/UserMessage.vue")),a=d(e("components/NotifyOnline.vue")),o=d(e("components/NotifyDownload.vue")),s=d(e("components/NotifyPlugins.vue")),l=e("app/constant"),u=d(e("services/viewport")),c=d(e("services/gui")),n.default={name:"Viewport",props:{appState:{type:Object}},components:{userMessage:i.default,onlineNotify:a.default,downloadNotify:o.default,pluginsNotify:s.default},data:function(){return{state:u.default.state,updatePreviousTitle:!1,media:{matches:!0}}},computed:{breadcrumb:function(){return this.state.content.contentsdata.filter(function(e){return e.options.crumb}).map(function(e){return e.options.crumb})},showresize:function(){var e=u.default.getCurrentContentLayout()["h"===this.state.split?"width":"height"];return this.state.resized.start&&0<this.state.secondaryPerc&&this.state.secondaryPerc<100&&e<100&&0<e},showresizeicon:function(){return 100!==this.state.secondaryPerc},hooks:function(){return this.usermessage.hooks},usermessage:function(){return this.state.usermessage},showtitle:function(){if(this.state.content.contentsdata.length){var e=this.state.content.contentsdata[this.state.content.contentsdata.length-1].options;if(_.isBoolean(e.showtitle))return e.showtitle}return!0},showContent:function(){return this.state.content.show},styles:function(){return{map:{width:this.state.map.sizes.width+"px",height:this.state.map.sizes.height+"px"},content:{width:this.state.content.sizes.width+"px",height:this.state.content.sizes.height+"px",zIndex:l.ZINDEXES.usermessage.tool+1,minHeight:"v"===this.state.split?l.VIEWPORT.resize.content.min+"px":null,paddingTop:"8px",paddingBottom:"8px"}}},contentTitle:function(){var e;if(this.state.content.contentsdata.length)return{title:(e=this.state.content.contentsdata[this.state.content.contentsdata.length-1].options).title,post_title:e.post_title}},backOrBackTo:function(){return!!(1<this.state.content.contentsdata.length&&this.state.content.showgoback)&&(this.state.content.contentsdata[this.state.content.contentsdata.length-2].options.title?"backto":"back")},previousTitle:function(){var e=this,t=1<this.state.content.contentsdata.length&&this.state.content.showgoback?this.state.content.contentsdata[this.state.content.contentsdata.length-2].options.title:null;return this.updatePreviousTitle=!0,this.$nextTick(function(){return e.updatePreviousTitle=!1}),t}},methods:{isNotLastCrumb:function(e){return e<this.breadcrumb.length-1},closeContent:function(){c.default.closeContent()},closeMap:function(){u.default.closeMap()},gotoPreviousContent:function(){c.default.popContent()},closeUserMessage:function(){c.default.closeUserMessage()},moveFnc:function(e){var t="h"===this.state.split?"width":"height",n=(e.preventDefault(),"width"==t?$(".sidebar-collapse").length?0:u.default.SIDEBARWIDTH:$("#main-navbar").height()),r=$(this.$el)[t](),e=("width"==t?e.pageX+2:e.pageY+2)-n,n=(e>r-l.VIEWPORT.resize.content.min?e=r-l.VIEWPORT.resize.content.min:e<l.VIEWPORT.resize.map.min&&(e=l.VIEWPORT.resize.map.min),r-e),r=100-Math.round(e/r*100);u.default.resizeViewComponents(this.state.split,{map:f({},t,e),content:f({},t,n)},r)}},mounted:(r=p(function*(){var t=this,e=(yield this.$nextTick(),window.matchMedia("(min-height: 300px)"));this.media.matches=e.matches,e.addListener(function(e){"change"===e.type&&(t.media.matches=e.currentTarget.matches)}),t.state.resized.start=!0}),function(){return r.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("div",{staticClass:"g3w-viewport"},[r("transition",{attrs:{name:"fade",duration:{enter:500,leave:500}}},[n.usermessage.show?r("user-message",{attrs:{title:n.usermessage.title,subtitle:n.usermessage.subtitle,id:n.usermessage.id,message:n.usermessage.message,draggable:n.usermessage.draggable,closable:n.usermessage.closable,duration:n.usermessage.duration,position:n.usermessage.position,autoclose:n.usermessage.autoclose,textMessage:n.usermessage.textMessage,size:n.usermessage.size,type:n.usermessage.type},on:{"close-usermessage":n.closeUserMessage}},[n.hooks.header?r("template",{slot:"header"},[r(n.hooks.header,{tag:"component"})],1):n._e(),n._v(" "),n.hooks.body?r("template",{slot:"body"},[r(n.hooks.body,{tag:"component"})],1):n._e(),n._v(" "),n.hooks.footer?r("template",{slot:"footer"},[r(n.usermessage.hooks.footer,{tag:"component"})],1):n._e()],2):n._e()],1),n._v(" "),r("div",{staticClass:"g3w-view map",class:"split-"+n.state.split,style:n.styles.map,attrs:{id:"g3w-view-map"}},[r("g3w-resize",{class:"split-"+n.state.split,style:{backgroundColor:"transparent"},attrs:{id:"resize-map-and-content",show:n.showresize,moveFnc:n.moveFnc,orientation:n.state.split}}),n._v(" "),r("div",{attrs:{id:"application-notifications"}},[r("online-notify"),n._v(" "),r("download-notify"),n._v(" "),r("plugins-notify")],1)],1),n._v(" "),r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:n.state.content.disabled,expression:"state.content.disabled"}],staticClass:"g3w-view content",class:"split-"+n.state.split,style:n.styles.content,attrs:{id:"g3w-view-content"}},[1<n.breadcrumb.length?r("section",{ref:n.breadcrumb,staticClass:"content_breadcrumb"},n._l(n.breadcrumb,function(e,t){return r("span",{key:e.title},[r("span",{directives:[{name:"t",rawName:"v-t",value:e.title,expression:"crumb.title"}],staticClass:"skin-color-dark",style:{fontWeight:n.isNotLastCrumb(t)?"bold":"normal"}}),n._v(" "),n.isNotLastCrumb(t)?r("span",{staticStyle:{"font-weight":"bold",margin:"3px 0"}},[n._v("/")]):n._e()])}),0):n._e(),n._v(" "),n.showtitle&&n.contentTitle||n.previousTitle||n.state.content.closable&&n.state.content.aside?r("div",{staticClass:"close-panel-block",staticStyle:{display:"flex","justify-content":"space-between"}},[n.previousTitle?r("div",{staticClass:"g3w_contents_back g3w-long-text"},["back"===n.backOrBackTo?r("div",{class:n.backOrBackTo},[r("span",{staticClass:"action-button",class:n.g3wtemplate.getFontClass("back")}),n._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"back",expression:"'back'"}]})]):r("div",{class:n.backOrBackTo,on:{click:function(e){return e.stopPropagation(),n.gotoPreviousContent()}}},[r("span",{staticClass:"action-button",class:n.g3wtemplate.getFontClass("back")}),n._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"backto",expression:"'backto'"}]}),n._v(" "),n.updatePreviousTitle?n._e():r("span",{directives:[{name:"t",rawName:"v-t",value:n.previousTitle,expression:"previousTitle"}]})])]):n._e(),n._v(" "),!n.previousTitle&&n.showtitle&&n.contentTitle?r("div",{staticClass:"panel-title",class:{mobile:n.isMobile()},style:[n.state.content.style.title]},[r("span",{attrs:{id:"contenttitle"}},[r("span",{directives:[{name:"t",rawName:"v-t",value:n.contentTitle.title,expression:"contentTitle.title"}]}),n._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:n.contentTitle.post_title,expression:"contentTitle.post_title"}]})])]):n._e(),n._v(" "),r("div",{staticClass:"g3-content-header-action-tools",staticStyle:{display:"flex","align-items":"center"}},[n._l(n.state.content.headertools,function(e){return r(e,{tag:"component"})}),n._v(" "),n.showresizeicon?r("resize-icon",{staticStyle:{"font-size":"1em",padding:"0","align-self":"center","margin-left":"auto"},style:{marginRight:n.state.content.closable?"5px":"0px"},attrs:{type:n.state.split}}):n._e(),n._v(" "),n.state.content.closable&&n.state.content.aside?r("span",{staticClass:"action-button",class:{mobile:n.isMobile()},staticStyle:{display:"flex","justify-content":"center"},on:{click:n.closeContent}},[r("i",{staticClass:"skin-color-dark",class:n.g3wtemplate.getFontClass("close")})]):n._e()],2)]):n._e(),n._v(" "),r("bar-loader",{attrs:{loading:n.state.content.loading}})],1)],1)},e.staticRenderFns=[],e._scopeId="data-v-466a54cc"},{"app/constant":5,"components/NotifyDownload.vue":206,"components/NotifyOnline.vue":207,"components/NotifyPlugins.vue":208,"components/UserMessage.vue":239,"services/gui":302,"services/viewport":309,"vueify/lib/insert-css":2}],241:[function(e,t,n){var i,r,a,o,s,l,c,d,u,p,f,h,g,v,m,y,_,b;e("vueify/lib/insert-css").insert(".g3w-add-wms-url-message[data-v-965f11b2]{font-weight:700;color:#000}.g3w-wmsurl-error[data-v-965f11b2]{background-color:red}.g3w-wmsurl-already-added[data-v-965f11b2]{color:inherit;font-weight:400;display:inline-block}.wms_url_input_content[data-v-965f11b2]{margin-bottom:5px}.wms-icon-action[data-v-965f11b2]{font-weight:700;font-size:1.3em;box-shadow:0 5px 10px #1e282c}.wms-icon-action[data-v-965f11b2]:hover{box-shadow:none}.new_wms_item[data-v-965f11b2]{display:flex;flex-direction:column;justify-content:space-between;background:transparent!important;margin-bottom:10px}");function w(e){return e&&e.__esModule?e:{default:e}}function x(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},r=e("app/constant"),a=w(e("core/g3w-panel")),o=w(e("store/projects")),s=w(e("services/application")),l=w(e("services/data")),c=w(e("services/gui")),d=e("utils/getUniqueDomId"),u=e("utils/isURL"),p=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/WMSLayersPanel.vue")),_=o.default.getCurrentProject().getId(),b=void 0,n.default={name:"wms",data:function(){return{state:{adminwmsurls:this.$options.wmsurls||[],localwmsurls:[]},url:null,id:null,loading:!1,status:{error:!1,added:!1}}},computed:{inputswmsurlvalid:function(){return null!==this.url&&this.url.trim()&&(0,u.isURL)(this.url)&&null!==this.id&&this.id.trim()}},methods:{addNewUrl:(y=x(function*(t){var e=this.state.localwmsurls.find(function(e){return e.url==t.url||e.id==t.id}),n={error:!1,added:!!e};if(!e)try{var r=yield this.getWMSLayers(t.url);if(!r.result)throw"invalid response";var i=this.getLocalWMSData();this.state.localwmsurls.push(t),i.urls=this.state.localwmsurls,this.updateLocalWMSData(i),r.wmsurl=t.url,this._showWmsLayersPanel(r)}catch(e){n.error=!0}return n}),function(e){return y.apply(this,arguments)}),addwmsurl:(m=x(function*(){this.loading=!0;var e=yield this.addNewUrl({url:this.url,id:this.id}),t=e.error,e=e.added;this.status.error=t,this.status.added=e,this.loading=!1}),function(){return m.apply(this,arguments)}),deleteWmsUrl:function(t){this.state.localwmsurls=this.state.localwmsurls.filter(function(e){return t!==e.id});var e=this.getLocalWMSData();e.urls=this.state.localwmsurls,this.updateLocalWMSData(e)},addWMSlayer:(v=x(function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.url,n=e.name,n=void 0===n?"wms_"+(0,d.getUniqueDomId)():n,r=e.layers,r=void 0===r?[]:r,i=e.epsg,a=e.position,o=e.visible,o=void 0===o||o,e=e.opacity,e=void 0===e?1:e;try{var s=this.getLocalWMSData();if(b){var l=s.wms[b.internalPanel.url];if(b.internalPanel.added=l&&l.some(function(t){return t.layers.length===b.internalPanel.selectedlayers.length?b.internalPanel.selectedlayers.every(function(e){return t.layers.includes(e)}):void 0}),b.internalPanel.added)return;b.internalPanel.loading=!0}var u={url:t,name:n,layers:r,epsg:i,position:a,visible:o,opacity:e};void 0===s.wms[t]?s.wms[t]=[u]:s.wms[t].push(u),this.updateLocalWMSData(s);try{yield c.default.getService("map").addExternalWMSLayer(u)}catch(e){c.default.getService("map").removeExternalLayer(n),this.deleteWms(n),setTimeout(function(){c.default.showUserMessage({type:"warning",message:"sidebar.wms.layer_add_error"})})}}catch(e){}b&&(b.internalPanel.clear(),b.close())}),function(){return v.apply(this,arguments)}),getWMSLayers:(g=x(function*(e){var t={result:!1,layers:[],info_formats:[],abstract:null,methods:[],map_formats:[],title:null};try{t=yield l.default.getData("ows:wmsCapabilities",{inputs:{url:e},outputs:!1})}catch(e){}return t}),function(e){return g.apply(this,arguments)}),_showWmsLayersPanel:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return(b=new a.default({service:this,id:(0,d.getUniqueDomId)(),title:"sidebar.wms.panel.title",internalPanel:new(Vue.extend(p))({service:this,config:e}),show:!0})).internalPanel.$on("add-wms-layer",this.addWMSlayer.bind(this)),b},showWmsLayersPanel:(h=x(function*(e){var t=!1;try{this.loading=!0;var n=yield this.getWMSLayers(e);(t=!n.result)||(n.wmsurl=e,this._showWmsLayersPanel(n))}catch(e){}finally{this.status.error=t,this.status.added=!1,this.loading=!1}}),function(e){return h.apply(this,arguments)}),deleteWms:function(n){var r=this.getLocalWMSData();Object.keys(r.wms).find(function(e){var t=r.wms[e].findIndex(function(e){return e.name==n});return-1!==t&&r.wms[e].splice(t,1),-1!==t&&0==r.wms[e].length&&delete r.wms[e],!0}),this.updateLocalWMSData(r)},clear:function(){b=null},changeLayerData:function(n){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=this.getLocalWMSData();Object.keys(i.wms).find(function(e){var t=i.wms[e].findIndex(function(e){return e.name==n});if(-1!==t)return i.wms[e][t][r.key]=r.value,!0}),this.updateLocalWMSData(i)},getLocalWMSData:function(){return(s.default.getLocalItem(r.LOCALSTORAGE_EXTERNALWMS_ITEM)||{})[_]},updateLocalWMSData:function(e){var t=s.default.getLocalItem(r.LOCALSTORAGE_EXTERNALWMS_ITEM)||{};t[_]=e,s.default.setLocalItem({id:r.LOCALSTORAGE_EXTERNALWMS_ITEM,data:t})}},mounted:(f=x(function*(){var t,n=this,r=(o.default.onafter("setCurrentProject",(t=x(function*(e){n.projectId=_=e.getId(),n.state.adminwmsurls=e.wmsurls||[]}),function(e){return t.apply(this,arguments)})),yield c.default.isReady(),c.default.getService("map")),e=(yield r.isReady(),this.deleteWms=this.deleteWms.bind(this),r.on("remove-external-layer",this.deleteWms),this.getLocalWMSData());void 0===e&&(e={urls:[],wms:{}},this.updateLocalWMSData(e)),setTimeout(function(){r.on("change-layer-position-map",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,e=e.position;return n.changeLayerData(t,{key:"position",value:e})}),r.on("change-layer-opacity",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,e=e.opacity;return n.changeLayerData(t,{key:"opacity",value:e})}),r.on("change-layer-visibility",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,e=e.visible;return n.changeLayerData(t,{key:"visible",value:e})}),Object.keys(e.wms).forEach(function(t){e.wms[t].forEach(function(e){return r.addExternalWMSLayer(i({url:t},e))})})}),this.state.localwmsurls=e.urls}),function(){return f.apply(this,arguments)}),beforeDestroy:function(){c.default.getService("map").off("remove-external-layer",this.deleteWms)}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var r=this,e=r.$createElement,i=r._self._c||e;return i("ul",{staticClass:"treeview-menu g3w-tools menu-items"},[r.loading?i("li",[i("bar-loader",{attrs:{loading:r.loading}})],1):r._e(),r._v(" "),i("li",{staticClass:"new_wms_item"},[i("div",{staticClass:"wms_url_input_content"},[i("label",{directives:[{name:"t",rawName:"v-t",value:"sidebar.wms.panel.label.name",expression:"'sidebar.wms.panel.label.name'"}],attrs:{for:"add_custom_name_url_wms_input"}}),r._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:r.id,expression:"id"}],staticClass:"form-control",staticStyle:{width:"100%",color:"#000000"},attrs:{id:"add_custom_name_url_wms_input"},domProps:{value:r.id},on:{input:function(e){e.target.composing||(r.id=e.target.value)}}})]),r._v(" "),i("div",{staticClass:"wms_url_input_content"},[i("label",{attrs:{for:"add_custom_url_wms_input"}},[r._v("URL")]),r._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:r.url,expression:"url"}],staticClass:"form-control",staticStyle:{width:"100%",color:"#000000"},attrs:{id:"add_custom_url_wms_input"},domProps:{value:r.url},on:{input:function(e){e.target.composing||(r.url=e.target.value)}}})]),r._v(" "),i("div",[i("button",{directives:[{name:"disabled",rawName:"v-disabled",value:!r.inputswmsurlvalid,expression:"!inputswmsurlvalid"}],staticClass:"btn btn-block skin-background-color",staticStyle:{width:"100%"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),r.addwmsurl(e)}}},[i("i",{class:r.g3wtemplate.getFontClass("plus-square")})])])]),r._v(" "),r.status.error?i("li",[i("div",{directives:[{name:"t",rawName:"v-t",value:"server_error",expression:"'server_error'"}],staticClass:"g3w-add-wms-url-message g3w-wmsurl-error"})]):r.status.added?i("li",[r._v("\n    \n    "),i("div",{directives:[{name:"t",rawName:"v-t",value:"sidebar.wms.url_already_added",expression:"'sidebar.wms.url_already_added'"}],staticClass:"g3w-add-wms-url-message g3w-wmsurl-already-added"})]):r._e(),r._v(" "),i("li",{staticClass:"skin-border-color",staticStyle:{background:"transparent !important","border-top":"2px solid"}},[i("div",{staticStyle:{"max-height":"200px","overflow-y":"auto"}},[r._l(r.state.adminwmsurls,function(e){var t=e.id;return i("div",{key:r.wmsurl,staticStyle:{display:"flex","justify-content":"space-between","align-items":"center","border-bottom":"1px solid #ccc","padding-bottom":"3px"}},[i("span",{staticClass:"g3w-long-text",staticStyle:{"flex-grow":"1","margin-right":"15px"}},[r._v(r._s(t)+"\n        ")]),r._v(" "),i("span",{staticClass:"skin-color",staticStyle:{padding:"5px"},on:{click:function(e){return e.stopPropagation(),r.showWmsLayersPanel(t)}}},[i("i",{class:r.g3wtemplate.getFontClass("plus-square"),staticStyle:{"font-weight":"bold","font-size":"1.3em"}})])])}),r._v(" "),r._l(r.state.localwmsurls,function(e){var t=e.id,n=e.url;return i("div",{key:t,staticStyle:{"border-bottom":"1px solid #cccccc","padding-bottom":"3px"}},[i("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center","padding-top":"3px"}},[i("span",{staticClass:"g3w-long-text",staticStyle:{"flex-grow":"1","margin-right":"15px","font-weight":"bold"}},[r._v(r._s(t))]),r._v(" "),i("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top.create",value:"sidebar.wms.add_wms_layer",expression:"'sidebar.wms.add_wms_layer'",arg:"top",modifiers:{create:!0}}],staticClass:"skin-color",staticStyle:{padding:"3px",margin:"2px"},on:{click:function(e){return e.stopPropagation(),r.showWmsLayersPanel(n)}}},[i("i",{staticClass:"wms-icon-action",class:r.g3wtemplate.getFontClass("plus-square")})]),r._v(" "),i("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top.create",value:"sidebar.wms.delete_wms_url",expression:"'sidebar.wms.delete_wms_url'",arg:"top",modifiers:{create:!0}}],staticStyle:{color:"red",padding:"3px",margin:"2px"},on:{click:function(e){return e.stopPropagation(),r.deleteWmsUrl(t)}}},[i("i",{staticClass:"wms-icon-action",class:r.g3wtemplate.getFontClass("trash"),staticStyle:{color:"red"}})])]),r._v(" "),i("div",{staticClass:"g3w-long-text",staticStyle:{"font-size":"0.7em"},attrs:{title:n}},[r._v(r._s(n))])])})],2)])])},e.staticRenderFns=[],e._scopeId="data-v-965f11b2"},{"app/constant":5,"components/WMSLayersPanel.vue":242,"core/g3w-panel":10,"services/application":298,"services/data":300,"services/gui":302,"store/projects":317,"utils/getUniqueDomId":397,"utils/isURL":415,"vueify/lib/insert-css":2}],242:[function(e,t,n){var r,i,o;e("vueify/lib/insert-css").insert(".g3w-wms-panel-title[data-v-64ebf92a]{font-size:1.2em;font-weight:700;margin-bottom:10px}button.wms-add-layer-button[data-v-64ebf92a]{width:100%;margin-top:10px}.g3w-wms-external-panel-layer-added-message[data-v-64ebf92a]{font-weight:700;color:red;margin:5px 0}");function a(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0}),o=e("g3w-ol/projection/projections"),n.default={name:"wmpspanel",data:function(){return{loading:!1,position:void 0,name:void 0,title:null,abstract:null,map_formats:[],info_formats:[],methods:[],layers:[],selectedlayers:[],projections:[],epsg:null,added:!1}},methods:{clear:function(){this.selectedlayers=[],this.name=null,this.loading=!1},getLayersByEpsg:function(t){var n=this;return null===t?this.$options.config.layers:this.layers.filter(function(e){e=e.name;return-1!==n.layerProjections[e].crss.indexOf(t)})},getProjectionsByName:function(t){var n=this;return this.projections.filter(function(e){return-1!==n.layerProjections[t].crss.indexOf(e)})}},watch:{selectedlayers:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];0===e.length?(this.epsg=null,this.projections=[]):1===e.length?(this.epsg=this.layerProjections[e[0]].crss[0],this.projections=this.layerProjections[e[0]].crss):this.projections=this.getProjectionsByName(e[e.length-1])},epsg:(i=a(function*(){yield this.$nextTick(),this.layers=this.getLayersByEpsg(this.epsg)}),function(){return i.apply(this,arguments)})},created:(r=a(function*(){var r=this,t=this.$options.config,e=t.layers,n=t.title,i=t.abstract,a=t.methods,t=t.wmsurl;try{this.url=a.GetMap.urls.find(function(e){return"Get"===e.type}).url}catch(e){this.url=t}this.title=n,this.abstract=i,this.layerProjections={},e.forEach(function(e){var t=e.name,n=e.crss,e=e.title;r.layerProjections[t]={title:e,crss:n.map(function(e){return o.get(e),"EPSG:"+e.epsg}).sort()}}),this.layers=e}),function(){return r.apply(this,arguments)}),beforeDestroy:function(){this.$data=null}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"disabled",rawName:"v-disabled",value:t.loading,expression:"loading"}]},[n("bar-loader",{attrs:{loading:t.loading}}),t._v(" "),n("h3",{staticClass:"skin-color g3w-wms-panel-title"},[t._v(t._s(t.title))]),t._v(" "),t.abstract?n("helpdiv",{attrs:{message:t.abstract}}):t._e(),t._v(" "),n("label",{directives:[{name:"t",rawName:"v-t",value:"sidebar.wms.panel.label.layers",expression:"'sidebar.wms.panel.label.layers'"}],attrs:{for:"g3w-wms-layers"}}),t._v(" "),n("select",{directives:[{name:"select2",rawName:"v-select2",value:"selectedlayers",expression:"'selectedlayers'"}],attrs:{id:"g3w-wms-layers",multiple:!0,clear:"true"}},t._l(t.layers,function(e){return n("option",{key:e.name,domProps:{value:e.name}},[t._v(t._s(e.title))])}),0),t._v(" "),n("label",{directives:[{name:"t",rawName:"v-t",value:"sidebar.wms.panel.label.projections",expression:"'sidebar.wms.panel.label.projections'"}],attrs:{for:"g3w-wms-projections"}}),t._v(" "),n("select",{directives:[{name:"select2",rawName:"v-select2",value:"epsg",expression:"'epsg'"}],attrs:{id:"g3w-wms-projections"}},t._l(t.projections,function(e){return n("option",{key:e,domProps:{value:e}},[t._v(t._s(e))])}),0),t._v(" "),n("label",{directives:[{name:"t",rawName:"v-t",value:"sidebar.wms.panel.label.name",expression:"'sidebar.wms.panel.label.name'"}],attrs:{for:"g3w-wms-layer-name"}}),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],staticClass:"form-control",attrs:{id:"g3w-wms-layer-name"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}}),t._v(" "),t.added?n("div",{directives:[{name:"t",rawName:"v-t",value:"sidebar.wms.layer_id_already_added",expression:"'sidebar.wms.layer_id_already_added'"}],staticClass:"g3w-wms-external-panel-layer-added-message"}):t._e(),t._v(" "),n("layerspositions",{attrs:{position:t.position},on:{"layer-position-change":function(e){t.position=e}}}),t._v(" "),n("button",{directives:[{name:"disabled",rawName:"v-disabled",value:0===t.selectedlayers.length,expression:"0 === selectedlayers.length"}],staticClass:"btn wms-add-layer-button sidebar-button skin-button",on:{click:function(e){e.stopPropagation(),t.$emit("add-wms-layer",{url:t.url,position:t.position,epsg:t.epsg,layers:t.selectedlayers,name:t.name&&t.name.trim()||void 0})}}},[n("i",{class:t.g3wtemplate.getFontClass("plus-square"),staticStyle:{"font-weight":"bold"}})])],1)},e.staticRenderFns=[],e._scopeId="data-v-64ebf92a"},{"g3w-ol/projection/projections":76,"vueify/lib/insert-css":2}],243:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};n.default=function(){var e,t,n,r,i,a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},o={highlightlayers:!1,external:{wms:[],vector:[]},layerstrees:f.default.getLayersStores().map(function(e){return{tree:e.getLayersTree(),storeid:e.getId()}}),layersgroups:[],legend:Object.assign(a.config.legend||{},{place:v.default.getCurrentProject().getLegendPosition()||"tab"})},s=a.service||new c.default({setters:{addExternalLayer:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,e=e.type,e=void 0===e?"vector":e;t.removable=!0,o.external[e].push(t)},removeExternalLayer:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=e.name,e=e.type,r=void 0===e?"vector":e;o.external[r].filter(function(e,t){if(e.name===n)return o.external[r].splice(t,1),!0})},setSelectedExternalLayer:function(e){var t=e.layer,n=e.type,r=e.selected;o.external[n].forEach(function(e){e.selected=void 0===e.selected?e.selected:e===t&&r})}}}),l=(s.state=o,s.createLayersGroup=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.title,e=e.layers;return{title:void 0===t?"Layers Group":t,nodes:(void 0===e?[]:e).map(function(e){return e})}},s.addLayersGroup=function(e){o.layersgroups.push(e)},s.getExternalLayers=function(e){e=e.type;return o.external[void 0===e?"vector":e]},s.getExternalSelectedLayers=function(e){e=e.type;return o.external[void 0===e?"vector":e].filter(function(e){return e.selected})},s.getExternalLayerById=function(e){var t=e.id,e=e.type;return o.external[void 0===e?"vector":e].find(function(e){return e.id===t})},s.isExternalLayerSelected=function(e){return!!(s.getExternalLayerById(e)||{}).selected},s.addLayersStoreToLayersTrees=function(e){return o.layerstrees.push({tree:e.getLayersTree(),storeid:e.getId()})},s.getMajorQgisVersion=function(){return h.default.getCurrentProject().getQgisVersion({type:"major"})},s.changeMapTheme=(e=function*(e){v.default.changeProjectView(!0);var t=o.layerstrees[0],e=(t.checked=!0,yield h.default.getCurrentProject().setLayersTreePropertiesFromMapTheme({map_theme:e,rootNode:t,layerstree:t.tree[0].nodes}));return v.default.changeProjectView(!1),e},t=function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})},function(e){return t.apply(this,arguments)}),f.default.onafter("addLayersStore",function(e){o.layerstrees.push({tree:e.getLayersTree(),storeid:e.getId()})}),f.default.onafter("removeLayersStore",function(t){var e=o.layerstrees.findIndex(function(e){return e.storeid===t.getId()});-1!==e&&o.layerstrees.splice(e,1)}),f.default.onafter("removeLayersStores",function(){o.layerstrees.forEach(function(e,t){o.layerstrees.splice(t,1)})}),new d.default(u({},a,{title:"catalog",resizable:!0,service:s,vueComponentObject:m})));return n=a.mapcomponentid,r=l,n&&(r.mapComponentId=n,a=g.default.getComponent(n),i=function(e){var t=e.getService();r.state.visible=!t.state.hidden,t.onafter("setHidden",function(){r.state.visible=!t.state.hidden,r.state.expanded=!0})},a?i(a):p.default.on("componentregistered",function(e){return n===e.getId()&&i(e)})),l};var c=r(e("core/g3w-object")),d=r(e("core/g3w-component")),p=r(e("store/components")),f=r(e("store/catalog-layers")),h=r(e("store/projects")),g=r(e("services/gui")),v=r(e("services/application")),m=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/Catalog.vue"));function r(e){return e&&e.__esModule?e:{default:e}}},{"components/Catalog.vue":134,"core/g3w-component":8,"core/g3w-object":9,"services/application":298,"services/gui":302,"store/catalog-layers":311,"store/components":312,"store/projects":317}],244:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},n=(n.default=function(){return new i.default(r({},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},{id:"changemapmenu",vueComponentObject:a}))},e("core/g3w-component")),i=(n=n)&&n.__esModule?n:{default:n},a=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/ChangeMapMenu.vue"))},{"components/ChangeMapMenu.vue":140,"core/g3w-component":8}],245:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},n=(n.default=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=new s.BarStack,i=new o.default(a({},e,{title:"contents",vueComponentObject:{name:"viewport-contents-viewer",template:'<div id="contents" class="contents"></div>',data:function(){return{state:null}}}}));return r.on("clear",function(){return i.contentsdata=r.state.contentsdata}),Object.assign(i,{stack:r,contentsdata:r.state.contentsdata,setContent:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=$.Deferred();return(e.push?(0,l.resolve)():r.clear()).then(function(){return i.addContent(e.content,e).then(function(){return t.resolve(e)})}),i.setOpen(!0),t.promise()},addContent:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=$.Deferred();return r.push(e,Object.assign(t,{parent:i.internalComponent.$el,append:!0})).then(function(){i.contentsdata=r.state.contentsdata,Array.from(i.internalComponent.$el.children).forEach(function(e,t,n){return e.style.display=t===n.length-1?"block":"none"}),n.resolve()}),n.promise()},removeContent:function(){return i.setOpen(!1),r.clear()},popContent:function(){return r.pop().then(function(){i.contentsdata=r.state.contentsdata,Array.from(i.internalComponent.$el.children).forEach(function(e,t,n){return e.style.display=t===n.length-1?"block":"none"})})},layout:function(n){var e=i.internalComponent.$el;Vue.nextTick(function(){var t=e.parentElement.clientHeight-((e.parentElement.querySelector(".close-panel-block")||{}).offsetHeight||0)-((e.parentElement.querySelector(".content_breadcrumb")||{}).offsetHeight||0)-10;e.style.height=t+"px",e.firstChild&&(e.firstChild.style.height=t+"px"),r.state.contentsdata.forEach(function(e){"function"==typeof e.content.layout&&e.content.layout(n+.5,t)})})},getComponentById:r.getComponentById.bind(r),getContentData:r.getContentData.bind(r),getCurrentContentData:r.getCurrentContentData.bind(r),getPreviousContentData:r.getPreviousContentData.bind(r),clearContents:r.clear.bind(r)}),i},e("core/g3w-component")),o=(n=n)&&n.__esModule?n:{default:n},s=e("core/g3w-barstack"),l=e("utils/resolve")},{"core/g3w-barstack":7,"core/g3w-component":8,"utils/resolve":433}],246:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e};function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);return void 0!==r?"value"in r?r.value:void 0!==(r=r.get)?r.call(n):void 0:null!==(r=Object.getPrototypeOf(e))?o(r,t,n):void 0}var s=d(e("core/g3w-component")),l=d(e("services/gui")),u=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/Form.vue")),c=d(e("components/FormBody.vue"));function d(e){return e&&e.__esModule?e:{default:e}}var p=e("gui/form/formservice"),e=function(e){var t=r;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);function r(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=this,n=r;if(t instanceof n)return t=function(e,t){if(e)return!t||"object"!=typeof t&&"function"!=typeof t?e:t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,i({},e,{id:e.id||"form",perc:null!==e.layer.getFormPercentage()?e.layer.getFormPercentage():e.perc,service:new(e.service||p),vueComponentObject:e.vueComponentObject||u}))),n=e.components||[{id:e.id,title:e.title,name:e.name,root:!0,component:c.default,headerComponent:e.headerComponent}],t.getService().addComponents(n),t.getService().setComponent(n[0].component),t.onafter("mount",function(){return l.default.setModal(!0)}),t;throw new TypeError("Cannot call a class as a function")}return t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e),a(r,[{key:"addFormComponents",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];this.getService().addComponents(e)}},{key:"addFormComponent",value:function(e){e&&this.getService().addComponent(e)}},{key:"layout",value:function(){this.getInternalComponent().reloadLayout()}},{key:"addBodyFormComponent",value:function(e){e&&this.getInternalComponent().body.components[e.where||"after"].push(e.component)}},{key:"addBodyFormComponents",value:function(t){var n=this;t&&(t.components||[]).forEach(function(e){return n.addBodyFormComponent({component:e,where:t.where||"after"})})}},{key:"addDependecyComponents",value:function(e){this.getService().addDependecyComponents(e)}},{key:"mount",value:function(e,t){return o(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"mount",this).call(this,e,t).then(function(){l.default.setModal(!0)})}}]),r}(s.default);n.default=e},{"components/Form.vue":150,"components/FormBody.vue":151,"core/g3w-component":8,"gui/form/formservice":82,"services/gui":302}],247:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},n=(n.default=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=new i.default(r({},e,{id:"map",title:"Map Component",service:new o(e),vueComponentObject:a}));return n.layout=function(e,t){n.getService().layout({width:e,height:t})},n},e("core/g3w-component")),i=(n=n)&&n.__esModule?n:{default:n},a=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/Map.vue"));var o=e("gui/map/mapservice").MapService},{"components/Map.vue":190,"core/g3w-component":8,"gui/map/mapservice":116}],248:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};n.default=function(e){var n={name:"",groups:{}},r=new o.default(i({},e,{title:"sdk.metadata.title",service:Object.assign(e.service||new s.default,{state:n,content:null,show:!1,reload:function(){0<arguments.length&&void 0!==arguments[0]&&!arguments[0]||r.getService().emit("reload");var i=l.default.getCurrentProject().getState();n.name=i.title,n.groups=Object.entries(f).reduce(function(e,t){var t=a(t,2),r=t[0],t=t[1];return e[r]=t.reduce(function(e,t){var n=(i.metadata&&i.metadata[t]?i.metadata:i)[t];return n&&(e[t]={value:n,label:"sdk.metadata.groups."+r+".fields."+t}),e},{}),e},{})}}),vueComponentObject:d}));return r.getService().reload(!1),r.getService().on("reload",function(){return r.setOpen(!1)}),r.onafter("setOpen",function(e){var t=r.getService();(t.show=e)?(t.content=new o.default({service:t,internalComponent:new(Vue.extend(p.default))({state:n})}),t.content.layout=c.noop,u.default.setContent({content:t.content,title:"sdk.metadata.title",perc:100}),t.show=!0):u.default.closeContent()}),u.default.on("closecontent",function(){return r.state.open=!1}),r};var o=r(e("core/g3w-component")),s=r(e("core/g3w-object")),l=r(e("store/projects")),u=r(e("services/gui")),c=e("utils/noop"),d=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/Metadata.vue")),p=r(e("components/MetadataProject.vue"));function r(e){return e&&e.__esModule?e:{default:e}}var f={general:["title","name","description","abstract","keywords","fees","accessconstraints","contactinformation","wms_url"],spatial:["crs","extent"],layers:["layers"]}},{"components/Metadata.vue":198,"components/MetadataProject.vue":200,"core/g3w-component":8,"core/g3w-object":9,"services/gui":302,"store/projects":317,"utils/noop":421}],249:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},n=(n.default=function(){var e=new i.default(r({},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},{title:"print",service:{},internalComponent:new(Vue.extend(a))})),t=e.getService(),n=e.getInternalComponent();return t.state=n.state,t.changeScale=n.changeScale,t.getOverviewExtent=n.getOverviewExtent,t.changeRotation=n.changeRotation,t.changeTemplate=n.changeTemplate,t.print=n.print,t.showPrintArea=n.showPrintArea,t.reload=n.reload,e.onafter("setOpen",function(e){return t.showPrintArea(e)}),e.onafter("reload",function(){t.reload(),e.state.visible=t.state.visible}),e},e("core/g3w-component")),i=(n=n)&&n.__esModule?n:{default:n},a=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/Print.vue"))},{"components/Print.vue":209,"core/g3w-component":8}],250:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};n.default=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return new i.default(r({},t,{id:"projectsmenu",title:t.title||"menu",internalComponent:new(Vue.extend(s))({host:t.host,state:{menuitems:(t.projects||a.default.getListableProjects()).map(function(e){return{title:e.title,description:e.description,thumbnail:e.thumbnail,gid:e.gid,cbk:t.cbk||function(){return o.default.changeProject({host:t.host,gid:(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).gid})}}})}})}))};var i=l(e("core/g3w-component")),a=l(e("store/projects")),o=l(e("services/application")),s=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/ProjectsMenu.vue"));function l(e){return e&&e.__esModule?e:{default:e}}},{"components/ProjectsMenu.vue":211,"core/g3w-component":8,"services/application":298,"store/projects":317}],251:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("core/g3w-panel"),i=(r=r)&&r.__esModule?r:{default:r},a=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/QueryBuilder.vue"));n.default={show:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).opts,e=void 0===e?{}:e;return new i.default(Object.assign(e,{title:"Query Builder",show:!0,internalPanel:new(Vue.extend(a))(e)})).getInternalPanel()}}},{"components/QueryBuilder.vue":212,"core/g3w-panel":10}],252:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},n=(n.default=function(){var e,t=new i.default(r({},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},{id:"queryresults",title:"Query Results",service:new s,vueComponentObject:o}));return t.getElement=function(){return t.internalComponent?t.internalComponent.$el:void 0},t.unmount=function(){return t.getService().closeComponent(),i.default.prototype.unmount.call(t)},t.layout=a.noop,t.getService().onafter("setLayersData",(e=function*(){t.internalComponent||t.setInternalComponent(),yield t.internalComponent.$nextTick()},function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})})),t},e("core/g3w-component")),i=(n=n)&&n.__esModule?n:{default:n},a=e("utils/noop"),o=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/QueryResults.vue"));var s=e("gui/queryresults/queryresultsservice")},{"components/QueryResults.vue":213,"core/g3w-component":8,"gui/queryresults/queryresultsservice":123,"utils/noop":421}],253:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},n=(n.default=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return new i.default(r({},e,{internalComponent:new(Vue.extend(a))(e)}))},e("core/g3w-component")),i=(n=n)&&n.__esModule?n:{default:n},a=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/RelationsPage.vue"))},{"components/RelationsPage.vue":225,"core/g3w-component":8}],254:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var l=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},r=(n.SearchComponent=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=p.default.getCurrentProject(),n={searches:(t.state.search||[]).sort(function(e,t){return(""+e.name).localeCompare(t.name)}),tools:[],querybuildersearches:L()},s=e.service||new i.default,r=new a.default(u({},e,{id:"search",visible:!0,title:t.state.search_title||"search",service:Object.assign(s,{state:n,title:t.state.search_title||"search",addQueryBuilderSearch:function(e){n.querybuildersearches.push(e)},addTool:function(e){n.tools.push(e)},addTools:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;s.addTool(o)}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}},showPanel:function(e){return new C(e,!0)},removeItem:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.type,e=e.index;"querybuilder"===t&&n.querybuildersearches.splice(e,1)},getTitle:function(){return s.title},cleanSearchPanels:function(){n.panels={}},removeTools:function(){n.tools.splice(0)},stop:h.resolve,removeTool:g.noop,reload:function(){n.searches=p.default.getCurrentProject().state.search,n.querybuildersearches=L()}}),vueComponentObject:w}));return r._reload=function(){r._service.reload()},r},n.SearchPanel=C,e("app/constant")),i=S(e("core/g3w-object")),a=S(e("core/g3w-component")),c=S(e("core/g3w-panel")),d=S(e("store/catalog-layers")),o=S(e("store/application-state")),p=S(e("store/projects")),f=S(e("services/gui")),h=e("utils/resolve"),g=e("utils/noop"),v=e("utils/getUniqueDomId"),m=e("utils/createFilterFormInputs"),y=e("utils/createInputsFormFromFilter"),_=e("utils/doSearch"),b=e("utils/debounce"),w=s(e("components/Search.vue")),x=s(e("components/SearchPanel.vue"));function s(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function S(e){return e&&e.__esModule?e:{default:e}}function L(){var e=o.default.querybuilder.searches,t=p.default.getCurrentProject().getId();return e[t]=e[t]||[],e[t]}function C(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],o={loading:{},searching:!1,title:n.name,type:n.type||"search",queryurl:(n.options||{}).queryurl,search_endpoint:"api",search_1n_relationid:n.options.search_1n_relationid,search_layers:[(n.options||{}).querylayerid||(n.options||{}).layerid||null].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}((n.options||{}).otherquerylayerids||[])).map(function(e){return d.default.getLayerById(e)}),forminputs:((n.options||{}).filter||[]).map(function(e,t){return{id:e.id||(0,v.getUniqueDomId)(),type:e.input.type||"textfield",widget_type:e.input.widget_type,label:e.label,attribute:e.attribute,values:e.input.options.values||[],dvalues:{},dependance_strict:e.input.options.dependance_strict||!1,dependance:e.input.options.dependance||!1,value:"selectfield"===e.input.type?r.SEARCH_ALLVALUE:null,operator:e.op,logicop:t===n.options.filter.length-1?null:e.logicop,loading:!0,disabled:e.input.options.disabled||!1,options:e.input.options}})},t=(o.mounted=(0,y.createInputsFormFromFilter)(o),n.service||Object.assign(new i.default,{state:o,doSearch:_.doSearch,run:(0,b.debounce)(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=f.default.getService("map").getMap().getSize(),r=l(r,2),i=r[0],r=r[1],a=f.default.isMobile()&&(0===i||0===r);setTimeout(function(){a&&f.default.hideSidebar(),s.getService().doSearch(u({},t,{state:o}))},a?0:600)}),clear:function(){s.getService().state=null},createFilter:function(){return(0,m.createFilterFormInputs)({layer:o.search_layers,inputs:o.forminputs.filter(function(e){return-1===[null,void 0,r.SEARCH_ALLVALUE].indexOf(e.value)&&""!==e.value.toString().trim()})})}})),s=new c.default(u({},n,{show:e,id:n.id||(0,v.getUniqueDomId)(),title:n.title||"search",vueComponentObject:n.component||x,service:t}));return s}},{"app/constant":5,"components/Search.vue":226,"components/SearchPanel.vue":227,"core/g3w-component":8,"core/g3w-object":9,"core/g3w-panel":10,"services/gui":302,"store/application-state":310,"store/catalog-layers":311,"store/projects":317,"utils/createFilterFormInputs":344,"utils/createInputsFormFromFilter":346,"utils/debounce":360,"utils/doSearch":363,"utils/getUniqueDomId":397,"utils/noop":421,"utils/resolve":433}],255:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};n.default=function(){var e=new i.default(r({},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},{title:"sdk.spatialbookmarks.title",vueComponentObject:o}));return a.default.on("closecontent",function(){e.state.open=!1}),e};var i=s(e("core/g3w-component")),a=s(e("services/gui")),o=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/SpatialBookMarks.vue"));function s(e){return e&&e.__esModule?e:{default:e}}},{"components/SpatialBookMarks.vue":233,"core/g3w-component":8,"services/gui":302}],256:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};n.default=function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=c.default.getCurrentProject(),i=s({},t,{toolsGroups:[],visible:!1,loading:!1}),r=new u.default({setters:{addTool:function(e,t){var n=t.title,t=t.position,r=i.toolsGroups.find(function(e){return e.name===n});return r||i.toolsGroups.splice(t,0,r={name:n,tools:[]}),r.tools.push(Object.assign(e,{state:e.state||{type:null,message:null},action:e.action||(h[e.type]||p.default).bind(null,e.options)}))},addToolGroup:function(e,t){var n=i.toolsGroups.find(function(e){return e.name===t});return n||i.toolsGroups.splice(e,0,n={name:t,tools:[]}),n},addTools:function(e,t){var n=this;e.forEach(function(e){return n.addTool(e,t)})},removeToolGroup:function(t){i.toolsGroups=i.toolsGroups.filter(function(e){return e.name!==t})},removeTools:function(){i.toolsGroups.splice(0)}}}),a=(r.state=i,r.config=null,r.getState=function(){return i},r.reload=function(){r.removeTools()},r.setLoading=function(){i.loading=0<arguments.length&&void 0!==arguments[0]&&arguments[0]},r.updateToolsGroup=function(e,t){Vue.set(i.toolsGroups,e,t)},r.setToolState=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,e=e.state,n=void 0===e?{type:null,message:null}:e;i.toolsGroups.find(function(e){e=e.tools.find(function(e){return e.name===t});if(e)return e.state.type=n.type,e.state.message=n.message,!0})},r.ACTIONS=h,n.getState().tools||{});for(e in a)!function(t){r.addToolGroup(0,t.toUpperCase()),r.addTools(a[t].map(function(e){return{name:e.name,action:h[t].bind(null,e)}}),{position:0,title:t.toUpperCase()})}(e);var o=new l.default(s({},t,{title:"tools",service:r,internalComponent:new(Vue.extend({template:'\n        <ul class="g3w-tools treeview-menu">\n          <bar-loader :loading="state.loading"/>\n          <li v-for="g in state.toolsGroups" :key="g.name">\n            <div class="tool-header"><i :class="g3wtemplate.getFontClass(\'tool\')"></i><span>{{ g.name }}</span></div>\n            <div :id="g.name + \'-tools\'" class="tool-box"><g3w-tool v-for="t in g.tools" :key="t.name" :tool="t" /></div>\n          </li>\n        </ul>',components:{G3wTool:f.default},data:function(){return{state:null}},watch:{"state.toolsGroups":function(e){o.setVisible(0<e.length),this.$emit("visible",0<e.length)}}}))}));return o._setOpen=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];(o.internalComponent.state.open=e)&&d.default.closeContent()},o};var l=r(e("core/g3w-component")),u=r(e("core/g3w-object")),c=r(e("store/projects")),d=r(e("services/gui")),p=r(e("utils/noop")),f=r(e("components/Tool.vue"));function r(e){return e&&e.__esModule?e:{default:e}}var h={}},{"components/Tool.vue":238,"core/g3w-component":8,"core/g3w-object":9,"services/gui":302,"store/projects":317,"utils/noop":421}],257:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};n.default=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=new i.default(r({},e,{title:"WMS",service:{},internalComponent:new(Vue.extend(o))({wmsurls:e.wmsurls})})),t=e.getService(),n=e.getInternalComponent();return e._setOpen=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];(n.state.open=e)&&a.default.closeContent()},t.state=n.state,t.addNewUrl=n.addNewUrl,t.deleteWmsUrl=n.deleteWmsUrl,t.showWmsLayersPanel=n._showWmsLayersPanel,t.addWMSlayer=n.addWMSlayer,t.getWMSLayers=n.getWMSLayers,t.deleteWms=n.deleteWms,t.clear=n.clear,t.changeLayerData=n.changeLayerData,t.getLocalWMSData=n.getLocalWMSData,t.updateLocalWMSData=n.updateLocalWMSData,e};var i=s(e("core/g3w-component")),a=s(e("services/gui")),o=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("components/WMS.vue"));function s(e){return e&&e.__esModule?e:{default:e}}},{"components/WMS.vue":241,"core/g3w-component":8,"services/gui":302}],258:[function(e,t,n){var r=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e("vue-color"));var i=window.initConfig;if(i.baseurl)try{new URL(i.baseurl)}catch(e){i.baseurl=new URL(i.baseurl,window.location).toString()}i.group=Object.assign(i.group||{},new Proxy(Object.fromEntries(Object.keys(i).filter(function(e){return!["i18n","staticurl","client","mediaurl","user","baseurl","vectorurl","proxyurl","rasterurl","interfaceowsurl","main_map_title","main_map_title","g3wsuite_logo_img","credits","version","group","frontendurl"].includes(e)}).map(function(e){return[e,i[e]]})),{get:function(e,t,n){return Reflect.get.apply(Reflect,arguments)}})),window.VueColor=r,window.VueCookie=e("vue-cookie")},{"vue-color":"vue-color","vue-cookie":"vue-cookie"}],259:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i=e("utils").uniqueId,a=new Vue,o={};n.watch=function(e){var t=e.el,n=e.attr,e=e.watcher,r=i(),t=(t.setAttribute(n,r),o[r]={});return e&&(t.unwatch=a.$watch(e[0],e[1],e[2]||{immediate:!0}),t.handler=e[1]),r},n.unwatch=function(e){var t=e.el,e=e.attr,t=t.getAttribute(e);t&&(o[t].unwatch(),delete o[t])},n.trigger=function(e){var t=e.el,n=e.attr,e=e.data;return o[t.getAttribute(n)].handler(e)}},{utils:404}],260:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){t.value?e.setAttribute("checked","checked"):e.removeAttribute("checked")}},{}],261:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default={bind:function(t,n,r){this.event=function(e){t===e.target||t.contains(e.target)||(e.stopPropagation(),r.context[n.expression](e))},document.body.addEventListener("click",this.event,!0)},unbind:function(){document.body.removeEventListener("click",this.event,!0)}}},{}],262:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){var n="g3w-disabled";t.value?e.classList.contains(n)||e.classList.add(n):e.classList.remove(n)}},{}],263:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("store/application-state"),i=(r=r)&&r.__esModule?r:{default:r},a=e("directives/utils");var o="g3w-v-download-id";n.default={bind:function(n,r){"boolean"==typeof r.value&&!r.value||(0,a.watch)({el:n,attr:o,watcher:[function(){return i.default.download},function(e){var t=r.modifiers&&r.modifiers.show?"hide":"disabled";n.classList.toggle("g3w-"+t,"hide"==t?!e:e)}]})},unbind:function(e){return(0,a.unwatch)({el:e,attr:o})}}},{"directives/utils":259,"store/application-state":310}],264:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("store/application-state"),i=(r=r)&&r.__esModule?r:{default:r},a=e("directives/utils");var o="g3w-v-offline-id";n.default={bind:function(t,n){(0,a.watch)({el:t,attr:o,watcher:[function(){return i.default.online},function(e){e=n.arg&&"hide"===n.arg?!e:e,t.classList.toggle("g3w-hide",!e)}]})},unbind:function(e){return(0,a.unwatch)({el:e,attr:o})}}},{"directives/utils":259,"store/application-state":310}],265:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("store/application-state"),i=(r=r)&&r.__esModule?r:{default:r},a=e("directives/utils");var o="g3w-v-plugins-id";n.default={bind:function(t){(0,a.watch)({el:t,attr:o,watcher:[function(){return i.default.plugins},function(e){t.classList.toggle("g3w-hide",0===e.length)}]})},unbind:function(e){return(0,a.unwatch)({el:e,attr:o})}}},{"directives/utils":259,"store/application-state":310}],266:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default={inserted:function(o,s,l){var e=l.data.attrs||{},t=e.templateResult,n=e.templateSelection,r=e.multiple,u=void 0!==r&&r,r=e.search,r=void 0===r||r,i=e.select2_value,c=e.indexItem,e=e.createTag,e=void 0!==e&&e,d=s.value&&Array.isArray(l.context[s.value])&&void 0!==c;$(o).select2({tags:e,width:"100%",dropdownCssClass:"skin-color",templateResult:t,templateSelection:n,minimumResultsForSearch:r?void 0:-1,createTag:function(e){e=e.term.trim();return e?{id:e,text:e,newTag:!0}:null}}).on("select2:select select2:unselect",function(e){var t,n,r,i,a;s.value&&(t=s.value,n="select2:select"===e.type,r=e.params.data.id,e=l.context,n&&(i=d?e[t][c].value:e[t],u&&i.every(function(e){return r!==e})?i.push(r):d?e[t][c].value=r:(a=(i=(""+t).split(".")).pop(),i.reduce(function(e,t){return e=e[t]},l.context)[a]=r)),!n&&u&&(d?e[t][c].value=e[t][c].value.filter(function(e){return r!==e}):e[t]=e[t].filter(function(e){return r!==e})),n||u)&&o.dispatchEvent(new Event("change"))}),s.value&&void 0!==i&&($(o).val(i).trigger("change"),l.g3w_observer=new MutationObserver(function(e){e=(e.find(function(e){return"select2_value"===e.attributeName})||{}).target;e&&$(o).val(e.getAttribute("select2_value")).trigger("change")}),l.g3w_observer.observe(o,{attributes:!0}))},unbind:function(e,t){t.g3w_observer&&t.g3w_observer.disconnect(),$(e).select2("destroy")}}},{}],267:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){e.toggleAttribute("selected",0===t.value)}},{}],268:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("store/application-state"),i=(r=r)&&r.__esModule?r:{default:r},a=e("directives/utils");var o=e("core/i18n/i18n.service").t,s="g3w-v-t-html-id";n.default={bind:function(e,t){(0,a.watch)({el:e,attr:s,watcher:[function(){return i.default.language},function(){e.innerHTML=""+o(t.value)}]})},unbind:function(e){return(0,a.unwatch)({el:e,attr:s})}}},{"core/i18n/i18n.service":12,"directives/utils":259,"store/application-state":310}],269:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("store/application-state"),i=(r=r)&&r.__esModule?r:{default:r},a=e("directives/utils");var r=e("core/i18n/i18n.service"),o=r.t,s=r.tPlugin,l="g3w-v-t-placeholder-id";n.default={bind:function(e,t){(0,a.watch)({el:e,attr:l,watcher:[function(){return i.default.language},function(){e.setAttribute("placeholder",("plugin"===t.arg?s:o)(t.value))}]})},unbind:function(e){return(0,a.unwatch)({el:e,attr:l})}}},{"core/i18n/i18n.service":12,"directives/utils":259,"store/application-state":310}],270:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("store/application-state"),i=(r=r)&&r.__esModule?r:{default:r},a=e("directives/utils");var o=e("core/i18n/i18n.service").tPlugin,s="g3w-v-t-plugin-id";n.default={bind:function(t,n){var r=t.innerHTML;(0,a.watch)({el:t,attr:s,watcher:[function(){return i.default.language},function(){var e=null!==n.value?o(n.value):"";switch(n.arg||"post"){case"pre":t.innerHTML=e+" "+r;break;case"post":t.innerHTML=r+" "+e}}]})},unbind:function(e){return(0,a.unwatch)({el:e,attr:s})}}},{"core/i18n/i18n.service":12,"directives/utils":259,"store/application-state":310}],271:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("store/application-state"),i=(r=r)&&r.__esModule?r:{default:r},a=e("directives/utils");var r=e("core/i18n/i18n.service"),o=r.t,s=r.tPlugin,l="g3w-v-t-title-id";n.default={bind:function(t,n){(0,a.watch)({el:t,attr:l,watcher:[function(){return i.default.language},function(){var e=("plugin"===n.arg?s:o)(n.value);t.setAttribute("title",e),t.setAttribute("data-original-title",e)}]})},unbind:function(e){return(0,a.unwatch)({el:e,attr:l})}}},{"core/i18n/i18n.service":12,"directives/utils":259,"store/application-state":310}],272:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("store/application-state"),i=(r=r)&&r.__esModule?r:{default:r},a=e("directives/utils");var r=e("core/i18n/i18n.service"),o=r.t,s=r.tPlugin,l="g3w-v-t-tooltip-id";n.default={bind:function(n,r){r.modifiers.create&&(r.arg&&(n.setAttribute("data-placement",r.arg),n.classList.add("skin-color","skin-tooltip-"+r.arg)),n.setAttribute("data-container","body"),$(n).tooltip({trigger:i.default.ismobile?"click":"hover",html:!0}).on("shown.bs.tooltip",function(){i.default.ismobile&&setTimeout(function(){return $(n).tooltip("hide")},600)})),(0,a.watch)({el:n,attr:l,watcher:[function(){return i.default.language},function(e){var e=e.el,e=void 0===e?n:e,t=e.getAttribute("current-tooltip");null===t&&(t=r.value),e.setAttribute("data-original-title",r.modifiers.text?t:("plugin"===r.arg?s:o)(t))}]})},componentUpdated:function(e,t){var n=e.getAttribute("current-tooltip");null!=n&&n!==t.oldValue&&(0,a.trigger)({el:e,attr:l,data:{el:e}})},unbind:function(e){$(e).tooltip("hide"),(0,a.unwatch)({el:e,attr:l})}}},{"core/i18n/i18n.service":12,"directives/utils":259,"store/application-state":310}],273:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("store/application-state"),i=(r=r)&&r.__esModule?r:{default:r},a=e("directives/utils");function o(e){var t=e.el,n=null!==t.__currentBinding.value?s(t.__currentBinding.value):"";switch(t.__currentBinding.arg||"post"){case"pre":t.innerHTML=n+" "+t.__innerHTML;break;case"post":t.innerHTML=t.__innerHTML+" "+n}}var s=e("core/i18n/i18n.service").t,l="g3w-v-t-id";n.default={bind:function(e,t){e.__innerHTML=e.innerHTML,e.__currentBinding=t,(0,a.watch)({el:e,attr:l,watcher:[function(){return i.default.language},function(){return o({el:e})}]})},componentUpdated:function(e,t){e.__currentBinding=t,o({el:e})},unbind:function(e){return(0,a.unwatch)({el:e,attr:l})}}},{"core/i18n/i18n.service":12,"directives/utils":259,"store/application-state":310}],274:[function(e,t,n){window.g3wsdk=e("app/api")},{"app/api":3}],275:[function(h,N,G){var g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")};h("./deprecated"),h("./globals");var r=M(h("store/application-state")),v=M(h("store/projects")),t=M(h("services/application")),m=M(h("services/gui")),a=M(h("services/floatbar")),o=M(h("services/navbaritems")),s=M(h("services/sidebar")),l=M(h("services/viewport")),u=M(h("store/components")),n=M(h("components/App.vue")),e=M(h("components/GlobalImage.vue")),c=M(h("components/GlobalGallery.vue")),d=M(h("components/GlobalGeo.vue")),p=M(h("components/GlobalSkeleton.vue")),f=M(h("components/GlobalBarLoader.vue")),y=M(h("components/GlobalProgressBar.vue")),b=M(h("components/GlobalHelpDiv.vue")),w=M(h("components/GlobalResize.vue")),x=M(h("components/GlobalLayerPositions.vue")),S=M(h("components/GlobalDateTime.vue")),L=M(h("components/GlobalRange.vue")),C=M(h("components/GlobalResizeIcon.vue")),E=M(h("components/GlobalTabs.vue")),T=M(h("components/GlobalDivider.vue")),k=M(h("components/Floatbar.vue")),D=M(h("components/NavbaritemsLeft.vue")),B=M(h("components/NavbaritemsRight.vue")),V=M(h("components/Sidebar.vue")),U=M(h("components/Viewport.vue")),z=M(h("directives/v-disabled")),q=M(h("directives/v-checked")),Y=M(h("directives/v-selected-first")),W=M(h("directives/v-select2")),H=M(h("directives/v-t-tooltip")),Q=M(h("directives/v-t-html")),Z=M(h("directives/v-t-placeholder")),K=M(h("directives/v-t-title")),X=M(h("directives/v-t")),J=M(h("directives/v-t-plugin")),ee=M(h("directives/v-plugins")),te=M(h("directives/v-online")),ne=M(h("directives/v-download")),re=M(h("directives/v-click-outside")),ie=h("app/constant");function M(e){return e&&e.__esModule?e:{default:e}}function P(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}function O(e){var p=e.ApplicationService,f=p.getConfig().layout||{};this._isMobile=isMobile.any,this._isIframe=f.iframe,this.sizes={sidebar:{width:0}},this.waitingoutputdataplace=null,this.init=function(){this._createApp()},this._createTemplateConfig=function(){var e=p.getConfig().apptitle||"G3W Suite",t=h("gui/viewport/contentsviewer"),n=h("gui/catalog/vue/catalog"),r=h("gui/search/vue/search"),i=h("gui/querybuilder/querybuilderuifactory"),a=h("gui/print/vue/print"),o=h("gui/metadata/vue/metadata"),s=h("gui/tools/vue/tools"),l=h("gui/wms/vue/wms"),u=h("gui/map/vue/map"),c=h("gui/queryresults/vue/queryresults"),d=h("gui/spatialbookmarks/vue/spatialbookmarks");return{title:e,placeholders:{navbar:{components:[]},sidebar:{components:[new o({id:"metadata",open:!1,collapsible:!1,icon:m.default.getFontClass("file"),mobile:!0}),new d({id:"spatialbookmarks",open:!1,collapsible:!0,icon:m.default.getFontClass("bookmark"),mobile:!0}),new a({id:"print",open:!1,visible:0<(v.default.getCurrentProject().getPrint()||[]).length,collapsible:!0,icon:m.default.getFontClass("print"),mobile:!1}),new r({id:"search",open:!1,collapsible:!0,icon:m.default.getFontClass("search"),actions:[{id:"querybuilder",class:m.default.getFontClass("calculator")+" sidebar-button sidebar-button-icon",tooltip:"Query Builder",fnc:function(){m.default.closeContent(),O.Services.sidebar.closeOpenComponents(),i.show({type:"sidebar"})},style:{color:"#8DC3E3",padding:"6px",fontSize:"1.2em",borderRadius:"3px",marginRight:"5px"}}],mobile:!0}),new s({id:"tools",open:!1,collapsible:!0,icon:m.default.getFontClass("tools"),mobile:!0}),new l({id:"wms",open:!1,collapsible:!0,icon:m.default.getFontClass("layers"),mobile:!0}),new n({id:"catalog",open:!1,collapsible:!1,isolate:!0,icon:m.default.getFontClass("map"),mobile:!0,config:{legend:{config:f.legend}}})]},floatbar:{components:[]}},othercomponents:[new c({id:"queryresults"})],viewport:{components:{map:new u({id:"map"}),content:new t({id:"contents"})}}}},this._createApp=function(){this._setDataTableLanguage();var e,t=this;return(isMobile.any||this._isIframe)&&$("body").addClass("sidebar-collapse"),new Vue({el:"#app",created:function(){t._setupInterface(),t._setupLayout(),t._setUpServices(),t.templateConfig=t._createTemplateConfig(),this.$watch(function(){return r.default.language},function(){return t._setDataTableLanguage()})},mounted:(e=P(function*(){yield this.$nextTick(),t._buildTemplate(),$(document).localize(),t._setViewport(t.templateConfig.viewport);var e=$(".navbar").css("background-color");m.default.skinColor=e&&"#"+e.substr(4,e.indexOf(")")-4).split(",").map(function(e){return parseInt(e).toString(16)}).join(""),yield this.$nextTick(),t.emit("ready"),t.sizes.sidebar.width=$("#g3w-sidebar").width(),m.default.ready()}),function(){return e.apply(this,arguments)})})},this._setupLayout=function(){isMobile.any||$("<style type='text/css'> .ol-control-tl {top: 7px;left:43px;}</style>").appendTo("head"),Vue.component("sidebar",V.default),Vue.component("navbarleftitems",D.default),Vue.component("navbarrightitems",B.default),Vue.component("viewport",U.default),Vue.component("floatbar",k.default),Vue.component("app",n.default)},this._setDataTableLanguage=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t={language:{sSearch:"",searchPlaceholder:j("dosearch"),sLengthMenu:j("dataTable.lengthMenu"),paginate:{previous:j("dataTable.previous"),next:j("dataTable.next")},info:j("dataTable.info"),zeroRecords:j("dataTable.nodatafilterd"),infoFiltered:""}};$.extend($.fn.dataTableExt.oStdClasses,{sFilterInput:"form-control search"}),e?e.dataTable({oLanguage:t}):$.extend(!0,$.fn.dataTable.defaults,t)},this._addRoutes=function(){p.getRouterService().addRoute("map/zoomto/{coordinate}/:zoom:",function(e,t){e=_.map(e.split(","),function(e){return Number(e)}),t=t?Number(t):null,e.length&&m.default.getService("map").on("ready",function(){this.zoomTo(e,t)})})},this._setUpServices=function(){Object.keys(O.Services).forEach(function(e){return p.registerService(e,O.Services[e])}),Object.values(m.default.getComponents()).forEach(function(e){return p.registerService(e.id,e.getService())}),O.Services.viewport.on("resize",function(){return m.default.emit("resize")})},this._buildTemplate=function(){var n=this;a.default.init(R),Object.entries(this.templateConfig.placeholders).forEach(function(e){var e=i(e,2),t=e[0],e=e[1];return n._addComponents(e.components,t)}),this._addOtherComponents()},this._addOtherComponents=function(){this.templateConfig.othercomponents&&this._addComponents(this.templateConfig.othercomponents)},this._setViewport=function(e){e&&(O.Services.viewport.init(e),this._addComponents(e.components))},this._addComponent=function(e,t){return this._addComponents([e],t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}),!0},this._addComponents=function(e,t,n){var r=!0;t&&-1<O.PLACEHOLDERS.indexOf(t)&&(t=O.Services[t])&&(r=t.addComponents(e,n)),Object.entries(e).forEach(function(e){e=i(e,2),e[0],e=e[1];r&&(u.default.registerComponent(e),p.registerService(e.id,e.getService()))})},this._removeComponent=function(e,t,n){t&&O.Services[t]&&O.Services[t].removeComponent(u.default.unregisterComponent(e),n)},this._showModalOverlay=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=arguments[1],n=m.default.getService("map");e?n.startDrawGreyCover(t):n.stopDrawGreyCover()},this._isSidebarVisible=function(){return!$("body").hasClass("sidebar-collapse")},this._showSidebar=function(){$("body").addClass("sidebar-open"),$("body").removeClass("sidebar-collapse")},this._hideSidebar=function(){$("body").removeClass("sidebar-open"),$("body").addClass("sidebar-collapse")},m.default.errorToMessage=function(e){var t,n,r,i="server_error";switch(I(e)){case"Error":i="CLIENT - "+e.message;break;case"Object":e.responseJSON?!1===(e=e.responseJSON).result&&(t=(r=e.error).code,n=void 0===(n=r.data)?"":n,r=void 0===(r=r.message)?"":r,i=(void 0===t?"":t).toUpperCase()+" "+n+" "+r):e.responseText&&(i=e.responseText);break;case"Array":i=e.map(function(e){return m.default.errorToMessage(e)}).join(" ");break;default:i=e}return i},this._setupInterface=function(){var t,n=this;m.default.layout=R,m.default.getSize=function(e){var t=e.element,e=e.what;if(t&&e)return n.sizes[t][e]},m.default.addComponent=this._addComponent.bind(this),m.default.removeComponent=this._removeComponent.bind(this),m.default.getResourcesUrl=function(){return p.getConfig().resourcesurl},m.default.showList=a.default.showPanel.bind(a.default),m.default.closeList=a.default.closePanel.bind(a.default),m.default.hideList=a.default.hidePanel.bind(a.default),m.default.showTable=function(){},m.default.closeTable=function(){},m.default.outputDataPlace=(t=P(function*(t){var e,n,r=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a={condition:!0,add:!1,loading:!0},o=i.title,s=void 0===o?"":o,o=i.show,o=void 0===o?a:o,l=i.before,u=i.after,i="Object"!==I(o)?{condition:o,add:!1,loading:!0}:g({},a,o),c=i.condition,d=i.add,a=i.loading,p=(this.waitingoutputdataplace&&(yield this.waitingoutputdataplace.stop()),d?m.default.getService("queryresults"):a&&this.showContentFactory("query")(s));this.waitingoutputdataplace=(n=!1,P(function*(){try{var e=yield t;l&&(yield l(e)),e.usermessage&&m.default.showUserMessage({type:e.usermessage.type,message:e.usermessage.message,autoclose:e.usermessage.autoclose}),n||(("Function"===I(c)?c(e):"Boolean"!==I(c)||c)?(p||r.showContentFactory("query")(s)).setQueryResponse(e,{add:d}):m.default.closeContent(),u&&u(e))}catch(e){r.showUserMessage({type:"alert",message:r.errorToMessage(e),textMessage:!0}),r.closeContent()}finally{n||(r.waitingoutputdataplace=null)}})(),{stop:(e=P(function*(){return n=!0}),function(){return e.apply(this,arguments)})})}),function(e){return t.apply(this,arguments)}),m.default.showContentFactory=function(e){var t=void 0;switch(e){case"query":t=m.default.showQueryResults;break;case"form":t=m.default.showForm}return t},m.default.showForm=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.perc,n=e.split,n=void 0===n?"h":n,r=e.push,i=e.showgoback,a=e.crumb,o=h("gui/form/vue/form"),o=new(e.formComponent||o)(e),e=o.getService();return m.default.setContent({perc:t,content:o,split:n,crumb:a,push:!!r,showgoback:!!i,closable:!1}),e},m.default.closeForm=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).pop,e=void 0!==e&&e;this.emit("closeform",!1),e?m.default.popContent():l.default.removeContent(),m.default.setModal(!1)},m.default.disableElement=function(e){var t=e.element,e=e.disable;$(t)[e?"addClass":"removeClass"]("g3w-disabled")},m.default.disableContent=function(e){l.default.disableContent(e)},m.default.disablePanel=function(){m.default.disableElement({element:"#g3w-sidebarpanel-placeholder",disable:0<arguments.length&&void 0!==arguments[0]&&arguments[0]})},m.default.hideContent=function(e,t){return l.default.hideContent(e,t)},m.default.closeContent=function(){return this.emit("closecontent",!1),l.default.closeContent()},m.default.closeOpenSideBarComponent=function(){O.Services.sidebar.closeOpenComponents()},m.default.showQueryResults=function(e,t){var n=m.default.getComponent("queryresults"),r=n.getService();return r.reset(),t&&r.setQueryResponse(t),m.default.showContextualContent({content:n,title:"info.title",crumb:{title:"info.title",trigger:null},push:m.default.getPushContent(),post_title:e}),r},m.default.addNavbarItem=function(e){o.default.addItem(e)},m.default.removeNavBarItem=function(){},m.default.showPanel=s.default.showPanel.bind(s.default),m.default.closePanel=s.default.closePanel.bind(s.default),m.default.disableApplication=function(){p.disableApplication(0<arguments.length&&void 0!==arguments[0]&&arguments[0])},m.default.showUserMessage=function(){return l.default.showUserMessage(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},m.default.closeUserMessage=function(){l.default.closeUserMessage()},m.default.notify={warning:function(e){m.default.showUserMessage({type:"warning",message:e,autoclose:1<arguments.length&&void 0!==arguments[1]&&arguments[1]})},error:function(e){m.default.showUserMessage({type:"alert",message:e,autoclose:1<arguments.length&&void 0!==arguments[1]&&arguments[1]})},info:function(e){m.default.showUserMessage({type:"info",message:e,autoclose:1<arguments.length&&void 0!==arguments[1]&&arguments[1]})},success:function(e){m.default.showUserMessage({type:"success",message:e,autoclose:!0})}},m.default.dialog=bootbox,m.default.showModalDialog=function(){return m.default.dialog.dialog(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},m.default.showSpinner=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.container||"body",n=e.id||"loadspinner",r=e.where||"prepend",i=e.style||"",a=e.transparent?"background-color: transparent":"",e=e.center?"margin: auto":"";$("#"+n).length||$(t)[r].call($(t),'<div id="'+n+'" class="spinner-wrapper '+i+'" style="'+a+'"><div class="spinner '+i+'" style="'+e+'"></div></div>')},m.default.hideSpinner=function(){$("#"+(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"loadspinner")).remove()},m.default.showFloatbar=function(){a.default.open()},m.default.hideFloatbar=function(){a.default.close()},m.default.showSidebar=this._showSidebar.bind(this),m.default.hideSidebar=this._hideSidebar.bind(this),m.default.isSidebarVisible=this._isSidebarVisible.bind(this),m.default.reloadComponents=function(){O.Services.sidebar.reloadComponents()},m.default.setModal=this._showModalOverlay.bind(this),m.default.showFullModal=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.element,e=e.show,e=void 0===e||e;$(void 0===t?"#full-screen-modal":t).modal(e?"show":"hide")},m.default.disableSideBar=function(){r.default.gui.sidebar.disabled=!(0<arguments.length&&void 0!==arguments[0])||arguments[0]},m.default.setPrimaryView=function(e){l.default.setPrimaryView(e)},m.default.showMap=function(){l.default.showMap()},m.default.showContextualMap=function(){l.default.showContextualMap({perc:0<arguments.length&&void 0!==arguments[0]?arguments[0]:30,split:arguments[1]})},m.default.setContextualMapComponent=function(e){l.default.setContextualMapComponent(e)},m.default.resetContextualMapComponent=function(){l.default.resetContextualMapComponent()},m.default.showContent=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return m.default.setLoadingContent(!1),e.perc=n._isMobile?100:e.perc,m.default.setContent(e),!0},m.default.showContextualContent=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e.perc=n._isMobile?100:e.perc,m.default.setContent(e),!0},m.default.pushContent=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.perc=n._isMobile?100:e.perc,e.push=!0,m.default.setContent(e)},m.default.pushContextualContent=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.perc=n._isMobile?100:e.perc,m.default.pushContent(e)},m.default.popContent=function(){l.default.popContent()},m.default.getContentLength=function(){return l.default.contentLength()},m.default.getCurrentContentTitle=function(){return l.default.getCurrentContentTitle()},m.default.getCurrentContentId=function(){return l.default.getCurrentContentId()},m.default.changeCurrentContentTitle=function(e){l.default.changeCurrentContentTitle(e)},m.default.changeCurrentContentOptions=function(){l.default.changeCurrentContentOptions(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},m.default.getCurrentContent=function(){return l.default.getCurrentContent()},m.default.toggleFullViewContent=function(){l.default.toggleFullViewContent()},m.default.resetToDefaultContentPercentage=function(){l.default.resetToDefaultContentPercentage()},m.default.getProjectMenuDOM=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.projects,t=void 0===t?[]:t,n=e.host,e=e.cbk;return new A({projects:t&&Array.isArray(t)&&t,cbk:e,host:n}).getInternalComponent().$mount().$el},m.default.setCloseUserMessageBeforeSetContent=function(){this._closeUserMessageBeforeSetContent=!(0<arguments.length&&void 0!==arguments[0])||arguments[0]},m.default._setContent=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};n._closeUserMessageBeforeSetContent&&m.default.closeUserMessage(),e.content=e.content||null,e.title=e.title||"",e.push=!!_.isBoolean(e.push)&&e.push,e.perc=n._isMobile?100:e.perc,e.split=e.split||"h",e.backonclose=!!_.isBoolean(e.backonclose)&&e.backonclose,e.showtitle=!_.isBoolean(e.showtitle)||e.showtitle,l.default.showContent(e)},m.default.hideClientMenu=function(){p.getConfig().user=null},m.default.hideChangeMaps=function(){p.getConfig().projects=[]},m.default.getTemplateClasses=function(){return BootstrapVersionClasses},m.default.getTemplateClass=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.element,e=e.type;return BootstrapVersionClasses[t][e]},m.default.setLoadingContent=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return O.Services.viewport.setLoadingContent(e),e&&new Promise(function(e){return setTimeout(e,200)})},m.default.openProjectsMenu=function(){m.default.getComponent("contents").getComponentById("projectsmenu")?m.default.closeContent():(this.isMobile()&&(m.default.hideSidebar(),$("#main-navbar.navbar-collapse").removeClass("in")),O.Services.sidebar.closeOpenComponents(),m.default.setContent({content:new A,title:"",perc:100}))},m.default.openChangeMapMenu=function(){m.default.getComponent("contents").getComponentById("changemapmenu")?m.default.closeContent():(this.isMobile()&&(m.default.hideSidebar(),$("#main-navbar.navbar-collapse").removeClass("in")),O.Services.sidebar.closeOpenComponents(),m.default.setContent({content:new le,title:"",perc:100}))}},ae(this)}var F=h("utils"),ae=F.base,oe=F.inherit,I=F.toRawType,F=h("core/i18n/i18n.service"),j=F.t,se=F.tPlugin,F=h("core/g3wobject"),A=h("gui/projectsmenu/projectsmenu"),le=h("gui/changemapmenu/changemapmenu"),R=(Vue.component(e.default.name,e.default),Vue.component(c.default.name,c.default),Vue.component(d.default.name,d.default),Vue.component(f.default.name,f.default),Vue.component(y.default.name,y.default),Vue.component(p.default.name,p.default),Vue.component(b.default.name,b.default),Vue.component(w.default.name,w.default),Vue.component(x.default.name,x.default),Vue.component(S.default.name,S.default),Vue.component(L.default.name,L.default),Vue.component(C.default.name,C.default),Vue.component(E.default.name,E.default),Vue.component(T.default.name,T.default),Vue.filter("t",function(e){return j(e)}),Vue.filter("tPlugin",function(e){return null!==e?se(e):""}),Vue.directive("disabled",z.default),Vue.directive("checked",q.default),Vue.directive("selected-first",Y.default),Vue.directive("select2",W.default),Vue.directive("t-tooltip",H.default),Vue.directive("t-html",Q.default),Vue.directive("t-placeholder",Z.default),Vue.directive("t-title",K.default),Vue.directive("t",X.default),Vue.directive("t-plugin",J.default),Vue.directive("plugins",ee.default),Vue.directive("online",te.default),Vue.directive("download",ne.default),Vue.directive("click-outside",re.default),Vue.use(window.VueCookie),Vue.use({install:function(t){function e(){return n.apply(this,arguments)}var n;t.prototype.g3wtemplate={font:ie.FONT_AWESOME_ICONS,get:function(){},getInfo:function(){return{font:this.font}},addFontClass:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.name,e=e.className,n=void 0===this.font[t];return n&&(this.font[t]=e),n},getInfoString:function(){},getFontClass:function(e){return void 0===this.font[e]?"":this.font[e]}},t.mixin({methods:{isMobile:(n=function(){return isMobile.any},e.toString=function(){return n.toString()},e)}}),m.default.isMobile=function(){return isMobile.any},m.default.getTemplateInfo=function(){return t.prototype.g3wtemplate.getInfo()},m.default.getTemplateInfo=function(){return t.prototype.g3wtemplate.getInfo()},m.default.getFontClass=function(e){return t.prototype.g3wtemplate.getFontClass(e)}}},{}),Vue.mixin({inheritAttrs:!1}),$.LayoutManager);R.loading(!0);oe(O,F),O.PLACEHOLDERS=["navbar","sidebar","viewport","floatbar"],O.Services={navbar:null,sidebar:s.default,viewport:l.default,floatbar:null},O.fail=function(e){e=e.error;R.loading(!1),new Vue(g({el:"#app"},Vue.compile('<div class="error-initial-page skin-background-color">\n        <template v-if="isMobile()">\n          <h3 class="oops">Oops!</h3>\n          <h5 class="cause">'+(e||j("error_page.error"))+'</h5>\n          <h6 class="at-moment">'+j("error_page.at_moment")+'</h6>\n          <h4 class="f5">'+j("error_page.f5")+'</h4>\n        </template>\n        <template v-else>\n          <h1 class="oops">Oops!</h1>\n          <h1 class="cause">'+(e||j("error_page.error"))+'</h1>\n          <h3 class="at-moment">'+j("error_page.at_moment")+'</h3>\n          <h2 class="f5">'+j("error_page.error")+"</h2>\n        </template>\n      </div>")))},t.default.init().then(function(){var e=new O({ApplicationService:t.default});e.on("ready",function(){return t.default.postBootstrap()}),e.init()}).catch(function(e){var t=e.error,t=void 0===t?null:t;e.language;t&&(t.responseJSON&&t.responseJSON.error.data?t=t.responseJSON.error.data:t.statusText&&(t=t.statusText)),O.fail({error:t})})},{"./deprecated":258,"./globals":274,"app/constant":5,"components/App.vue":132,"components/Floatbar.vue":149,"components/GlobalBarLoader.vue":154,"components/GlobalDateTime.vue":155,"components/GlobalDivider.vue":156,"components/GlobalGallery.vue":157,"components/GlobalGeo.vue":158,"components/GlobalHelpDiv.vue":159,"components/GlobalImage.vue":160,"components/GlobalLayerPositions.vue":161,"components/GlobalProgressBar.vue":162,"components/GlobalRange.vue":163,"components/GlobalResize.vue":164,"components/GlobalResizeIcon.vue":165,"components/GlobalSkeleton.vue":166,"components/GlobalTabs.vue":167,"components/NavbaritemsLeft.vue":204,"components/NavbaritemsRight.vue":205,"components/Sidebar.vue":228,"components/Viewport.vue":240,"core/g3wobject":11,"core/i18n/i18n.service":12,"directives/v-checked":260,"directives/v-click-outside":261,"directives/v-disabled":262,"directives/v-download":263,"directives/v-online":264,"directives/v-plugins":265,"directives/v-select2":266,"directives/v-selected-first":267,"directives/v-t":273,"directives/v-t-html":268,"directives/v-t-placeholder":269,"directives/v-t-plugin":270,"directives/v-t-title":271,"directives/v-t-tooltip":272,"gui/catalog/vue/catalog":77,"gui/changemapmenu/changemapmenu":78,"gui/form/vue/form":83,"gui/map/vue/map":117,"gui/metadata/vue/metadata":118,"gui/print/vue/print":120,"gui/projectsmenu/projectsmenu":121,"gui/querybuilder/querybuilderuifactory":122,"gui/queryresults/vue/queryresults":124,"gui/search/vue/search":127,"gui/spatialbookmarks/vue/spatialbookmarks":128,"gui/tools/vue/tools":129,"gui/viewport/contentsviewer":130,"gui/wms/vue/wms":131,"services/application":298,"services/floatbar":301,"services/gui":302,"services/navbaritems":304,"services/sidebar":307,"services/viewport":309,"store/application-state":310,"store/components":312,"store/projects":317,utils:404}],276:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default={translation:{error_page:{error:"Verbindungsfehler",at_moment:"Karte anzeigen ist im Moment nicht mglich",f5:"Drcken Sie Strg+F5"},cookie_law:{message:"Diese Website verwendet Cookies, um Ihnen die bestmgliche Erfahrung auf unserer Website zu bieten.",buttonText:"Verstanden!"},default:"default",sign_in:"Anmelden",layer_selection_filter:{tools:{filter:"Filter aktivieren/deaktivieren",nofilter:"Filter entfernen",invert:"Auswahl umkehren",clear:"Auswahl lschen",show_features_on_map:"Auf der Karte sichtbare Features anzeigen",savefilter:"Filter speichern",filterName:"Filtername"}},warning:{not_supported_format:"Nicht untersttztes Format"},layer_position:{top:"OBEN",bottom:"UNTEN",message:"Position relativ zu den Layern im TOC"},sdk:{atlas:{template_dialog:{title:"Template auswhlen"}},spatialbookmarks:{title:"Rumliche Lesezeichen",helptext:"Bewegen Sie sich auf der Kartenausdehnung, fgen Sie den Namen ein und klicken Sie auf Hinzufgen",input:{name:"Name"},sections:{project:{title:"Projekt-Lesezeichen"},user:{title:"Benutzer-Lesezeichen"}}},search:{all:"ALLE",no_results:"Keine Ergebnisse",searching:"Suchen ...",error_loading:"Fehler beim Datenladen",layer_not_searchable:"Layer ist nicht durchsuchbar",layer_not_querable:"Layer ist nicht abfragbar",autocomplete:{inputshort:{pre:"Bitte",post:"oder mehrere Zeichen eingeben"}}},print:{no_layers:"Kein Layer zu drucken",template:"Template",labels:"Labels",scale:"Skala",format:"Format",rotation:"Drehung",download_image:"Bild herunterladen",fids_instruction:"Akzeptierte Werte: von 1 bis [max]. Es ist mglich, ein Intervall einzugeben, z. B. 4-6",fids_example:"Bsp. 1,4-6 druckt id 1,4,5,6",help:"Die im Druck angezeigten Layer knnen die im Projekt definierten sein und nicht die auf der Karte angezeigten"},querybuilder:{search:{run:"Ausfhren",info:"Information",delete:"Lschen",edit:"Bearbeiten"},messages:{changed:"Gespeichert",number_of_features:"Anzahl der Features"},panel:{button:{all:"ALLE",save:"SPEICHERN",test:"TEST",clear:"LSCHEN",run:"AUSFHREN",manual:"MANUELL"},layers:"LAYERS",fields:"FELDER",values:"WERTE",operators:"OPERATOREN",expression:"AUSDRUCK"},error_run:"Es ist ein Fehler aufgetreten. Bitte berprfen Sie die Abfrage",error_test:"Whrend der Ausfhrung der Abfrage ist ein Fehler aufgetreten",delete:"Soll es gelscht werden?",additem:"Geben Sie den Namen der neuen Suche ein"},errors:{layers:{load:"Einige Layer sind nicht verfgbar"},unsupported_format:"Nicht untersttztes Format",add_external_layer:"Fehler im Ladevorgang des Layers"},metadata:{title:"Metadaten",groups:{general:{title:"ALLGEMEIN",fields:{title:"TITEL",name:"NAME",description:"BESCHREIBUNG",abstract:"ABASTRACT",keywords:"SCHLSSELWRTER",fees:"GEBHREN",accessconstraints:"ZUGRIFFSBESCHRNKUNG",contactinformation:"KONTAKTE",subfields:{contactinformation:{contactelectronicmailaddress:"Email",personprimary:"Referenzen",contactvoicetelephone:"Telefon",contactorganization:"Firma",ContactOrganization:"Firma",contactposition:"Position",ContactPosition:"Position",contactperson:"Person",ContactPerson:"Person"}},wms_url:"WMS"}},spatial:{title:"SPATIAL",fields:{crs:"EPSG",extent:"BBOX"}},layers:{title:"LAYERS",fields:{layers:"LAYERS",subfields:{crs:"EPSG",bbox:"BBOX",title:"TITEL",name:"NAME",geometrytype:"GEOMETRIE",source:"QUELLE",attributes:"ATTRIBUTE",abstract:"ABSTRACT",attribution:"ATRIBUTION",keywords:"SCHLSSELWRTER",metadataurl:"METADATEN URL",dataurl:"DATEN URL"}},groups:{general:"ALLGEMEIN",spatial:"SPATIAL"}}}},tooltips:{relations:{form_to_row:"Zeilenansicht",row_to_form:"Formularansicht",zoomtogeometry:"Auf Geometrie zoomen"},copy_map_extent_url:"Link zur Kartenansicht kopieren",download_shapefile:"Shapefile herunterladen",download_gpx:"DGPX herunterladen",download_gpkg:"GPKG herunterladen",download_csv:"CSV herunterladen",download_xls:"XLS herunterladen",show_chart:"Diagramm anzeigen",atlas:"Atlas drucken"},mapcontrols:{query:{tooltip:"Query layer",actions:{add_selection:{hint:"Auswahl hinzufgen/entfernen"},zoom_to_features_extent:{hint:"Zoom auf Feature-Ausdehnung"},add_features_to_results:{hint:"Hinzufgen/Entfernen von Features zu den Ergebnissen"},remove_feature_from_results:{hint:"Feature aus den Ergebnissen entfernen"},zoom_to_feature:{hint:"Zum Feature zoomen"},relations:{hint:"Relationen anzeigen"},relations_charts:{hint:"Relationship-Diagramm anzeigen"},download_features_shapefile:{hint:"Features Shapefile herunterladen"},download_shapefile:{hint:"Feature Shapefile herunterladen"},download_features_gpx:{hint:"Feature GPX herunterladen"},download_features_gpkg:{hint:"Feature GPKG herunterladen"},download_gpx:{hint:"Feature GPX herunterladen"},download_gpkg:{hint:"Feature GPKG herunterladen"},download_features_csv:{hint:"Features CSV herunterladen"},download_csv:{hint:"Feature CSV herunterladen"},download_features_xls:{hint:"Features XLS herunterladen"},download_xls:{hint:"Feature XLS herunterladen"},atlas:{hint:"Atlas drucken"},copy_zoom_to_fid_url:{hint:"Kopieren der Karten-URL mit dieser Geometrie-Feature-Erweiterung",hint_change:"Kopiert"}}},querybypolygon:{download:{title:"Attribute herunterladen",choiches:{feature:{label:"Nur Features"},feature_polygon:{label:"Features+Query Polygon"}}},tooltip:"Query nach Polygon",no_geometry:"Keine Geometrie in der Antwort",help:{title:"Hilfe - Abfrage nach Polygon",message:"\n                <ul>\n                  <li>Whlen Sie einen Polygon Layer auf TOC.</li>\n                  <li>Stellen Sie sicher, dass der Layer sichtbar ist.</li>\n                  <li>Klicken Sie auf ein Feature des ausgewhlten Layers.</li>\n                </ul>"}},querybydrawpolygon:{tooltip:"Abfrage durch Polygon zeichnen"},querybybbox:{tooltip:"BBox Layer abfragen",nolayers_visible:"Es sind keine abfragbaren Layer sichtbar. Bitte setzen Sie mindestens einen sichtbaren wfs Layer, um die Abfrage zu starten",help:{title:"Hilfe - Abfrage des BBox Layers",message:"\n                 <ul>\n                  <li>Ein Quadrat auf der Karte ziehen, um unterstrichene Layer im TOC abzufragen</li>\n                 </ul>"}},addlayer:{messages:{csv:{warning:"Das Ergebnis in der Karte ist unvollstndig, da die unten stehende Liste fehlerhafter Eintrge enthlt:"}},tooltip:"Layer hinzufgen"},geolocation:{tooltip:"Geolokalisierung"},measures:{length:{tooltip:"Lnge",help:"Klicken Sie auf die Karte, um die Linie zu zeichnen. Drcken Sie <br>CANC, wenn Sie den letzten Eckpunkt lschen mchten."},area:{tooltip:"Flche",help:"Drcken Sie <br>CANC, wenn Sie den letzten Eckpunkt lschen wollen."}},scale:{no_valid_scale:"Ungltige Skala"},scaleline:{units:{metric:"Meter",nautical:"Nautische Meile"}},zoomhistory:{zoom_last:"Zoom Vorheriger",zoom_next:"Zoom Nchster"}},relations:{relation_data:"Daten zur Relation",no_relations_found:"Keine Relationen gefunden",back_to_relations:"Zurck zu den Relationen",list_of_relations_feature:"Liste der Relationen des Features",error_missing_father_field:"Ein Feld fehlt"},form:{loading:"Laden ...",inputs:{messages:{errors:{picklayer:"Kein Feature ausgewhlt. Prfen, ob der Layer in Bearbeitung oder im aktuellen Mastab sichtbar ist"}},tooltips:{picklayer:"Wert aus dem Layer abrufen",lonlat:"Zum Abrufen der Koordinaten auf die Karte klicken"},input_validation_mutually_exclusive:"Feld schliet sich gegenseitig aus mit ",input_validation_error:"Obligatorisches Feld oder falscher Datentyp",input_validation_min_field:"Der Wert muss grer/gleich sein als der Feldwert  ",input_validation_max_field:"Der Wert muss kleiner/gleich sein als der Feldwert ",input_validation_exclude_values:"Wert muss einmalig sein",integer:"integer",bigint:"integer",text:"text",varchar:"text",textarea:"text",string:"string",date:"date",datetime:"date",float:"float",table:"table"},footer:{required_fields:"Erforderliche Felder"},messages:{qgis_input_widget_relation:"Spezifisches Relations-Formular verwenden, um mit Relationen zu arbeiten"}},catalog:{current_map_theme_prefix:"THEMA",choose_map_theme:"THEMA AUSWHLEN",choose_map_theme_input_label:"Name des neuen Themes",project_map_theme:"Projekt Themes",user_map_theme:"Benutzer Themes",question_delete_map_theme:"Mchten Sie das Thema lschen??",delete_map_theme:"Theme erfolgreich gelscht",saved_map_theme:"Thema erfolgreich gespeichert",updated_map_theme:"Thema aktualisieren gespeichert",invalid_map_theme_name:"Der Name ist bereits vorhanden oder falsch",menu:{layerposition:"Position der Ebenen",setwmsopacity:"Opazitt einstellen",wms:{title:"",copy:"Klicken Sie hier, um die Url zu kopieren",copied:"Kopiert"},download:{unknow:"Herunterladen",shp:"Shapefile herunterladen",gpx:"GPX herunterladen",gpkg:"GPKG herunterladen",csv:"CSV herunterladen",xls:"XLS herunterladen",geotiff:"GEOTIFF herunterladen",geotiff_map_extent:"GEOTIFF herunterladen (aktueller Ansichtsumfang)"}}},wps:{list_process:"Liste der Prozesse",tooltip:"Karte anklicken"}},credits:{g3wSuiteFramework:"Applikation basiert auf OS-Framework",g3wSuiteDescription:"Verffentlichen und verwalten Sie Ihre QGIS-Projekte im Internet",productOf:"Framework entwickelt von"},toggle_color_scheme:"Farbschema umschalten",logout:"Logout",no_other_projects:"Kein weiteres Projekt fr diese Gruppe",no_other_groups:"Keine weiteren Gruppen fr diese Makrogruppe",yes:"Ja",no:"No",back:"Zurck",backto:"Zurck zu ",changemap:"Karte ndern",change_session:"Sitzung ndern",component:"Allgemeine Komponente",search:"Suche",no_results:"Keine Ergebnisse gefunden",print:"Drucken",create_print:"Drucken erstellen",dosearch:"Suche",catalog:"Karte",data:"Daten",externalwms:"WMS",baselayers:"Base",tools:"Tools",tree:"Layers",legend:"Legende",nobaselayer:"Keine Basemap",street_search:"Adresse finden",show:"Anzeigen",hide:"Ausblenden",copy_form_data:"Daten kopieren",paste_form_data:"Einfgen",copy_form_data_from_feature:"Daten von der Karte kopieren",error_map_loading:"Fehler beim Laden der Karte",check_internet_connection_or_server_admin:"Internetverbindung prfen oder Admin kontaktieren",could_not_load_vector_layers:"Verbindungsfehler: Layers knnen geladen werden",server_saver_error:"Fehler beim Speichern auf dem Server",server_error:"Server-Verbindungsfehler",save:"Speichern",cancel:"Abbrechen",update:"Aktualisieren",close:"Schlieen",dont_show_again:"Diese Meldung nicht mehr anzeigen",enlange_reduce:"Vergrern / Verkleinern",reset_default:"Standardgre",add:"Hinzufgen",exitnosave:"Beenden ohne Speichern",annul:"Abbrechen",layer_is_added:"Layer mit gleichem Namen bereits hinzugefgt",sidebar:{wms:{panel:{title:"WMS Layer hinzufgen",label:{position:"Kartenposition",name:"Name",projections:"Projektion",layers:"Layers"}},add_wms_layer:"WMS Layer hinzufgen",delete_wms_url:"WMS Url lschen",layer_id_already_added:"WMS Layer bereits hinzugefgt",url_already_added:"WMS URL/Name bereits hinzugefgt",layer_add_error:"WMS Layer nicht hinzugefgt. Bitte berprfen Sie alle WMS-Parameter oder Url"}},info:{title:"Ergebnisse",list_of_relations:"List of Relations",open_link:"Beigefgtes Dokument ffnen",server_error:"Auf dem Server ist ein Fehler aufgetreten",no_results:"Keine Ergebnisse fr diese Anfrage/Suche gefunden",link_button:"ffnen"},mapcontrols:{geolocation:{error:"Position kann nicht bestimmt werden"},geocoding:{choose_layer:"Whlen Sie eine Ebene aus, auf der Sie diese Funktion hinzufgen mchten",placeholder:"Addresse ...",nolayers:"Fr dieses Projekt wurden keine bearbeitbaren Punktebenen gefunden",noresults:"Keine Ergebnisse",notresponseserver:"Keine Antwort vom Server"},add_layer_control:{header:"Layer hinzufgen",select_projection:"Layer Projektion auswhlen",select_field_to_show:"Feld auswhlen, das auf der Karte angezeigt werden soll",select_csv_separator:"Begrenzer auswhlen",select_csv_x_field:"X-Feld auswhlen",select_csv_y_field:"Y-Feld auswhlen",select_color:"Layer Farbe auswhlen",drag_layer:"Layer hierher ziehen und ablegen"},query:{input_relation:"Klicken, um Relationen anzuzeigen"},length:{tooltip:"Lnge"},area:{tooltip:"Area"},screenshot:{error:"Screenshot Fehlererstellung",securityError:'  \n        <p><b>Sicherheitsfehler</b>: Eine externe Ebene verhindert, dass die Karte gedruckt wird. Gehen Sie zur berprfung wie folgt vor:</p>\n        <ol>\n          <li>Entfernen Sie alle manuell hinzugefgten externen Ebenen (z. B. WMS-Ebenen)</li>\n          <li>Neuladen der Seite erzwingen: <code>STRG + F5</code></li>\n          <li>Drucken Sie die Karte erneut</li>\n        </ol>\n        <p>Fr weitere Informationen wenden Sie sich bitte an den Serveradministrator zu: <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image" style="color: #000 !important;font -weight: fett;">&#x2139;&#xFE0F; Sicherheit und befleckte Leinwnde</a></p>\n        '}},catalog_items:{helptext:"Klicken Sie mit der rechten Maustaste auf einen einzelnen Layer, um auf zustzliche Funktionen zuzugreifen",contextmenu:{zoomtolayer:"Zoom auf Layer",open_attribute_table:"Attributtabelle ffnen",show_metadata:"Metadaten",styles:"Stile",vector_color_menu:"Farbe einstellen/ndern",layer_opacity:"Opazitt",filters:"Filters"}},dataTable:{previous:"Vorherige",next:"Weiter",lengthMenu:"_MEN_ anzeigen",info:"Anzeige von _START_ bis _END_ der _TOTAL_ Eintrge",no_data:"Keine Daten",nodatafilterd:"Keine passenden Datenstze gefunden",infoFiltered:"(gefiltert aus _MAX_ Gesamtstzen)"}}}},{}],277:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default={translation:{error_page:{error:"Connection error",at_moment:"At the moment is not possible show map",f5:"Press Ctrl+F5"},cookie_law:{message:"This website uses cookies to ensure you get the best experience on our website.",buttonText:"Got It!"},default:"default",sign_in:"Sign in",layer_selection_filter:{tools:{filter:"Enable/Disable filter",nofilter:"Remove Filter",invert:"Invert Selection",clear:"Clear Selection",show_features_on_map:"Show features visible on map",savefilter:"Save Filter",filterName:"Filter Name"}},warning:{not_supported_format:"Not supported format"},layer_position:{top:"TOP",bottom:"BOTTOM",message:"Position relative to layers on TOC"},sdk:{atlas:{template_dialog:{title:"Select Template"}},spatialbookmarks:{title:"Spatial Bookmarks",helptext:"Move on map extent, insert name and click Add",input:{name:"Name"},sections:{project:{title:"Project Bookmarks"},user:{title:"User Bookmarks"}}},search:{all:"ALL",no_results:"No results",searching:"Searching ...",error_loading:"Error Loading Data",layer_not_searchable:"Layer is not searchable",layer_not_querable:"Layer is not querable",autocomplete:{inputshort:{pre:"Please enter",post:"or more characters"}}},print:{no_layers:"No Layer to print",template:"Template",labels:"Labels",scale:"Scale",format:"Format",rotation:"Rotation",download_image:"Download Image",fids_instruction:"Values accepted: from 1 to value of [max]. Is possible to insert a range ex. 4-6",fids_example:"Ex. 1,4-6 will be printed id 1,4,5,6",help:"The layers shown in the print could be those defined on the project and not those displayed on the map"},querybuilder:{search:{run:"Run",info:"Information",delete:"Delete",edit:"Edit"},messages:{changed:"Saved",number_of_features:"Number of features"},panel:{button:{all:"ALL",save:"SAVE",test:"TEST",clear:"CLEAR",run:"RUN",manual:"MANUAL"},layers:"LAYERS",fields:"FIELDS",values:"VALUES",operators:"OPERATORS",expression:"EXPRESSION"},error_run:"An error occurs. Please check the query",error_test:"An error occur during query execution",delete:"Do you want delete it?",additem:"Insert the name of the new search"},errors:{layers:{load:"Some layers are not available"},unsupported_format:"Not supported format",add_external_layer:"Load layer error"},metadata:{title:"Metadata",groups:{general:{title:"GENERAL",fields:{title:"TITLE",name:"NAME",description:"DESCRIPTION",abstract:"ABSTRACT",keywords:"KEYWORDS",fees:"FEES",accessconstraints:"ACCESS CONSTRAINT",contactinformation:"CONTACTS",subfields:{contactinformation:{contactelectronicmailaddress:"Email",personprimary:"References",contactvoicetelephone:"Phone",contactorganization:"Organization",ContactOrganization:"Organization",contactposition:"Position",ContactPosition:"Position",contactperson:"Person",ContactPerson:"Person"}},wms_url:"WMS"}},spatial:{title:"SPATIAL",fields:{crs:"EPSG",extent:"BBOX"}},layers:{title:"LAYERS",fields:{layers:"LAYERS",subfields:{crs:"EPSG",bbox:"BBOX",title:"TITLE",name:"NAME",geometrytype:"GEOMETRY",source:"SOURCE",attributes:"ATTRIBUTES",abstract:"ABSTRACT",attribution:"ATTRIBUTION",keywords:"PAROLE CHIAVE",metadataurl:"METADATA URL",dataurl:"DATA URL"}},groups:{general:"GENERAL",spatial:"SPATIAL"}}}},tooltips:{relations:{form_to_row:"Row View",row_to_form:"Form View",zoomtogeometry:"Zoom to Geometry"},copy_map_extent_url:"Copy map view link",download_shapefile:"Download Shapefile",download_gpx:"Download GPX",download_gpkg:"Download GPKG",download_csv:"Download CSV",download_xls:"Download XLS",show_chart:"Show Chart",atlas:"Print Atlas"},mapcontrols:{query:{tooltip:"Query layer",actions:{add_selection:{hint:"Add/Remove Selection"},zoom_to_features_extent:{hint:"Zoom to features extent"},add_features_to_results:{hint:"Add/Remove features to results"},remove_feature_from_results:{hint:"Remove feature from results"},zoom_to_feature:{hint:"Zoom to feature"},relations:{hint:"Show Relations"},relations_charts:{hint:"Show relations chart"},download_features_shapefile:{hint:"Download features Shapefile"},download_shapefile:{hint:"Download feature Shapefile"},download_features_gpx:{hint:"Download feature GPX"},download_features_gpkg:{hint:"Download features GPKG"},download_gpx:{hint:"Download feature GPX"},download_gpkg:{hint:"Download feature GPKG"},download_features_csv:{hint:"Download features CSV"},download_csv:{hint:"Download feature CSV"},download_features_xls:{hint:"Download features XLS"},download_xls:{hint:"Download feature XLS"},atlas:{hint:"Print Atlas"},copy_zoom_to_fid_url:{hint:"Copy map URL with this geometry feature extension",hint_change:"Copied"}}},querybypolygon:{download:{title:"Attributes download",choiches:{feature:{label:"Features only"},feature_polygon:{label:"Features+Query Polygon"}}},tooltip:"Query By Polygon",no_geometry:"No geometry on response",help:{title:"Guide - Query By Polygon",message:"\n                <ul>\n                  <li>Select a polygon layer on TOC.</li>\n                  <li>Be sure that layer is visible.</li>\n                  <li>Click on a feature of selected layer.</li>\n                </ul>"}},querybydrawpolygon:{tooltip:"Query by Draw Polygon "},querybybbox:{tooltip:"Query BBox layer",nolayers_visible:"No querable layers are visible. Please set at least one visible wfs layer to run query",help:{title:"Guide - Query BBox layer",message:"\n                  <ul>\n                  <li>Draw a square on map to query underlined layers on TOC</li>\n                  </ul>"}},addlayer:{messages:{csv:{warning:"The result in the map is partial due to the presence of the below incorrect records list:"}},tooltip:"Add Layer"},geolocation:{tooltip:"Geolocation"},measures:{length:{tooltip:"Length",help:"Click on map to draw the line. Press <br>CANC if you want delete last vertex"},area:{tooltip:"Area",help:"Click to draw poligon.Press <br>CANC if you want delete last vertex"}},scale:{no_valid_scale:"Invalid Scale"},scaleline:{units:{metric:"Meters",nautical:"Nautical Mile"}},zoomhistory:{zoom_last:"Zoom Last",zoom_next:"Zoom Next"}},relations:{relation_data:"Relation data",no_relations_found:"No relations found",back_to_relations:"Back to relations",list_of_relations_feature:"List of relations of feature",error_missing_father_field:"Field is missing"},form:{loading:"Loading ...",inputs:{messages:{errors:{picklayer:"No feature selected. Check if layer is on editing or visible at current scale"}},tooltips:{picklayer:"Get value from ma layer",lonlat:"Click on map to get coordinates"},input_validation_mutually_exclusive:"Field mutually exclusive with ",input_validation_error:"Mandatory Field or wrong data type",input_validation_min_field:"Value has to be more/equal to field value  ",input_validation_max_field:"Value has to be less/equal to field value ",input_validation_exclude_values:"Value has to be unique",integer:"integer",bigint:"integer",text:"text",varchar:"text",textarea:"text",string:"string",date:"date",datetime:"date",float:"float",table:"table"},footer:{required_fields:"Required fields"},messages:{qgis_input_widget_relation:"Use relation specific form to work with relation"}},catalog:{current_map_theme_prefix:"THEME",choose_map_theme:"CHOOSE THEME",choose_map_theme_input_label:"Name of new map theme",project_map_theme:"Project Themes",user_map_theme:"User Themes",question_delete_map_theme:"Do you want delete the theme?",delete_map_theme:"Theme deleted successfully",saved_map_theme:"Theme saved successfully",updated_map_theme:"Theme updated successfully",invalid_map_theme_name:"Invalid or exiting name",menu:{layerposition:"Layer Position",setwmsopacity:"Set Opacity",wms:{title:"",copy:"Click here to copy url",copied:"Copied"},download:{unknow:"Download",shp:"Download Shapefile",gpx:"Download GPX",gpkg:"Download GPKG",csv:"Download CSV",xls:"Download XLS",geotiff:"Download GEOTIFF",geotiff_map_extent:"Download GEOTIFF(current view extent)"}}},wps:{list_process:"List of process",tooltip:"Click on map"}},credits:{g3wSuiteFramework:"Application based on OS framework",g3wSuiteDescription:"Publish and manage your QGIS projects on the web",productOf:"Framework developed by"},toggle_color_scheme:"Toggle color scheme",logout:"Logout",no_other_projects:"No more project for this group",no_other_groups:"No more groups for this Macrogroup",yes:"Yes",no:"No",back:"Back",backto:"Back to ",changemap:"Change Map",change_session:"Change Session",component:"Generic Component",search:"Search",no_results:"No results found",print:"Print",create_print:"Create Print",dosearch:"Search",catalog:"Map",data:"Data",externalwms:"WMS",baselayers:"Base",tools:"Tools",tree:"Layers",legend:"Legend",nobaselayer:"No basemap",street_search:"Find Address",show:"Show",hide:"Hide",copy_form_data:"Copy data",paste_form_data:"Paste",copy_form_data_from_feature:"Copy data from map",error_map_loading:"Error occurs loading map",check_internet_connection_or_server_admin:"Check internet connection or contact admin",could_not_load_vector_layers:"Connection error: Layers can be loaded",server_saver_error:"Error in server saving",server_error:"Server connection error",save:"Save",cancel:"Cancel",update:"Update",close:"Close",dont_show_again:"Don't show again",enlange_reduce:"Enlarge / Reduce",reset_default:"Default size",add:"Add",exitnosave:"Exit without save",annul:"Cancel",layer_is_added:"Layer with same name already added",sidebar:{wms:{panel:{title:"Add WMS Layer",label:{position:"Map Position",name:"Name",projections:"Projection",layers:"Layers"}},add_wms_layer:"Add WMS layer",delete_wms_url:"Delete WMS url",layer_id_already_added:"WMS Layer already added",url_already_added:"WMS URL/Name already added",layer_add_error:"WMS Layer not added. Please check all wms parameter or url"}},info:{title:"Results",list_of_relations:"List of Relations",open_link:"Open attached document",server_error:"An error occurred from server",no_results:"No results found for this query/search",link_button:"Open"},mapcontrols:{geolocation:{error:"Can't get your position"},geocoding:{choose_layer:"Choose a layer where to add this feature",placeholder:"Address ...",nolayers:"No editable point layers found on this project",noresults:"No results",notresponseserver:"No response from server"},add_layer_control:{header:"Add Layer",select_projection:"Select layer projection",select_field_to_show:"Select Field to show on map",select_csv_separator:"Select delimiter",select_csv_x_field:"Select X field",select_csv_y_field:"Select Y field",select_color:"Select Layer Color",drag_layer:"Drag and drop layer here"},query:{input_relation:"Click to show relations"},length:{tooltip:"Length"},area:{tooltip:"Area"},screenshot:{error:"Screenshot error creation",securityError:'  \n        <p><b>Security Error</b>: an external layer is preventing map from being printed. To check, proceed as follows:</p>\n        <ol>\n          <li>remove any manually added external layers (eg. WMS layers)</li>\n          <li>force page reload: <code>CTRL + F5</code></li>\n          <li>print again the map</li>\n        </ol>\n        <p>For more info please contact server administrator about: <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image" style="color: #000 !important;font-weight: bold;">&#x2139;&#xFE0F; security and tainted canvases</a></p>\n        '}},catalog_items:{helptext:"Right-click on individual layer to access additional features",contextmenu:{zoomtolayer:"Zoom to Layer",open_attribute_table:"Open Attribute Table",show_metadata:"Metadata",styles:"Styles",vector_color_menu:"Set/Change Color",layer_opacity:"Opacity",filters:"Filters"}},dataTable:{previous:"Previous",next:"Next",lengthMenu:"Show _MENU_",info:"Showing _START_ to _END_ of _TOTAL_ entries",no_data:"No data",nodatafilterd:"No matching records found",infoFiltered:"(filtered from _MAX_ total records)"}}}},{}],278:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default={translation:{error_page:{error:"Yhteysvirhe",at_moment:"Tll hetkell ei ole mahdollista nytt karttaa",f5:"Paina Ctrl+F5"},cookie_law:{message:"This website uses cookies to ensure you get the best experience on our website.",buttonText:"Got It!"},default:"oletuksena",sign_in:"Kirjaudu sisn",layer_selection_filter:{tools:{filter:"Ota suodatin kyttn/poista kytst",nofilter:"Poista Suodattaa",invert:"Knteinen Valinta",clear:"Peruuttaa Valinta",show_features_on_map:"Nyt kartalla nkyvt ominaisuudet",savefilter:"Tallenna suodatin",filterName:"Suodattimen Nimi"}},warning:{not_supported_format:"Not supported format"},layer_position:{top:"TOP",bottom:"BOTTOM",message:"Position relative to layers on TOC"},sdk:{atlas:{template_dialog:{title:"Valitse Template"}},spatialbookmarks:{title:"Tilalliset kirjanmerkit",helptext:"Siirry kartan laajuuteen, lis nimi ja napsauta Lis",input:{name:"Nimi"},sections:{project:{title:"Projektin kirjanmerkit"},user:{title:"Kyttjn kirjanmerkit"}}},search:{all:"KAIKKI",no_results:"Ei tuloksia",searching:"Haetaan ...",error_loading:"Virhe ladattaessa tietoja.",layer_not_searchable:"Taso ei ole haettavissa.",layer_not_querable:"Tasolle ei voi suorittaa kyselyit.",autocomplete:{inputshort:{pre:"Syt",post:"tai useampi merkki"}}},print:{no_layers:"Ei tulostettavia tasoja",template:"Template",labels:"Labels",scale:"Mittakaava",format:"Formaatti",rotation:"Kierto",download_image:"Lataa kuva",fids_instruction:"Hyvksytyt arvot: yhdest arvoon [max]. Salittua sytt mys vli, esim. 4-6.",fids_example:"Esimerkiksi 1,4-6 tulostuu id 1,4,5,6.",help:"Tulosteessa esiintyvt tasot voivat olla projektissa mriteltyj ei kartalla esiintyvi."},querybuilder:{search:{run:"Suorita",info:"Informaatio",delete:"Poista",edit:"Muokkaa"},messages:{changed:"Tallennettu",number_of_features:"Ominaisuuksien lukumr"},panel:{button:{all:"KAIKKI",save:"TALLENNA",test:"TESTI",clear:"TYHJENN",run:"SUORITA",manual:"MANUAALINEN"},layers:"TASOT",fields:"KENTT",values:"ARVOT",operators:"OPERAATTORIT",expression:"LAUSEKE"},error_run:"Tapahtui virhe. Tarkista kysely.",error_test:"Kysely suorittaessa tapahtui virhe.",delete:"Haluatko poistaa sen?",additem:"Anna nimi uudelle haulle."},errors:{layers:{load:"Jotkin tasot eivt ole saatavilla."},unsupported_format:"Ei tuettu formaatti",add_external_layer:"Tason latausvirhe"},metadata:{title:"Metatiedot",groups:{general:{title:"YLEINEN",fields:{title:"OTSIKKO",name:"NIMI",description:"KUVAUS",abstract:"TIIVISTELM",keywords:"AVAINSANAT",fees:"MAKSUT",accessconstraints:"PSYRAJOITUKSET",contactinformation:"YHTEYSTIEDOT",subfields:{contactinformation:{contactelectronicmailaddress:"Shkposti",personprimary:"Viitteet",contactvoicetelephone:"Puhelin",contactorganization:"Organisaatio",ContactOrganization:"Organisaatio",contactposition:"Asema",ContactPosition:"Asema",contactperson:"Yhteyshenkil",ContactPerson:"Yhteyshenkil"}},wms_url:"WMS"}},spatial:{title:"SPATIAL",fields:{crs:"EPSG",extent:"BBOX"}},layers:{title:"TASOT",fields:{layers:"TASOT",subfields:{crs:"EPSG",bbox:"BBOX",title:"OTSIKKO",name:"NIMI",geometrytype:"GEOMETRIA",source:"LHDE",attributes:"ATTRIBUUTIT",abstract:"TIIVISTELM",attribution:"ATTRIBUUTIO",keywords:"AVAINSANAT",metadataurl:"METATIEDON URL",dataurl:"DATA URL"}},groups:{general:"YLEINEN",spatial:"SPATIAL"}}}},tooltips:{relations:{form_to_row:"Rivinkym",row_to_form:"Taulukkonkym",zoomtogeometry:"Zoomaa geometriaan"},copy_map_extent_url:"Kopioi kartan katselulinkki",download_shapefile:"Lataa SHP-tiedosto",download_gpx:"Lataa GPX-tiedosto",download_gpkg:"Lataa GPKG-tiedosto",download_csv:"Lataa CSV-tiedosto",download_xls:"Lataa XLS-tiedosto",show_chart:"Nyt kaavio",atlas:"Tulosta Atlas"},mapcontrols:{query:{tooltip:"Kyselytaso",actions:{add_selection:{hint:"Lis/Poista valinta"},zoom_to_features_extent:{hint:"Tarkenna ominaisuuden laajuuteen"},add_features_to_results:{hint:"Add/Remove features to results"},remove_feature_from_results:{hint:"Remove feature from results"},zoom_to_feature:{hint:"Tarkenna ominaisuuteen"},relations:{hint:"Nyt relaatiot"},relations_charts:{hint:"Nyt relaatiokaavio"},download_features_shapefile:{hint:"Lataa ominaisuuden SHP-tiedosto"},download_shapefile:{hint:"Lataa ominaisuuden SHP-tiedosto"},download_features_gpx:{hint:"Lataa ominaisuuden GPX-tiedosto"},download_features_gpkg:{hint:"Lataa ominaisuuden GPKG-tiedosto"},download_gpx:{hint:"Lataa ominaisuuden GPX-tiedosto"},download_gpkg:{hint:"Lataa ominaisuuden GPKG-tiedosto"},download_features_csv:{hint:"Lataa ominaisuuden CSV-tiedosto"},download_csv:{hint:"Lataa ominaisuuden CSV-tiedosto"},download_features_xls:{hint:"Lataa ominaisuuden XLS-tiedosto"},download_xls:{hint:"Lataa ominaisuuden XLS-tiedosto"},atlas:{hint:"Tulosta Atlas"},copy_zoom_to_fid_url:{hint:"Copy map URL with this geometry feature extension",hint_change:"Copied"}}},querybypolygon:{download:{title:"Attributes download",choiches:{feature:{label:"Features only"},feature_polygon:{label:"Features+Query Polygon"}}},tooltip:"Kysely monikulmiolla",no_geometry:"No geometry on response",help:{title:"Ohje - Kysely monikulmiolla",message:"\n                <ul>\n                  <li>Valitse monikulmiotaso luettelosta.</li>\n                  <li>Tarkista, ett taso on nkyvill.</li>\n                  <li>Valitse ominaisuus valitulla tasolla.</li>\n                </ul>"}},querybydrawpolygon:{tooltip:"Kysely piirtopolygonin mukaan"},querybybbox:{tooltip:"Tasoon kohdituva BBox-kysely",nolayers_visible:"Ei kyseltvi tasoja nkyvill. Aseta vhintn yksi WFS-taso nkyvksi suorittaaksesi haun.",help:{title:"Ohje - Tasoon kohdistuva BBox-kysely",message:"\n                 <ul>\n                  <li>Piirr suorakulmio kartalle suorittaaksesi kyselyn luettelossa alleviivatuille tasoille.</li>\n                 </ul>"}},addlayer:{messages:{csv:{warning:"The result in the map is partial due to the presence of the below incorrect records list:"}},tooltip:"Lis taso"},geolocation:{tooltip:"Maantieteellinen sijainti"},measures:{length:{tooltip:"Pituus",help:"Piirr murtoviiva kartalle. Paina <br>CANC, mikli haluat poistaa edellisen pisteen."},area:{tooltip:"Alue",help:"Piirr monikulmio kartalle. Paina <br>CANC, mikli haluat poistaa edellisen pisteen."}},scale:{no_valid_scale:"Vr mittakaava"},scaleline:{units:{metric:"Meters",nautical:"Nautical Mile"}},zoomhistory:{zoom_last:"Zoom Edellinen",zoom_next:"Zoom Seurata"}},relations:{relation_data:"Relaation tiedot",no_relations_found:"Relaatiota ei lytynyt.",back_to_relations:"Takaisin relaatioihin",list_of_relations_feature:"Lista ominaisuuden relaatioista",error_missing_father_field:"Kentt puuttu"},form:{loading:"Ladataan...",inputs:{messages:{errors:{picklayer:"Ominaisuuksia ei valiitu. Tarkista, ett taso on muokattavissa tai nkyviss nykyisell mittakaavalla."}},tooltips:{picklayer:"Valitse arvo karttatasolta",lonlat:"Click on map to get coordinates"},input_validation_mutually_exclusive:"Kentt toisensa poissulkeva.",input_validation_error:"Pakollinen kentt tai vr tietotyyppi.",input_validation_min_field:"Arvon tulee olla suurempi tai yhtsuuri kuin kentn arvo.",input_validation_max_field:"Arvon tulee olla pienempi tai yhtsuuri kuin kentn arvo.",input_validation_exclude_values:"Arvon tulee olla uniikki.",integer:"kokonaisluku",bigint:"kokonaisluku",text:"teksti",varchar:"teksti",textarea:"teksti",string:"merkkijono",date:"pivys",datetime:"pivys",float:"liukuluku",table:"taulukko"},footer:{required_fields:"Vaaditut kentt"},messages:{qgis_input_widget_relation:"Kyt relaatioiden mrittmiseen thn tarkoitettua toimintoa"}},catalog:{current_map_theme_prefix:"THEME",choose_map_theme:"CHOOSE THEME",choose_map_theme_input_label:"Uuden teeman nimi",project_map_theme:"Projektin Themes",user_map_theme:"Kyttj Themes",question_delete_map_theme:"Haluatko poistaa teeman?",delete_map_theme:"Teeman poistaminen onnistui",saved_map_theme:"Teeman tallennus onnistui",updated_map_theme:"Teeman pivitt onnistui",invalid_map_theme_name:"Nimi on jo olemassa tai se on virheellinen",menu:{layerposition:"Kerroksen sijainti",setwmsopacity:"Aseta Opacity",wms:{title:"",copy:"Paina tst kopioidaksesi url:n.",copied:"Kopioitu."},download:{unknow:"Lataa",shp:"Lataa SHP-tiedosto",gpx:"Lataa GPX-tiedosto",gpkg:"Lataa GPKG-tiedosto",csv:"Lataa CSV-tiedosto",xls:"Lataa XLS-tiedosto",geotiff:"Lataa GEOTIFF-tiedosto",geotiff_map_extent:"Lataa GEOTIFF-tiedosto(current view extent)"}}},wps:{list_process:"Lista prosesseista",tooltip:"Valitse kartalta"}},credits:{g3wSuiteFramework:"Sovellus perustuu OS framework",g3wSuiteDescription:"Julkaise ja hallinnoi QGIS-projekteja verkossa.",productOf:"Frameworkin on kehittnyt"},toggle_color_scheme:"Toggle color scheme",logout:"Kirjaudu ulos",no_other_projects:"Ei projekteja tlle ryhmlle",no_other_groups:"Ei en ryhmi tlle makroryhmlle",yes:"Kyll",no:"Ei",back:"Palaa",backto:"Takaisin ",changemap:"Vaihda karttaa",change_session:"Vaihda istuntoa",component:"Yleinen komponentti",search:"Hae",no_results:"Ei hakutuloksia",print:"Tulosta",create_print:"Luo tuloste",dosearch:"Hae",catalog:"Kartta",data:"Data",externalwms:"WMS",baselayers:"Taustakartta",tools:"Tykalut",tree:"Tasot",legend:"Merkintjen selite",nobaselayer:"Ei taustakarttaa",street_search:"Hae osoite",show:"Nyt",hide:"Piilota",copy_form_data:"Kopioi tiedot",paste_form_data:"Liit",copy_form_data_from_feature:"Kopioi tiedot kartalta",error_map_loading:"Virhe ladattessa karttaa",check_internet_connection_or_server_admin:"Tarkista internetyhteys tai ota yhteytt yllpitjn.",could_not_load_vector_layers:"Yhteysvirhe, tasoja ei voida ladata.",server_saver_error:"Virhe tallentaessa palvelimelle.",server_error:"Yhteysvirhe palvelimeen",save:"Tallenna",cancel:"Peruuta",update:"Pivitt",close:"Sulje",dont_show_again:"l nyt viesti uudelleen",enlange_reduce:"Suurenna / Pienenn",reset_default:"Oletuskoko",add:"Lis",exitnosave:"Poistu tallentamatta",annul:"Peruuta",layer_is_added:"Samanniminen taso on jo listty.",sidebar:{wms:{panel:{title:"Add WMS Layer",label:{position:"Map Position",name:"Name",projections:"Projection",layers:"Layers"}},add_wms_layer:"Aggiungi WMS layer",delete_wms_url:"Delete WMS url",layer_id_already_added:"WMS Taso on jo listty.",url_already_added:"WMS URL/Nimi on jo listty.",layer_add_error:"WMS Layer not added. Please check all wms parameter or url"}},info:{title:"Tulokset",list_of_relations:"List of Relations",open_link:"Avaa liitetiedosto",server_error:"Palvelimella tapahtui virhe.",no_results:"Ei tuloksia haulle/kyselylle.",link_button:"Avaa"},mapcontrols:{geolocation:{error:"Sijaintiasi ei saada"},geocoding:{choose_layer:"Valitse kerros, johon tm ominaisuus listn",placeholder:"Osoite ...",nolayers:"Tst projektista ei lytynyt muokattavia pistetasoja",noresults:"Ei tuloksia",notresponseserver:"Ei vastausta palvelimelta"},add_layer_control:{header:"Lis taso",select_projection:"Valitse tason projektio",select_field_to_show:"Select Field to show on map",select_csv_separator:"Select delimiter",select_csv_x_field:"Select X field",select_csv_y_field:"Select Y field",select_color:"Valitse tason vri",drag_layer:"Ved ja pudota taso thn"},query:{input_relation:"Paina nyttksesi relaatiot"},length:{tooltip:"Pituus"},area:{tooltip:"Pinta-ala"},screenshot:{error:"Screenshot error creation",securityError:'  \n        <p><b>Turvallisuusvirhe</b>: ulkoinen kerros est karttaa tulostamasta. Tarkistaaksesi, toimi seuraavasti:</p>\n        <ol>\n          <li>poista manuaalisesti listyt ulkoiset tasot (esim. WMS-tasot)</li>\n          <li>Pakota sivun uudelleenlataus: <code>CTRL + F5</code></li>\n          <li>tulosta kartta uudelleen</li>\n        </ol>\n        <p>Saat listietoja palvelimen jrjestelmnvalvojalta seuraavista aiheista: <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image" style="color: #000 !important;font -paino: lihavoitu;">&#x2139;&#xFE0F; turvallisuus ja likaiset kankaat</a></p>\n        '}},catalog_items:{helptext:"Napsauta hiiren kakkospainikkeella yksittist tasoa pstksesi lisominaisuuksiin.",contextmenu:{zoomtolayer:"Tarkenna tasoon",open_attribute_table:"Avaa attribuuttitaulu",show_metadata:"Metatiedot",styles:"Tyylej",vector_color_menu:"Aseta/muuta vri",layer_opacity:"Peittvyys",filters:"Filters"}},dataTable:{previous:"Edellinen",next:"Seuraava",lengthMenu:"Show _MENU_ items",info:"Showing _START_ to _END_ of _TOTAL_ entries",no_data:"Ei tietoja",nodatafilterd:"Vastaavia tietueita ei lytynyt",infoFiltered:"(filtered from _MAX_ total records)"}}}},{}],279:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default={translation:{error_page:{error:"Erreur de connexion",at_moment:"Pour le moment, il n'est pas possible d'afficher la carte",f5:"Appuyez sur Ctrl+F5"},cookie_law:{message:"Ce site utilise des cookies pour assurer une bonne convivialit pour l'utilisateur final.",buttonText:"Jai compris !"},default:"par dfaut ",sign_in:"Se connecter ",layer_selection_filter:{tools:{filter:"Activer/Dsactiver le filtre",nofilter:"Supprimer le filtre ",invert:"Slection inverse ",clear:"Effacer la slection ",show_features_on_map:"Afficher les caractristiques visibles sur la carte",savefilter:"Sauver le Filtre",filterName:"Nom du Filtre"}},warning:{not_supported_format:"Not supported format"},layer_position:{top:"TOP",bottom:"BOTTOM",message:"Position relative to layers on TOC"},sdk:{atlas:{template_dialog:{title:"Slectionnez Template"}},spatialbookmarks:{title:"Signets spatiaux",helptext:"Dplacez-vous sur l'tendue de la carte, insrez le nom et cliquez sur Ajouter",input:{name:"Nom"},sections:{project:{title:"Signets du projet"},user:{title:"Signets de l'utilisateur"}}},search:{all:"TOUTES",no_results:"Aucune valeur trouve",searching:"Je cherche...",error_loading:"Erreur de chargement des valeurs",layer_not_searchable:"Le layer nest pas recherchable",layer_not_querable:"Le layer n'est pas interrogeable",autocomplete:{inputshort:{pre:"Tapez au moins",post:"caractres"}}},print:{no_layers:"Aucune layer visible",scale:"chelle",format:"Format",rotation:"Rotation",download_image:"Tlcharger l'image",fids_instruction:"Valeurs acceptes : de 1  la valeur maximale indique par [max]. Il est galement possible d'indiquer une fourchette de valeurs, par exemple 4-6",fids_example:"Par exemple 1,4-6 les ids 1,4,5,6 seront imprims",help:"Les layers montrs dans l'impression peuvent tre ceux dfinis dans le projet et non ceux montrs sur la carte"},querybuilder:{search:{run:"Lancer la recherche",info:"Information",delete:"Supprimer",edit:"Editer"},messages:{changed:"Enregistr correctement",number_of_features:"Nombre de fonctionnalits"},panel:{button:{all:"TOUTES",save:"SAUVEGARDER",test:"TESTER",clear:"NETTOYER",run:"EXECUTER",manual:"MANUEL"},layers:"LAYERS",fields:"CHAMPS",values:"VALEURS",operators:"OPERATEURS",expression:"EXPRESSION"},error_run:"Une erreur s'est produite. Vrifiez si la requte est correcte",error_test:"Erreur d'excution de la requte",delete:"Voulez-vous confirmer la suppression ?",additem:"Entrer le nom de la requte"},errors:{layers:{load:"Certaines layers du projet ne sont pas disponibles actuellement et n'apparaissent donc pas dans la vue actuelle"},unsupported_format:"Format non support",add_external_layer:"Erreur lors du chargement du layer"},metadata:{title:"Mtadonnes",groups:{general:{title:"GNRAL",fields:{title:"TITRE",name:"NOM",description:"DESCRIPTION",abstract:"ABREGE",keywords:"LISTE DE MOTS-CLS",fees:"DROITS D'INSCRIPTION",accessconstraints:"CONTRAINTES D'ACCS",contactinformation:"CONTACTS",subfields:{contactinformation:{contactelectronicmailaddress:"E-mail",personprimary:"Rfrences",contactvoicetelephone:"Tlphone",contactorganization:"Organisation",ContactOrganization:"Organisation",contactposition:"Localisation",ContactPosition:"Localisation",contactperson:"Personne",ContactPerson:"Personne"}},wms_url:"WMS"}},spatial:{title:"INFO ESPACE",fields:{crs:"EPSG",extent:"BBOX"}},layers:{title:"STRATES",groups:{general:"GENERALE",spatial:"INFO ESPACE"},fields:{layers:"STRATES",subfields:{crs:"EPSG",bbox:"BBOX",title:"TITRE",name:"NOM",geometrytype:"GOMTRIE",source:"SOURCE",attributes:"ATTRIBUTES",abstract:"ABRG",attribution:"ATTRIBUTION",keywords:"MOTS- CLS",metadataurl:"URL DE MTADONNES",dataurl:"URL DES DONNES"}}}}},tooltips:{relations:{form_to_row:"Afficher le format de la ligne",row_to_form:"Format du formulaire d'affichage",zoomtogeometry:"Zoom sur la gomtrie"},zoom_to_features_extent:"Zoom sur les fonctionnalits",copy_map_extent_url:"Copier le lien de visualisation de la carte",download_shapefile:"Tlcharger le fichier Shapefile",download_gpx:"Tlcharger GPX",download_gpkg:"Tlcharger GPKG",download_csv:"Tlcharger CSV",download_xls:"Tlcharger XLS",show_chart:"Montrer graphique",atlas:"Imprimer l'Atlas"},mapcontrols:{query:{tooltip:"Interrogation layer",actions:{add_selection:{hint:"Ajouter/supprimer une slection"},zoom_to_features_extent:{hint:"Zoom sur les fonctionnalits"},add_features_to_results:{hint:"Ajouter des fonctionnalits aux rsultats"},remove_feature_from_results:{hint:"Supprimer la fonctionnalit des rsultats"},zoom_to_feature:{hint:"Zoom sur les fonctionnalits"},relations:{hint:"Voir les relations"},relations_charts:{hint:"Voir les graphiques de relations"},download_features_shapefile:{hint:"Tlcharger les fonctionnalits vers Shapefile"},download_shapefile:{hint:"Tlcharger le Shapefile"},download_features_gpx:{hint:"Tlcharger les fonctionnalits vers GPX"},download_features_gpkg:{hint:"Tlcharger les fonctionnalits vers GPKG"},download_gpx:{hint:"Tlcharger le GPX"},download_gpkg:{hint:"Tlcharger le GPKG"},download_features_csv:{hint:"Tlcharger les fonctionnalits vers CSV"},download_csv:{hint:"Tlcharger le CSV"},download_features_xls:{hint:"Tlcharger les fonctionnalits vers XLS"},download_xls:{hint:"Tlcharger le XLS"},atlas:{hint:"Imprimer l'Atlas"},copy_zoom_to_fid_url:{hint:"Copier l'URL de la carte avec l'extension vers cette gomtrie",hint_change:"Copi"}}},querybypolygon:{download:{title:"Tlchargement des attributs",choiches:{feature:{label:"Fonctionnalits seulement"},feature_polygon:{label:"Fonctionnalits+Requte Polygon "}}},tooltip:"Requte par polygone",no_geometry:"La rponse ne contient pas de gomtrie",help:{title:"Aide - Requte par polygone",message:"\n                <ul>\n                  <li>Slectionnez un layer de polygone dans la lgende.</li>\n                  <li>Vrifiez que le layer est visible dans la carte.</li>\n                  <li>Cliquez sur une gomtrie du layer slectionn.</li>\n                </ul>"}},querybydrawpolygon:{tooltip:"Requte par polygone de dessin"},querybybbox:{tooltip:"Requte pour BBOX",nolayers_visible:"Aucun layer requtable n'est visible. Assurez-vous qu'au moins un layer wfs est visible pour excuter la requte",help:{title:"Aide - Requte BBox",message:"\n                  <ul>\n                    <li>Dessinez un rectangle pour interroger les couches surlignes en jaune</li>\n                 </ul>\n            "}},addlayer:{messages:{csv:{warning:"Le rsultat de la carte est partiel en raison de la prsence des enregistrements incorrects suivants :"}},tooltip:"Ajouter un layer"},geolocation:{tooltip:"Golocalisation"},measures:{length:{tooltip:"Longueur",help:"Cliquez sur la carte pour continuer  dessiner la ligne.<br>CANC si vous voulez supprimer le dernier vertex insr"},area:{tooltip:"Zone",help:"Cliquez pour continuer  dessiner le polygone.<br>CANC si vous voulez supprimer le dernier vertex insr"}},scale:{no_valid_scale:"chelle invalide"},scaleline:{units:{metric:"Meters",nautical:"Nautical Mile"}},zoomhistory:{zoom_last:"Zoom Prcdent",zoom_next:"Zoom Suivant"}},relations:{relation_data:"Donnes relationnelles",no_relations_found:"Aucune relation trouve",back_to_relations:"Retour aux relations",list_of_relations_feature:"Liste des relations entre les caractristiques",error_missing_father_field:"Le champ concern n'existe pas"},form:{loading:"Chargement...",inputs:{messages:{errors:{picklayer:"Aucune fonction slectionne. Vrifier si le layer est en dition ou non visible  l'chelle actuelle"}},tooltips:{picklayer:"Obtenir la valeur de la carte",lonlat:"Cliquez sur la carte pour obtenir les coordonnes"},input_validation_mutually_exclusive:"Champ mutuellement exclusif avec ",input_validation_error:"Champ obligatoire ou type de valeur incorrect",input_validation_min_field:"La valeur doit tre suprieure ou gale au camp ",input_validation_max_field:"La valeur doit tre infrieure ou gale au champ ",input_validation_exclude_values:"Le champ doit contenir une valeur diffrente",integer:"entier",bigint:"entier",text:"textuel",varchar:"textuel",textarea:"textuel",string:"chane",date:"date",datetime:"date",float:"float",table:"table"},footer:{required_fields:"Champs obligatoires"},messages:{qgis_input_widget_relation:"Grer les relations via un formulaire ddi"}},catalog:{current_map_theme_prefix:"THEME",choose_map_theme:"SLECTIONNEZ LE THME",choose_map_theme_input_label:"Nom du nouveau thme",project_map_theme:"Thme du projet",user_map_theme:"Thme de l'utilisateur",question_delete_map_theme:"Voulez-vous supprimer le thme ?",delete_map_theme:"Thme supprim avec succs",saved_map_theme:"Thme enregistr avec succs",updated_map_theme:"Thme mise  jour avec succs",invalid_map_theme_name:"Le nom existe dj ou est incorrect",menu:{layerposition:"Position du calque",setwmsopacity:"Dfinir l'opacit",wms:{title:"",copy:"Cliquez ici pour copier l'url",copied:"Copi"},download:{unknow:"Tlcharger",shp:"Tlcharger Shapefile",gpx:"Tlcharger GPX",gpkg:"Tlcharger GPKG",csv:"Tlcharger CSV",xls:"Tlcharger XLS",geotiff:"Tlcharger GEOTIFF",geotiff_map_extent:"Tlcharger GEOTIFF(current view extent)"}}},wps:{list_process:"Liste des processus",tooltip:"Cliquez sur la carte"}},credits:{g3wSuiteFramework:"Application construite avec le framework OS",g3wSuiteDescription:"Publiez et grez vos projets QGIS sur le Web",productOf:"Framework dvelopp par"},logout:"Quitter",no_other_projects:"Il n'y a pas d'autres projets dans ce groupe de cartes",no_other_groups:"Il n'y a pas d'autres groupes dans ce macrogroupe",yes:"Oui",no:"No",back:"Retour",backto:"Retour  ",changemap:"Changer de carte",change_session:"Changer de sance",component:"Composant gnrique",search:"Recherches",no_results:"Aucun rsultat trouv",print:"Imprimer",create_print:"Crer une impression",dosearch:"Recherche",catalog:"Carte",data:"Donnes",externalwms:"WMS",baselayers:"Bases",tools:"Outils",tree:"Strates",legend:"Lgende",nobaselayer:"Pas de carte de base",street_search:"Adresse de recherche",show:"Afficher",hide:"Cacher",copy_form_data:"Copier les donnes du formulaire",paste_form_data:"Coller",copy_form_data_from_feature:"Copier les donnes de la carte",error_map_loading:"Erreur de chargement de la nouvelle carte",check_internet_connection_or_server_admin:"Vrifiez la connexion internet ou contactez l'administrateur",could_not_load_vector_layers:"Erreur de connexion au serveur : il n'a pas t possible de charger les vecteurs demands",server_saver_error:"Erreur de sauvegarde sur le serveur",server_error:"Une erreur s'est produite dans la requte au serveur",save:"Sauvegarder",cancel:"Supprimer",update:"Mise  jour",close:"Fermer",dont_show_again:"Ne plus afficher ce message",enlange_reduce:"Agrandir / Rduire",reset_default:"Taille par dfaut",add:"Ajouter",exitnosave:"Quitter sans sauvegarder",annul:"Annuler",layer_is_added:"Layer avec le mme nom dj ajout",wms_layer_id_already_added:"WMS Layer dj ajout",wms_url_already_added:"WMS URL dj ajout",sidebar:{wms:{panel:{title:"Add WMS Layer",label:{position:"Map Position",name:"Name",projections:"Projection",layers:"Layers"}},add_wms_layer:"Add WMS layer",delete_wms_url:"Delete WMS url",layer_id_already_added:"WMS Nivn har redan lagts till.",url_already_added:"WMS URL/Nom har redan lagts till.",layer_add_error:"WMS Layer not added. Please check all wms parameter or url"}},info:{title:"Rsultats",list_of_relations:"List of Relations",open_link:"Ouvrir le document joint",server_error:"Une erreur s'est produite dans la requte au serveur",no_results:"Aucun rsultat pour cette requte/recherche",link_button:"Ouvrir"},mapcontrols:{geolocation:{error:"Votre position ne peut tre calcule."},geocoding:{choose_layer:"Choisissez un calque o ajouter cette fonctionnalit",placeholder:"Adresse ...",nolayers:"Aucune couche de points modifiable trouve sur ce projet",noresults:"Aucun rsultat",notresponseserver:"Le serveur ne rpond pas"},add_layer_control:{header:"Ajouter un layer",select_projection:"Slectionnez le systme de projection de couches",select_field_to_show:"Slectionnez le champ  afficher sur la carte",select_csv_separator:"Slectionner le sparateur",select_csv_x_field:"Slectionnez le champ X",select_csv_y_field:"Slectionnez le champ Y",select_color:"Slectionnez la couleur du layer",drag_layer:"Faire glisser le layer vers cette zone"},query:{input_relation:"Cliquez pour voir les relations"},length:{tooltip:"Longueur"},area:{tooltip:"Zone"},screenshot:{error:"Erreur de cration de la capture d'cran",securityError:'  \n        <p><b>Erreur de scurit</b> : une couche externe empche l\'impression de la carte. Pour vrifier, procdez comme suit :</p>\n        <ol>\n          <li>supprimer toutes les couches externes ajoutes manuellement (par exemple, les couches WMS)</li>\n          <li>forcer le rechargement de la page : <code>CTRL + F5</code></li>\n          <li>imprimer  nouveau la carte</li>\n        </ol>\n        <p>Pour plus d\'informations, veuillez contacter l\'administrateur du serveur  propos de : <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image" style="color: #000 !important;font -poids : gras ;">&#x2139;&#xFE0F; scurit et toiles souilles</a></p>\n        '}},catalog_items:{helptext:"Cliquez avec le bouton droit de la souris sur les diffrents layers pour accder  des fonctionnalits supplmentaires",contextmenu:{zoomtolayer:"Zoom sur le layer",open_attribute_table:"Table d'attributs ouverte",show_metadata:"Mtadonnes",styles:"Styles",vector_color_menu:"Dfinir/changer la couleur",layer_opacity:"Opacit",filters:"Filters"}},dataTable:{previous:"Prcdent",next:"Suivant",lengthMenu:"Afficher _MENU_",info:"Afficher _START_  _END_ sur _TOTAL_ lignes",nodatafilterd:"Aucun rsultat trouv",infoFiltered:"(Filtr par _MAX_ rangs totaux)"}}}},{}],280:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=u(e("./it")),i=u(e("./en")),a=u(e("./fi")),o=u(e("./se")),s=u(e("./fr")),l=u(e("./de")),e=u(e("./ro"));function u(e){return e&&e.__esModule?e:{default:e}}r={it:r.default,en:i.default,fi:a.default,se:o.default,fr:s.default,de:l.default,ro:e.default};n.default=r},{"./de":276,"./en":277,"./fi":278,"./fr":279,"./it":281,"./ro":282,"./se":283}],281:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default={translation:{error_page:{error:"Errore di connessione",at_moment:"Al momento non  possibile caricare la mappa",f5:"Premi Ctrl+F5"},cookie_law:{message:"Questo sito utilizza i cookie per garantire una buona usabilit all'utilizzatore finale.",buttonText:"Ho capito!"},default:"predefinito",sign_in:"Accedi",layer_selection_filter:{tools:{filter:"Attiva/Disattiva Filtro",nofilter:"Rimuovi filtro",invert:"Inverti Selezione",clear:"Annulla selezione",show_features_on_map:"Mostra features visibili su mappa",savefilter:"Salva Filtro",filterName:"Nome Filtro"}},warning:{not_supported_format:"Formato non supportato"},layer_position:{top:"SOPRA",bottom:"IN FONDO",message:"Posizione rispetto ai layers della TOC"},sdk:{atlas:{template_dialog:{title:"Seleziona Template"}},spatialbookmarks:{title:"Segnalibri Spaziali",helptext:"Posizionati all'estensione del tuo nuovo segnalibro, definisci il nome e clicca Aggiungi",input:{name:"Nome"},sections:{project:{title:"Segnalibri Progetto"},user:{title:"Segnalibri Utente"}}},search:{all:"TUTTE",no_results:"Nessun valore trovato",searching:"Sto cercando ..",error_loading:"Errore nel caricamento valori",layer_not_searchable:"Il layer non  ricercabile",layer_not_querable:"Il layer non  interrogabile",autocomplete:{inputshort:{pre:"Digita almeno",post:"caratteri"}}},print:{no_layers:"Nessun Layer visibile",template:"Template",labels:"Etichette",scale:"Scala",format:"Formato",rotation:"Rotazione",download_image:"Scarica Immagine",fids_instruction:"Valori accettati: da 1 al valore massimo indicato da [max]. Possibile indicare anche range di valori es. 4-6",fids_example:"Es. 1,4-6 verranno stampati gli id 1,4,5,6",help:"I layers mostrati nella stampa potrebbero essere quelli definiti sul progetto e non quelli visualizzati sulla mappa"},querybuilder:{search:{run:"Lancia ricerca",info:"Informazioni",delete:"Cancella",edit:"Modifica"},messages:{changed:"Salvato correttamente",number_of_features:"Numero di features"},panel:{button:{all:"TUTTI",save:"SALVA",test:"TEST",clear:"PULISCI",run:"ESEGUI",manual:"MANUALE"},layers:"LAYERS",fields:"CAMPI",values:"VALORI",operators:"OPERATORI",expression:"ESPRESSIONE"},error_run:"Si  verificato un errore. Verificare se la query  corretta",error_test:"Errore nell'esecuzione della query",delete:"Vuoi confermare la cancellazione?",additem:"Inserisci nome della ricerca"},errors:{layers:{load:"Alcuni layers presenti nel progetto non sono attualmente disponibili e quindi non compaiono nell'attuale visualizzazione"},unsupported_format:"Formato non supportato",add_external_layer:"Errore nel caricamento del layer"},metadata:{title:"Metadati",groups:{general:{title:"GENERALE",fields:{title:"TITOLO",name:"NOME",description:"DESCRIZIONE",abstract:"ABSTRACT",keywords:"LISTA DELLE PAROLE CHIAVE",fees:"CANONI",accessconstraints:"VINCOLI DI ACCESSO",contactinformation:"CONTATTI",subfields:{contactinformation:{contactelectronicmailaddress:"E-mail",personprimary:"Riferimenti",contactvoicetelephone:"Telefono",contactorganization:"Organizzazione",ContactOrganization:"Organizzazione",contactposition:"Posizione",ContactPosition:"Posizione",contactperson:"Persona",ContactPerson:"Persona"}},wms_url:"WMS"}},spatial:{title:"INFO SPAZIALI",fields:{crs:"EPSG",extent:"BBOX"}},layers:{title:"STRATI",groups:{general:"GENERALE",spatial:"INFO SPAZIALI"},fields:{layers:"STRATI",subfields:{crs:"EPSG",bbox:"BBOX",title:"TITOLO",name:"NOME",geometrytype:"GEOMETRIA",source:"SORGENTE",attributes:"ATTRIBUTI",abstract:"ABSTRACT",attribution:"ATTRIBUTION",keywords:"PAROLE CHIAVE",metadataurl:"METADATA URL",dataurl:"DATA URL"}}}}},tooltips:{relations:{form_to_row:"Visualizza formato Riga",row_to_form:"Visualizza formato Form",zoomtogeometry:"Zoom sulla geometria"},zoom_to_features_extent:"Zoom sulle features",copy_map_extent_url:"Copia map view link",download_shapefile:"Scarica Shapefile",download_gpx:"Scarica GPX",download_gpkg:"Scarica GPKG",download_csv:"Scarica CSV",download_xls:"Scarica XLS",show_chart:"Mostra Grafico",atlas:"Stampa Atlas"},mapcontrols:{query:{tooltip:"Interroga Layer",actions:{add_selection:{hint:"Aggiungi/Rimuovi Selezione"},zoom_to_features_extent:{hint:"Zoom sulle features"},add_features_to_results:{hint:"Aggiungi features ai risultati"},remove_feature_from_results:{hint:"Rimuovi feature dai risultati"},zoom_to_feature:{hint:"Zoom sulla feature"},relations:{hint:"Visualizza Relazioni"},relations_charts:{hint:"Visualizza grafici relazioni"},download_features_shapefile:{hint:"Scarica features in Shapefile"},download_shapefile:{hint:"Scarica feature in Shapefile"},download_features_gpx:{hint:"Scarica features in GPX"},download_features_gpkg:{hint:"Scarica features in GPKG"},download_gpx:{hint:"Scarica feature in GPX"},download_gpkg:{hint:"Scarica feature in GPKG"},download_features_csv:{hint:"Scarica features in CSV"},download_csv:{hint:"Scarica feature in CSV"},download_features_xls:{hint:"Scarica features in XLS"},download_xls:{hint:"Scarica la feature in XLS"},atlas:{hint:"Stampa Atlas"},copy_zoom_to_fid_url:{hint:"Copia URL mappa con estensione a questa geometria",hint_change:"Copiato"}}},querybypolygon:{download:{title:"Download attributi",choiches:{feature:{label:"Solo features"},feature_polygon:{label:"Features+Poligono Interrogazione"}}},tooltip:"Interroga per poligono",no_geometry:"Non contiene la geometria nella risposta",help:{title:"Guida - Interrogazione con Poligono",message:"\n                <ul>\n                  <li>Seleziona uno strato poligonale in legenda.</li>\n                  <li>Assicurati che lo strato sia visibile in mappa.</li>\n                  <li>Clicca su una geometria dello strato selezionato.</li>\n                </ul>"}},querybydrawpolygon:{tooltip:"Disegna un poligono per interrogare"},querybybbox:{tooltip:"Interroga per BBOX",nolayers_visible:"Nessun layer interrogabile  visibile. Assicurarsi che almeno un layer wfs sia visibile per eseguire l'interrogazione",help:{title:"Guida - Interrogazione BBox",message:"\n                  <ul>\n                    <li>Disegna un rettangolo per interrogare gli strati evidenziati in giallo</li>\n                  </ul>\n            "}},addlayer:{messages:{csv:{warning:"Il risultato in mappa  parziale a causa della presenza dei seguenti records non corretti:"}},tooltip:"Aggiungi Layer"},geolocation:{tooltip:"Geolocalizzazione"},measures:{length:{tooltip:"Lunghezza",help:"Clicca sulla mappa per continuare a disegnare la linea.<br>CANC se si vuole cancellare l'ultimo vertice inserito"},area:{tooltip:"Area",help:"Clicca per continuare a disegnare il poligono.<br>CANC se si vuole cancellare l'ultimo vertice inserito"}},scale:{no_valid_scale:"Scala non valida"},scaleline:{units:{metric:"Metri",nautical:"Miglio Nautico"}},zoomhistory:{zoom_last:"Zoom Precedente",zoom_next:"Zoom Successivo"}},relations:{relation_data:"Dati Relazione",no_relations_found:"Nessuna relazione trovata",back_to_relations:"Ritorna alle relazioni",list_of_relations_feature:"Lista delle relazioni della feature",error_missing_father_field:"Il campo relazionato non esiste"},form:{loading:"Caricamento ...",inputs:{messages:{errors:{picklayer:"Nessuna feature selezionata. Verificare se il layer  in editing o non visibile alla scala attuale"}},tooltips:{picklayer:"Prendi valore dalla mappa",lonlat:"Clicca sulla mappa per prendere le coordinate"},input_validation_mutually_exclusive:"Campo mutualmente esclusivo con ",input_validation_error:"Campo obbligatorio o tipo valore non corretto",input_validation_min_field:"Valore deve essere magiore uguale a quello del camp ",input_validation_max_field:"Valore deve essere minore uguale a quello del campo ",input_validation_exclude_values:"Campo deve contenere un valore diverso",integer:"intero",bigint:"intero",text:"testuale",varchar:"testuale",textarea:"testuale",string:"stringa",date:"data",datetime:"data",float:"float",table:"table"},footer:{required_fields:"Campi obbligatori"},messages:{qgis_input_widget_relation:"Gestisci le relazioni tramite form dedicato"}},catalog:{current_map_theme_prefix:"TEMA",choose_map_theme:"SCEGLI TEMA",choose_map_theme_input_label:"Nome del nuovo tema",project_map_theme:"Temi Progetto",user_map_theme:"Temi Utente",question_delete_map_theme:"Vuoi cancellare il tema ?",delete_map_theme:"Tema cancellato con successo",saved_map_theme:"Tema salvato con successo",updated_map_theme:"Tema aggiornato con successo",invalid_map_theme_name:"Nome gi esistente o non corretto",menu:{layerposition:"Posizione Layer",setwmsopacity:"Cambia opacit",wms:{title:"",copy:"Clicca qui per copiare url",copied:"Copiato"},download:{unknow:"Scarica",shp:"Scarica Shapefile",gpx:"Scarica GPX",gpkg:"Scarica GPKG",csv:"Scarica CSV",xls:"Scarica XLS",geotiff:"Scarica GEOTIFF",geotiff_map_extent:"Scarica GEOTIFF(estensione vista corrente)"}}},wps:{list_process:"Lista dei processi",tooltip:"Clicca sulla mappa"}},credits:{g3wSuiteFramework:"Applicativo realizzato con il framework OS",g3wSuiteDescription:"Pubblica e gestisci i tuoi progetti QGIS sul Web",productOf:"Framework sviluppato da"},toggle_color_scheme:"Cambia colore",logout:"Esci",no_other_projects:"Non ci sono altri progetti in questo gruppo cartografico",no_other_groups:"Non ci sono altri gruppi in questo Macrogruppo",yes:"Si",no:"No",back:"Indietro",backto:"Torna a ",changemap:"Cambia Mappa",change_session:"Cambia Sessione",component:"Componente Generico",search:"Ricerche",no_results:"Nessun risultato trovato",print:"Stampa",create_print:"Crea Stampa",dosearch:"Cerca",catalog:"Mappa",data:"Dati",externalwms:"WMS",baselayers:"Basi",tools:"Strumenti",tree:"Strati",legend:"Legenda",nobaselayer:"Nessuna mappa di base",street_search:"Cerca indirizzo",show:"Mostra",hide:"Nascondi",copy_form_data:"Copia i dati del modulo",paste_form_data:"Incolla",copy_form_data_from_feature:"Copia i dati dalla mappa",error_map_loading:"Errore di caricamento della nuova mappa",check_internet_connection_or_server_admin:"Controllare la connessione internet o contattare l'amministratore",could_not_load_vector_layers:"Errore di connessione al server: non  stato possibile caricare i vettoriali richiesti",server_saver_error:"Errore nel salvataggio sul server",server_error:"Si  verificato un errore nella richiesta al server",save:"Salva",cancel:"Cancella",update:"Aggiorna",close:"Chiudi",dont_show_again:"Non mostrare pi",enlange_reduce:"Allarga / Riduci",reset_default:"Dimensione predefinita",add:"Aggiungi",exitnosave:"Esci senza salvare",annul:"Annulla",layer_is_added:"Layer con stesso nome gi aggiunto",sidebar:{wms:{panel:{title:"Aggiungi WMS Layer",label:{position:"Posizione su Mappa",name:"Nome",projections:"Sistema di riferimento",layers:"Layers"}},add_wms_layer:"Aggiungi WMS layer",delete_wms_url:"Elimina WMS url",layer_id_already_added:"Questo Layer WMS  gi stato aggiunto",url_already_added:"URL/Nome WMS gi aggiunto",layer_add_error:"WMS Layer non aggiunto. Verificare i parametri o l'url"}},info:{title:"Risultati",list_of_relations:"Lista delle relazioni",open_link:"Apri documento allegato",server_error:"Si  verificato un errore nella richiesta al server",no_results:"Nessun risultato per questa interrogazione/ricerca ",link_button:"Apri"},mapcontrols:{geolocation:{error:"Non  possibile ottenere la tua posizione."},geocoding:{choose_layer:"Scegli un livello in cui aggiungere questa funzionalit",placeholder:"Indirizzo ...",nolayers:"Nessun layer di punti modificabile trovato in questo progetto",noresults:"Nessun risultato",notresponseserver:"Il server non risponde"},add_layer_control:{header:"Aggiungi Layer",select_projection:"Seleziona il sistema di proiezione del layer",select_field_to_show:"Seleziona il campo da visualizzare sulla mappa",select_csv_separator:"Seleziona il separatore",select_csv_x_field:"Seleziona il campo X",select_csv_y_field:"Seleziona il campo Y",select_color:"Seleziona il colore del Layer",drag_layer:"Trascina il layer in questa area"},query:{input_relation:"Clicca per consultare le relazioni"},length:{tooltip:"Lunghezza"},area:{tooltip:"Area"},screenshot:{error:"Errore nella creazione dello screenshot",securityError:'  \n        <p><b>Errore di sicurezza</b>: uno strato esterno impedisce la stampa della mappa. Per verificare, procedere come segue:</p>\n        <ol>\n          <li>rimuovi eventuali layer esterni aggiunti manualmente (es. layer WMS)</li>\n          <li>forza il ricaricamento della pagina: <code>CTRL + F5</code></li>\n          <li>stampa nuovamente la mappa</li>\n        </ol>\n        <p>Per maggiori informazioni contattare l\'amministratore del server in merito a: <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image" style="color: #000 !important;font-weight: bold;">&#x2139;&#xFE0F; security and tainted canvases</a></p>\n        '}},catalog_items:{helptext:"Tasto destro sui singoli layer per accedere alle funzionalit aggiuntive",contextmenu:{zoomtolayer:"Zoom to Layer",open_attribute_table:"Apri tabella attributi",show_metadata:"Metadati",styles:"Stili",vector_color_menu:"Setta/Cambia Colore",layer_opacity:"Trasparenza",filters:"Filtri"}},dataTable:{previous:"Precedente",next:"Successivo",lengthMenu:"Visualizza _MENU_",info:"Visualizzazione _START_ a _END_ su _TOTAL_ righe",nodatafilterd:"Nessun risultato trovato",infoFiltered:"(Filtrati da _MAX_ total righe)"}}}},{}],282:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default={translation:{error_page:{error:"Eroare de conexiune",at_moment:"Momentan nu este posibil s afiai harta",f5:"Apsai Ctrl+F5"},cookie_law:{message:"Acest website foloseste cookie-uri pentru a furniza vizitatorilor o experien mult mai bun de navigare",buttonText:"Am neles!"},default:"Implicit",sign_in:"Logare",layer_selection_filter:{tools:{filter:"Activai/Dezactivai filtrul",nofilter:"Eliminare Filtrare",invert:"Inversare Selecie",clear:"Elimin Selecia",show_features_on_map:"Arat entitile vizibile n cadrul hrii",savefilter:"Salveaz Filtrul",filterName:"Nume Filtru"}},warning:{not_supported_format:"Formatul nu este acceptat"},layer_position:{top:"SUS",bottom:"JOS",message:"Poziie relativ la straturile din TOC"},sdk:{atlas:{template_dialog:{title:"Selectai Template"}},spatialbookmarks:{title:"Marcaje spaiale",helptext:"Deplasai-v pe ntinderea hrii, introducei numele i facei clic pe Adugai",input:{name:"Nume"},sections:{project:{title:"Marcaje de proiect"},user:{title:"Marcaje utilizator"}}},search:{all:"Toate",no_results:"Fr rezultat",searching:"Cutare ...",error_loading:"ncrcarea a euat",layer_not_searchable:"Nu se poate cuta pe strat",layer_not_querable:"Stratul nu se poate interoga",autocomplete:{inputshort:{pre:"Te rog introdu",post:"sau mai multe caractere"}}},print:{no_layers:"Nu avem straturi de print",template:"ablon",labels:"Etichete",scale:"Scar",format:"Format",rotation:"Rotaie",download_image:"Descarc Imaginea",fids_instruction:"Valori acceptate: de la 1 la valoarea [max]. Este posibil inserarea de interval, de ex. 4-6",fids_example:"Ex. 1,4-6 vor fi tiprite id 1,4,5,6",help:"Straturile prezentate n print pot fi acelea definite n proiect i nu acelea prezentate n cadrul hrii"},querybuilder:{search:{run:"Execut",info:"Info",delete:"Elimin",edit:"Modific"},messages:{changed:"Salvat",number_of_features:"Numr de entiti"},panel:{button:{all:"TOATE",save:"SALVEAZ",test:"TEST",clear:"TERGE",run:"RUN",manual:"MANUAL"},layers:"STRATURI",fields:"CMPURI",values:"VALORI",operators:"OPERATORI",expression:"EXPRESII"},error_run:"A survenit o eroare. De verificat interogarea",error_test:"A survenit o eroare n timp ce se executa interogarea",delete:"Vrei s o tergi?",additem:"Introdu numele noii cutri"},errors:{layers:{load:"Cteva straturi nu sunt disponibile"},unsupported_format:"Formatul nu este acceptat",add_external_layer:"Eroare ncrcare strat"},metadata:{title:"Metadate",groups:{general:{title:"GENERALITI",fields:{title:"TITLU",name:"NUME",description:"DESCRIERE",abstract:"ABSTRACT",keywords:"CUVINTE CHEIE",fees:"TAXE",accessconstraints:"CONSTRNGERI DE ACCES",contactinformation:"CONTACTE",subfields:{contactinformation:{contactelectronicmailaddress:"Email",personprimary:"Referine",contactvoicetelephone:"Telefon",contactorganization:"Organizaie",ContactOrganization:"Organizaie",contactposition:"Poziie",ContactPosition:"Poziie",contactperson:"Persoana",ContactPerson:"Persoana"}},wms_url:"WMS"}},spatial:{title:"SPAIAL",fields:{crs:"EPSG",extent:"BBOX"}},layers:{title:"STRATURI",fields:{layers:"STRATURI",subfields:{crs:"EPSG",bbox:"BBOX",title:"TITLU",name:"NUME",geometrytype:"GEOMETRIE",source:"SURSA",attributes:"ATRIBUTE",abstract:"ABSTRACT",attribution:"ATRIBUIRE",keywords:"CUVINTE CHEIE",metadataurl:"URL METADATE",dataurl:"URL DATE"}},groups:{general:"GENERALITI",spatial:"SPAIAL"}}}},tooltips:{relations:{form_to_row:"Vizualizare pe rnduri",row_to_form:"Vizualizare formular",zoomtogeometry:"Mrii la geometrie"},copy_map_extent_url:"Copiaz linkul de vizualizare hart",download_shapefile:"Descarc Shapefile",download_gpx:"Descarc GPX",download_gpkg:"Descarc GPKG",download_csv:"Descarc CSV",download_xls:"Descarc XLS",show_chart:"Arat Diagrama",atlas:"Tiprire Atlas"},mapcontrols:{query:{tooltip:"Interogare strat",actions:{add_selection:{hint:"Adaug/Elimin Selecia"},zoom_to_features_extent:{hint:"Zoom la ncadrarea entitilor"},add_features_to_results:{hint:"Adaug/Elimin entiti rezultat"},remove_feature_from_results:{hint:"Elimin entitate din rezultat"},zoom_to_feature:{hint:"Zoom la entitate"},relations:{hint:"Arat Relaiile"},relations_charts:{hint:"Arat diagrama de relaii"},download_features_shapefile:{hint:"Descarc entiti n Shapefile"},download_shapefile:{hint:"Descarc entitate n Shapefile"},download_features_gpx:{hint:"Descarc entiti n GPX"},download_features_gpkg:{hint:"Descarc entiti n GPKG"},download_gpx:{hint:"Descarc entitate n GPX"},download_gpkg:{hint:"Descarc entitate n GPKG"},download_features_csv:{hint:"Descarc entiti n CSV"},download_csv:{hint:"Descarc entitate n CSV"},download_features_xls:{hint:"Descarc entiti n XLS"},download_xls:{hint:"Descarc entitate n XLS"},atlas:{hint:"Tiprire Atlas"},copy_zoom_to_fid_url:{hint:"Copiaz URL hart cu ntinderea geometriei entitii",hint_change:"Copiat"}}},querybypolygon:{download:{title:"Descrcare atribute",choiches:{feature:{label:"Doar entiti"},feature_polygon:{label:"Entiti+Poligon Interogare"}}},tooltip:"Interogare Dup Poligon",no_geometry:"Nu avem geometrii n rspuns",help:{title:"Ghid - Interogare Dup Poligon",message:"\n                <ul>\n                  <li>Selecteaz un strat poligon din TOC.</li>\n                  <li>Asigur-te c stratul este vizibil.</li>\n                  <li>Click pe o entitate a stratului selectat.</li>\n                </ul>"}},querybydrawpolygon:{tooltip:"Interogare prin poligon de desen"},querybybbox:{tooltip:"Interogare BBox strat",nolayers_visible:"Nu este vizibil niciun strat de interogare. Trebuie setat cel puin un strat WFS vizibil pentru a efectua interogarea",help:{title:"Ghid - Interogare BBox strat",message:"\n                 <ul>\n                  <li>Deseneaz un ptrat pe hart pentru a interoga straturile din TOC de sub </li>\n                 </ul>"}},addlayer:{messages:{csv:{warning:"Rezultateul pe hart este parial datorit prezenei urmtoarei liste de rezultate incorecte:"}},tooltip:"Adaug Strat"},geolocation:{tooltip:"Geolocalizare"},measures:{length:{tooltip:"Lungime",help:"Click pe hart pentru a desena linia. Apas <br>CANC dac doreti s tergi ultimul vertex"},area:{tooltip:"Aria",help:"Click pentru desen poligon. Apas <br>CANC dac doreti s tergi ultimul vertex"}},scale:{no_valid_scale:"Scar Invalid"},scaleline:{units:{metric:"Metri",nautical:"Mile Nautice"}},zoomhistory:{zoom_last:"Zoom Anterior",zoom_next:"Zoom Urmatorul"}},relations:{relation_data:"Date Relaii",no_relations_found:"Nu am gsit nicio relaie",back_to_relations:"napoi la relaii",list_of_relations_feature:"Lista de relaii a entitii",error_missing_father_field:"Cmpul de legtur lipsete"},form:{loading:"Se ncarc ...",inputs:{messages:{errors:{picklayer:"Nu avem entitate selectat. Verific dac stratul este n editare sau vizibil la scara curent if layer is on editing or visible at current scale"}},tooltips:{picklayer:"Ia valoare din strat",lonlat:"Click pe hart pentru a prelua coordonate"},input_validation_mutually_exclusive:"Cmp ce se exclude mutual cu ",input_validation_error:"Cmp mandatoriu sau tip de date greit",input_validation_min_field:"Valoarea trebuie s fie mai mare/egal cu valoare cmpului ",input_validation_max_field:"Valoarea trebuie s fie mai mic/egal cu valoare cmpului ",input_validation_exclude_values:"Valoarea trebuie s fie unic",integer:"integer - nr. ntreg",bigint:"integer - nr. ntreg",text:"text",varchar:"text",textarea:"text",string:"string - text",date:"data",datetime:"data",float:"float - nr. cu zecimale",table:"tabel"},footer:{required_fields:"Cmpuri necesare"},messages:{qgis_input_widget_relation:"Folosete formular specific de relaii pentru a lucra cu relaia"}},catalog:{current_map_theme_prefix:"TEMA",choose_map_theme:"ALEGE TEMA",choose_map_theme_input_label:"Numele noii tema",project_map_theme:"Tema de proiect",user_map_theme:"Tema utilizator",question_delete_map_theme:"Dorii s tergei tema?",delete_map_theme:"Tema a fost tears cu succes",saved_map_theme:"Tema a fost salvat cu succes",updated_map_theme:"Tema a fost actualizat cu succes",invalid_map_theme_name:"Numele exist deja sau este incorect",menu:{layerposition:"Poziie Strat",setwmsopacity:"Alege Opacitatea",wms:{title:"Titlu",copy:"Click pentru copiere URL",copied:"Copiat"},download:{unknow:"Descarc",shp:"Descarc Shapefile",gpx:"Descarc GPX",gpkg:"Descarc GPKG",csv:"Descarc CSV",xls:"Descarc XLS",geotiff:"Descarc GEOTIFF",geotiff_map_extent:"Descarc GEOTIFF(ce se vede n cadrul hrii)"}}},wps:{list_process:"Lista de procese",tooltip:"Click pe hart"}},credits:{g3wSuiteFramework:"Aplicaie bazat pe frameworkul",g3wSuiteDescription:"Public i administreaz proiectele de QGIS pe WEB",productOf:"Framework dezvoltat de"},toggle_color_scheme:"Comutare schem de culori",logout:"Deconectare",no_other_projects:"No more project for this group",no_other_groups:"Nu mai sunt grupuri pentru acest macrogrup",yes:"Da",no:"Nu",back:"napoi",backto:"napoi la ",changemap:"Schimbare Hart",change_session:"Schimbai sesiunea",component:"Component Generic",search:"Cutare",no_results:"Niciun rezultat gsit",print:"Tiprire",create_print:"Tiprete",dosearch:"Caut",catalog:"Hart",data:"Data",externalwms:"WMS",baselayers:"Straturi Baz",tools:"Instrumente",tree:"Straturi",legend:"Legend",nobaselayer:"Fr strat de baz",street_search:"Caut Adres",show:"Arat",hide:"Ascunde",copy_form_data:"Copiaz data",paste_form_data:"Lipete",copy_form_data_from_feature:"Copiaz data din hart",error_map_loading:"Sunt erori la ncrcarea hrii",check_internet_connection_or_server_admin:"Verificai conexiune de internet sau contactai administratorul de sistem",could_not_load_vector_layers:"Eroare de conexiune: Straturile nu pot fi ncrcate",server_saver_error:"Eroare la salvarea pe server",server_error:"Eroare de conexiune la server",save:"Salveaz",cancel:"Anuleaz",update:"Actualizai",close:"nchide",dont_show_again:"Nu mai afia mesajul",enlange_reduce:"Mrete / Micoreaz",reset_default:"Mrimea implicit",add:"Adaug",exitnosave:"Ieire fr salvare",annul:"Anuleaz",layer_is_added:"Exist un strat cu acelai nume deja adugat",sidebar:{wms:{panel:{title:"Adaug strat WMS",label:{position:"Poziie Hart",name:"Nume",projections:"Proiecie",layers:"Straturi"}},add_wms_layer:"Adaug strat WMS",delete_wms_url:"terge URL WMS",layer_id_already_added:"Strat WMS deja adugat",url_already_added:"URL WMS/Nume deja adugat",layer_add_error:"Stratul WMS nu s-a adugat. Verificai URL-ul sau parametrii WMS"}},info:{title:"Rezultate",list_of_relations:"List of Relations",open_link:"Deschide document ataat",server_error:"Serverul a ntmpinat o eroare",no_results:"Niciun rezultat",link_button:"Deschide"},mapcontrols:{geolocation:{error:"Nu te-am putut localiza"},geocoding:{choose_layer:"Alegei un strat unde s adugai aceast caracteristic",placeholder:"Adresa ...",nolayers:"Nu s-au gsit straturi de puncte editabile n acest proiect",noresults:"Niciun rezultat",notresponseserver:"Niciun rspuns de la server"},add_layer_control:{header:"Adugare Strat",select_projection:"Selecteaz proiecia strat",select_field_to_show:"Selecteaz cmpul de artat pe hart",select_csv_separator:"Selecteaz delimitatorul",select_csv_x_field:"Selecteaz cmpul X - Est",select_csv_y_field:"Selecteaz cmpul Y - Nord",select_color:"Selecteaz culoare strat",drag_layer:"Tragei stratul aici (Drag&Drop)"},query:{input_relation:"Click pentru a arta relaiile"},length:{tooltip:"Lungime"},area:{tooltip:"Arie"},screenshot:{error:"Eroare captur ecran",securityError:'  \n        <p><b>Eroare de securitate</b>: un strat extern mpiedic imprimarea hrii. Pentru a verifica, procedai dup cum urmeaz:</p>\n        <ol>\n          <li>eliminai orice straturi externe adugate manual (de exemplu, straturi WMS)</li>\n          <li>forai rencrcarea paginii: <code>CTRL + F5</code></li>\n          <li>tiprete din nou harta</li>\n        </ol>\n        <p>Pentru mai multe informaii, v rugm s contactai administratorul serverului despre: <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image" style="color: #000 !important;font -greutate: bold;">&#x2139;&#xFE0F; securitate i pnze contaminate</a></p>\n        '}},catalog_items:{helptext:"Click dreapta pe strat pentru a accesa opiuni",contextmenu:{zoomtolayer:"Zoom pe Strat",open_attribute_table:"Deschide Tabela Atribute",show_metadata:"Metadate",styles:"Stiluri",vector_color_menu:"Seteaz/Schimb Culoare",layer_opacity:"Opacitate",filters:"Filters"}},dataTable:{previous:"Anteriorul",next:"Urmtorul",lengthMenu:"Arat _MENU_",info:"Arat _START_ pn la _END_ din _TOTAL_ de intrri",no_data:"Fr date",nodatafilterd:"Niciun rezultat",infoFiltered:"(filtrat din _MAX_ de rezultate totale)"}}}},{}],283:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default={translation:{error_page:{error:"Anslutningsfel",at_moment:"Fr nrvarande r det inte mjligt att visa kartan",f5:"Tryck p Ctrl+F5"},cookie_law:{message:"Denna applikation anvnder cookies fr att den ska fungera s bra som mjligt fr dig.",buttonText:"Jag accepterar"},default:"standard",sign_in:"Logga in",layer_selection_filter:{tools:{filter:"Aktivera/inaktivera filter",nofilter:"Avlgsna Filtrera",invert:"Invertera Urval",clear:"Annullera Urval",show_features_on_map:"Visa funktioner som r synliga p kartan",savefilter:"Spara Filter",filterName:"Filternamn"}},warning:{not_supported_format:"Formatet stds inte"},layer_position:{top:"verst",bottom:"Underst",message:"Position relativt till lager i lagerlistan"},sdk:{atlas:{template_dialog:{title:"Vlj Template"}},spatialbookmarks:{title:"Rumsliga bokmrken",helptext:"Flytta p kartans omfattning, ange namn och klicka p Lgg till",input:{name:"Namn"},sections:{project:{title:"Projektbokmrken"},user:{title:"Anvndarbokmrken"}}},search:{all:"ALLA",no_results:"Inga resultat",searching:"Skning ...",error_loading:"Fel vid laddning av uppgifter.",layer_not_searchable:"Nivn kan inte skas.",layer_not_querable:"Frfrgningar kan inte gras p nivn.",autocomplete:{inputshort:{pre:"Mata in",post:"eller flera tecken"}}},print:{no_layers:"Inga niver att skriva ut",template:"Template",labels:"Labels",scale:"Skala",format:"Format",rotation:"Rotation",download_image:"Ladda ner bild",fids_instruction:"Godknda vrden: Frn ett till vrdet [max]. Mellanslag tillts, t.ex. 4-6.",fids_example:"Exempelvis 1,4-6 skriver ut id 1,4,5,6.",help:"Niverna p utskriften kan vara specificerade i ett projekt inte sdana som visas p karta."},querybuilder:{search:{run:"Utfr",info:"Information",delete:"Ta bort",edit:"Redigera"},messages:{changed:"Sparat",number_of_features:"Antal funktione"},panel:{button:{all:"ALLA",save:"SPARA",test:"TEST",clear:"TM",run:"UTFR",manual:"MANUELL"},layers:"NIVER",fields:"FLT",values:"VRDEN",operators:"OPERATRER",expression:"KLAUSUL"},error_run:"Ett fel intrffade. Kontrollera frfrgan.",error_test:"Ett fel intrffade nr frfrgan utfrdes.",delete:"Vill du ta bort den?",additem:"Ge den nya skningen ett namn."},errors:{layers:{load:"Vissa niver r inte tillgngliga."},unsupported_format:"Formatet stds inte",add_external_layer:"Fel vid laddning av nivn"},metadata:{title:"Metadata",groups:{general:{title:"ALLMN",fields:{title:"RUBRIK",name:"NAMN",description:"BESKRIVNING",abstract:"SAMMANDRAG",keywords:"NYCKELORD",fees:"AVGIFTER",accessconstraints:"TKOMSTBEGRNSNINGAR",contactinformation:"KONTAKTUPPGIFTER",subfields:{contactinformation:{contactelectronicmailaddress:"E-post",personprimary:"Referenser",contactvoicetelephone:"Telefon",contactorganization:"Organisation",ContactOrganization:"Organisation",contactposition:"Stllning",ContactPosition:"Stllning",contactperson:"Kontaktperson",ContactPerson:"Kontaktperson"}},wms_url:"WMS"}},spatial:{title:"SPATIAL",fields:{crs:"EPSG",extent:"BBOX"}},layers:{title:"NIVER",fields:{layers:"NIVER",subfields:{crs:"EPSG",bbox:"BBOX",title:"RUBRIK",name:"NAMN",geometrytype:"GEOMETRI",source:"KLLA",attributes:"ATTRIBUT",abstract:"SAMMANDRAG",attribution:"TILLSKRIVNING",keywords:"NYCKELORD",metadataurl:"METADATA URL",dataurl:"DATA URL"}},groups:{general:"ALLMN",spatial:"SPATIAL"}}}},tooltips:{relations:{form_to_row:"Radvy",row_to_form:"Tabellvy",zoomtogeometry:"Zooma till geometri"},copy_map_extent_url:"Kopiera lnk till karta",download_shapefile:"Ladda SHP-fil",download_gpx:"Ladda GPX-fil",download_gpkg:"Ladda GPKG-fil",download_csv:"Ladda CSV-fil",download_xls:"Ladda XLS-fil",show_chart:"Visa diagram",atlas:"Skriv ut Atlas"},mapcontrols:{query:{tooltip:"Frfrgningsniv",actions:{add_selection:{hint:"Lgg till/Avlgsna Urval"},zoom_to_features_extent:{hint:"Zooma till egenskapens omfattning"},add_features_to_results:{hint:"Add/Remove features to results"},remove_feature_from_results:{hint:"Remove feature from results"},zoom_to_feature:{hint:"Zooma till egenskapen"},relations:{hint:"Visa relationerna"},relations_charts:{hint:"Visa relationsdiagrammet"},download_features_shapefile:{hint:"Ladda egenskapens SHP-fil"},download_shapefile:{hint:"Ladda egenskapens SHP-fil"},download_features_gpx:{hint:"Ladda egenskapens GPX-fil"},download_features_gpkg:{hint:"Ladda egenskapens GPKG-fil"},download_gpx:{hint:"Ladda egenskapens GPX-fil"},download_gpkg:{hint:"Ladda egenskapens GPKG-fil"},download_features_csv:{hint:"Ladda egenskapens CSV-fil"},download_csv:{hint:"Ladda egenskapens CSV-fil"},download_features_xls:{hint:"Ladda egenskapens XLS-fil"},download_xls:{hint:"Ladda egenskapens XLS-fil"},atlas:{hint:"Skriv ut Atlas"},copy_zoom_to_fid_url:{hint:"Copy map URL with this geometry feature extension",hint_change:"Copied"}}},querybypolygon:{download:{title:"Attributes download",choiches:{feature:{label:"Features only"},feature_polygon:{label:"Features+Query Polygon"}}},tooltip:"Frfrgan med polygon",no_geometry:"No geometry on response",help:{title:"Ohje - Frfrgan med polygon",message:"\n                <ul>\n                  <li>Vlj polygonniv i listan.</li>\n                  <li>Kontrollera att nivn r synlig.</li>\n                  <li>Vlj egenskap p nskad niv.</li>\n                </ul>"}},querybydrawpolygon:{tooltip:"Frga efter ritpolygon"},querybybbox:{tooltip:"BBox-frfrgan som riktar sig till en niv",nolayers_visible:"Inga niver som frfrgningar kan riktas till. Gr minst en WFS-niv synlig fr att kunna utfra skningen.",help:{title:"Ohje - BBox-frfrgan som riktar sig till nivn",message:"\n                 <ul>\n                  <li>Rita upp en rektangel p kartan fr att utfra frfrgan p de i listan understreckade niverna.</li>\n                 </ul>"}},addlayer:{messages:{csv:{warning:"The result in the map is partial due to the presence of the below incorrect records list:"}},tooltip:"Lgg till niv"},geolocation:{tooltip:"Geografiskt lge"},measures:{length:{tooltip:"Lngd",help:"Rita upp en bruten linje p kartan. Tryck <br>CANC, om du vill ta bort fregende punkt."},area:{tooltip:"Omrde",help:"Rita upp en polygon p kartan. Tryck <br>CANC, om du vill ta bort fregende punkt."}},scale:{no_valid_scale:"Fel skala"},scaleline:{units:{metric:"Meters",nautical:"Nautical Mile"}},zoomhistory:{zoom_last:"Zoom Fregende",zoom_next:"Zoom Nsta"}},relations:{relation_data:"Relationsuppgifter",no_relations_found:"Inga relationer hittades.",back_to_relations:"Tillbaka till relationerna",list_of_relations_feature:"Lista p egenskapens relationer",error_missing_father_field:"Flt saknas"},form:{loading:"Laddning...",inputs:{messages:{errors:{picklayer:"Inga egenskaper har valts. Kontroller att nivn kan redigeras eller att den syns med nuvarande skala."}},tooltips:{picklayer:"Vlj vrde p kartniv",lonlat:"Click on map to get coordinates"},input_validation_mutually_exclusive:"Flten utesluter varandra.",input_validation_error:"Obligatoriskt flt eller fel datatyp.",input_validation_min_field:"Vrdet ska vara strre eller lika stort som vrdet i fltet.",input_validation_max_field:"Vrdet ska vara mindre eller lika stort som vrdet i fltet.",input_validation_exclude_values:"Vrdet ska vara unikt.",integer:"heltal",bigint:"heltal",text:"text",varchar:"text",textarea:"text",string:"teckenstrng",date:"datum",datetime:"datum",float:"flyttal",table:"tabell"},footer:{required_fields:"Obligatoriska flt"},messages:{qgis_input_widget_relation:"Anvnd den specifika funktinen fr att bestmma relationer"}},catalog:{current_map_theme_prefix:"THEME",choose_map_theme:"CHOOSE THEME",choose_map_theme_input_label:"Namn p det nya temat",project_map_theme:"Temat de proiect",user_map_theme:"Temat utilizator",question_delete_map_theme:"Vill du ta bort temat?",delete_map_theme:"Temat har tagits bort",saved_map_theme:"Temat har sparats",updated_map_theme:"Temat har uppdaterats",invalid_map_theme_name:"Namnet finns redan eller r felaktigt",menu:{layerposition:"Lagerposition",setwmsopacity:"Stll in Opacitet",wms:{title:"",copy:"Tryck hr fr att kopiera url.",copied:"Kopierad."},download:{unknow:"Ladda",shp:"Ladda SHP-fil",gpx:"Ladda GPX-fil",gpkg:"Ladda GPKG-fil",csv:"Ladda CSV-fil",xls:"Ladda XLS-fil",geotiff:"Ladda GEOTIFF-fil",geotiff_map_extent:"Ladda GEOTIFF-fil(current view extent)"}}},wps:{list_process:"Lista p processer",tooltip:"Vlj p kartan"}},credits:{g3wSuiteFramework:"Tillmpningen baserar p OS framework",g3wSuiteDescription:"Publicera och hantera QGIS-projekt p ntet.",productOf:"Framework har utvecklats av"},toggle_color_scheme:"Toggle color scheme",logout:"Logga ut",no_other_projects:"Inga projekt fr denna grupp",no_other_groups:"Inga fler grupper fr denna makrogrupp",yes:"Ja",no:"Nej",back:"G tillbaka",backto:"Tillbaka ",changemap:"Byt karta",change_session:"ndra session",component:"Allmn komponent",search:"Sk",no_results:"Inga skresultat",print:"Skriv ut",create_print:"Skapa utskrift",dosearch:"Sk",catalog:"Karta",data:"Data",externalwms:"WMS",baselayers:"Bakgrundskarta",tools:"Verktyg",tree:"Niver",legend:"Frklaring till beteckningarna",nobaselayer:"Ingen bakgrundskarta",street_search:"Sk adress",show:"Visa",hide:"Dlj",copy_form_data:"Kopiera uppgifterna",paste_form_data:"Infoga",copy_form_data_from_feature:"Kopiera uppgifter frn kartan",error_map_loading:"Fel vid laddning av kartan",check_internet_connection_or_server_admin:"Kontrollera internetanslutningen eller kontakta administratren.",could_not_load_vector_layers:"Fel i anslutningen, niver kan inte laddas.",server_saver_error:"Fel vid lagring p servern.",server_error:"Fel p anslutningen till servern",save:"Spara",cancel:"nga",update:"Uppdatering",close:"Stng",dont_show_again:"Visa inte det hr meddelandet igen",enlange_reduce:"Frstora / Frminska",reset_default:"Standardstorlek",add:"Lgg till",exitnosave:"Lmna programmet utan att spara",annul:"ngra",layer_is_added:"Lagret med samma namn har redan lagts till.",sidebar:{wms:{panel:{title:"Add WMS Layer",label:{position:"Map Position",name:"Name",projections:"Projection",layers:"Layers"}},add_wms_layer:"Aggiungi WMS layer",delete_wms_url:"Delete WMS url",layer_id_already_added:"WMS Nivn har redan lagts till.",url_already_added:"WMS URL/Namn har redan lagts till.",layer_add_error:"WMS Layer not added. Please check all wms parameter or url"}},info:{title:"Resultat",list_of_relations:"List of Relations",open_link:"ppna filbilaga",server_error:"Ett fel uppstod p servern.",no_results:"Inga resultat fr skningen/frfrgan.",link_button:"ppna"},mapcontrols:{geolocation:{error:"Du kan inte lokaliseras"},geocoding:{choose_layer:"Vlj ett lager dr du vill lgga till denna funktion",placeholder:"Adress ...",nolayers:"Inga redigerbara punktlager hittades i det hr projektet",noresults:"Inga resultat",notresponseserver:"Inget svar frn servern"},add_layer_control:{header:"Lgg till niv",select_projection:"Vlj projektion fr nivn",select_field_to_show:"Select Field to show on map",select_csv_separator:"Select delimiter",select_csv_x_field:"Select X field",select_csv_y_field:"Select Y field",select_color:"Vlj frg p nivn",drag_layer:"Dra och slpp nivn hit"},query:{input_relation:"Tryck fr att visa relationerna"},length:{tooltip:"Lngd"},area:{tooltip:"Areal"},screenshot:{error:"Screenshot error creation",securityError:'  \n        <p><b>Skerhetsfel</b>: ett externt lager hindrar kartan frn att skrivas ut. Gr s hr fr att kontrollera:</p>\n        <ol>\n          <li>ta bort alla manuellt tillagda externa lager (t.ex. WMS-lager)</li>\n          <li>tvinga om inlsning av sidan: <code>CTRL + F5</code></li>\n          <li>skriv ut kartan igen</li>\n        </ol>\n        <p>Fr mer information kontakta serveradministratren om: <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image" style="color: #000 !important;font -vikt: fet;">&#x2139;&#xFE0F; skerhet och nedsmutsade dukar</a></p>\n        '}},catalog_items:{helptext:"Hgerklicka p en enskild niv fr att komma till tillggsegenskaperna.",contextmenu:{zoomtolayer:"Zooma till niv",open_attribute_table:"ppna attributtabellen",show_metadata:"Metadata",styles:"Stilar",vector_color_menu:"Stll in/ndra frg",layer_opacity:"Opacitet",filters:"Filters"}},dataTable:{previous:"Fregende",next:"Nsta",lengthMenu:"Show _MENU_ items",info:"Showing _START_ to _END_ of _TOTAL_ entries",no_data:"Inga uppgifter",nodatafilterd:"Inga motsvarande poster hittades",infoFiltered:"(filtered from _MAX_ total records)"}}}},{}],284:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,e=e("store/catalog-layers"),i=(e=e)&&e.__esModule?e:{default:e};function a(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}n.default={methods:{autocompleteRequest:(r=a(function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layerId,n=e.field,e=e.value,r=[],t=i.default.getLayerById(t);try{r=yield t.getFilterData({suggest:n+"|"+e,unique:n})}catch(e){}return r.map(function(e){return{id:e,text:e}})}),function(){return r.apply(this,arguments)})}}},{"store/catalog-layers":311}],285:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default={computed:{tabIndex:function(){return this.editable?0:-1},notvalid:function(){return!1===this.state.validate.valid},editable:function(){return this.state.editable},showhelpicon:function(){return this.state.help&&this.state.help.message.trim()},disabled:function(){return!this.editable||["loading","error"].includes(this.loadingState)},loadingState:function(){return this.state.input.options.loading?this.state.input.options.loading.state:null}},methods:{setLoading:function(e){this.state.input.options.loading.state=e?"loading":"ready"},showHideHelp:function(){this.state.help.visible=!this.state.help.visible},mobileChange:function(e){this.state.value=e.target.value,this.change()},change:function(){this.service.setEmpty(),this.service.setUpdate(),this.service.validate(),this.$emit("changeinput",this.state)},isVisible:function(){}}}},{}],286:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default={created:function(){this.__CLICK_EVENT={count:0,timeoutID:null}},methods:{handleClick:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=arguments[1];this.__CLICK_EVENT&&(this.__CLICK_EVENT.count+=1,this.__CLICK_EVENT.timeoutID||(this.__CLICK_EVENT.timeoutID=setTimeout(function(){void 0!==t[e.__CLICK_EVENT.count]&&t[e.__CLICK_EVENT.count].call(n),e.__resetClickMixin()},300)))},__resetClickMixin:function(){this.__CLICK_EVENT.count=0,this.__CLICK_EVENT.timeoutID=null},__clearClickMixin:function(){this.__resetClickMixin(),this.__CLICK_EVENT=null}},beforeDestroy:function(){this.__clearClickMixin()}}},{}],287:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default={methods:{getFieldService:function(){return void 0===this._fieldsService&&(this._fieldsService=e("gui/fields/fieldsservice")),this._fieldsService},getFieldType:function(e){return this.getFieldService().getType(e)},isSimple:function(e){return this.getFieldService().isSimple(e)},isLink:function(e){return this.getFieldService().isLink(e)},isImage:function(e){return this.getFieldService().isImage(e)},isPhoto:function(e){return this.getFieldService().isPhoto(e)},isVue:function(e){return this.getFieldService().isVue(e)},sanitizeFieldValue:function(e){return Array.isArray(e)&&!e.length?"":e}}}},{"gui/fields/fieldsservice":81}],288:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default={data:function(){return{valid:!1}},methods:{addToValidate:function(e){this.tovalidate.push(e)},changeInput:function(e){this.isValid(e)},isValid:function(e){var t,n=this;if(e)if(e.validate.mutually){if(!e.validate.required)if(e.validate.empty){e.value=null,e.validate.mutually_valid=!0,e.validate.valid=!0,e.validate._valid=!0;for(var r=[],i=e.validate.mutually.length;i--;){var a=e.validate.mutually[i];this.tovalidate[a].validate.empty||r.push(a)}r.length<2&&r.forEach(function(e){n.tovalidate[e].validate.mutually_valid=!0,n.tovalidate[e].validate.valid=!0,setTimeout(function(){n.tovalidate[e].validate.valid=n.tovalidate[e].validate._valid,n.state.valid=n.state.valid&&n.tovalidate[e].validate.valid})})}else e.validate._valid=e.validate.valid,e.validate.mutually_valid=e.validate.mutually.reduce(function(e,t){return e&&n.tovalidate[t].validate.empty},!0),e.validate.valid=e.validate.mutually_valid&&e.validate.valid}else e.validate.empty||!e.validate.min_field&&!e.validate.max_field||(t=e.validate.min_field||e.validate.max_field,e.validate.valid=e.validate.min_field?this.tovalidate[e.validate.min_field].validate.empty||+e.value>+this.tovalidate[e.validate.min_field].value:this.tovalidate[e.validate.max_field].validate.empty||+e.value<+this.tovalidate[e.validate.max_field].value,e.validate.valid&&(this.tovalidate[t].validate.valid=!0));this.valid=Object.values(this.tovalidate).reduce(function(e,t){return e&&t.validate.valid},!0)}},created:function(){this.tovalidate=[]},destroyed:function(){this.tovalidate=null}}},{}],289:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=e("services/gui"),i=(e=e)&&e.__esModule?e:{default:e};n.default={methods:{showLayer:function(){this.visible=!this.visible,this.layer.setVisible(this.visible)}},created:function(){var e=this.data,t=i.default.getService("map"),n=t.getProjection().getCode(),r=void 0;switch(e.type){case"Point":case"MultiPoint":r=[new ol.style.Style({image:new ol.style.Circle({radius:6,fill:new ol.style.Fill({color:[255,255,255,1]}),stroke:new ol.style.Stroke({color:[0,0,0,1],width:2})})}),new ol.style.Style({image:new ol.style.Circle({radius:2,fill:new ol.style.Fill({color:[255,255,255,1]}),stroke:new ol.style.Stroke({color:[0,0,0,1],width:2})})})];break;case"Line":case"MultiLineString":case"Polygon":case"MultiPolygon":r=new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.3)"}),stroke:new ol.style.Stroke({color:[0,0,0,1],width:2})})}this.layer=new ol.layer.Vector({source:new ol.source.Vector({features:(new ol.format.GeoJSON).readFeatures(e,{featureProjection:n})}),visible:!!this.visible,style:r}),t.getMap().addLayer(this.layer)},beforeDestroy:function(){i.default.getService("map").getMap().removeLayer(this.layer)}}},{"services/gui":302}],290:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.mixins=n.autocompleteMixin=n.baseInputMixin=n.metadataMixin=n.widgetMixins=n.formInputsMixins=n.select2Mixin=n.selectMixin=n.resizeMixin=n.geoMixin=n.mediaMixin=n.fieldsMixin=void 0;var r=f(e("mixins/autocomplete")),i=f(e("mixins/fields")),a=f(e("mixins/media")),o=f(e("mixins/geo")),s=f(e("mixins/resize")),l=f(e("mixins/select")),u=f(e("mixins/select2")),c=f(e("mixins/form-inputs")),d=f(e("mixins/widget")),p=f(e("mixins/metadata")),e=f(e("mixins/base-input"));function f(e){return e&&e.__esModule?e:{default:e}}var h={autocompleteMixin:r.default,fieldsMixin:i.default,mediaMixin:a.default,geoMixin:o.default,resizeMixin:s.default,selectMixin:l.default,select2Mixin:u.default,formInputsMixins:c.default,widgetMixins:d.default,metadataMixin:p.default,baseInputMixin:e.default};n.fieldsMixin=i.default,n.mediaMixin=a.default,n.geoMixin=o.default,n.resizeMixin=s.default,n.selectMixin=l.default,n.select2Mixin=u.default,n.formInputsMixins=c.default,n.widgetMixins=d.default,n.metadataMixin=p.default,n.baseInputMixin=e.default,n.autocompleteMixin=r.default,n.mixins=h,n.default=h},{"mixins/autocomplete":284,"mixins/base-input":285,"mixins/fields":287,"mixins/form-inputs":288,"mixins/geo":289,"mixins/media":291,"mixins/metadata":292,"mixins/resize":293,"mixins/select":294,"mixins/select2":295,"mixins/widget":296}],291:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.default={computed:{filename:function(){return this.value&&this.value.split("/").pop()}},methods:{isMedia:function(e){return!(!e||"object"!==(void 0===e?"undefined":r(e))||e.constructor!==Object||!e.mime_type)},getMediaType:function(e){var t={type:null,options:{}};switch(e){case"image/gif":case"image/png":case"image/jpeg":case"image/bmp":t.type="image";break;case"application/pdf":t.type="pdf";break;case"video/mp4":case"video/ogg":case"video/x-ms-wmv":case"video/x-msvideo":case"video/quicktime":t.type="video",t.options.format=e;break;case"application/gzip":case"application/zip":t.type="zip";break;case"application/msword":case"application/vnd.oasis.opendocument.text":t.type="text";break;case"application/vnd.ms-office":case"application/vnd.oasis.opendocument.spreadsheet":t.type="excel";break;case"application/vnd.openxmlformats-officedocument.presentationml.presentation":case"application/vnd.ms-powerpoint":case"application/vnd.oasis.opendocument.presentation":t.type="ppt";break;default:t.type="unknow"}return t}}}},{}],292:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default={methods:{findAttributeFormMetadataAttribute:function(e){return!!this.state.metadata&&void 0!==this.state.metadata[e]},findMetadataAttribute:function(e){return void 0!==this.state[e]}}}},{}],293:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("services/gui"),i=(r=r)&&r.__esModule?r:{default:r};function a(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var o,r=e("utils"),s={throttle:r.throttle,debounce:r.debounce};n.default={created:function(){var e=this.delayType&&s[this.delayType]||s.throttle;this.delayResize=this.resize?e(this.resize.bind(this),this.delayTime):null,i.default.on("resize",this.delayResize)},mounted:(o=a(function*(){yield this.$nextTick(),this.resize&&this.resize()}),function(){return o.apply(this,arguments)}),beforeDestroy:function(){i.default.off("resize",this.delayResize),this.delayResize=null,this.delayTime=null}}},{"services/gui":302,utils:404}],294:[function(e,t,n){function r(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0});var i,a,o=e("core/i18n/i18n.service").getAppLanguage;n.default={methods:{getLanguage:function(){return o()},changeSelect:(a=r(function*(e){this.state.value="null"===e?null:e,yield this.$nextTick(),this.change()}),function(e){return a.apply(this,arguments)}),getValue:function(e){return null===e?"null":e},resetValues:function(){this.state.input.options.values.splice(0)}},computed:{autocomplete:function(){return"select_autocomplete"===this.state.input.type&&this.state.input.options.usecompleter}},watch:{notvalid:(i=r(function*(e){yield this.$nextTick(),this.select2&&this.select2.data("select2").$container[e?"addClass":"removeClass"]("input-error-validation")}),function(e){return i.apply(this,arguments)})}}},{"core/i18n/i18n.service":12}],295:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=i(e("store/application-state")),e=i(e("mixins/resize"));function i(e){return e&&e.__esModule?e:{default:e}}n.default={mixins:[e.default],methods:{setValue:function(){this.select2.val(this.state.value).trigger("change")},resize:function(){this.select2&&!r.default.ismobile&&this.select2.select2("close")}},beforeDestroy:function(){this.select2&&(this.select2.select2("destroy"),this.select2.off(),this.select2=null)}}},{"mixins/resize":293,"store/application-state":310}],296:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default={data:function(){return{changed:!1}},methods:{widgetChanged:function(){this.changed=!0,this.change()},stateValueChanged:function(e){}},watch:{"state.value":function(e){this.changed?this.changed=!1:this.stateValueChanged(e)}}}},{}],297:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("utils"),i=r.base,a=r.inherit,o=r.reject;function s(){this._config=null,this._baseUrl=null,this.init=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=$.Deferred();return this._config=e,this._baseUrl=e.urls.api,this._apiEndpoints=e.urls.apiEndpoints,t.resolve(),t.promise()};var e=0;this._incrementLoaders=function(){0===e&&this.emit("apiquerystart"),e+=1},this._decrementLoaders=function(){0===--e&&this.emit("apiqueryend")},this.get=function(t,e){var n=this,r=this._apiEndpoints[t];return r?(r=this._baseUrl+"/"+r+(e.request?"/"+e.request:""),this.emit(t+"querystart"),this._incrementLoaders(),$.get(r,e.params||{}).done(function(e){return n.emit(t+"queryend",e),e}).fail(function(e){return n.emit(t+"queryfail",e),e}).always(function(){return n._decrementLoaders()})):o()},i(this)}a(s,e("core/g3wobject")),n.default=new s},{"core/g3wobject":11,utils:404}],298:[function(i,e,t){Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=n(i("config")),s=i("app/constant"),l=n(i("store/application-state")),u=n(i("services/data")),c=n(i("store/plugins")),d=n(i("store/projects")),p=n(i("services/api")),f=n(i("services/clipboard")),h=n(i("services/router")),g=n(i("services/gui"));function n(e){return e&&e.__esModule?e:{default:e}}function v(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}function r(){var t,n,r=this;this.version=s.APP_VERSION,l.default.iframe=window.top!==window.self,l.default.online=navigator.onLine,l.default.ismobile=isMobile.any,this.complete=!1,this.baseurl="/",this.download_caller_id=null,this._applicationServices={},this.config={},this._initConfigUrl=null,this._initConfig=null,this._groupId=null,this._gid=null,this.setters={changeProject:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.gid,e=e.host;return this._changeProject({gid:t,host:e})},changeMapProject:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.url,e=e.epsg,t=g.default.getService("map").addMapExtentUrlParameterToUrl(t,e);history.replaceState(null,null,t),location.replace(t)},online:function(){this.setOnline()},offline:function(){this.setOffline()},setFilterToken:function(e){this._setFilterToken(e)}},b(this),this.on("initconfig",function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).user;r.setApplicationUser(e)}),this.init=v(function*(){try{var t=yield this.createApplicationConfig();return this.setConfig(t),this.setLayout("app",t.layout),yield this.bootstrap()}catch(e){var n=navigator&&navigator.language||"en",t=o.default.supportedLanguages.find(function(e){return-1!==n.indexOf(e)});return Promise.reject({error:e,language:t})}}),this.setupI18n=function(){var t=this;this._config._i18n.appLanguages=(this._config.i18n||[]).map(function(e){return e[0]}),this.setApplicationLanguage(this._config._i18n.language),y(this._config._i18n),this._groupId=this._config.group.slug||this._config.group.name.replace(/\s+/g,"-").toLowerCase(),$.ajaxSetup({beforeSend:function(e){e.setRequestHeader("Accept-Language",t._config.user.i18n||"en")}})},this.getCurrentProject=function(){return d.default.getCurrentProject()},this.setDownload=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return l.default.download=e,this.download_caller_id=t?null:S(),this.download_caller_id},this.getDownload=function(){return l.default.download},this.loadingPlugin=function(e){l.default.plugins.push(e)},this.loadedPlugin=function(t){l.default.plugins=l.default.plugins.filter(function(e){return t!==e})},this._setFilterToken=function(e){l.default.tokens.filtertoken=e},this.getFilterToken=function(){return l.default.tokens.filtertoken},this.changeLanguage=function(e){_(e),l.default.lng=e,l.default.language=e;var t=window.location.pathname.split("/");t[1]=e,history.replaceState(null,null,t.join("/"))},this.registerOnlineOfflineEvent=function(){var e=this;this.registerWindowEvent({evt:"online",cb:function(){return e.online()}}),this.registerWindowEvent({evt:"offline",cb:function(){return e.offline()}})},this.getBaseLayerId=function(){return l.default.baseLayerId},this.setBaseLayerId=function(e){l.default.baseLayerId=e},this.registerLeavePage=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.bool,t=void 0!==t&&t,n=(e.message,t||void 0);window.onbeforeunload=function(e){return n}},this.unregisterOnlineOfflineEvent=function(){window.removeEventListener("online"),window.removeEventListener("offline")},this.getState=function(){return l.default},this.disableApplication=function(){l.default.gui.app.disabled=0<arguments.length&&void 0!==arguments[0]&&arguments[0]},this.setApplicationLanguage=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"en";l.default.lng=e,l.default.language=e},this.getApplicationLanguage=function(){return l.default.language},this.setOnline=function(){l.default.online=!0},this.setOffline=function(){l.default.online=!1},this.isOnline=function(){return l.default.online},this.setOfflineItem=(t=v(function*(e){this.setLocalItem({id:e,data:1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}})}),function(e){return t.apply(this,arguments)}),this.setLocalItem=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,e=e.data;try{window.localStorage.setItem(t,JSON.stringify(e))}catch(e){return e}},this.removeLocalItem=function(e){window.localStorage.removeItem(e)},this.getLocalItem=function(e){e=window.localStorage.getItem(e);return e?JSON.parse(e):void 0},this.getOfflineItem=function(e){return this.getLocalItem(e)},this.removeOfflineItem=function(e){this.removeLocalItem(e)},this.isIframe=function(){return l.default.iframe},this.getConfig=function(){return this._config},this.setConfig=function(){this._config=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}},this.getRouterService=function(){return h.default},this.getProxyUrl=function(){return""+this._initConfig.proxyurl},this.getInterfaceOwsUrl=function(){return""+this._initConfig.interfaceowsurl},this.getClipboardService=function(){return f.default},this.createApplicationConfig=(n=v(function*(e){var t=a({},o.default);try{e=e||(yield this.obtainInitConfig({initConfigUrl:""+o.default.server.urls.initconfig})),this.baseurl=e.baseurl;var n=yield this.getMacrogroupsGroups(),r=n.macrogroups,i=n.groups;return t.server.urls.baseurl=e.baseurl,t.server.urls.frontendurl=e.frontendurl,t.server.urls.staticurl=e.staticurl,t.server.urls.clienturl=e.staticurl+e.client,t.server.urls.mediaurl=e.mediaurl,t.server.urls.vectorurl=e.vectorurl,t.server.urls.proxyurl=e.proxyurl,t.server.urls.rasterurl=e.rasterurl,t.server.urls.interfaceowsurl=e.interfaceowsurl,t.main_map_title=e.main_map_title,t.group=e.group,t.user=e.user,t.credits=e.credits,t.i18n=e.i18n,t._i18n.language=t.user.i18n,t.group.layout.iframe=window.top!==window.self,{apptitle:t.apptitle||"",logo_img:t.group.header_logo_img,logo_link:t.group.header_logo_link,terms_of_use_text:t.group.header_terms_of_use_text,terms_of_use_link:t.group.terms_of_use_link,header_custom_links:t.group.header_custom_links,debug:t.client.debug||!1,group:t.group,urls:t.server.urls,mediaurl:t.server.urls.mediaurl,resourcesurl:t.server.urls.clienturl,vectorurl:t.server.urls.vectorurl,rasterurl:t.server.urls.rasterurl,interfaceowsurl:t.server.urls.interfaceowsurl,projects:t.group.projects,initproject:t.group.initproject,overviewproject:t.group.overviewproject&&t.group.overviewproject.gid?t.group.overviewproject:null,baselayers:t.group.baselayers,mapcontrols:t.group.mapcontrols,background_color:t.group.background_color,crs:t.group.crs,minscale:t.group.minscale,maxscale:t.group.maxscale,main_map_title:t.main_map_title,credits:t.credits,_i18n:t._i18n,i18n:t.i18n,layout:t.group.layout||{},getWmsUrl:function(e){return""+t.server.urls.baseurl+t.server.urls.ows+"/"+t.group.id+"/"+e.type+"/"+e.id+"/"},getProjectConfigUrl:function(e){return""+t.server.urls.baseurl+t.server.urls.config+"/"+t.group.id+"/"+e.type+"/"+e.id+"?_t="+e.modified},plugins:t.group.plugins,tools:t.tools,views:t.views||{},user:t.user||null,groups:i,macrogroups:r}}catch(e){return Promise.reject(e)}}),function(e){return n.apply(this,arguments)}),this.getMacrogroupsGroups=v(function*(){var e=[],t=[];try{e=yield x.get({url:"/"+this.getApplicationUser().i18n+s.API_BASE_URLS.ABOUT.macrogroups})}catch(e){}try{t=yield x.get({url:"/"+this.getApplicationUser().i18n+s.API_BASE_URLS.ABOUT.nomacrogoups})}catch(e){}return{macrogroups:e,groups:t}}),this.obtainInitConfig=v(function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.initConfigUrl,n=e.url,e=e.host,r=(this._initConfigUrl?this.clearInitConfig():this._initConfigUrl=t,this._initConfig=window.initConfig,void 0),t=n?n.split("?")[1]:location.search.substring(1);t?t.split("&").forEach(function(e){r=-1<e.indexOf("project")?e.split("=")[1]:r}):this._gid&&(r=this._groupId+"/"+this._gid.split(":").join("/"));try{r&&(this._initConfig=yield this.getInitConfig(""+(e||"")+this.baseurl+this._initConfigUrl+"/"+r))}catch(e){return Promise.reject(e)}finally{window.initConfig=this._initConfig,this.emit("initconfig",this._initConfig),this.setInitVendorKeys(this._initConfig)}return this._initConfig}),this.getInitConfig=function(e){var r=this;return new Promise(function(t,n){r._initConfig?t(r._initConfig):x.get({url:e}).then(function(e){return t(e)}).catch(function(e){return n(e)})})},this.getInitConfigUrl=function(){return this._initConfigUrl},this.setInitConfigUrl=function(e){this._initConfigUrl=e},this.setEPSGApplication=function(e){l.default.map.epsg=e.state.crs.epsg},this.setApplicationUser=function(e){l.default.user=e},this.getApplicationUser=function(){return l.default.user},this.bootstrap=function(){var i=this;return new Promise(function(t,n){i.setupI18n();var r=setTimeout(function(){n("Timeout")},s.TIMEOUT);l.default.ready||$.when(d.default.init(i._config),p.default.init(i._config)).then(function(){clearTimeout(r),i.registerOnlineOfflineEvent(),i.emit("ready"),l.default.ready=i.initialized=!0;var e=d.default.getCurrentProject();i._gid=e.getGid(),i.setEPSGApplication(e),l.default.iframe&&i.startIFrameService({project:e}),u.default.init(),i.initLocalItems(),t(!0)}).fail(function(e){return n(e)})})},this.postBootstrap=v(function*(){if(!this.complete)try{h.default.init(),yield c.default.init({pluginsBaseUrl:this._config.urls.staticurl,pluginsConfigs:this._config.plugins,otherPluginsConfig:d.default.getCurrentProject().getState()})}catch(e){}finally{this.complete=!0,this.emit("complete")}}),this.startIFrameService=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).project;i("services/iframe").default.init({project:e})},this.registerWindowEvent=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.evt,e=e.cb;window.addEventListener(t,e)},this.unregisterWindowEvent=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.evt,e=e.cb;window.removeEventListener(t,e)},this.registerService=function(e,t){this._applicationServices[e]=t},this.unregisterService=function(e){delete this._applicationServices[e]},this.getApplicationService=function(e){return this._applicationServices[e]},this.getService=function(e){return this._applicationServices[e]},this.errorHandler=function(e){},this.clearInitConfig=function(){window.initConfig=this._initConfig=null},this.setInitVendorKeys=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.group.vendorkeys||{};e.group.baselayers.forEach(function(e){e.apikey&&(t[e.servertype?e.servertype.toLowerCase():null]=e.apikey)}),this.setVendorKeys(t)},this.setVendorKeys=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};Object.keys(t).forEach(function(e){return l.default.keys.vendorkeys[e]=t[e]})},this.changeProjectView=function(e){l.default.changeProjectview=e},this.isProjectViewChanging=function(){return l.default.changeProjectview},this.reloadCurrentProject=function(){return this.changeProject({gid:d.default.getCurrentProject().getGid()})},this._changeProject=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.gid,e=(e.host,e.crs),n=$.Deferred(),t=(this._gid=t,d.default.getProjectUrl(t)),t=g.default.getService("map").addMapExtentUrlParameterToUrl(t,e);try{history.replaceState(null,null,t)}catch(e){}return location.replace(t),n.resolve(),n.promise()},this.setLayout=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"app",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.rightpanel||{width:50,height:50,width_default:50,height_default:50,width_100:!1,height_100:!1};t.rightpanel=Object.assign(n,{width:t.rightpanel.width||n.width,height:t.rightpanel.height||n.width,width_default:t.rightpanel.width||n.width,height_default:t.rightpanel.height||n.width,width_100:!1,height_100:!1}),l.default.gui.layout[e]=t},this.removeLayout=function(e){e&&delete l.default.gui.layout[e]},this.setCurrentLayout=function(){l.default.gui.layout.__current=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"app"},this.getCurrentLayout=function(){return l.default.gui.layout[l.default.gui.layout.__current]},this.getCurrentLayoutName=function(){return l.default.gui.layout.__current},this.cloneLayout=function(){return L(l.default.gui.layout[0<arguments.length&&void 0!==arguments[0]?arguments[0]:"app"])},this.clear=function(){this.unregisterOnlineOfflineEvent()},this.initLocalItems=function(){var t=this;Object.keys(s.LOCAL_ITEM_IDS).forEach(function(e){void 0===t.getLocalItem(e)&&t.setLocalItem({id:e,data:s.LOCAL_ITEM_IDS[e].value})})}}var m=i("core/i18n/i18n.service"),y=m.init,_=m.changeLanguage,m=i("utils"),b=m.base,w=m.inherit,x=m.XHR,S=m.uniqueId,m=i("core/g3wobject"),L=i("lodash.clonedeep");w(r,m),t.default=new r},{"app/constant":5,config:4,"core/g3wobject":11,"core/i18n/i18n.service":12,"lodash.clonedeep":"lodash.clonedeep","services/api":297,"services/clipboard":299,"services/data":300,"services/gui":302,"services/iframe":303,"services/router":306,"store/application-state":310,"store/plugins":316,"store/projects":317,utils:404}],299:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=new function(){this._data={},this.set=function(e,t){e=e.split("form")[0];this._data[e]=t},this.get=function(e){var t=this._data[e]||{};return this._data[e]={},t}}},{}],300:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},h=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e};function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var g=e("app/constant"),i=u(e("store/projects")),v=u(e("services/application")),a=u(e("services/gui")),o=u(e("services/iframe")),s=e("utils/splitContextAndMethod"),m=e("utils/getFeaturesFromResponseVectorApi"),y=e("utils/getQueryLayersPromisesByCoordinates"),_=e("utils/getQueryLayersPromisesByGeometry"),b=e("utils/getQueryLayersPromisesByBBOX"),w=e("utils/getMapLayersByFilter"),x=e("utils/createOlFeatureFromApiResponseFeature"),l=e("utils/resolve"),S=e("utils/XHR");function u(e){return e&&e.__esModule?e:{default:e}}function L(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){if(e)return!t||"object"!=typeof t&&"function"!=typeof t?e:t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}function E(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function T(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var c,d,p,k,M=e("core/i18n/i18n.service").t,P={defaultoutputplaces:["gui"],currentoutputplaces:["gui"],ouputplaces:{gui:(p=T(function*(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};a.default.setLoadingContent(!0);try{a.default.outputDataPlace(e,t),yield e}catch(e){}a.default.setLoadingContent(!1)}),function(e){return p.apply(this,arguments)}),iframe:(d=T(function*(e){o.default.outputDataPlace(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{})}),function(e){return d.apply(this,arguments)})},getData:(c=T(function*(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=(0,s.splitContextAndMethod)(e),r=n.context,n=n.method,r=P.getService(r),i=t.inputs,t=t.outputs,a=void 0===t?{}:t,o=r[n](void 0===i?{}:i);return a&&P.currentoutputplaces.forEach(function(e){return P.ouputplaces[e](o,a)}),yield yield o}),function(e){return c.apply(this,arguments)}),showEmptyOutputs:function(){P.currentoutputplaces.forEach(function(e){return P.ouputplaces[e](Promise.resolve({data:[]}))})},showCustomOutputDataPromise:function(t){P.currentoutputplaces.forEach(function(e){return P.ouputplaces[e](t,{})})},getService:function(e){return P.services[e]},setOutputPlaces:function(){P.currentoutputplaces=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]},addCurrentOutputPlace:function(e){e&&-1===P.currentoutputplaces.indexOf(e)&&P.currentoutputplaces.push(e)},addNewOutputPlace:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.place,e=e.method,n=!1;return void 0===P.ouputplaces[t]&&(P.ouputplaces[t]=void 0===e?function(){}:e,n=!0),n},resetDefaultOutput:function(){P.currentoutputplaces=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(P.defaultoutputplaces))}},O=(P.init=T(function*(){function e(){return L(this,e),C(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}var t,n,r,i,a,o,s,l;function u(){return L(this,u),C(this,(u.__proto__||Object.getPrototypeOf(u)).apply(this,arguments))}function c(){return L(this,c),C(this,(c.__proto__||Object.getPrototypeOf(c)).apply(this,arguments))}function d(){return L(this,d),C(this,(d.__proto__||Object.getPrototypeOf(d)).apply(this,arguments))}function p(){L(this,p);var e=C(this,(p.__proto__||Object.getPrototypeOf(p)).call(this));return e.condition={filtrable:{ows:"WFS"}},e}P.services={query:(E(p,O),h(p,[{key:"polygon",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.feature,n=e.feature_count,n=void 0===n?this.project.getQueryFeatureCount():n,r=e.filterConfig,r=void 0===r?{}:r,i=e.multilayers,i=void 0!==i&&i,a=e.condition,a=void 0===a?this.condition:a,o=e.layerName,o=void 0===o?"":o,s=e.excludeSelected,s=void 0===s?null:s,l=e.external,l=void 0===l?{add:!0,filter:{SELECTED:!1}}:l,e=e.type,e=void 0===e?"polygon":e,u=this.hasExternalLayerSelected({type:"vector"})?t.getId():t.get(g.G3W_FID),t=t.getGeometry();return t?this.handleRequest((0,_.getQueryLayersPromisesByGeometry)((0,w.getMapLayersByFilter)(f({},"boolean"==typeof s?{SELECTED:!s}:{SELECTED_OR_ALL:!0},{FILTERABLE:!0,VISIBLE:!0}),a),{geometry:t,multilayers:i,feature_count:n,filterConfig:r,projection:this.project.getProjection()}),{fid:u,geometry:t,layerName:o,type:e,filterConfig:r,external:l}):this.returnExceptionResponse({usermessage:{type:"warning",message:o+" - "+M("sdk.mapcontrols.querybypolygon.no_geometry"),messagetext:!0,autoclose:!1}})}},{key:"bbox",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.bbox,n=e.feature_count,n=void 0===n?this.project.getQueryFeatureCount():n,r=e.filterConfig,r=void 0===r?{}:r,i=e.multilayers,i=void 0!==i&&i,a=e.condition,a=void 0===a?this.condition:a,o=e.excludeSelected,o=void 0===o?null:o,s=e.addExternal,s=void 0===s||s,e=e.layersFilterObject,e=void 0===e?{SELECTED_OR_ALL:!0,FILTERABLE:!0,VISIBLE:!0}:e,l=this.hasExternalLayerSelected({type:"vector"}),s={bbox:t,type:"bbox",filterConfig:r,external:{add:s,filter:{SELECTED:l||"boolean"==typeof o&&o}}};return l?this.handleRequest(this.getEmptyRequest(),s):this.handleRequest((0,b.getQueryLayersPromisesByBBOX)((0,w.getMapLayersByFilter)(e,a),{bbox:t,feature_count:n,filterConfig:r,multilayers:i}),s)}},{key:"coordinates",value:(l=T(function*(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=e.coordinates,r=e.layerIds,r=void 0===r?[]:r,i=e.multilayers,i=void 0!==i&&i,a=e.query_point_tolerance,a=void 0===a?g.QUERY_POINT_TOLERANCE:a,o=e.addExternal,o=void 0===o||o,e=e.feature_count,s=this.hasExternalLayerSelected({type:"vector"}),o={coordinates:n,type:"coordinates",external:{add:o,filter:{SELECTED:s}}};return s&&0===r.length?this.handleRequest(this.getEmptyRequest(),o):(t={QUERYABLE:!0,SELECTED_OR_ALL:0===r.length,VISIBLE:!0},Array.isArray(r)&&r.forEach(function(e){t.IDS||(t.IDS=[]),t.IDS.push(e)}),1===(s=(0,w.getMapLayersByFilter)(t)).length&&s[0].isSelected()&&(o.external.add=!1),this.handleRequest((0,y.getQueryLayersPromisesByCoordinates)(s,{multilayers:i,feature_count:e,query_point_tolerance:a,coordinates:n}),o))}),function(){return l.apply(this,arguments)})},{key:"handleRequest",value:function(n){var r=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(t,e){n.then(function(e){e=r.handleResponse(e,i);t(e)}).fail(e)})}},{key:"handleResponse",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return{query:1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},type:"ows",data:e.map(function(e){e=e.data;return void 0===e?[]:e}).flat(),result:!0}}},{key:"returnExceptionResponse",value:(s=T(function*(e){return{data:[],usermessage:e.usermessage,result:!0,error:!0}}),function(e){return s.apply(this,arguments)})}]),new p),search:(E(d,O),h(d,[{key:"features",value:(o=T(function*(){var s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{layer:layer,search_endpoint:search_endpoint,filter:filter,raw:!1,queryUrl:queryUrl,feature_count:feature_count,formatter:1,ordering:ordering};return T(function*(){s.search_endpoint=s.search_endpoint||"api";var e=[],t=s.layer,n=function(e,t){var n,r={};for(n in e)0<=t.indexOf(n)||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(s,["layer"]),r=s.raw,i=void 0!==r&&r,r=s.filter,a=[],o=[].concat(t);return n.filter=[].concat(n.filter),e="api"===n.search_endpoint?o.map(function(e,t){return e.searchFeatures(f({},n,{filter:n.filter[t]}))}):[new Promise(function(t,e){o[0].getProvider("search").query(f({},n,{layers:o},o[0].getSearchParams())).then(function(e){t(e)}).fail(e)})],(yield Promise.allSettled(e)).filter(function(e){return"fulfilled"===e.status}).forEach(function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).value;i?a.push({data:e}):"api"!==n.search_endpoint?a=e.data=void 0!==e.data?e.data:[]:Array.isArray(e.data)&&e.data.length&&a.push(e.data[0])}),{data:a,query:{type:"search",search:r},type:n.search_endpoint}})()}),function(){return o.apply(this,arguments)})},{key:"fids",value:(a=T(function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,n=e.formatter,n=void 0===n?0:n,e=e.fids,e=void 0===e?[]:e,r=[];try{var i=t&&(yield t.getFeatureByFids({fids:e,formatter:n}));i&&i.forEach(function(e){return r.push((0,x.createOlFeatureFromApiResponseFeature)(e))})}catch(e){}return{data:[{layer:t,features:r}],query:{type:"search"}}}),function(){return a.apply(this,arguments)})},{key:"layersfids",value:(i=T(function*(){var n=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layers,t=void 0===t?[]:t,r=e.fids,i=void 0===r?[]:r,r=e.formatter,a=void 0===r?0:r,o=[],s=[];t.forEach(function(e,t){o.push(n.fids({layer:e,fids:i[t],formatter:a}))});try{(yield Promise.all(o)).forEach(function(e){s.push(e.data)})}catch(e){}return{data:s,query:{type:"search"}}}),function(){return i.apply(this,arguments)})}]),new d),expression:(E(c,O),h(c,[{key:"expression",value:(r=T(function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};try{return this.handleResponse(yield this.handleRequest({url:""+this.project.getUrl("vector_data")+e.layer_id+"/",params:e}))}catch(e){return Promise.reject(e)}}),function(){return r.apply(this,arguments)})},{key:"expression_eval",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this.handleRequest({url:this.project.getUrl("expression_eval"),params:e})}},{key:"handleRequest",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.url,n=e.params,e=e.contentType;return S.XHR.post({url:t,contentType:void 0===e?"application/json":e,data:JSON.stringify(void 0===n?{}:n)})}},{key:"handleResponse",value:function(){return(0,m.getFeaturesFromResponseVectorApi)(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}}]),new c),proxy:(E(u,O),h(u,[{key:"wms",value:(n=T(function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.url,n=e.method,n=void 0===n?"GET":n,r=e.params,i=void 0===r?{}:r,r=e.headers,e=void 0===r?{}:r,r=""+v.default.getProxyUrl();"GET"===n&&(t=new URL(t),Object.keys(i).forEach(function(e){return t.searchParams.set(e,i[e])}),t=t.toString());try{var a=JSON.stringify({url:t,params:i,headers:e,method:n});return{response:yield S.XHR.post({url:r,contentType:"application/json",data:a}),data:a}}catch(e){}}),function(){return n.apply(this,arguments)})},{key:"data",value:function(){}}]),new u),ows:(E(e,O),h(e,[{key:"wmsCapabilities",value:(t=T(function*(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).url,t=""+v.default.getInterfaceOwsUrl();try{var n={url:e,service:"wms"},r=JSON.stringify(n);return yield S.XHR.post({url:t,contentType:"application/json",data:r})}catch(e){}}),function(){return t.apply(this,arguments)})}]),new e)}}),h(F,[{key:"handleRequest",value:function(){}},{key:"handleResponse",value:(k=T(function*(){}),function(){return k.apply(this,arguments)})},{key:"getSelectedExternalLayers",value:function(e){e=e.type,e=void 0===e?"vector":e;return a.default.getService("catalog").state.external[e].filter(function(e){return e.selected})}},{key:"getEmptyRequest",value:function(){return(0,l.resolve)([])}},{key:"hasExternalLayerSelected",value:function(e){e=e.type;return 0<this.getSelectedExternalLayers({type:void 0===e?"vector":e}).length}}]),F);function F(){var t=this;L(this,F),i.default.onbefore("setCurrentProject",function(e){return t.project=e}),this.project=i.default.getCurrentProject()}n.default=P},{"app/constant":5,"core/i18n/i18n.service":12,"services/application":298,"services/gui":302,"services/iframe":303,"store/projects":317,"utils/XHR":319,"utils/createOlFeatureFromApiResponseFeature":349,"utils/getFeaturesFromResponseVectorApi":381,"utils/getMapLayersByFilter":386,"utils/getQueryLayersPromisesByBBOX":390,"utils/getQueryLayersPromisesByCoordinates":391,"utils/getQueryLayersPromisesByGeometry":392,"utils/resolve":433,"utils/splitContextAndMethod":442}],301:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("services/gui"),i=(r=r)&&r.__esModule?r:{default:r};r={stack:new(e("core/g3w-barstack").BarStack),init:function(e){this.layout=e,this.sidebarEl=$(this.layout.options.controlSidebarOptions.selector),this._zindex=this.sidebarEl.css("z-index"),this._modalOverlay=null,this._modal=!1,this._isopen=!1},isOpen:function(){return this._isopen},open:function(){this.layout.floatBar.open(this.sidebarEl,!0),this._isopen=!0},close:function(){this.layout.floatBar.close(this.sidebarEl,!0),this._isopen=!1},showPanel:function(e,t){(t=t||{}).parent="#g3w-floatbarpanel-placeholder",this.stack.push(e,t),this._isopen||this.open()},closePanel:function(e){e?this.stack.remove(e):this.stack.pop();e=this.stack.getLength();!e&&this._modal?(i.default.setModal(!1),this.close(),$(".control-sidebar-bg").toggleClass("control-sidebar-bg-shadow"),this.sidebarEl.css("z-index",""),this.sidebarEl.css("padding-top","50px"),$(".control-sidebar-bg").css("z-index",""),this._modal=!1):e||this._modal||this.close()},hidePanel:function(){this.close()}};n.default=r},{"core/g3w-barstack":7,"services/gui":302}],302:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=o(e("services/application")),i=o(e("services/router")),a=o(e("store/components"));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var l,u=e("utils"),c=u.base,d=u.inherit,p=u.noop;function f(){this.setters={setContent:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.emit("opencontent",!0),this._setContent(e)}},this.isready=!1,this.getResourcesUrl=p,this.showForm=p,this.closeForm=p,this.showListing=p,this.closeListing=p,this.hideListing=p,this.setModal=p,this.showFullModal=p,this.showQueryResults=p,this.hideQueryResults=p,this.showPanel=p,this.hidePanel=p,this.reloadComponents=p,this.showUserMessage=p,this.closeUserMessage=p,this.showModalDialog=p,this.push_content=!1,this.setPushContent=function(){this.push_content=0<arguments.length&&void 0!==arguments[0]&&arguments[0]},this.getPushContent=function(){return this.push_content},this._closeUserMessageBeforeSetContent=!0,this.setComponent=function(e){a.default.registerComponent(e)},this.getComponent=function(e){return a.default.getComponent(e)},this.getComponents=function(){return a.default.getComponents()},this.goto=function(e){i.default.goto(e)},this.ready=function(){this.emit("ready"),this.isready=!0},this.guiResized=function(){this.emit("guiresized")},this.isReady=function(){var t=this;return new Promise(function(e){return t.isready?e():t.once("ready",e)})},this.getService=function(e){e=this.getComponent(e);return e&&e.getService()},this.showSpinner=function(){},this.hideSpinner=function(e){},this.notify=p,this.dialog=p,this.isMobile=p,c(this)}d(f,e("core/g3wobject")),f.prototype.downloadWrapper=(l=s(function*(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=r.default.setDownload(!0);this.setLoadingContent(!0);try{yield e(t)}catch(e){this.showUserMessage({type:"alert",message:e||"server_error",textMessage:!!e})}r.default.setDownload(!1,n),this.setLoadingContent(!1)}),function(e){return l.apply(this,arguments)}),n.default=new f},{"core/g3wobject":11,"services/application":298,"services/router":306,"store/components":312,utils:404}],303:[function(r,R,e){Object.defineProperty(e,"__esModule",{value:!0});var t=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n=h(function*(e){return e=(0,G.normalizeEpsg)(e),yield D.registerProjection(e),e});var n,a=function(e){return n.apply(this,arguments)},o=l(r("services/gui")),N=l(r("store/projects")),s=l(r("store/plugins")),G=r("utils/normalizeEpsg"),u=r("utils");function l(e){return e&&e.__esModule?e:{default:e}}function c(e,t){var n,r={};for(n in e)0<=t.indexOf(n)||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function d(e,t){if(e)return!t||"object"!=typeof t&&"function"!=typeof t?e:t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var g,v,m,y,_,D=r("g3w-ol/projection/projections"),b=r("core/g3wobject"),B=(t(w,[{key:"init",value:(_=h(function*(){for(var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).project,t=(yield o.default.isReady(),this.services={app:new V,editing:new W},e.state.layers.map(function(e){return{id:e.id,name:e.name}})),n=Object.keys(this.services),r=0;r<n.length;r++){var i=this.services[n[r]];void 0===i.getLayers()&&i.setLayers(t),yield i.init(),i.on("response",this.eventResponseServiceHandler)}this.postMessage({id:null,action:"app:ready",response:{result:!0,data:{layers:t}}}),window.addEventListener("message",this.getMessage,!1)}),function(){return _.apply(this,arguments)})},{key:"eventResponseServiceHandler",value:function(e){var t=e.action,e=e.response;this.postMessage({id:null,action:t,response:e})}},{key:"outputDataPlace",value:(y=h(function*(e){var t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).action,t=void 0===t?"app:results":t,n=yield e,r=n.result,n=n.data,n=void 0===n?[]:n,i=new ol.format.GeoJSON,a=[];try{a=n.map(function(e){var t,n=e.layer,e=e.features;return t={},n=n.getId(),e={features:i.writeFeatures(e)},n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t})}catch(e){r=!1,a=e}this.postMessage({id:null,action:t,response:{result:r,data:a}})}),function(e){return y.apply(this,arguments)})},{key:"postMessage",value:function(){window.parent&&window.parent.postMessage(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},"*")}},{key:"stopPendingActions",value:(m=h(function*(){var t=this,n=[];return Object.keys(this.pendingactions).forEach(function(e){n.push(t.services[t.pendingactions[e].context].stop()),delete t.pendingactions[e]}),Promise.allSettled(n)}),function(){return m.apply(this,arguments)})},{key:"getMessage",value:(v=h(function*(e){if(e&&e.data){var e=e.data,t=e.id,t=void 0===t?(0,u.uniqueId)():t,n=e.single,n=void 0===n||n,r=e.action,e=e.data,i=(0,u.splitContextAndMethod)(r),a=i.context,i=i.method,o=!1,s=void 0;try{var l=this.services[a].getReady();l&&n&&(yield this.stopPendingActions()),l&&(this.pendingactions[t]={context:a},s=yield this.services[a][i](e),o=!0)}catch(e){o=!1,s=e}this.postMessage({id:t,action:r,response:{result:o,data:s}}),delete this.pendingactions[t]}}),function(e){return v.apply(this,arguments)})},{key:"clear",value:(g=h(function*(){for(var e=Object.keys(this.services),t=0;t<e.length;t++)this.services[e[t]].off("response",this.eventResponseServiceHandler);yield this.stopPendingActions(),window.removeEventListener("message",this.getMessage,!1)}),function(){return g.apply(this,arguments)})}]),w);function w(){f(this,w),this.pendingactions={},this.getMessage=this.getMessage.bind(this),this.eventResponseServiceHandler=this.eventResponseServiceHandler.bind(this)}p(E,b),t(E,[{key:"init",value:(C=h(function*(){var t,n=this,e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).layers;this.layers=void 0===e?{}:e,s.default.isPluginInConfiguration(this.pluginName)&&((e=s.default.getPlugin(this.pluginName))?(this.setDependencyApi(e.getApi()),this.setReady(!0)):s.default.onafter("registerPlugin",(t=h(function*(e){yield e.isReady(),e.getName()===n.pluginName&&(n.setDependencyApi(e.getApi()),n.setReady(!0))}),function(e){return t.apply(this,arguments)})))}),function(){return C.apply(this,arguments)})},{key:"setDependencyApi",value:function(){this.dependencyApi=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}}},{key:"getDependecyApi",value:function(){return this.dependencyApi}},{key:"getQgsLayerId",value:function(e){var t=e.qgs_layer_id,e=e.noValue,e=void 0===e?this.layers.map(function(e){return e.id}):e;return t?[].concat(t):e}},{key:"searchFeature",value:(L=h(function*(e){var t=e.layer,e=e.feature,n=e.field,e=e.value,t=(yield r("services/data").default.getData("search:features",{inputs:{layer:t,filter:(0,u.createFilterFormField)({layer:t,field:n,value:e})},outputs:!1})).data;return void 0===t?[]:t}),function(e){return L.apply(this,arguments)})},{key:"findFeaturesWithGeometry",value:(S=h(function*(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.feature,n=e.qgs_layer_id,r=void 0===n?[]:n,n=e.zoom,i=void 0!==n&&n,n=e.highlight,a=void 0!==n&&n,o={found:!1,features:[],qgs_layer_id:null},s=r.length,l=0;!o.found&&l<s;){var u=this.project.getLayerById(r[l]);try{var c=u&&(yield this.searchFeature({layer:u,feature:t})),d=c.length&&c[0].features;if(o.found=d&&0<d.length&&!!d.find(function(e){return e.getGeometry()}),!d||!o.found)throw"invalid response";o.features=d,o.qgs_layer_id=r[l],i&&(yield this.mapService.zoomToFeatures(d,{highlight:a}))}catch(e){l++}}return o.found||this.mapService.zoomToProjectInitExtent(),o}),function(){return S.apply(this,arguments)})},{key:"setLayers",value:function(){this.layers=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]}},{key:"getLayers",value:function(){return this.layers}},{key:"setReady",value:function(){this.ready=0<arguments.length&&void 0!==arguments[0]&&arguments[0]}},{key:"getReady",value:function(){return this.ready}},{key:"stop",value:(x=h(function*(){}),function(){return x.apply(this,arguments)})},{key:"clear",value:function(){}}]);var x,S,L,C,b=E;function E(){f(this,E);var e=d(this,(E.__proto__||Object.getPrototypeOf(E)).call(this));return e.ready=!1,e.mapService=o.default.getService("map"),e.project=N.default.getCurrentProject(),e.layers=void 0,e.pluginName,e.dependencyApi={},e}p(j,b),t(j,[{key:"init",value:function(){var n=this;return new Promise(function(e,t){n.mapService.once("ready",function(){n._map=n.mapService.getMap(),n._mapCrs=n.mapService.getCrs(),n.mapControls.screenshot.control=n.mapService.getMapControlByType({type:"screenshot"}),n.setReady(!0),e()})})}},{key:"results",value:(I=h(function*(e){var e=e.capture,e=void 0===e||e,t=r("services/data").default;return e?t.setOutputPlaces(["iframe"]):t.resetDefaultOutput(),[]}),function(e){return I.apply(this,arguments)})},{key:"screenshot",value:(F=h(function*(e){var n=this,e=e.capture;void 0===e||e?this.mapControls.screenshot.control.overwriteOnClickEvent(h(function*(){var t=void 0;try{t={result:!0,data:yield n.mapService.createMapImage()}}catch(e){t={result:!1,data:e}}finally{n.emit("response",{response:t,action:"app:screenshot"})}})):this.mapControls.screenshot.control.resetOriginalOnClickEvent()}),function(e){return F.apply(this,arguments)})},{key:"getcenter",value:(O=h(function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=this.mapService.getCenter();return void 0!==e.epsg?ol.proj.transform(t,this.mapService.getEpsg(),yield a(e.epsg)):t}),function(){return O.apply(this,arguments)})},{key:"zoomtocoordinates",value:(P=h(function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.coordinates,t=void 0===t?[]:t,e=e.epsg;return t&&Array.isArray(t)&&2===t.length?(void 0!==e&&(e=yield a(e),t=ol.proj.transform(t,e,this.mapService.getEpsg())),this.mapService.zoomTo(t),t):Promise.reject(t)}),function(){return P.apply(this,arguments)})},{key:"getextent",value:(M=h(function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=this.mapService.getMapExtent();return void 0!==e.epsg?ol.proj.transformExtent(t,this.mapService.getEpsg(),yield a(e.epsg)):t}),function(){return M.apply(this,arguments)})},{key:"zoomtoextent",value:(k=h(function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.extent,t=void 0===t?[]:t,e=e.epsg;return t&&Array.isArray(t)&&4===t.length?(void 0!==e?(e=a(e),t=ol.proj.transformExtent(t,e,this.mapService.getEpsg())):this.mapService.goToBBox(t),t):Promise.reject(t)}),function(){return k.apply(this,arguments)})},{key:"zoomtofeature",value:(T=h(function*(){var n,a=this,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return new Promise((n=h(function*(e,t){var n=o.qgs_layer_id,r=o.feature,i=o.highlight,i=void 0!==i&&i,n=a.getQgsLayerId({qgs_layer_id:n});e((yield a.findFeaturesWithGeometry({qgs_layer_id:n,feature:r,zoom:!0,highlight:i})).qgs_layer_id)}),function(e,t){return n.apply(this,arguments)}))}),function(){return T.apply(this,arguments)})}]);var T,k,M,P,O,F,I,V=j;function j(){f(this,j);var e=d(this,(j.__proto__||Object.getPrototypeOf(j)).call(this));return e.mapControls={screenshot:{control:null},changeMap:{control:null}},e}p(A,b),t(A,[{key:"startAction",value:(Y=h(function*(e){var n=this,t=e.toolboxes,r=e.resolve,i=e.reject;this.responseObject.cb=i,this.dependencyApi.setSaveConfig({cb:{done:function(e){n.responseObject.cb=r,n.responseObject.qgs_layer_id=e.getId(),n.responseObject.error=null,n.dependencyApi.hidePanel()},error:function(e,t){n.responseObject.cb=i,n.responseObject.qgs_layer_id=e.getId(),n.responseObject.error=t}}}),this.dependencyApi.showPanel({toolboxes:t}),this.isRunning=!0}),function(e){return Y.apply(this,arguments)})},{key:"stopAction",value:(q=h(function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.qgs_layer_id&&(yield this.stopEditing(e.qgs_layer_id))}),function(){return q.apply(this,arguments)})},{key:"addSubscribeEvents",value:function(e){var t=this.subscribersHandlers[e](1<arguments.length&&void 0!==arguments[1]?arguments[1]:{});return this.dependencyApi.subscribe(e,t),this.subscribevents.push({event:e,handler:t}),t}},{key:"resetSubscribeEvents",value:function(){var t=this;this.subscribevents.forEach(function(e){t.dependencyApi.unsubscribe(e.event,e.handler)})}},{key:"add",value:function(){var n,i=this,a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return new Promise((n=h(function*(e,t){if(i.isRunning)return t();var n=a.qgs_layer_id,r=c(a,["qgs_layer_id"]).properties,n=i.getQgsLayerId({qgs_layer_id:n,noValue:i.dependencyApi.getEditableLayersId()}),e=(yield i.startAction({toolboxes:n,resolve:e,reject:t}),(yield i.startEditing(n,{tools:i.config.tools.add,startstopediting:!1,action:"add",selected:1===n.length})).filter(function(e){return"fulfilled"===e.status}).map(function(e){return e.value}));o.default.isSidebarVisible()||o.default.showSidebar(),1===e.length&&e[0]&&e[0].setActiveTool(e[0].getToolById("addfeature")),i.addSubscribeEvents("addfeature",{properties:r,toolboxes:e}),i.addSubscribeEvents("closeeditingpanel",{qgs_layer_id:n})}),function(e,t){return n.apply(this,arguments)}))}},{key:"update",value:(z=h(function*(){var n,i=this,a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return new Promise((n=h(function*(e,t){var n,r;return!i.isRunning&&(r=a.qgs_layer_id,n=c(a,["qgs_layer_id"]).feature,r=i.getQgsLayerId({qgs_layer_id:r,noValue:i.dependencyApi.getEditableLayersId()}),(r=yield i.findFeaturesWithGeometry({qgs_layer_id:r,feature:n,zoom:!0,highlight:!0,selected:1===r.length})).found)?(yield i.startAction({toolboxes:[r.qgs_layer_id],resolve:e,reject:t}),yield i.startEditing([r.qgs_layer_id],{feature:n,tools:i.config.tools.update,startstopediting:!1,action:"update"}),o.default.isSidebarVisible()||o.default.showSidebar(),void i.addSubscribeEvents("closeeditingpanel",{qgs_layer_id:[r.qgs_layer_id]})):t()}),function(e,t){return n.apply(this,arguments)}))}),function(){return z.apply(this,arguments)})},{key:"delete",value:function(){}},{key:"startEditing",value:($=h(function*(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=n.action,r=void 0===r?"add":r,i=n.feature,a={};switch(n.filter=a,r){case"add":a.nofeatures=!0;break;case"update":a.field=i.field+"|eq|"+i.value}var o=[];return e.forEach(function(e){o.push(t.dependencyApi.startEditing(e,n))}),yield Promise.allSettled(o)}),function(){return $.apply(this,arguments)})},{key:"stopEditing",value:(U=h(function*(e){var t=this,n=[];e.forEach(function(e){n.push(t.dependencyApi.stopEditing(e))}),yield Promise.allSettled(n),this.clear()}),function(e){return U.apply(this,arguments)})},{key:"stop",value:function(){var n=this;return new Promise(function(e,t){n.dependencyApi.hidePanel(),o.default.hideSidebar(),n.once("clear",e)})}},{key:"clear",value:function(){this.dependencyApi.resetDefault(),this.isRunning=!1,this.responseObject={cb:null,qgs_layer_id:null,error:null},this.resetSubscribeEvents(),this.emit("clear")}}]);var U,$,z,q,Y,W=A;function A(){f(this,A);var o=d(this,(A.__proto__||Object.getPrototypeOf(A)).call(this));return o.pluginName="editing",o.subscribevents=[],o.isRunning=!1,o.responseObject={cb:null,qgs_layer_id:null,error:null},o.config={tools:{add:{disabled:[{id:"deletefeature"},{id:"copyfeatures"},{id:"editmultiattributes"},{id:"deletePart"},{id:"splitfeature"},{id:"mergefeatures"}]},update:{disabled:[{id:"addfeature"},{id:"copyfeatures"},{id:"deletefeature"},{id:"editmultiattributes"},{id:"deletePart"},{id:"splitfeature"},{id:"mergefeatures"}]},delete:{enabled:[{id:"deletefeature",options:{active:!0}}]}}},o.subscribersHandlers={canUndo:function(e){var n=e.activeTool,e=e.disableToolboxes,r=void 0===e?[]:e;return function(t){!1===t&&(o.responseObject.qgs_layer_id=null,o.responseObject.error=null),n.setEnabled(!t),r.forEach(function(e){return e.setEditing(!t)})}},canRedo:function(){},cancelform:function(e){return function(){e()}},addfeature:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=e.properties,a=e.toolboxes;return function(t){Object.keys(i).forEach(function(e){return t.set(e,i[e])});var n=void 0,r=[];a.forEach(function(e){var t=e.getToolById("addfeature");t.isActive()?(t.setEnabled(!1),n=t):(e.setEditing(!1),r.push(e))}),o.subscribevents.find(function(e){return"canUndo"!==e.event})&&o.addSubscribeEvents("cancelform",o.addSubscribeEvents("canUndo",{activeTool:n,disableToolboxes:r}))}},closeeditingpanel:function(e){var t=e.qgs_layer_id;return function(){o.responseObject.cb({qgs_layer_id:o.responseObject.qgs_layer_id,error:o.responseObject.error}),o.stopAction({qgs_layer_id:t})}}},o}e.default=new B},{"core/g3wobject":11,"g3w-ol/projection/projections":76,"services/data":300,"services/gui":302,"store/plugins":316,"store/projects":317,utils:404,"utils/normalizeEpsg":422}],304:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("utils"),i=r.base;function a(){this.state={items:{left:[],right:[]}},this.addItem=function(e){this.state.items[1<arguments.length&&void 0!==arguments[1]?arguments[1]:"right"].push(e)},i(this)}(0,r.inherit)(a,e("core/g3wobject")),n.default=new a},{"core/g3wobject":11,utils:404}],305:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var a=r(e("store/catalog-layers")),d=r(e("store/projects")),o=r(e("services/data")),p=e("utils/sanitizeFidFeature"),s=e("utils/getAlphanumericPropertiesFromFeature");function r(e){return e&&e.__esModule?e:{default:e}}var i=e("utils"),l=i.inherit,u=i.XHR,c=i.base,f=i.createSingleFieldParameter;function h(){c(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}l(h,e("core/g3wobject"));var g,i=h.prototype;i.createUrl=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=d.default.getCurrentProject(),n=e.layer,n=void 0===n?{}:n,r=e.relation,r=void 0===r?{}:r,i=e.fid,a=e.type,a=void 0===a?"data":a,e=e.formatter,e=void 0===e?1:e,o=void 0,s=r.father,l=r.child,u=r.referencedLayer,c=r.referencingLayer,r=r.id,o=void 0===s?n.id===u?c:u:n.id===s?l:s;return t.getLayerById(o).getUrl(a)+"?relationonetomany="+r+"|"+(0,p.sanitizeFidFeature)(i)+"&formatter="+e},i.getRelations=function(){return u.get({url:this.createUrl(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})})},i.getRelationsNM=(g=function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.nmRelation,e=e.features,e=void 0===e?[]:e,n=t.referencedLayer,t=(t.referencingLayer,t.fieldRef),r=t.referencingField,t=t.referencedField,i=[];return i=e.length&&(e=e.map(function(e){return e.attributes[r]}),(n=yield o.default.getData("search:features",{inputs:{layer:a.default.getLayerById(n),filter:""+f({field:t,value:e,logicop:"OR"}),formatter:1},outputs:null})).data)&&n.data[0]&&Array.isArray(n.data[0].features)?n.data[0].features.map(function(n){var e=(0,s.getAlphanumericPropertiesFromFeature)(n.getProperties()).reduce(function(e,t){return e[t]=n.get(t),e},{});return{id:n.getId(),attributes:e,geometry:n.getGeometry()}}):i},function(){var s=g.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}),i.save=function(){return u.fileDownload({url:this.createUrl(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),httpMethod:"GET"})},n.default=new h},{"core/g3wobject":11,"services/data":300,"store/catalog-layers":311,"store/projects":317,utils:404,"utils/getAlphanumericPropertiesFromFeature":374,"utils/sanitizeFidFeature":436}],306:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});function r(){this._initialLocationQuery,this._routeQuery="",this.setters={setRouteQuery:function(e){this._routeQuery=e,crossroads.parse(e)}},a(this)}var i=e("utils"),a=i.base,o=i.inherit,i=(i.Base64,e("core/g3wobject")),e=(crossroads.ignoreState=!0,crossroads.greedy=!0,o(r,i),r.prototype);e.init=function(){var e=window.location.search;this._setRouteQueryFromLocationQuery(e)},e.addRoute=function(e,t,n){return crossroads.addRoute(e,t,n)},e.removeRoute=function(e){return crossroads.removeRoute(e)},e.removeAllRoutes=function(){return crossroads.removeAllRoutes()},e.parse=function(e,t){return crossroads.parse(e,t)},e.goto=function(e){this._initialQuery||(this._initialLocationQuery=this._stripInitialQuery(location.search.substring(1))),e&&this.setRouteQuery(e)},e.makePermalink=function(e){this._initialQuery||(this._initialLocationQuery=this._stripInitialQuery(location.search.substring(1)));this._encodeRouteQuery(e);return"?"+this._initialLocationQuery+"&q="+this._encodeRouteQuery(e)},e.makeQueryString=function(e){},e.slicePath=function(e){return e.split("?")[0].split("/")},e.sliceFirst=function(e){var t=e.split("?"),n=t[1],t=t[0].split("/");return[t[0],e=[e=t.slice(1).join("/"),n].join("?")]},e.getQueryParams=function(e){e=e.replace("?","");var n={},t=[],t=""!=e&&-1==e.indexOf("&")?[e]:e.split("&");try{_.forEach(t,function(e){var e=e.split("="),t=e[0],e=e[1];n[t]=e})}catch(e){}return n},e.getQueryString=function(e){return e.split("?")[1]},e._getQueryPortion=function(e,t){var n;try{var r=e.split("&");_.forEach(r,function(e){e.split("=")[0]==t&&(n=e)})}catch(e){}return n},e._encodeRouteQuery=function(e){return e=(e=(e=e.replace("?","@")).replace("&","|")).replace("=","!")},e._decodeRouteQuery=function(e){return e=(e=(e=e.replace("@","?")).replace("|","&")).replace("!","=")},e._setRouteQueryFromLocationQuery=function(e){var e=this._getRouteQueryFromLocationQuery(e);e&&(e=this._decodeRouteQuery(e),this.setRouteQuery(e))},e._getRouteQueryFromLocationQuery=function(e){return this.getQueryParams(e).q},e._stripInitialQuery=function(e){var t,n=this._getQueryPortion(e,"q");return n&&(t=n.length,n=e.indexOf(n),queryPrefix=_.trimEnd(e.substring(0,n),"&"),querySuffix=e.substring(n+t),querySuffix=""!=queryPrefix?querySuffix:_.trimStart(querySuffix,"&"),e=queryPrefix+querySuffix),e},n.default=new r},{"core/g3wobject":11,utils:404}],307:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e};function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=u(e("core/g3w-object")),s=e("core/g3w-barstack"),l=u(e("components/SidebarItem.vue"));function u(e){return e&&e.__esModule?e:{default:e}}function c(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}n.default=new(function(e){var t,n=r;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);function r(){var e;if(this instanceof r)return(e=function(e,t){if(e)return!t||"object"!=typeof t&&"function"!=typeof t?e:t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(this,(r.__proto__||Object.getPrototypeOf(r)).call(this))).stack=new s.BarStack,e.state={components:[],gui:{title:""},disabled:!1},e.setters={closeSidebarPanel:function(){},openCloseItem:function(e){}},e;throw new TypeError("Cannot call a class as a function")}return n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(n,e):n.__proto__=e),a(r,[{key:"init",value:function(e){this.layout=e}},{key:"addComponents",value:function(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return e.forEach(function(e){return t.addComponent(e,n)}),!0}},{key:"addComponent",value:function(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(isMobile.any&&!e.mobile)return!1;n.before=void 0===n.before||n.before;var t=new(Vue.extend(l.default))({service:this,component:e}),r=(t.title=e.title||t.title,t.info=e.info||t.info,t.actions=e.actions||t.actions,t.open=e.state.open,t.icon=e.icon||t.icon,t.iconColor=e.iconColor,t.state=e.state||!0,t.collapsible="boolean"!=typeof e.collapsible||e.collapsible,t.isolate="boolean"==typeof e.isolate&&e.isolate,t.$mount().$el),t="#g3w-sidebarcomponents"+($(".g3w-sidebarpanel").is(":visible")?":hidden":""),i=(this.state.components.push(e),$(t).children().filter(function(){return"none"!==this.style.display}));return null===n.position||void 0===n.position||n.position<0||n.position>=i.length?$(t).append(r):i.each(function(e,t){(Number.isInteger(n.position)?n.position===e:t.id===n.position)&&$(r)["insert"+(n.before?"Before":"After")](t)}),e.mount("#g3w-sidebarcomponent-placeholder"),e.initService&&e.initService(),this.setComponentClickHandler(e),!0}},{key:"setComponentClickHandler",value:function(t){t.click=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).open,e=void 0!==e&&e||!1;$(t.getInternalComponent().$el).siblings("a").click(),t.setOpen(e)}}},{key:"getComponent",value:function(t){return this.state.components.find(function(e){return e.getId()===t})}},{key:"getComponents",value:function(){return this.state.components}},{key:"closeOpenComponents",value:function(){this.getComponents().forEach(function(e){return e.getOpen()&&e.state.closewhenshowviewportcontent&&e.collapsible&&e.click({open:!1})})}},{key:"reloadComponent",value:function(e){e=this.getComponent(e);e&&e.reload()}},{key:"reloadComponents",value:function(){this.closePanel(),this.state.components.forEach(function(e){e.collapsible&&e.state.open&&e.click({open:!1}),component.reload()})}},{key:"removeComponent",value:function(n){var r=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.state.components.forEach(function(e,t){if(n===e)return n.unmount(),r.state.components.splice(t,1),(void 0!==i.position&&Number.isInteger(i.position)?$("#g3w-sidebarcomponents").children(":visible")[i.position]:$("#g3w-sidebarcomponents").children("#"+n.id)).remove(),!1})}},{key:"showPanel",value:(t=c(function*(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=(this.state.gui.title=e.title,this.stack.getCurrentContentData());return n&&$(n.content.internalPanel.$el).hide(),yield this.stack.push(e,i({parent:"#g3w-sidebarpanel-placeholder"},t))}),function(e){return t.apply(this,arguments)})},{key:"closePanel",value:function(){var n=this;this.closeSidebarPanel(),this.stack.pop().then(function(e){var t=n.stack.getCurrentContentData();t&&($(t.content.internalPanel.$el).show(),n.state.gui.title=t.content.title)})}},{key:"closeAllPanels",value:function(){this.state.gui.title=null,this.closeSidebarPanel(),this.stack.clear()}}]),r}(o.default))},{"components/SidebarItem.vue":229,"core/g3w-barstack":7,"core/g3w-object":9}],308:[function(e,t,n){function g(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(n,"__esModule",{value:!0});var v=e("utils").XHR;n.default=new function(){var h=[];this.runTask=g(function*(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=t.method,n=void 0===n?"GET":n,r=t.params,r=void 0===r?{}:r,i=t.url,a=t.taskUrl,o=t.interval,s=void 0===o?1e3:o,o=t.timeout,l=void 0===o?1/0:o,o=t.listener,u=void 0===o?function(){}:o;try{var c="GET"===n?yield v.get({url:i,params:r}):yield v.post({url:i,data:r.data||{},contentType:r.contentType||"application/json"}),d=c.result,p=c.task_id;if(!d)return Promise.reject(c);var f=setInterval(g(function*(){if(0<(l-=s)){var t=void 0;try{t=yield v.get({url:""+a+p})}catch(e){t=e}u({task_id:p,timeout:!1,response:t})}else u({timeout:!0}),e.stopTask({task_id:p})}),s);h.push({task_id:p,intervalId:f}),u({task_id:p,response:c})}catch(e){return Promise.reject(e)}}),this.stopTask=function(){var t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).task_id,e=h.find(function(e){return e.task_id===t});e&&clearInterval(e.intervalId)},this.clear=function(){var t=this;h.forEach(function(e){e=e.taskId;return t.stopTask({taskId:e})}),h.splice(0)}}},{utils:404}],309:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=a(e("store/application-state")),i=e("app/constant"),s=a(e("services/gui"));function a(e){return e&&e.__esModule?e:{default:e}}function l(){this.state={primaryView:"map",secondaryPerc:0,resized:{start:!1,h:!1,v:!1},split:"h",map:{sizes:{width:0,height:0},aside:!1},content:{loading:!1,disabled:!1,sizes:{width:0,height:0},resize:{h:{perc:0},v:{perc:0}},aside:!0,showgoback:!0,stack:[],closable:!0,backonclose:!1,contentsdata:[]},usermessage:{id:null,show:!1,title:null,message:null,position:null,type:null,draggable:null,cloasable:null,autoclose:null,textMessage:!1,hooks:{header:null,body:null,footer:null}}},this._components={map:null,content:null},this._defaultMapComponent,this._contextualMapComponent,this._secondaryViewMinWidth=i.VIEWPORT.resize.content.min,this._secondaryViewMinHeight=i.VIEWPORT.resize.content.min,this._immediateComponentsLayout=!0,this.init=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.primaryview,n=e.split,n=void 0===n?"h":n,e=e.components;this.state.primaryView=void 0===t?"map":t,this.state.split=n,this._addComponents(e)},this.setResized=function(e){this.state.resized[e]=1<arguments.length&&void 0!==arguments[1]&&arguments[1]},this.showUserMessage=function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=t.title,r=t.subtitle,i=t.message,a=t.type,o=t.position,s=t.size,l=t.draggable,u=t.duration,c=t.textMessage,d=void 0!==c&&c,p=t.closable,f=t.autoclose,c=t.hooks,h=void 0===c?{}:c;return this.closeUserMessage(),setTimeout(function(){e.state.usermessage.id=g(),e.state.usermessage.show=!0,e.state.usermessage.message=i,e.state.usermessage.textMessage=d,e.state.usermessage.title=n,e.state.usermessage.subtitle=r,e.state.usermessage.position=o,e.state.usermessage.duration=u,e.state.usermessage.type=a,e.state.usermessage.show=!0,e.state.usermessage.size=s,e.state.usermessage.autoclose=f,e.state.usermessage.closable=p,e.state.usermessage.draggable=l,e.state.usermessage.hooks.header=h.header,e.state.usermessage.hooks.body=h.body,e.state.usermessage.hooks.footer=h.footer}),this.state.usermessage},this.closeUserMessage=function(){this.state.usermessage.id=null,this.state.usermessage.show=!1,this.state.usermessage.textMessage=!1,this.state.usermessage.message=""},this.getState=function(){return this.state},this.getMapState=function(){return this.state.map},this.getContentState=function(){return this.state.content},this.setLoadingContent=function(){this.state.content.loading=0<arguments.length&&void 0!==arguments[0]&&arguments[0]},this._addComponents=function(e){var r=this;Object.entries(e).forEach(function(e){var e=o(e,2),t=e[0],n=e[1];-1<Object.keys(r._components).indexOf(t)&&n.mount("#g3w-view-"+t,!0).then(function(){r._components[t]=n,"map"===t&&(r._defaultMapComponent=n)}).fail(function(e){})})},this.showMap=function(){this._toggleMapComponentVisibility(this._defaultMapComponent,!0),this._components.map=this._defaultMapComponent,this._showView("map")},this.showContextualMap=function(){var e,t=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._contextualMapComponent||(this._contextualMapComponent=this._defaultMapComponent),this._contextualMapComponent!=this._defaultMapComponent&&this._toggleMapComponentVisibility(this._defaultMapComponent,!1),this._contextualMapComponent.ismount()?(this._components.map=this._contextualMapComponent,this._toggleMapComponentVisibility(this._contextualMapComponent,!0)):(e=this._contextualMapComponent).mount("#g3w-view-map",!0).then(function(){return t._components.map=e}),this._showView("map",n)},this.recoverDefaultMap=function(){return this._components.map!==this._defaultMapComponent&&(this._components.map=this._defaultMapComponent,this._toggleMapComponentVisibility(this._contextualMapComponent,!1),this._toggleMapComponentVisibility(this._defaultMapComponent,!0)),this._components.map},this.setContextualMapComponent=function(e){e!==this._defaultMapComponent&&(this._contextualMapComponent&&this._contextualMapComponent.unmount(),this._contextualMapComponent=e)},this.resetContextualMapComponent=function(){this._contextualMapComponent&&this._contextualMapComponent.unmount(),this._contextualMapComponent=this._defaultMapComponent},this._toggleMapComponentVisibility=function(e,t){e.internalComponent.$el.style.display=t?"block":"none"},this.closeMap=function(){this.state.secondaryPerc="map"===this.state.primaryView?100:0,this.recoverDefaultMap(),this._layout()},this.showContent=function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=(t.perc=void 0!==t.perc?t.perc:this.getContentPercentageFromCurrentLayout(),t.push=t.push||!1,100===t.perc?"show-content-full":"show-content");this._prepareContentView(t),this._immediateComponentsLayout=!1,this._showView("content",t),this._components.content.setContent(t).then(function(){e._immediateComponentsLayout=!0,e._layoutComponents(n)})},this.hideContent=function(e){var t=this.getContentPercentageFromCurrentLayout(this.state.split);return this.state.secondaryVisible=!e,this._layout("hide-content"),t},this.resetToDefaultContentPercentage=function(){var e=this.getCurrentContentLayout();e["h"===this.state.split?"width":"height"]=e[("h"===this.state.split?"width":"height")+"_default"],e[("h"===this.state.split?"width":"height")+"_100"]=!1,this._layoutComponents()},this.toggleFullViewContent=function(){r.default.gui.layout[r.default.gui.layout.__current].rightpanel[("h"===this.state.split?"width":"height")+"_100"]=!r.default.gui.layout[r.default.gui.layout.__current].rightpanel[("h"===this.state.split?"width":"height")+"_100"],this._layoutComponents()},this.isFullViewContent=function(){return r.default.gui.layout[r.default.gui.layout.__current].rightpanel[("h"===this.state.split?"width":"height")+"_100"]},this.contentLength=function(){return this.state.content.contentsdata.length},this.popContent=function(){var e,t=this,n=$.Deferred();return this.state.content.contentsdata.length?(this.recoverDefaultMap(),e=this._components.content.getPreviousContentData(),this._prepareContentView(e.options),this._immediateComponentsLayout=!1,this._showView("content",e.options),this._components.content.popContent().then(function(){t.state.secondaryPerc=e.options.perc,t._immediateComponentsLayout=!0,t._layout("pop-content"),n.resolve(t._components.contentgetCurrentContentData)})):n.reject(),n.promise()},this.getCurrentContent=function(){return this.contentLength()?this.state.content.contentsdata[this.contentLength()-1]:null},this.getCurrentContentTitle=function(){var e=this.getCurrentContent();return e&&e.options.title},this.getCurrentContentId=function(){var e=this.getCurrentContent();return e&&e.options.id},this.changeCurrentContentOptions=function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=this.getCurrentContent();n&&(e=t.title,t=t.crumb,e&&(n.options.title=e),t)&&(n.options.crumb=t)},this.changeCurrentContentTitle=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=this.getCurrentContent();t&&(t.options.title=e)},this.isContentOpen=function(){return!!this.state.content.contentsdata.length},this.closeContent=function(){var e,t=this,n=$.Deferred();return this.isContentOpen()?(this._components.content.removeContent(),this.closeSecondaryView("close-content").then(function(){var e=t.recoverDefaultMap();n.resolve(e)})):(e=this.recoverDefaultMap(),n.resolve(e)),n.promise()},this.disableContent=function(e){this.state.content.disabled=e},this.removeContent=function(){if(!(this.state.content.backonclose&&1<this.state.content.contentsdata.length))return this.closeContent();this.popContent()},this.isPrimaryView=function(e){return e==this.state.primaryView},this.setPrimaryView=function(e){e!==this.state.primaryView&&(this.state.primaryView=e),this._layout()},this.showPrimaryView=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;e&&this.state.secondaryVisible&&100===this.state.secondaryPerc&&(this.state.secondaryPerc=100-e,this._layout())},this.showSecondaryView=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.state.split,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.state.perc;this.state.secondaryVisible=!0,this.state.split=e,this.state.secondaryPerc=t,this._layout()},this.closeSecondaryView=function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,n=$.Deferred(),r=this._components[this._otherView(this.state.primaryView)];return r.clearContents?r.clearContents().then(function(){e.state.secondaryVisible=!1,e.state.secondaryPerc=0,e._layout(t),Vue.nextTick(function(){return n.resolve()})}):(this.state.secondaryVisible=!1,this._layout(t),Vue.nextTick(function(){return n.resolve()})),n.promise()},this.getDefaultViewPerc=function(e){return this.isPrimaryView(e)?100:50},this._otherView=function(e){return"map"===e?"content":"map"},this._isSecondary=function(e){return this.state.primaryView!==e},this._setPrimaryView=function(e){this.state.primaryView!==e&&(this.state.primaryView=e)},this._prepareContentView=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.title,n=e.split,n=void 0===n?null:n,r=e.closable,r=void 0===r||r,i=e.backonclose,i=void 0===i||i,a=e.style,a=void 0===a?{}:a,o=e.showgoback,o=void 0===o||o,e=e.headertools,e=void 0===e?[]:e;this.state.content.title=t,this.state.content.split=n,this.state.content.closable=r,this.state.content.backonclose=i,this.state.content.contentsdata=this._components.content.contentsdata,this.state.content.style=a,this.state.content.headertools=e,this.state.content.showgoback=o},this._showView=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.perc,n=void 0===n?this.getDefaultViewPerc(e):n,r=t.split,r=void 0===r?"h":r,i=void 0,i=!this.isPrimaryView(e)||void 0!==t.aside&&t.aside,t=(this.state[e].aside=i,this.isPrimaryView(e)?100-n:n);if(!(0<t))return this.closeSecondaryView();this.showSecondaryView(r,t)},this._getReducedSizes=function(){var e,t=$(".content"),n=0,r=$(".sidebar-aside-toggle");return t&&this.state.secondaryVisible&&this.isFullViewContent()?r&&r.is(":visible")&&(e=r.outerWidth(),t.css("padding-left",e+5),n=e-5):(e=r.outerWidth(),t.css("padding-left",100===this.state.secondaryPerc?e+5:15)),{reducedWidth:n,reducedHeight:0}},this._layout=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=this._getReducedSizes();this._setViewSizes(t.reducedWidth,t.reducedHeight),this._immediateComponentsLayout&&this._layoutComponents(e)},this._setViewSizes=function(){var e=this.state.primaryView,t=this._otherView(e),n=this.getViewportSize(),r=n.width,n=n.height,i=void 0,a=void 0,o=void 0,s=void 0,l=(100===this.state.secondaryPerc||this.isFullViewContent()?100:this.getContentPercentageFromCurrentLayout(this.state.split))/100,a="h"===this.state.split?(i=r-(o=this.state.secondaryVisible?Math.max(r*l,this._secondaryViewMinWidth):0),s=n):(o=r,s=this.state.secondaryVisible?Math.max(n*l,this._secondaryViewMinHeight):0,i=this.state.secondaryVisible&&1==l?0:r,n-s);this.state[e].sizes.width=i,this.state[e].sizes.height=a,this.state[t].sizes.width=o,this.state[t].sizes.height=s},this.getViewportSize=function(){return{width:this._viewportWidth(),height:this._viewportHeight()}},this._viewportHeight=function(){return $(document).innerHeight()-$(".navbar-header").innerHeight()},this._viewportWidth=function(){var e=$(".main-sidebar"),t=e.length&&e.offset().left,e=(e.length&&e[0].getBoundingClientRect().width)+t;return $("#app")[0].getBoundingClientRect().width-e},this.resizeViewComponents=function(e){var t=arguments[2];this.setResized(e,!0),this.setContentPercentageFromCurrentLayout(e,t),this._layout("resize")},this.setContentPercentageFromCurrentLayout=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.state.split,t=arguments[1];this.getCurrentContentLayout()["h"===e?"width":"height"]=t},this.getContentPercentageFromCurrentLayout=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.state.split;return this.getCurrentContentLayout()["h"===e?"width":"height"]},this.getCurrentContentLayout=function(){return r.default.gui.layout[r.default.gui.layout.__current].rightpanel},this._layoutComponents=function(){var a=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;requestAnimationFrame(function(){var e=a._getReducedSizes(),r=e.reducedWidth||0,i=e.reducedHeight||0;a._setViewSizes(),Object.entries(a._components).forEach(function(e){var e=o(e,2),t=e[0],e=e[1],n=a.state[t].sizes.width-r,t=a.state[t].sizes.height-i;e.layout(n,t)}),t&&setTimeout(function(){a.emit(t),s.default.emit(t)})})},this._firstLayout=function(){var t=this,n=!1,r=!1;function i(){r=!0,e()}var e=function e(){!0===r?(n=!(r=!1),t._layout("resize"),requestAnimationFrame(e)):n=!1};s.default.on("ready",function(){t.SIDEBARWIDTH=s.default.getSize({element:"sidebar",what:"width"}),t._layout(),s.default.on("guiresized",i),$(window).resize(function(){!1===n&&i()}),$(".main-sidebar").on("webkitTransitionEnd transitionend msTransitionEnd oTransitionEnd",function(e){e.target===this&&($(this).trigger("trans-end"),i())})})},this._firstLayout(),c(this)}var u=e("utils"),c=u.base,d=u.inherit,g=u.uniqueId;d(l,e("core/g3wobject")),n.default=new l},{"app/constant":5,"core/g3wobject":11,"services/gui":302,"store/application-state":310,utils:404}],310:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=Vue.observable({ready:!1,iframe:!1,online:!1,ismobile:!1,download:!1,upload:!1,baseLayerId:null,language:"en",lng:"en",changeProjectview:!1,plugins:[],user:null,map:{epsg:"",unit:"metric"},gui:{app:{disabled:!1},sidebar:{disabled:!1},layout:{__current:"app",app:{}}},keys:{vendorkeys:{google:void 0,bing:void 0}},tokens:{filtertoken:void 0},querybuilder:{cache:{},searches:JSON.parse(window.localStorage.getItem("QUERYBUILDERSEARCHES")||"{}")}});n.STATE_METHODS={};n.default=r},{}],311:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});e=e("core/layers/layersstoresregistry");n.default=new e},{"core/layers/layersstoresregistry":24}],312:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=e("core/g3w-object");var r=new((e=e)&&e.__esModule?e:{default:e}).default,e={components:{},on:r.on.bind(r),registerComponent:function(e){var t=e.getId();void 0===this.components[t]&&(this.components[t]=e,r.emit("componentregistered",e))},getComponent:function(e){return this.components[e]},getComponents:function(){return this.components},unregisterComponent:function(e){var t=this.components[e];return t&&"function"==typeof t.destroy&&t.destroy(),t&&(this.components[e]=null),t}};n.default=e},{"core/g3w-object":9}],313:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ProjectsRegistry=n.PluginsRegistry=n.LayersStoresRegistry=n.ControlsRegistry=n.ComponentsRegistry=n.CatalogLayersStoresRegistry=void 0;var r=l(e("./catalog-layers")),i=l(e("./components")),a=l(e("./map-controls")),o=l(e("./map-layers")),s=l(e("./plugins")),e=l(e("./projects"));function l(e){return e&&e.__esModule?e:{default:e}}n.CatalogLayersStoresRegistry=r.default,n.ComponentsRegistry=i.default,n.ControlsRegistry=a.default,n.LayersStoresRegistry=o.default,n.PluginsRegistry=s.default,n.ProjectsRegistry=e.default},{"./catalog-layers":311,"./components":312,"./map-controls":314,"./map-layers":315,"./plugins":316,"./projects":317}],314:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i=r(e("services/application")),a=r(e("services/gui")),o=e("app/eventbus");function r(e){return e&&e.__esModule?e:{default:e}}var s=e("utils"),l=s.base;function u(){var r=this;this._controls={},this._offlineids=[],this.selectedLayer=null,this.externalLayers=[],i.default.on("complete",function(){var e=a.default.getService("catalog"),n={};e.onafter("addExternalLayer",function(e){var t=e.layer;"vector"===e.type&&(r.externalLayers.push(t),n[t.name]=[o.VM.$watch(function(){return t.selected},function(e){r.setSelectedLayer(!0===e?t:null)})],r.callControlsEventHandler({handler:"onAddExternalLayer",param:{layer:t,unWatches:n[t.name]}}))}),e.onafter("removeExternalLayer",function(e){var t=e.name;"vector"===e.type&&(r.externalLayers=r.externalLayers.filter(function(e){return t===e.name&&r.callControlsEventHandler({handler:"handleRemoveExternalLayer",param:e}),t===e.name&&e===r.selectedLayer&&r.setSelectedLayer(null),t!==e.name}),n[t].forEach(function(e){return e()}),delete n[t])})}),i.default.onbefore("offline",function(){r._offlineids.forEach(function(e){var t=r._controls[e.id];e.enable=t.getEnable(),t.setEnable(!1)})}),i.default.onbefore("online",function(){r._offlineids.forEach(function(e){var t=e.id,e=e.enable;return r._controls[t].setEnable(e)})}),this.setters={registerControl:function(e,t){this._registerControl(e,t)}},this.setSelectedLayer=function(e){this.selectedLayer=e},this.getSelectedLayer=function(){return this.selectedLayer},this.getExternalLayers=function(){return this.externalLayers},this.catalogSelectedLayer=function(e){this.setSelectedLayer(e.isSelected()?e:null),this.callControlsEventHandler({handler:"onSelectLayer",param:this.selectedLayer})},this.callControlsEventHandler=function(e){var t=e.handler,n=e.param;Object.values(this._controls).forEach(function(e){"function"==typeof e[t]&&e[t](n)})},this._registerControl=function(e,t){!1===(this._controls[e]=t).offline&&(this._offlineids.push({id:e,enable:t.getEnable()}),t.getEnable())&&t.setEnable(i.default.isOnline())},this.getControl=function(e){return this._controls[e]},this.getControls=function(){return this._controls},this.unregisterControl=function(t){var e=this.getControl(t);return!!e&&(a.default.getService("map").getMap().removeControl(e),delete this._controls[t],this._offlineids=this._offlineids.filter(function(e){return e!==t}),!0)},l(this)}(0,s.inherit)(u,e("core/g3wobject")),n.default=new u},{"app/eventbus":46,"core/g3wobject":11,"services/application":298,"services/gui":302,utils:404}],315:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});e=e("core/layers/layersstoresregistry");n.default=new e},{"core/layers/layersstoresregistry":24}],316:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},a=s(e("store/projects")),o=s(e("services/application"));function s(e){return e&&e.__esModule?e:{default:e}}function l(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var u=e("utils"),c=u.base,u=u.inherit,e=e("core/g3wobject"),d=["law"];function p(){var n,t=this;this.config=null,this._plugins={},this._configurationPlugins=[],this.pluginsConfigs={},this._loadedPluginUrls=[],this.setters={registerPlugin:function(e){this._plugins[e.name]||(this._plugins[e.name]=e)}},a.default.onafter("setCurrentProject",function(e){t.gidProject=e.getGid()}),c(this),this.init=l(function*(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this.pluginsBaseUrl=e.pluginsBaseUrl,this.setPluginsConfig(e.pluginsConfigs),Object.keys(this.pluginsConfigs).forEach(function(e){return t._configurationPlugins.push(e)}),this.addLoadingPlugins(),this.otherPluginsConfig=e.otherPluginsConfig||{},this.setOtherPlugins(),this.setDependencyPluginConfig(),yield this._loadPlugins()}),this.addLoadingPlugins=function(){Object.keys(this.pluginsConfigs).forEach(function(e){return o.default.loadingPlugin(e)})},this.removeLoadingPlugin=function(e,t){o.default.loadedPlugin(e,t)},this._loadPlugins=function(){var n=this;return Promise.allSettled(Object.entries(this.pluginsConfigs).map(function(e){var e=i(e,2),t=e[0],e=e[1];return n._setup(t,e)}))},this.setDependencyPluginConfig=function(){var e,n=this;for(e in this.pluginsConfigs)!function(e){var t=n.pluginsConfigs[e].plugins;t&&Object.keys(t).forEach(function(e){n.pluginsConfigs[e]=r({},n.pluginsConfigs[e],t[e])})}(e)},this.setOtherPlugins=function(){var e=d[0];this.otherPluginsConfig&&this.otherPluginsConfig[e]&&this.otherPluginsConfig[e].length?(this.pluginsConfigs[e]=this.otherPluginsConfig[e],this.pluginsConfigs[e].gid=this.otherPluginsConfig.gid):delete this.pluginsConfigs[e]},this.reloadPlugins=function(r,o){var n,s=this;return new Promise((n=l(function*(e,t){var n,i=$("script"),a=s.getPlugins();for(n in a)!function(r){a[r].unload(),delete s._plugins[r],i.each(function(e,n){s._loadedPluginUrls.forEach(function(e,t){if(n.getAttribute("src")===e&&-1!==e.indexOf(r))return n.parentNode.removeChild(n),s._loadedPluginUrls.splice(t,1),!1})})}(n);s._loadedPluginUrls=[],s.otherPluginsConfig=o.getState(),s.setPluginsConfig(r.group.plugins),s.addLoadingPlugins(),s.setOtherPlugins();try{e(yield s._loadPlugins())}catch(e){t(e)}}),function(e,t){return n.apply(this,arguments)}))},this.setPluginsConfig=function(){var t=this,n={};Object.entries(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).filter(function(e){return i(e,2)[1].gid===t.gidProject}).forEach(function(e){var e=i(e,2),t=e[0],e=e[1];return n[t]=e}),this.pluginsConfigs=n},this._loadScript=function(r){return 1<arguments.length&&void 0!==arguments[1]&&!arguments[1]?new Promise(function(e,t){var n=document.createElement("script");n.onload=function(){return e()},n.onerror=function(){return t(new Error("Failed to load script: "+r))},n.src=r,document.head.appendChild(n)}):$.getScript(r)},this._setup=(n=l(function*(t,e){var n=this;if(!e)return Promise.resolve();var r=""+this.pluginsBaseUrl+t+"/js/plugin.js?"+Date.now();e.baseUrl=this.pluginsBaseUrl;try{return yield Promise.all((e.jsscripts||[]).map(function(e){return n._loadScript(e,!1)})),yield this._loadScript(r,!1),this._loadedPluginUrls.push(r),Promise.resolve()}catch(e){return this.removeLoadingPlugin(t,!1),Promise.reject()}}),function(e,t){return n.apply(this,arguments)}),this.getPluginConfig=function(e){return this.pluginsConfigs[e]},this.getPlugins=function(){return this._plugins},this.getPlugin=function(e){return this._plugins[e]},this.isPluginInConfiguration=function(e){return-1!==this._configurationPlugins.indexOf(e)},this.isTherePlugin=function(e){return this.pluginsConfigs[e]}}u(p,e),n.default=new p},{"core/g3wobject":11,"services/application":298,"store/projects":317,utils:404}],317:[function(t,n,r){Object.defineProperty(r,"__esModule",{value:!0});var i=o(t("store/catalog-layers")),a=o(t("store/map-layers"));function o(e){return e&&e.__esModule?e:{default:e}}var s=t("utils"),l=s.base,s=s.inherit,u=t("core/g3wobject"),c=t("core/project/project");function d(){this.config=null,this.initialized=!1,this.projectType=null,this.currentProjectGroup=null,this.overviewproject=void 0,this.setters={createProject:function(e){},setCurrentProject:function(e){e!==this.state.currentProject&&(i.default.removeLayersStores(),a.default.removeLayersStores()),this.state.currentProject=e,this.state.qgis_version=e.getQgisVersion(),this.setProjectType(e.state.type);e=e.getLayersStore();i.default.addLayersStore(e,0),a.default.addLayersStore(e,0)}},this.state={baseLayers:{},minScale:null,maxscale:null,currentProject:null,qgis_version:null},this._groupProjects=[],this._projectConfigs={},this.init=function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=$.Deferred();return this.initialized?n.resolve(this.getCurrentProject()):(this.config=e,this.currentProjectGroup=e.group,this.overviewproject=e.overviewproject,this.setupState(),this.getProject(e.initproject,{map_theme:new URLSearchParams(location.search).get("map_theme")}).then(function(e){t.setCurrentProject(e),t.initialized=!0,n.resolve(e)}).fail(function(e){return n.reject(e)})),n.promise()},this.clear=function(){this.config=null,this.initialized=!1,this.projectType=null,this.overviewproject=void 0,this.initialized=!1,this._groupProjects=[],this._projectConfigs={},this.state={baseLayers:{},minScale:null,maxscale:null,currentProject:null,qgis_version:null}},this.setProjectType=function(e){this.projectType=e},this.getConfig=function(){return this.config},this.getState=function(){return this.state},this.setupState=function(){this.state.baseLayers=this.config.baselayers,this.state.minScale=this.config.minscale,this.state.maxScale=this.config.maxscale,this.state.crs=this.config.crs,this.setProjects(this.config.projects)},this.getProjectType=function(){return this.projectType},this.getProjects=function(){return this._groupProjects},this.setProjects=function(e){var t=this;this.clearProjects(),e.forEach(function(e){t.state.qgis_version=e.qgis_version||t.state.qgis_version,e.baselayers=t.config.baselayers,e.minscale=t.config.minscale,e.maxscale=t.config.maxscale,e.crs=t.config.crs,e.vectorurl=t.config.vectorurl,e.rasterurl=t.config.rasterurl,e.overviewprojectgid=t.overviewproject?t.overviewproject.gid:null,t._groupProjects.push(e)})},this.clearProjects=function(){this._groupProjects=[]},this.getListableProjects=function(){var t=this.getCurrentProject().getId();return _.sortBy(this.getProjects().filter(function(e){return null!==e.listable&&void 0!==e.listable?e.listable:!(e.id===t||e.overviewprojectgid&&e.gid===e.overviewprojectgid)&&e}),"title")},this.getCurrentProject=function(){return this.state.currentProject},this.getProject=function(t){var n,r=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{reload:!1},a=$.Deferred(),o=this._groupProjects.find(function(e){return e.gid===t});return o?(n=!i.reload&&this._projectConfigs[t])?a.resolve(new c(n)):this._getProjectFullConfig(o,{map_theme:i.map_theme}).then(function(e){e=_.merge(o,e);e.WMSUrl=r.config.getWmsUrl(e),e.relations=r._setProjectRelations(e),r._projectConfigs[e.gid]=e,r.createProject(e),a.resolve(new c(e))}).fail(function(t){return a.reject(e)}):a.reject("Project doesn't exist"),a.promise()},this._setProjectRelations=function(t){var n=this;return t.relations=(t.relations||[]).map(function(e){return n._updateRelation(t,e)}),t.relations},this._updateRelation=function(e,t){return"ONE"===t.type&&e.layers.find(function(e){if(e.id===t.referencingLayer)return t.name=e.name,t.origname=e.origname,!0}),t},this.getProjectConfigByGid=function(t){return this._groupProjects.find(function(e){return e.gid===t})},this.setProjectAliasUrl=function(t){var e=this.config.projects.find(function(e){return e.gid===t.gid});e&&(e.url=e&&""+(t.host||"")+t.url)},this.getProjectUrl=function(t){var n=this.config&&this.config.urls&&this.config.urls.baseurl,t=this.getProjectConfigByGid(t).url;try{return""+new URL(n)+t}catch(e){return""+location.origin+n+t}},this.getBaseUrl=function(){return this.config.urls.baseurl},this._getProjectFullConfig=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=$.Deferred();return $.get(this.config.getProjectConfigUrl(e)).done(function(n){var r;t.map_theme?(r=Object.values(n.map_themes).flat().find(function(e){return e.theme===t.map_theme}))&&$.get("/"+e.type+"/api/prjtheme/"+e.id+"/"+t.map_theme).done(function(e){var t=e.result,e=e.data;t&&(n.layerstree=e,r.layetstree=e,r.default=!0)}).always(function(){i.resolve(n)}):i.resolve(n)}).fail(function(e){return i.reject(e)}),i.promise()},this.getCurrentProjectGroup=function(){return this.currentProjectGroup},l(this)}s(d,u),r.default=new d},{"core/g3wobject":11,"core/project/project":44,"store/catalog-layers":311,"store/map-layers":315,utils:404}],318:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var u=n.Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,n,r,i,a="",o=void 0,s=void 0,l=0;for(e=u._utf8_encode(e);l<e.length;)r=(t=e.charCodeAt(l++))>>2,i=(3&t)<<4|(t=e.charCodeAt(l++))>>4,o=(15&t)<<2|(n=e.charCodeAt(l++))>>6,s=63&n,isNaN(t)?o=s=64:isNaN(n)&&(s=64),a=a+this._keyStr.charAt(r)+this._keyStr.charAt(i)+this._keyStr.charAt(o)+this._keyStr.charAt(s);return a},decode:function(e){var t,n,r,i,a,o,s="",l=0;for(e=e.replace(/[^A-Za-z0-9+/=]/g,"");l<e.length;)r=this._keyStr.indexOf(e.charAt(l++)),t=(15&(i=this._keyStr.indexOf(e.charAt(l++))))<<4|(a=this._keyStr.indexOf(e.charAt(l++)))>>2,n=(3&a)<<6|(o=this._keyStr.indexOf(e.charAt(l++))),s+=String.fromCharCode(r<<2|i>>4),64!=a&&(s+=String.fromCharCode(t)),64!=o&&(s+=String.fromCharCode(n));return s=u._utf8_decode(s)},_utf8_encode:function(e){e=e.replace(/rn/g,"n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):t=127<r&&r<2048?(t+=String.fromCharCode(r>>6|192))+String.fromCharCode(63&r|128):(t=(t+=String.fromCharCode(r>>12|224))+String.fromCharCode(r>>6&63|128))+String.fromCharCode(63&r|128)}return t},_utf8_decode:function(e){var t,n="",r=0;for(c1=c2=0;r<e.length;)(t=e.charCodeAt(r))<128?(n+=String.fromCharCode(t),r++):191<t&&t<224?(c2=e.charCodeAt(r+1),n+=String.fromCharCode((31&t)<<6|63&c2),r+=2):(c2=e.charCodeAt(r+1),c3=e.charCodeAt(r+2),n+=String.fromCharCode((15&t)<<12|(63&c2)<<6|63&c3),r+=3);return n}}},{}],319:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.XHR=void 0;var s=e("app/constant"),r=e("utils/promisify");function i(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var a,o;n.XHR={get:(o=i(function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.url,e=e.params;return t?(0,r.promisify)($.get(t,void 0===e?{}:e)):Promise.reject("No url")}),function(){return o.apply(this,arguments)}),post:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=e.url,a=e.data,t=e.formdata,o=void 0!==t&&t,s=e.contentType,l=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return new Promise(function(r,t){if(o){var e,n=new FormData;for(e in a)n.append(e,a[e]);$.ajax({type:"POST",url:i,data:n,processData:!1,contentType:!1}).then(function(e,t,n){r(l?{data:e,status:t,request:n}:e)}).fail(function(e){t(e)})}else s?$.ajax({url:i,data:a,type:"POST",processData:!1,contentType:s||!1}).then(function(e,t,n){return r(l?{data:e,status:t,request:n}:e)}).fail(function(e){t(e)}):$.post(i,a).then(function(e,t,n){return r(l?{data:e,status:t,request:n}:e)}).fail(function(e){t(e)})})},htmlescape:function(e){return e=(e=(e=(e=e.replace("&","&amp;")).replace("<","&lt;")).replace(">","&gt;")).replace('"',"&quot;")},fileDownload:function(){var r,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=e.url,a=e.data,e=e.httpMethod,o=void 0===e?"POST":e;return new Promise(function(e,t){var n=$.fileDownload(i,{httpMethod:o,data:a});r=setTimeout(function(){t("Timeout"),n.abort()},s.TIMEOUT),n.done(function(){return e()}).fail(function(e){t(e)}).always(function(){return clearTimeout(r)})})},delete:(a=i(function*(e){var t=e.url,e=e.data,e=void 0===e?{}:e;try{return(yield fetch(t,{method:"DELETE",body:JSON.stringify(e)})).json()}catch(e){return Promise.reject(e)}}),function(e){return a.apply(this,arguments)})}},{"app/constant":5,"utils/promisify":428}],320:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.addZValueToOLFeatureGeometry=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.feature,e=e.geometryType;if((0,a.is3DGeometry)(e)){var n=t.getGeometry(),r=n.getCoordinates();switch(e||n.getType()){case i.GEOMETRY_TYPES.POINTZ:case i.GEOMETRY_TYPES.POINTM:case i.GEOMETRY_TYPES.POINTZM:case i.GEOMETRY_TYPES.POINT25D:r.push(0),t.getGeometry().setCoordinates(r);break;case i.GEOMETRY_TYPES.MULTIPOINTZ:case i.GEOMETRY_TYPES.MULTIPOINTM:case i.GEOMETRY_TYPES.MULTIPOINTZM:case i.GEOMETRY_TYPES.MULTIPOINT25D:case i.GEOMETRY_TYPES.LINESTRINGZ:case i.GEOMETRY_TYPES.LINESTRINGM:case i.GEOMETRY_TYPES.LINESTRINGZM:case i.GEOMETRY_TYPES.LINESTRING25D:case i.GEOMETRY_TYPES.LINEZ:case i.GEOMETRY_TYPES.LINEM:case i.GEOMETRY_TYPES.LINEZM:case i.GEOMETRY_TYPES.LINE25D:r.forEach(function(e){return e.push(0)}),t.getGeometry().setCoordinates(r);break;case i.GEOMETRY_TYPES.MULTILINESTRINGZ:case i.GEOMETRY_TYPES.MULTILINESTRINGM:case i.GEOMETRY_TYPES.MULTILINESTRINGZM:case i.GEOMETRY_TYPES.MULTILINESTRING25D:case i.GEOMETRY_TYPES.MULTILINEZ:case i.GEOMETRY_TYPES.MULTILINEM:case i.GEOMETRY_TYPES.MULTILINEZM:case i.GEOMETRY_TYPES.MULTILINE25D:r.forEach(function(e){return e.forEach(function(e){return e.push(0)})}),t.getGeometry().setCoordinates(r);break;case i.GEOMETRY_TYPES.POLYGONZ:case i.GEOMETRY_TYPES.POLYGONM:case i.GEOMETRY_TYPES.POLYGONZM:case i.GEOMETRY_TYPES.POLYGON25D:r[0].forEach(function(e){return e.push(0)}),t.getGeometry().setCoordinates(r);break;case i.GEOMETRY_TYPES.MULTIPOLYGONZ:case i.GEOMETRY_TYPES.MULTIPOLYGONM:case i.GEOMETRY_TYPES.MULTIPOLYGOZM:case i.GEOMETRY_TYPES.MULTIPOLYGON25D:r.forEach(function(e){return e[0].forEach(function(e){return e.push(0)})}),t.getGeometry().setCoordinates(r)}}return t};var i=e("app/constant"),a=e("utils/is3DGeometry")},{"app/constant":5,"utils/is3DGeometry":407}],321:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.appendParams=function(e,t){var n=[],r=(Object.keys(t).forEach(function(e){null!==t[e]&&void 0!==t[e]&&n.push(e+"="+encodeURIComponent(t[e]))}),n.join("&"));return(e=-1===(e=e.replace(/[?&]$/,"")).indexOf("?")?e+"?":e+"&")+r}},{}],322:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.areCoordinatesEqual=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];return e[0]===t[0]&&e[1]===t[1]}},{}],323:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.base=function(e,t,n){var r=arguments.callee.caller;if(r.superClass_)return r.superClass_.constructor.apply(e,Array.prototype.slice.call(arguments,1));for(var i=Array.prototype.slice.call(arguments,2),a=!1,o=e.constructor;o;o=o.superClass_&&o.superClass_.constructor)if(o.prototype[t]===r)a=!0;else if(a)return o.prototype[t].apply(e,i);{if(e[t]===r)return e.constructor.prototype[t].apply(e,i);throw Error("base called from a method of one name to a method of a different name")}}},{}],324:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.basemixin=function(e,t){return(0,r.merge)(e.prototype,t)};var r=e("./merge")},{"./merge":416}],325:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.capitalize_first_letter=function(e){return""+e[0].toUpperCase()+e.slice(1)}},{}],326:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.closestOnSegment=function(e,t){var n=e[0],e=e[1],r=t[0][0],i=t[0][1],a=t[1][0],t=t[1][1],o=a-r,s=t-i,n=0==o&&0==s?0:(o*(n-r)+s*(e-i))/(o*o+s*s||0);if(n<=0)return[r,i];if(1<=n)return[a,t];return[r+n*o,i+n*s]}},{}],327:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.colorHEXToRGB=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"#FFFFFF",t=parseInt(e.substr(1,2),16),n=parseInt(e.substr(3,2),16),e=parseInt(e.substr(5,2),16);return[t,n,e]}},{}],328:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertDEGToDM=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.deg,e=e.output,e=void 0===e?"Array":e,t=Math.abs(t),n=Math.floor(t),r=60*(t-n);switch(e){case"Array":return[n,r];case"Object":return{degrees:n,minutes:r};default:return n+""+r+"'"}}},{}],329:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertDEGToDMS=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.deg,n=e.lat,r=e.lon,e=e.output,e=void 0===e?"Array":e,i=Math.abs(t),a=Math.floor(i),i=60*(i-a),o=Math.floor(i),s=(60*(i-o)).toFixed(2),l=void 0;n&&(l=0<=t?"N":"S");r&&(l=0<=t?"E":"W");switch(e){case"Array":return[a,o,s,l];case"Object":return{degrees:a,minutes:o,seconds:s,direction:l};default:return a+""+o+"'"+s+'"'+l}}},{}],330:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertDMSToDEG=function(e){var t=e.dms,e=e.type,e="Array"===(void 0===e?"Array":e)?t:t.split(/[^\d\w\.]+/);return(Number(+e[0])+Number(+e[1])/60+Number(+e[2])/3600).toFixed(6)*(["S","W"].includes(e[3])?-1:1)}},{}],331:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertDMToDEG=function(e){var t=e.dms,e=e.type,e="Array"===(void 0===e?"Array":e)?t:t.split(/[^\d\w\.]+/);return+(Number(+e[0])+Number(+e[1])/60).toFixed(6)}},{}],332:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertFeatureToGEOJSON=function(e){return(new ol.format.GeoJSON).writeFeatureObject(e)}},{}],333:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertObjectToUrlParams=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return $.param(e)}},{}],334:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertQGISDateTimeFormatToMoment=function(e){var t=(e=e.replace(/y/g,"Y")).match(/d/g);t&&t.length<3&&(e=e.replace(/d/g,"D"));return e}},{}],335:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertSingleMultiGeometry=function(e,t){var n=e.getType();return t&&n!==t?(n=(0,r.isMultiGeometry)(n),t=(0,r.isMultiGeometry)(t),!n||t?n||!t?e:(0,a.singleGeometriesToMultiGeometry)([e]):(0,i.multiGeometryToSingleGeometries)(e)):e};var r=e("utils/isMultiGeometry"),i=e("utils/multiGeometryToSingleGeometries"),a=e("utils/singleGeometriesToMultiGeometry")},{"utils/isMultiGeometry":410,"utils/multiGeometryToSingleGeometries":419,"utils/singleGeometriesToMultiGeometry":439}],336:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertVectorFeaturesToResultFeatures=function(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).map(function(e){return e.properties[r.G3W_FID]=e.id,{geometry:e.geometry,attributes:e.properties,id:e.id}})};var r=e("app/constant")},{"app/constant":5}],337:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.coordinatesToGeometry=function(e,t){switch(e){case r.GEOMETRY_TYPES.POLYGON:case r.GEOMETRY_TYPES.POLYGONZ:case r.GEOMETRY_TYPES.POLYGONM:case r.GEOMETRY_TYPES.POLYGONZM:case r.GEOMETRY_TYPES.POLYGON25D:return new ol.geom.Polygon(t);case r.GEOMETRY_TYPES.MULTIPOLYGON:case r.GEOMETRY_TYPES.MULTIPOLYGONZ:case r.GEOMETRY_TYPES.MULTIPOLYGONM:case r.GEOMETRY_TYPES.MULTIPOLYGONZM:case r.GEOMETRY_TYPES.MULTIPOLYGON25D:return new ol.geom.MultiPolygon(t);case r.GEOMETRY_TYPES.LINESTRING:case r.GEOMETRY_TYPES.LINESTRINGZ:case r.GEOMETRY_TYPES.LINESTRINGM:case r.GEOMETRY_TYPES.LINESTRINGZM:case r.GEOMETRY_TYPES.LINESTRING25D:case r.GEOMETRY_TYPES.LINE:case r.GEOMETRY_TYPES.LINEZ:case r.GEOMETRY_TYPES.LINEM:case r.GEOMETRY_TYPES.LINEZM:case r.GEOMETRY_TYPES.LINE25D:return new ol.geom.LineString(t);case r.GEOMETRY_TYPES.MULTILINE:case r.GEOMETRY_TYPES.MULTILINEZ:case r.GEOMETRY_TYPES.MULTILINEM:case r.GEOMETRY_TYPES.MULTILINEZM:case r.GEOMETRY_TYPES.MULTILINE25D:case r.GEOMETRY_TYPES.MULTILINESTRING:case r.GEOMETRY_TYPES.MULTILINESTRINGZ:case r.GEOMETRY_TYPES.MULTILINESTRINGM:case r.GEOMETRY_TYPES.MULTILINESTRINGZM:case r.GEOMETRY_TYPES.MULTILINESTRING25D:return new ol.geom.MultiLineString(t);case r.GEOMETRY_TYPES.POINT:case r.GEOMETRY_TYPES.POINTZ:case r.GEOMETRY_TYPES.POINTM:case r.GEOMETRY_TYPES.POINTZM:case r.GEOMETRY_TYPES.POINT25D:return new ol.geom.Point(t);case r.GEOMETRY_TYPES.MULTIPOINT:case r.GEOMETRY_TYPES.MULTIPOINTZ:case r.GEOMETRY_TYPES.MULTIPOINTM:case r.GEOMETRY_TYPES.MULTIPOINTZM:case r.GEOMETRY_TYPES.MULTIPOINT25D:return new ol.geom.MultiPoint(t);default:return new ol.geom.Point(t)}};var r=e("app/constant")},{"app/constant":5}],338:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.copyUrl=function(e){var t=document.createElement("input");document.body.appendChild(t),t.value=e,t.select(),document.execCommand("copy"),document.body.removeChild(t)}},{}],339:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createFeatureFromBBOX=function(e){if(Array.isArray(e)&&4===e.length)return new ol.Feature(ol.geom.Polygon.fromExtent(e))}},{}],340:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createFeatureFromCoordinates=function(e){if(Array.isArray(e)&&2===e.length)return new ol.Feature(new ol.geom.Point(e))}},{}],341:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createFeatureFromFeatureObject=function(e){var t=e.id,e=e.feature,n=void 0===e?{}:e,e=n,r=e.geometry,i=e.attributes;return n=(0,a.createFeatureFromGeometry)({id:t,geometry:r}),Object.keys(i).forEach(function(e){return n.set(e,i[e])}),n};var a=e("utils/createFeatureFromGeometry")},{"utils/createFeatureFromGeometry":342}],342:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createFeatureFromGeometry=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,e=e.geometry;if(e)return(e=new ol.Feature(e)).setId(t),e}},{}],343:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createFilterFormField=function(e){var t=e.layer,n=e.field,r=e.value,i=e.search_endpoint,i=void 0===i?"api":i,e=e.operator,a=void 0===e?"eq":e,o=void 0;switch(i){case"ows":o=(new l).setExpression((new u).createExpressionFromField({field:n,value:r,operator:a,layerName:t.getWMSLayerName()}).get());break;case"api":o=(0,s.createSingleFieldParameter)({field:n,value:r,operator:a})}return o};var s=e("utils/createSingleFieldParameter"),l=e("core/layers/filter/filter"),u=e("core/layers/filter/expression")},{"core/layers/filter/expression":17,"core/layers/filter/filter":18,"utils/createSingleFieldParameter":353}],344:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createFilterFormInputs=function(e){var t=e.layer,n=e.search_endpoint,n=void 0===n?"api":n,e=e.inputs,a=void 0===e?[]:e,r=void 0;switch(n){case"ows":r=[].concat(t).map(function(e){var t=new l,e=(t.createExpressionFromFilter(a,e.getWMSLayerName()),new s);return e.setExpression(t.get()),e});break;case"api":var i=a.map(function(e,t){var n=e.attribute,r=e.value,i=e.operator,e=e.logicop;return Array.isArray(n)?n.map(function(e,t){return(0,o.createSingleFieldParameter)({field:e,value:r[t],operator:i,logicop:null})}).join("|AND,")||"":(0<t?"|"+a[t-1].logicop+",":"")+(0,o.createSingleFieldParameter)({field:n,value:r,operator:i,logicop:e})}).join("")||void 0;r=[].concat(t).map(function(){return i})}return Array.isArray(t)?r:r[0]};var o=e("utils/createSingleFieldParameter"),s=e("core/layers/filter/filter"),l=e("core/layers/filter/expression")},{"core/layers/filter/expression":17,"core/layers/filter/filter":18,"utils/createSingleFieldParameter":353}],345:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},n=(n.createFilterFromString=function(e){var t=e.layer,n=e.search_endpoint,n=void 0===n?"api":n,e=e.filter,r=void 0===e?"":e;switch(n){case"ows":r=(new a).setExpression(new o({filter:r,layerName:t.getWMSLayerName()}).get());break;case"api":r=s.reduce(function(e,t){t=i(t,2),t[0],t=t[1];return e.replace(new RegExp("\\s+"+t+"\\s+","g"),""+t).replace(new RegExp("'"+t,"g"),""+t).replace(new RegExp(t+"'","g"),""+t)},r).replace(/'$/g,"").replace(/"/g,""),r=s.reduce(function(e,t){var t=i(t,2),n=t[0],t=t[1];return e.replace(new RegExp(t,"g"),["AND","OR"].includes(t)?"|"+n+",":"|"+n+"|")},r).split("|").map(function(e,t){return 0==(t+1)%3?encodeURIComponent(e):e}).join("|")}return r},e("app/constant")),a=e("core/layers/filter/filter"),o=e("core/layers/filter/expression"),s=Object.entries(n.FILTER_EXPRESSION_OPERATORS)},{"app/constant":5,"core/layers/filter/expression":17,"core/layers/filter/filter":18}],346:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createInputsFormFromFilter=void 0;n.createInputsFormFromFilter=(r=function*(e){for(var t=0;t<=e.forminputs.length-1;t++){var n=e.forminputs[t],r="autocompletefield"===n.type;n.values=[].concat(l("selectfield"===n.type?[a.SEARCH_ALLVALUE]:[]),l(n.dependance_strict||r?n.values:yield(0,s.getDataForSearchInput)({state:e,field:n.attribute}))).map(function(e){return"Object"===(0,o.toRawType)(e)?e:{key:e,value:e}}),n.dependance&&(e.loading[n.dependance]=!1,n.disabled=n.dependance_strict),n._values=[].concat(l(n.values)),n.loading=!1}},i=function(){var s=r.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})},function(e){return i.apply(this,arguments)});var r,i,a=e("app/constant"),o=e("utils/toRawType"),s=e("utils/getDataForSearchInput");function l(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}},{"app/constant":5,"utils/getDataForSearchInput":378,"utils/toRawType":448}],347:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")};n.createLayerStyle=function(e){if(e)return new ol.style.Style(Object.entries(e).reduce(function(e,t){var t=r(t,2),n=t[0],t=t[1];return"point"===n&&t.icon&&(e.image=new ol.style.Icon({src:t.icon.url,imageSize:t.icon.width})),"line"===n&&(e.stroke=new ol.style.Stroke({color:t.color,width:t.width})),"polygon"===n&&(e.fill=new ol.style.Fill({color:t.color})),e},{}))}},{}],348:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createMeasureTooltip=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=e.map,e=e.feature,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=document.createElement("div"),a=(i.className="mtooltip mtooltip-measure",new ol.Overlay({element:i,offset:[0,-15],positioning:"bottom-center"}));return n.addOverlay(a),{tooltip:a,unbyKey:e.getGeometry().on("change",function(e){var t=void 0,e=e.target;e instanceof ol.geom.Polygon?t=e.getInteriorPoint().getCoordinates():e instanceof ol.geom.MultiPolygon?t=e.getInteriorPoints().getCoordinates()[0]:(e instanceof ol.geom.LineString||e instanceof ol.geom.MultiLineString)&&(t=e.getLastCoordinate()),i.innerHTML=(0,o.formatMeasure)({geometry:e,projection:n.getView().getProjection()},r),a.setPosition(t)})}};var o=e("utils/formatMeasure")},{"utils/formatMeasure":369}],349:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createOlFeatureFromApiResponseFeature=function(e){var t=void 0!==e.properties?e.properties:{},n=(t[r.G3W_FID]=e.id,new ol.Feature(e.geometry&&new ol.geom[e.geometry.type](e.geometry.coordinates)));return n.setProperties(t),n.setId(e.id),n};var r=e("app/constant")},{"app/constant":5}],350:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createOlLayer=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.color,n=e.style,r=e.source||new ol.source.Vector({features:e.features||new ol.Collection}),r=new ol.layer.Vector({id:e.id,source:r});!n&&(0,i.getAllPointGeometryTypes)().includes(e.geometryType)&&(n=new ol.style.Style({image:new ol.style.Circle({fill:new ol.style.Fill({color:t}),radius:5})}));!n&&(0,a.getAllLineGeometryTypes)().includes(e.geometryType)&&(n=new ol.style.Style({stroke:new ol.style.Stroke({color:t,width:3})}));!n&&(0,o.getAllPolygonGeometryTypes)().includes(e.geometryType)&&(n=new ol.style.Style({stroke:new ol.style.Stroke({color:"#000000",width:1}),fill:new ol.style.Fill({color:t})}),r.setOpacity(.6));return r.setStyle(n),r};var i=e("utils/getAllPointGeometryTypes"),a=e("utils/getAllLineGeometryTypes"),o=e("utils/getAllPolygonGeometryTypes")},{"utils/getAllLineGeometryTypes":371,"utils/getAllPointGeometryTypes":372,"utils/getAllPolygonGeometryTypes":373}],351:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createPolygonLayerFromBBox=function(e){return new ol.layer.Vector({source:new ol.source.Vector({features:[new ol.Feature(new ol.geom.Polygon.fromExtent(e))]})})}},{}],352:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createSelectedStyle=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.geometryType,n=e.color,r=void 0===n?"rgb(255,255,0)":n,n=e.fill,i=void 0===n||n;switch(t){case"LineString":case"MultiLineString":return new ol.style.Style({stroke:new ol.style.Stroke({color:r,width:4})});case"Point":case"MultiPoint":return new ol.style.Style({image:new ol.style.Circle({radius:6,fill:i&&new ol.style.Fill({color:r}),stroke:!i&&new ol.style.Stroke({color:r,width:4})}),zIndex:1/0});case"MultiPolygon":case"Polygon":return new ol.style.Style({stroke:new ol.style.Stroke({color:r,width:4}),fill:i&&new ol.style.Fill({color:ol.color.asString(ol.color.asArray(r).splice(3,1,.5))})});default:return null}}},{}],353:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createSingleFieldParameter=function(e){var t=e.layer,n=e.field,r=e.value,i=e.operator,a=void 0===i?"eq":i,i=e.logicop,i=void 0===i?"OR":i,e=e.search_endpoint,e=void 0===e?"api":e;return"api"!==e?(0,s.createFilterFromString)({layer:t,search_endpoint:e,filter:[].concat(r).map(function(e){return'"'+n+'" '+o.FILTER_EXPRESSION_OPERATORS[a]+" '"+encodeURIComponent(e)+"' "}).join(i+" ")}):[].concat(r).map(function(e){return n+"|"+a.toLowerCase()+"|"+encodeURIComponent(e)}).join("|"+i+",")};var o=e("app/constant"),s=e("utils/createFilterFromString")},{"app/constant":5,"utils/createFilterFromString":345}],354:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createStyleFunctionToVectorLayer=function(){function e(e,t){var n=a.color,r=a.field,n=n.rgba?"rgba("+n.rgba.r+","+n.rgba.g+","+n.rgba.b+","+n.rgba.a+")":n,i=(0,o.getDefaultLayerStyle)(e.getGeometry().getType(),{color:n});return r&&i.setText(new ol.style.Text({text:""+e.get(r),font:"bold",scale:2,offsetY:15,fill:new ol.style.Fill({color:n}),stroke:new ol.style.Stroke({color:"#FFF",width:2})})),i}var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e._g3w_options=a,e};var o=e("utils/getDefaultLayerStyle")},{"utils/getDefaultLayerStyle":379}],355:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createVectorLayerFromFeatures=function(e){return new ol.layer.Vector({source:new ol.source.Vector({features:Array.isArray(e)?e:[e]})})}},{}],356:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createVectorLayerFromFile=void 0;a=l(function*(r,i,a,o,s){try{return yield new Promise((n=l(function*(e,t){var n=new JSZip,n=(n.load(yield s.arrayBuffer(s)),n.file(/.kml$/i)),n=n[n.length-1];n?e(x(r,i,a,o,n.asText(),new ol.format.KML({extractStyles:!1}),"EPSG:4326")):t()}),function(e,t){return n.apply(this,arguments)}))}catch(e){return Promise.reject()}var n});var a,o,r,_=function(e,t,n,r,i){return a.apply(this,arguments)},b=(o=l(function*(n,r,i,a,o){try{return yield new Promise((s=l(function*(t,e){shp(yield o.arrayBuffer(o)).then(function(e){t(x(n,r,i,a,JSON.stringify(e),new ol.format.GeoJSON({}),"EPSG:4326"))}).catch(e)}),function(e,t){return s.apply(this,arguments)}))}catch(e){return Promise.reject()}var s}),function(e,t,n,r,i){return o.apply(this,arguments)}),s=(n.createVectorLayerFromFile=(r=l(function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.name,n=e.type,r=e.crs,i=e.mapCrs,a=e.data,o=e.style;switch(n){case"gpx":return x(t,r,i,o,a,new ol.format.GPX);case"gml":return x(t,r,i,o,a,new ol.format.WMSGetFeatureInfo);case"geojson":return x(t,r,i,o,a,new ol.format.GeoJSON);case"kml":return x(t,r,i,o,a,new ol.format.KML({extractStyles:!1}),"EPSG:4326");case"csv":var s=t,l=r,u=i,c=o,d=a,p=d.headers,f=d.separator,h=d.values,g=d.x,v=d.y,m=[],y=[];return(h.forEach(function(e,t){var n,r={},e=e.split(f);e.length===p.length?(n=[],e.forEach(function(e,t){t=p[t];t===g&&(n[0]=+e),t===v&&(n[1]=+e),r[t]=e}),void 0===n.find(function(e){return Number.isNaN(e)})&&(e=new ol.geom.Point(n),l!==u&&e.transform(l,u),(e=new ol.Feature(e)).setId(t),e.setProperties(r),m.push(e))):y.push({row:t+1,value:h[t]})}),m.length)?(y.length&&GUI.showUserMessage({type:"warning",message:"sdk.mapcontrols.addlayer.messages.csv.warning",hooks:{footer:{template:'<select v-select2="errorrows[0].value" class="skin-color" :search="false" style="width:100%">\n              <option v-for="errorrow in errorrows" :key="errorrow.row" :value="errorrow.value">[{{ errorrow.row}}] {{errorrow.value}}</option>\n          </select>',data:function(){return{errorrows:y}}}},autoclose:!1}),new ol.layer.Vector({source:new ol.source.Vector({features:m}),name:s,_fields:p,id:(0,w.getUniqueDomId)(),style:c})):Promise.reject();case"kmz":return _(t,r,i,o,a);case"zip":return b(t,r,i,o,a)}}),function(){return r.apply(this,arguments)}),e("app/constant")),w=e("./getUniqueDomId");function l(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}function x(e,t,n,r,i,a,o){i=a.readFeatures(i,{dataProjection:o=void 0===o?t:o,featureProjection:n||o});if(0!==i.length)return a instanceof ol.format.KML&&i.forEach(function(e){return e.unset("styleUrl")}),new ol.layer.Vector({source:new ol.source.Vector({features:i}),name:e,_fields:Object.keys(i[0].getProperties()).filter(function(e){return s.GEOMETRY_FIELDS.indexOf(e)<0}),id:(0,w.getUniqueDomId)(),style:r})}},{"./getUniqueDomId":397,"app/constant":5}],357:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createVectorLayerFromGeometry=function(e){return(0,r.createVectorLayerFromFeatures)(new ol.Feature(e))};var r=e("utils/createVectorLayerFromFeatures")},{"utils/createVectorLayerFromFeatures":355}],358:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createWMSLayer=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.url,n=e.name,r=e.projection,e=e.layers,e=void 0===e?[]:e,i=n||(0,a.getUniqueDomId)(),e=new o({id:i,layers:e,projection:r,url:t}),r=e.getOLLayer();return r.set("id",i),r.set("name",n||i),{wmslayer:e,olLayer:r}};var a=e("utils/getUniqueDomId"),o=e("core/layers/map/wmslayer")},{"core/layers/map/wmslayer":29,"utils/getUniqueDomId":397}],359:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.crsToCrsObject=function(e){if(null==e)return e;if("Object"===(0,i.toRawType)(e)&&e.epsg)return e.epsg=(0,r.normalizeEpsg)(e.epsg),e;return{epsg:(0,r.normalizeEpsg)(e),proj4:"",axisinverted:!1,geographic:!1}};var r=e("utils/normalizeEpsg"),i=e("utils/toRawType")},{"utils/normalizeEpsg":422,"utils/toRawType":448}],360:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.debounce=function(r){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:500,a=void 0;return function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];clearTimeout(a),a=setTimeout(function(){r.apply(void 0,t)},i)}}},{}],361:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.dissolve=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.features,n=void 0===t?[]:t,t=e.index,r=void 0===t?0:t,t=e.clone,e=void 0!==t&&t,i=new jsts.io.OL3Parser,a=n.length;if(0===a)return null;if(1===a)return n[0];var o=void 0,t=e?n[r].clone():n[r],e=t.getGeometry(),s=e.getType();if("LineString"===s){for(var l=new jsts.operation.linemerge.LineMerger,u=0;u<a;u++)l.addLineString((new jsts.geom.GeometryFactory).createLineString(i.read(n[u].getGeometry()).getCoordinates()));var c=l.getMergedLineStrings();o=1===c.size()?c.toArray()[0]:null}if("LineString"!==s){o=i.read(e);for(var d=0;d<a;d++)r!==d&&(o=o.union(i.read(n[d].getGeometry())))}return o&&(c=i.write(o),e=c.getType(),null!==(e=e===s?c.getCoordinates():-1!==s.indexOf("Multi")&&e===s.replace("Multi","")?[c.getCoordinates()]:null))?(t.getGeometry().setCoordinates(e),t):null}},{}],362:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.distance=function(e,t){return Math.sqrt((0,r.squaredDistance)(e,t))};var r=e("utils/squaredDistance")},{"utils/squaredDistance":446}],363:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.doSearch=void 0;n.doSearch=(r=function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.filter,n=e.queryUrl,r=e.show,i=e.feature_count,i=void 0===i?1e4:i,e=e.state,n=void 0!==n?n:e.queryurl,r=void 0!==r?r:"search"===e.type,a=(e.searching=!0,void 0),o=void 0;try{a=yield v.default.getData("search:features",{inputs:{layer:e.search_layers,filter:t||(0,y.createFilterFormInputs)({layer:e.search_layers,inputs:e.forminputs.filter(function(e){return-1===[null,void 0,h.SEARCH_ALLVALUE].indexOf(e.value)&&""!==e.value.toString().trim()})}),queryUrl:n,formatter:1,feature_count:i,raw:!1},outputs:r&&{title:e.title}}),r&&g.default.getCurrentProject().state.autozoom_query&&a&&a.data&&1===a.data.length&&m.default.getService("map").zoomToFeatures(a.data[0].features);var s,l,u,c=!r&&"search_1n"===e.type,d=c&&(a.data[0]||{}).features||[],p=d.length&&g.default.getCurrentProject().getRelationById(e.search_1n_relationid),f=p&&g.default.getCurrentProject().getLayerById(p.referencedLayer);c&&!d.length&&(v.default.showEmptyOutputs(),o=[]),p&&(s=p.fieldRef,l=s.referencedField,u=s.referencingField,o=yield v.default.getData("search:features",{inputs:{layer:f,filter:(0,y.createFilterFormInputs)({layer:f,inputs:d.map(function(t){return{attribute:1===l.length?l[0]:l,logicop:"OR",operator:"eq",value:[].concat(function(e){{if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}}(new Set(1===u.length?d.map(function(e){return e.get(u[0])}):u.map(function(e){return t.get(e)}))))}})}),formatter:1,feature_count:i},outputs:{title:e.title}}))}catch(e){}return e.searching=!1,o||a},i=function(){var s=r.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})},function(){return i.apply(this,arguments)});var r,i,h=e("app/constant"),g=a(e("store/projects")),v=a(e("services/data")),m=a(e("services/gui")),y=e("utils/createFilterFormInputs");function a(e){return e&&e.__esModule?e:{default:e}}},{"app/constant":5,"services/data":300,"services/gui":302,"store/projects":317,"utils/createFilterFormInputs":344}],364:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.downloadCSV=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.filename,t=void 0===t?(0,r.getUniqueDomId)():t,e=e.items,e=void 0===e?[]:e;t+=".csv",e=function(e){for(var t="",n=0;n<e.length;n++){var r,i="";for(r in e[n])""!==i&&(i+=";"),i+=e[n][r];t+=i+"\r\n"}return t}(e),e=new Blob([e],{type:"text/csv;charset=utf-8;"});{var n;navigator.msSaveBlob?navigator.msSaveBlob(e,t):void 0!==(n=document.createElement("a")).download&&(e=URL.createObjectURL(e),n.setAttribute("href",e),n.setAttribute("download",t),n.style.visibility="hidden",n.click())}};var r=e("./getUniqueDomId")},{"./getUniqueDomId":397}],365:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.downloadCSVLayerFeatures=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=e.layer,e=e.alias,i=void 0===e||e,e=Object.keys(n.features[0].attributes),t=(0,o.getAlphanumericPropertiesFromFeature)(e),a=i?t.map(function(t){var e=n.attributes.find(function(e){return e.name===t});return e?e.label:t}):t,e=n.features.map(function(e){var n=e.attributes,r={};return t.forEach(function(e,t){t=!i&&e||a[t];r[t]=n[e]}),r});(0,r.downloadCSV)({filename:n.id,items:e})};var r=e("utils/downloadCSV"),o=e("utils/getAlphanumericPropertiesFromFeature")},{"utils/downloadCSV":364,"utils/getAlphanumericPropertiesFromFeature":374}],366:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i;n.downloadFile=(r=function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.filename,n=e.content,r=e.url,e=e.mime_type,e=void 0===e?"text/plain":e;if(n)return a(new Blob([n],{type:e}),t,e);if(r){n=yield fetch(r);if(400===n.status||500===n.status)throw(yield n.json()).message;200===n.status&&a(yield n.blob(),t||n.headers.get("content-disposition").split("filename=").length?n.headers.get("content-disposition").split("filename=")[1]:"g3w_download_file",e||n.headers.get("content-type"))}},i=function(){var s=r.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})},function(){return i.apply(this,arguments)});function a(e,t,n){var r=document.createElement("a");r.setAttribute("href",window.URL.createObjectURL(e)),r.setAttribute("download",t),r.dataset.downloadurl=[n,r.download,r.href].join(":"),r.click()}},{}],367:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.findSelfIntersects=function(e){e=(new jsts.io.OL3Parser).read(e);if(new jsts.operation.IsSimpleOp(e).isSimpleLinearGeometry(e))return!1;if(!new jsts.operation.valid.ConsistentAreaTester(new jsts.geomgraph.GeometryGraph(0,e)).isNodeConsistentArea())return!0}},{}],368:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.flattenObject=function e(t,n){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};for(var i in t){var a=n?n+"_"+i:i;"object"==o(t[i])?e(t[i],a,r):r[a]=t[i]}return r}},{}],369:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.formatMeasure=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.geometry,e=e.projection,n=t.getType(),r=(0,a.getCurrentMapUnit)();{var i;return(0,l.isLineGeometryType)(n)?(0,o.getLengthMessageText)({unit:r,projection:e,geometry:t}):(0,u.isPolygonGeometryType)(n)?((i=void 0,c.isMultiGeometry)(n)?(i=[],(0,d.multiGeometryToSingleGeometries)(t).forEach(function(e){e.getLinearRing().getCoordinates().forEach(function(e){return i.push(e)})})):i=t.getLinearRing().getCoordinates(),(0,s.getAreaMessageText)({unit:r,geometry:t,projection:e,segments:i})):void 0}};var a=e("utils/getCurrentMapUnit"),o=e("utils/getLengthMessageText"),s=e("utils/getAreaMessageText"),l=e("utils/isLineGeometryType"),u=e("utils/isPolygonGeometryType"),c=e("utils/isMultiGeometry"),d=e("utils/multiGeometryToSingleGeometries")},{"utils/getAreaMessageText":375,"utils/getCurrentMapUnit":376,"utils/getLengthMessageText":384,"utils/isLineGeometryType":409,"utils/isMultiGeometry":410,"utils/isPolygonGeometryType":412,"utils/multiGeometryToSingleGeometries":419}],370:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getAjaxResponses=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=$.Deferred(),n=[],r=[],i=e.length;return e.forEach(function(e){e.then(function(e){n.push(e)}).fail(function(e){r.push(e)}).always(function(){0===(i=0<i?i-1:i)&&t.resolve({done:n,fail:r})})}),t.promise()}},{}],371:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getAllLineGeometryTypes=function(){return[r.GEOMETRY_TYPES.LINESTRING,r.GEOMETRY_TYPES.LINESTRINGZ,r.GEOMETRY_TYPES.LINESTRINGM,r.GEOMETRY_TYPES.LINESTRINGZM,r.GEOMETRY_TYPES.LINESTRING25D,r.GEOMETRY_TYPES.MULTILINESTRING,r.GEOMETRY_TYPES.MULTILINESTRINGZ,r.GEOMETRY_TYPES.MULTILINESTRINGM,r.GEOMETRY_TYPES.MULTILINESTRINGZM,r.GEOMETRY_TYPES.MULTILINESTRING25D,r.GEOMETRY_TYPES.LINE,r.GEOMETRY_TYPES.LINEZ,r.GEOMETRY_TYPES.LINEM,r.GEOMETRY_TYPES.LINEZM,r.GEOMETRY_TYPES.LINE25D,r.GEOMETRY_TYPES.MULTILINE,r.GEOMETRY_TYPES.MULTILINEZ,r.GEOMETRY_TYPES.MULTILINEM,r.GEOMETRY_TYPES.MULTILINEZM,r.GEOMETRY_TYPES.MULTILINE25D]};var r=e("app/constant")},{"app/constant":5}],372:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getAllPointGeometryTypes=function(){return[r.GEOMETRY_TYPES.POINT,r.GEOMETRY_TYPES.POINTZ,r.GEOMETRY_TYPES.POINTM,r.GEOMETRY_TYPES.POINTZM,r.GEOMETRY_TYPES.POINT25D,r.GEOMETRY_TYPES.MULTIPOINT,r.GEOMETRY_TYPES.MULTIPOINTZ,r.GEOMETRY_TYPES.MULTIPOINTM,r.GEOMETRY_TYPES.MULTIPOINTZM,r.GEOMETRY_TYPES.MULTIPOINT25D]};var r=e("app/constant")},{"app/constant":5}],373:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getAllPolygonGeometryTypes=function(){return[r.GEOMETRY_TYPES.POLYGON,r.GEOMETRY_TYPES.POLYGONZ,r.GEOMETRY_TYPES.POLYGONM,r.GEOMETRY_TYPES.POLYGONZM,r.GEOMETRY_TYPES.POLYGON25D,r.GEOMETRY_TYPES.MULTIPOLYGON,r.GEOMETRY_TYPES.MULTIPOLYGONZ,r.GEOMETRY_TYPES.MULTIPOLYGONM,r.GEOMETRY_TYPES.MULTIPOLYGONZM,r.GEOMETRY_TYPES.MULTIPOLYGON25D]};var r=e("app/constant")},{"app/constant":5}],374:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getAlphanumericPropertiesFromFeature=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return(e=Array.isArray(e)?e:Object.keys(e)).filter(function(e){return-1===r.GEOMETRY_FIELDS.indexOf(e)})};var r=e("app/constant")},{"app/constant":5}],375:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getAreaMessageText=function(e){var t=e.unit,n=e.geometry,r=e.projection,e=e.segments,e=void 0===e?[]:e,i=(0,o.needUseSphereMethods)(r),i=Math.round(i?ol.sphere.getArea(n,{projection:r.getCode()}):n.getArea()),n=void 0,a="";2<e.length&&(a+=(0,s.getLengthMessageText)({unit:t,projection:r,geometry:new ol.geom.LineString(e)})+" <br>");n="nautical"===t?(0,l.transformMeterArea)(i,t)+" nmi":1e6<i?(Math.round(i/1e6*100)/100).toFixed(6)+" km<sup>2</sup>":(Math.round(100*i)/100).toFixed(3)+" m<sup>2</sup>";a&&(n="Area: "+n+' <br><div style="width: 100%; padding: 3px; border-bottom: 2px solid #ffffff"></div> '+a);return n};var o=e("utils/needUseSphereMethods"),s=e("utils/getLengthMessageText"),l=e("utils/transformMeterArea")},{"utils/getLengthMessageText":384,"utils/needUseSphereMethods":420,"utils/transformMeterArea":450}],376:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getCurrentMapUnit=function(){return r.default.map.unit};var n=e("store/application-state"),r=(e=n)&&e.__esModule?e:{default:e}},{"store/application-state":310}],377:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getDPI=function(){return r.DOTS_PER_INCH};var r=e("constant")},{constant:5}],378:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getDataForSearchInput=void 0;var r,i,s=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},l=n.getDataForSearchInput=(r=function*(e){var t=e.state,n=e.field,r=e.suggest;try{var i=t.forminputs.find(function(e){return e.attribute===n}),a=i&&i.dependance,o=a&&t.forminputs.some(function(e){return a===e.dependance&&e.dvalues.length});return(yield Promise.allSettled(t.search_layers.map(function(e){return e.getFilterData({suggest:r,fformatter:n,ordering:n,field:l.field({state:t,field:a,fields:o&&![u.SEARCH_ALLVALUE,void 0].includes(i.value)?[(0,c.createSingleFieldParameter)({field:a,value:i.value,operator:t.forminputs.find(function(e){return e.attribute===a}).operator})]:[]})})}))).filter(function(e){return"fulfilled"===e.status}).reduce(function(e,t){return e.concat(t.value.data||[])},[]).map(function(e){var e=s(e,2),t=e[0];return{key:e[1],value:t}})}catch(e){}return[]},i=function(){var s=r.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})},function(e){return i.apply(this,arguments)}),u=e("app/constant"),c=e("utils/createSingleFieldParameter");l.field=function(){var e,t,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=n.state,i=n.field,n=n.fields,n=void 0===n?[]:n,a=r.forminputs.find(function(e){return e.attribute===i}),o=a&&a.dependance;return o&&r.forminputs.some(function(e){return o===e.dependance&&e.dvalues.length})&&u.SEARCH_ALLVALUE!==a.value?(void 0!==a.value&&(e=(t=r.forminputs.find(function(e){return e.attribute===o}).operator).op,t=t.logicop,n.unshift(o+"|"+e.toLowerCase()+"|"+encodeURI(a.value)+"|"+(n.length?t.toLowerCase():""))),l.field({state:r,fields:n,field:o})):(n||[]).join()||void 0}},{"app/constant":5,"utils/createSingleFieldParameter":353}],379:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getDefaultLayerStyle=function(e){var t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).color;if((0,r.isPointGeometryType)(e))return new ol.style.Style({image:new ol.style.Circle({fill:new ol.style.Fill({color:t}),stroke:new ol.style.Stroke({color:t,width:1}),radius:5})});if((0,i.isLineGeometryType)(e))return new ol.style.Style({stroke:new ol.style.Stroke({color:t,width:3})});if((0,a.isPolygonGeometryType)(e))return new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255,255,255,0.5)"}),stroke:new ol.style.Stroke({color:t,width:3})})};e("app/constant");var r=e("./isPointGeometryType"),i=e("./isLineGeometryType"),a=e("./isPolygonGeometryType")},{"./isLineGeometryType":409,"./isPointGeometryType":411,"./isPolygonGeometryType":412,"app/constant":5}],380:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getExtentForViewAndSize=function(e,t,n,r){var i=t*r[0]/2,t=t*r[1]/2,r=Math.cos(n),n=Math.sin(n),a=i*r,i=i*n,r=t*r,t=t*n,n=e[0],e=e[1],o=n-a+t,s=n-a-t,l=n+a-t,n=n+a+t,a=e-i-r,t=e-i+r,u=e+i+r,e=e+i-r;return[Math.min(o,s,l,n),Math.min(a,t,u,e),Math.max(o,s,l,n),Math.max(a,t,u,e)]}},{}],381:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getFeaturesFromResponseVectorApi=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).type,t=void 0===t?"vector":t;if(!e.result)return null;if("result"===t)return(0,r.convertVectorFeaturesToResultFeatures)(e.vector.data.features||[]);if("vector"===t)return e.vector.data.features||[]};var r=e("utils/convertVectorFeaturesToResultFeatures")},{"utils/convertVectorFeaturesToResultFeatures":336}],382:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getFormDataExpressionRequestFromFeature=function(t){delete t.attributes.geometry;var e=new ol.Feature(t.geometry),n={};return(0,i.getAlphanumericPropertiesFromFeature)(t.attributes).filter(function(e){return e!==r.G3W_FID}).forEach(function(e){return n[e]=t.attributes[e]}),e.setProperties(n),e.setId(t.attributes[r.G3W_FID]),(0,a.convertFeatureToGEOJSON)(e)};var r=e("app/constant"),i=e("utils/getAlphanumericPropertiesFromFeature"),a=e("utils/convertFeatureToGEOJSON")},{"app/constant":5,"utils/convertFeatureToGEOJSON":332,"utils/getAlphanumericPropertiesFromFeature":374}],383:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i;n.getGeoTIFFfromServer=(r=function*(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=new FormData;return t.append("image",e.params.image),t.append("csrfmiddlewaretoken",e.params.csrfmiddlewaretoken),t.append("bbox",e.params.bbox),yield(yield fetch(e.url,{method:e.method||"POST",body:t})).blob()},i=function(){var s=r.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})},function(){return i.apply(this,arguments)})},{}],384:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getLengthMessageText=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.unit,n=e.projection,e=e.geometry,r=e.getType(),n=(0,i.needUseSphereMethods)(n)?ol.sphere.getLength(e,{projection:n.getCode()}):(0,o.isMultiGeometry)(r)?e.getLineStrings().reduce(function(e,t){return e+t.getLength()},0):e.getLength(),r=void 0;r="nautical"===t?(0,a.transformMeterLength)(n,t)+" nm":1e3<n?(Math.round(n/1e3*100)/100).toFixed(3)+" km":(Math.round(100*n)/100).toFixed(2)+" m";return r};var i=e("utils/needUseSphereMethods"),a=e("utils/transformMeterLength"),o=e("utils/isMultiGeometry")},{"utils/isMultiGeometry":410,"utils/needUseSphereMethods":420,"utils/transformMeterLength":451}],385:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getMapLayerById=function(e){return r.default.getLayerById(e)};var n=e("store/map-layers"),r=(e=n)&&e.__esModule?e:{default:e}},{"store/map-layers":315}],386:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},n=(n.getMapLayersByFilter=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return t=r({GEOLAYER:!0},t),i.default.getQuerableLayersStores().flatMap(function(e){return e.getLayers(t,n)})},e("store/map-layers")),i=(e=n)&&e.__esModule?e:{default:e}},{"store/map-layers":315}],387:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getMetersFromDegrees=function(e){return e*ol.proj.Units.METERS_PER_UNIT.degrees}},{}],388:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getOLGeometry=function(e){switch(e){case r.GEOMETRY_TYPES.LINESTRINGZ:case r.GEOMETRY_TYPES.LINESTRINGM:case r.GEOMETRY_TYPES.LINESTRINGZM:case r.GEOMETRY_TYPES.LINESTRING25D:case r.GEOMETRY_TYPES.LINE:case r.GEOMETRY_TYPES.LINEZ:case r.GEOMETRY_TYPES.LINEM:case r.GEOMETRY_TYPES.LINEZM:case r.GEOMETRY_TYPES.LINE25D:return"LineString";case r.GEOMETRY_TYPES.MULTILINESTRINGZ:case r.GEOMETRY_TYPES.MULTILINESTRINGM:case r.GEOMETRY_TYPES.MULTILINESTRINGZM:case r.GEOMETRY_TYPES.MULTILINESTRING25D:case r.GEOMETRY_TYPES.MULTILINE:case r.GEOMETRY_TYPES.MULTILINEZ:case r.GEOMETRY_TYPES.MULTILINEM:case r.GEOMETRY_TYPES.MULTILINEZM:case r.GEOMETRY_TYPES.MULTILINE25D:return"MultiLineString";case r.GEOMETRY_TYPES.POINTZ:case r.GEOMETRY_TYPES.POINTM:case r.GEOMETRY_TYPES.POINTZM:case r.GEOMETRY_TYPES.POINT25D:return"Point";case r.GEOMETRY_TYPES.MULTIPOINTZ:case r.GEOMETRY_TYPES.MULTIPOINTM:case r.GEOMETRY_TYPES.MULTIPOINTZM:case r.GEOMETRY_TYPES.MULTIPOINT25D:return"MultiPoint";case r.GEOMETRY_TYPES.POLYGONZ:case r.GEOMETRY_TYPES.POLYGONM:case r.GEOMETRY_TYPES.POLYGONZM:case r.GEOMETRY_TYPES.POLYGON25D:return"Polygon";case r.GEOMETRY_TYPES.MULTIPOLYGONZ:case r.GEOMETRY_TYPES.MULTIPOLYGONM:case r.GEOMETRY_TYPES.MULTIPOLYGONZM:case r.GEOMETRY_TYPES.MULTIPOLYGON25D:return"MultiPolygon";default:return e}};var r=e("app/constant")},{"app/constant":5}],389:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getPointFeaturesfromGeometryVertex=function(e){var t=[];switch(e.getType()){case r.GEOMETRY_TYPES.MULTIPOLYGON:e.getCoordinates().forEach(function(e){e.forEach(function(e){e.pop(),e.forEach(function(e){return t.push(new ol.Feature(new ol.geom.Point(e)))})})});break;case r.GEOMETRY_TYPES.POLYGON:e.getCoordinates().forEach(function(e){e.pop(),e.forEach(function(e){return t.push(new ol.Feature(new ol.geom.Point(e)))})});break;case r.GEOMETRY_TYPES.MULTILINESTRING:e.getCoordinates().forEach(function(e){e.forEach(function(e){return t.push(new ol.Feature(new ol.geom.Point(e)))})});break;case r.GEOMETRY_TYPES.LINESTRING:e.getCoordinates().forEach(function(e){e.forEach(function(e){return t.push(new ol.Feature(new ol.geom.Point(e)))})});break;case r.GEOMETRY_TYPES.MULTIPOINT:e.getCoordinates().forEach(function(e){return t.push(new ol.Feature(new ol.geom.Point(e)))});break;case r.GEOMETRY_TYPES.POINT:t.push(new ol.geom.Point(e.getCoordinates()))}return t};var r=e("app/constant")},{"app/constant":5}],390:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getQueryLayersPromisesByBBOX=function(r,e){var t=e.bbox,n=e.filterConfig,i=void 0===n?{}:n,n=e.feature_count,a=void 0===n?10:n,n=e.multilayers,e=void 0!==n&&n,o=ol.geom.Polygon.fromExtent(t),n=p.default.getComponent("map").getService().getMap().getView().getProjection();if(e)return(0,f.getQueryLayersPromisesByGeometry)(r,{geometry:o,feature_count:a,filterConfig:i,multilayers:e,projection:n});var s=$.Deferred(),l=n.getCode(),t=s.promise(),u=[],c=[],d=r.length;return r.forEach(function(e){var t=new h(i),n=e.getProjection().getCode();t.setGeometry(l===n?o:o.clone().transform(l,n)),e.query({filter:t,feature_count:a}).then(function(e){return u.push(e)}).fail(function(e){return c.push(e)}).always(function(){0===--d&&(c.length===r.length?s.reject(c):s.resolve(u))})}),t};var n=e("services/gui"),p=(n=n)&&n.__esModule?n:{default:n},f=e("utils/getQueryLayersPromisesByGeometry");var h=e("core/layers/filter/filter")},{"core/layers/filter/filter":18,"services/gui":302,"utils/getQueryLayersPromisesByGeometry":392}],391:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getQueryLayersPromisesByCoordinates=function(a){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=e.coordinates,t=e.feature_count,s=void 0===t?10:t,t=e.query_point_tolerance,l=void 0===t?i.QUERY_POINT_TOLERANCE:t,t=e.multilayers,t=void 0!==t&&t,e=e.reproject,u=void 0===e||e,c=$.Deferred();if(0===a.length)return c.resolve(a);var e=v.default.getService("map").getMap(),d=e.getSize(),p=[],f=[],h=e.getView().getProjection(),g=e.getView().getResolution();{var n,r;t?function(){var e,n={},t=(a.forEach(function(e){var t=e.getInfoFormat()+":"+e.getInfoUrl()+":"+e.getMultiLayerId();n[t]?n[t].push(e):n[t]=[e]}),Object.keys(n).length),r=t;for(e in n){var i=n[e];n[e][0].getProvider("query").query({feature_count:s,coordinates:o,query_point_tolerance:l,mapProjection:h,reproject:u,resolution:g,size:d,layers:i}).then(function(e){return p.push(e)}).fail(function(e){return f.push(e)}).always(function(){0===--r&&(f.length===t?c.reject(f):c.resolve(p))})}}():(n=a.length,r=0,a.forEach(function(e){e.query({feature_count:s,coordinates:o,query_point_tolerance:l,mapProjection:h,size:d,resolution:g}).then(function(e){return p.push(e)}).fail(function(e){f.push(e),r+=1}).always(function(){0===--n&&(r<a.length?c.resolve(p):c.reject(f))})}))}return c.promise()};var i=e("app/constant"),n=e("services/gui"),v=(e=n)&&e.__esModule?e:{default:e}},{"app/constant":5,"services/gui":302}],392:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getQueryLayersPromisesByGeometry=function(s){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},t=e.multilayers,t=void 0!==t&&t,l=e.geometry,n=e.filterConfig,r=void 0===n?{}:n,n=e.projection,e=e.feature_count,u=void 0===e?10:e,c=$.Deferred(),d=[],p=[],f=n.getCode(),h=new a(r);0===s.length&&c.resolve([]);{var i;t?function(){var e,t=(0,g.groupBy)(s,function(e){return e.getMultiLayerId()+"_"+e.getProjection().getCode()}),n=Object.keys(t).length,r=n;for(e in t){var i=t[e],a=t[e][0],o=a.getProvider("filter"),a=a.getProjection().getCode();h.setGeometry(f===a?l:l.clone().transform(f,a)),o.query({filter:h,layers:i,feature_count:u}).then(function(e){return d.push(e)}).fail(function(e){return p.push(e)}).always(function(){0===--r&&(p.length===n?c.reject(p):c.resolve(d))})}}():(i=s.length,s.forEach(function(e){var t=e.getProjection().getCode();h.setGeometry(f===t?l:l.clone().transform(f,t)),e.query({filter:h,filterConfig:r,feature_count:u}).then(function(e){return d.push(e)}).fail(function(e){return p.push(e)}).always(function(){0===--i&&(p.length===s.length?c.reject(p):c.resolve(d))})}))}return c.promise()};var g=e("utils/groupBy"),a=e("core/layers/filter/filter")},{"core/layers/filter/filter":18,"utils/groupBy":400}],393:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getRandomColor=function(){return"#"+((1<<24)*Math.random()|0).toString(16)}},{}],394:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getResolutionFromScale=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"m";return 1/((1<=e?1/e:e)*r.INCHES_PER_UNIT[t]*r.DOTS_PER_INCH)};var r=e("constant")},{constant:5}],395:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getScaleFromResolution=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"m";return Math.round(e*r.INCHES_PER_UNIT[t]*r.DOTS_PER_INCH)};var r=e("constant")},{constant:5}],396:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getTimeoutPromise=function(e){var t=e.timeout,t=void 0===t?i.TIMEOUT:t,n=e.resolve,r=e.data;return setTimeout(function(){n(r)},t)};var i=e("app/constant")},{"app/constant":5}],397:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getUniqueDomId=function(){return(r+=1)+"_"+Date.now()};var r=0},{}],398:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getVertexLength=function(e){var t=0;switch(e.getType()){case r.GEOMETRY_TYPES.MULTIPOLYGON:e.getCoordinates().forEach(function(e){e.forEach(function(e){e.pop(),e.forEach(function(){return t+=1})})});break;case r.GEOMETRY_TYPES.POLYGON:e.getCoordinates().forEach(function(e){e.pop(),e.forEach(function(){return t+=1})})}return t};var r=e("app/constant")},{"app/constant":5}],399:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.get_legend_params=function(r){var i=void 0,a=void 0;return(r.getCategories()||[]).forEach(function(e){var t=e.checked,n=e._checked,e=e.ruleKey;t!==n&&(t?i=(void 0===i?r.getWMSLayerName()+":":i+",")+e:a=(void 0===a?r.getWMSLayerName()+":":a+",")+e)}),{LEGEND_ON:i,LEGEND_OFF:a}}},{}],400:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.groupBy=function(e,r){return e.reduce(function(e,t){var n=r(t);return e[n]||(e[n]=[]),e[n].push(t),e},{})}},{}],401:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.handleQueryResponse=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.response,n=e.projections,r=e.layers,e=e.wms,e=void 0===e||e;return r=r||[this._layer],i.response.get(r[0].getInfoFormat())({response:t,projections:n,layers:r,wms:e})};var i=e("utils/parsers")},{"utils/parsers":425}],402:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.hasOwn=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},{}],403:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.imageToDataURL=function(e){var r=e.src,t=e.type,i=void 0===t?"image/jpeg":t,t=e.callback,a=void 0===t?function(){}:t;return new Promise(function(n,e){var t=new Image;t.onload=function(){var e=document.createElement("canvas"),t=e.getContext("2d"),t=(e.height=this.naturalHeight,e.width=this.naturalWidth,t.drawImage(this,0,0),e.toDataURL(i));a(t),n(t)},t.onerror=e,t.src=r})}},{}],404:[function(e,t,R){var n=e("./getUniqueDomId"),r=e("./basemixin"),i=e("./mixin"),a=e("./merge"),o=e("./hasOwn"),s=e("./inherit"),l=e("./base"),u=e("./noop"),c=e("./resolve"),d=e("./reject"),p=e("./getAjaxResponses"),f=e("./trimValue"),h=e("./isURL"),g=e("./sanitizeUrl"),v=e("./convertObjectToUrlParams"),m=e("./appendParams"),y=e("./imageToDataURL"),_=e("./capitalize_first_letter"),b=e("./Base64"),w=e("./toRawType"),x=e("./isEmptyObject"),S=e("./throttle"),L=e("./debounce"),C=e("./getRandomColor"),E=e("./copyUrl"),T=e("./downloadFile"),k=e("./downloadCSVLayerFeatures"),M=e("./downloadCSV"),P=e("./getTimeoutPromise"),O=e("./XHR"),F=e("./createSingleFieldParameter"),I=e("./createFilterFormInputs"),j=e("./createFilterFromString"),N=e("./createFilterFormField"),G=e("./splitContextAndMethod"),D=e("./colorHEXToRGB"),B=e("./convertQGISDateTimeFormatToMoment"),V=e("./sortAlphabeticallyArray"),U=e("./sortNumericArray"),e=e("./sameOrigin");function A(e,t,n){return void 0===n||0==+n?Math[e](t):(t=+t,n=+n,isNaN(t)||"number"!=typeof n||n%1!=0?NaN:(t=t.toString().split("e"),+((t=(t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-n:-n)))).toString().split("e"))[0]+"e"+(t[1]?+t[1]+n:n))))}Math.round10||(Math.round10=function(e,t){return A("round",e,t)}),Math.floor10||(Math.floor10=function(e,t){return A("floor",e,t)}),Math.ceil10||(Math.ceil10=function(e,t){return A("ceil",e,t)}),String.prototype.hashCode=function(){var e,t=0,n=void 0;if(0!==this.length)for(n=0,e=this.length;n<e;n++)t=(t<<5)-t+this.charCodeAt(n),t|=0;return t};n={getUniqueDomId:n.getUniqueDomId,uniqueId:n.getUniqueDomId,basemixin:r.basemixin,mixin:i.mixin,merge:a.merge,hasOwn:o.hasOwn,inherit:s.inherit,base:l.base,noop:u.noop,truefnc:function(){return!0},falsefnc:function(){return!0},resolve:c.resolve,reject:d.reject,getValueFromG3WObjectEvent:function(){},getAjaxResponses:p.getAjaxResponses,trimValue:f.trimValue,isURL:h.isURL,sanitizeUrl:g.sanitizeUrl,convertObjectToUrlParams:v.convertObjectToUrlParams,appendParams:m.appendParams,imageToDataURL:y.imageToDataURL,capitalize_first_letter:_.capitalize_first_letter,Base64:b.Base64,toRawType:w.toRawType,isEmptyObject:x.isEmptyObject,throttle:S.throttle,debounce:L.debounce,getRandomColor:C.getRandomColor,copyUrl:E.copyUrl,downloadFile:T.downloadFile,downloadCSVLayerFeatures:k.downloadCSVLayerFeatures,downloadCSV:M.downloadCSV,getTimeoutPromise:P.getTimeoutPromise,XHR:O.XHR,createSingleFieldParameter:F.createSingleFieldParameter,createFilterFromString:j.createFilterFromString,createFilterFormInputs:I.createFilterFormInputs,createFilterFormField:N.createFilterFormField,splitContextAndMethod:G.splitContextAndMethod,colorHEXToRGB:D.colorHEXToRGB,convertQGISDateTimeFormatToMoment:B.convertQGISDateTimeFormatToMoment,sortAlphabeticallyArray:V.sortAlphabeticallyArray,sortNumericArray:U.sortNumericArray,sameOrigin:e.sameOrigin};t.exports=n},{"./Base64":318,"./XHR":319,"./appendParams":321,"./base":323,"./basemixin":324,"./capitalize_first_letter":325,"./colorHEXToRGB":327,"./convertObjectToUrlParams":333,"./convertQGISDateTimeFormatToMoment":334,"./copyUrl":338,"./createFilterFormField":343,"./createFilterFormInputs":344,"./createFilterFromString":345,"./createSingleFieldParameter":353,"./debounce":360,"./downloadCSV":364,"./downloadCSVLayerFeatures":365,"./downloadFile":366,"./getAjaxResponses":370,"./getRandomColor":393,"./getTimeoutPromise":396,"./getUniqueDomId":397,"./hasOwn":402,"./imageToDataURL":403,"./inherit":405,"./isEmptyObject":408,"./isURL":415,"./merge":416,"./mixin":418,"./noop":421,"./reject":430,"./resolve":433,"./sameOrigin":435,"./sanitizeUrl":437,"./sortAlphabeticallyArray":440,"./sortNumericArray":441,"./splitContextAndMethod":442,"./throttle":447,"./toRawType":448,"./trimValue":452}],405:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.inherit=function(e,t){function n(){}n.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],406:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.intersects=function(e,t){var n=new jsts.io.OL3Parser;return n.read(e).intersects(n.read(t))}},{}],407:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.is3DGeometry=function(t){return[r.GEOMETRY_TYPES.POINTZ,r.GEOMETRY_TYPES.POINTM,r.GEOMETRY_TYPES.POINTZM,r.GEOMETRY_TYPES.POINT25D,r.GEOMETRY_TYPES.MULTIPOINTZ,r.GEOMETRY_TYPES.MULTIPOINTM,r.GEOMETRY_TYPES.MULTIPOINTZM,r.GEOMETRY_TYPES.MULTIPOINT25D,r.GEOMETRY_TYPES.LINESTRINGZ,r.GEOMETRY_TYPES.LINESTRINGM,r.GEOMETRY_TYPES.LINESTRINGZM,r.GEOMETRY_TYPES.LINESTRING25D,r.GEOMETRY_TYPES.MULTILINESTRINGZ,r.GEOMETRY_TYPES.MULTILINESTRINGM,r.GEOMETRY_TYPES.MULTILINESTRINGZM,r.GEOMETRY_TYPES.MULTILINESTRING25D,r.GEOMETRY_TYPES.LINEZ,r.GEOMETRY_TYPES.LINEM,r.GEOMETRY_TYPES.LINEZM,r.GEOMETRY_TYPES.LINE25D,r.GEOMETRY_TYPES.MULTILINEZ,r.GEOMETRY_TYPES.MULTILINEM,r.GEOMETRY_TYPES.MULTILINEZM,r.GEOMETRY_TYPES.MULTILINE25D,r.GEOMETRY_TYPES.POLYGONZ,r.GEOMETRY_TYPES.POLYGONM,r.GEOMETRY_TYPES.POLYGONZM,r.GEOMETRY_TYPES.POLYGON25D,r.GEOMETRY_TYPES.MULTIPOLYGONZ,r.GEOMETRY_TYPES.MULTIPOLYGONM,r.GEOMETRY_TYPES.MULTIPOLYGONZM,r.GEOMETRY_TYPES.MULTIPOLYGON25D].find(function(e){return e===t})};var r=e("app/constant")},{"app/constant":5}],408:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isEmptyObject=function(e){return"{}"===JSON.stringify(e)}},{}],409:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isLineGeometryType=function(e){return-1!==(0,r.getAllLineGeometryTypes)().indexOf(e)};var r=e("utils/getAllLineGeometryTypes")},{"utils/getAllLineGeometryTypes":371}],410:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isMultiGeometry=function(e){return-1!==[r.GEOMETRY_TYPES.MULTIPOINT,r.GEOMETRY_TYPES.MULTIPOINTZ,r.GEOMETRY_TYPES.MULTIPOINTZM,r.GEOMETRY_TYPES.MULTIPOINTM,r.GEOMETRY_TYPES.MULTIPOINT25D,r.GEOMETRY_TYPES.MULTILINESTRING,r.GEOMETRY_TYPES.MULTILINESTRINGZ,r.GEOMETRY_TYPES.MULTILINESTRINGM,r.GEOMETRY_TYPES.MULTILINESTRINGZM,r.GEOMETRY_TYPES.MULTILINESTRING25D,r.GEOMETRY_TYPES.MULTILINE,r.GEOMETRY_TYPES.MULTILINEZ,r.GEOMETRY_TYPES.MULTILINEM,r.GEOMETRY_TYPES.MULTILINEZM,r.GEOMETRY_TYPES.MULTILINE25D,r.GEOMETRY_TYPES.MULTIPOLYGON,r.GEOMETRY_TYPES.MULTIPOLYGONZ,r.GEOMETRY_TYPES.MULTIPOLYGONM,r.GEOMETRY_TYPES.MULTIPOLYGONZM,r.GEOMETRY_TYPES.MULTIPOLYGON25D].indexOf(e)};var r=e("app/constant")},{"app/constant":5}],411:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isPointGeometryType=function(e){return-1!==(0,r.getAllPointGeometryTypes)().indexOf(e)};var r=e("utils/getAllPointGeometryTypes")},{"utils/getAllPointGeometryTypes":372}],412:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isPolygonGeometryType=function(e){return-1!==(0,r.getAllPolygonGeometryTypes)().indexOf(e)};var r=e("utils/getAllPolygonGeometryTypes")},{"utils/getAllPolygonGeometryTypes":373}],413:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isSameBaseGeometryType=function(e,t){return e.replace("Multi","")===t.replace("Multi","")}},{}],414:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isSingleGeometry=function(e){return!(0,r.isMultiGeometry)(e.getType())};var r=e("utils/isMultiGeometry")},{"utils/isMultiGeometry":410}],415:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isURL=function(e){return e&&e.match(/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g)}},{}],416:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.merge=function(e,t){for(var n in t)(0,r.hasOwn)(t,n)&&(e[n]=t[n])};var r=e("./hasOwn")},{"./hasOwn":402}],417:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};n.mergeOptions=function(e,t){return r({},e,t)}},{}],418:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.mixin=function(e,t){var n=new t;(0,r.merge)(e,n),(0,r.merge)(e.prototype,t.prototype)};var r=e("./merge")},{"./merge":416}],419:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.multiGeometryToSingleGeometries=function(e){switch(e.getType()){case r.GEOMETRY_TYPES.MULTIPOLYGON:return e.getPolygons();case r.GEOMETRY_TYPES.MULTILINE:case r.GEOMETRY_TYPES.MULTILINESTRING:return e.getLineStrings();case r.GEOMETRY_TYPES.MULTIPOINT:return e.getPoints()}return[]};var r=e("app/constant")},{"app/constant":5}],420:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.needUseSphereMethods=function(e){return"EPSG:3857"===e.getCode()||"degrees"===e.getUnits()}},{}],421:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.noop=function(){}},{}],422:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.normalizeEpsg=function(e){if("number"==typeof e)return"EPSG:"+e;if(""!==(e=e.replace(/[^\d\.\-]/g,"")))return"EPSG:"+parseInt(e)}},{}],423:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.parseAttributes=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1];if(e&&0<e.length)return e.filter(function(e){return-1<Object.keys(t).indexOf(e.name)});return Object.keys(t).filter(function(e){return-1===r.GEOMETRY_FIELDS.indexOf(e)}).map(function(e){return{name:e,label:e}})};var r=e("app/constant")},{"app/constant":5}],424:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.parseQueryLayersPromiseResponses=function(e){return{query:e[0]?e[0].query:null,data:e.flatMap(function(e){return e.data||[]})}}},{}],425:[function(e,t,n){var s=e("app/constant"),r=e("services/gui"),i=(r=r)&&r.__esModule?r:{default:r},o=e("utils/is3DGeometry"),l=e("utils/removeZValueToOLFeatureGeometry"),u=e("utils/sanitizeFidFeature"),a=e("utils/reverseGeometry");function c(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function f(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}var d=e("utils").toRawType,p=e("core/layers/features/feature"),h=e("core/i18n/i18n.service").t,g="GIS3W_ESCAPE_NUMERIC_FIELD_",v={getHandledResponsesFromResponse:function(e){var a=this,t=e.response,o=e.layers,s=e.projections,e=e.id,l=void 0!==e&&e,u=!1,c=(new X2JS).xml_str2json(t);if(!c)return[{layer:o[0],features:[]}];var e=c.FeatureCollection,t=c.ServiceExceptionReport,d=[];if(e&&e.featureMember)for(var p=Array.isArray(e.featureMember)?e.featureMember:[e.featureMember],n=0;n<o.length;n++)!function(e){var n,t=o[e],r=l?t.getId():"layer"+e,i={features:null,__prefix:null};c.FeatureCollection.featureMember=p.filter(function(e){var t=e[r];if(t)return t.g3w_fid={__prefix:e.__prefix,__text:t._fid&&t._fid.split(".")[1]},!Array.isArray(t)||(i.features=t,i.__prefix=e.__prefix,!1)}),i.features&&(n=i.__prefix,e=a.groupFeaturesByFields(i.features),1<Object.keys(e).length?(u=!0,a.handleWMSMultiLayersResponseFromQGISSERVER({groupFeatures:e,prefix:n,handledResponses:d,jsonresponse:c,layer:t,projections:s})):i.features.forEach(function(e){var t;c.FeatureCollection.featureMember.push((f(t={},r,e),f(t,"__prefix",n),t))})),u||(e=a.parseLayerFeatureCollection({jsonresponse:c,layer:t,projections:s}))&&d.unshift(e[0])}(n);return t&&t.ServiceException&&i.default.showUserMessage({type:"warning",textMessage:!0,message:o[0].getName()+" - "+t.ServiceException}),d},transformFeatures:function(e,n){var t;return e=e.length&&e[0].getGeometry()&&(t="ne"===(n.layer||n.map).getAxisOrientation().substr(0,2),n.layer&&n.layer.getCode()!==n.map.getCode()&&e.forEach(function(e){var t=e.getGeometry();e.setGeometry(t.transform(n.layer.getCode(),n.map.getCode()))}),t)?this.reverseFeaturesCoordinates(e):e},parseLayerFeatureCollection:function(e){var t,i=this,n=e.jsonresponse,r=e.layer,e=e.projections,n=(new X2JS).json2xml_str(n),a=new ol.format.WMSGetFeatureInfo,a=this.transformFeatures(a.readFeatures(n),e);return r.isGeoLayer()&&(n=r.getGeometryType(),(0,o.is3DGeometry)(n)||a.forEach(function(e){return(0,l.removeZValueToOLFeatureGeometry)({feature:e})})),a.length&&this.hasFieldsStartWithNotPermittedKey&&(t=Object.keys(a[0].getProperties()).filter(function(e){return-1!==e.indexOf(g)}),a.forEach(function(r){t.forEach(function(e){var t=r.get(e),n=e.replace(g,"");r.set(i.hasFieldsStartWithNotPermittedKey[n],Array.isArray(t)?t[0]:t),r.unset(e)})})),[{layer:r,features:a}]},reverseFeaturesCoordinates:function(e){return e.forEach(function(e){var t=e.getGeometry();e.setGeometry((0,a.reverseGeometry)(t))}),e},handleXMLStringResponseBeforeConvertToJSON:function(){var n=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.response,t=e.layers,i=e.wms;if(r){"string"==typeof r||r instanceof String||(r=(new XMLSerializer).serializeToString(r));for(var a=0;a<t.length;a++)var o=t[a],o=i&&o.isWmsUseLayerIds()?o.getId():o.getName(),o=i?o.replace(/[/\s]/g,""):o.replace(/\s/g,"_"),o=(o=(o=(o=o.replace(/(\'+)/,"")).replace(/(\)+)/,"")).replace(/(\(+)/,""),o=i?o:o.replace(/\//g,""),o=i?o:o.replace(/\\/g,""),o=i?o:o.replace(/\:/g,"-"),new RegExp("qgs:"+o,"g")),r=r.replace(o,"qgs:layer"+a);[].concat(c(r.matchAll(/qgs:(\d+(?:\.\d+)?)(\w+)/g)),c(r.matchAll(/qgs:(\w+):(\w+)/g))).forEach(function(e,t){t%2==0&&(n.hasFieldsStartWithNotPermittedKey||(n.hasFieldsStartWithNotPermittedKey={}),t=e[0].replace("qgs:",""),n.hasFieldsStartWithNotPermittedKey[""+e[1]+e[2]]=t,t=new RegExp(""+e[0],"g"),r=r.replace(t,"qgs:"+g+e[1]+e[2]))});e=new RegExp(""+String.fromCharCode(0),"g");return r=r.replace(e,"0")}},groupFeaturesByFields:function(e){return _.groupBy(e,function(e){return Object.keys(e)})},handleWMSMultiLayersResponseFromQGISSERVER:function(){var i=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.groupFeatures,a=e.prefix,o=e.handledResponses,s=e.jsonresponse,l=e.layer,u=e.projections;Object.keys(t).forEach(function(e,r){t[e].forEach(function(e,t){s.FeatureCollection.featureMember=(f(n={},"layer"+r+"_"+t,e),f(n,"__prefix",a),n);var n,t=i.parseLayerFeatureCollection({jsonresponse:s,layer:l,projections:u});t&&((e=t[0]).layer=l,o.unshift(e))})})}},m={"application/json":function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layers,t=void 0===t?[]:t,n=e.response,r=e.projections,e=e.wms,i=void 0===e||e,a=[],o=t.map(function(e){return a.push({layer:e,features:[]}),i?e.getWMSLayerName():e.getWFSLayerName()}),e=n;return(e&&(t=r.layer||r.map,new ol.format.GeoJSON({defaultDataProjection:t,geometryName:"geometry"}).readFeatures(e))).filter(function(t){var e,n,r=t.getId(),i=(0,u.sanitizeFidFeature)(r),r=r==i?0:o.indexOf(r);-1!==r&&(e=a[r].layer.getFields().filter(function(e){return e.show}),n=t.getProperties(),t.set(s.G3W_FID,i),e.forEach(function(e){void 0===n[e.name]&&void 0!==n[e.label]&&t.set(e.name,n[e.label])}),a[r].features.push(t))}),a},"application/geojson":function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layers,n=(e.projections,e.response),r=[],i=y.vector.get({type:"geojson"});return n&&t.forEach(function(e){r.push({layer:e,features:i(n,{})})}),r},"text/html":function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layers,n=e.response,r=[];return t.forEach(function(e){r.push({layer:e,rawdata:n})}),r},"text/plain":function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layers,n=e.response,r=[];return t.forEach(function(e){r.push({layer:e,rawdata:n})}),r},"text/gml":function(e){var t=e.layers,e=e.response,n=y.vector.get({type:"gml"})({data:e,layer:t[0]});return t.map(function(e){return{layer:e,features:n}})},"application/vnd.ogc.gml":function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.response,n=e.projections,r=e.layers,e=e.wms;return v.getHandledResponsesFromResponse({response:v.handleXMLStringResponseBeforeConvertToJSON({layers:r,response:t,wms:void 0===e||e}),layers:r,projections:n})},not_supported_format:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).layers;return(void 0===e?[]:e).map(function(e){return{layer:e,rawdata:h("warning.not_supported_format")}})}},y={vector:new function(){this.get=function(){var e=void 0;switch((0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).type){case"geojson":case"json":e=this._parseLayerGeoJSON;break;case"gml":e=this._parseLayermsGMLOutput;break;default:e=this._parseLayerGeoJSON}return e},this._parseLayermsGMLOutput=function(e){var t=e.data,e=e.layer;try{var n,r,i=void 0,a=("--"!==t.substr(0,2)?i=t:(n=new RegExp("<([^ ]*)FeatureCollection"),r=new RegExp("<([^ ]*)msGMLOutput"),t.split(new RegExp("\r\n--")).forEach(function(e){(-1<e.search(n)||-1<e.search(r))&&(i=e.substr(e.indexOf("<?xml")))})),e.getQueryLayerOrigName());return new ol.format.WMSGetFeatureInfo({layers:a}).readFeatures(i)}catch(e){return[]}},this._parseLayerGeoJSON=function(e,t){try{e="String"===d(e)?JSON.parse(e):e;var n=t.crs,r=t.mapCrs;return new ol.format.GeoJSON({dataProjection:n,featureProjection:r||n,geometryName:"geometry"}).readFeatures(e)}catch(e){return[]}}},table:new function(){this.get=function(){(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).type;return this._parserJSON.bind(this)},this._parserJSON=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).features;return(void 0===e?[]:e).map(function(e){var t=e.id,e=e.properties,n=new p;return n.setProperties(e),n.setId(t),n})}},response:{get:function(e){return m[e]||m.not_supported_format},utils:{getTimeoutData:function(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).map(function(e){return{layer:e,rawdata:"timeout"}})}}}};t.exports=y},{"app/constant":5,"core/i18n/i18n.service":12,"core/layers/features/feature":14,"services/gui":302,utils:404,"utils/is3DGeometry":407,"utils/removeZValueToOLFeatureGeometry":432,"utils/reverseGeometry":434,"utils/sanitizeFidFeature":436}],426:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};n.print=function(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"GET",t=o.default.getCurrentProject().getLayersStore(),r=t.getLayers({PRINTABLE:{scale:n.scale},SERVERTYPE:"QGIS"}).reverse();if(!r.length)return Promise.resolve({layers:!1});"geopdf"===n.format&&(e="GET");var i=r.map(function(e){return e.getPrintLayerName()}).join();return p[e]({url:t.getWmsUrl(),mime_type:{pdf:"application/pdf",jpg:"image/jpeg",svg:"image/svg"}[n.format]||n.format,params:a({SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetPrint",TEMPLATE:n.template,DPI:n.dpi,STYLES:r.map(function(e){return e.getStyle()}).join(",")},n.is_maps_preset_theme?{}:{LAYERS:i},{FORMAT:{png:"png",pdf:"application/pdf",geopdf:"application/pdf"}[n.format]||n.format},"geopdf"===n.format?{FORMAT_OPTIONS:"WRITE_GEO_PDF:TRUE"}:{},{CRS:t.getProjection().getCode(),filtertoken:s.default.tokens.filtertoken},(n.maps||[]).reduce(function(e,t){return Object.assign(e,a((l(e={},t.name+":SCALE",t.scale),l(e,t.name+":EXTENT",t.extent),l(e,t.name+":ROTATION",n.rotation),e),n.is_maps_preset_theme&&void 0===t.preset_theme?l({},t.name+":LAYERS",i):{}))},{}),(n.labels||[]).reduce(function(e,t){return Object.assign(e,l({},t.id,t.text))},{}))})};var o=i(e("store/projects")),s=i(e("store/application-state")),r=e("utils/convertObjectToUrlParams");function i(e){return e&&e.__esModule?e:{default:e}}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var c,d,p={POST:(d=u(function*(e){var t=e.url,n=e.params,e=e.mime_type,t=yield fetch(t,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},body:(0,r.convertObjectToUrlParams)(n)});if(t.ok)return{mime_type:e,layers:!0,url:URL.createObjectURL(yield t.blob())};throw new Error(500===t.status?"Internal Server Error":"Request Failed")}),function(e){return d.apply(this,arguments)}),GET:(c=u(function*(e){var t=e.url,n=e.params,e=e.mime_type;return{url:t+"?"+(0,r.convertObjectToUrlParams)(n),layers:!0,mime_type:e}}),function(e){return c.apply(this,arguments)})}},{"store/application-state":310,"store/projects":317,"utils/convertObjectToUrlParams":333}],427:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.printAtlas=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"GET",n=i.default.getCurrentProject().getLayersStore(),r=1<e.values.length;return c[t]({url:n.getWmsUrl(),mime_type:"application/pdf",params:{SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetPrintAtlas",EXP_FILTER:e.field+(r?" IN (":"=")+e.values.map(function(e){return"'"+e+"'"}).join()+(r?")":""),TEMPLATE:e.template,filtertoken:a.default.tokens.filtertoken,DOWNLOAD:e.download?1:void 0}})};var i=o(e("store/projects")),a=o(e("store/application-state")),r=e("utils/convertObjectToUrlParams");function o(e){return e&&e.__esModule?e:{default:e}}function s(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var l,u,c={POST:(u=s(function*(e){var t=e.url,n=e.params,e=e.mime_type,t=yield fetch(t,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},body:(0,r.convertObjectToUrlParams)(n)});if(t.ok)return{mime_type:e,layers:!0,url:URL.createObjectURL(yield t.blob())};throw new Error(500===t.status?"Internal Server Error":"Request Failed")}),function(e){return u.apply(this,arguments)}),GET:(l=s(function*(e){var t=e.url,n=e.params,e=e.mime_type;return{url:t+"?"+(0,r.convertObjectToUrlParams)(n),layers:!0,mime_type:e}}),function(e){return l.apply(this,arguments)})}},{"store/application-state":310,"store/projects":317,"utils/convertObjectToUrlParams":333}],428:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.promisify=function(n){if(n instanceof Promise)return n;return new Promise(function(e,t){n.then(e).fail(t)})}},{}],429:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.prompt=void 0;n.prompt=(r=function*(e){var t=e.value,n=e.label,e=e.callback,r={value:t,id:(0,o.getUniqueDomId)()},i=new Vue({template:'\n      <div>\n        <label :for="id">'+n+'</label>\n        <input\n          v-model      = "value"\n          :id          = "id"\n          class        = "bootbox-input bootbox-input-text form-control"\n          autocomplete = "off"\n          type         = "text"\n        >\n      </div>',data:function(){return r}});new Promise(function(e,t){var n=a.default.showModalDialog({message:i.$mount().$el,closeButton:!1,buttons:{ok:{label:"Ok",className:"btn-success",callback:function(){return e(r.value)}},cancel:{label:"Cancel",className:"btn-danger",callback:function(){return t()}}}}).find("button.btn-success");n.prop("disabled",0===r.value.trim().length),i.$watch("value",function(e){n.prop("disabled",0===e.trim().length)})}).then(e).finally(function(){i.$destroy(),r=i=null})},i=function(){var s=r.apply(this,arguments);return new Promise(function(a,o){return function t(e,n){try{var r=s[e](n),i=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})},function(e){return i.apply(this,arguments)});var r,i,n=e("services/gui"),a=(n=n)&&n.__esModule?n:{default:n},o=e("./getUniqueDomId")},{"./getUniqueDomId":397,"services/gui":302}],430:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.reject=function(e){var t=$.Deferred();return t.reject(e),t.promise()}},{}],431:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.removeMeasureTooltip=function(e){var t=e.map,n=e.tooltip,e=e.unbyKey;t.removeOverlay(n),ol.Observable.unByKey(e)}},{}],432:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.removeZValueToOLFeatureGeometry=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).feature,t=e.getGeometry();if(t){var n=t.getCoordinates();switch(t.getType()){case r.GEOMETRY_TYPES.POINT:3===n.length&&(n.splice(2),e.getGeometry().setCoordinates(n));break;case r.GEOMETRY_TYPES.MULTIPOINT:case r.GEOMETRY_TYPES.LINESTRING:case r.GEOMETRY_TYPES.LINE:n.forEach(function(e){return e.splice(2)}),e.getGeometry().setCoordinates(n);break;case r.GEOMETRY_TYPES.MULTILINESTRING:case r.GEOMETRY_TYPES.MULTILINE:n.forEach(function(e){return e.forEach(function(e){return e.splice(2)})}),e.getGeometry().setCoordinates(n);break;case r.GEOMETRY_TYPES.POLYGON:n[0].forEach(function(e){return e.splice(2)}),e.getGeometry().setCoordinates(n);break;case r.GEOMETRY_TYPES.MULTIPOLYGON:n.forEach(function(e){return e[0].forEach(function(e){return e.splice(2)})}),e.getGeometry().setCoordinates(n)}}return e};var r=e("app/constant")},{"app/constant":5}],433:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.resolve=function(e){var t=$.Deferred();return t.resolve(e),t.promise()}},{}],434:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")};n.reverseGeometry=function(e){return e.setCoordinates(function r(e){e.find(function(e){var t,n;if(!Array.isArray(e))return n=i(e,2),t=n[0],n=n[1],e[0]=n,e[1]=t,!0;r(e)});return e}(e.getCoordinates())),e}},{}],435:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.sameOrigin=function(e,t){try{return new URL(e).origin===new URL(t).origin}catch(e){return!1}}},{}],436:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.sanitizeFidFeature=function(e){"String"===(0,r.toRawType)(e)&&Number.isNaN(+e)&&(e=2===(e=e.split(".")).length?e[1]:e[0]);return e};var r=e("utils/toRawType")},{"utils/toRawType":448}],437:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.sanitizeUrl=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=e.url,e=e.reserverParameters,e=void 0===e?[]:e,o=new URL(a);return e.forEach(function(e){for(var t=[e.toUpperCase(),e.toLowerCase()],n=0;n<2;n++){var r=t[n],i=o.searchParams.get(r);if(i){a=a.replace(r+"="+i,"");break}}}),a}},{}],438:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.setMeasureTooltipStatic=function(e){e.getElement().className="mtooltip mtooltip-static",e.setOffset([0,-7])}},{}],439:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.singleGeometriesToMultiGeometry=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=e[0]&&e[0].getType();return t&&new ol.geom["Multi"+t](e.map(function(e){return e.getCoordinates()}))}},{}],440:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.sortAlphabeticallyArray=function(e){return e.sort(function(e,t){return e.localeCompare(t,void 0,{sensitivity:"base"})})}},{}],441:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.sortNumericArray=function(e){var n=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];return e.sort(function(e,t){return n?e-t:t-e})}},{}],442:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=t,r=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!n||r.length!==n);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")};n.splitContextAndMethod=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"").split(":"),e=r(e,2),t=e[0],e=e[1];return{context:t,method:e}}},{}],443:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.splitFeature=function r(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.feature,i=e.splitfeature;e={feature:t.getGeometry(),split:i.getGeometry()};t=e.split.getType();var n=e.feature.getType();var a=[];var o=new jsts.io.OL3Parser;if("LineString"!==t)return[];var s=(0,b.isMultiGeometry)(n);t=(0,x.isLineGeometryType)(n);n=(0,w.isPolygonGeometryType)(n);var l=function(e){var t=e.feature,n=e.geomClass;t.forEach(function(e){r({splitfeature:i,feature:new ol.Feature({geometry:e})}).forEach(function(e){return e&&a.push(new n([e.getCoordinates()]))})})};if(n){var u=s?e.feature.getPolygons():e.feature;if(Array.isArray(u))l({feature:u,geomClass:ol.geom.MultiPolygon});else{var c=void 0!==u.getCoordinates()[0][0][2],d=o.read(u),p=o.read(u.getLinearRing(0)),n=o.read(e.split),f=void 0;if(1<u.getLinearRingCount()){for(var h=void 0,g=1;g<u.getLinearRingCount();g++){var v=o.read(u.getLinearRing(g));h=void 0===h?v:h.union(v)}(f=new jsts.operation.polygonize.Polygonizer).add(h);var m=void 0;f.getPolygons().toArray().forEach(function(e){return m=void 0===m?e:m.union(e)}),f=m}c&&(u.getCoordinates()[0].forEach(function(e,t){return p.getCoordinates()[t].z=e[2]}),n.getCoordinates().forEach(function(e){return e.z=0}));var n=p.union(n),y=new jsts.operation.polygonize.Polygonizer,n=(y.add(n),y.getPolygons().toArray());1<n.length&&n.forEach(function(e){var t,n,r;f&&(e=e.difference(f)),d.intersects(e.getInteriorPoint())&&(t=o.write(e),n=e.getCoordinates(),c&&(n.forEach(function(e,t){return e.z=(void 0===e.z?n[0===t?t+1:t-1]:e).z}),r=[],t.getCoordinates()[0].forEach(function(e,t){e.push(n[t].z),r.push(e)}),t.setCoordinates([r])),e=(0,S.isSingleGeometry)(t),s?a.push(new ol.geom.MultiPolygon(e?[t.getCoordinates()]:t.getCoordinates())):e?a.push(t):t.getCoordinates().forEach(function(e){return a.push(new ol.geom.Polygon(e))}))})}}if(t){y=s?e.feature.getLineStrings():e.feature;if(!Array.isArray(y))return(0,_.splitGeometryLine)(e.split,e.feature);l({feature:y,geomClass:ol.geom.MultiLineString})}return a};var _=e("utils/splitGeometryLine"),b=e("utils/isMultiGeometry"),w=e("utils/isPolygonGeometryType"),x=e("utils/isLineGeometryType"),S=e("utils/isSingleGeometry")},{"utils/isLineGeometryType":409,"utils/isMultiGeometry":410,"utils/isPolygonGeometryType":412,"utils/isSingleGeometry":414,"utils/splitGeometryLine":445}],444:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.splitFeatures=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.features,t=void 0===t?[]:t,r=e.splitfeature;return t.reduce(function(e,t){var n=(0,i.splitFeature)({splitfeature:r,feature:t});return 1<n.length&&e.push({uid:t.getUid(),geometries:n}),e},[])};var i=e("utils/splitFeature")},{"utils/splitFeature":443}],445:[function(e,t,n){function _(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.splitGeometryLine=function(e,t){var r=void 0!==t.getCoordinates()[0][2],n=!1,i=[],a=new jsts.io.WKTReader,o=new ol.format.WKT,s=new jsts.io.OL3Parser,l=a.read(o.writeGeometry(e)),e=o.writeGeometry(t);r&&(e=e.replace(" Z",""));for(var u=a.read(e).getCoordinates(),c=u.length,d=new jsts.geom.GeometryFactory,p=[],f=void 0,h=void 0,g=0;g<c-1;g++){h=u[g],f=u[g+1],r&&(h.z=t.getCoordinates()[g][2],f.z=t.getCoordinates()[g+1][2]);var v=d.createLineString([h,f]).intersection(l).getCoordinates();n=n||0<v.length,v.forEach(function(e){r&&(e.z=h.z);var t,n=s.write(d.createLineString((p.length?p:[]).concat([h,e])));r&&(t=n.getCoordinates(),n.setCoordinates([[].concat(_(t[0]),[h.z]),[].concat(_(t[1]),[e.z])])),p.length&&(p=[]),i.push(n),h=e}),p=p.concat([h,f])}var m=s.write(d.createLineString(p));{var y;r&&(y=[],p.forEach(function(e,t){t=m.getCoordinates()[t];t.push(e.z),y.push(t)}),m.setCoordinates(y))}return i.push(m),n?i:[]}},{}],446:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.squaredDistance=function(e,t){return Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)}},{}],447:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.throttle=function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:500,r=void 0;return function(){var e=r;r=Date.now(),(void 0===e||n<r-e)&&t.apply(void 0,arguments)}}},{}],448:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.toRawType=function(e){return Object.prototype.toString.call(e).slice(8,-1)}},{}],449:[function(e,t,n){function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.transformBBOX=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.bbox,n=e.sourceCrs,e=e.destinationCrs,r=new ol.geom.Point([t[0],t[1]]),t=new ol.geom.Point([t[2],t[3]]);return r.transform(n,e),t.transform(n,e),[].concat(i(r.getCoordinates()),i(t.getCoordinates()))}},{}],450:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.transformMeterArea=function(e,t){return"nautical"!==t?e:2.9155334959812285e-7*e}},{}],451:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.transformMeterLength=function(e,t){return"nautical"!==t?e:.0005399568*e}},{}],452:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.trimValue=function(e){return e.replace(/ /g,"")}},{}],453:[function(e,t,n){var r=e("utils").truefnc;t.exports={validators:{float:function(){this.options=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},this.validate=function(e){e=Number(+e);return!Number.isNaN(e)}},bigint:function(){this.options=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},this.validate=function(e){return e=+e,!Number.isNaN(e)&&e<=Number.MAX_SAFE_INTEGER}},integer:function(){this.options=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},this.validate=function(e){e=+e;return!Number.isNaN(e)&&Number.isSafeInteger(e)&&e<=2147483647}},checkbox:function(){this.options=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},this.validate=function(e){return-1!==(this.options.values||[]).indexOf(e)}},datetimepicker:function(){this.options=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},this.validate=function(e,t){t=t.fielddatetimeformat;return moment(e,t,!0).isValid()}},char:function(e){this.options=e,this.validate=function(e){return e&&1===(""+e).length}},varchar:function(){this.options=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},this.validate=r},text:function(){this.options=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},this.validate=r},string:function(){this.options=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},this.validate=r},radio:function(){this.options=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},this.validate=r},default:function(){this.options=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},this.validate=r},range:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.min,n=e.max;this.validate=function(e){return t<=(e=+e)&&e<=n}}},get:function(e){return new(this.validators[e]||this.validators.default)(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{})}}},{utils:404}],454:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.within=function(e,t){var n=new jsts.io.OL3Parser;return n.read(t).within(n.read(e))}},{}],455:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default="3.10.0-alpha.1"},{}]},{},[275]);
//# sourceMappingURL=app.min.js.map
