!function n(i,a,o){function s(t,e){if(!a[t]){if(!i[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(l)return l(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}r=a[t]={exports:{}},i[t][0].call(r.exports,function(e){return s(i[t][1][e]||e)},r,r.exports,n,i,a,o)}return a[t].exports}for(var l="function"==typeof require&&require,e=0;e<o.length;e++)s(o[e]);return s}({1:[function(e,t,r){var n=r.cache={};function i(){}r.insert=function(e){if(n[e])return i;n[e]=!0;var t=document.createElement("style");return t.setAttribute("type","text/css"),"textContent"in t?t.textContent=e:t.styleSheet.cssText=e,document.getElementsByTagName("head")[0].appendChild(t),function(){document.getElementsByTagName("head")[0].removeChild(t),n[e]=!1}}},{}],2:[function(e,t,j){var r=k(e("constant")),n=k(e("store/application-state")),i=k(e("services/application")),a=k(e("components/InputG3W.vue")),o=k(e("components/InputG3WFormInputs.vue")),s=k(e("core/expression/inputservice")),l=k(e("components/FormBody.vue")),u=k(e("components/FormFooter.vue")),c=k(e("components/C3XYLine.vue")),d=k(e("store/catalog-layers")),p=k(e("services/data")),f=k(e("services/editing")),h=k(e("store/sessions")),g=k(e("services/iframe-plugin")),v=k(e("store/map-layers")),m=k(e("store/plugins")),y=k(e("store/projects")),_=k(e("services/relations")),b=k(e("services/tasks")),w=k(e("services/workflows")),x=k(e("services/api")),S=k(e("services/router")),L=k(e("services/gui")),C=k(e("mixins"));function k(e){return e&&e.__esModule?e:{default:e}}var E=e("core/g3wobject"),M=e("core/utils/utils"),T=e("core/utils/geo"),I=e("core/i18n/i18n.service"),N=e("core/errors/parser/servererrorparser"),D=e("core/editing/session"),G=e("core/editing/editor"),P=e("core/utils/geo"),F=e("core/utils/geo").Geometry,V=e("core/project/project"),$=e("core/layers/layersstoresregistry"),U=e("core/layers/layersstore"),q=e("core/layers/layer"),B=e("core/layers/layerfactory"),z=e("core/layers/tablelayer"),W=e("core/layers/vectorlayer"),H=e("core/layers/imagelayer"),K=e("core/layers/map/wmslayer"),Z=e("core/layers/map/xyzlayer"),Y=e("core/layers/map/maplayer"),Q=e("core/layers/features/feature"),X=e("core/layers/features/featuresstore"),J=e("core/layers/features/olfeaturesstore"),ee=e("core/layers/filter/filter"),te=e("core/layers/filter/expression"),re=e("core/plugin/plugin"),ne=e("core/plugin/pluginservice"),ie=e("core/workflow/task"),ae=e("core/workflow/step"),oe=e("core/workflow/flow"),se=e("core/workflow/workflow"),O=e("gui/panel"),le=e("gui/map/control/factory"),ue=e("gui/component/componentsfactory"),ce=e("gui/fields/fieldsservice"),de=e("gui/component/component"),pe=e("gui/metadata/vue/metadata"),fe=e("gui/search/vue/search"),he=e("gui/search/vue/panel/searchpanel"),ge=e("gui/print/vue/print"),ve=e("gui/catalog/vue/catalog"),me=e("gui/map/vue/map"),ye=e("gui/tools/vue/tools"),_e=e("gui/queryresults/vue/queryresults"),be=e("gui/form/vue/form"),we=e("gui/form/formservice"),xe=e("gui/inputs/inputs"),Se=e("gui/charts/chartsfactory"),Le=e("gui/fields/fields"),Ce=e("gui/search/vue/panel/searchservice"),R=e("g3w-ol/interactions/pickfeatureinteraction"),A=e("g3w-ol/interactions/pickcoordinatesinteraction"),ke=e("g3w-ol/interactions/deletefeatureinteraction"),Ee=e("g3w-ol/interactions/areainteraction"),Me=e("g3w-ol/interactions/lengthinteraction"),e=e("core/utils/ol");t.exports={constant:r.default,core:{G3WObject:E,utils:M,geoutils:T,ApplicationService:i.default,ApplicationState:n.default,ApiService:x.default,Router:S.default,i18n:I,task:{TaskService:b.default},data:{DataRouterService:p.default},iframe:{IFrameRouterService:g.default},errors:{parsers:{Server:N}},editing:{Session:D,SessionsRegistry:h.default,Editor:G,ChangesManager:f.default},geometry:{Geom:P,Geometry:F},project:{ProjectsRegistry:y.default,Project:V},map:{MapLayersStoreRegistry:v.default},catalog:{CatalogLayersStoresRegistry:d.default},layer:{LayersStoreRegistry:$,LayersStore:U,Layer:q,LayerFactory:B,TableLayer:z,VectorLayer:W,ImageLayer:H,WmsLayer:K,XYZLayer:Z,MapLayer:Y,geometry:{Geometry:F,geom:P},features:{Feature:Q,FeaturesStore:X,OlFeaturesStore:J},filter:{Filter:ee,Expression:te}},relations:{RelationsService:_.default},interaction:{PickCoordinatesInteraction:A,PickFeatureInteraction:R},plugin:{Plugin:re,PluginsRegistry:m.default,PluginService:ne},workflow:{Task:ie,Step:ae,Flow:oe,Workflow:se,WorkflowsStack:w.default},input:{inputService:s.default}},gui:{GUI:L.default,Panel:O,ControlFactory:le,ComponentsFactory:ue,FieldsService:ce,vue:{Component:de,Panel:O,MetadataComponent:pe,SearchComponent:fe,SearchPanel:he,PrintComponent:ge,CatalogComponent:ve,MapComponent:me,ToolsComponent:ye,QueryResultsComponent:_e,FormComponent:be,FormComponents:{Body:l.default,Footer:u.default},Inputs:{G3wFormInputs:o.default,G3WInput:a.default,InputsComponents:xe},Charts:{ChartsFactory:Se,c3:{lineXY:c.default}},Fields:Le,Mixins:C.default,services:{SearchPanel:Ce,FormService:we}}},ol:{interactions:{PickFeatureInteraction:R,PickCoordinatesInteraction:A,DeleteFeatureInteraction:ke,measure:{AreaInteraction:Ee,LengthInteraction:Me}},controls:{},utils:e},info:function(){$script("https://unpkg.com/platform@1.3.6/platform.js",function(){window.console.info(("\n[g3wsdk.info]\n\n- g3w-admin: __"+initConfig.version+"__\n- g3w-client: __"+r.default.APP_VERSION+"__\n- browser: __"+platform.name+" "+platform.version+"__\n- operating system: __"+platform.os.toString()+"__\n").trim())})},version:r.default.APP_VERSION}},{"components/C3XYLine.vue":195,"components/FormBody.vue":215,"components/FormFooter.vue":216,"components/InputG3W.vue":239,"components/InputG3WFormInputs.vue":240,constant:4,"core/editing/editor":6,"core/editing/session":8,"core/errors/parser/servererrorparser":9,"core/expression/inputservice":10,"core/g3wobject":12,"core/i18n/i18n.service":13,"core/layers/features/feature":26,"core/layers/features/featuresstore":27,"core/layers/features/olfeaturesstore":28,"core/layers/filter/expression":29,"core/layers/filter/filter":30,"core/layers/imagelayer":33,"core/layers/layer":34,"core/layers/layerfactory":35,"core/layers/layersstore":36,"core/layers/layersstoresregistry":37,"core/layers/map/maplayer":43,"core/layers/map/wmslayer":45,"core/layers/map/xyzlayer":47,"core/layers/tablelayer":56,"core/layers/vectorlayer":57,"core/plugin/plugin":58,"core/plugin/pluginservice":59,"core/project/project":61,"core/utils/geo":64,"core/utils/ol":66,"core/utils/utils":68,"core/workflow/flow":70,"core/workflow/step":72,"core/workflow/task":73,"core/workflow/workflow":74,"g3w-ol/interactions/areainteraction":101,"g3w-ol/interactions/deletefeatureinteraction":102,"g3w-ol/interactions/lengthinteraction":103,"g3w-ol/interactions/pickcoordinatesinteraction":105,"g3w-ol/interactions/pickfeatureinteraction":106,"gui/catalog/vue/catalog":113,"gui/charts/chartsfactory":116,"gui/component/component":117,"gui/component/componentsfactory":118,"gui/fields/fields":120,"gui/fields/fieldsservice":121,"gui/form/formservice":122,"gui/form/vue/form":123,"gui/inputs/inputs":132,"gui/map/control/factory":156,"gui/map/vue/map":158,"gui/metadata/vue/metadata":161,"gui/panel":162,"gui/print/vue/print":164,"gui/queryresults/vue/queryresults":172,"gui/search/vue/panel/searchpanel":177,"gui/search/vue/panel/searchservice":178,"gui/search/vue/search":179,"gui/tools/vue/tools":186,mixins:343,"services/api":350,"services/application":351,"services/data":358,"services/editing":359,"services/gui":361,"services/iframe-plugin":364,"services/relations":367,"services/router":368,"services/tasks":370,"services/workflows":372,"store/application-state":373,"store/catalog-layers":374,"store/map-layers":377,"store/plugins":378,"store/projects":379,"store/sessions":380}],3:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.utils=r.server=r.client=r._i18n=r.tools=r.plugins=void 0;var e=e("../locales"),e=(e=e)&&e.__esModule?e:{default:e};var n=r.plugins={},i=r.tools={tools:[]},e=r._i18n={resources:e.default},a=r.client={debug:!0,local:!1},o=r.server={urls:{baseurl:"/",ows:"ows",api:"api",initconfig:"api/initconfig",config:"api/config"}},s=r.utils={merge:function(e){}};r.default={apptitle:"G3W Client",client:a,server:o,plugins:n,supportedLanguages:["en","it"],tools:i,_i18n:e,utils:s}},{"../locales":333}],4:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.LOGO_GIS3W=r.LOCAL_ITEM_IDS=r.FONT_AWESOME_ICONS=r.API_BASE_URLS=r.ZINDEXES=r.VIEWPORT=r.TOC_THEMES_INIT_STATUS=r.TOC_LAYERS_INIT_STATUS=r.TIMEOUT=r.SEARCH_RETURN_TYPES=r.SEARCH_ALLVALUE=r.QUERY_POINT_TOLERANCE=r.PRINT_SCALES=r.PRINT_RESOLUTIONS=r.PRINT_FORMATS=r.MAP_SETTINGS=r.LOCALSTORAGE_EXTERNALWMS_ITEM=r.LIST_OF_RELATIONS_ID=r.LIST_OF_RELATIONS_TITLE=r.GEOMETRY_TYPES=r.GEOMETRY_FIELDS=r.FILTER_EXPRESSION_OPERATORS=r.FILTER_OPERATORS=r.G3W_FID=r.EPSG=r.DOWNLOAD_FORMATS=r.DEFAULT_EDITING_CAPABILITIES=r.APP_VERSION=void 0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},e=e("../version"),e=(e=e)&&e.__esModule?e:{default:e};var e=r.APP_VERSION=e.default,i=r.DEFAULT_EDITING_CAPABILITIES=["add_feature","change_feature","change_attr_feature","delete_feature"],a=r.DOWNLOAD_FORMATS={download:{format:"shapefile",url:"shp"},download_gpkg:{format:"gpkg",url:"gpkg"},download_gpx:{format:"gpx",url:"gpx"},download_csv:{format:"csv",url:"csv"},download_xls:{format:"xls",url:"xls"},download_raster:{format:"geotiff",url:"geotiff"}},o=(r.EPSG=["EPSG:3003","EPSG:3004","EPSG:3045","EPSG:3857","EPSG:4326","EPSG:6708","EPSG:23032","EPSG:23033","EPSG:25833","EPSG:32632","EPSG:32633"],r.G3W_FID="g3w_fid",r.FILTER_OPERATORS={gte:">=",lte:"<=",NOT:"!=",eq:"=",gt:">",lt:"<",IN:"IN","NOT IN":"NOT IN",LIKE:"LIKE",ILIKE:"ILIKE",AND:"AND",OR:"OR"}),n=r.FILTER_EXPRESSION_OPERATORS=n({lte:"<=",ltgt:"!=",ilike:"ILIKE",like:"LIKE"},o),s=r.GEOMETRY_FIELDS=["geometryProperty","boundedBy","geom","the_geom","geometry","bbox","GEOMETRY","geoemtria","geometria"],l=r.GEOMETRY_TYPES={POINT:"Point",POINTZ:"PointZ",POINTM:"PointM",POINTZM:"PointZM",POINT25D:"Point25D",MULTIPOINT:"MultiPoint",MULTIPOINTZ:"MultiPointZ",MULTIPOINTM:"MutliPointM",MULTIPOINTZM:"MultiPointZM",MULTIPOINT25D:"MultiPoint25D",LINESTRING:"LineString",LINESTRINGZ:"LineStringZ",LINESTRINGM:"LineStringM",LINESTRINGZM:"LineStringZM",LINESTRING25D:"LineString25D",LINE:"Line",LINEZ:"LineZ",LINEM:"LineM",LINEZM:"LineZM",LINE25D:"Line25D",MULTILINESTRING:"MultiLineString",MULTILINESTRINGZ:"MultiLineStringZ",MULTILINESTRINGM:"MultiLineStringM",MULTILINESTRINGZM:"MultiLineStringZM",MULTILINESTRING25D:"MultiLineString25D",MULTILINE:"MultiLine",MULTILINEZ:"MultiLineZ",MULTILINEM:"MultiLineM",MULTILINEZM:"MultiLineZM",MULTILINE25D:"MultiLine25D",POLYGON:"Polygon",POLYGONZ:"PolygonZ",POLYGONM:"PolygonM",POLYGONZM:"PolygonZM",POLYGON25D:"Polygon25D",MULTIPOLYGON:"MultiPolygon",MULTIPOLYGONZ:"MultiPolygonZ",MULTIPOLYGONM:"MultiPolygonM",MULTIPOLYGONZM:"MultiPolygonZM",MULTIPOLYGON25D:"MultiPolygon25D",GEOMETRYCOLLECTION:"GeometryCollection",GEOMETRYCOLLECTIONZ:"GeometryCollectionZ",GEOMETRYCOLLECTIONM:"GeometryCollectionM",GEOMETRYCOLLECTIONZM:"GeometryCollectionZM",GEOMETRYCOLLECTION25D:"GeometryCollection25D"},u=(r.LIST_OF_RELATIONS_TITLE="info.list_of_relations",r.LIST_OF_RELATIONS_ID="__G3W_LIST_OF_RELATIONS_ID__",r.LOCALSTORAGE_EXTERNALWMS_ITEM="externalwms",r.MAP_SETTINGS={ZOOM:{maxScale:1e3},ANIMATION:{duration:2e3},LAYER_POSITIONS:{default:"top",getPositions:function(){return["top","bottom"]}}}),c=r.PRINT_FORMATS=[{value:"pdf",label:"PDF"},{value:"png",label:"PNG"}],d=r.PRINT_RESOLUTIONS=[150,300],p=r.PRINT_SCALES=[{value:100,label:"1:100"},{value:200,label:"1:200"},{value:500,label:"1:500"},{value:1e3,label:"1:1.000"},{value:2e3,label:"1:2.000"},{value:2500,label:"1:2.500"},{value:5e3,label:"1:5.000"},{value:1e4,label:"1:10.000"},{value:2e4,label:"1:20.000"},{value:25e3,label:"1:25.000"},{value:5e4,label:"1:50.000"},{value:1e5,label:"1:100.000"},{value:25e4,label:"1:250.000"},{value:5e5,label:"1:500.000"},{value:1e6,label:"1:1.000.000"},{value:25e5,label:"1:2.500.000"},{value:5e6,label:"1:5.000.000"},{value:1e7,label:"1:10.000.000"},{value:2e7,label:"1:20.000.000"},{value:5e7,label:"1:50.000.000"},{value:1e8,label:"1:100.000.000"},{value:25e7,label:"1:250.000.000"},{value:5e8,label:"1:500.000.000"}],f=r.QUERY_POINT_TOLERANCE={unit:"pixel",value:10},h=(r.SEARCH_ALLVALUE="__G3W_ALL__",r.SEARCH_RETURN_TYPES=["data","search"]),g=(r.TIMEOUT=6e4,r.TOC_LAYERS_INIT_STATUS="not_collapsed",r.TOC_THEMES_INIT_STATUS="collapsed",r.VIEWPORT={resize:{map:{min:200},content:{min:200}}}),v=r.ZINDEXES={usermessage:{tool:2}},m=r.API_BASE_URLS={ABOUT:{macrogroups:"/about/api/macrogroup/",nomacrogoups:"/about/api/group/nomacrogroup/",projects:"/about/api/group/__G3W_GROUP_ID__/projects/",group:"/about/api/group/"},CRS:"/crs/"},y=r.FONT_AWESOME_ICONS={"change-map":"fas fa-map-signs",map:"far fa-map",file:"fas fa-file-code",marker:"fas fa-map-marker-alt",relation:"fas fa-sitemap",tools:"fas fa-cogs",tool:"fas fa-cog",search:"fas fa-search",print:"fas fa-print",info:"fas fa-info-circle","info-circle":"fas fa-info-circle",globe:"fas fa-globe",mail:"fas fa-envelope",mobile:"fas fa-mobile",fax:"fas fa-fax",user:"fas fa-user",bars:"fas fa-bars",uncheck:"far fa-square",check:"far fa-check-square",filluncheck:"fas fa-square",table:"fas fa-table",trash:"fas fa-trash","trash-o":"far fa-trash-alt",pencil:"fas fa-pencil-alt","ellips-h":"fas fa-ellipsis-h","ellips-v":"fas fa-ellipsis-v","arrow-up":"fas fa-chevron-up","arrow-down":"fas fa-chevron-down","arrow-left":"fas fa-chevron-left","arrow-right":"fas fa-chevron-right","resize-h":"fas fa-arrows-alt-h","resize-v":"fas fa-arrows-alt-v","resize-default":"fas fa-compress","caret-up":"fas fa-caret-up","caret-down":"fas fa-caret-down","caret-left":"fas fa-caret-left","caret-right":"fas fa-caret-right","empty-circle":"far fa-circle","cloud-upload":"fas fa-cloud-upload-alt",spinner:"fas fa-spinner",minus:"fas fa-minus","minus-square":"far fa-minus-square",plus:"fas fa-plus","plus-circle":"fas fa-plus-circle","plus-square":"far fa-plus-square",grid:"fas fa-th",home:"fas fa-home",folder:"fas fa-folder","sign-out":"fas fa-sign-out-alt",close:"fas fa-times",time:"far fa-clock",calendar:"fas fa-calendar-alt",list:"fas fa-list-alt",link:"fas fa-link",unlink:"fas fa-unlink",eye:"far fa-eye","eye-close":"far fa-eye-slash",save:"far fa-save",pdf:"fas fa-file-pdf",image:"far fa-image",video:"far fa-file-video",unknow:"far fa-question-circle",zip:"far fa-file-archive",text:"far fa-file-alt",excel:"far fa-file-excel",xls:"far fa-file-excel",gpx:"fas fa-location-arrow",gpkg:"fas fa-box-open",shapefile:"fas fa-file-archive",csv:"fas fa-file-csv",geotiff:"fas fa-th",ppt:"far fa-file-powerpoint",circle:"fas fa-circle",calculator:"fas fa-calculator",picture:"far fa-image",keyboard:"far fa-keyboard","file-download":"fas fa-file-download",copy:"far fa-copy",draw:"fas fa-draw-polygon",chart:"fas fa-chart-bar","chart-line":"fas fa-chart-line","chart-area":"fas fa-chart-area","chart-pie":"fas fa-chart-pie",run:"fas fa-play",warning:"fas fa-exclamation-circle",alert:"fas fa-exclamation-triangle",crosshairs:"fas fa-crosshairs",success:"far fa-check-circle",back:"fas fa-chevron-circle-left","file-upload":"fas fa-file-upload",wifi:"fas fa-wifi",mouse:"fas fa-mouse","copy-paste":"far fa-copy","vector-square":"fas fa-vector-square",download:"fas fa-download",credits:"fas fa-euro-sign",filter:"fas fa-filter",plugin:"fas fa-plug",invert:"fas fa-exchange-alt",clear:"fas fa-broom",palette:"fas fa-palette",layers:"fas fa-layer-group","sign-in":"fas fa-sign-in-alt",language:"fas fa-language",target:"fas fa-bullseye",pin:"fas fa-map-pin",square:"far fa-square",move:"fas fa-arrows-alt",moon:"fas fa-moon",sun:"fas fa-sun",refresh:"fas fa-sync-alt",pause:"fas fa-pause","step-backward":"fas fa-step-backward","fast-backward":"fas fa-fast-backward","step-forward":"fas fa-step-forward","fast-forward":"fas fa-fast-forward",crop:"fas fa-crop-alt",exit:"fas fa-door-open",slider:"fas fa-sliders-h",bookmark:"fas fa-bookmark",reply:"fas fa-reply",share:"fas fa-share"},_=r.LOCAL_ITEM_IDS={MESSAGES:{id:"MESSAGES",value:{}},SPATIALBOOKMARKS:{id:"SPATIALBOOKMARKS",value:{}}};r.LOGO_GIS3W="images/logo_gis3w_156_85.png";r.default={APP_VERSION:e,API_BASE_URLS:m,DEFAULT_EDITING_CAPABILITIES:i,DOWNLOAD_FORMATS:a,FILTER_OPERATORS:o,FILTER_EXPRESSION_OPERATORS:n,FONT_AWESOME_ICONS:y,G3W_FID:"g3w_fid",GEOMETRY_FIELDS:s,GEOMETRY_TYPES:l,LIST_OF_RELATIONS_TITLE:"info.list_of_relations",LIST_OF_RELATIONS_ID:"__G3W_LIST_OF_RELATIONS_ID__",LOCAL_ITEM_IDS:_,LOCALSTORAGE_EXTERNALWMS_ITEM:"externalwms",LOGO_GIS3W:"images/logo_gis3w_156_85.png",MAP_SETTINGS:u,PRINT_FORMATS:c,PRINT_RESOLUTIONS:d,PRINT_SCALES:p,QUERY_POINT_TOLERANCE:f,SEARCH_ALLVALUE:"__G3W_ALL__",SEARCH_RETURN_TYPES:h,TIMEOUT:6e4,TOC_LAYERS_INIT_STATUS:"not_collapsed",TOC_THEMES_INIT_STATUS:"collapsed",VIEWPORT:g,ZINDEXES:v}},{"../version":381}],5:[function(e,t,r){var n=a(e("store/projects")),i=a(e("services/gui"));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var s=e("core/utils/utils").resolve;function l(){var t=this;n.default.onbefore("setCurrentProject",function(e){return t.project=e}),this.project=n.default.getCurrentProject()}var u,e=l.prototype;e.handleRequest=function(e){},e.handleResponse=(u=o(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)})),function(e){return u.apply(this,arguments)}),e.getSelectedExternalLayers=function(e){e=e.type,e=void 0===e?"vector":e;return i.default.getService("catalog").getExternalSelectedLayers({type:e})},e.getEmptyRequest=function(){return s([])},e.hasExternalLayerSelected=function(e){e=e.type;return 0<this.getSelectedExternalLayers({type:void 0===e?"vector":e}).length},t.exports=l},{"core/utils/utils":68,"services/gui":361,"store/projects":379}],6:[function(e,t,r){var o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},n=a(e("store/application-state")),i=a(e("services/editing")),s=a(e("store/sessions"));function a(e){return e&&e.__esModule?e:{default:e}}function l(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var u=e("core/utils/utils"),c=u.inherit,d=u.base,u=e("core/g3wobject"),p=e("core/layers/features/featuresstore"),f=e("core/layers/features/olfeaturesstore"),h=e("core/layers/layer");function g(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.setters={save:function(){this._save()},addFeature:function(e){this._addFeature(e)},updateFeature:function(e){this._updateFeature(e)},deleteFeature:function(e){this._deleteFeature(e)},setFeatures:function(){this._setFeatures(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[])},getFeatures:function(){return this._getFeatures(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}},d(this),this._filter={bbox:null},this._allfeatures=!1,this._layer=e.layer,this._featuresstore=new(this._layer.getType()===h.LayerTypes.TABLE?p:f),this._started=!1,this._noteditablefileds=this._layer.getEditingNotEditableFields()||[]}c(g,u);e=g.prototype;e._canDoGetFeaturesRequest=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=!0;return this._layer.getType()===h.LayerTypes.VECTOR&&(e=(e.filter||{}).bbox)&&(this._filter.bbox?ol.extent.containsExtent(this._filter.bbox,e)?t=!1:this._filter.bbox=ol.extent.extend(this._filter.bbox,e):this._filter.bbox=e),t},e.getEditingSource=function(){return this._featuresstore},e.getSource=function(){this._layer.getSource()},e._applyChanges=function(){i.default.execute(this._featuresstore,0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],!(1<arguments.length&&void 0!==arguments[1])||arguments[1])},e.setChanges=function(e,t){this._applyChanges(e,t)},e.getLayer=function(){return this._layer},e.setLayer=function(e){return this._layer=e,this._layer},e.removeNotEditablePropriertiesFromFeature=function(t){this._noteditablefileds.forEach(function(e){return t.unset([e])})},e._cloneFeatures=function(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).map(function(e){return e.clone()})},e._addFeaturesFromServer=function(){var e=this._cloneFeatures(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]);this._featuresstore.addFeatures(e)},e._doGetFeaturesRequest=function(){return n.default.online&&!this._allfeatures&&this._canDoGetFeaturesRequest(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},e._getFeatures=function(){var t=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=$.Deferred();return this._doGetFeaturesRequest(r)?this._layer.getFeatures(r).then(function(e){e.then(function(e){return t._addFeaturesFromServer(e),t._allfeatures=!r.filter,n.resolve(e)}).fail(function(e){return n.reject(e)})}).fail(function(e){return n.reject(e)}):n.resolve(),n.promise()},e.revert=function(){var e=$.Deferred(),t=this._cloneFeatures(this._layer.readFeatures());return this._featuresstore.setFeatures(t),e.resolve(),e.promise()},e.rollback=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=$.Deferred();return this._applyChanges(e,!0),t.resolve(),t.promise()},e.applyChangesToNewRelationsAfterCommit=function(e){for(var t in e){var r=e[t],n=this.getLayerById(t),t=this.getEditingLayer(t).getEditingSource(),i=t.readFeatures();i.forEach(function(e){return e.clearState()}),n.getSource().setFeatures(i),n.applyCommitResponse({response:r,result:!0}),t.setFeatures(n.getSource().readFeatures())}},e.setFieldValueToRelationField=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.relationId,r=e.ids,n=e.field,e=e.values,i=void 0===e?[]:e,a=s.default.getSession(t).getEditor().getEditingSource();r.forEach(function(e){e=a.getFeatureById(e);e&&e.get(n)==i[0]&&e.set(n,i[1])})},e.applyCommitResponse=function(){var e,a=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];t&&t.result&&(e=(t=t.response).new,t=t.new_lockids,e.forEach(function(n){var i=a._featuresstore.getFeatureById(n.clientid);i.setId(n.id),i.setProperties(n.properties),r.forEach(function(e){Object.entries(e).forEach(function(e){var e=o(e,2),t=e[0],e=e[1],r=i.get(e.fatherField);a.setFieldValueToRelationField({relationId:t,ids:e.ids,field:e.childField,values:[n.clientid,r]})})})}),(e=this._featuresstore.readFeatures()).forEach(function(e){return e.clearState()}),this._layer.setFeatures(e),this._layer.getSource().addLockIds(t))},e.getLockIds=function(){return this._layer.getSource().getLockIds()},e.commit=function(a){var o=this,t=$.Deferred(),r=a.add.length?Object.keys(a.relations).map(function(e){var t,r=o._layer.getRelations().getRelationByFatherChildren(o._layer.getId(),e),n=a.relations[e].update.map(function(e){return e.id}),i=a.relations[e].add.map(function(e){return e.id});return t={},e=e,i={ids:[].concat(l(i),l(n)),fatherField:r.getFatherField(),childField:r.getChildField()},e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}):[];return this._layer.commit(a).then(function(e){e.then(function(e){o.applyCommitResponse(e,r),t.resolve(e)}).fail(function(e){return t.reject(e)})}).fail(function(e){return t.reject(e)}),t.promise()},e.start=function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred();return this.getFeatures(e).then(function(e){e.then(function(e){r.resolve(e),t._started=!0}).fail(function(e){return r.reject(e)})}).fail(function(e){return r.reject(e)}),r.promise()},e._addFeature=function(e){this._featuresstore.addFeature(e)},e._deleteFeature=function(e){this._featuresstore.deleteFeature(e)},e._updateFeature=function(e){this._featuresstore.updateFeature(e)},e._setFeatures=function(e){this._featuresstore.setFeatures(e)},e.readFeatures=function(){return this._layer.readFeatures()},e.readEditingFeatures=function(){return this._featuresstore.readFeatures()},e.stop=function(){var t=this,r=$.Deferred();return this._layer.unlock().then(function(e){t.clear(),r.resolve(e)}).fail(function(e){return r.reject(e)}),r.promise()},e._save=function(){this._layer.save()},e.isStarted=function(){return this._started},e.clear=function(){this._started=!1,this._filter.bbox=null,this._allfeatures=!1,this._featuresstore.clear(),this._layer.getFeaturesStore().clear(),this._layer.getType()===h.LayerTypes.VECTOR&&this._layer.resetEditingSource(this._featuresstore.getFeaturesCollection())},t.exports=g},{"core/g3wobject":12,"core/layers/features/featuresstore":27,"core/layers/features/olfeaturesstore":28,"core/layers/layer":34,"core/utils/utils":68,"services/editing":359,"store/application-state":373,"store/sessions":380}],7:[function(e,t,r){var n=e("core/utils/utils"),a=n.base;function o(){this.id=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).id,a(this),this._maxSteps=10,this._states=[],this.state={commit:!1,undo:!1,redo:!1},this._current=null}(0,n.inherit)(o,e("core/g3wobject"));n=o.prototype;n.add=function(e,t){var r=this,n=$.Deferred();return null===this._current?this._states=[{id:e,items:t}]:(this._states.length&&this._current<this.getLastState().id&&(this._states=this._states.filter(function(e){return e.id<=r._current})),this._states.push({id:e,items:t})),this._current=e,this._setState(),n.resolve(e),n.promise()},n.getRelationStates=function(t){(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).clear;for(var e=[],r=0;r<this._states.length;r++){var n=this._states[r],i=n.items.filter(function(e){return(Array.isArray(e)?e[0]:e).layerId===t});i.length&&e.push({id:n.id,items:i})}return e},n.insertState=function(e){for(var t=e.id,r=this._states.length,n=0;n<this._states.length;n++){var i=this._states[n];if(i.id>t){r=n;break}i.id===t&&(r=-1);break}-1<r&&(this._current<t&&(this._current=t),this._states.splice(r,0,e))},n.removeState=function(e){var t=void 0;for(i=0;i<this._states.length;i++)if(this._states[i].id===e){t=i;break}this._current===e&&(this._current=1<this._states.length?this._states[t-1].id:null),this._states.splice(t,1)},n.removeStates=function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=0;t<e.length;t++){var r=e[t];this.removeState(r)}},n.insertStates=function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=0;t<e.length;t++)this.insertState(e[t]);this.canCommit()},n._setState=function(){this.canUndo(),this.canCommit(),this.canRedo()},n._checkItems=function(e,t){var r=this,n={own:[],dependencies:{}};return e.forEach(function(e){Array.isArray(e)&&(e=e[t]),(r.id===e.layerId?n:(n.dependencies[e.layerId]||(n.dependencies[e.layerId]={own:[],dependencies:{}}),n.dependencies[e.layerId])).own.push(e)}),n},n.undo=function(){var r=this,n=void 0;return this._current===this.getFirstState().id?(this._current=null,n=this._states[0].items):this._states.find(function(e,t){if(e.id===r._current)return n=r._states[t].items,r._current=r._states[t-1].id,!0}),n=this._checkItems(n,0),this._setState(),n},n.redo=function(){var r=this,n=void 0;return this._current?this._states.find(function(e,t){if(r._current===e.id)return r._current=r._states[t+1].id,n=r._states[t+1].items,!0}):(n=this._states[0].items,this._current=this._states[0].id),n=this._checkItems(n,1),this._setState(),n},n.setItemsFeatureIds=function(){var n=this;(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(e){var t=e.id,r=e.clientid;n._states.forEach(function(e){e.items.forEach(function(e){e=e.feature.getId()===r&&e.feature;e&&e.setId(t)})})})},n.clear=function(r){var n=this;r?this._states.forEach(function(e,t){-1!==r.indexOf(e.id)&&(n._current&&n._current===e.id()&&n.undo(),n._states.splice(t,1))}):this._clearAll()},n._clearAll=function(){this._states=[],this._current=null,this.state.commit=!1,this.state.redo=!1,this.state.undo=!1},n.getState=function(t){return this._states.find(function(e){return e.id===t})},n.getFirstState=function(){return this._states.length?this._states[0]:null},n.getLastState=function(){var e=this._states.length;return e?this._states[e-1]:null},n.getCurrentState=function(){var t=this,e=null;return e=this._current&&this._states.length?this._states.find(function(e){return t._current===e.id}):e},n.getCurrentStateIndex=function(){var r=this,n=null;return this._current&&this._states.length&&this._states.forEach(function(e,t){if(r._current===e.id)return n=t,!1}),n},n.canCommit=function(){var e,t=this.commit(),r=!1;for(e in t)var n=t[e],r=r||!!n.length;return this.state.commit=r,this.state.commit},n.canUndo=function(){var e=this._states.length-1-this.getCurrentStateIndex();return this.state.undo=!_.isNull(this._current)&&this._maxSteps>e,this.state.undo},n.canRedo=function(){return this.state.redo=this.getLastState()&&this.getLastState().id!=this._current||_.isNull(this._current)&&0<this._states.length,this.state.redo},n._getStatesToCommit=function(){var t=this;return this._states.filter(function(e){return e.id<=t._current})},n.commit=function(){var i={};return this._getStatesToCommit().forEach(function(e){e.items.forEach(function(r){var e,t,n=!0;Array.isArray(r)&&(r=r[1]),i[r.layerId]&&i[r.layerId].forEach(function(e,t){if(e.getUid()===r.feature.getUid())return r.feature.isNew()&&!e.isDeleted()&&r.feature.isUpdated()?((e=r.feature.clone()).add(),i[r.layerId][t]=e):r.feature.isNew()&&r.feature.isDeleted()?i[r.layerId].splice(t,1):(r.feature.isUpdated()||r.feature.isDeleted())&&(i[r.layerId][t]=r.feature),n=!1}),n&&(e=r.feature,t=r.layerId,!e.isNew()&&e.isAdded()||(i[t]||(i[t]=[]),i[t].push(e)))})}),i},t.exports=o},{"core/g3wobject":12,"core/utils/utils":68}],8:[function(e,t,r){var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=n(e("store/sessions")),o=n(e("store/map-layers"));function n(e){return e&&e.__esModule?e:{default:e}}var i=e("core/utils/utils"),a=i.base,i=i.inherit,s=e("core/g3wobject"),l=e("core/editing/history"),d=e("core/layers/layer"),p=e("core/utils/geo").Geometry.is3DGeometry;function f(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.setters={start:function(){return this._start(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},getFeatures:function(){return this._getFeatures(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},stop:function(){return this._stop()},saveChangesOnServer:function(e){}},a(this,e),this.state={id:e.id,started:!1,getfeatures:!1},this._editor=e.editor,this._history=new l({id:this.state.id}),this._temporarychanges=[],this.register()}i(f,s);e=f.prototype;e.getId=function(){return this.state.id},e.getLastHistoryState=function(){return this._history.getLastState()},e.getLastStateId=function(){return this._history.getLastState().id},e.deleteState=function(e){this._history.removeState(e)},e.register=function(){c.default.register(this)},e.unregister=function(){c.default.unregister(this.getId())},e._start=function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred();return this._editor.start(e).then(function(e){t.state.started=!0,r.resolve(e)}).fail(function(e){r.reject(e)}),r.promise()},e._getFeatures=function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred();return this._allfeatures?r.resolve([]):(this._allfeatures=!e.filter,this._editor.getFeatures(e).then(function(e){e.then(function(e){t.state.getfeatures=!0,r.resolve(e)}).fail(function(e){return r.reject(e)})})),r.promise()},e.isStarted=function(){return this.state.started},e.getEditor=function(){return this._editor},e.setEditor=function(e){this._editor=e},e.save=function(){var e,t=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=$.Deferred();return this._temporarychanges.length?(e=r.id||Date.now(),this._history.add(e,this._temporarychanges).then(function(){t._temporarychanges=[],n.resolve(e)})):n.resolve(null),n.promise()},e.updateTemporaryChanges=function(t){this._temporarychanges.forEach(function(e){e.feature.setProperties(t.getProperties())})},e.pushAdd=function(e,t){2<arguments.length&&void 0!==arguments[2]&&!arguments[2]||this._editor.removeNotEditablePropriertiesFromFeature(t);var r=t.clone();return this.push({layerId:e,feature:r.add()}),r},e.pushDelete=function(e,t){return this.push({layerId:e,feature:t.delete()}),t},e.pushUpdate=function(t,r,e){if(r.isNew()){var n,i=this._temporarychanges.findIndex(function(e){return e.layerId===t&&e.feature.getId()===r.getId()});if(-1!==i)return(n=r.clone()).add(),void(this._temporarychanges[i].feature=n)}this.push({layerId:t,feature:r.update()},{layerId:t,feature:e.update()})},e.removeChangesFromHistory=function(){this._history.removeStates(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[])},e.moveRelationStatesOwnSession=function(){var e,t={};for(e in this.getCommitItems().relations){var r=this._history.getRelationStates(e);c.default.getSession(e)._history.insertStates(r),t[e]=r.map(function(e){return e.id})}return t},e.push=function(e,t){this._temporarychanges.push(t?[t,e]:e)},e.revert=function(){var e=this,t=$.Deferred();return this._editor.revert().then(function(){e._history.clear(),t.resolve()}),t.promise()},e._filterChanges=function(){var t=this.getId(),r={own:[],dependencies:{}};return this._temporarychanges.forEach(function(e){e=Array.isArray(e)?e[0]:e;e.layerId===t?r.own.push(e):(r.dependencies[e.layerId]||(r.dependencies[e.layerId]=[]),r.dependencies[e.layerId].unshift(e))}),r},e.rollback=function(e){var r,n;return e?this._editor.rollback(e):(r=$.Deferred(),n=this._filterChanges(),this._editor.rollback(n.own).then(function(){var e,t=n.dependencies;for(e in t)c.default.getSession(e).rollback(t[e]);r.resolve(t)}),this._temporarychanges=[],r.promise())},e.rollbackDependecies=function(){var e=this;(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(t){var r=[];e._temporarychanges=e._temporarychanges.filter(function(e){if(e.layerId===t)return r.push(e),!1}),r.length&&c.default.getSession(t).rollback(r)})},e.undo=function(e){return e=e||this._history.undo(),this._editor.setChanges(e.own,!0),this._history.canCommit(),e.dependencies},e.redo=function(e){return e=e||this._history.redo(),this._editor.setChanges(e.own,!0),this._history.canCommit(),e.dependencies},e._serializeCommit=function(e){var t,r=this.getId(),a=void 0,o=void 0,n={add:[],update:[],delete:[],relations:{}};for(t in e){var i,s=!1,l=e[t],o=t!==r?(s=!0,i=(i=c.default.getSession(t))?i.getEditor().getLockIds():[],n.relations[t]={lockids:i,add:[],update:[],delete:[]},n.relations[t]):n;l.forEach(function(e){a=e.getState();var t=new ol.format.GeoJSON;if("delete"===a)e.isNew()||o.delete.push(e.getId());else{var r,n=t.writeFeatureObject(e),i=e.getProperties();for(r in n.properties)n.properties[r]&&"object"===u(n.properties[r])&&n.properties[r].constructor===Object&&(n.properties[r]=n.properties[r].value),void 0===n.properties[r]&&i[r]&&(n.properties[r]=i[r]);t=e.isNew()?"add":e.getState();o[t].push(n)}}),!s||o.add.length||o.update.length||o.delete.length||delete n.relations[t]}return n},e.getCommitItems=function(){var e=this._history.commit();return this._serializeCommit(e)},e.set3DGeometryType=function(){var t,r=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=e.layerId,n=void 0===n?this.getId():n,i=e.commitItems,a=i.relations,e=o.default.getLayerById(n).getEditingLayer();e&&e.getType()===d.LayerTypes.VECTOR&&(t=e.getGeometryType(),p(t))&&["add","update"].forEach(function(e){i[e].forEach(function(e){return e.geometry.type=t})}),Object.keys(a).forEach(function(e){return r.set3DGeometryType({layerId:e,commitItems:a[e]})})},e.commit=function(){var i=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.ids,t=void 0===t?null:t,r=e.items,e=e.relations,e=void 0===e||e,a=$.Deferred(),o=void 0;return t?(o=this._history.commit(t),this._history.clear(t)):(o=r||(o=this._history.commit(),this._serializeCommit(o)),e||(o.relations={}),this._editor.commit(o).then(function(e){if(e&&e.result){var t,r=e.response.new_relations,n=void 0===r?{}:r;for(t in n)c.default.getSession(t).getEditor().applyCommitResponse({response:n[t],result:!0});i._history.clear(),i.saveChangesOnServer(o),a.resolve(o,e)}else a.reject(e)}).fail(function(e){return a.reject(e)})),a.promise()},e._canStop=function(){return this.state.started||this.state.getfeatures},e._stop=function(){var e=this,t=$.Deferred();return this._canStop()?this._editor.stop().then(function(){e.clear(),t.resolve()}).fail(function(e){return t.reject(e)}):t.resolve(),t.promise()},e.clear=function(){this._allfeatures=!1,this.state.started=!1,this.state.getfeatures=!1,this.clearHistory(),this._editor.clear()},e.getHistory=function(){return this._history},e.clearHistory=function(){this._history.clear()},t.exports=f},{"core/editing/history":7,"core/g3wobject":12,"core/layers/layer":34,"core/utils/geo":64,"core/utils/utils":68,"store/map-layers":377,"store/sessions":380}],9:[function(e,t,r){function n(){this._error=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).error}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},l=e("core/i18n/i18n.service").t;n.prototype.parse=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).type,e=void 0===e?"responseJSON":e,i="server_saver_error";function a(e){var e=Object.entries(e),t=e.find(function(e){var e=s(e,2),t=e[0];e[1];return"fields"===t});if(t){var r,t=s(t,2)[1];try{"string"==typeof t?(n=e.find(function(e){var e=s(e,2),t=e[0];e[1];return"fields"!==t}),r=s(n,1)[0],i="["+r+"] "+t):(i="",Object.entries(t).forEach(function(e){var e=s(e,2),t=e[0],e=e[1];i=""+i+t+" "+(Array.isArray(e)?e[0]:e)+" \n"}))}catch(e){}return i.replace(/\:|\./g,"")}var n=s(e[0],2)[1];if(!Array.isArray(n)&&"object"===(void 0===n?"undefined":o(n)))return a(n)}if("responseJSON"===e){if(this._error&&this._error.responseJSON&&this._error.responseJSON.error.message)return this._error.responseJSON.error.message;if(this._error&&this._error.errors)return a(this._error.errors)}else if("String"===e)return"string"==typeof this._error?this._error:a(this._error);return l("server_saver_error")},t.exports=n},{"core/i18n/i18n.service":13}],10:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("services/data"),h=(n=n)&&n.__esModule?n:{default:n};function i(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var a,o,g=e("core/utils/geo").convertFeatureToGEOJSON;r.default={handleFilterExpressionFormInput:(o=i(regeneratorRuntime.mark(function e(){var t,r,n,i,a,o,s,l,u=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},c=u.field,d=u.feature,p=u.qgs_layer_id,f=u.parentData;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=c.input.options,t=a.key,r=a.value,n=a.layer_id,n=void 0===n?p:n,i=a.filter_expression,a=a.loading,i){e.next=3;break}return e.abrupt("return");case 3:return a.state="loading",e.prev=4,e.next=7,h.default.getData("expression:expression",{inputs:{field_name:c.name,layer_id:n,qgs_layer_id:p,form_data:g(d),parent:f&&{form_data:g(f.feature),qgs_layer_id:f.qgs_layer_id,formatter:0},formatter:0,expression:i.expression},outputs:!1});case 7:if(o=e.sent,"select_autocomplete"===c.input.type){for(c.input.options.values=[],s=[],l=0;l<o.length;l++)s.push({key:o[l].properties[t],value:o[l].properties[r]});s.sort(function(e,t){e=e.key,t=t.key;return"string"==typeof e&&(e=e.toLowerCase(),t=t.toLowerCase()),e<t?-1:t<e?1:0}),c.input.options.values=s}return e.abrupt("return",o);case 12:return e.prev=12,e.t0=e.catch(4),e.abrupt("return",Promise.reject(e.t0));case 15:return e.prev=15,a.state="ready",e.finish(15);case 18:case"end":return e.stop()}},e,this,[[4,12,15,18]])})),function(){return o.apply(this,arguments)}),handleDefaultExpressionFormInput:(a=i(regeneratorRuntime.mark(function e(){var t,r,n,i,a,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},s=o.field,l=o.feature,u=o.qgs_layer_id,c=o.parentData;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=s.input.options,t=i.layer_id,t=void 0===t?u:t,r=i.default_expression,n=i.loading,i=i.default,r){e.next=3;break}return e.abrupt("return");case 3:return n.state="loading",e.prev=4,e.next=7,h.default.getData("expression:expression_eval",{inputs:{field_name:s.name,layer_id:t,qgs_layer_id:u,form_data:g(l),formatter:0,expression:r.expression,parent:c&&{form_data:g(c.feature),qgs_layer_id:c.qgs_layer_id,formatter:0}},outputs:!1});case 7:return a=e.sent,s.value=a,e.abrupt("return",a);case 12:return e.prev=12,e.t0=e.catch(4),void 0!==i&&(s.value=i),e.abrupt("return",Promise.reject(e.t0));case 16:return e.prev=16,n.state="ready",e.finish(16);case 19:case"end":return e.stop()}},e,this,[[4,12,16,19]])})),function(){return a.apply(this,arguments)})}},{"core/utils/geo":64,"services/data":358}],11:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("services/data"),a=(n=n)&&n.__esModule?n:{default:n};var n=e("core/utils/geo"),o=n.getFormDataExpressionRequestFromFeature,s=n.convertFeatureToGEOJSON;r.default={getVisibility:function(e){var t=e.qgs_layer_id,r=e.expression,n=e.feature,n=void 0===n?{}:n,e=e.contenttype,i="query"===e?1:0,e=("editing"===e?s:o)(n);return a.default.getData("expression:expression_eval",{inputs:{qgs_layer_id:t,form_data:e,expression:r,formatter:i},outputs:!1})}}},{"core/utils/geo":64,"services/data":358}],12:[function(e,t,r){function n(){this.setters&&this._setupListenersChain(this.setters),this.debounces&&this._setupDebounces(this.debounces),this.throttles&&this._setupThrottles(this.throttles)}var a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},e=e("core/utils/utils"),i=e.inherit,o=e.noop,s=e.debounce,l=e.throttle,e=(i(n,EventEmitter),n.prototype);e.onafter=function(e,t,r){return this._onsetter("after",e,t,!1,r)},e.onceafter=function(e,t,r){return this._onsetter("after",e,t,!1,r,!0)},e.onbefore=function(e,t,r){return this._onsetter("before",e,t,!1,r)},e.oncebefore=function(e,t,r){return this._onsetter("before",e,t,!1,r,!0)},e.onbeforeasync=function(e,t,r){return this._onsetter("before",e,t,!0,r)},e.un=function(n,i){Object.entries(this.settersListeners).forEach(function(e){var e=a(e,2),r=(e[0],e[1]);void 0===i?r[n].splice(0):r[n].forEach(function(e,t){e.key===i&&r[n].splice(t,1)})})},e._onsetter=function(e,t,r,n){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,a=5<arguments.length&&void 0!==arguments[5]&&arguments[5],o=void 0;return void 0!==this.settersListeners[e][t]&&(o=""+(Math.floor(1e6*Math.random())+Date.now()),this.settersListeners[e][t].push({key:o,fnc:r,async:n,priority:i,once:a}),this.settersListeners[e][t]=_.sortBy(this.settersListeners[e][t],function(e){return e.priority})),o},e._setupListenersChain=function(t){var e,r=this;this.settersListeners={after:{},before:{}};for(e in t)!function(c){var e=t[c],d=o,p=o;_.isFunction(e)?d=e:(d=e.fnc,p=e.fallback||o),r.settersListeners.after[c]=[],r.settersListeners.before[c]=[],r[c]=function(){for(var i=this,e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];var r=$.Deferred(),n=null,o=0,s=function(){n=d.apply(i,a),r.resolve(n);var t=[];i.settersListeners.after[c].forEach(function(e){e.fnc.apply(i,a),e.once&&t.push(e.key)}),t.forEach(function(e){return i.un(c,e)})},l=function(){p.apply(i,a),r.reject()},u=this.settersListeners.before[c],o=0;return function e(t){var r,n=!0;!1===(n=_.isBoolean(t)?t:n)?l.apply(i,a):o===u.length?void 0!==(t=s())&&!0!==t||i.emitEvent("set:"+c,a):n&&(t=u[o],u[n=o].async?(a.push(e),o+=1,t.fnc.apply(i,a)):(r=t.fnc.apply(i,a),o+=1,e(r)),t.once)&&u.splice(n,1)}(),r.promise()}}(e);return this.settersListeners},e._setupDebounces=function(e){for(var t in e){var r=e[t].delay,n=e[t].fnc;this[t]=s(n,r)}},e._setupThrottles=function(e){for(var t in e){var r=e[t].delay,n=e[t].fnc;this[t]=l(n,r)}},e.get=function(e){return!this[e]||this[e]instanceof Function?null:this[e]},e.set=function(e,t){this[e]=t},t.exports=n},{"core/utils/utils":68}],13:[function(e,t,r){var e=e("services/application"),n=(e=e)&&e.__esModule?e:{default:e};var a={};function o(e){for(var t in e){var r,n=e[t];for(r in n)i18next.addResource(t,"translation",r,n[r])}}t.exports={init:function(e){return e.appLanguages.forEach(function(e){a[e]={plugins:{}}}),i18next.use(i18nextXHRBackend).init({lng:e.language,ns:"app",fallbackLng:"en",resources:e.resources}),new Promise(function(e,t){jqueryI18next.init(i18next,$,{tName:"t",i18nName:"i18n",handleName:"localize",selectorAttr:"data-i18n",targetAttr:"data-i18n-target",optionsAttr:"data-i18n-options",useOptionsAttr:!1,parseDefaultValueFromContent:!0}),o(a),e()})},t:function(e){return i18next.t(e)},tPlugin:function(e){return i18next.t("plugins."+e)},tPrefix:function(t){return function(e){return i18next.t(t+"."+e)}},addI18n:o,addI18nPlugin:function(e){var t,r=e.name,n=e.config;for(t in n){var i=a[t];i&&(i.plugins[r]=n[t])}o(a)},changeLanguage:function(e){i18next.changeLanguage(e)},getAppLanguage:function(){return n.default.getConfig().user.i18n||"en"}}},{"services/application":351}],14:[function(e,t,r){var e=e("services/iframe-plugin"),e=(e=e)&&e.__esModule?e:{default:e};t.exports=e.default},{"services/iframe-plugin":364}],15:[function(e,t,r){var s=a(e("services/data")),n=a(e("store/projects")),i=a(e("services/gui"));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var l=e("core/utils/utils"),u=l.base,c=l.inherit,d=l.createFilterFormField;function p(){u(this),this.ready=!1,this.init=function(){}}c(p,e("core/g3wobject"));var f,h=p.prototype;h.mapService=i.default.getComponent("map").getService(),h.project=n.default.getCurrentProject(),h.layers=void 0,h.getQgsLayerId=function(e){var t=e.qgs_layer_id,e=e.noValue,e=void 0===e?this.layers.map(function(e){return e.id}):e;return t?Array.isArray(t)?t:[t]:e},h.searchFeature=(f=o(regeneratorRuntime.mark(function e(t){var r,n,i,a=t.layer,o=t.feature;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.project.getSearchEndPoint(),n=o.field,i=o.value,e.next=4,s.default.getData("search:features",{inputs:{layer:a,search_endpoint:r,filter:d({layer:a,search_endpoint:r,field:n,value:i})},outputs:!1});case 4:return r=e.sent,n=r.data,i=void 0===n?[]:n,e.abrupt("return",i);case 8:case"end":return e.stop()}},e,this)})),function(e){return f.apply(this,arguments)}),h.findFeaturesWithGeometry=o(regeneratorRuntime.mark(function e(){var t,r,n,i,a,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},s=o.qgs_layer_id,l=void 0===s?[]:s,u=o.feature,s=o.zoom,c=void 0!==s&&s,s=o.highlight,d=void 0!==s&&s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t={found:!1,features:[],qgs_layer_id:null},r=l.length,n=0;case 3:if(!t.found&&n<r){if(i=this.project.getLayerById(l[n]),e.prev=5,e.t0=i,e.t0)return e.next=10,this.searchFeature({layer:i,feature:u});e.next=11}else e.next=20;break;case 10:e.t0=e.sent;case 11:(i=e.t0).length&&(a=i[0].features,t.found=0<a.length&&!!a.find(function(e){return e.getGeometry()}),t.found)?(t.features=a,t.qgs_layer_id=l[n],c&&this.mapService.zoomToFeatures(a,{highlight:d})):n++,e.next=18;break;case 15:e.prev=15,e.t1=e.catch(5),n++;case 18:e.next=3;break;case 20:return t.found||this.mapService.zoomToProjectInitExtent(),e.abrupt("return",t);case 22:case"end":return e.stop()}},e,this,[[5,15]])})),h.setLayers=function(){h.layers=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]},h.getLayers=function(){return h.layers},h.setReady=function(){this.ready=0<arguments.length&&void 0!==arguments[0]&&arguments[0]},h.getReady=function(){return this.ready},h.stop=o(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)})),h.clear=function(){},t.exports=p},{"core/g3wobject":12,"core/utils/utils":68,"services/data":358,"services/gui":361,"store/projects":379}],16:[function(e,t,r){var n=i(e("services/iframe-app")),e=i(e("services/iframe-editing"));function i(e){return e&&e.__esModule?e:{default:e}}t.exports={app:n.default,editing:e.default}},{"services/iframe-app":362,"services/iframe-editing":363}],17:[function(e,t,r){var n=e("store/plugins"),a=(n=n)&&n.__esModule?n:{default:n};function o(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var n=e("core/utils/utils"),i=n.base;function s(){i(this),this.pluginName,this.dependencyApi={},this.init=o(regeneratorRuntime.mark(function e(){var t,r=this,n=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).layers,i=void 0===n?{}:n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.layers=i,a.default.isPluginInConfiguration(this.pluginName)&&((t=a.default.getPlugin(this.pluginName))?(this.setDependencyApi(t.getApi()),this.setReady(!0)):a.default.onafter("registerPlugin",function(){var t=o(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.isReady();case 2:t.getName()===r.pluginName&&(r.setDependencyApi(t.getApi()),r.setReady(!0));case 3:case"end":return e.stop()}},e,r)}));return function(e){return t.apply(this,arguments)}}()));case 2:case"end":return e.stop()}},e,this)})),this.clear=function(){}}(0,n.inherit)(s,e("core/iframe/services/baseservice"));n=s.prototype;n.setDependencyApi=function(){this.dependencyApi=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}},n.getDependecyApi=function(){return this.dependencyApi},t.exports=s},{"core/iframe/services/baseservice":15,"core/utils/utils":68,"store/plugins":378}],18:[function(e,t,r){var n=e("core/utils/utils"),i=n.base,n=n.inherit,a=e("core/layers/baselayers/baselayer"),o=e("g3w-ol/layers/bases");function s(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.config=e,i(this,e,t)}n(s,a),s.prototype._makeOlLayer=function(){var e=this.config,t=e.url,r=e.attributions,e=e.crs,e=this.getProjectionFromCrs(e);return o.TMS.get({url:t,source_type:"arcgismapserver",projection:e,attributions:r})},t.exports=s},{"core/layers/baselayers/baselayer":19,"core/utils/utils":68,"g3w-ol/layers/bases":107}],19:[function(e,t,r){var n=e("core/utils/utils"),i=n.base,n=n.inherit,a=e("g3w-ol/projection/projections"),o=e("core/layers/map/wmslayer");function s(){var e;i(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}),this.isWMS()?(e={url:this.getWmsUrl(),id:this.state.id,tiled:this.state.tiled},this._mapLayer=new o(e),this._mapLayer.addLayer(this)):this._mapLayer=this}n(s,e("core/layers/imagelayer"));n=s.prototype;n.getProjectionFromCrs=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e.epsg=e.epsg||"EPSG:3857",a.get(e)},n._makeOlLayer=function(){},n._registerLoadingEvent=function(){var e=this;this._olLayer.getSource().on("imageloadstart",function(){e.emit("loadstart")}),this._olLayer.getSource().on("imageloadend",function(){e.emit("loadend")})},n.getSource=function(){return this.getOLLayer().getSource()},n.update=function(e,t){this._updateLayer(e,t)},n.getOLLayer=function(){var e=this._olLayer;return e||(e=this._olLayer=this._makeOlLayer(),this._registerLoadingEvent(),this._mapLayer.config.attributions&&this._olLayer.getSource().setAttributions(this._mapLayer.config.attributions),e.setVisible(this._mapLayer.state.visible)),e},n._updateLayer=function(e,t){this.isWMS()&&this._mapLayer.update(e,t)},n.setVisible=function(e){this.getOLLayer().setVisible(e)},n.getMapLayer=function(){return this._mapLayer},t.exports=s},{"core/layers/imagelayer":33,"core/layers/map/wmslayer":45,"core/utils/utils":68,"g3w-ol/projection/projections":111}],20:[function(e,t,r){e={OSM:e("./osmlayer"),Bing:e("./binglayer"),TMS:e("./tmslayer"),ARCGISMAPSERVER:e("./arcgislayer"),WMTS:e("./wmtslayer"),WMS:e("./wmslayer")};t.exports=e},{"./arcgislayer":18,"./binglayer":21,"./osmlayer":22,"./tmslayer":23,"./wmslayer":24,"./wmtslayer":25}],21:[function(e,t,r){var n=e("store/application-state"),i=(n=n)&&n.__esModule?n:{default:n};var n=e("core/utils/utils"),a=n.base,n=n.inherit,o=e("core/layers/baselayers/baselayer"),s=e("g3w-ol/layers/bases");function l(){a(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},1<arguments.length&&void 0!==arguments[1]?arguments[1]:{})}n(l,o),l.prototype._makeOlLayer=function(){var e=void 0,t=i.default.keys.vendorkeys.bing;switch(this.config.source?this.config.source.subtype:null){case"streets":e=s.BING.get({imagerySet:"Road",key:t});break;case"aerial":e=s.BING.get({imagerySet:"Aerial",key:t});break;case"aerialwithlabels":e=s.BING.get({imagerySet:"AerialWithLabels",key:t});break;default:e=s.BING.get({imagerySet:"Aerial",key:t})}return e},t.exports=l},{"core/layers/baselayers/baselayer":19,"core/utils/utils":68,"g3w-ol/layers/bases":107,"store/application-state":373}],22:[function(e,t,r){var n=e("core/utils/utils"),i=n.inherit,a=n.base,n=e("core/layers/baselayers/baselayer"),o=e("g3w-ol/layers/bases");function s(){a(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},1<arguments.length&&void 0!==arguments[1]?arguments[1]:{})}i(s,n),s.prototype._makeOlLayer=function(){return o.OSM.get({id:this.config.name,title:this.config.title,url:this.config.url})},t.exports=s},{"core/layers/baselayers/baselayer":19,"core/utils/utils":68,"g3w-ol/layers/bases":107}],23:[function(e,t,r){var n=e("core/utils/utils"),i=n.base,n=n.inherit,a=e("core/layers/baselayers/baselayer"),o=e("g3w-ol/layers/bases");function s(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.config=e,i(this,e,t)}n(s,a),s.prototype._makeOlLayer=function(){var e=this.config,t=e.url,r=e.attributions,n=e.minZoom,i=e.maxZoom,e=e.crs,e=this.getProjectionFromCrs(e);return o.TMS.get({url:t,minZoom:n,maxZoom:i,attributions:r,projection:e})},t.exports=s},{"core/layers/baselayers/baselayer":19,"core/utils/utils":68,"g3w-ol/layers/bases":107}],24:[function(e,t,r){var n=e("core/utils/utils"),i=n.inherit,a=n.base,n=e("core/layers/baselayers/baselayer"),o=e("g3w-ol/layers/bases");function s(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.config=e,a(this,e,t)}i(s,n),s.prototype._makeOlLayer=function(){var e=this.config,t=e.url,r=e.layers,n=e.singleTile,i=e.attributions,a=e.crs,e=e.opacity,a=this.getProjectionFromCrs(a);return o.WMS.get({url:t,layers:r,singleTile:n,attributions:i,projection:a,opacity:e})},t.exports=s},{"core/layers/baselayers/baselayer":19,"core/utils/utils":68,"g3w-ol/layers/bases":107}],25:[function(e,t,r){var n=e("core/utils/utils"),i=n.base,n=n.inherit,a=e("core/layers/baselayers/baselayer"),l=e("g3w-ol/layers/bases");function o(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.config=e,i(this,e,t)}n(o,a),o.prototype._makeOlLayer=function(){var e=this.config,t=e.url,r=e.layer,n=e.attributions,i=e.matrixSet,a=e.format,o=e.style,s=e.requestEncoding,e=e.crs,e=this.getProjectionFromCrs(e);return l.WMTS.get({url:t,layer:r,attributions:n,format:a,projection:e,requestEncoding:s,matrixSet:i,style:o})},t.exports=o},{"core/layers/baselayers/baselayer":19,"core/utils/utils":68,"g3w-ol/layers/bases":107}],26:[function(e,t,r){var n=e("app/constant"),n=(n=n)&&n.__esModule?n:{default:n};function i(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=(ol.Feature.call(this),this._uid=a(),this._newPrefix="_new_",this._geometry=!1,e.feature),e=e.properties;r&&(e&&Array.isArray(e)?e.forEach(function(e){return t.set(e,r.get(e))}):this.setProperties(r.getProperties()),this.setId(r.getId()),this.setGeometryName(r.getGeometryName()),e=r.getGeometry(),this._geometry=!!e,e&&this.setGeometry(e),e=this.getStyle())&&this.setStyle(e),this.state={new:!1,state:null,visible:!0}}var a=e("core/utils/utils").uniqueId,o=n.default.GEOMETRY_FIELDS,e=(ol.inherits(i,ol.Feature),i.prototype);e.constructor="Feature",e.getUid=function(){return this._uid},e._setUid=function(e){this._uid=e},e.isGeometry=function(){return this._geometry},e.cloneNew=function(){var e=this.clone(),t=a();return e._setUid(t),e.setTemporaryId(),e},e.clone=function(){var e=ol.Feature.prototype.clone.call(this),e=(e.setId(this.getId()),this.isGeometry()&&e.setGeometry(e.getGeometry().clone()),new i({feature:e})),t=this.getUid();return e._setUid(t),e.setState(this.getState()),this.isNew()&&e.setNew(),e},e.setTemporaryId=function(){var e=""+this._newPrefix+a();this.setId(e),this.setNew()},e.setNew=function(){this.state.new=!0},e.delete=function(){return this.state.state="delete",this},e.update=function(){return this.state.state="update",this},e.add=function(){return this.state.state="add",this},e.isNew=function(){return this.state.new},e.isAdded=function(){return"add"===this.state.state},e.isUpdated=function(){return"update"===this.state.state},e.isDeleted=function(){return"delete"===this.state.state},e.setFullState=function(e){this.state=e},e.getFullState=function(){return this.state},e.setState=function(e){this.state.state=e},e.getState=function(){return this.state.state},e.getAlphanumericProperties=function(){var e,t=this.getProperties(),r={};for(e in t)-1===o.indexOf(e)&&(r[e]=t[e]);return r},e.clearState=function(){this.state.state=null,this.state.new=!1},e.isVisible=function(){return this.state.visible},e.setVisible=function(){this.state.visible=!(0<arguments.length&&void 0!==arguments[0])||arguments[0]},t.exports=i},{"app/constant":4,"core/utils/utils":68}],27:[function(e,t,r){function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var i=e("core/utils/utils"),a=i.base;function o(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._features=e.features||[],this._provider=e.provider||null,this._loadedIds=[],this._lockIds=[],this.hasFeatureLockByOtherUser=!1,this.setters={addFeatures:function(e){var t=this;e.forEach(function(e){t._addFeature(e)})},addFeature:function(e){this._addFeature(e)},removeFeature:function(e){this._removeFeature(e)},updateFeature:function(e){this._updateFeature(e)},clear:function(){this._clearFeatures()},getFeatures:function(){return this._getFeatures(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},commit:function(e,t){return this._commit(e,t)},featuresLockedByOtherUser:function(){this.hasFeatureLockByOtherUser=!0}},a(this)}(0,i.inherit)(o,e("core/g3wobject"));i=o.prototype;i.clone=function(){return _.cloneDeep(this)},i.setProvider=function(e){this._provider=e},i.getProvider=function(){return this._provider},i.unlock=function(){var t=this,r=$.Deferred();return this._provider.unlock().then(function(e){t.hasFeatureLockByOtherUser=!1,r.resolve(e)}).fail(function(e){return r.reject(e)}),r.promise()},i._getFeatures=function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred();return this._provider?this._provider.getFeatures(e).then(function(e){e=t._filterFeaturesResponse(e);t.addFeatures(e),r.resolve(e)}).fail(function(e){return r.reject(e)}):r.resolve(this._readFeatures()),r.promise()},i._filterFeaturesResponse=function(){var r=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.features,t=void 0===t?[]:t,n=e.featurelocks,n=void 0===n?[]:n,e=e.count,i=t.filter(function(e){var e=e.getId(),t=-1!==r._loadedIds.indexOf(e);return t||r._loadedIds.push(e),!t});return this._filterLockIds(n),t.length<e&&!this.hasFeatureLockByOtherUser&&this.featuresLockedByOtherUser(),i},i._filterLockIds=function(e){var t=this._lockIds.map(function(e){return e.featureid}),e=e.filter(function(e){return-1===t.indexOf(e.featureid)});this._lockIds=[].concat(n(this._lockIds),n(e))},i.addLoadedIds=function(e){this._loadedIds.push(e)},i.getLockIds=function(){return this._lockIds},i.addLockIds=function(e){var t=this;this._lockIds=_.union(this._lockIds,e),this._lockIds.forEach(function(e){return t._loadedIds.push(e.featureid)})},i._readFeatures=function(){return this._features},i._commit=function(e){var t=$.Deferred();return e&&this._provider?(e.lockids=this._lockIds,this._provider.commit(e).then(function(e){return t.resolve(e)}).fail(function(e){return t.reject(e)})):t.reject(),t.promise()},i.getFeatureById=function(t){return this._features.find(function(e){return e.getId()==t})},i.getFeatureByUid=function(t){return this._features.find(function(e){return e.getUid()===t})},i._addFeature=function(e){this._features.push(e)},i._updateFeature=function(r){var n=this;this._features.find(function(e,t){if(e.getUid()===r.getUid())return n._features[t]=r,!0})},i.setFeatures=function(e){this._features=e},i._removeFeature=function(t){this._features=this._features.filter(function(e){return t.getUid()!==e.getUid()})},i._clearFeatures=function(){this._features=null,this._features=[],this._lockIds=[],this._loadedIds=[]},i.getDataProvider=function(){return this._provider},i.readFeatures=function(){return this._features},t.exports=o},{"core/g3wobject":12,"core/utils/utils":68}],28:[function(e,t,r){var n=e("core/utils/utils"),i=n.inherit,a=n.base;function o(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this._features=e.features||new ol.Collection([])}i(o,e("core/layers/features/featuresstore"));n=o.prototype;n.getLength=function(){return this._features.getLength()},n.setFeatures=function(){var t=this;(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(e){return t._features.push(e)})},n.readFeatures=function(){return this._features.getArray()},n.getFeaturesCollection=function(){return this._features},n.getFeatureById=function(t){return this._features.getArray().find(function(e){return e.getId()==t})},n.getFeatureByUid=function(t){return this._features.getArray().find(function(e){return e.getUid()===t})},n._addFeature=function(e){this._features.push(e),this._features.dispatchEvent("change")},n._updateFeature=function(e){for(var t=-1,r=this._features.getArray(),n=0;r.length;n++)if(r[n].getUid()===e.getUid()){t=n;break}0<=t&&(this._features.removeAt(t),this._features.insertAt(t,e),this._features.dispatchEvent("change"))},n._removeFeature=function(e){for(var t=this._features.getArray(),r=0;r<t.length;r++){var n=t[r];if(e.getUid()===n.getUid()){this._features.removeAt(r);break}}this._features.dispatchEvent("change")},n._clearFeatures=function(){try{this._features.clear()}catch(e){}this._features=null,this._features=new ol.Collection([])},t.exports=o},{"core/layers/features/featuresstore":27,"core/utils/utils":68}],29:[function(e,t,r){var d=e("app/constant");function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=(this._layerName=e.layerName,e.filter);this._expression=e||""}e=n.prototype;e.and=function(e,t){return this._expression=this._expression&&this._expression+" AND ",e&&t&&this.eq(e,t),this},e.or=function(){return field&&value&&(this._expression=this._expression&&this._expression+" OR ",this.eq(field,value)),this},e.eq=function(e,t){return this._expression=this._expression+this._build("eq",e,t),this},e.like=function(e,t){return this._expression=this._expression+this._build("LIKE",e,t),this},e.ilike=function(e,t){return this._expression=this._expression+this._build("ILIKE",e,t),this},e.not=function(e,t){return this._expression=this._expression+this._build("NOT",e,t),this},e.gt=function(e,t){return this._expression=this._expression+this._build("gt",e,t),this},e.gte=function(e,t){return this._expression=this._expression+this._build("gte",e,t),this},e.lt=function(e,t){return this._expression=this._expression+this._build("lt",e,t),this},e.lte=function(e,t){return this._expression=this._expression+this._build("lte",e,t),this},e.clear=function(){return this._expression="",this},e.get=function(){return this._layerName?this._layerName+": "+this._expression:this._expression},e._build=function(e,t,r){return['"'+t+'"',d.FILTER_EXPRESSION_OPERATORS[e],""+r].join(" ")},e.createSingleExpressionElement=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.value,r=e.attribute,n=e.operator,e=e.logicop,i=void 0,a="LIKE"===n||"ILIKE"===n?"%":"",o=d.FILTER_EXPRESSION_OPERATORS[n],e=e&&" "+e+" "||"";if("IN"===n)i='"'+r+'" '+o+" "+("( "+(Array.isArray(t)?t:[t]).map(function(e){return"'"+e+"'"}).join(",").replace(/,/g," , ")+" )")+e;else if(null!=t&&!Number.isNaN(t)&&t.toString().trim()){var s=Array.isArray(t)?t:"number"!=typeof t?t.split("'"):[];if(1<s.length){for(var l=[],u=0;u<s.length;u++){var c=s[u];c&&(c=("%"+c+"%").trim(),l.push('"'+r+"\" ILIKE '"+c+"'"))}i=""+l.join(" AND ")+e}else i='"'+r+'" '+o+" '"+a+t+a+"'"+e}return i},e.createExpressionFromFilterObject=function(){var e,o=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},s=[],r=void 0;for(e in t){r=d.FILTER_EXPRESSION_OPERATORS[e];t[e].forEach(function(e){for(var t in e){var r=e[t];if(Array.isArray(r))o.createExpressionFromFilterObject(e);else{var n,i=e[t];for(n in i){var a=i[n],a=o.createSingleExpressionElement({value:a,operator:t,attribute:n});s.push(a)}}}}),r=0<s.length&&s.join(" "+r+" ")}return r},e.createExpressionFromField=function(e){var t=e.layerName,r=e.field,n=e.value,e=e.operator,r=this.createSingleExpressionElement({attribute:r,value:n,operator:void 0===e?"eq":e});return this._expression=t+":"+r,this},e.createExpressionFromFilterArray=function(){var n=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],i="",a=e.length&&e.length-1;return e.forEach(function(e,t){var r=n.createSingleExpressionElement(e);i=""+i+(e.logicop&&t===a?r.substring(0,r.length-(e.logicop.length+1)):r)}),i||void 0},e.createExpressionFromFilter=function(e,t){e=Array.isArray(e)?this.createExpressionFromFilterArray(e):this.createExpressionFromFilterObject(e);return e&&(this._expression=t+":"+e),this},t.exports=n},{"app/constant":4}],30:[function(e,t,r){var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._filter=null,this._type=null,this.config=e}var a=i.prototype;a.getConfig=function(){return this.config},a.setConfig=function(){this.config=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}},a.mergeConfig=function(){this.config=n({},this.config,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},a.getAll=function(){this._type=i.TYPES.all,this._filter=null},a.setExpression=function(e){this._type=i.TYPES.expression,this._filter=e},a.setGeometry=function(e){return this._type=i.TYPES.geometry,this._filter=e,this},a.setBBOX=function(e){return this._type=i.TYPES.bbox,this._filter=e,this},a.setFids=function(e){return this._type=i.TYPES.fids,this._filter=e,this},a.serialize=function(){return JSON.stringify(this)},a.get=function(){return this._filter},a.getType=function(){return this._type},a.clear=function(){this._filter=null},i.TYPES={bbox:"bbox",geometry:"geometry",expression:"expression",fids:"fids",all:"all"},t.exports=i},{}],31:[function(e,t,r){var n=e("core/utils/utils"),i=n.base,n=n.inherit,a=e("core/layers/vectorlayer"),o=e("core/layers/map/geojson");function s(e,t){i(this,e,t),this.config.style=e.style,this.setup(e)}n(s,a),s.prototype.getMapLayer=function(){var e,t,r,n,i;return this._mapLayer||(i=this.get("source").url,e=this.getName(),t=this.getId(),r=this.get("style"),n=this.getProvider("data"),i={url:i,projection:this.getProjection().getCode(),id:t,name:e,style:r,provider:n},this._mapLayer=new o(i)),this._mapLayer},t.exports=s},{"core/layers/map/geojson":42,"core/layers/vectorlayer":57,"core/utils/utils":68}],32:[function(e,t,r){var i=a(e("services/gui")),n=a(e("services/application"));function a(e){return e&&e.__esModule?e:{default:e}}var o=e("g3w-ol/projection/projections"),s=e("core/utils/ol").getScaleFromResolution,l=e("core/utils/geo").createFeatureFromFeatureObject,e=e("core/utils/utils"),u=e.XHR,c=e.sanitizeUrl,d={wms:["VERSION","REQUEST","BBOX","LAYERS","WIDTH","HEIGHT","DPI","FORMAT","CRS"]};function p(){}e=p.prototype;e.setup=function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.config&&(e=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).project,this.config.map_crs=e.getProjection().getCode(),this.config.multilayerid=t.multilayer,this.legendCategories={},this.olSelectionFeatures={},_.extend(this.state,{geolayer:"NoGeometry"!==t.geometrytype,legend:{url:null,loading:!1,error:!1,show:!0,change:!1},external:t.source&&t.source.external||!1,bbox:t.bbox||null,visible:t.visible||!1,checked:t.visible||!1,epsg:t.crs.epsg,hidden:t.hidden||!1,scalebasedvisibility:t.scalebasedvisibility||!1,minscale:t.minscale,maxscale:t.maxscale,ows_method:t.ows_method,exclude_from_legend:"boolean"!=typeof t.exclude_from_legend||t.exclude_from_legend,categories:!1,expanded:t.expanded,opacity:t.opacity||100}),t.projection&&(this.config.projection=t.projection.getCode()===t.crs.epsg?t.projection:o.get(t.crs)),t.attributions&&(this.config.attributions=t.attributions),t.source)&&t.source.url&&this._sanitizeSourceUrl()},e.getLegendGraphic=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).all,e=void 0===e||e,t=n.default.getConfig().layout?n.default.getConfig().layout.legend:{},t=this.getLegendUrl(t,{categories:!0,all:e,format:"application/json"});return u.get({url:t})},e.setCategories=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];this.legendCategories[this.getCurrentStyle().name]=e,this.state.categories=0<e.length&&0<e.filter(function(e){return e.ruleKey}).length},e.getCategories=function(){return this.legendCategories[this.getCurrentStyle().name]},e.clearCategories=function(){this.legendCategories={},this.state.categories=!1},e.clearOlSelectionFeatures=function(){this.olSelectionFeatures=null},e.getOlSelectionFeature=function(e){return this.olSelectionFeatures[e]},e.updateOlSelectionFeature=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,e=e.feature,t=this.getOlSelectionFeature(t);t&&(t.feature=e,i.default.getService("map").setSelectionFeatures("update",{feature:e}))},e.deleteOlSelectionFeature=function(e){var t=this.olSelectionFeatures[e];t&&(mapService.setSelectionFeatures("remove",{feature:t.feature}),delete this.olSelectionFeatures[e])},e.getOlSelectionFeatures=function(){return this.olSelectionFeatures},e.addOlSelectionFeature=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,e=e.feature;return this.olSelectionFeatures[t]=this.olSelectionFeatures[t]||{feature:l({id:t,feature:e}),added:!1},this.olSelectionFeatures[t]},e.showAllOlSelectionFeatures=function(){var t=i.default.getService("map");Object.values(this.olSelectionFeatures).forEach(function(e){e.added||t.setSelectionFeatures("add",{feature:e.feature}),e.added=!0})},e.setInversionOlSelectionFeatures=function(){var t=i.default.getComponent("map").getService();Object.values(this.olSelectionFeatures).forEach(function(e){t.setSelectionFeatures(e.added?"remove":"add",{feature:e.feature}),e.added=!e.added})},e.setOlSelectionFeatureByFid=function(e,t){var r=this.olSelectionFeatures[e]&&this.olSelectionFeatures[e].feature;return r&&this.setOlSelectionFeatures({id:e,feature:r},t)},e.setOlSelectionFeatures=function(e){var t,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"add",n=i.default.getComponent("map").getService();return e?(t=this.olSelectionFeatures[e.id]||this.addOlSelectionFeature(e),"add"===r?t.added||(t.feature.__layerId=this.getId(),n.setSelectionFeatures(r,{feature:t.feature}),t.added=!0):(n.setSelectionFeatures(r,{feature:t.feature}),t.added=!1)):Object.values(this.olSelectionFeatures).forEach(function(e){e.added&&n.setSelectionFeatures("remove",{feature:e.feature}),e.added=!1}),!Object.values(this.olSelectionFeatures).find(function(e){return e.added})},e._sanitizeSourceUrl=function(){var e=c({url:this.config.source.url,reserverParameters:d[0<arguments.length&&void 0!==arguments[0]?arguments[0]:"wms"]});this.config.source.url=e},e.isLayerCheckedAndAllParents=function(){var e=this.isChecked();if(e)for(var t=this.state.parentGroup;e&&t;)e=e&&t.checked,t=t.parentGroup;return e},e.setChecked=function(e){this.state.checked=e},e.isChecked=function(){return this.state.checked},e.setVisible=function(e){var t=this.state.visible;return this.state.visible=e&&this.isChecked(),t!==this.state.visible&&this.change(),this.state.visible},e.isVisible=function(){return this.state.visible},e.isDisabled=function(){return this.state.disabled},e.isPrintable=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).scale;return this.isLayerCheckedAndAllParents()&&(!this.state.scalebasedvisibility||e>=this.state.maxscale&&e<=this.state.minscale)},e.getStyles=function(){return(this.config.source.external?this.config.source:this.config).styles},e.getStyle=function(){return this.config.source.external?this.config.source.styles:this.config.styles?this.config.styles.find(function(e){return e.current}).name:""},e.getOpacity=function(){return this.state.opacity},e.setCurrentStyle=function(t){var r=!1;return this.config.styles.forEach(function(e){e.name===t&&(r=!e.current),e.current=e.name===t}),r},e.getCurrentStyle=function(){return this.config.styles.find(function(e){return e.current})},e.setDisabled=function(e){if(this.state.scalebasedvisibility){for(var t=s(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:"m"),r=(this.state.disabled=!(t>=this.state.maxscale&&t<=this.state.minscale),this.state.disabled=0===this.state.minscale?!(t>=this.state.maxscale):this.state.disabled,!0),n=this.state.parentGroup;n;)r=r&&n.checked,n=n.parentGroup;r&&this.setVisible(!this.state.disabled),this.isFilterable()&&this.setTocHighlightable(!this.state.disabled)}else this.state.disabled=!1},e.getMultiLayerId=function(){return this.config.multilayerid},e.getGeometryType=function(){return this.config.geometrytype},e.getOwsMethod=function(){return this.config.ows_method},e.setProjection=function(){this.config.projection=o.get(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},e.getProjection=function(){return this.config.projection},e.getEpsg=function(){return this.config.crs.epsg},e.getCrs=function(){return this.config.projection&&this.config.projection.getCode()||null},e.getMapCrs=function(){return this.config.map_crs},e.isCached=function(){return this.config.cache_url&&""!==this.config.cache_url},e.getCacheUrl=function(){if(this.isCached())return this.config.cache_url},e.hasAxisInverted=function(){var e=this.getProjection();return"ne"===(e.getAxisOrientation?e.getAxisOrientation():"enu").substr(0,2)},e.getMapLayer=function(){},e.setMapProjection=function(e){this._mapProjection=e},e.getMapProjection=function(){return this._mapProjection},t.exports=p},{"core/utils/geo":64,"core/utils/ol":66,"core/utils/utils":68,"g3w-ol/projection/projections":111,"services/application":351,"services/gui":361}],33:[function(e,t,r){var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=a(e("store/projects")),i=a(e("services/application"));function a(e){return e&&e.__esModule?e:{default:e}}var o=e("core/utils/utils"),s=o.base,u=o.inherit,o=o.mixin,c=e("core/layers/layer"),d=e("core/layers/vectorlayer"),p=e("core/layers/map/wmslayer"),f=e("core/layers/map/wmstlayer"),h=e("core/layers/map/arcgismapserverlayer"),g=e("core/layers/map/xyzlayer"),v=e("core/layers/legend/legendservice"),e=e("core/layers/geolayermixin");function m(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.setters={change:function(){}},s(this,e,t),this.config.baselayer=e.baselayer||!1,this.type=c.LayerTypes.IMAGE,this.legendUrl=null,this.customParams={},this.setup(e,t)}u(m,c),o(m,e);var y,u=m.prototype;u.getLayerForEditing=(y=regeneratorRuntime.mark(function e(){var t,r,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=n.force,a=void 0!==i&&i,o=n.vectorurl,s=n.project_type;n.project;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isEditable()||a)return t=t||l.default.getCurrentProject(),r=new d(this.config,{vectorurl:o,project_type:s,project:t}),e.prev=3,e.next=6,r.layerForEditing;e.next=16;break;case 6:return r=e.sent,this.setEditingLayer(r),e.abrupt("return",r);case 11:return e.prev=11,e.t0=e.catch(3),e.abrupt("return",Promise.reject(e.t0));case 14:e.next=17;break;case 16:return e.abrupt("return",null);case 17:case"end":return e.stop()}},e,this,[[3,11]])}),function(){var s=y.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}),u.isBaseLayer=function(){return this.config.baselayer},u.isWMS=function(){return-1<m.WMSServerTypes.indexOf(this.config.servertype)},u.isLayerProjectionASMapProjection=function(){return this.config.crs.epsg===this.config.map_crs},u.getCrs=function(){return this.config.crs.epsg},u.isExternalWMS=function(){return!!(this.config.source&&this.config.source.external&&this.config.source.url)},u.isArcgisMapserver=function(){return this.isExternalWMS()&&this.config.source.type===c.SourceTypes.ARCGISMAPSERVER},u._getBaseLayerName=function(){return this.isWmsUseLayerIds()?this.getId():this.getName()},u.getWMSLayerName=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).type,e=void 0===e?"map":e,t="map"!==e||this.isExternalWMS()&&this.isLayerProjectionASMapProjection(),r=this._getBaseLayerName();return r=t&&this.config.source&&("legend"===e||this.config.source.external)&&(this.config.source.layers||this.config.source.layer)?this.config.source.layers||this.config.source.layer:r},u.getWmsUrl=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).type,e=void 0===e?"map":e;return("map"!==e||this.isExternalWMS()&&this.isLayerProjectionASMapProjection())&&this.config.source&&("legend"===e||this.config.source.external)&&("wms"===this.config.source.type||"wmst"===this.config.source.type)&&this.config.source.url?this.config.source.url:this.config.wmsUrl},u.getWFSLayerName=function(){return this.getQueryLayerName().replace(/[/\s]/g,"_")},u.useProxy=function(){return this.isExternalWMS()&&this.isLayerProjectionASMapProjection()&&this.getInfoFormats()},u.getWMSInfoLayerName=function(){return this.isExternalWMS()&&this.isLayerProjectionASMapProjection()&&this.getInfoFormats()?this.getSource().layers:this._getBaseLayerName()},u.getPrintLayerName=function(){return this.isWmsUseLayerIds()?this.getId():this.getName()},u.getStringBBox=function(){var e=this.config.bbox;return e.minx+","+e.miny+","+e.maxx+","+e.maxy},u.isWfsActive=function(){return Array.isArray(this.config.ows)&&void 0!==this.config.ows.find(function(e){return"WFS"===e})},u.getFullWmsUrl=function(){var e=l.default.getCurrentProject().getState().metadata.wms_url;return this.isExternalWMS()||!e?this.getWmsUrl():e},u.getCatalogWmsUrl=function(){var e=l.default.getCurrentProject().getMetadata().wms_url;return this.isExternalWMS()||!e?this.getWmsUrl()+"?service=WMS&version=1.3.0&request=GetCapabilities":e},u.getCatalogWfsUrl=function(){return this.getWfsUrl()+"?service=WFS&version=1.1.0&request=GetCapabilities"},u.getWfsUrl=function(){return l.default.getCurrentProject().getMetadata().wms_url||this.config.wmsUrl},u.getQueryUrl=function(){var e=s(this,"getQueryUrl");return e=this.getServerType()===c.ServerTypes.QGIS&&this.isExternalWMS()&&this.isLayerProjectionASMapProjection()?this.getInfoFormats()?this.getSource().url:e+"SOURCE="+this.config.source.type:e},u.getIconUrlFromLegend=function(){return this.getLegendUrl({layertitle:!1})},u.getLegendUrl=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return this.legendUrl=v.get({layer:this,params:n({},e,this.customParams),options:t}),this.legendUrl},u.setMapParamstoLegendUrl=function(e){var t=e.bbox,e=e.crs;this.customParams=n({},this.customParams,{bbox:t,crs:e})},u.getWfsCapabilities=function(){return this.config.wfscapabilities||1===this.config.capabilities},u.getMapLayer=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],r=i.default.isIframe()&&!this.isExternalWMS(),r=(e.iframe_internal=r,this.isExternalWMS()?"GET":this.getOwsMethod());return this.isCached()?(e.extent=this.config.bbox?[this.config.bbox.minx,this.config.bbox.miny,this.config.bbox.maxx,this.config.bbox.maxy]:null,new g(e,r)):this.isExternalWMS()&&this.config.source&&this.config.source.type===c.SourceTypes.ARCGISMAPSERVER?(e=n({},e,this.config.source),new h(e,t)):(e.url=e.url||this.getWmsUrl(),new(this.isExternalWMS()&&this.config.source&&this.config.source.type===c.SourceTypes.WMST?f:p)(e,t,r))},m.WMSServerTypes=[c.ServerTypes.QGIS,c.ServerTypes.Mapserver,c.ServerTypes.Geoserver,c.ServerTypes.OGC],t.exports=m},{"core/layers/geolayermixin":32,"core/layers/layer":34,"core/layers/legend/legendservice":39,"core/layers/map/arcgismapserverlayer":41,"core/layers/map/wmslayer":45,"core/layers/map/wmstlayer":46,"core/layers/map/xyzlayer":47,"core/layers/vectorlayer":57,"core/utils/utils":68,"services/application":351,"store/projects":379}],34:[function(e,t,r){var d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p=s(e("store/application-state")),n=e("app/constant"),a=s(e("services/data")),o=s(e("store/projects")),i=s(e("services/application"));function s(e){return e&&e.__esModule?e:{default:e}}function l(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var u=e("core/i18n/i18n.service").t,c=e("core/utils/utils"),f=c.inherit,h=c.base,g=c.XHR,c=e("core/g3wobject"),v=e("core/utils/geo"),m=v.geometryFields,y=v.parseAttributes,_=e("core/relations/relations"),b=e("core/layers/providers/providersfactory");function w(){var e,t,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=((this.config=r).id=r.id||"Layer",r.title=r.title||r.name,r.download=!!r.download,r.geolayer=!1,r.baselayer=!!r.baselayer,r.fields=r.fields||{},r.urls=d({query:r.infourl&&""!==r.infourl?r.infourl:r.wmsUrl},r.urls||{}),n.project),n=void 0===n?o.default.getCurrentProject():n,i=(this.config.search_endpoint=n.getSearchEndPoint(),this._relations=this._createRelations(n.getRelations()),this.isBaseLayer()||(t=n.getType()+"/"+n.getId()+"/"+r.id+"/",e=n.getVectorUrl(),i=n.getRasterUrl(),this.config.urls.filtertoken=e+"filtertoken/"+t,this.config.urls.data=e+"data/"+t,this.config.urls.shp=e+"shp/"+t,this.config.urls.csv=e+"csv/"+t,this.config.urls.xls=e+"xls/"+t,this.config.urls.gpx=e+"gpx/"+t,this.config.urls.gpkg=e+"gpkg/"+t,this.config.urls.geotiff=i+"geotiff/"+t,this.config.urls.editing=e+"editing/"+t,this.config.urls.commit=e+"commit/"+t,this.config.urls.config=e+"config/"+t,this.config.urls.unlock=e+"unlock/"+t,this.config.urls.widget={unique:e+"widget/unique/data/"+t},this.config.urls.featurecount=n.getUrl("featurecount"),this.config.searchParams={I:0,J:0}),r.styles&&r.styles.find(function(e){return e.current}).name),i=(this.state={id:r.id,title:r.title,selected:r.selected||!1,disabled:r.disabled||!1,metadata:r.metadata,metadata_querable:!this.isBaseLayer()&&this.isQueryable({onMap:!1}),openattributetable:!this.isBaseLayer()&&this.canShowTable(),removable:r.removable||!1,downloadable:this.isDownloadable(),source:r.source,styles:r.styles,defaultstyle:i,inediting:!1,infoformat:this.getInfoFormat(),infoformats:this.config.infoformats||[],projectLayer:!0,geolayer:!1,selection:{active:!1},filter:{active:!1},attributetable:{pageLength:null},visible:r.visible||!1,tochighlightable:!1,featurecount:r.featurecount,stylesfeaturecount:r.featurecount&&i&&(e={},t=i,n=r.featurecount,t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e)},this.selectionFids=new Set,this._layersstore=r.layersstore||null,this.config.servertype),n=this.config.source?this.config.source.type:null;i&&n&&(this.providers={query:b.build("query",i,n,{layer:this}),filter:b.build("filter",i,n,{layer:this}),filtertoken:b.build("filtertoken",i,n,{layer:this}),search:b.build("search",i,n,{layer:this}),data:b.build("data",i,n,{layer:this})}),this.proxyData={wms:null},h(this)}f(w,c);var x,S,L,C,v=w.prototype;v.getProxyData=function(e){return e?this.proxyData[e]:this.proxyData},v.setProxyData=function(e){this.proxyData[e]=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}},v.clearProxyData=function(e){this.proxyData[e]=null},v.getDataProxyFromServer=l(regeneratorRuntime.mark(function e(){var t,r,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"wms",i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.default.getData("proxy:"+n,{inputs:i,outputs:!1});case 3:return r=e.sent,t=r.response,r=r.data,this.setProxyData(n,JSON.parse(r)),e.abrupt("return",t);case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return");case 13:case"end":return e.stop()}},e,this,[[0,10]])})),v.changeProxyDataAndReloadFromServer=function(){var r=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"wms",i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(i).forEach(function(t){Object.keys(i[t]).forEach(function(e){r.proxyData[n][t][e]=i[t][e]})}),this.getDataProxyFromServer(n,this.proxyData[n])},v.isInEditing=function(){return this.state.inediting},v.setInEditing=function(){this.state.inediting=0<arguments.length&&void 0!==arguments[0]&&arguments[0]},v.getSearchParams=function(){return this.config.searchParams},v.getSearchEndPoint=function(){return this.getType()!==w.LayerTypes.TABLE?this.config.search_endpoint:"api"},v._createRelations=function(e){var t=this.getId();return new _({relations:e.filter(function(e){return-1!==[e.referencedLayer,e.referencingLayer].indexOf(t)})})},v.getRelations=function(){return this._relations},v.getRelationById=function(t){return this._relations.getArray().find(function(e){return e.getId()===t})},v.getRelationAttributes=function(t){var e=this._relations.find(function(e){return e.name===t});return e?e.fields:[]},v.getRelationsAttributes=function(){var t={};return this.state.relations.forEach(function(e){return t[e.name]=e.fields}),t},v.isChild=function(){return!!this.getRelations()&&this._relations.isChild(this.getId())},v.isFather=function(){return!!this.getRelations()&&this._relations.isFather(this.getId())},v.getChildren=function(){return this.isFather()?this._relations.getChildren(this.getId()):[]},v.getFathers=function(){return this.isChild()?this._relations.getFathers(this.getId()):[]},v.hasChildren=function(){return!!this.hasRelations()&&this._relations.hasChildren(this.getId())},v.hasFathers=function(){return!!this.hasRelations()&&this._relations.hasFathers(this.getId())},v.hasRelations=function(){return!!this._relations},v.setAttributeTablePageLength=function(e){this.state.attributetable.pageLength=e},v.getAttributeTablePageLength=function(){return this.state.attributetable.pageLength},v.setFilter=function(){this.state.filter.active=0<arguments.length&&void 0!==arguments[0]&&arguments[0]},v.getFilterActive=function(){return this.state.filter.active},v.toggleFilterToken=l(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.filter.active=!this.state.filter.active,e.next=3,this.activeFilterToken(this.state.filter.active);case 3:return e.abrupt("return",this.state.filter.active);case 4:case"end":return e.stop()}},e,this)})),v.activeFilterToken=(x=l(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:e.sent?(this.createFilterToken(),e.next=7):e.next=6;break;case 6:this.deleteFilterToken();case 7:case"end":return e.stop()}},e,this)})),function(e){return x.apply(this,arguments)}),v.deleteFilterToken=l(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.providers.filtertoken){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.providers.filtertoken.deleteFilterToken();case 5:i.default.setFilterToken(null),this.emit("filtertokenchange",{layerId:this.getId()}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0);case 12:case"end":return e.stop()}},e,this,[[0,9]])})),v.createFilterToken=l(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=null,e.prev=1,!this.providers.filtertoken||0<!this.selectionFids.size)return e.abrupt("return");e.next=4;break;case 4:if(this.selectionFids.has(w.SELECTION_STATE.ALL))return e.next=7,this.providers.filtertoken.deleteFilterToken();e.next=9;break;case 7:e.next=14;break;case 9:return r={},this.selectionFids.has(w.SELECTION_STATE.EXCLUDE)?r.fidsout=Array.from(this.selectionFids).filter(function(e){return e!==w.SELECTION_STATE.EXCLUDE}).join(","):r.fidsin=Array.from(this.selectionFids).join(","),e.next=13,this.providers.filtertoken.getFilterToken(r);case 13:t=e.sent;case 14:i.default.setFilterToken(t),this.emit("filtertokenchange",{layerId:this.getId()}),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(1);case 21:case"end":return e.stop()}},e,this,[[1,18]])})),v.setSelectionFidsAll=function(){this.selectionFids.clear(),this.selectionFids.add(w.SELECTION_STATE.ALL),this.isGeoLayer()&&this.showAllOlSelectionFeatures(),this.setSelection(!0),this.state.filter.active&&this.createFilterToken()},v.getSelectionFids=function(){return this.selectionFids},v.invertSelectionFids=function(){this.selectionFids.has(w.SELECTION_STATE.EXCLUDE)?this.selectionFids.delete(w.SELECTION_STATE.EXCLUDE):this.selectionFids.has(w.SELECTION_STATE.ALL)?this.selectionFids.delete(w.SELECTION_STATE.ALL):0<this.selectionFids.size&&this.selectionFids.add(w.SELECTION_STATE.EXCLUDE),this.isGeoLayer()&&this.setInversionOlSelectionFeatures(),this.state.filter.active&&this.createFilterToken(),this.setSelection(0<this.selectionFids.size)},v.hasSelectionFid=function(e){return!!this.selectionFids.has(w.SELECTION_STATE.ALL)||(this.selectionFids.has(w.SELECTION_STATE.EXCLUDE)?!this.selectionFids.has(e):this.selectionFids.has(e))},v.includeSelectionFid=(S=l(regeneratorRuntime.mark(function e(t){var r,n=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=this.selectionFids.has(w.SELECTION_STATE.EXCLUDE)&&this.selectionFids.has(t))&&this.selectionFids.delete(t),r&&1===this.selectionFids.size&&this.setSelectionFidsAll(),r||this.selectionFids.add(t),r||this.isSelectionActive()||this.setSelection(!0),this.isGeoLayer()&&this.setOlSelectionFeatureByFid(t,"add"),n&&this.state.filter.active)return e.next=9,this.createFilterToken();e.next=9;break;case 9:case"end":return e.stop()}},e,this)})),function(e){return S.apply(this,arguments)}),v.includeSelectionFids=function(){var t=this;(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(e){return t.includeSelectionFid(e)})},v.excludeSelectionFid=(L=l(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.selectionFids.has(w.SELECTION_STATE.ALL)&&0!==this.selectionFids.size||(this.selectionFids.clear(),this.selectionFids.add(w.SELECTION_STATE.EXCLUDE)),this.selectionFids[this.selectionFids.has(w.SELECTION_STATE.EXCLUDE)?"add":"delete"](t),1===this.selectionFids.size&&this.selectionFids.has(w.SELECTION_STATE.EXCLUDE)&&this.setselectionFidsAll(),r=this.isGeoLayer()&&this.setOlSelectionFeatureByFid(t,"remove"),e.t0=this.state.filter.active,e.t0)return e.next=8,this.createFilterToken();e.next=8;break;case 8:0!==this.selectionFids.size&&!r||(this.selectionFids.clear(),this.setSelection(!1));case 9:case"end":return e.stop()}},e,this)})),function(e){return L.apply(this,arguments)}),v.excludeSelectionFids=function(){var t=this;(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(e){return t.excludeSelectionFid(e)})},v.clearSelectionFids=function(){this.selectionFids.clear(),this.isGeoLayer()&&this.setOlSelectionFeatures(),this.setSelection(!1)},v.getWMSLayerName=function(){return this.isWmsUseLayerIds()?this.getId():this.getName()},v.isWmsUseLayerIds=function(){return this.config.wms_use_layer_ids},v.getFilterToken=function(){return i.default.getFilterToken()},v.getDownloadFilefromDownloadDataType=function(e,t){var r=t.data,n=void 0===r?{}:r,i=t.options;switch(n.filtertoken=this.getFilterToken(),e){case"shapefile":return this.getShp({data:n,options:i});case"xls":return this.getXls({data:n,options:i});case"csv":return this.getCsv({data:n,options:i});case"gpx":return this.getGpx({data:n,options:i});case"gpkg":return this.getGpkg({data:n,options:i});case"geotiff":return this.getGeoTIFF({data:n,options:i})}},v.getGeoTIFF=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).data,e=void 0===e?{}:e;return e.filtertoken=this.getFilterToken(),g.fileDownload({url:this.getUrl("geotiff"),data:e,httpMethod:"POST"})},v.getXls=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).data,e=void 0===e?{}:e;return e.filtertoken=this.getFilterToken(),g.fileDownload({url:this.getUrl("xls"),data:e,httpMethod:"POST"})},v.getShp=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).data,e=void 0===e?{}:e;return e.filtertoken=this.getFilterToken(),g.fileDownload({url:this.getUrl("shp"),data:e,httpMethod:"POST"})},v.getGpx=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).data,e=void 0===e?{}:e;return e.filtertoken=this.getFilterToken(),g.fileDownload({url:this.getUrl("gpx"),data:e,httpMethod:"POST"})},v.getGpkg=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).data,e=void 0===e?{}:e;return e.filtertoken=this.getFilterToken(),g.fileDownload({url:this.getUrl("gpkg"),data:e,httpMethod:"POST"})},v.getCsv=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).data,e=void 0===e?{}:e;return e.filtertoken=this.getFilterToken(),g.fileDownload({url:this.getUrl("csv"),data:e,httpMethod:"POST"})},v.getSourceType=function(){return this.config.source?this.config.source.type:null},v.isGeoLayer=function(){return this.state.geolayer},v.getDataTable=function(){var r=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.page,t=void 0===t?null:t,n=e.page_size,n=void 0===n?null:n,i=e.ordering,i=void 0===i?null:i,a=e.search,a=void 0===a?null:a,o=e.field,s=e.suggest,s=void 0===s?null:s,l=e.formatter,l=void 0===l?0:l,u=e.in_bbox,e=e.custom_params,e=void 0===e?{}:e,c=$.Deferred(),e=d({},e,{field:o,page:t,page_size:n,ordering:i,search:a,formatter:l,suggest:s,in_bbox:u,filtertoken:p.default.tokens.filtertoken});return this.getProvider("filter")||this.getProvider("data")?this.getProvider("data").getFeatures({editing:!1},e).done(function(e){var t=e.data.features&&e.data.features||[];c.resolve({headers:y(r.getAttributes(),t.length?t[0].properties:[]),features:t,title:r.getTitle(),count:e.count})}).fail(function(e){return c.reject(e)}):c.reject(),c.promise()},v.getFeatureByFids=l(regeneratorRuntime.mark(function e(){var t,r,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=n.fids,a=void 0===i?[]:i,i=n.formatter,o=void 0===i?0:i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.getUrl("data"),t=void 0,e.prev=2,e.next=5,g.get({url:r,params:{fids:a.toString(),formatter:o}});case 5:r=e.sent,t=r&&r.result&&r.vector&&r.vector.data&&r.vector.data.features,e.next=11;break;case 9:e.prev=9,e.t0=e.catch(2);case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}},e,this,[[2,9]])})),v.searchFeatures=function(){var r,u=this,c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=c.search_endpoint,p=void 0===e?this.config.search_endpoint:e;return new Promise((r=l(regeneratorRuntime.mark(function e(t,r){var n,i,a,o,s,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=p,e.next="ows"===e.t0?3:"api"===e.t0?5:18;break;case 3:return u.search(c,d).then(function(e){t({data:e})}).fail(function(e){return r(e)}),e.abrupt("break",18);case 5:return n=c.raw,n=void 0!==n&&n,i=c.filter,a=c.suggest,a=void 0===a?{}:a,o=c.unique,s=c.queryUrl,l=c.ordering,e.prev=6,e.t1=t,e.next=10,u.getFilterData({queryUrl:s,raw:n,field:i,ordering:l,suggest:a,unique:o});case 10:e.t2=e.sent,(0,e.t1)(e.t2),e.next=17;break;case 14:e.prev=14,e.t3=e.catch(6),r(e.t3);case 17:return e.abrupt("break",18);case 18:case"end":return e.stop()}},e,u,[[6,14]])})),function(e,t){return r.apply(this,arguments)}))},v.getFilterData=l(regeneratorRuntime.mark(function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.field,n=t.raw,i=void 0!==n&&n,n=t.suggest,a=void 0===n?{}:n,o=t.unique,n=t.formatter,s=void 0===n?1:n,l=t.queryUrl,u=t.ordering;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getProvider("data").getFilterData({queryUrl:l,field:r,raw:i,ordering:u,suggest:a,formatter:s,unique:o});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),v.search=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=(e.feature_count=e.feature_count||10,e=d({},e,this.config.searchParams,t),$.Deferred()),t=this.getProvider("search");return t?t.query(e).done(function(e){return r.resolve(e)}).fail(function(e){return r.reject(e)}):r.reject(u("sdk.search.layer_not_searchable")),r.promise()},v.query=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=$.Deferred(),r=this.getProvider(e.filter?"filter":"query");return r?r.query(e).done(function(e){return t.resolve(e)}).fail(function(e){return t.reject(e)}):t.reject(u("sdk.search.layer_not_querable")),t.promise()},v.get=function(e){return this.config[e]||this.state[e]},v.getFields=function(){return this.config.fields},v.getFieldByName=function(t){return this.getFields().find(function(e){return e.name===t})},v.getEditingFields=function(){return this.config.editing.fields},v.getTableFields=function(){return(this.config.fields||[]).filter(function(e){return e.show})},v.getTableHeaders=function(){return this.getTableFields().filter(function(e){return-1===m.indexOf(e.name)})},v.getProject=function(){return this.config.project},v.getConfig=function(){return this.config},v.getLayerEditingFormStructure=function(e){return this.config.editor_form_structure},v.getEditorFormStructure=function(){return this.getLayerEditingFormStructure()},v.getFieldsOutOfFormStructure=function(){return this.config.editor_form_structure?this.config.editor_form_structure.filter(function(e){return e.field_name}):[]},v.hasFormStructure=function(){return!!this.config.editor_form_structure},v.getCustomStyle=function(){return this.config.customstyle},v.getState=function(){return this.state},v.getSource=function(){return this.state.source},v.isDownloadable=function(){return this.isShpDownlodable()||this.isXlsDownlodable()||this.isGpxDownlodable()||this.isGpkgDownlodable()||this.isCsvDownlodable()},v.getDownloadableFormats=function(){var t=this;return Object.keys(n.DOWNLOAD_FORMATS).filter(function(e){return t.config[e]}).map(function(e){return n.DOWNLOAD_FORMATS[e].format})},v.getDownloadUrl=function(t){var e=Object.values(n.DOWNLOAD_FORMATS).find(function(e){return e.format===t});return e&&e.url},v.isGeoTIFFDownlodable=function(){return!this.isBaseLayer()&&this.config.download&&"gdal"===this.config.source.type},v.isShpDownlodable=function(){return!this.isBaseLayer()&&this.config.download&&"gdal"!==this.config.source.type},v.isXlsDownlodable=function(){return!this.isBaseLayer()&&this.config.download_xls},v.isGpxDownlodable=function(){return!this.isBaseLayer()&&this.config.download_gpx},v.isGpkgDownlodable=function(){return!this.isBaseLayer()&&this.config.download_gpkg},v.isCsvDownlodable=function(){return!this.isBaseLayer()&&this.config.download_csv},v.getEditingLayer=function(){return this._editingLayer},v.setEditingLayer=function(e){this._editingLayer=e},v.isHidden=function(){return this.state.hidden},v.setHidden=function(){this.state.hidden=!(0<arguments.length&&void 0!==arguments[0])||arguments[0]},v.isModified=function(){return this.state.modified},v.getId=function(){return this.config.id},v.getMetadata=function(){return this.state.metadata},v.getTitle=function(){return this.config.title},v.getName=function(){return this.config.name},v.getOrigName=function(){return this.config.origname},v.getServerType=function(){return this.config.servertype&&""!==this.config.servertype?this.config.servertype:ServerTypes.QGIS},v.getType=function(){return this.type},v.isType=function(e){return this.getType()===e},v.setType=function(e){this.type=e},v.isSelected=function(){return this.state.selected},v.setSelected=function(e){this.state.selected=e},v.setSelection=l(regeneratorRuntime.mark(function e(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.selection.active=t)e.next=8;else{if(e.t0=this.state.filter.active,e.t0)return e.next=6,this.deleteFilterToken();e.next=6}break;case 6:this.state.filter.active=t,this.emit("unselectionall",this.getId());case 8:case"end":return e.stop()}},e,this)})),v.isSelectionActive=function(){return this.state.selection.active},v.getSelection=function(){return this.state.selection},v.getFilter=function(){return this.state.filter},v.setDisabled=function(e){this.state.disabled=e},v.isDisabled=function(){return this.state.disabled},v.isVisible=function(){return this.state.visible},v.setVisible=function(e){this.state.visible=e},v.isQueryable=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{onMap:!1}).onMap,t=!1,r=!!(this.config.capabilities&&this.config.capabilities&w.CAPABILITIES.QUERYABLE);return e?r&&(t=this.isVisible()&&!this.isDisabled(),void 0!==this.config.infowhennotvisible)&&!0===this.config.infowhennotvisible||t:r},v.getOws=function(){return this.config.ows},v.getTocHighlightable=function(){return this.state.tochighlightable},v.setTocHighlightable=function(){this.state.tochighlightable=0<arguments.length&&void 0!==arguments[0]&&arguments[0]},v.isFilterable=function(){var e,n=this,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=!!(this.config.capabilities&&this.config.capabilities&w.CAPABILITIES.FILTERABLE);return t&&i&&(e=Object.keys(i).reduce(function(e,t){var r=n.get(t),t=i[t];return e&&Array.isArray(r)?-1!==r.indexOf(t):t===r},!0),t=t&&e),t},v.isQtimeseries=function(){return this.config.qtimeseries},v.isEditable=function(){return!!(this.config.capabilities&&this.config.capabilities&w.CAPABILITIES.EDITABLE)},v.isBaseLayer=function(){return this.config.baselayer},v.getUrl=function(e){return this.config.urls[e]},v.setUrl=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.type,e=e.url;this.config.urls[t]=e},v.getUrls=function(){return this.config.urls},v.setEditingUrl=function(e){this.config.urls.editing=e||this.config.urls.editing},v.getQueryUrl=function(){return this.config.urls.query},v.setQueryUrl=function(e){this.config.urls.query=e},v.getQueryLayerName=function(){return this.config.infolayer&&""!==this.config.infolayer?this.config.infolayer:this.getName()},v.getQueryLayerOrigName=function(){return this.state.infolayer&&""!==this.config.infolayer?this.config.infolayer:this.config.origname},v.getInfoFormat=function(e){return!0===this.config.qtimeseries||"gdal"===this.getSourceType()?"application/json":this.config.infoformat&&""!==this.config.infoformat&&"wfs"!==e?this.config.infoformat:"application/vnd.ogc.gml"},v.getInfoFormats=function(){return this.state.infoformats},v.getInfoUrl=function(){return this.config.infourl},v.setInfoFormat=function(e){this.config.infoformat=e},v.getAttributes=function(){return this.config.fields},v.changeAttribute=function(e,t,r){var n=!0,i=!1,a=void 0;try{for(var o,s=this.config.fields[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=o.value;if(l.name===e){l.type=t,l.options=r;break}}}catch(e){i=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw a}}},v.getAttributeLabel=function(t){var e=this.getAttributes().find(function(e){return e.name===t});return e&&e.label},v.getProvider=function(e){return this.providers[e]},v.getProviders=function(){return this.providers},v.getLayersStore=function(){return this._layersstore},v.setLayersStore=function(e){this._layersstore=e},v.canShowTable=function(){return!this.config.not_show_attributes_table&&(this.getServerType()===w.ServerTypes.QGIS&&-1<[w.SourceTypes.POSTGIS,w.SourceTypes.ORACLE,w.SourceTypes.WFS,w.SourceTypes.OGR,w.SourceTypes.MSSQL,w.SourceTypes.SPATIALITE].indexOf(this.config.source.type)&&this.isQueryable()?0<this.getTableFields().length:this.getServerType()===w.ServerTypes.G3WSUITE&&"geojson"===this.get("source").type||!(this.getServerType()===w.ServerTypes.G3WSUITE||!this.isFilterable()))},v.changeFieldType=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.name,r=e.type,n=e.options,n=void 0===n?{}:n,e=e.reset,e=void 0!==e&&e,i=this.getFields().find(function(e){return e.name===t});return i&&e?(i.type=i._type,delete i._type,delete i[r+"options"],i.type):i&&!e?(i._type=i.type,i.type=r,i[r+"options"]=n,i._type):void 0},v.changeConfigFieldType=function(e){var t=e.name,r=e.type,n=e.options,e=e.reset;return this.changeFieldType({name:t,type:r,options:void 0===n?{}:n,reset:void 0!==e&&e})},v.resetConfigField=function(e){e=e.name;this.changeConfigFieldType({name:e,reset:!0})},v.clear=function(){},v.isVector=function(){return this.getType()===w.LayerTypes.VECTOR},v.isTable=function(){return this.getType()===w.LayerTypes.TABLE},v.getFeatureCount=function(){return this.state.featurecount},v.getStyleFeatureCount=(C=l(regeneratorRuntime.mark(function e(t){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.state.stylesfeaturecount[t])return e.prev=1,e.next=4,g.post({url:""+this.config.urls.featurecount+this.getId()+"/",data:JSON.stringify({style:t}),contentType:"application/json"});e.next=13;break;case 4:n=e.sent,r=n.result,n=n.data,this.state.stylesfeaturecount[t]=!0===r?n:{},e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),this.state.stylesfeaturecount[t]={};case 13:return e.abrupt("return",this.state.stylesfeaturecount[t]);case 14:case"end":return e.stop()}},e,this,[[1,10]])})),function(e){return C.apply(this,arguments)}),w.LayerTypes={TABLE:"table",IMAGE:"image",VECTOR:"vector"},w.ServerTypes={OGC:"OGC",QGIS:"QGIS",Mapserver:"Mapserver",Geoserver:"Geoserver",ARCGISMAPSERVER:"ARCGISMAPSERVER",OSM:"OSM",BING:"Bing",LOCAL:"Local",TMS:"TMS",WMS:"WMS",WMTS:"WMTS",G3WSUITE:"G3WSUITE"},w.SourceTypes={VIRTUAL:"virtual",POSTGIS:"postgres",SPATIALITE:"spatialite",ORACLE:"oracle",MSSQL:"mssql",CSV:"delimitedtext",OGR:"ogr",GDAL:"gdal",WMS:"wms",WMST:"wmst",WFS:"wfs",WCS:"wcs",MDAL:"mdal","VECTOR-TILE":"vector-tile",VECTORTILE:"vectortile",ARCGISMAPSERVER:"arcgismapserver",GEOJSON:"geojson"},w.CAPABILITIES={QUERYABLE:1,FILTERABLE:2,EDITABLE:4},w.EDITOPS={INSERT:1,UPDATE:2,DELETE:4},w.SELECTION_STATE={ALL:"__ALL__",EXCLUDE:"__EXCLUDE__"},t.exports=w},{"app/constant":4,"core/g3wobject":12,"core/i18n/i18n.service":13,"core/layers/providers/providersfactory":51,"core/relations/relations":63,"core/utils/geo":64,"core/utils/utils":68,"services/application":351,"services/data":358,"store/application-state":373,"store/projects":379}],35:[function(e,t,r){var n=e("core/layers/layer"),i=e("core/layers/tablelayer"),a=e("core/layers/vectorlayer"),o=e("core/layers/imagelayer"),s=e("core/layers/baselayers/baselayers"),l=e("core/layers/geojson");t.exports=new function(){this.build=function(e,t){var r=this.get(e);return r?new r(e,t):null},this.get=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=void 0,r=t.servertype;switch(r){case n.ServerTypes.QGIS:t.source&&(t.geometrytype?[n.SourceTypes.VIRTUAL,n.SourceTypes.POSTGIS,n.SourceTypes.MSSQL,n.SourceTypes.SPATIALITE,n.SourceTypes.WFS,n.SourceTypes.CSV,n.SourceTypes.ORACLE,n.SourceTypes.OGR,n.SourceTypes.MDAL].find(function(e){return e===t.source.type})&&(e=t.geometrytype&&"NoGeometry"===t.geometrytype?i:o):[n.SourceTypes.WMST,n.SourceTypes.WCS,n.SourceTypes.WMS,n.SourceTypes.GDAL,n.SourceTypes.VECTORTILE,n.SourceTypes["VECTOR-TILE"],n.SourceTypes.MDAL,n.SourceTypes.ARCGISMAPSERVER].find(function(e){return e===t.source.type})&&(e=o));break;case n.ServerTypes.OGC:if(t.source)switch(t.source.type){case n.SourceTypes.WMS:e=o;break;case n.SourceTypes.WFS:e=a}break;case n.ServerTypes.LOCAL:e=a;break;case n.ServerTypes.OSM:case n.ServerTypes.BING:case n.ServerTypes.TMS:case n.ServerTypes.WMS:case n.ServerTypes.WMTS:case n.ServerTypes.ARCGISMAPSERVER:e=s[r];break;case n.ServerTypes.G3WSUITE:e=a,t.source&&"geojson"===t.source.type&&(e=l)}return e}}},{"core/layers/baselayers/baselayers":20,"core/layers/geojson":31,"core/layers/imagelayer":33,"core/layers/layer":34,"core/layers/tablelayer":56,"core/layers/vectorlayer":57}],36:[function(e,t,r){var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},n=e("core/utils/utils"),i=n.base,o=n.inherit,l=n.uniqueId;function u(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.config={id:e.id||Date.now(),projection:e.projection,extent:e.extent,initextent:e.initextent,wmsUrl:e.wmsUrl,catalog:!_.isBoolean(e.catalog)||e.catalog},this.state={layerstree:[],relations:null},this._isQueryable=!_.isBoolean(e.queryable)||e.queryable,this._layers=this.config.layers||{},this.setters={setLayerSelection:function(e){var t=e.layerId;e.selection,this.getLayerById(t)},setLayerSelected:function(t,r){this.getLayers().forEach(function(e){return e.state.selected=t===e.getId()&&r})},addLayers:function(e){var t=this;e.forEach(function(e){return t.addLayer(e)})},addLayer:function(e){this._addLayer(e)},removeLayer:function(e){this._removeLayer(e)}},i(this)}o(u,e("core/g3wobject"));n=u.prototype;n.isQueryable=function(){return this._isQueryable},n.setQueryable=function(e){this._isQueryable=!!e},n.showOnCatalog=function(){return this.config.catalog},n.setOptions=function(e){this.config=e},n.getId=function(){return this.config.id},n._addLayer=function(e){this._layers[e.getId()]=e},n._removeLayer=function(e){e=e.getId();delete this._layers[e]},n.removeLayers=function(){var t=this;Object.entries(this._layers).forEach(function(e){e=s(e,2),e[0],e=e[1];t.removeLayer(e)})},n.getLayersDict=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(!e)return this._layers;var r=e.PRINTABLE,n=e.QUERYABLE,i=e.FILTERABLE,a=e.EDITABLE,o=e.VISIBLE,s=e.SELECTED,l=e.CACHED,u=e.SELECTED_OR_ALL,c=e.SERVERTYPE,d=e.BASELAYER,p=e.GEOLAYER,f=e.VECTORLAYER,h=e.HIDDEN,g=e.DISABLED,e=e.IDS;if(_.isUndefined(n)&&_.isUndefined(i)&&_.isUndefined(a)&&_.isUndefined(o)&&_.isUndefined(c)&&_.isUndefined(l)&&_.isUndefined(u)&&_.isUndefined(c)&&_.isUndefined(p)&&_.isUndefined(h)&&_.isUndefined(g)&&_.isUndefined(d)&&_.isUndefined(f)&&_.isUndefined(r)&&_.isUndefined(e))return this._layers;var v,m,y=[];for(v in this._layers)y.push(this._layers[v]);return e&&(m=Array.isArray(e)?e:[e],y=y.filter(function(e){return-1!==m.indexOf(e.getId())})),u&&(y=(y=(e=y).filter(function(e){return e.isSelected()})).length?y:e),"boolean"!=typeof s||u||(y=y.filter(function(e){return s===e.isSelected()})),"boolean"==typeof n&&(y=y.filter(function(e){return n===e.isQueryable()})),"boolean"==typeof i&&(y=y.filter(function(e){return i===e.isFilterable(t.filtrable||null)})),"boolean"==typeof a&&(y=y.filter(function(e){return a===e.isEditable()})),"boolean"==typeof o&&(y=y.filter(function(e){return o===e.isVisible()})),"boolean"==typeof l&&(y=y.filter(function(e){return l===e.isCached()})),"boolean"==typeof d&&(y=y.filter(function(e){return d===e.isBaseLayer()})),"boolean"==typeof p&&(y=y.filter(function(e){return p===e.state.geolayer})),"boolean"==typeof f&&(y=y.filter(function(e){return f===e.isType("vector")})),"boolean"==typeof h&&(y=y.filter(function(e){return h==e.isHidden()})),"boolean"==typeof g&&(y=y.filter(function(e){return g===e.isDisabled()})),"string"==typeof c&&""!==c&&(y=y.filter(function(e){return c===e.getServerType()})),y=r?y.filter(function(e){return e.state.geolayer&&e.isPrintable({scale:r.scale})}):y},n.getLayers=function(){return Object.values(this.getLayersDict(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}))},n.getBaseLayers=function(){return this.getLayersDict({BASELAYER:!0})},n.getLayerById=function(e){return this.getLayersDict()[e]},n.getLayerByName=function(t){return this._layers.find(function(e){return e.getName()===t})},n.getLayerAttributes=function(e){return this.getLayerById(e).getAttributes()},n.getLayerAttributeLabel=function(e,t){return this.getLayerById(e).getAttributeLabel(t)},n.getGeoLayers=function(){return this.getLayers({GEOLAYER:!0})},n._getAllSiblingsChildrenLayersId=function(e){var r=[];return function t(e){e.nodes.forEach(function(e){e.id?r.push(e.id):t(e)})}(e),r},n._getAllParentLayersId=function(e,t){var r=[];return{nodes:e.nodes.filter(function(e){return e!==t})}.nodes.forEach(function(e){e.id&&r.push(e.id)}),r},n.selectLayer=function(e,t){this.setLayerSelected(e,t)},n.getProjection=function(){return this.config.projection},n.getExtent=function(){return this.config.extent},n.getInitExtent=function(){return this.config.initextent},n.getWmsUrl=function(){return this.config.wmsUrl},n.removeLayersTree=function(){this.state.layerstree.splice(0,this.state.layerstree.length)},n.getLayersTree=function(){return this.state.layerstree},n.setLayersTree=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],n=this.getInitExtent(),n=s(n,4),i=n[0],a=n[1],o=n[2],n=n[3],t={title:t||this.config.id,root:!0,parentGroup:null,expanded:r,disabled:!1,checked:!0,bbox:{minx:i,miny:a,maxx:o,maxy:n},nodes:e};e.length&&(this._traverseLayersTree(e,t),this.state.layerstree.splice(0,0,t))},n.createLayersTree=function(e){var t,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{layerstree:null,expanded:!1,full:!1},n=[];if(r.layerstree&&!0===r.full)return this.state.layerstree;r.layerstree&&!0!==r.full&&(t=this.getLayers({BASELAYER:!1}).map(function(e){return e.getId()}),this._traverseLightLayersTree(r.layerstree,n,t)),r.layerstree||(n=this.getGeoLayers().map(function(e){return{id:e.getId(),name:e.getName(),title:e.getTitle(),visible:e.isVisible()||!1}})),this.setLayersTree(n,e,r.expanded)},n._traverseLightLayersTree=function(e,r,n){var i=this;e.forEach(function(t){var e=null;null!==t.id&&void 0!==t.id&&n.find(function(e){return e===t.id})&&(e=a({},e,t)),null!==t.nodes&&void 0!==t.nodes&&(e=a({},e,{title:t.name,groupId:l(),root:!1,nodes:[],checked:t.checked,mutually_exclusive:t["mutually-exclusive"]}),i._traverseLightLayersTree(t.nodes,e.nodes,n)),null!==e&&(e.expanded=t.expanded,r.push(e))})},n._traverseLayersTree=function(r,n){var i=this;r.forEach(function(e,t){void 0!==e.id&&(r[t]=i.getLayerById(e.id).getState()),void 0!==e.id&&(r[t]=i.getLayerById(e.id).getState(),void 0!==r[t].bbox)&&i._setLayersTreeGroupBBox(n,{bbox:r[t].bbox,epsg:r[t].epsg}),Array.isArray(e.nodes)&&(e.nodes.forEach(function(e){return e.parentGroup=n}),i._traverseLayersTree(e.nodes,e)),r[t].parentGroup=n})},n._setLayersTreeGroupBBox=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=t.bbox,t=t.epsg,n=this.getProjection().getCode();t!==n&&(t=ol.proj.transformExtent([r.minx,r.miny,r.maxx,r.maxy],t,n),r={minx:(t=s(t,4))[0],miny:t[1],maxx:t[2],maxy:t[3]}),void 0===e.bbox?e.bbox=r:e.bbox=ol.extent.extend([e.bbox.minx,e.bbox.miny,e.bbox.maxx,e.bbox.maxy],[r.minx,r.miny,r.maxx,r.maxy]).reduce(function(e,t,r){switch(r){case 0:e.minx=t;break;case 1:e.miny=t;break;case 2:e.maxx=t;break;case 3:e.maxy=t}return e},{minxx:null,miny:null,maxx:null,maxy:null}),e.parentGroup&&!1===e.parentGroup.root&&this._setLayersTreeGroupBBox(e.parentGroup,{bbox:e.bbox,epsg:n})},t.exports=u},{"core/g3wobject":12,"core/utils/utils":68}],37:[function(e,t,r){var n=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=e("core/utils/utils"),a=i.base;function o(){this.stores={},this.storesArray=[],this.setters={addLayersStore:this._addLayersStore.bind(this),removeLayersStore:this._removeLayersStore.bind(this),removeLayersStores:this._removeLayersStores.bind(this)},a(this)}(0,i.inherit)(o,e("core/g3wobject"));i=o.prototype;i.getLayerById=function(e){var t,r=void 0;for(t in this.stores)if(r=this.stores[t].getLayerById(e))break;return r},i.getLayers=function(t){var r=[];return Object.entries(this.stores).forEach(function(e){e=n(e,2),e[0],e=e[1];r=r.concat(e.getLayers(t))}),r},i.getQuerableLayersStores=function(){return this.getLayersStores().filter(function(e){return e.isQueryable()})},i.getLayersStore=function(e){return this.stores[e]},i.getLayersStores=function(){var t=this,r=[];return this.storesArray.forEach(function(e){r.push(t.stores[e])}),r},i._addLayersStore=function(e,t){var r=e.getId();this.stores[r]=e,_.isNil(t)?this.storesArray.push(r):this.storesArray.splice(t,0,r)},i._removeLayersStore=function(e){var t;e&&(t=e.getId(),this.storesArray=this.storesArray.filter(function(e){return e!=t}),delete this.stores[t])},i._removeLayersStores=function(){this.storesArray=[],this.stores={}},t.exports=o},{"core/g3wobject":12,"core/utils/utils":68}],38:[function(e,t,r){t.exports=function(e){var t=e.layer;e.params;t=(e=t.getConfig().source).url,e=e.layer;return t.replace("/rest/","/")+"/WMSServer?request=GetLegendGraphic&version=1.3.0&format=image/png&LAYER="+e}},{}],39:[function(e,t,r){var i={wms:e("./wmslegend"),arcgismapserver:e("./arcgismapserverlegend")};t.exports={get:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,r=e.params,e=e.options,e=void 0===e?{}:e,n=t.isArcgisMapserver()?"arcgismapserver":"wms";return i[n]({layer:t,params:r,options:e})}}},{"./arcgismapserverlegend":38,"./wmslegend":40}],40:[function(e,t,r){var n=e("store/projects"),F=(n=n)&&n.__esModule?n:{default:n};var O=e("core/utils/geo").get_LEGEND_ON_LEGEND_OFF_Params;t.exports=function(e){var t=e.layer,r=e.params,e=void 0===(e=e.options)?{}:e,n=r.width,i=r.height,a=void 0===(a=r.color)?"white":a,o=void 0===(o=r.fontsize)?10:o,s=void 0===(s=r.transparent)||s,l=r.boxspace,u=r.layerspace,c=void 0===(c=r.layertitle)||c,d=r.layertitlespace,p=r.symbolspace,f=r.iconlabelspace,h=r.symbolwidth,g=r.symbolheight,v=r.itemfontfamily,m=r.layerfontfamily,y=r.layerfontbold,_=r.itemfontbold,b=r.layerfontitalic,w=r.itemfontitalic,x=r.rulelabel,S=r.crs,L=r.bbox,r=void 0===(r=r.sld_version)?"1.1.0":r,C=void 0!==(C=e.categories)&&C,k=void 0!==(k=e.all)&&k,e=void 0===(e=e.format)?"image/png":e,E=t.getWMSLayerName({type:"legend"}),M=void 0,T=void 0,I=void 0,P=t.getWmsUrl({type:"legend"});return k&&(L=null),C&&"application/json"===e&&(h=g=16,M=encodeURIComponent(t.getCurrentStyle().name)),C&&(F.default.getCurrentProject().getContextBaseLegend()||"image/png"===e)&&(T=(k=O(t)).LEGEND_ON,I=k.LEGEND_OFF),[""+P+(-1<P.indexOf("?")?"&":"?")+"SERVICE=WMS&VERSION=1.3.0&REQUEST=GetLegendGraphic&SLD_VERSION="+r,n?"&WIDTH="+n:"",i?"&HEIGHT="+i:"","&FORMAT="+e,"&TRANSPARENT="+s,"&ITEMFONTCOLOR="+a,"&LAYERFONTCOLOR="+a,"&LAYERTITLE="+c,"&ITEMFONTSIZE="+o,S?"&CRS="+S:"",L?"&BBOX="+L.join(","):"",l?"&BOXSPACE="+l:"",u?"&LAYERSPACE="+u:"",d?"&LAYERTITLESPACE="+d:"",p?"&SYMBOLSPACE="+p:"",f?"&ICONLABELSPACE="+f:"",h?"&SYMBOLWIDTH="+h:"",g?"&SYMBOLHEIGHT="+g:"",m?"&LAYERFONTFAMILY="+m:"",v?"&ITEMFONTFAMILY="+v:"",y?"&LAYERFONTBOLD="+y:"",_?"&ITEMFONTBOLD="+_:"",b?"&LAYERFONTITALIC="+b:"",w?"&ITEMFONTITALIC="+w:"",x?"&RULELABEL="+x:"",T?"&LEGEND_ON="+T:"",I?"&LEGEND_OFF="+I:"",M?"&STYLES="+M:"","&LAYER="+E].join("")}},{"core/utils/geo":64,"store/projects":379}],41:[function(e,t,r){var n=e("core/utils/utils"),i=n.inherit,a=n.base,n=e("core/layers/map/wmslayer"),o=e("g3w-ol/layers/rasters");function s(){a(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},1<arguments.length&&void 0!==arguments[1]?arguments[1]:{})}i(s,n),s.prototype._makeOlLayer=function(){var e=this,t={url:this.config.url,id:this.config.id,projection:this.config.projection,format:this.config.format},t=new o.TiledArgisMapServer(t);return t.getSource().on("imageloadstart",function(){e.emit("loadstart")}),t.getSource().on("imageloadend",function(){e.emit("loadend")}),t.getSource().on("imageloaderror",function(){e.emit("loaderror")}),t},t.exports=s},{"core/layers/map/wmslayer":45,"core/utils/utils":68,"g3w-ol/layers/rasters":108}],42:[function(e,t,r){var n=e("core/utils/utils"),i=n.inherit,a=n.base;function o(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.provider;this.setProvider(t),a(this,e),this.getFeatures({url:e.url,mapProjection:this.mapProjection})}i(o,e("core/layers/map/vectorlayer")),t.exports=o},{"core/layers/map/vectorlayer":44,"core/utils/utils":68}],43:[function(e,t,r){var n=e("core/utils/utils"),i=n.base;function a(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.config=e,this.id=e.id,this.iframe_internal=e.iframe_internal||!1,this.extent=e.extent,this.projection=e.projection,this.layer=null,this.layers=e.layers||[],this.allLayers=[],this.showSpinnerWhenLoading=!0,i(this)}(0,n.inherit)(a,e("core/g3wobject"));n=a.prototype;n.getId=function(){return this.id},n.getOLLayer=function(){},n.update=function(){this._updateLayers(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},1<arguments.length&&void 0!==arguments[1]?arguments[1]:{})},n.checkLayerDisabled=function(e,t,r){return e.setDisabled(t,r),e.isDisabled()},n.checkLayersDisabled=function(t,r){var n=this;this.allLayers.forEach(function(e){return n.checkLayerDisabled(e,t,r)})},n.setupCustomMapParamsToLegendUrl=function(){},t.exports=a},{"core/g3wobject":12,"core/utils/utils":68}],44:[function(e,t,r){var i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},n=e("services/gui"),a=(n=n)&&n.__esModule?n:{default:n};var n=e("core/utils/utils").inherit,o=e("core/utils/geo"),s=o.createOlLayer,l=o.createLayerStyle;function u(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.mapService=a.default.getComponent("map").getService(),this.geometrytype=e.geometrytype||null,this.type=e.type||null,this.crs=e.crs||null,this.id=e.id,this.name=e.name||"",this.style=e.style,this.color=e.color,this.geometryType=e.geometryType,this.mapProjection=this.mapService.getProjection().getCode(),this.projection=e.projection||this.mapProjection,this.url=e.url,this.provider=e.provider,this._features=e.features||[],this._olLayer=e.olLayer||this.getOLLayer()}n(u,e("core/g3wobject"));o=(t.exports=u).prototype;o.setProvider=function(e){this._provider=e},o.getProvider=function(){return this._provider},o.resetSource=function(){var e=new ol.source.Vector({features:0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]});this.setSource(e)},o._makeOlLayer=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).style,e=this._makeStyle(e);this._olLayer=new ol.layer.Vector({name:this.name,id:this.id,style:e,source:new ol.source.Vector({})})},o._makeStyle=function(e){var t=void 0,n={};return e&&(Object.entries(e).forEach(function(e){var e=i(e,2),t=e[0],r=e[1];switch(t){case"point":r.icon&&(n.image=new ol.style.Icon({src:r.icon.url,imageSize:r.icon.width}));break;case"line":n.stroke=new ol.style.Stroke({color:r.color,width:r.width});break;case"polygon":n.fill=new ol.style.Fill({color:r.color})}}),t=new ol.style.Style(n)),t},o.getFeatures=function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred();return this.provider.getFeatures(e).then(function(e){t.addFeatures(e),r.resolve(e)}).fail(function(e){return r.reject(e)}),r.promise()},o.addFeatures=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];this.getSource().addFeatures(e)},o.addFeature=function(e){e&&this.getSource().addFeature(e)},o.getOLLayer=function(){var e,t,r,n;return this._olLayer||(e=this.id,t=this.geometryType,r=this.color,n=this.style?l(this.style):null,this._olLayer=s({id:e,geometryType:t,color:r,style:n,features:this._features})),this._olLayer},o.setOLLayer=function(e){this._olLayer=e},o.getSource=function(){return this._olLayer||this.getOLLayer(),this._olLayer.getSource()},o.setSource=function(e){this._olLayer.setSource(e)},o.setStyle=function(e){this._olLayer.setStyle(e)},o.getFeatureById=function(e){return e?this._olLayer.getSource().getFeatureById(e):null},o.isVisible=function(){return this._olLayer.getVisible()},o.setVisible=function(e){this._olLayer.setVisible(e)},o.clear=function(){this.getSource().clear()},o.addToMap=function(e){e.addLayer(this._olLayer)}},{"core/g3wobject":12,"core/utils/geo":64,"core/utils/utils":68,"services/gui":361}],45:[function(u,e,t){var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r=u("store/application-state"),d=(r=r)&&r.__esModule?r:{default:r};var r=u("core/utils/utils"),n=r.base,r=r.inherit,i=u("core/layers/map/maplayer"),a=u("g3w-ol/layers/rasters");function o(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"GET";this.LAYERTYPE={LAYER:"layer",MULTILAYER:"multilayer"},this.extraParams=t,this._method=r,n(this,e)}r(o,i);r=o.prototype;r.getOLLayer=function(e){return this._olLayer||(this._olLayer=this._makeOlLayer(e)),this._olLayer},r.getSource=function(){return this.getOLLayer().getSource()},r.getInfoFormat=function(){return"application/vnd.ogc.gml"},r.getGetFeatureInfoUrl=function(e,t,r,n){return this.getOLLayer().getSource().getGetFeatureInfoUrl(e,t,r,n)},r.getLayerConfigs=function(){return this.layers},r.addLayer=function(t){this.allLayers.find(function(e){return t===e})||this.allLayers.push(t),this.layers.find(function(e){return t===e})||this.layers.push(t)},r.removeLayer=function(t){this.layers=this.layers.filter(function(e){return t!==e})},r.isVisible=function(){return 0<this._getVisibleLayers().length},r.getQueryUrl=function(){var e=this.layers[0];return e.infourl&&""!==e.infourl?e.infourl:this.config.url},r.getQueryableLayers=function(){return this.layers.filter(function(e){return e.isQueryable()})},r._getVisibleLayers=function(){return this.layers.filter(function(e){return e.isVisible()})},r._makeOlLayer=function(e){var t=this,e=new a.WMSLayer({url:this.layers[0]&&this.layers[0].getWmsUrl?this.layers[0].getWmsUrl():this.config.url,id:this.config.id,projection:this.config.projection,iframe_internal:this.iframe_internal,layers:e?this.layers.map(function(e){return e.getWMSLayerName()}):this.layers,format:this.config.format},this.extraParams,this._method);return e.getSource().on("imageloadstart",function(){return t.emit("loadstart")}),e.getSource().on("imageloadend",function(){return t.emit("loadend")}),e.getSource().on("imageloaderror",function(){return t.emit("loaderror")}),e},r._updateLayers=function(){var r,n,i,t,a,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=o.force,s=void 0!==s&&s,o=function(e,t){var r,n={};for(r in e)0<=t.indexOf(r)||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(o,["force"]),s=(s||this.checkLayersDisabled(e.resolution,e.mapUnits),this._getVisibleLayers(e)||[]),l=u("core/utils/geo").get_LEGEND_ON_LEGEND_OFF_Params;0<s.length?(r={},n=[],i=[],t=void s.map(function(e){var t=e.getWMSLayerName();r[t]=c({},l(e)),n.push(e.getStyle()),i.push(parseInt(e.getOpacity()/100*255))}),a=void 0,Object.keys(r).forEach(function(e){r[e].LEGEND_OFF&&(a=void 0===a?r[e].LEGEND_OFF:a+";"+r[e].LEGEND_OFF),r[e].LEGEND_ON&&(t=void 0===t?r[e].LEGEND_ON:t+";"+r[e].LEGEND_ON)}),e=s[0].isArcgisMapserver()?"show:":"",o=c({},o,{filtertoken:d.default.tokens.filtertoken,STYLES:n.join(","),OPACITIES:i.join(","),LEGEND_ON:t,LEGEND_OFF:a,LAYERS:e+s.map(function(e){return e.getWMSLayerName()}).join(",")}),this._olLayer.setVisible(!0),this._olLayer.getSource().updateParams(o)):this._olLayer.setVisible(!1)},r.setupCustomMapParamsToLegendUrl=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.layer?this.layer.setMapParamstoLegendUrl(t):this.layers.forEach(function(e){return e.setMapParamstoLegendUrl(t)})},e.exports=o},{"core/layers/map/maplayer":43,"core/utils/geo":64,"core/utils/utils":68,"g3w-ol/layers/rasters":108,"store/application-state":373}],46:[function(e,t,r){var n=e("store/application-state");(n=n)&&n.__esModule;var n=e("core/utils/utils"),i=n.base,n=n.inherit,a=e("core/layers/map/wmslayer"),o=e("g3w-ol/layers/rasters");function s(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"GET";this.LAYERTYPE={LAYER:"layer",MULTILAYER:"multilayer"},this.extraParams=t,this._method=r,i(this,e)}n(s,a),s.prototype._makeOlLayer=function(e){var t=this,r={url:this.config.url,id:this.config.id,projection:this.config.projection,iframe_internal:this.iframe_internal,layers:this.layers},e=(e&&(r.layers=this.layers.map(function(e){return e.getWMSLayerName()})),this.layers[0]),e=(e&&e.getWmsUrl&&(r.url=e.getWmsUrl()),new o.TiledWMSLayer(r,this.extraParams,this._method));return e.getSource().on("tileloadstart",function(){return t.emit("loadstart")}),e.getSource().on("tileloadend",function(){return t.emit("loadend")}),e.getSource().on("tileloaderror",function(){return t.emit("loaderror")}),e},t.exports=s},{"core/layers/map/wmslayer":45,"core/utils/utils":68,"g3w-ol/layers/rasters":108,"store/application-state":373}],47:[function(e,t,r){var n=e("core/utils/utils"),i=n.inherit,a=n.base,n=e("core/layers/map/maplayer"),o=e("g3w-ol/layers/rasters");function s(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"GET";a(this,e),this._method=t}i(s,n);e=s.prototype;e.getOLLayer=function(){return this._olLayer||(this._olLayer=this._makeOlLayer())},e.getSource=function(){return this.getOLLayer().getSource()},e.getLayerConfigs=function(){return this.layer},e.addLayer=function(e){this.layer=e,this.layers.push(e),this.allLayers.push(e)},e.update=function(e,t){this._updateLayer(e,t)},e.isVisible=function(){return layer.state.visible},e._makeOlLayer=function(){var e=this,t=this.projection||this.layer.getProjection(),r={url:this.layer.getCacheUrl()+"/{z}/{x}/{y}.png",maxZoom:20,extent:this.config.extent,iframe_internal:this.iframe_internal};return r.projection=t,this._olLayer=new o.XYZLayer(r,this._method),this._olLayer.getSource().on("imageloadstart",function(){e.emit("loadstart")}),this._olLayer.getSource().on("imageloadend",function(){e.emit("loadend")}),this._olLayer.getSource().on("imageloaderror",function(){e.emit("loaderror")}),this._olLayer},e._updateLayer=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).force;void 0!==t&&t||this.checkLayersDisabled(e.resolution,e.mapUnits),this._olLayer.setVisible(this.layer.isVisible())},t.exports=s},{"core/layers/map/maplayer":43,"core/utils/utils":68,"g3w-ol/layers/rasters":108}],48:[function(e,t,r){var n=e("core/utils/utils"),i=n.inherit,a=n.base;function o(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this._name="geojson",this.provider=e.provider}i(o,e("core/layers/providers/provider"));n=o.prototype;n.query=function(){var e=$.Deferred();return e.resolve([]),e.promise()},n.getFeatures=function(){function t(e){return(new ol.format.GeoJSON).readFeatures(e,{featureProjection:o,dataProjection:a})}var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred(),n=e.url||this.getLayer().get("source").url,i=e.data,a=e.projection||"EPSG:4326",o=e.mapProjection;return i?(e=t(i),r.resolve(e)):$.get({url:n}).then(function(e){e=t(e.results);r.resolve(e)}).fail(function(e){r.reject(e)}),r.promise()},n.getDataTable=function(){var e=this,t=((0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).page,$.Deferred());return this.getFeatures().then(function(){t.resolve(e._features)}).fail(function(e){t.reject(e)}),t.promise()},n.digestFeaturesForTable=function(){return{headers:[],features:[]}},t.exports=o},{"core/layers/providers/provider":50,"core/utils/utils":68}],49:[function(e,t,r){var n=e("core/utils/utils"),i=n.inherit,a=n.base;function o(){a(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),this._name="kml"}i(o,e("core/layers/providers/provider")),o.prototype.getData=function(){return $.Deferred().promise()},t.exports=o},{"core/layers/providers/provider":50,"core/utils/utils":68}],50:[function(e,t,r){var n=e("core/utils/utils"),i=n.base,a=n.inherit,o=n.getTimeoutPromise,n=e("core/g3wobject"),s=e("core/utils/geo").handleQueryResponse,l=e("core/utils/parsers").response;function u(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._isReady=!1,this._name="provider",this._layer=e.layer,this._hasFieldsStartWithNotPermittedKey,i(this)}a(u,n);e=u.prototype;e.getLayer=function(){return this._layer},e.setLayer=function(e){this._layer=e},e.getFeatures=function(){},e.query=function(){},e.setReady=function(e){this._isReady=e},e.isReady=function(){return this._isReady},e.error=function(){},e.isValid=function(){},e.getName=function(){return this._name},e.handleQueryResponseFromServer=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[this._layer];return s({response:e,projections:t,layers:r,wms:!(3<arguments.length&&void 0!==arguments[3])||arguments[3]})},e.getQueryResponseTimeoutKey=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=e.layers,t=void 0===t?[this._layer]:t,r=e.resolve,e=e.query;return o({resolve:r,data:{data:l.utils.getTimeoutData(t),query:e}})},t.exports=u},{"core/g3wobject":12,"core/utils/geo":64,"core/utils/parsers":67,"core/utils/utils":68}],51:[function(e,t,r){var e={geojson:e("./geojsonprovider"),kml:e("./kmlprovider"),xml:e("./xmlprovider"),qgis:e("./qgisprovider"),wms:e("./wmsprovider"),wfs:e("./wfsprovider")},n={QGIS:{virtual:{query:e.wms,filter:e.wfs,data:e.qgis,search:e.qgis,filtertoken:e.qgis},postgres:{query:e.wms,filter:e.wfs,data:e.qgis,search:e.qgis,filtertoken:e.qgis},oracle:{query:e.wms,filter:e.wfs,data:e.qgis,search:e.qgis,filtertoken:e.qgis},mssql:{query:e.wms,filter:e.wfs,data:e.qgis,search:e.qgis,filtertoken:e.qgis},spatialite:{query:e.wms,filter:e.wfs,data:e.qgis,search:e.qgis,filtertoken:e.qgis},ogr:{query:e.wms,filter:e.wfs,data:e.qgis,search:e.qgis,filtertoken:e.qgis},delimitedtext:{query:e.wms,filter:e.wfs,data:e.qgis,search:e.qgis,filtertoken:e.qgis},wmst:{query:e.wms,filter:e.wfs,data:null,search:null},wcs:{query:e.wms,filter:e.wfs,data:null,search:null},wms:{query:e.wms,filter:e.wfs,data:null,search:null},wfs:{query:e.wms,filter:e.wfs,data:e.qgis,search:e.qgis},gdal:{query:e.wms,filter:null,data:null,search:null},"vector-tile":{query:e.wms,filter:null,data:null,search:null},vectortile:{query:e.wms,filter:null,data:null,search:null},arcgismapserver:{query:e.wms,filter:null,data:null,search:null},mdal:{query:e.wms,filter:null,data:null,search:null}},OGC:{wms:{query:e.wms,filter:null,data:null,search:null}},G3WSUITE:{geojson:{query:e.geojson,filter:null,data:e.geojson,search:null}}};t.exports=new function(){this.build=function(e,t,r,n){e=this.get(e,t,r);return e?new e(n):null},this.get=function(e,t,r){return n[t][r][e]}}},{"./geojsonprovider":48,"./kmlprovider":49,"./qgisprovider":52,"./wfsprovider":53,"./wmsprovider":54,"./xmlprovider":55}],52:[function(e,t,r){var c=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},p=n(e("store/application-state")),d=n(e("services/relations"));function n(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}function f(e){return void 0!==e}var a=e("core/utils/utils"),o=a.base,s=a.inherit,h=a.XHR,g=e("core/i18n/i18n.service").t,a=e("core/layers/providers/provider"),v=e("core/utils/parsers").response,m=e("core/layers/features/feature"),y=e("core/utils/parsers");function l(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};o(this),this._name="qgis",this._layer=e.layer||{},this._projections={map:null,layer:null},this._queryUrl=this._layer.getUrl("query"),this._filtertokenUrl=this._layer.getUrl("filtertoken"),this._layerName=this._layer.getName()||null,this._infoFormat=this._layer.getInfoFormat()||"application/vnd.ogc.gml"}s(l,a);e=l.prototype;e.deleteFilterToken=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.get({url:this._filtertokenUrl,params:{mode:"delete"}});case 2:case"end":return e.stop()}},e,this)})),e.getFilterToken=i(regeneratorRuntime.mark(function e(){var t,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.get({url:this._filtertokenUrl,params:r});case 3:return t=e.sent,t=t.data,t=void 0===t?{}:t,e.abrupt("return",t.filtertoken);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 12:case"end":return e.stop()}},e,this,[[0,9]])})),e.getFilterData=i(regeneratorRuntime.mark(function e(){var t,r,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=n.field,a=n.raw,o=void 0!==a&&a,a=n.suggest,s=void 0===a?{}:a,l=n.unique,a=n.formatter,u=void 0===a?1:a,c=n.queryUrl,d=n.ordering;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._layer.getUrl("data"),r={field:i,suggest:s,ordering:d,formatter:u,unique:l,filtertoken:p.default.tokens.filtertoken},e.prev=2,e.next=5,h.get({url:""+(c||t),params:r});case 5:return t=e.sent,"table"!==this._layer.getType()&&this.setProjections(),r=o?t:t.result?l?t.data:{data:v.get("application/json")({layers:[this._layer],response:t.vector.data,projections:this._projections})}:Promise.reject(),e.abrupt("return",r);case 12:return e.prev=12,e.t0=e.catch(2),e.abrupt("return",Promise.reject(e.t0));case 15:case"end":return e.stop()}},e,this,[[2,12]])})),e.setProjections=function(){this._projections.map=this._layer.getMapProjection()||this._projections.layer},e.query=function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred(),n=e.feature_count||10,i=e.raw||!1,a=e.filter,a=void 0===a?null:a,o=(a=a&&Array.isArray(a)?a:[a],"table"!==this._layer.getType()),s=(o&&this.setProjections(),o?this._projections.map.getCode():p.default.map.epsg),l=e.queryUrl||this._queryUrl,u=e.I,c=e.J,d=e.layers,e=d?d.map(function(e){return e.getWMSLayerName()}).join(","):this._layer.getWMSLayerName();return a?("geometry"!==a[0].getType()&&(this._projections.layer=null),a=a.map(function(e){return e.get()}).filter(function(e){return e}),l=l,e={SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetFeatureInfo",filtertoken:p.default.tokens.filtertoken,LAYERS:e,QUERY_LAYERS:e,INFO_FORMAT:this._infoFormat,FEATURE_COUNT:n,CRS:s,I:u,J:c,FILTER:a&&a.length?a.join(";"):void 0,WITH_GEOMETRY:o},h.get({url:l,params:e}).then(function(e){e=i?e:t.handleQueryResponseFromServer(e,t._projections,d);r.resolve(e)}).catch(function(e){return r.reject(e)})):r.reject(),r.promise()},e.getConfig=function(){var t=$.Deferred(),e=this._layer.getUrl("config");if(e)return $.get(e).then(function(e){return t.resolve(e)}).fail(function(e){return t.reject(e)}),t.promise();t.reject("not valid url")},e.getWidgetData=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.type,e=e.fields,t=this._layer.getUrl("widget")[t];return $.get(t,{fields:e})},e.unlock=function(){var e=this._layer.getUrl("unlock"),t=$.Deferred();return $.post(e).then(function(e){return t.resolve(e)}).fail(function(e){return t.reject(e)}),t.promise()},e.commit=function(e){var t=$.Deferred(),r=this._layer.getUrl("commit"),e=JSON.stringify(e);return $.post({url:r,data:e,contentType:"application/json"}).then(function(e){return t.resolve(e)}).fail(function(e){return t.reject(e)}),t.promise()},e.getFeatures=function(){var o=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},s=$.Deferred(),l=(Object.entries(r).forEach(function(e){var e=c(e,2),t=e[0],e=e[1];null==e&&delete r[t]}),this._layer.getType()),t=void 0,n="application/json";if(e.editing){var i=void 0;if(!(t=this._layer.getUrl("editing")))return void s.reject("Url not valid");var a=$.param(r),u=(t+=a?"?"+a:"",[]),a=e.filter||null;a?f(a.bbox)?(a={in_bbox:(e=a.bbox)[0]+","+e[1]+","+e[2]+","+e[3],filtertoken:p.default.tokens.filtertoken},e=JSON.stringify(a),i=h.post({url:t,data:e,contentType:n})):f(a.fid)?(e=a.fid,i=d.default.getRelations(e)):a.field?(e=JSON.stringify(a),i=h.post({url:t,data:e,contentType:n})):f(a.fids)?i=h.get({url:t,params:a}):f(a.nofeatures)&&(e=JSON.stringify({field:(a.nofeatures_field||"id")+"|eq|__G3W__NO_FEATURES__"}),i=h.post({url:t,data:e,contentType:n})):i=h.post({url:t,contentType:n}),i.then(function(e){var t,r,n,i=e.vector,a=e.result,e=e.featurelocks;a?(a=i.data,r=i.geometrytype,i=i.count,t=y[l].get({type:"json"}),r="NoGeometry"!==r?{crs:o._layer.getCrs()}:{},n=e.map(function(e){return e.featureid}),t(a,r).forEach(function(e){var t=""+e.getId();-1<n.indexOf(t)&&u.push(new m({feature:e}))}),s.resolve({count:i,features:u,featurelocks:e})):s.reject({message:g("info.server_error")})}).catch(function(e){return s.reject({message:g("info.server_error")})})}else{t=this._layer.getUrl("data");a=$.param(r);t+=a?"?"+a:"",$.get({url:t,contentType:n}).then(function(e){var e=e.vector,t=e.data;s.resolve({data:t,count:e.count})}).fail(function(e){return s.reject(e)})}return s.promise()},e._loadLayerData=function(e,t){var r=this,n=arguments,i=$.Deferred(),a=(Obkect.entries(this._layers).forEach(function(e){var e=c(e,2),t=e[0],e=e[1];_.isNull(e.vector)&&noVectorlayerCodes.push(t)}),noVectorlayerCodes.map(function(e){return r._setupVectorLayer(e)}));return this.emit("loadingvectorlayersstart"),$.when.apply(this,a).then(function(){var e=Array.prototype.slice.call(n);r.emit("loadingvectolayersdatastart"),r.loadAllVectorsData(e).then(function(){r._vectorLayersCodes=e,i.resolve(e),r.emit("loadingvectorlayersend"),r.setReady(!0)}).fail(function(){r._layers.forEach(function(e){return e.vector=null}),i.reject(),r.emit("errorloadingvectorlayersend"),r.setReady(!1)})}).fail(function(){r.setReady(!1),r.emit("errorloadingvectorlayersend"),i.reject()}),i.promise()},e.setVectorLayersCodes=function(e){this._vectorLayersCodes=e},e.getVectorLayersCodes=function(){return this._vectorLayersCodes},e.getLayers=function(){return this._layers},e.reloadVectorData=function(e){var r=this,n=$.Deferred(),i=this._mapService.state.bbox;return this._createVectorLayerFromConfig(e).then(function(t){r._getVectorLayerData(t,i).then(function(e){r.setVectorLayerData(t[r._editingApiField],e),t.setData(e.vector.data),n.resolve(t)})}),n.promise()},e.loadAllVectorsData=function(e){var t=this,r=$.Deferred(),n=this._layers,i=this._mapService.state.bbox,a=this._loadedExtent;if(a&&ol.extent.containsExtent(a,i))return resolvedValue();this._loadedExtent=a?ol.extent.extend(a,i):i,e&&(n=[],e.forEach(function(e){return n.push(t._layers[e])}));a=n.map(function(e){return t._loadVectorData(e.vector,i)});return $.when.apply(this,a).then(function(){return r.resolve(e)}).fail(function(){return r.reject()}),r.promise()},e._setCustomUrlParameters=function(e){this._customUrlParameters=e},e._checkVectorGeometryTypeFromConfig=function(e){switch(e.geometrytype){case"Line":e.geometrytype="LineString";break;case"MultiLine":e.geometrytype="MultiLineString"}return e},e._createVectorLayerFromConfig=function(e){var n=this,i=this._layers[e],a=$.Deferred();return this._getVectorLayerConfig(i[this._editingApiField]).then(function(e){var e=e.vector,e=n._checkVectorGeometryTypeFromConfig(e),t=i.crs||n._mapService.getProjection().getCode(),r=n._createVectorLayer({geometrytype:e.geometrytype,format:e.format,crs:n._mapService.getProjection().getCode(),crsLayer:t,id:i.id,name:i.name,editing:self._editingMode}),t=(r.setFields(e.fields),r.setCrs(t),e.relations);t&&(r.lazyRelations=!0,r.setRelations(t)),i.style&&r.setStyle(i.style),a.resolve(r)}).fail(function(){return a.reject()}),a.promise()},e._setupVectorLayer=function(t){var r=this,n=$.Deferred();return this._createVectorLayerFromConfig(t).then(function(e){r._layers[t].vector=e,n.resolve(t)}).fail(function(){return n.reject()}),n.promise()},e._loadVectorData=function(t,e){var r=this;return self._getVectorLayerData(t,e).then(function(e){if(r.setVectorLayerData(t[r._editingApiField],e),r._editingMode&&e.featurelocks&&r.setVectorFeaturesLock(t,e.featurelocks),t.setData(e.vector.data),r._)return e}).fail(function(){return!1})},e.getVectorLayerData=function(e){return this._vectorLayersData[e]},e.getVectorLayersData=function(){return this._vectorLayersData},e.setVectorLayerData=function(e,t){this._vectorLayersData[e]=t},e.setVectorFeaturesLock=function(t,e){_.differenceBy(e,t.getFeatureLocks(),"featureid").forEach(function(e){t.addLockId(e)})},e.cleanVectorFeaturesLock=function(e){e.cleanFeatureLocks()},e.lockFeatures=function(e){var t=this,r=$.Deferred(),n=this._mapService.state.bbox,i=this._layers[e].vector;return $.get(this._baseUrl+e+"/?lock"+this._customUrlParameters+"&in_bbox="+n[0]+","+n[1]+","+n[2]+","+n[3]).done(function(e){t.setVectorFeaturesLock(i,e.featurelocks),r.resolve(e)}).fail(function(){return r.reject()}),r.promise()},e._getVectorLayerConfig=function(e){var t=$.Deferred();return $.get(this._baseUrl+e+"/?config"+this._customUrlParameters).done(function(e){return t.resolve(e)}).fail(function(){return t.reject()}),t.promise()},e._getVectorLayerData=function(e,t){var r=$.Deferred(),e="w"==this.getMode()?this._baseUrl+e[this._editingApiField]+"/?editing":this._baseUrl+e[this._editingApiField]+"/?";return $.get(e+this._customUrlParameters+"&in_bbox="+t[0]+","+t[1]+","+t[2]+","+t[3]).done(function(e){return r.resolve(e)}).fail(function(){return r.reject()}),r.promise()},e._createVectorLayer=function(){return new VectorLayer(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},e.cleanUpLayers=function(){this._loadedExtent=null},t.exports=l},{"core/i18n/i18n.service":13,"core/layers/features/feature":26,"core/layers/providers/provider":50,"core/utils/parsers":67,"core/utils/utils":68,"services/relations":367,"store/application-state":373}],53:[function(e,t,r){var c=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},n=e("core/utils/utils"),i=n.base,a=n.inherit,d=n.toRawType,n=e("core/layers/providers/provider"),h=e("core/layers/filter/filter");function o(){i(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),this._name="wfs"}a(o,n);e=o.prototype;e.getData=function(){return $.Deferred().promise()},e.query=function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=e.reproject,n=void 0!==n&&n,i=e.feature_count,a=e.filter,o=(r.MAXFEATURES=void 0===i?10:i,$.Deferred()),i=e.layers,s=void 0===i?[this._layer]:i,l={map:this._layer.getMapProjection(),layer:n?this._layer.getProjection():null},u=this.getQueryResponseTimeoutKey({layers:s,resolve:o.resolve,query:{}});return this._doRequest(a,r,s,n).then(function(e){e=t.handleQueryResponseFromServer(e,l,s,wms=!1);e.forEach(function(e){e=e.features;(void 0===e?[]:e).forEach(function(r){Object.entries(r.getProperties()).forEach(function(e){var e=c(e,2),t=e[0],e=e[1];"Object"===d(e)&&e["xsi:nil"]&&r.set(t,"NULL")})})}),o.resolve({data:e})}).fail(function(e){return o.reject(e)}).always(function(){clearTimeout(u)}),o.promise()},e._post=function(e,t){e=e.match(/\/$/)?e:e+"/";var r=$.Deferred();return $.post(e,t).then(function(e){return r.resolve(e)}).fail(function(e){return r.reject(e)}),r.promise()},e._get=function(e,t){e=e.match(/\/$/)?e:e+"/";var r=$.Deferred();return e=e+"?"+$.param(t),$.get(e).then(function(e){return r.resolve(e)}).fail(function(e){return r.reject(e)}),r.promise()},e._doRequest=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=arguments[2],n=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],i=$.Deferred(),a=(e=e||new h({}),r?r[0]:this._layer),o=a.getOwsMethod(),s=a.getQueryUrl(),l=a.getInfoFormat(),u=r?r.map(function(e){return e.getWFSLayerName()}).join(","):a.getWFSLayerName(),n=(n?a.getProjection():this._layer.getMapProjection()).getCode(),t=Object.assign(t,{SERVICE:"WFS",VERSION:"1.1.0",REQUEST:"GetFeature",TYPENAME:u,OUTPUTFORMAT:l,SRSNAME:n});if(e){var u=e.getType(),c=e.getConfig(),d=void 0,p=ol.format.filter;switch(e=e.get(),u){case"bbox":d=(new ol.format.WFS).writeGetFeature({featureTypes:[a],filter:p.bbox("the_geom",e)});break;case"geometry":var f=c.spatialMethod,f=void 0===f?"intersects":f,d=(new ol.format.WFS).writeGetFeature({featureTypes:[a],filter:p[f]("the_geom",e)});break;case"expression":d=(new ol.format.WFS).writeGetFeature({featureTypes:[a],filter:null});break;case"all":return request=this._post(s,t)}t.FILTER=("("+d.children[0].innerHTML+")").repeat(r?r.length:1),("GET"===o&&"geometry"!==u?this._get(s,t):this._post(s,t)).then(function(e){i.resolve(e)}).fail(function(e){200===e.status?i.resolve(e.responseText):i.reject(e)})}else i.reject();return i.promise()},t.exports=o},{"core/layers/filter/filter":30,"core/layers/providers/provider":50,"core/utils/utils":68}],54:[function(e,t,r){var h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n=e("store/application-state"),g=(n=n)&&n.__esModule?n:{default:n},v=e("constant");var n=e("core/utils/utils"),i=n.base,a=n.inherit,o=n.appendParams,s=n.XHR,m=e("core/utils/geo").get_LEGEND_ON_LEGEND_OFF_Params,y=e("core/utils/ol"),n=e("core/layers/providers/provider"),_=[101,101],b=y.getDPI();function l(){i(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),this._name="wms",this._projections={map:null,layer:null}}a(l,n);e=l.prototype;e._getRequestParameters=function(e){var t=e.layers,r=e.feature_count,n=e.coordinates,i=e.infoFormat,a=e.query_point_tolerance,a=void 0===a?v.QUERY_POINT_TOLERANCE:a,o=e.resolution,e=e.size,s=t?t.map(function(e){return e.getWMSInfoLayerName()}).join(","):this._layer.getWMSInfoLayerName(),l=y.getExtentForViewAndSize(n,o,0,e),u=Math.floor((n[0]-l[0])/o),c=Math.floor((l[3]-n[1])/o),d={},p=a.unit,a=a.value,f=(d="map"===p?(p=ol.geom.Polygon.fromCircle(new ol.geom.Circle(n,a)),{FILTER_GEOM:(new ol.format.WKT).writeGeometry(p)}):{FI_POINT_TOLERANCE:a,FI_LINE_TOLERANCE:a,FI_POLYGON_TOLERANCE:a,G3W_TOLERANCE:a*o,I:u,J:c},{LEGEND_ON:[],LEGEND_OFF:[]}),n=(t.forEach(function(e){var t;e.getCategories()&&(t=(e=m(e)).LEGEND_ON,e=e.LEGEND_OFF,t&&f.LEGEND_ON.push(t),e)&&f.LEGEND_OFF.push(e)}),h({SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetFeatureInfo",CRS:this._projections.map.getCode(),LAYERS:s,QUERY_LAYERS:s,filtertoken:g.default.tokens.filtertoken,INFO_FORMAT:i,FEATURE_COUNT:r,WITH_GEOMETRY:!0,DPI:b},d,{WIDTH:e[0],HEIGHT:e[1],LEGEND_ON:f.LEGEND_ON.length?f.LEGEND_ON.join(";"):void 0,LEGEND_OFF:f.LEGEND_OFF.length?f.LEGEND_OFF.join(";"):void 0})),p=("STYLES"in n||(n.STYLES=""),"ne"===this._projections.map.getAxisOrientation().substr(0,2)?[l[1],l[0],l[3],l[2]]:l);return n.BBOX=p.join(","),n},e.query=function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred(),n=this._layer.getInfoFormat()||"application/vnd.ogc.gml",i=this._layer.getProjection(),i=(this._projections.map=this._layer.getMapProjection()||i,e.layers),a=void 0===i?[this._layer]:i,i=e.feature_count,i=void 0===i?10:i,o=e.size,o=void 0===o?_:o,s=e.coordinates,s=void 0===s?[]:s,l=e.resolution,e=e.query_point_tolerance,u=a[0],c=u.getQueryUrl(),d=u.isExternalWMS()||!/^\/ows/.test(c)?"GET":u.getOwsMethod(),i=this._getRequestParameters({layers:a,feature_count:i,coordinates:s,infoFormat:n,query_point_tolerance:e,resolution:l,size:o}),p={coordinates:s,resolution:l},f=this.getQueryResponseTimeoutKey({layers:a,resolve:r.resolve,query:p});return u.useProxy()?u.getDataProxyFromServer("wms",{url:c,params:i,method:d,headers:{"Content-Type":n}}).then(function(e){e=t.handleQueryResponseFromServer(e,t._projections,a);r.resolve({data:e,query:p})}):this[d]({url:c,layers:a,params:i}).then(function(e){e=t.handleQueryResponseFromServer(e,t._projections,a);r.resolve({data:e,query:p})}).catch(function(e){return r.reject(e)}).finally(function(){return clearTimeout(f)}),r.promise()},e.GET=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.url,e=e.params,r=t.split("SOURCE");return r.length&&(t=r[0],r=1<r.length?"&SOURCE"+r[1]:""),t=o(t,e),s.get({url:t=""+t+r})},e.POST=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.url,e=e.params;return s.post({url:t,data:e})},t.exports=l},{constant:4,"core/layers/providers/provider":50,"core/utils/geo":64,"core/utils/ol":66,"core/utils/utils":68,"store/application-state":373}],55:[function(e,t,r){var n=e("core/utils/utils"),i=n.inherit,a=n.base;function o(){a(this),this._name="xml"}i(o,e("core/layers/providers/provider")),o.prototype.getData=function(){return $.Deferred().promise()},t.exports=o},{"core/layers/providers/provider":50,"core/utils/utils":68}],56:[function(e,t,r){var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=e("app/constant"),i=s(e("store/catalog-layers")),o=s(e("store/projects"));function s(e){return e&&e.__esModule?e:{default:e}}var l=e("core/utils/utils"),u=l.base,l=l.inherit,c=e("core/layers/layer"),d=e("core/editing/editor"),p=e("core/layers/features/featuresstore"),f=e("core/layers/features/feature");function h(){var i=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.setters={clearFeatures:function(){this._clearFeatures()},addFeature:function(e){this._addFeature(e)},deleteFeature:function(e){this._deleteFeature(e)},updateFeature:function(e){this._updateFeature(e)},setFeatures:function(e){this._setFeatures(e)},getFeatures:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred();return this._featuresstore.getFeatures(e).then(function(e){e.then(function(e){return t.emit("getFeatures",e),r.resolve(e)}).fail(function(e){return r.reject(e)})}).fail(function(e){return r.reject(e)}),r.promise()},commit:function(t){var r=this,n=$.Deferred();return this._featuresstore.commit(t).then(function(e){e.then(function(e){e&&e.result&&r.syncSelectionFilterFeatures(t),n.resolve(e)}).fail(function(e){return n.reject(e)})}).fail(function(e){n.reject(e)}),n.promise()},setColor:function(e){this._setColor(e)}},this.type=c.LayerTypes.TABLE,this._color=null,t.project=t.project||o.default.getCurrentProject(),this.layerId=e.id,e.urls=e.urls||{},e.editing={fields:[]},u(this,e,t),this._editatbleLayer,this.isEditable()&&(this.layerForEditing=new Promise(function(n,t){i.getEditingConfig().then(function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.vector,r=e.constraints,r=void 0===r?{}:r,e=e.capabilities,e=void 0===e?a.DEFAULT_EDITING_CAPABILITIES:e;i.config.editing.fields=t.fields,i.config.editing.format=t.format,i.config.editing.constraints=r,i.config.editing.capabilities=e,i.config.editing.style=t.style,i.config.editing.form={perc:null},i._setOtherConfigParameters(t),t.style&&i.setColor(t.style.color),i._editor=new d({layer:i}),n(i),i.setReady(!0)}).fail(function(e){t(i),i.setReady(!1)})}),this.state=n({},this.state,{editing:{started:!1,modified:!1,ready:!1}})),this._featuresstore=new p({provider:this.providers.data})}l(h,c);var g,e=h.prototype;e.syncSelectionFilterFeatures=function(e){try{var r=i.default.getLayerById(this.getId());r.isGeoLayer()&&e.update.forEach(function(e){var t=e.id,e=e.geometry;r.getOlSelectionFeature(t)&&r.updateOlSelectionFeature({id:t,geometry:e})}),e.delete.forEach(function(e){r.hasSelectionFid(e)&&r.excludeSelectionFid(e)})}catch(e){}},e.setFormPercentage=function(e){this.config.editing.form.perc=e},e.getFormPercentage=function(){return this.config.editing.form.perc},e.clone=function(){return _.cloneDeep(this)},e.cloneFeatures=function(){return this._featuresstore.clone()},e.setVectorUrl=function(e){this.vectorUrl=e},e.setProjectType=function(e){this.projectType=e},e._setColor=function(e){this._color=e},e.getColor=function(){return this._color},e.readFeatures=function(){return this._featuresstore.readFeatures()},e.getLayerForEditing=(g=regeneratorRuntime.mark(function e(){var t,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=r.vectorurl,i=r.project_type;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n&&this.setVectorUrl(n),i&&this.setProjectType(i),this.setEditingUrl(),t=this.clone(),e.prev=4,e.next=7,t.layerForEditing;case 7:return e.abrupt("return",e.sent);case 10:return e.prev=10,e.t0=e.catch(4),e.abrupt("return",e.t0);case 13:case"end":return e.stop()}},e,this,[[4,10]])}),function(){var s=g.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}),e.getEditingSource=function(){return this._editor.getEditingSource()},e.readEditingFeatures=function(){return this._editor.readEditingFeatures()},e.getEditingLayer=function(){return this},e.isEditingLayer=function(){return!!this.config.editing},e.getEditingStyle=function(){return this.config.editing.style},e.setEditingStyle=function(){this.config.editing.style=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}},e.getEditingConstrains=function(){return this.config.editing.constraints},e.getEditingCapabilities=function(){return this.config.editing.capabilities},e.isFieldRequired=function(t){var r=!1;return this.getEditingFields().forEach(function(e){if(t===e.name)return r=!!e.validate.required,!1}),r},e.unlock=function(){var t=$.Deferred();return this._featuresstore.unlock().then(function(){return t.resolve()}).fail(function(e){return t.reject(e)}),t.promise()},e._setOtherConfigParameters=function(e){},e.getEditingFields=function(){var e=(this.config.editing.fields.length?this.config.editing:this.config).fields;return e=0<arguments.length&&void 0!==arguments[0]&&arguments[0]?e.filter(function(e){return e.editable}):e},e.isPkField=function(t){var e=this.getEditingFields().find(function(e){return e.name===t});return e&&e.pk},e.isEditingFieldEditable=function(t){var e=this.getEditingFields().find(function(e){return e.name===t});return!!e&&e.editable},e.getEditingNotEditableFields=function(){return this.config.editing.fields.filter(function(e){return!e.editable}).map(function(e){return e.name})},e.getEditingMediaFields=function(){return this.config.editing.fields.filter(function(e){return"media"===e.input.type}).map(function(e){return e.name})},e.getFieldsLabel=function(){var t=[];return this.getEditingFields().forEach(function(e){return t.push(e.label)}),t},e.getDataFormat=function(){return this.config.editing.format},e.getEditingFormat=function(){return this.config.editing.format},e.isReady=function(){return this.state.editing.ready},e.setReady=function(){this.state.editing.ready=0<arguments.length&&void 0!==arguments[0]&&arguments[0]},e.getEditingConfig=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=$.Deferred();return this.getProvider("data").getConfig(e).then(function(e){return t.resolve(e)}).fail(function(e){return t.reject(e)}),t.promise()},e.addEditingConfigFieldOption=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.field,r=e.key,e=e.value,t=t.input.options;return t[r]=e,t[r]},e.getWidgetData=function(e){var t=this.getProvider("data"),r=$.Deferred();return t.getWidgetData(e).then(function(e){return r.resolve(e)}).fail(function(e){return r.reject(e)}),r.promise()},e.getCommitUrl=function(){return this.config.urls.commit},e.setCommitUrl=function(e){this.config.urls.commit=e},e.getEditingUrl=function(){return this.config.urls.editing},e.getUnlockUrl=function(){return this.config.url.unlock},e.setUnlockUrl=function(e){this.config.urls.unlock=e},e.getWidgetUrl=function(){return this.config.urls.widget},e.setDataUrl=function(e){this.config.urls.data=e},e.getDataUrl=function(){return this.config.urls.data},e.getConfigUrl=function(){return this.config.urls.config},e.setConfigUrl=function(e){this.config.urls.index=e},e.getEditor=function(){return this._editor},e.isStarted=function(){return this.getEditor().isStarted()},e.setEditor=function(e){this._editor=e},e.getFeaturesStore=function(){return this._featuresstore},e.setFeaturesStore=function(e){this._featuresstore=e},e.setSource=function(e){this.setFeaturesStore(e)},e.getSource=function(){return this._featuresstore},e.getEditingStyle=function(){return this.config.editing.style},e._setFeatures=function(e){this._featuresstore.setFeatures(e)},e.addFeatures=function(e){var t=this;e.forEach(function(e){return t.addFeature(e)})},e._addFeature=function(e){this._featuresstore.addFeature(e)},e._deleteFeature=function(e){return e.getId()},e._updateFeature=function(e){},e._clearFeatures=function(){this._featuresstore.clearFeatures()},e.addLockIds=function(e){this._featuresstore.addLockIds(e)},e.setFieldsWithValues=function(e,t){t=function t(e){var r={};return e.forEach(function(e){"child"===e.type?r[e.name]=t(e.fields):"null"===e.value&&(e.value=null),r[e.name]=e.value}),r}(t);return e.setProperties(t),t},e.getFieldsWithValues=function(e){var r=this,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.exclude,i=void 0===n?[]:n,n=t.get_default_value,a=void 0===n||n,t=JSON.parse(JSON.stringify(this.getEditingFields())),n=void 0;if(e instanceof f)n=e;else if(e instanceof ol.Feature)n=new f({feature:e});else{if(!e)return t;n=this.getFeatureById(e)}var o=n.getProperties();return t.forEach(function(t){var e;t.value=o[t.name],t._value=o[t.name],t.update=!1,t.input&&(e=r.getEditingFields().find(function(e){return e.name===t.name}).input.options,t.input.options.loading=e.loading||{state:null},t.input.options.values=e.values),t.visible=-1===i.indexOf(t.name),void 0===t.validate&&(t.validate={}),t.forceNull=!1,t.validate.valid=!0,t.validate._valid=!0,t.value_from_default_value=!1,t.get_default_value=a,t.validate.unique=t.validate.unique||!1,t.validate.exclude_values=new Set,t.validate.required=t.validate.required||!1,t.validate.mutually_valid=!0,t.validate.empty=!t.validate.required,t.validate.message=null}),t},e.createNewFeature=function(){var e=new ol.Feature,t={};return this.getEditingFields().forEach(function(e){return t[e.name]=null}),e.setProperties(t),(e=new f({feature:e})).setNew(),e},t.exports=h},{"app/constant":4,"core/editing/editor":6,"core/layers/features/feature":26,"core/layers/features/featuresstore":27,"core/layers/layer":34,"core/utils/utils":68,"store/catalog-layers":374,"store/projects":379}],57:[function(e,t,r){var n=e("core/utils/utils"),i=n.base,a=n.inherit,n=n.mixin,o=e("core/layers/layer"),s=e("core/layers/tablelayer"),l=e("core/layers/geolayermixin"),u=e("core/layers/map/vectorlayer");function c(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];i(this,e,t),this._mapLayer=null,this.type=o.LayerTypes.VECTOR,this.setup(e,t),this.onafter("setColor",function(e){})}a(c,s),n(c,l);e=c.prototype;e.getEditingLayer=function(){return this.getMapLayer().getOLLayer()},e.resetEditingSource=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];this.getMapLayer().resetSource(e)},e._setOtherConfigParameters=function(e){this.config.editing.geometrytype=e.geometrytype},e.getEditingGeometryType=function(){return this.config.editing.geometrytype},e.getMapLayer=function(){var e,t,r,n,i;return this._mapLayer||(e=this.getId(),t=this.getGeometryType(),r=this.getColor(),n=this.isEditingLayer()?this.getEditingStyle():this.getCustomStyle(),i=this.getProvider("data"),this._mapLayer=new u({id:e,geometryType:t,color:r,style:n,provider:i,features:this._editor&&this._editor.getEditingSource().getFeaturesCollection()})),this._mapLayer},t.exports=c},{"core/layers/geolayermixin":32,"core/layers/layer":34,"core/layers/map/vectorlayer":44,"core/layers/tablelayer":56,"core/utils/utils":68}],58:[function(e,t,r){var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=o(e("store/plugins")),n=o(e("store/projects")),a=o(e("services/application")),u=o(e("services/gui"));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}function c(){var e=this,t=void 0===(t=(s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).name)?null:t,r=void 0===(r=s.config)?l.default.getPluginConfig(t):r,n=void 0===(n=s.service)?null:n,i=void 0===(i=s.dependencies)?[]:i,a=void 0===(a=s.i18n)?null:a,o=void 0===(o=s.fontClasses)?[]:o,s=void 0===(s=s.api)?{}:s;f(this),this.setName(t),this.setConfig(r),this.setLocale(a),this.setService(n),this.setDependencies(i),this.addFontClasses(o),this.setApi(s),this.setHookService(null),this._ready=!1,this.hookservices={search:u.default.getService("search"),tools:u.default.getService("tools")},this._timeout=setTimeout(function(){l.default.removeLoadingPlugin(e.name,e._ready),e.removeLayout()},1e4)}var d,p=e("core/utils/utils"),f=p.base,h=p.inherit,g=p.toRawType,p=e("core/g3wobject"),v=e("gui/component/componentsfactory"),m=e("core/i18n/i18n.service").addI18nPlugin,e=(h(c,p),c.prototype);e.setName=function(e){this.name=e},e.getName=function(){return this.name},e.setConfig=function(e){this.config="Object"===g(e)?e:null},e.getConfig=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.name;return this.config||l.default.getPluginConfig(e)},e.setLocale=function(e){e&&this.name&&m({name:this.name,config:e})},e.setService=function(e){(this.service=e)&&e.setPlugin(this)},e.getService=function(){return this.service},e.setDependencies=function(e){this.dependencies=e},e.setApi=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};(this._api=e).getConfig=this._api.getConfig},e.getApi=function(){return this._api},e.setHookService=function(e){this._hook=e},e.getHookService=function(){return this.hookservices[0<arguments.length&&void 0!==arguments[0]?arguments[0]:"tools"]},e.setLayout=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:a.default.cloneLayout("app");a.default.setLayout(this.name,e)},e.setCurrentLayout=function(){a.default.setCurrentLayout(this.name)},e.removeLayout=function(){a.default.removeLayout(this.name)},e.setReady=function(e){var t=this;this._ready=e,this._ready&&this.setLayout(),this.emit("set-ready",e,this.name),setTimeout(function(){clearTimeout(t._timeout),l.default.removeLoadingPlugin(t.name,t._ready)},0)},e.isReady=function(){var r=this;return new Promise(function(t){r._ready?t(r._ready):r.once("set-ready",function(e){r._ready=e,t(r._ready)})})},e.isCurrentProjectCompatible=function(e){return e===n.default.getCurrentProject().getGid()},e.registerPlugin=function(e){e=this.isCurrentProjectCompatible(e);return e?l.default.registerPlugin(this):(l.default.removeLoadingPlugin(this.name,!1),clearTimeout(this._timeout)),e},e.getDependencyPlugins=function(e){var t=this;return this.dependencies=e||this.dependencies,Promise.all(this.dependencies.map(function(e){return t.getDependencyPlugin(e)}))},e.getDependencyPluginsObject=(d=s(regeneratorRuntime.mark(function e(t){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={},e.next=3,this.getDependencyPlugins(t);case 3:return n=e.sent,this.dependencies.forEach(function(e,t){return r[e]=n[t]}),e.abrupt("return",r);case 6:case"end":return e.stop()}},e,this)})),function(e){return d.apply(this,arguments)}),e.getDependencyPlugin=function(r){return l.default.isTherePlugin(r)?new Promise(function(t){var e=l.default.getPlugin(r);e&&e.isReady().then(function(){return t(e.getApi())})||l.default.onafter("registerPlugin",function(e){e.name===r&&e.isReady().then(function(){t(e.getApi())})})}):Promise.reject({error:"no plugin"})},e.setHookLoading=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.hook,e=e.loading,e=void 0!==e&&e;this.getHookService(void 0===t?"tools":t).setLoading(e)},e.addToolGroup=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.hook,r=e.position,e=e.title;this.getHookService(void 0===t?"tools":t).addToolGroup(r,e)},e.removeToolGroup=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.hook,e=e.group;this.getHookService(t).removeToolGroup(e.title)},e.addTools=function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.hook,r=void 0===r?"tools":r,n=e.action,i=e.html,a=e.offline,o=void 0===a||a,s=e.icon,l=e.name,u=e.type,a=e.options,c=void 0===a?{}:a,a=e.loading,d=void 0!==a&&a,a=e.disabled,p=void 0!==a&&a,a=e.state,f=void 0===a?{type:null,message:null}:a,e=arguments[1];return n||u?(this.setHookService(r),a=(this.config.configs||[this.config]).map(function(e){return{icon:s,type:u,name:e.name||l,html:i,loading:d,disabled:p,options:c,offline:o,action:n&&n.bind(t,e),state:f}}),this.getHookService(r).addTools(a,e),a):(this.removeToolGroup({hook:r,group:e}),[])},e.setToolState=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,e=e.state;this.hookservices[this._hook].setToolState({id:t,state:void 0===e?{type:null,message:null}:e})},e.removeTools=function(){this.hookservices[this._hook].removeTools()},e.createSideBarComponent=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:(id=(n={}).id,title=n.title,open=void 0!==(r=n.open)&&r,collapsible=void 0===(r=n.collapsible)||r,mobile=void 0===(r=n.mobile)||r,isolate=void 0!==(r=n.isolate)&&r,closewhenshowviewportcontent=void 0===(r=n.closewhenshowviewportcontent)||r,iconConfig=void 0===(r=n.iconConfig)?{}:r,events=void 0===(r=n.events)?{}:r,sidebarOptions=void 0===(r=n.sidebarOptions)?{position:1}:r,n),r=i({},t,{iconColor:t.iconConfig.color,icon:u.default.getFontClass(t.iconConfig.icon)}),n=(delete r.iconConfig,v.build({vueComponentObject:e},r));return u.default.addComponent(n,"sidebar",t.sidebarOptions),this.once("unload",function(){return u.default.removeComponent(id,"sidebar",t.sidebarOptions)}),n},e.unload=function(){this.service&&this.service.clearAllEvents(),this.emit("unload")},e.load=function(){},e.getProject=function(){return n.default.getCurrentProject()},e.addDependency=function(e){this.dependencies.push(e)},e.addFontClass=function(e){var t=e.name,e=e.className;Vue.prototype.g3wtemplate.addFontClass({name:t,className:e})},e.addFontClasses=function(){var t=this;(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(e){return t.addFontClass(e)})},t.exports=c},{"core/g3wobject":12,"core/i18n/i18n.service":13,"core/utils/utils":68,"gui/component/componentsfactory":118,"services/application":351,"services/gui":361,"store/plugins":378,"store/projects":379}],59:[function(e,t,r){var n=a(e("store/application-state")),i=a(e("services/application"));function a(e){return e&&e.__esModule?e:{default:e}}var o=e("core/utils/utils"),s=o.base;function l(){var t=this;s(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),this.plugin,this._api={own:null,dependencies:{}},this._pluginEvents={},this._appEvents=[],this.currentLayout=i.default.getCurrentLayoutName(),this.vm=new Vue,this.unwatch=this.vm.$watch(function(){return n.default.gui.layout.__current},function(e){return t.currentLayout=e!==t.getPlugin().getName()?e:t.currentLayout})}(0,o.inherit)(l,e("core/g3wobject"));o=l.prototype;o.init=function(){this.config=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}},o.setCurrentLayout=function(){i.default.setCurrentLayout(this.getPlugin().getName())},o.resetCurrentLayout=function(){i.default.setCurrentLayout(this.currentLayout)},o.setPlugin=function(e){this.plugin=e},o.getPlugin=function(){return this.plugin},o.isIframe=function(){return i.default.isIframe()},o.getCurrentProject=function(){return i.default.getCurrentProject()},o.getGid=function(){var e=this.config.gid;return e&&e.split(":")[1]},o.getConfig=function(){return this.config},o.setConfig=function(e){this.config=e},o.setApi=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.dependency,e=e.api;t?this._api.dependencies[t]=e:this._api.own=e},o.getApi=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).dependency;return e&&this._api.dependencies[e]||this._api.own},o.initEvents=function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];for(e in t){var r=t[e];this._pluginEvents[r]={}}},o.registerWindowEvent=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.evt,e=e.cb;i.default.registerWindowEvent({evt:t,cb:e})},o.unregisterWindowEvent=function(e){var t=e.evt,e=e.cb;i.default.unregisterWindowEvent({evt:t,cb:e})},o.subscribeEvent=function(e){var t=e.name,r=e.once,r=void 0!==r&&r,n=e.owner,e=e.listener;this._pluginEvents[t]=this._pluginEvents[t]||{},this._pluginEvents[t][n]=e,r?this.once(t,e):this.on(t,e)},o.triggerEvent=function(e){var t=e.name,e=e.params;this.emit(t,void 0===e?{}:e)},o.unsubscribeEvent=function(e){var t=e.name,e=e.owner,r=this._pluginEvents[t][e];this.removeEvent(t,r),delete this._pluginEvents[t][e]},o.unsubscribeAllEvents=function(){for(var e in this._pluginEvents)this.removeEvent(e),delete this._pluginEvents[e]},o.clearAllEvents=function(){this.unsubscribeAllEvents(),this.unwatch(),this.vm=null,this._pluginEvents=null},o.loadPlugin=function(){return!0},o.clear=function(){},t.exports=l},{"core/g3wobject":12,"core/utils/utils":68,"services/application":351,"store/application-state":373}],60:[function(e,t,r){var p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=i(e("store/application-state")),n=i(e("store/projects"));function i(e){return e&&e.__esModule?e:{default:e}}var a=e("core/utils/utils"),o=a.base,s=a.inherit,l=a.convertObjectToUrlParams,a=e("core/g3wobject"),u={pdf:"application/pdf",jpg:"image/jpeg"},h={SERVICE:"WMS",VERSION:"1.3.0"};function c(){var t=this;this._currentLayerStore=n.default.getCurrentProject().getLayersStore(),n.default.onbefore("setCurrentProject",function(e){return t._currentLayerStore=e.getLayersStore()}),o(this)}s(c,a);e=c.prototype;e.POST=function(e){var i=e.url,a=e.params,o=e.mime_type;return new Promise(function(t,r){var n=new XMLHttpRequest;n.open("POST",i,!0),n.responseType="blob",n.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),n.onload=function(){if(200===n.status)try{window.URL=window.URL||window.webkitURL;var e=window.URL.createObjectURL(n.response);t({url:e,layers:!0,mime_type:o})}catch(e){r(e)}else 500===n.status&&r()},n.onerror=function(){r()},n.send(l(a))})},e.GET=function(e){var r=e.url,n=e.params,i=e.mime_type;return new Promise(function(e,t){e({url:r=r+"?"+l(n),layers:!0,mime_type:i})})},e._getAtlasParamsFromOptions=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.field,r=e.values,n=e.template,e=e.download,e=void 0!==e&&e,i=1<r.length,t=t+(i?" IN (":"=")+r.map(function(e){return"'"+e+"'"}).join()+(i?")":""),r=p({},h,{REQUEST:"GetPrintAtlas",EXP_FILTER:t,TEMPLATE:n,filtertoken:f.default.tokens.filtertoken});return e&&(r.DOWNLOAD=1),r},e._getParamsFromOptions=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=t.rotation,r=t.dpi,n=t.format,a=t.crs,o=t.template,s=t.maps,s=void 0===s?[]:s,l=t.labels,l=void 0===l?[]:l,u=t.is_maps_preset_theme,c=e.map(function(e){return e.getPrintLayerName()}).join(),t=e.map(function(e){return e.getStyle()}).join(","),d=p({},h,{REQUEST:"GetPrint",TEMPLATE:o,DPI:r,STYLES:t,FORMAT:n,CRS:a,filtertoken:f.default.tokens.filtertoken});return u||(d.LAYERS=c),s.forEach(function(e){var t=e.name,r=e.scale,n=e.extent,e=e.preset_theme;d[t+":SCALE"]=r,d[t+":EXTENT"]=n,d[t+":ROTATION"]=i,u&&void 0===e&&(d[t+":LAYERS"]=c)}),l.forEach(function(e){return d[e.id]=e.text}),d},e.getUrl=function(){return this._currentLayerStore.getWmsUrl()},e.printAtlas=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"GET",r=this.getUrl(),e=this._getAtlasParamsFromOptions(e);return this[t]({url:r,params:e,mime_type:u.pdf})},e.print=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"GET",r=this.getUrl(),n=this._currentLayerStore.getLayers({PRINTABLE:{scale:e.scale},SERVERTYPE:"QGIS"}).reverse();return n.length?(e.crs=this._currentLayerStore.getProjection().getCode(),n=this._getParamsFromOptions(n,e),e=u[n.FORMAT],this[t]({url:r,params:n,mime_type:e})):Promise.resolve({layers:!1})},t.exports=c},{"core/g3wobject":12,"core/utils/utils":68,"store/application-state":373,"store/projects":379}],61:[function(e,t,r){var n=e("app/constant"),a=i(e("store/application-state")),o=i(e("services/application"));function i(e){return e&&e.__esModule?e:{default:e}}function s(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}function l(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var u=e("core/utils/utils"),c=u.base,d=u.inherit,p=u.XHR,f=e("core/utils/geo").crsToCrsObject,u=e("core/g3wobject"),h=e("core/layers/layerfactory"),g=e("core/layers/layersstore"),v=e("g3w-ol/projection/projections");function m(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=(e.catalog_tab=e.toc_tab_default||e._catalog_tab||"layers",e.ows_method=e.ows_method||"GET",e.toc_layers_init_status=e.toc_layers_init_status||n.TOC_LAYERS_INIT_STATUS,e.toc_themes_init_status=e.toc_themes_init_status||n.TOC_THEMES_INIT_STATUS,e.query_point_tolerance=e.query_point_tolerance||n.QUERY_POINT_TOLERANCE,this.state=e,this.getType()),t=this.getId(),r=this.getVectorUrl();this.urls={map_themes:"/"+e+"/api/prjtheme/"+t+"/",expression_eval:"/api/expression_eval/"+t+"/",vector_data:r+"data/"+e+"/"+t+"/",featurecount:r+"featurecount/"+e+"/"+t+"/"},this._processLayers(),this.state.crs=f(this.state.crs),this._projection=v.get(this.state.crs),this._layersStore=this._buildLayersStore(),this.setters={setBaseLayer:function(t){var r=this;this.state.baselayers.forEach(function(e){r._layersStore.getLayerById(e.id).setVisible(e.id===t),e.visible=e.id===t})}},this.setSearchEndPoint(),c(this)}d(m,u);var y,_,b,e=m.prototype;e.getSearchEndPoint=function(){return this.state.search_endpoint},e.setSearchEndPoint=function(){var t=this;(this.state.search||[]).forEach(function(e){return e.search_endpoint=t.state.search_endpoint})},e.getAliasUrl=function(){return this.state.aliasUrl},e.getActiveCatalogTab=function(){return this.state.catalog_tab},e.setActiveCatalogTab=function(){this.state.catalog_tab=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"layers"},e.isWmsUseLayerIds=function(){return this.state.wms_use_layer_ids},e.getContextBaseLegend=function(){return this.state.context_base_legend},e.getQueryPointTolerance=function(){return this.state.query_point_tolerance},e.getQueryFeatureCount=function(){return this.state.feature_count||5},e.isQueryMultiLayers=function(e){return this.state.querymultilayers&&-1!==this.state.querymultilayers.indexOf(e)},e.getRelations=function(){return this.state.relations},e.getRelationById=function(t){return this.state.relations.find(function(e){return e.id===t})},e.getRelationsByLayerId=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layerId,r=e.type;return this.state.relations.filter(function(e){return e.referencedLayer===t&&(!r||e.type===r)})},e.getOwsMethod=function(){return this.state.ows_method},e._processLayers=function(){var i=this,e=(function e(n){for(var t=0;t<n.length;t++)!function(t){var r=n[t];void 0!==r.id&&i.state.layers.forEach(function(e){if(e.name,r.id===e.id)return r.name=e.name,e.wmsUrl=i.getWmsUrl(),e.project=i,r[t]=Object.assign(e,r),!1}),Array.isArray(r.nodes)&&(r.title=r.name,e(r.nodes))}(t)}(this.state.layerstree),o.default.getBaseLayerId());this.state.baselayers=this.state.baselayers.filter(function(e){return"Bing"!==e.servertype||a.default.keys.vendorkeys.bing});for(var t=0;t<this.state.baselayers.length;t++){var r=this.state.baselayers[t],n=null!==e?e:this.state.initbaselayer;r.visible=n&&r.id===n||!!r.fixed,r.baselayer=!0}},e._buildLayersStore=function(){var t=this,r=new g,e=this.state.overviewprojectgid?this.state.overviewprojectgid.gid:null;return r.setOptions({id:this.state.gid,projection:this._projection,extent:this.state.extent,initextent:this.state.initextent,wmsUrl:this.state.WMSUrl,catalog:this.state.gid!==e}),this.getLayers().forEach(function(e){e.crs=f(e.crs),e.projection=e.crs?v.get(e.crs):t._projection,e.ows_method=t.getOwsMethod(),e.wms_use_layer_ids=t.state.wms_use_layer_ids;e=h.build(e,{project:t});e&&r.addLayer(e)}),r.createLayersTree(this.state.name,{layerstree:this.state.layerstree,expanded:"not_collapsed"===this.state.toc_layers_init_status}),r},e.getLayerById=function(e){return this._layersStore.getLayerById(e)},e.getLayers=function(){return[].concat(l(this.state.layers),l(this.state.baselayers))},e.getBaseLayers=function(){return this.state.baselayers},e.getConfigLayers=function(){var t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).key;return t?this.state.layers.filter(function(e){return void 0!==e[t]}):this.state.layers},e.setLegendPosition=function(){this.state.legend_position=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"tab"},e.getLegendPosition=function(){return this.state.legend_position},e.getThumbnail=function(){return this.state.thumbnail},e.getMetadata=function(){return this.state.metadata||{}},e.getState=function(){return this.state},e.getPrint=function(){return this.state.print||[]},e.getSearches=function(){return this.state.search||[]},e.getVectorUrl=function(){return this.state.vectorurl},e.getRasterUrl=function(){return this.state.rasterurl},e.getId=function(){return this.state.id},e.getType=function(){return this.state.type},e.getGid=function(){return this.state.gid},e.getName=function(){return this.state.name},e.getOverviewProjectGid=function(){return this.state.overviewprojectgid?this.state.overviewprojectgid.gid:null},e.getCrs=function(){return this._projection.getCode()},e.getQgisVersion=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).type,e=["major","minor","patch"].indexOf(e);return-1===e?this.state.qgis_version:+this.state.qgis_version.split(".")[e]},e.getProjection=function(){return this._projection},e.getWmsUrl=function(){return this.state.WMSUrl},e.getInfoFormat=function(){return"application/vnd.ogc.gml"},e.getLayersStore=function(){return this._layersStore},e.setLayersTreePropertiesFromMapTheme=(y=s(regeneratorRuntime.mark(function e(t){var a,r,o,s,l,u=this,n=t.map_theme,t=t.layerstree,i=void 0===t?this.state.layerstree:t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMapThemeFromThemeName(n);case 2:return a=e.sent,r=a.layerstree,o={layers:{}},s=[],l=[],function t(e,r,i){e.forEach(function(n,e){n.nodes?(l.push({node:n,group:r[e]}),t(n.nodes,r[e].nodes,i&&n.checked)):(n.style=a.styles[n.id],r[e].checked!==n.visible&&(o.layers[n.id]={visibility:!0,style:!1}),r[e].checked=n.visible,n.style&&(e=new Promise(function(t,e){function r(e){void 0===o.layers[e.id]&&(o.layers[e.id]={visibility:!1,style:!1}),o.layers[e.id].style=u.getLayerById(e.id).setCurrentStyle(e.style),t()}u.getLayersStore()&&r(n)}),s.push(e)))})}(r,i),e.next=11,Promise.allSettled(s);case 11:return l.forEach(function(e){var t=e.group,e=e.node,r=e.checked,e=e.expanded;t.checked=r,t.expanded=e}),e.abrupt("return",o);case 13:case"end":return e.stop()}},e,this)})),function(e){return y.apply(this,arguments)}),e.getMapThemeFromThemeName=(_=s(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=this.state.map_themes.find(function(e){return e.theme===t}))&&void 0===r.layerstree)return e.next=4,this.getMapThemeConfiguration(t);e.next=5;break;case 4:r.layerstree=e.sent;case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}},e,this)})),function(e){return _.apply(this,arguments)}),e.getMapThemeConfiguration=(b=s(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.get({url:""+this.urls.map_themes+t+"/"});case 3:if((r=e.sent).result)return e.abrupt("return",r.data);e.next=6;break;case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0);case 11:case"end":return e.stop()}},e,this,[[0,8]])})),function(e){return b.apply(this,arguments)}),e.getUrl=function(e){return this.urls[e]},e.getSpatialBookmarks=function(){return this.state.bookmarks||[]},e.getMessages=function(){return this.state.messages},t.exports=m},{"app/constant":4,"core/g3wobject":12,"core/layers/layerfactory":35,"core/layers/layersstore":36,"core/utils/geo":64,"core/utils/utils":68,"g3w-ol/projection/projections":111,"services/application":351,"store/application-state":373}],62:[function(e,t,r){var n=e("core/utils/utils"),i=n.base;function a(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=Date.now(),r=e.id||"id_"+t,n=e.name||"name_"+t,t=e.origname||"origname_"+t;this.state={id:r,name:n,origname:t,father:e.referencedLayer,child:e.referencingLayer,fatherField:e.fieldRef.referencedField,childField:e.fieldRef.referencingField,type:e.type,loading:!1},i(this)}(0,n.inherit)(a,e("core/g3wobject"));n=a.prototype;n.getId=function(){return this.state.id},n.setId=function(e){this.state.id=e},n.getName=function(){return this.state.name},n.setName=function(e){this.state.name=e},n.getTitle=function(){return this.state.title},n.setTitle=function(e){return this.state.title=e},n.getChild=function(){return this.state.child},n.getFather=function(){return this.state.father},n.getState=function(){return this.state},n.getType=function(){return this.state.type},n.getFields=function(){return{father:this.state.fatherField,child:this.state.childField}},n.getFatherField=function(){return this.state.fatherField},n.getChildField=function(){return this.state.childField},n.setLoading=function(){this.state.loading=0<arguments.length&&void 0!==arguments[0]&&arguments[0]},n.isLoading=function(){return this.state.loading},t.exports=a},{"core/g3wobject":12,"core/utils/utils":68}],63:[function(e,t,r){var a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},n=e("core/utils/utils"),i=n.base,n=n.inherit,o=e("core/g3wobject"),s=e("core/relations/relation");function l(){var t=this,e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).relations,r=(this._relations={},this._length=e?e.length:0,this._relationsInfo={children:{},fathers:{},father_child:{}},void 0);e.forEach(function(e){r=new s(e),t._relations[r.getId()]=r}),this._createRelationsInfo(),i(this)}n(l,o);e=l.prototype;e._createRelationsInfo=function(){var r,n,i=this;Object.entries(this._relations).forEach(function(e){var e=a(e,2),t=e[0],e=e[1];r=e.getFather(),n=e.getChild(),i._relationsInfo.father_child[r+n]=t,i._relationsInfo.fathers[r]||(i._relationsInfo.fathers[r]=[]),i._relationsInfo.children[n]||(i._relationsInfo.children[n]=[]),i._relationsInfo.fathers[r].push(n),i._relationsInfo.children[n].push(r)})},e._clearRelationsInfo=function(){this._relationsInfo={children:{},fathers:{},father_children:{}}},e._reloadRelationsInfo=function(){this._clearRelationsInfo(),this._createRelationsInfo()},e.getLength=function(){return this._length},e.getRelations=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).type,t=void 0===e?null:e;if(t){if(-1===["ONE","MANY"].indexOf(t))return{};var r,n={};for(r in this._relations){var i=this._relations[r];i.getType()===t&&(n[r]=i)}return n}return this._relations},e.getArray=function(){var t=[];return Object.entries(this._relations).forEach(function(e){e=a(e,2),e[0],e=e[1];t.push(e)}),t},e.setRelations=function(e){this._relations=Array.isArray(e)?e:[]},e.getRelationById=function(e){return this._relations[e]},e.getRelationByFatherChildren=function(e,t){e=this._relationsInfo.father_child[e+t];return this.getRelationById(e)},e.addRelation=function(e){e instanceof s&&(this._relations[e.getId()]=e,this._reloadRelationsInfo())},e.removeRelation=function(e){e instanceof s&&(e=e.getId(),delete this._relations[e],this._reloadRelationsInfo())},e.hasChildren=function(e){e=this.getChildren(e);return!!e&&!!e.length},e.hasFathers=function(e){e=this.getFathers(e);return!!e&&!!e.length},e.getChildren=function(e){return this.isFather(e)?this._relationsInfo.fathers[e]:null},e.getFathers=function(e){return this.isChild(e)?this._relationsInfo.children[e]:null},e.isChild=function(e){return!!this._relationsInfo.children[e]},e.isFather=function(e){return!!this._relationsInfo.fathers[e]},t.exports=l},{"core/g3wobject":12,"core/relations/relation":62,"core/utils/utils":68}],64:[function(e,t,r){var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},n=s(e("app/constant")),o=s(e("store/map-layers")),w=s(e("services/gui"));function s(e){return e&&e.__esModule?e:{default:e}}function b(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function x(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var l,u,c=e("core/utils/utils"),d=c.toRawType,S=c.uniqueId,p=e("core/layers/map/wmslayer"),L=e("core/layers/filter/filter"),f=e("core/utils/parsers").response,C=n.default.GEOMETRY_FIELDS,k=n.default.QUERY_POINT_TOLERANCE,h=n.default.G3W_FID,g=n.default.GEOMETRY_TYPES,v={GeometryTypes:g,removeZValueToOLFeatureGeometry:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).feature,t=e.getGeometry();if(t){var r=t.getType(),n=t.getCoordinates();switch(r){case g.POINT:3===n.length&&(n.splice(2),e.getGeometry().setCoordinates(n));break;case g.MULTIPOINT:case g.LINESTRING:case g.LINE:n.forEach(function(e){return e.splice(2)}),e.getGeometry().setCoordinates(n);break;case g.MULTILINESTRING:case g.MULTILINE:n.forEach(function(e){e.forEach(function(e){return e.splice(2)})}),e.getGeometry().setCoordinates(n);break;case g.POLYGON:n[0].forEach(function(e){return e.splice(2)}),e.getGeometry().setCoordinates(n);break;case g.MULTIPOLYGON:n.forEach(function(e){e[0].forEach(function(e){return e.splice(2)})}),e.getGeometry().setCoordinates(n)}}return e},addZValueToOLFeatureGeometry:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.feature,e=e.geometryType,r=t.getGeometry(),e=e||r.getType(),n=r.getCoordinates();switch(e){case g.POINTZ:case g.POINTM:case g.POINTZM:case g.POINT25D:n.push(0),t.getGeometry().setCoordinates(n);break;case g.MULTIPOINTZ:case g.MULTIPOINTM:case g.MULTIPOINTZM:case g.MULTIPOINT25D:case g.LINESTRINGZ:case g.LINESTRINGM:case g.LINESTRINGZM:case g.LINESTRING25D:case g.LINEZ:case g.LINEM:case g.LINEZM:case g.LINE25D:n.forEach(function(e){return e.push(0)}),t.getGeometry().setCoordinates(n);break;case g.MULTILINESTRINGZ:case g.MULTILINESTRINGM:case g.MULTILINESTRINGZM:case g.MULTILINESTRING25D:case g.MULTILINEZ:case g.MULTILINEM:case g.MULTILINEZM:case g.MULTILINE25D:n.forEach(function(e){e.forEach(function(e){return e.push(0)})}),t.getGeometry().setCoordinates(n);break;case g.POLYGONZ:case g.POLYGONM:case g.POLYGONZM:case g.POLYGON25D:n[0].forEach(function(e){return e.push(0)}),t.getGeometry().setCoordinates(n);break;case g.MULTIPOLYGONZ:case g.MULTIPOLYGONM:case g.MULTIPOLYGOZM:case g.MULTIPOLYGON25D:n.forEach(function(e){e[0].forEach(function(e){return e.push(0)})}),t.getGeometry().setCoordinates(n)}return t},getOLGeometry:function(e){switch(e){case g.LINESTRINGZ:case g.LINESTRINGM:case g.LINESTRINGZM:case g.LINESTRING25D:case g.LINE:case g.LINEZ:case g.LINEM:case g.LINEZM:case g.LINE25D:e="LineString";break;case g.MULTILINESTRINGZ:case g.MULTILINESTRINGM:case g.MULTILINESTRINGZM:case g.MULTILINESTRING25D:case g.MULTILINE:case g.MULTILINEZ:case g.MULTILINEM:case g.MULTILINEZM:case g.MULTILINE25D:e="MultiLineString";break;case g.POINTZ:case g.POINTM:case g.POINTZM:case g.POINT25D:e="Point";break;case g.MULTIPOINTZ:case g.MULTIPOINTM:case g.MULTIPOINTZM:case g.MULTIPOINT25D:e="MultiPoint";break;case g.POLYGONZ:case g.POLYGONM:case g.POLYGONZM:case g.POLYGON25D:e="Polygon";break;case g.MULTIPOLYGONZ:case g.MULTIPOLYGONM:case g.MULTIPOLYGONZM:case g.MULTIPOLYGON25D:e="MultiPolygon"}return e},isMultiGeometry:function(e){return-1!==[g.MULTIPOINT,g.MULTIPOINTZ,g.MULTIPOINTZM,g.MULTIPOINTM,g.MULTIPOINT25D,g.MULTILINESTRING,g.MULTILINESTRINGZ,g.MULTILINESTRINGM,g.MULTILINESTRINGZM,g.MULTILINESTRING25D,g.MULTILINE,g.MULTILINEZ,g.MULTILINEM,g.MULTILINEZM,g.MULTILINE25D,g.MULTIPOLYGON,g.MULTIPOLYGONZ,g.MULTIPOLYGONM,g.MULTIPOLYGONZM,g.MULTIPOLYGON25D].indexOf(e)},getAllPointGeometryTypes:function(){return[g.POINT,g.POINTZ,g.POINTM,g.POINTZM,g.POINT25D,g.MULTIPOINT,g.MULTIPOINTZ,g.MULTIPOINTM,g.MULTIPOINTZM,g.MULTIPOINT25D]},isPointGeometryType:function(e){return-1!==v.getAllPointGeometryTypes().indexOf(e)},getAllLineGeometryTypes:function(){return[g.LINESTRING,g.LINESTRINGZ,g.LINESTRINGM,g.LINESTRINGZM,g.LINESTRING25D,g.MULTILINESTRING,g.MULTILINESTRINGZ,g.MULTILINESTRINGM,g.MULTILINESTRINGZM,g.MULTILINESTRING25D,g.LINE,g.LINEZ,g.LINEM,g.LINEZM,g.LINE25D,g.MULTILINE,g.MULTILINEZ,g.MULTILINEM,g.MULTILINEZM,g.MULTILINE25D]},isLineGeometryType:function(e){return-1!==v.getAllLineGeometryTypes().indexOf(e)},getAllPolygonGeometryTypes:function(){return[g.POLYGON,g.POLYGONZ,g.POLYGONM,g.POLYGONZM,g.POLYGON25D,g.MULTIPOLYGON,g.MULTIPOLYGONZ,g.MULTIPOLYGONM,g.MULTIPOLYGONZM,g.MULTIPOLYGON25D]},isPolygonGeometryType:function(e){return-1!==v.getAllPolygonGeometryTypes().indexOf(e)},is3DGeometry:function(t){return[g.POINTZ,g.POINTM,g.POINTZM,g.POINT25D,g.LINESTRINGZ,g.LINESTRINGM,g.LINESTRINGZM,g.LINESTRING25D,g.MULTILINESTRINGZ,g.MULTILINESTRINGM,g.MULTILINESTRINGZM,g.MULTILINESTRING25D,g.LINEZ,g.LINEM,g.LINEZM,g.LINE25D,g.MULTILINEZ,g.MULTILINEM,g.MULTILINEZM,g.MULTILINE25D,g.POLYGONZ,g.POLYGONM,g.POLYGONZM,g.POLYGON25D,g.MULTIPOLYGONZ,g.MULTIPOLYGONM,g.MULTIPOLYGONZM,g.MULTIPOLYGON25D].find(function(e){return e===t})}},m={geometryFields:C,coordinatesToGeometry:function(e,t){var r=void 0;switch(e){case g.POLYGON:case g.POLYGONZ:case g.POLYGONM:case g.POLYGONZM:case g.POLYGON25D:r=ol.geom.Polygon;break;case g.MULTIPOLYGON:case g.MULTIPOLYGONZ:case g.MULTIPOLYGONM:case g.MULTIPOLYGONZM:case g.MULTIPOLYGON25D:r=ol.geom.MultiPolygon;break;case g.LINESTRING:case g.LINESTRINGZ:case g.LINESTRINGM:case g.LINESTRINGZM:case g.LINESTRING25D:case g.LINE:case g.LINEZ:case g.LINEM:case g.LINEZM:case g.LINE25D:r=ol.geom.LineString;break;case g.MULTILINE:case g.MULTILINEZ:case g.MULTILINEM:case g.MULTILINEZM:case g.MULTILINE25D:case g.MULTILINESTRING:case g.MULTILINESTRINGZ:case g.MULTILINESTRINGM:case g.MULTILINESTRINGZM:case g.MULTILINESTRING25D:r=ol.geom.MultiLineString;break;case g.POINT:case g.POINTZ:case g.POINTM:case g.POINTZM:case g.POINT25D:r=ol.geom.Point;break;case g.MULTIPOINT:case g.MULTIPOINTZ:case g.MULTIPOINTM:case g.MULTIPOINTZM:case g.MULTIPOINT25D:r=ol.geom.MultiPoint;break;default:r=ol.geom.Point}return new r(t)},getDefaultLayerStyle:function(e){var t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).color;switch(e){case g.LINESTRINGZ:case g.LINESTRINGM:case g.LINESTRINGZM:case g.LINESTRING25D:case g.LINE:case g.LINEZ:case g.LINEM:case g.LINEZM:case g.LINE25D:e="LineString";break;case g.MULTILINESTRINGZ:case g.MULTILINESTRINGM:case g.MULTILINESTRINGZM:case g.MULTILINESTRING25D:case g.MULTILINE:case g.MULTILINEZ:case g.MULTILINEM:case g.MULTILINEZM:case g.MULTILINE25D:e="MultiLineString";break;case g.POINTZ:case g.POINTM:case g.POINTZM:case g.POINT25D:e="Point";break;case g.MULTIPOINTZ:case g.MULTIPOINTM:case g.MULTIPOINTZM:case g.MULTIPOINT25D:e="MultiPoint";break;case g.POLYGONZ:case g.POLYGONM:case g.POLYGONZM:case g.POLYGON25D:e="Polygon";break;case g.MULTIPOLYGONZ:case g.MULTIPOLYGONM:case g.MULTIPOLYGONZM:case g.MULTIPOLYGON25D:e="MultiPolygon"}return{Point:new ol.style.Style({image:new ol.style.Circle({fill:new ol.style.Fill({color:t}),radius:5,stroke:new ol.style.Stroke({color:t,width:1})})}),LineString:new ol.style.Style({stroke:new ol.style.Stroke({color:t,width:3})}),Polygon:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255,255,255,0.5)"}),stroke:new ol.style.Stroke({color:t,width:3})}),MultiPoint:new ol.style.Style({image:new ol.style.Circle({fill:new ol.style.Fill({color:t}),radius:5,stroke:new ol.style.Stroke({color:t,width:1})})}),MultiLineString:new ol.style.Style({stroke:new ol.style.Stroke({color:t,width:3})}),MultiPolygon:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255,255,255,0.5)"}),stroke:new ol.style.Stroke({color:t,width:3})})}[e]},createLayerStyle:function(e){var t=void 0,n={};return e&&(Object.entries(e).forEach(function(e){var e=a(e,2),t=e[0],r=e[1];switch(t){case"point":r.icon&&(n.image=new ol.style.Icon({src:r.icon.url,imageSize:r.icon.width}));break;case"line":n.stroke=new ol.style.Stroke({color:r.color,width:r.width});break;case"polygon":n.fill=new ol.style.Fill({color:r.color})}}),t=new ol.style.Style(n)),t},createFeatureFromCoordinates:function(e){var t=void 0;return Array.isArray(e)&&2===e.length&&(e=new ol.geom.Point(e),t=new ol.Feature(e)),t},createFeatureFromBBOX:function(e){var t=void 0;return Array.isArray(e)&&4===e.length&&(e=ol.geom.Polygon.fromExtent(e),t=new ol.Feature(e)),t},createFeatureFromGeometry:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,e=e.geometry;if(e)return(e=new ol.Feature(e)).setId(t),e},createFeatureFromFeatureObject:function(e){var t=e.id,e=e.feature,e=i=void 0===e?{}:e,r=e.geometry,n=e.attributes,i=m.createFeatureFromGeometry({id:t,geometry:r});return Object.keys(n).forEach(function(e){return i.set(e,n[e])}),i},createOlLayer:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.features,n=e.geometryType,i=e.color,a=e.style,e=e.source||new ol.source.Vector({features:r||new ol.Collection}),o=new ol.layer.Vector({id:t,source:e});if(!a)switch(n){case g.POINT:case g.POINTZ:case g.POINTM:case g.POINTZM:case g.POINT25D:case g.MULTIPOINT:case g.MULTIPOINTZ:case g.MULTIPOINTM:case g.MULTIPOINTZM:case g.MULTIPOINT25D:a=new ol.style.Style({image:new ol.style.Circle({radius:5,fill:new ol.style.Fill({color:i})})});break;case g.LINESTRING:case g.LINESTRINGZ:case g.LINESTRINGM:case g.LINESTRINGZM:case g.LINESTRING25D:case g.MULTILINESTRING:case g.MULTILINESTRINGZ:case g.MULTILINESTRINGM:case g.MULTILINESTRINGZM:case g.MULTILINESTRING25D:case g.LINE:case g.LINEZ:case g.LINEM:case g.LINEZM:case g.LINE25D:case g.MULTILINE:case g.MULTILINEZ:case g.MULTILINEM:case g.MULTILINEZM:case g.MULTILINE25D:a=new ol.style.Style({stroke:new ol.style.Stroke({width:3,color:i})});break;case g.POLYGON:case g.POLYGONZ:case g.POLYGONM:case g.POLYGONZM:case g.POLYGON25D:case g.MULTIPOLYGON:case g.MULTIPOLYGONZ:case g.MULTIPOLYGONM:case g.MULTIPOLYGONZM:case g.MULTIPOLYGON25D:a=new ol.style.Style({stroke:new ol.style.Stroke({color:"#000000",width:1}),fill:new ol.style.Fill({color:i})}),o.setOpacity(.6)}return o.setStyle(a),o},createWMSLayer:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.name,n=e.projection,e=e.layers,e=void 0===e?[]:e,i=r||S(),r=r||i,e=new p({id:i,layers:e,projection:n,url:t}),n=e.getOLLayer();return n.set("id",i),n.set("name",r),{wmslayer:e,olLayer:n}},createVectorLayerFromGeometry:function(e){e=new ol.Feature(e);return m.createVectorLayerFromFeatures(e)},createVectorLayerFromFeatures:function(e){return new ol.layer.Vector({source:new ol.source.Vector({features:Array.isArray(e)?e:[e]})})},createVectorLayerFromFile:(u=x(regeneratorRuntime.mark(function e(){var i,t,a,o,s,l,u,c,d,p,r,n,f=this,h=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},g=h.name,v=h.type,m=h.crs,y=h.mapCrs,_=h.data,b=h.style;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=i=void 0,a=function(e,t){var r,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:m,i=void 0,n=e.readFeatures(t,{dataProjection:n,featureProjection:y||n});return n.length&&(e instanceof ol.format.KML&&n.forEach(function(e){return e.unset("styleUrl")}),r=new ol.source.Vector({features:n}),i=new ol.layer.Vector({source:r,name:g,_fields:Object.keys(n[0].getProperties()).filter(function(e){return C.indexOf(e)<0}),id:S()}),b)&&i.setStyle(b),i},e.t0=v,e.next="gpx"===e.t0?6:"gml"===e.t0?9:"geojson"===e.t0?12:"kml"===e.t0?15:"csv"===e.t0?18:"kmz"===e.t0?28:"zip"===e.t0?39:50;break;case 6:return i=new ol.format.GPX,t=a(i,_),e.abrupt("break",50);case 9:return i=new ol.format.WMSGetFeatureInfo,t=a(i,_),e.abrupt("break",50);case 12:return i=new ol.format.GeoJSON,t=a(i,_),e.abrupt("break",50);case 15:return i=new ol.format.KML({extractStyles:!1}),t=a(i,_,"EPSG:4326"),e.abrupt("break",50);case 18:if(o=(r=_).headers,s=r.separator,l=r.values,u=r.x,c=r.y,d=[],p=[],l.forEach(function(e,t){var r,n={},e=e.split(s);e.length===o.length?(r=[],e.forEach(function(e,t){t=o[t];t===u&&(r[0]=+e),t===c&&(r[1]=+e),n[t]=e}),void 0===r.find(function(e){return Number.isNaN(e)})&&(e=new ol.geom.Point(r),m!==y&&e.transform(m,y),(e=new ol.Feature(e)).setId(t),e.setProperties(n),d.push(e))):p.push({row:t+1,value:l[t]})}),d.length){e.next=24;break}return e.abrupt("return",Promise.reject());case 24:return p.length&&w.default.showUserMessage({type:"warning",message:"sdk.mapcontrols.addlayer.messages.csv.warning",hooks:{footer:{template:'<select v-select2="errorrows[0].value" class="skin-color" :search="false" style="width:100%">\n                    <option v-for="errorrow in errorrows" :key="errorrow.row" :value="errorrow.value">[{{ errorrow.row}}] {{errorrow.value}}</option>\n                </select>',data:function(){return{errorrows:p}}}},autoclose:!1}),t=new ol.layer.Vector({source:new ol.source.Vector({features:d}),name:g,_fields:o,id:S()}),b&&t.setStyle(b),e.abrupt("break",50);case 28:return r=new Promise(function(){var r=x(regeneratorRuntime.mark(function e(t,r){var n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new JSZip,e.next=3,_.arrayBuffer(_);case 3:i=e.sent,n.load(i),i=n.file(/.kml$/i),(i=i[i.length-1])?(_=i.asText(),t(a(new ol.format.KML({extractStyles:!1}),_,"EPSG:4326"))):r();case 8:case"end":return e.stop()}},e,f)}));return function(e,t){return r.apply(this,arguments)}}()),e.prev=29,e.next=32,r;case 32:return e.abrupt("return",e.sent);case 35:return e.prev=35,e.t1=e.catch(29),e.abrupt("return",Promise.reject());case 38:return e.abrupt("break",50);case 39:return n=new Promise(function(){var r=x(regeneratorRuntime.mark(function e(t,r){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.arrayBuffer(_);case 2:n=e.sent,shp(n).then(function(e){e=JSON.stringify(e);i=new ol.format.GeoJSON({}),t(a(i,e,"EPSG:4326"))}).catch(function(e){return r(e)});case 4:case"end":return e.stop()}},e,f)}));return function(e,t){return r.apply(this,arguments)}}()),e.prev=40,e.next=43,n;case 43:return e.abrupt("return",e.sent);case 46:return e.prev=46,e.t2=e.catch(40),e.abrupt("return",Promise.reject());case 49:return e.abrupt("break",50);case 50:return e.abrupt("return",t);case 51:case"end":return e.stop()}},e,this,[[29,35],[40,46]])})),function(){return u.apply(this,arguments)}),createStyleFunctionToVectorLayer:function(){function e(e,t){var r=a.color,n=a.field,r=r.rgba?"rgba("+r.rgba.r+","+r.rgba.g+","+r.rgba.b+","+r.rgba.a+")":r,i=e.getGeometry().getType(),i=m.getDefaultLayerStyle(i,{color:r});return n&&i.setText(new ol.style.Text({text:""+e.get(n),font:"bold",scale:2,offsetY:15,fill:new ol.style.Fill({color:r}),stroke:new ol.style.Stroke({color:"#FFFFFF",width:2})})),i}var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e._g3w_options=a,e},createSelectedStyle:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.geometryType,r=e.color,r=void 0===r?"rgb(255,255,0)":r,e=e.fill,e=void 0===e||e,n=null;return"LineString"===t||"MultiLineString"===t?n=new ol.style.Style({stroke:new ol.style.Stroke({color:r,width:4})}):"Point"===t||"MultiPoint"===t?n=new ol.style.Style({image:new ol.style.Circle({radius:6,stroke:!e&&new ol.style.Stroke({color:r,width:4}),fill:e&&new ol.style.Fill({color:r})}),zIndex:1/0}):"MultiPolygon"!==t&&"Polygon"!==t||((t=ol.color.asArray(r)).splice(3,1,.5),n=new ol.style.Style({stroke:new ol.style.Stroke({color:r,width:4}),fill:e&&new ol.style.Fill({color:ol.color.asString(t)})})),n},getAlphanumericPropertiesFromFeature:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return(e=Array.isArray(e)?e:Object.keys(e)).filter(function(e){return-1===C.indexOf(e)})},getFormDataExpressionRequestFromFeature:function(t){delete t.attributes.geometry;var e=new ol.Feature(t.geometry),r={};return m.getAlphanumericPropertiesFromFeature(t.attributes).forEach(function(e){e!==h&&(r[e]=t.attributes[e])}),e.setProperties(r),e.setId(t.attributes[h]),m.convertFeatureToGEOJSON(e)},convertFeatureToGEOJSON:function(e){return(new ol.format.GeoJSON).writeFeatureObject(e)},getQueryLayersPromisesByBBOX:function(n,e){var i,a,o,s,l,t=e.bbox,r=e.filterConfig,u=void 0===r?{}:r,r=e.feature_count,c=void 0===r?10:r,r=e.multilayers,e=void 0!==r&&r,r=void 0,d=ol.geom.Polygon.fromExtent(t),t=w.default.getComponent("map").getService().getMap().getView().getProjection();return e?r=m.getQueryLayersPromisesByGeometry(n,{geometry:d,feature_count:c,filterConfig:u,multilayers:e,projection:t}):(i=$.Deferred(),a=t.getCode(),r=i.promise(),o=[],s=[],l=n.length,n.forEach(function(e){var t=new L(u),r=e.getProjection().getCode();t.setGeometry(a===r?d:d.clone().transform(a,r)),e.query({filter:t,feature_count:c}).then(function(e){o.push(e)}).fail(function(e){return s.push(e)}).always(function(){0===--l&&(s.length===n.length?i.reject(s):i.resolve(o))})})),r},getQueryLayersPromisesByGeometry:function(r){var n,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},t=e.multilayers,t=void 0!==t&&t,i=e.geometry,a=e.filterConfig,o=void 0===a?{}:a,a=e.projection,e=e.feature_count,s=void 0===e?10:e,l=$.Deferred(),u=[],c=[],d=a.getCode(),p=new L(o);if(t){r.length||l.resolve([]);var f,h=_.groupBy(r,function(e){return e.getMultiLayerId()+"_"+e.getProjection().getCode()}),g=Object.keys(h).length,v=g;for(f in h){var m=h[f],y=h[f][0],b=y.getProvider("filter"),y=y.getProjection().getCode();p.setGeometry(d===y?i:i.clone().transform(d,y)),b.query({filter:p,layers:m,feature_count:s}).then(function(e){return u.push(e)}).fail(function(e){return c.push(e)}).always(function(){0===--v&&(c.length===g?l.reject(c):l.resolve(u))})}}else 0===r.length?l.resolve([]):(n=r.length,r.forEach(function(e){var t=e.getProjection().getCode();p.setGeometry(d===t?i:i.clone().transform(d,t)),e.query({filter:p,filterConfig:o,feature_count:s}).then(function(e){return u.push(e)}).fail(function(e){return c.push(e)}).always(function(){0===--n&&(c.length===r.length?l.reject(c):l.resolve(u))})}));return l.promise()},getQueryLayersPromisesByCoordinates:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=e.coordinates,n=e.feature_count,i=void 0===n?10:n,n=e.query_point_tolerance,a=void 0===n?k:n,n=e.multilayers,n=void 0!==n&&n,e=e.reproject,o=void 0===e||e,s=$.Deferred();if(!t.length)return s.resolve(t);var e=w.default.getComponent("map").getService().getMap(),l=e.getSize(),u=[],c=[],d=e.getView().getProjection(),p=e.getView().getResolution();if(n){var f,h={},g=(t.forEach(function(e){var t=e.getInfoFormat()+":"+e.getInfoUrl()+":"+e.getMultiLayerId();h[t]?h[t].push(e):h[t]=[e]}),Object.keys(h).length),v=g;for(f in h){var m=h[f];h[f][0].getProvider("query").query({feature_count:i,coordinates:r,query_point_tolerance:a,mapProjection:d,reproject:o,resolution:p,size:l,layers:m}).then(function(e){return u.push(e)}).fail(function(e){return c.push(e)}).always(function(){0===--v&&(c.length===g?s.reject(c):s.resolve(u))})}}else{var y=t.length,_=0;t.forEach(function(e){e.query({feature_count:i,coordinates:r,query_point_tolerance:a,mapProjection:d,size:l,resolution:p}).then(function(e){u.push(e)}).fail(function(e){_+=1,c.push(e)}).always(function(){0===--y&&(_<t.length?s.resolve(u):s.reject(c))})})}return s.promise()},transformBBOX:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.bbox,r=e.sourceCrs,e=e.destinationCrs,n=new ol.geom.Point([t[0],t[1]]),t=new ol.geom.Point([t[2],t[3]]);return n.transform(r,e),t.transform(r,e),[].concat(b(n.getCoordinates()),b(t.getCoordinates()))},parseQueryLayersPromiseResponses:function(e){var t={query:e[0]?e[0].query:null,data:[]};return e.forEach(function(e){e.data&&e.data.forEach(function(e){t.data.push(e)})}),t},getMapLayerById:function(e){return o.default.getLayerById(e)},getMapLayersByFilter:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},t=i({GEOLAYER:!0},t),n=[];return o.default.getQuerableLayersStores().forEach(function(e){n=e.getLayers(t,r)}),n||[]},areCoordinatesEqual:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];return e[0]===t[0]&&e[1]===t[1]},getFeaturesFromResponseVectorApi:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).type;return e.result?(e=e.vector.data.features||[],"result"!==(void 0===t?"vector":t)?e:m.covertVectorFeaturesToResultFeatures(e)):null},covertVectorFeaturesToResultFeatures:function(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).map(function(e){var t=e.id,r=e.properties,e=e.geometry;return r[h]=t,{geometry:e,attributes:r,id:t}})},splitGeometryLine:function(e,t){var n=void 0!==t.getCoordinates()[0][2],r=!1,i=[],a=new jsts.io.WKTReader,o=new ol.format.WKT,s=new jsts.io.OL3Parser,l=a.read(o.writeGeometry(e)),e=o.writeGeometry(t);n&&(e=e.replace(" Z",""));for(var u=a.read(e).getCoordinates(),c=u.length,d=new jsts.geom.GeometryFactory,p=[],f=void 0,h=void 0,g=0;g<c-1;g++){h=u[g],f=u[g+1],n&&(h.z=t.getCoordinates()[g][2],f.z=t.getCoordinates()[g+1][2]);var v=d.createLineString([h,f]).intersection(l).getCoordinates(),p=(v.length&&(r=!0,v.forEach(function(e){var t,r;n&&(e.z=h.z),p.length?(r=s.write(d.createLineString(p.concat([h,e]))),n&&(t=r.getCoordinates(),r.setCoordinates([[].concat(b(t[0]),[h.z]),[].concat(b(t[1]),[e.z])])),i.push(r),p=[]):(t=s.write(d.createLineString([h,e])),n&&(r=t.getCoordinates(),t.setCoordinates([[].concat(b(r[0]),[h.z]),[].concat(b(r[1]),[e.z])])),i.push(t)),h=e})),p.concat([h,f]))}var m,y=s.write(d.createLineString(p));return n&&(m=[],p.forEach(function(e,t){t=y.getCoordinates()[t];t.push(e.z),m.push(t)}),y.setCoordinates(m)),i.push(y),r&&i||[]},splitFeatures:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.features,t=void 0===t?[]:t,r=e.splitfeature,n=[];return t.forEach(function(e){var t=m.splitFeature({feature:e,splitfeature:r});1<t.length&&n.push({uid:e.getUid(),geometries:t})}),n},splitFeature:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.feature,r=e.splitfeature,e={feature:t.getGeometry(),split:r.getGeometry()},t=e.split.getType(),n=e.feature.getType(),i=[],a=new jsts.io.OL3Parser;if("LineString"===t)if(-1!==n.indexOf("Polygon")){var o=-1!==n.indexOf("Multi"),s=o?e.feature.getPolygons():e.feature;if(Array.isArray(s))s.forEach(function(e){m.splitFeature({splitfeature:r,feature:new ol.Feature({geometry:e})}).forEach(function(e){e&&i.push(new ol.geom.MultiPolygon([e.getCoordinates()]))})});else{var l=void 0!==s.getCoordinates()[0][0][2],u=a.read(s),c=a.read(s.getLinearRing(0)),t=a.read(e.split),d=void 0;if(1<s.getLinearRingCount()){for(var p=void 0,f=1;f<s.getLinearRingCount();f++)var h=a.read(s.getLinearRing(f)),p=void 0===p?h:p.union(h);(d=new jsts.operation.polygonize.Polygonizer).add(p);var g=void 0;d.getPolygons().toArray().forEach(function(e){g=void 0===g?e:g.union(e)}),d=g}l&&(s.getCoordinates()[0].forEach(function(e,t){c.getCoordinates()[t].z=e[2]}),t.getCoordinates().forEach(function(e){return e.z=0}));var t=c.union(t),v=new jsts.operation.polygonize.Polygonizer,t=(v.add(t),v.getPolygons().toArray());1<t.length&&t.forEach(function(e){var t,r,n;d&&(e=e.difference(d)),u.intersects(e.getInteriorPoint())&&(t=a.write(e),r=e.getCoordinates(),l&&r.forEach(function(e,t){e.z=(void 0===e.z?r[0===t?t+1:t-1]:e).z}),l&&(n=[],t.getCoordinates()[0].forEach(function(e,t){e.push(r[t].z),n.push(e)}),t.setCoordinates([n])),e=t.getType(),o?i.push(new ol.geom.MultiPolygon("Polygon"===e?[t.getCoordinates()]:t.getCoordinates())):"Polygon"===e?i.push(t):t.getCoordinates().forEach(function(e){i.push(new ol.geom.Polygon(e))}))})}}else if(-1!==n.indexOf("LineString")){v=-1!==n.indexOf("Multi")?e.feature.getLineStrings():e.feature;if(!Array.isArray(v))return m.splitGeometryLine(e.split,e.feature);v.forEach(function(e){m.splitFeature({splitfeature:r,feature:new ol.Feature({geometry:e})}).forEach(function(e){e&&i.push(new ol.geom.MultiLineString([e.getCoordinates()]))})})}return i},getPointFeaturesfromGeometryVertex:function(e){var t=[];switch(e.getType()){case g.MULTIPOLYGON:e.getCoordinates().forEach(function(e){e.forEach(function(e){e.pop(),e.forEach(function(e){e=new ol.Feature(new ol.geom.Point(e));t.push(e)})})});break;case g.POLYGON:e.getCoordinates().forEach(function(e){e.pop(),e.forEach(function(e){e=new ol.Feature(new ol.geom.Point(e));t.push(e)})});break;case g.MULTILINESTRING:e.getCoordinates().forEach(function(e){e.forEach(function(e){e=new ol.Feature(new ol.geom.Point(e));t.push(e)})});break;case g.LINESTRING:e.getCoordinates().forEach(function(e){e.forEach(function(e){e=new ol.Feature(new ol.geom.Point(e));t.push(e)})});break;case g.MULTIPOINT:e.getCoordinates().forEach(function(e){e=new ol.Feature(new ol.geom.Point(e));t.push(e)});break;case g.POINT:var r=e.getCoordinates(),r=new ol.geom.Point(r);t.push(r)}return t},getVertexLength:function(e){var t=0;switch(e.getType()){case g.MULTIPOLYGON:e.getCoordinates().forEach(function(e){e.forEach(function(e){e.pop(),e.forEach(function(){return t+=1})})});break;case g.POLYGON:e.getCoordinates().forEach(function(e){e.pop(),e.forEach(function(){return t+=1})})}return t},isSameBaseGeometryType:function(e,t){return(e=e.replace("Multi",""))===(t=t.replace("Multi",""))},isSingleGeometry:function(e){return!v.isMultiGeometry(e.getType())},singleGeometriesToMultiGeometry:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=e[0]&&e[0].getType();return t&&new ol.geom["Multi"+t](e.map(function(e){return e.getCoordinates()}))},multiGeometryToSingleGeometries:function(e){var t=[];switch(e.getType()){case g.MULTIPOLYGON:t=e.getPolygons();break;case g.MULTILINE:case g.MULTILINESTRING:t=e.getLineStrings();break;case g.MULTIPOINT:t=e.getPoints()}return t},convertSingleMultiGeometry:function(e,t){var r=e.getType();if(t&&r!==t){r=v.isMultiGeometry(r),t=v.isMultiGeometry(t);if(r&&!t)return m.multiGeometryToSingleGeometries(e);if(!r&&t)return m.singleGeometriesToMultiGeometry([e])}return e},dissolve:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.features,r=void 0===t?[]:t,t=e.index,n=void 0===t?0:t,t=e.clone,i=void 0!==t&&t,a=new jsts.io.OL3Parser,o=r.length,s=void 0,l=void 0;switch(o){case 0:s=null;break;case 1:s=r[0];break;default:var u=s=i?r[n].clone():r[n],c=u.getGeometry(),d=c.getType();if("LineString"===d){for(var p=new jsts.operation.linemerge.LineMerger,f=0;f<o;f++){var h=r[f],h=a.read(h.getGeometry()).getCoordinates(),h=(new jsts.geom.GeometryFactory).createLineString(h);p.addLineString(h)}var g=p.getMergedLineStrings(),l=1===g.size()?g.toArray()[0]:null}else{l=a.read(c);for(var v,m=0;m<o;m++)n!==m&&(v=r[m],l=l.union(a.read(v.getGeometry())))}l&&(c=(c=(g=a.write(l)).getType())===d?g.getCoordinates():-1!==d.indexOf("Multi")&&c===d.replace("Multi","")?[g.getCoordinates()]:null)?u.getGeometry().setCoordinates(c):s=null}return s},within:function(e,t){var r=new jsts.io.OL3Parser,e=r.read(e);return r.read(t).within(e)},intersects:function(e,t){var r=new jsts.io.OL3Parser,e=r.read(e),r=r.read(t);return e.intersects(r)},findSelfIntersects:function(e){var e=(new jsts.io.OL3Parser).read(e);return!new jsts.operation.IsSimpleOp(e).isSimpleLinearGeometry(e)&&(e=new jsts.geomgraph.GeometryGraph(0,e),!new jsts.operation.valid.ConsistentAreaTester(e).isNodeConsistentArea()||void 0)},normalizeEpsg:function(e){return"number"==typeof e?"EPSG:"+e:""!==(e=e.replace(/[^\d\.\-]/g,""))?"EPSG:"+parseInt(e):void 0},crsToCrsObject:function(e){return null!=e&&("Object"===d(e)&&e.epsg?e.epsg=m.normalizeEpsg(e.epsg):e={epsg:m.normalizeEpsg(e),proj4:"",axisinverted:!1,geographic:!1}),e},ConvertDMToDEG:function(e){var t=e.dms,e=e.type,e="Array"===(void 0===e?"Array":e)?t:t.split(/[^\d\w\.]+/),t=+e[0],e=+e[1];return+(Number(t)+Number(e)/60).toFixed(6)},ConvertDEGToDM:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.deg,e=e.output,e=void 0===e?"Array":e,t=Math.abs(t),r=Math.floor(t),n=60*(t-r);switch(e){case"Array":return[r,n];case"Object":return{degrees:r,minutes:n};default:return r+"°"+n+"'"}},ConvertDMSToDEG:function(e){var t=e.dms,e=e.type,e="Array"===(void 0===e?"Array":e)?t:t.split(/[^\d\w\.]+/),t=+e[0],r=+e[1],n=+e[2],e=e[3],t=(Number(t)+Number(r)/60+Number(n)/3600).toFixed(6);return"S"!=e&&"W"!=e||(t*=-1),+t},ConvertDEGToDMS:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.deg,r=e.lat,n=e.lon,e=e.output,e=void 0===e?"Array":e,i=Math.abs(t),a=Math.floor(i),i=60*(i-a),o=Math.floor(i),s=(60*(i-o)).toFixed(2),l=n?0<=t?"E":"W":r?0<=t?"N":"S":void 0;switch(e){case"Array":return[a,o,s,l];case"Object":return{degrees:a,minutes:o,seconds:s,direction:l};default:return a+"°"+o+"'"+s+'"'+l}},getGeoTIFFfromServer:(l=x(regeneratorRuntime.mark(function e(){var t,r,n,i,a,o,s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.url,r=s.params,a=r.image,o=r.csrfmiddlewaretoken,r=r.bbox,n=s.method,n=void 0===n?"POST":n,(i=new FormData).append("image",a),i.append("csrfmiddlewaretoken",o),i.append("bbox",r),e.next=7,fetch(t,{method:n,body:i});case 7:return a=e.sent,e.next=10,a.blob();case 10:return o=e.sent,e.abrupt("return",o);case 12:case"end":return e.stop()}},e,this)})),function(){return l.apply(this,arguments)}),createOlFeatureFromApiResponseFeature:function(e){var t=e.properties,t=void 0===t?{}:t,r=e.geometry,e=e.id,r=(t[h]=e,new ol.Feature(r&&new ol.geom[r.type](r.coordinates)));return r.setProperties(t),r.setId(e),r},sanitizeFidFeature:function(e){return e="String"===d(e)&&Number.isNaN(+e)?2===(e=e.split(".")).length?e[1]:e[0]:e},parseAttributes:function(e,t){var r,n=Object.keys(t).filter(function(e){return-1===C.indexOf(e)});return e&&e.length?(r=Object.keys(t),e.filter(function(e){return-1<r.indexOf(e.name)})):n.map(function(e){return{name:e,label:e}})},handleQueryResponse:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.response,r=e.projections,n=e.layers,e=e.wms,e=void 0===e||e,i=(n=n||[this._layer])[0].getInfoFormat();return f.get(i)({response:t,projections:r,layers:n,wms:e})},distance:function(e,t){return Math.sqrt(geom.squaredDistance(e,t))},squaredDistance:function(e,t){var r=e[0],e=e[1],r=t[0]-r,t=t[1]-e;return r*r+t*t},closestOnSegment:function(e,t){var r=e[0],e=e[1],n=t[0],t=t[1],i=n[0],n=n[1],a=t[0],t=t[1],o=a-i,s=t-n,r=0==o&&0==s?0:(o*(r-i)+s*(e-n))/(o*o+s*s||0),e=void 0,l=void 0,l=r<=0?(e=i,n):1<=r?(e=a,t):(e=i+r*o,n+r*s);return[e,l]},get_LEGEND_ON_LEGEND_OFF_Params:function(n){var i=void 0,a=void 0;return n.getCategories()&&n.getCategories().forEach(function(e){var t=e.checked,r=e._checked,e=e.ruleKey;t!==r&&(t?(void 0===i?i=n.getWMSLayerName()+":":i+=",",i=""+i+e):(void 0===a?a=n.getWMSLayerName()+":":a+=",",a=""+a+e))}),{LEGEND_ON:i,LEGEND_OFF:a}},Geometry:v};t.exports=m},{"app/constant":4,"core/layers/filter/filter":30,"core/layers/map/wmslayer":45,"core/utils/parsers":67,"core/utils/utils":68,"services/gui":361,"store/map-layers":377}],65:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var e=e("services/gui"),n=(e=e)&&e.__esModule?e:{default:e};r.default={layout:function(e){e.map,e.position,e.element},changeLayoutBottomControl:function(e){var r,t=e.map,n=e.position,i=e.element,e=e.isMobile,e=void 0!==e&&e,t=t.getViewport(),n=(n.top?"t":"b")+(n.left?"l":"r"),t=$(t).find(".ol-control-"+n+":visible");t.length&&(r=void 0,t.each(function(e,t){if(t==i[0])return!1;r=$(t)}),r)&&"br"==n&&(e?(t=r.width(),i.css("right",(t<10?130:t+20)+"px"),i.css("bottom","15px")):(n=r.position().top)-i.position().top!=35&&i.css("top",n-35+"px"))},createControlUserMessageTool:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{hooks:{body:{template:'<div>\n                <div >\n                  <input type="radio" name="radio" id="g3w-map_theme-0" class="magic-radio" value="view1">\n                  <label  for="g3w-map_theme-0" style="display: flex; justify-content: space-between;">\n                    <span>Intersect</span>\n                  </label>\n                </div>\n                <div>\n                  <input  type="radio" name="radio" id="_cotains" class="magic-radio" value="view2">\n                  <label  for="g3w-map_theme-1" style="display: flex; justify-content: space-between;">\n                    <span>view2</span>\n                  </label>\n                </div>\n              </div>'}},title:"Scelgli il tipo di operazione"};n.default.showUserMessage({type:"tool",message:e.message,size:e.size||"small",title:e.title||"",hooks:e.hooks})}}},{"services/gui":361}],66:[function(s,e,t){var a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n=s("store/application-state"),i=(n=n)&&n.__esModule?n:{default:n};var o={m:39.37,degrees:4374754},l={merge:function(e,t){return r({},e,t)},getExtentForViewAndSize:function(e,t,r,n){var i=t*n[0]/2,t=t*n[1]/2,n=Math.cos(r),r=Math.sin(r),a=i*n,i=i*r,n=t*n,t=t*r,r=e[0],e=e[1],o=r-a+t,s=r-a-t,l=r+a-t,r=r+a+t,a=e-i-n,t=e-i+n,u=e+i+n,e=e+i-n;return[Math.min(o,s,l,r),Math.min(a,t,u,e),Math.max(o,s,l,r),Math.max(a,t,u,e)]},createPolygonLayerFromBBox:function(e){e=new ol.Feature(new ol.geom.Polygon.fromExtent(e)),e=new ol.source.Vector({features:[e]});return new ol.layer.Vector({source:e})},reverseGeometry:function(e){function i(n){n.find(function(e){var t,r;if(!Array.isArray(e))return t=(r=a(n,2))[0],r=r[1],n[0]=r,n[1]=t,!0;i(e)})}var t=e.getCoordinates();return i(t),e.setCoordinates(t),e},getScaleFromResolution:function(e){return Math.round(e*o[1<arguments.length&&void 0!==arguments[1]?arguments[1]:"m"]*96)},getResolutionFromScale:function(e){return 1/((1<=e?1/e:e)*o[1<arguments.length&&void 0!==arguments[1]?arguments[1]:"m"]*96)},getDPI:function(){return 96},getMetersFromDegrees:function(e){return e*ol.proj.Units.METERS_PER_UNIT.degrees},needUseSphereMethods:function(e){return"EPSG:3857"===e.getCode()||"degrees"===e.getUnits()},getLengthMessageText:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.unit,r=e.projection,e=e.geometry,n=s("core/utils/geo").Geometry,i=e.getType(),r=this.needUseSphereMethods(r)?ol.sphere.getLength(e,{projection:r.getCode()}):n.isMultiGeometry(i)?e.getLineStrings().reduce(function(e,t){return e+t.getLength()},0):e.getLength();return"nautical"===t?this.transformMeterLength(r,t)+" nm":1e3<r?(Math.round(r/1e3*100)/100).toFixed(3)+" km":(Math.round(100*r)/100).toFixed(2)+" m"},getAreaMessageText:function(e){var t=e.unit,r=e.geometry,n=e.projection,e=e.segments,e=void 0===e?[]:e,i=this.needUseSphereMethods(n),i=Math.round(i?ol.sphere.getArea(r,{projection:n.getCode()}):r.getArea()),r=void 0,a="";return 2<e.length&&(a+=this.getLengthMessageText({unit:t,projection:n,geometry:new ol.geom.LineString(e)})+" <br>"),r="nautical"===t?this.transformMeterArea(i,t)+"  nmi²":1e6<i?(Math.round(i/1e6*100)/100).toFixed(6)+" km<sup>2</sup>":(Math.round(100*i)/100).toFixed(3)+" m<sup>2</sup>",r=a?"Area: "+r+' <br><div style="width: 100%; padding: 3px; border-bottom: 2px solid #ffffff"></div> '+a:r},formatMeasure:function(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.geometry,e=e.projection,n=s("core/utils/geo"),i=n.Geometry,n=n.multiGeometryToSingleGeometries,a=r.getType(),o=this.getCurrentMapUnit();return i.isLineGeometryType(a)?this.getLengthMessageText({unit:o,projection:e,geometry:r}):i.isPolygonGeometryType(a)?(t=void 0,i.isMultiGeometry(a)?(t=[],n(r).forEach(function(e){e.getLinearRing().getCoordinates().forEach(function(e){return t.push(e)})})):t=r.getLinearRing().getCoordinates(),this.getAreaMessageText({unit:o,geometry:r,projection:e,segments:t})):void 0},createMeasureTooltip:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.map,e=e.feature,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=document.createElement("div"),a=(i.className="mtooltip mtooltip-measure",new ol.Overlay({element:i,offset:[0,-15],positioning:"bottom-center"})),e=(r.addOverlay(a),e.getGeometry().on("change",function(e){var t=void 0,e=e.target,e=(e instanceof ol.geom.Polygon?t=e.getInteriorPoint().getCoordinates():e instanceof ol.geom.MultiPolygon?t=e.getInteriorPoints().getCoordinates()[0]:(e instanceof ol.geom.LineString||e instanceof ol.geom.MultiLineString)&&(t=e.getLastCoordinate()),l.formatMeasure({geometry:e,projection:r.getView().getProjection()},n));i.innerHTML=e,a.setPosition(t)}));return{tooltip:a,unbyKey:e}},getCurrentMapUnit:function(){return i.default.map.unit},transformMeterLength:function(e,t){return"nautical"===t&&(e*=.0005399568),e},transformMeterArea:function(e,t){return"nautical"===t&&(e*=2.9155334959812285e-7),e},removeMeasureTooltip:function(e){var t=e.map,r=e.tooltip,e=e.unbyKey;t.removeOverlay(r),ol.Observable.unByKey(e)},setMeasureTooltipStatic:function(e){e.getElement().className="mtooltip mtooltip-static",e.setOffset([0,-7])}};e.exports=l},{"core/utils/geo":64,"store/application-state":373}],67:[function(l,e,t){var u=l("app/constant");function s(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function f(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}var i=l("core/utils/utils").toRawType,n=l("core/layers/features/feature"),r=l("core/i18n/i18n.service").t,a=l("core/utils/ol"),c="GIS3W_ESCAPE_NUMERIC_FIELD_",o={getHandledResponsesFromResponse:function(e){var a=this,t=e.response,o=e.layers,s=e.projections,e=e.id,l=void 0!==e&&e,u=!1,c=(new X2JS).xml_str2json(t);if(!c)return[{layer:o[0],features:[]}];var e=c.FeatureCollection,d=[];if(e.featureMember)for(var p=Array.isArray(e.featureMember)?e.featureMember:[e.featureMember],r=0;r<o.length;r++)!function(e){var r,t=o[e],n=l?t.getId():"layer"+e,i={features:null,__prefix:null};c.FeatureCollection.featureMember=p.filter(function(e){var t=e[n];if(t)return t.g3w_fid={__prefix:e.__prefix,__text:t._fid&&t._fid.split(".")[1]},!Array.isArray(t)||(i.features=t,i.__prefix=e.__prefix,!1)}),i.features&&(r=i.__prefix,e=a.groupFeaturesByFields(i.features),1<Object.keys(e).length?(u=!0,a.handleWMSMultiLayersResponseFromQGISSERVER({groupFeatures:e,prefix:r,handledResponses:d,jsonresponse:c,layer:t,projections:s})):i.features.forEach(function(e){var t;c.FeatureCollection.featureMember.push((f(t={},n,e),f(t,"__prefix",r),t))})),u||(e=a.parseLayerFeatureCollection({jsonresponse:c,layer:t,projections:s}))&&d.unshift(e[0])}(r);return d},transformFeatures:function(e,r){var t;return e=e.length&&e[0].getGeometry()&&(t="ne"===(r.layer||r.map).getAxisOrientation().substr(0,2),r.layer&&r.layer.getCode()!==r.map.getCode()&&e.forEach(function(e){var t=e.getGeometry();e.setGeometry(t.transform(r.layer.getCode(),r.map.getCode()))}),t)?this.reverseFeaturesCoordinates(e):e},parseLayerFeatureCollection:function(e){var t,i=this,r=e.jsonresponse,n=e.layer,e=e.projections,a=l("core/utils/geo").Geometry,o=a.is3DGeometry,s=a.removeZValueToOLFeatureGeometry,a=(new X2JS).json2xml_str(r),r=new ol.format.WMSGetFeatureInfo,r=this.transformFeatures(r.readFeatures(a),e);return n.isGeoLayer()&&!o(n.getGeometryType())&&r.forEach(function(e){return s({feature:e})}),r.length&&this.hasFieldsStartWithNotPermittedKey&&(t=Object.keys(r[0].getProperties()).filter(function(e){return-1!==e.indexOf(c)}),r.forEach(function(n){t.forEach(function(e){var t=n.get(e),r=e.replace(c,"");n.set(i.hasFieldsStartWithNotPermittedKey[r],Array.isArray(t)?t[0]:t),n.unset(e)})})),[{layer:n,features:r}]},reverseFeaturesCoordinates:function(e){return e.forEach(function(e){var t=e.getGeometry();e.setGeometry(a.reverseGeometry(t))}),e},handleXMLStringResponseBeforeConvertToJSON:function(){var r=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=e.response,t=e.layers,i=e.wms;if(n){"string"==typeof n||n instanceof String||(n=(new XMLSerializer).serializeToString(n));for(var a=0;a<t.length;a++)var o=t[a],o=i&&o.isWmsUseLayerIds()?o.getId():o.getName(),o=i?o.replace(/[/\s]/g,""):o.replace(/[/\s]/g,"_"),o=(o=(o=(o=o.replace(/(\'+)/,"")).replace(/(\)+)/,"")).replace(/(\(+)/,""),new RegExp("qgs:"+o,"g")),n=n.replace(o,"qgs:layer"+a);[].concat(s(n.matchAll(/qgs:(\d+(?:\.\d+)?)(\w+)/g)),s(n.matchAll(/qgs:(\w+):(\w+)/g))).forEach(function(e,t){t%2==0&&(r.hasFieldsStartWithNotPermittedKey||(r.hasFieldsStartWithNotPermittedKey={}),t=e[0].replace("qgs:",""),r.hasFieldsStartWithNotPermittedKey[""+e[1]+e[2]]=t,t=new RegExp(""+e[0],"g"),n=n.replace(t,"qgs:"+c+e[1]+e[2]))});e=new RegExp(""+String.fromCharCode(0),"g");return n=n.replace(e,"0")}},groupFeaturesByFields:function(e){return _.groupBy(e,function(e){return Object.keys(e)})},handleWMSMultiLayersResponseFromQGISSERVER:function(){var i=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.groupFeatures,a=e.prefix,o=e.handledResponses,s=e.jsonresponse,l=e.layer,u=e.projections;Object.keys(t).forEach(function(e,n){t[e].forEach(function(e,t){s.FeatureCollection.featureMember=(f(r={},"layer"+n+"_"+t,e),f(r,"__prefix",a),r);var r,t=i.parseLayerFeatureCollection({jsonresponse:s,layer:l,projections:u});t&&((e=t[0]).layer=l,o.unshift(e))})})}},d={"application/json":function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layers,t=void 0===t?[]:t,r=e.response,n=e.projections,e=e.wms,i=void 0===e||e,a=l("core/utils/geo").sanitizeFidFeature,o=[],s=t.map(function(e){return o.push({layer:e,features:[]}),i?e.getWMSLayerName():e.getWFSLayerName()}),e=r;return(e&&(t=n.layer||n.map,new ol.format.GeoJSON({defaultDataProjection:t,geometryName:"geometry"}).readFeatures(e))).filter(function(t){var e,r,n=t.getId(),i=a(n),n=n==i?0:s.indexOf(n);-1!==n&&(e=o[n].layer.getFields().filter(function(e){return e.show}),r=t.getProperties(),t.set(u.G3W_FID,i),e.forEach(function(e){void 0===r[e.name]&&void 0!==r[e.label]&&t.set(e.name,r[e.label])}),o[n].features.push(t))}),o},"application/geojson":function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layers,r=(e.projections,e.response),n=[],i=p.vector.get({type:"geojson"});return r&&t.forEach(function(e){n.push({layer:e,features:i(r,{})})}),n},"text/html":function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layers,r=e.response,n=[];return t.forEach(function(e){n.push({layer:e,rawdata:r})}),n},"text/plain":function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layers,r=e.response,n=[];return t.forEach(function(e){n.push({layer:e,rawdata:r})}),n},"text/gml":function(e){var t=e.layers,e=e.response,r=p.vector.get({type:"gml"})({data:e,layer:t[0]});return t.map(function(e){return{layer:e,features:r}})},"application/vnd.ogc.gml":function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.response,r=e.projections,n=e.layers,e=e.wms;return o.getHandledResponsesFromResponse({response:o.handleXMLStringResponseBeforeConvertToJSON({layers:n,response:t,wms:void 0===e||e}),layers:n,projections:r})},not_supported_format:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).layers;return(void 0===e?[]:e).map(function(e){return{layer:e,rawdata:r("warning.not_supported_format")}})}},p={vector:new function(){this.get=function(){var e=void 0;switch((0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).type){case"geojson":case"json":e=this._parseLayerGeoJSON;break;case"gml":e=this._parseLayermsGMLOutput;break;default:e=this._parseLayerGeoJSON}return e},this._parseLayermsGMLOutput=function(e){var t=e.data,e=e.layer;try{var r,n,i=void 0,a=("--"!==t.substr(0,2)?i=t:(r=new RegExp("<([^ ]*)FeatureCollection"),n=new RegExp("<([^ ]*)msGMLOutput"),t.split(new RegExp("\r\n--")).forEach(function(e){(-1<e.search(r)||-1<e.search(n))&&(i=e.substr(e.indexOf("<?xml")))})),e.getQueryLayerOrigName());return new ol.format.WMSGetFeatureInfo({layers:a}).readFeatures(i)}catch(e){return[]}},this._parseLayerGeoJSON=function(e,t){try{e="String"===i(e)?JSON.parse(e):e;var r=t.crs,n=t.mapCrs;return new ol.format.GeoJSON({dataProjection:r,featureProjection:n||r,geometryName:"geometry"}).readFeatures(e)}catch(e){return[]}}},table:new function(){this.get=function(){(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).type;return this._parserJSON.bind(this)},this._parserJSON=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).features;return(void 0===e?[]:e).map(function(e){var t=e.id,e=e.properties,r=new n;return r.setProperties(e),r.setId(t),r})}},response:{get:function(e){return d[e]||d.not_supported_format},utils:{getTimeoutData:function(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).map(function(e){return{layer:e,rawdata:"timeout"}})}}}};e.exports=p},{"app/constant":4,"core/i18n/i18n.service":13,"core/layers/features/feature":26,"core/utils/geo":64,"core/utils/ol":66,"core/utils/utils":68}],68:[function(n,e,t){var o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},c=n("app/constant");function d(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var p=n("core/layers/filter/filter"),f=n("core/layers/filter/expression");function r(e,t,r){return void 0===r||0==+r?Math[e](t):(t=+t,r=+r,isNaN(t)||"number"!=typeof r||r%1!=0?NaN:(t=t.toString().split("e"),+((t=(t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-r:-r)))).toString().split("e"))[0]+"e"+(t[1]?+t[1]+r:r))))}Math.round10||(Math.round10=function(e,t){return r("round",e,t)}),Math.floor10||(Math.floor10=function(e,t){return r("floor",e,t)}),Math.ceil10||(Math.ceil10=function(e,t){return r("ceil",e,t)}),String.prototype.hashCode=function(){var e,t=0,r=void 0;if(0!==this.length)for(r=0,e=this.length;r<e;r++)t=(t<<5)-t+this.charCodeAt(r),t|=0;return t};var u={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,r,n,i,a="",o=void 0,s=void 0,l=0;for(e=u._utf8_encode(e);l<e.length;)n=(t=e.charCodeAt(l++))>>2,i=(3&t)<<4|(t=e.charCodeAt(l++))>>4,o=(15&t)<<2|(r=e.charCodeAt(l++))>>6,s=63&r,isNaN(t)?o=s=64:isNaN(r)&&(s=64),a=a+this._keyStr.charAt(n)+this._keyStr.charAt(i)+this._keyStr.charAt(o)+this._keyStr.charAt(s);return a},decode:function(e){var t,r,n,i,a,o,s="",l=0;for(e=e.replace(/[^A-Za-z0-9+/=]/g,"");l<e.length;)n=this._keyStr.indexOf(e.charAt(l++)),t=(15&(i=this._keyStr.indexOf(e.charAt(l++))))<<4|(a=this._keyStr.indexOf(e.charAt(l++)))>>2,r=(3&a)<<6|(o=this._keyStr.indexOf(e.charAt(l++))),s+=String.fromCharCode(n<<2|i>>4),64!=a&&(s+=String.fromCharCode(t)),64!=o&&(s+=String.fromCharCode(r));return s=u._utf8_decode(s)},_utf8_encode:function(e){e=e.replace(/rn/g,"n");for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r);n<128?t+=String.fromCharCode(n):t=127<n&&n<2048?(t+=String.fromCharCode(n>>6|192))+String.fromCharCode(63&n|128):(t=(t+=String.fromCharCode(n>>12|224))+String.fromCharCode(n>>6&63|128))+String.fromCharCode(63&n|128)}return t},_utf8_decode:function(e){var t,r="",n=0;for(c1=c2=0;n<e.length;)(t=e.charCodeAt(n))<128?(r+=String.fromCharCode(t),n++):191<t&&t<224?(c2=e.charCodeAt(n+1),r+=String.fromCharCode((31&t)<<6|63&c2),n+=2):(c2=e.charCodeAt(n+1),c3=e.charCodeAt(n+2),r+=String.fromCharCode((15&t)<<12|(63&c2)<<6|63&c3),n+=3);return r}},i=0,h={getUniqueDomId:function(){return(i+=1)+"_"+Date.now()},uniqueId:function(){return h.getUniqueDomId()},basemixin:function(e,t){return h.merge(e.prototype,t)},mixin:function(e,t){var r=new t;h.merge(e,r),h.merge(e.prototype,t.prototype)},merge:function(e,t){var r=void 0;for(r in t)h.hasOwn(t,r)&&(e[r]=t[r])},hasOwn:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},inherit:function(e,t){function r(){}r.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new r,e.prototype.constructor=e},base:function(e,t,r){var n=arguments.callee.caller;if(n.superClass_)return n.superClass_.constructor.apply(e,Array.prototype.slice.call(arguments,1));for(var i=Array.prototype.slice.call(arguments,2),a=!1,o=e.constructor;o;o=o.superClass_&&o.superClass_.constructor)if(o.prototype[t]===n)a=!0;else if(a)return o.prototype[t].apply(e,i);if(e[t]===n)return e.constructor.prototype[t].apply(e,i);throw Error("base called from a method of one name to a method of a different name")},noop:function(){},truefnc:function(){return!0},falsefnc:function(){return!0},resolve:function(e){var t=$.Deferred();return t.resolve(e),t.promise()},reject:function(e){var t=$.Deferred();return t.reject(e),t.promise()},getValueFromG3WObjectEvent:function(){},getAjaxResponses:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=e.length,r=$.Deferred(),n=[],i=[];return e.forEach(function(e){e.then(function(e){n.push(e)}).fail(function(e){i.push(e)}).always(function(){0===(t=0<t?t-1:t)&&r.resolve({done:n,fail:i})})}),r.promise()},trimValue:function(e){return e.replace(/ /g,"")},isURL:function(e){return e&&e.match(/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g)},sanitizeUrl:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=e.url,e=e.reserverParameters,e=void 0===e?[]:e,o=new URL(a);return e.forEach(function(e){for(var t=[e.toUpperCase(),e.toLowerCase()],r=0;r<2;r++){var n=t[r],i=o.searchParams.get(n);if(i){a=a.replace(n+"="+i,"");break}}}),a},convertObjectToUrlParams:function(){return $.param(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},appendParams:function(e,t){var r=[],n=(Object.keys(t).forEach(function(e){null!==t[e]&&void 0!==t[e]&&r.push(e+"="+encodeURIComponent(t[e]))}),r.join("&"));return(e=-1===(e=e.replace(/[?&]$/,"")).indexOf("?")?e+"?":e+"&")+n},imageToDataURL:function(e){var t=e.src,r=e.type,n=void 0===r?"image/jpeg":r,r=e.callback,i=void 0===r?function(){}:r,e=new Image;e.onload=function(){var e=document.createElement("canvas"),t=e.getContext("2d"),t=(e.height=this.naturalHeight,e.width=this.naturalWidth,t.drawImage(this,0,0),e.toDataURL(n));i(t)},e.src=t},capitalize_first_letter:function(e){return""+e[0].toUpperCase()+e.slice(1)},Base64:u,toRawType:function(e){return Object.prototype.toString.call(e).slice(8,-1)},isEmptyObject:function(e){return"{}"===JSON.stringify(e)},throttle:function(t){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:500,n=void 0;return function(){var e=n;n=Date.now(),(void 0===e||r<n-e)&&t.apply(void 0,arguments)}},debounce:function(n){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:500,a=void 0;return function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];clearTimeout(a),a=setTimeout(function(){n.apply(void 0,t)},i)}},getRandomColor:function(){return"#"+((1<<24)*Math.random()|0).toString(16)},copyUrl:function(e){var t=document.createElement("input");document.body.appendChild(t),t.value=e,t.select(),document.execCommand("copy"),document.body.removeChild(t)},downloadFile:function(){function i(e){var t=document.createElement("a");t.setAttribute("href",window.URL.createObjectURL(e)),t.setAttribute("download",o),t.dataset.downloadurl=[u,t.download,t.href].join(":"),t.click()}var a=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},o=e.filename,s=e.content,l=e.url,e=e.mime_type,u=void 0===e?"text/plain":e;return new Promise(function(t,r){var e,n;s?(e=new Blob([s],{type:u}),i(e),t()):l&&fetch(l).then((n=d(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(200===t.status)return u=u||t.headers.get("content-type"),o=o||t.headers.get("content-disposition").split("filename=").length?t.headers.get("content-disposition").split("filename=")[1]:"g3w_download_file",e.abrupt("return",t.blob());e.next=6;break;case 6:if(400===t.status||500===t.status)return e.next=9,t.json();e.next=12;break;case 9:return r=e.sent,r=r.message,e.abrupt("return",Promise.reject(r));case 12:case"end":return e.stop()}},e,a)})),function(e){return n.apply(this,arguments)})).then(function(e){i(e),t()}).catch(function(e){r(e)})})},downloadCSVLayerFeatures:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.layer,e=e.alias,i=void 0===e||e,t=(0,n("core/utils/geo").getAlphanumericPropertiesFromFeature)(Object.keys(r.features[0].attributes)),a=i?t.map(function(t){var e=r.attributes.find(function(e){return e.name===t});return e?e.label:t}):t,e=r.features.map(function(e){var r=e.attributes,n={};return t.forEach(function(e,t){t=!i&&e||a[t];n[t]=r[e]}),n});h.downloadCSV({filename:r.id,items:e})},downloadCSV:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.filename,t=void 0===t?h.getUniqueDomId():t,e=e.items;var r,t=t+".csv",e=function(e){for(var t="",r=0;r<e.length;r++){var n,i="";for(n in e[r])""!==i&&(i+=";"),i+=e[r][n];t+=i+"\r\n"}return t}(void 0===e?[]:e),e=new Blob([e],{type:"text/csv;charset=utf-8;"});navigator.msSaveBlob?navigator.msSaveBlob(e,t):void 0!==(r=document.createElement("a")).download&&(e=URL.createObjectURL(e),r.setAttribute("href",e),r.setAttribute("download",t),r.style.visibility="hidden",r.click())},getTimeoutPromise:function(e){var t=e.timeout,t=void 0===t?c.TIMEOUT:t,r=e.resolve,n=e.data;return setTimeout(function(){r(n)},t)},XHR:{get:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=e.url,e=e.params,i=void 0===e?{}:e;return new Promise(function(t,r){n?$.get(n,i).then(function(e){t(e)}).fail(function(e){return r(e)}):r("No url")})},post:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=e.url,a=e.data,t=e.formdata,o=void 0!==t&&t,s=e.contentType,l=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return new Promise(function(n,t){if(o){var e,r=new FormData;for(e in a)r.append(e,a[e]);$.ajax({type:"POST",url:i,data:r,processData:!1,contentType:!1}).then(function(e,t,r){n(l?{data:e,status:t,request:r}:e)}).fail(function(e){t(e)})}else s?$.ajax({type:"POST",url:i,data:a,processData:!1,contentType:s||!1}).then(function(e,t,r){n(l?{data:e,status:t,request:r}:e)}).fail(function(e){t(e)}):$.post(i,a).then(function(e,t,r){n(l?{data:e,status:t,request:r}:e)}).fail(function(e){t(e)})})},htmlescape:function(e){return e=(e=(e=(e=e.replace("&","&amp;")).replace("<","&lt;")).replace(">","&gt;")).replace('"',"&quot;")},fileDownload:function(){var n,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=e.url,a=e.data,e=e.httpMethod,o=void 0===e?"POST":e;return new Promise(function(e,t){var r=$.fileDownload(i,{httpMethod:o,data:a});n=setTimeout(function(){t("Timeout"),r.abort()},c.TIMEOUT),r.done(function(){return e()}).fail(function(){return t()}).always(function(){clearTimeout(n)})})}},createSingleFieldParameter:function(e){var r,n,i,a,o=e.field,t=e.value,s=e.operator,l=void 0===s?"eq":s,s=e.logicop,u=void 0===s?"OR":s,s=e.search_endpoint;return"api"===(void 0===s?"api":s)?Array.isArray(t)?(r="",n=t.length,t.forEach(function(e,t){r+=o+"|"+l+"|"+encodeURIComponent(e)+(t<n-1?"|"+u+",":"")}),r):o+"|"+l.toLowerCase()+"|"+encodeURIComponent(t):Array.isArray(t)?(i="",a=t.length,t.forEach(function(e,t){i+='"'+o+'" '+c.FILTER_EXPRESSION_OPERATORS[l]+" '"+encodeURIComponent(e)+"' "+(t<a-1?u+" ":"")}),i):'"'+o+'" '+c.FILTER_EXPRESSION_OPERATORS[l]+" '"+encodeURIComponent(t)+"'"},createFilterFromString:function(e){var t=e.layer,r=e.search_endpoint,e=e.filter,n=i=void 0===e?"":e;switch(void 0===r?"ows":r){case"ows":var i,a=t.getWMSLayerName(),a=new f({layerName:a,filter:n});(i=new p).setExpression(a.get());break;case"api":Object.values(c.FILTER_EXPRESSION_OPERATORS).forEach(function(e){var t=new RegExp("\\s+"+e+"\\s+","g"),t=(n=n.replace(t,""+e),new RegExp("'"+e,"g"));n=n.replace(t,""+e),t=new RegExp(e+"'","g"),n=n.replace(t,""+e)}),n=n.replace(/'$/g,""),i=n.replace(/"/g,""),Object.entries(c.FILTER_EXPRESSION_OPERATORS).forEach(function(e){var e=o(e,2),t=e[0],e=e[1],r=new RegExp(e,"g");i=i.replace(r,"AND"===e||"OR"===e?"|"+t+",":"|"+t+"|")}),i=i.split("|").map(function(e,t){return(t+1)%3==0?encodeURIComponent(e):e}).join("|")}return i},createFilterFormInputs:function(e){var t,r=e.layer,n=e.search_endpoint,n=void 0===n?"ows":n,e=e.inputs,i=void 0===e?[]:e,a=Array.isArray(r),o=void 0,s=[];switch(n){case"ows":a?r.forEach(function(e){var t=new f,e=e.getWMSLayerName();t.createExpressionFromFilter(i,e),(o=new p).setExpression(t.get()),s.push(o)}):(t=new f,u=r.getWMSLayerName(),t.createExpressionFromFilter(i,u),(o=new p).setExpression(t.get()));break;case"api":var l=i.length-1,u=i.map(function(e,t){return h.createSingleFieldParameter({field:e.attribute,value:e.value,operator:e.operator,logicop:t<l?e.logicop:null})}),o=u.length?u.join():void 0;a&&r.forEach(function(){return s.push(o)})}return a?s:o},createFilterFormField:function(e){var t=e.layer,r=e.search_endpoint,n=e.field,i=e.value,e=e.operator,a=void 0===e?"eq":e,o=void 0;switch(void 0===r?"ows":r){case"ows":var s=new f,l=t.getWMSLayerName();s.createExpressionFromField({layerName:l,field:n,value:i,operator:a}),(o=new p).setExpression(s.get());break;case"api":o=h.createSingleFieldParameter({field:n,value:i,operator:a})}return o},splitContextAndMethod:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"").split(":"),e=o(e,2);return{context:e[0],method:e[1]}},colorHEXToRGB:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"#FFFFFF";return[parseInt(e.substr(1,2),16),parseInt(e.substr(3,2),16),parseInt(e.substr(5,2),16)]},convertQGISDateTimeFormatToMoment:function(e){var t=(e=e.replace(/y/g,"Y")).match(/d/g);return e=t&&t.length<3?e.replace(/d/g,"D"):e},sortAlphabeticallyArray:function(e){return e.sort(function(e,t){return e.localeCompare(t,void 0,{sensitivity:"base"})})},sortNumericArray:function(e){var r=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];return e.sort(function(e,t){return r?e-t:t-e})},sameOrigin:function(e,t){try{return new URL(e).origin===new URL(t).origin}catch(e){return!1}}};e.exports=h},{"app/constant":4,"core/layers/filter/expression":29,"core/layers/filter/filter":30,"core/utils/geo":64}],69:[function(e,t,r){var n=e("core/utils/utils").truefnc;t.exports={validators:{float:function(){this.options=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},this.validate=function(e){e=Number(+e);return!Number.isNaN(e)}},integer:function(){this.options=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},this.validate=function(e){e=+e;return!_.isNaN(e)&&Number.isSafeInteger(e)&&e<=2147483647}},checkbox:function(){this.options=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},this.validate=function(e){return-1!==(this.options.values||[]).indexOf(e)}},datetimepicker:function(){this.options=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},this.validate=function(e,t){t=t.fielddatetimeformat;return moment(e,t,!0).isValid()}},text:function(){this.options=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},this.validate=n},string:function(){this.options=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},this.validate=n},radio:function(){this.options=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},this.validate=n},default:function(){this.options=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},this.validate=n},range:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.min,r=e.max;this.validate=function(e){return t<=(e=+e)&&e<=r}}},get:function(e){return new(this.validators[e]||this.validators.default)(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{})}}},{"core/utils/utils":68}],70:[function(e,t,r){var n=e("core/utils/utils"),s=n.base,n=n.inherit,i=e("core/g3wobject"),l=e("core/workflow/queque");function a(){var t,r=[],n=0,i=null,a=void 0,o=void 0;this.queques={end:new l,micro:new l},this.start=function(e){return a=$.Deferred(),t=(o=e).getInputs(),i=e.getContext(),(r=e.getSteps())&&r.length&&this.runStep(r[0],t,i),a.promise()},this.runStep=function(e,t){var r=this,n=(o.setMessages({help:e.state.help}),this.queques.micro.getLength());e.run(t,i,this.queques).then(function(e){n&&r.queques.micro.run(),r.onDone(e)}).fail(function(e){return r.onError(e)})},this.onDone=function(e){++n===r.length?(n=0,a.resolve(e)):this.runStep(r[n],e)},this.onError=function(e){n=0,this.clearQueques(),a.reject(e)},this.stop=function(){var e=$.Deferred();return r[n].isRunning()&&r[n].stop(),this.clearQueques(),0<n?(n=0,e.reject()):e.resolve(),e.promise()},s(this)}n(a,i),a.prototype.clearQueques=function(){this.queques.micro.clear(),this.queques.end.clear()},t.exports=a},{"core/g3wobject":12,"core/utils/utils":68,"core/workflow/queque":71}],71:[function(e,t,r){function n(){this.tasks=[]}var i=n.prototype;i.addTask=function(e){this.tasks.push(e)},i.run=function(){for(var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.tasks.length;)(e?this.tasks.pop():this.tasks.shift())()},i.flush=function(){return this.tasks.splice(0)},i.getLength=function(){return this.tasks.length},i.clear=function(){this.run(),this.tasks=[]},t.exports=n},{}],72:[function(e,t,r){var n=e("core/utils/utils"),o=n.base;function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(o(this),e.inputs),r=e.context,r=void 0===r?null:r,n=e.task,n=void 0===n?null:n,i=e.outputs,i=void 0===i?null:i,a=e.escKeyPressEventHandler;this._inputs=void 0===t?null:t,this._context=r,this._task=n,this._outputs=i,this.state={id:e.id||null,name:e.name||null,help:e.help||null,running:!1,error:null,message:e.message||null},a&&this.registerEscKeyEvent(a)}(0,n.inherit)(i,e("core/g3wobject"));n=i.prototype;n.escKeyUpHandler=function(e){var t=e.data,r=t.task,t=t.callback;"Escape"===e.key&&t({task:r})},n.unbindEscKeyUp=function(){$(document).unbind("keyup",this.escKeyUpHandler)},n.bindEscKeyUp=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){};$(document).on("keyup",{callback:e,task:this.getTask()},this.escKeyUpHandler)},n.registerEscKeyEvent=function(e){var t=this;this.on("run",function(){return t.bindEscKeyUp(e)}),this.on("stop",function(){return t.unbindEscKeyUp()})},n.run=function(e,t,r){var n=this,i=(this.emit("run",{inputs:e,context:t}),$.Deferred());if(this._task)try{this.state.running=!0,this._task.setInputs(e),this._task.setContext(t),this._task.run(e,t,r).then(function(e){n.stop(),i.resolve(e)}).fail(function(e){n.stop(),i.reject(e)})}catch(e){this.state.error=e,this.state.error="Problem ..",this.stop(),i.reject(e)}return i.promise()},n.stop=function(){this._task.stop(this._inputs,this._context),this.state.running=!1,this.emit("stop"),this._task.setInputs(null),this._task.setContext(null)},n.revert=function(){this._task&&this._task.revert&&this._task.revert()},n.panic=function(){this._task&&this._task.panic&&this._task.panic()},n.getId=function(){return this.state.id},n.getName=function(){return this.state.name},n.getHelp=function(){return this.state.help},n.getError=function(){return this.state.error},n.getMessage=function(){return this.state.message},n.isRunning=function(){return this.state.running},n.setInputs=function(e){this._inputs=e},n.getInputs=function(){return this._inputs},n.setTask=function(e){this._task=e},n.getTask=function(){return this._task},n.setOutputs=function(e){this._outputs=e},n.getOutputs=function(){return this._outputs},i.MESSAGES={help:null},t.exports=i},{"core/g3wobject":12,"core/utils/utils":68}],73:[function(e,t,r){var n=e("core/utils/utils"),i=n.base;function a(){i(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),this.state={usermessagesteps:{}}}(0,n.inherit)(a,e("core/g3wobject"));n=a.prototype;n.setInputs=function(e){this.inputs=e},n.getInputs=function(){return this.inputs},n.setContext=function(e){return this.context=e},n.getContext=function(){return this.context},n.revert=function(){},n.panic=function(){},n.stop=function(){},n.run=function(){},n.setRoot=function(e){this.state.root=e},n.getUserMessageSteps=function(){return this.state.usermessagesteps},n.setUserMessageSteps=function(){this.state.usermessagesteps=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}},n.setUserMessageStepDone=function(e){e&&(this.state.usermessagesteps[e].done=!0)},t.exports=a},{"core/g3wobject":12,"core/utils/utils":68}],74:[function(e,t,r){var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(e("services/workflows")),s=n(e("services/gui"));function n(e){return e&&e.__esModule?e:{default:e}}var i=e("core/utils/utils"),l=i.base,u=i.inherit,c=i.resolve,i=e("core/g3wobject"),d=e("core/workflow/flow"),p=e("core/workflow/step").MESSAGES,f=e("gui/workflow/createUserMessageStepsFactory");function h(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.inputs,t=void 0===t?null:t,r=e.context,r=void 0===r?null:r,n=e.flow,n=void 0===n?new d:n,i=e.steps,i=void 0===i?[]:i,e=e.runOnce,e=void 0!==e&&e;l(this),this._promise=null,this._inputs=t,this._context=r,this._flow=n,this._steps=i,this._child=null,this._stackIndex=null,this.runOnce=e,this._messages=p,this._userMessageSteps=this._steps.reduce(function(e,t){t=t.getTask().getUserMessageSteps();return t&&a({},e,t)||e},{})}u(h,i);e=h.prototype;e.getContextService=function(){return this.getContext().service},e.setContextService=function(e){this.getContext().service=e},e.getStackIndex=function(){return this._stackIndex},e.addChild=function(e){this._child?this._child.addChild(e):this._child=e},e.removeChild=function(){var e;this._child&&(e=this._child.getStackIndex(),o.default.removeAt(e)),this._child=null},e.setInput=function(e){var t=e.key,e=e.value;this._inputs[t]=e},e._setInputs=function(e){this._inputs=e},e.getInputs=function(){return this._inputs},e.setContext=function(e){this._context=e},e.getContext=function(){return this._context},e.getFlow=function(){return this._flow},e.setFlow=function(e){this._flow=e},e.addStep=function(e){this._steps.push(e)},e.setSteps=function(e){this._steps=e},e.getSteps=function(){return this._steps},e.getStep=function(e){return this._steps[e]},e.setMessages=function(e){Object.assign(this._messages,e)},e.getMessages=function(){return this._messages},e.clearMessages=function(){this._messages.help=null,this._isThereUserMessaggeSteps()&&this.clearUserMessagesSteps()},e.getLastStep=function(){var e=this._steps.length;return e?this._steps[e-1]:null},e.getRunningStep=function(){return this._steps.find(function(e){return e.isRunning()})},e._stopChild=function(){return this._child?this._child.stop():c()},e._isThereUserMessaggeSteps=function(){return Object.keys(this._userMessageSteps).length},e.reject=function(){this._promise&&this._promise.reject()},e.resolve=function(){this._promise&&this._promise.resolve()},e.start=function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred(),n=(this._promise=r,this._inputs=e.inputs,this._context=e.context||{},this._context.isChild||!1),i=(!o.default.getLength()||o.default.getCurrent()===this||n||o.default.getCurrent().addChild(this),this._stackIndex=o.default.push(this),this._flow=e.flow||this._flow,this._steps=e.steps||this._steps,this._isThereUserMessaggeSteps());return i&&(n=f({steps:this._userMessageSteps}),s.default.showUserMessage({title:"sdk.workflow.steps.title",type:"tool",position:"left",size:"small",closable:!1,hooks:{body:n}})),this._flow.start(this).then(function(e){i&&setTimeout(function(){t.clearUserMessagesSteps(),r.resolve(e)},500)||r.resolve(e)}).fail(function(e){i&&t.clearUserMessagesSteps(),r.reject(e)}).always(function(){t.runOnce&&t.stop()}),this.emit("start"),r.promise()},e.stop=function(){var e=this,t=(this._promise=null,$.Deferred());return this._stopChild().always(function(){e.removeChild(),o.default.removeAt(e.getStackIndex()),e._flow.stop().then(function(){return t.resolve()}).fail(function(e){return t.reject(e)}).always(function(){return e.clearMessages()})}),this.emit("stop"),t.promise()},e.clearUserMessagesSteps=function(){this._resetUserMessaggeStepsDone(),s.default.closeUserMessage()},e._resetUserMessaggeStepsDone=function(){var t=this;Object.keys(this._userMessageSteps).forEach(function(e){e=t._userMessageSteps[e];e.done=!1,e.buttonnext&&(e.buttonnext.disabled=!0)})},t.exports=h},{"core/g3wobject":12,"core/utils/utils":68,"core/workflow/flow":70,"core/workflow/step":72,"gui/workflow/createUserMessageStepsFactory":193,"services/gui":361,"services/workflows":372}],75:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});r.SPATIALMETHODS=["intersects","within"],r.VM=new Vue},{}],76:[function(e,t,r){var n=e("g3w-ol/controls/control");function i(){n.call(this,{name:"addlayer",tipLabel:"sdk.mapcontrols.addlayer.tooltip",label:""}),this._layerstore=null}ol.inherits(i,n);e=i.prototype;e.setMap=function(e){var t=this;n.prototype.setMap.call(this,e),$(this.element).on("click",function(){return t.dispatchEvent("addlayer")})},e.layout=function(e){n.prototype.layout.call(this,e)},e.getLayersSore=function(){return this._layerstore},e.setLayersStore=function(e){this._layerstore=e},t.exports=i},{"g3w-ol/controls/control":79}],77:[function(e,t,r){function n(){var e=i.merge(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},{tipLabel:"sdk.mapcontrols.measures.area.tooltip",label:"",clickmap:!0,interactionClass:a});o.call(this,e)}var i=e("core/utils/ol"),a=e("g3w-ol/interactions/areainteraction"),o=e("g3w-ol/controls/measurecontrol");ol.inherits(n,o),t.exports=n},{"core/utils/ol":66,"g3w-ol/controls/measurecontrol":85,"g3w-ol/interactions/areainteraction":101}],78:[function(e,t,r){function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=void 0===(t=(n=e).spatialMethod)?i.SPATIALMETHODS[0]:t,r=n.onSelectlayer,n=n.interactionClass;(e=o(e,{offline:!1,onSelectlayer:r,clickmap:!0,interactionClass:n,spatialMethod:t,toggledTool:{type:"spatialMethod",how:"toggled"},onhover:!0})).geometryTypes=s,a.call(this,e)}var i=e("g3w-ol/constants"),a=e("g3w-ol/controls/interactioncontrol"),o=e("core/utils/ol").merge,s=e("core/utils/geo").Geometry.getAllPolygonGeometryTypes();ol.inherits(n,a),t.exports=n},{"core/utils/geo":64,"core/utils/ol":66,"g3w-ol/constants":75,"g3w-ol/controls/interactioncontrol":83}],79:[function(e,t,r){function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(){var r,n,i,a,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=void 0===(t=e.name)?"":t,o=void 0===(o=e.visible)||o,s=e.enabled,t=(this._enabled=void 0!==s&&s,this.offline=void 0===e.offline||e.offline,this.name=t.split(" ").join("-").toLowerCase(),this.id=this.name+"_"+Math.floor(1e6*Math.random()),this.eventKeys={},this.positionCode=e.position||"tl",this.priority=e.priority||0,e.element||(r="ol-"+this.name.split(" ").join("-").toLowerCase(),n=e.customClass,i=e.tipLabel||this.name,a=e.label||"",s=(new(Vue.extend({functional:!0,render:function(e){var t;return e("div",{class:(l(t={},r,!!r),l(t,"ol-unselectable",!0),l(t,"ol-control",!0),t)},[e("button",{attrs:{type:"button"},directives:[{name:"t-tooltip",value:i}]},[a,e("i",{class:l({},n,!!n)})])])}}))).$mount().$el,e.element=s),e.buttonClickHandler||u.prototype._handleClick.bind(this));$(e.element).on("click",t),ol.control.Control.call(this,e),this.setVisible(o),this._postRender()}var n=e("g3w-ol/controls/utils").layout,e=(ol.inherits(u,ol.control.Control),u.prototype);e.isClickMap=function(){return this.clickmap},e.isToggled=function(){return this._toggled},e.setEventKey=function(e){var t=e.eventType,e=e.eventKey;this.eventKeys[t]={eventKey:e,originalHandler:e.listener}},e.resetOriginalHandlerEvent=function(e){this.eventKeys[e]&&this.eventKeys[e].eventKey&&(ol.Observable.unByKey(this.eventKeys[e].eventKey),this.eventKeys[e].eventKey=this.on(e,this.eventKeys[e].originalHandler))},e.overwriteEventHandler=function(e){var t=e.eventType,e=e.handler;this.eventKeys[t]&&this.eventKeys[t].eventKey&&(ol.Observable.unByKey(this.eventKeys[t].eventKey),this.eventKeys[t].eventKey=this.on(t,e))},e.getPosition=function(e){e=e||this.positionCode;var t={};return t.top=-1<e.indexOf("t"),t.left=-1<e.indexOf("l"),t.bottom=-1<e.indexOf("b"),t.right=-1<e.indexOf("r"),t},e._handleClick=function(e){var t=this,e=(e.preventDefault(),this.getMap()),r=null,e=e.getControls();this._toggled&&e.forEach(function(e){e.id&&e.toggle&&e.id!==t.id&&(e.toggle(!1),"reset"===e.name)&&(r=e)}),!this._toggled&&r&&r.toggle(!0),this.dispatchEvent("controlclick")},e.shiftPosition=function(e){$(this.element).css(hWhere,e+"px")},e.layout=function(e){var t,r;e&&(t=this.getPosition(),r=$(this.element),n({map:e,position:t,element:r}))},e.changelayout=function(e){},e.setMap=function(e){e&&(this.layout(e),ol.control.Control.prototype.setMap.call(this,e))},e.showControl=function(){$(this.element).show()},e.hideControl=function(){var e,t=$(this.element).position().left,r=$(this.element).outerWidth();$(this.element).siblings(".ol-control-tl").each(function(){$(this).position().left>t&&(e=$(this).position().left,r>$(this).outerWidth()&&(t+=r-$(this).outerWidth()),$(this).css("left",t+"px"),t=e,r=$(this).outerWidth())}),$(this.element).hide()},e.setEnable=function(e){$(this.element).find("button").first().toggleClass("g3w-ol-disabled",!e),!e&&this._interaction&&this._interaction.setActive(!1),this._enabled=e},e.getEnable=function(){return this._enabled},e.setVisible=function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this._visible=e,$(this.element)[e?"show":"hide"]()},e.isVisible=function(){return this._visible},e._postRender=function(){},t.exports=u},{"g3w-ol/controls/utils":97}],80:[function(e,t,r){var f=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},n=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e};function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=l(e("store/application-state")),s=l(e("services/gui"));function l(e){return e&&e.__esModule?e:{default:e}}function u(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var p=e("./control"),h=e("core/utils/utils"),g=h.toRawType,v=h.XHR,m=e("g3w-ol/projection/projections"),y={namespace:"ol-geocoder",spin:"gcd-pseudo-rotate",hidden:"gcd-hidden",inputQueryId:"gcd-input-query",inputResetId:"gcd-input-reset",country:"gcd-country",city:"gcd-city",road:"gcd-road",olControl:"ol-control",inputText:{container:"gcd-txt-container",control:"gcd-txt-control",input:"gcd-txt-input",reset:"gcd-txt-reset",result:"gcd-txt-result"}},_={isNumeric:function(e){return/^\d+$/.test(e)},classRegex:function(e){return new RegExp("(^|\\s+) "+e+" (\\s+|$)")},addClass:function(e,t,r){var n=this;if(Array.isArray(e))e.forEach(function(e){return n.addClass(e,t)});else for(var i=Array.isArray(t)?t:t.split(/\s+/),a=i.length;a--;)this.hasClass(e,i[a])||this._addClass(e,i[a],r)},_addClass:function(e,t,r){var n=this;e.classList?e.classList.add(t):e.className=(e.className+" "+t).trim(),r&&this.isNumeric(r)&&setTimeout(function(){return n._removeClass(e,t)},r)},removeClass:function(e,t,r){var n=this;if(Array.isArray(e))e.forEach(function(e){return n.removeClass(e,t,r)});else for(var i=Array.isArray(t)?t:t.split(/\s+/),a=i.length;a--;)this.hasClass(e,i[a])&&this._removeClass(e,i[a],r)},_removeClass:function(e,t,r){var n=this;e.classList?e.classList.remove(t):e.className=e.className.replace(this.classRegex(t)," ").trim(),r&&this.isNumeric(r)&&setTimeout(function(){return n._addClass(e,t)},r)},hasClass:function(e,t){return e.classList?e.classList.contains(t):this.classRegex(t).test(e.className)},toggleClass:function(e,t){var r=this;Array.isArray(e)?e.forEach(function(e){return r.toggleClass(e,t)}):e.classList?e.classList.toggle(t):this.hasClass(e,t)?this._removeClass(e,t):this._addClass(e,t)},find:function(e,t,r){void 0===t&&(t=window.document);var n=Array.prototype.slice,i=[];if(/^(#?[\w-]+|\.[\w-.]+)$/.test(e))switch(e[0]){case"#":i=[this.$(e.substr(1))];break;case".":i=n.call(t.getElementsByClassName(e.substr(1).replace(/\./g," ")));break;default:i=n.call(t.getElementsByTagName(e))}else i=n.call(t.querySelectorAll(e));return r?i:i[0]},$:function(e){return e="#"===e[0]?e.substr(1,e.length):e,document.getElementById(e)},isElement:function(e){return"HTMLElement"in window?!!e&&e instanceof HTMLElement:!!e&&"object"===(void 0===e?"undefined":a(e))&&1===e.nodeType&&!!e.nodeName},getAllChildren:function(e,t){return[].slice.call(e.getElementsByTagName(t))},isEmpty:function(e){return!e||0===e.length},emptyArray:function(e){for(;e.length;)e.pop()},anyMatchInArray:function(e,t){return e.some(function(e){return 0<=t.indexOf(e)})},everyMatchInArrayy:function(t,e){return e.every(function(e){return 0<=t.indexOf(e)})},anyItemHasValue:function(t,r){var n=this;return void 0===r&&(r=!1),Object.keys(t).forEach(function(e){n.isEmpty(t[e])||(r=!0)}),r},removeAllChildren:function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},removeAll:function(e){for(var t=void 0;t=e[0];)t.parentNode.removeChild(t)},getChildren:function(e,t){return[].filter.call(e.childNodes,function(e){return t?1===e.nodeType&&e.tagName.toLowerCase()===t:1===e.nodeType})},template:function(e,r){var n=this;return e.replace(/\{ *([\w_-]+) *\}/g,function(e,t){t=void 0===r[t]?"":r[t];return n.htmlEscape(t)})},htmlEscape:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},createElement:function(e,t){var r=void 0;if(Array.isArray(e)){if(r=document.createElement(e[0]),e[1].id&&(r.id=e[1].id),e[1].classname&&(r.className=e[1].classname),e[1].attr){var n=e[1].attr;if(Array.isArray(n))for(var i=-1;++i<n.length;)r.setAttribute(n[i].name,n[i].value);else r.setAttribute(n.name,n.value)}}else r=document.createElement(e);r.innerHTML=t;for(var a=document.createDocumentFragment();r.childNodes[0];)a.appendChild(r.childNodes[0]);return r.appendChild(a),r}},b=(n(w,[{key:"getParameters",value:function(e){var t=this.settings,r=t.url,n=t.viewbox,t=t.params.limit;return{url:r,params:{q:e.query,format:"json",addressdetails:1,limit:e.limit||t,viewbox:n,bounded:1}}}},{key:"handleResponse",value:function(){var t=this;return{results:(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).filter(function(e){return ol.extent.containsXY(t.settings.extent,e.lon,e.lat)}).map(function(e){return{lon:e.lon,lat:e.lat,address:{name:e.address.neighbourhood||"",road:e.address.road||"",postcode:e.address.postcode,city:e.address.city||e.address.town,state:e.address.state,country:e.address.country},original:{formatted:e.display_name,details:e.address}}}),header:{title:this.id}}}}]),w);function w(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=(d(this,w),this.id="Nominatim (OSM)",this.active=!0,ol.proj.transformExtent(e.viewbox,e.mapCrs,"EPSG:4326"));this.settings={url:"https://nominatim.openstreetmap.org/search",params:{q:"",format:"json",addressdetails:1,limit:10},extent:e,viewbox:e.join(",")}}n(S,[{key:"getParameters",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.lang,r=this.settings,n=r.url,r=r.viewbox;return{url:n,params:{address:e.query,key:o.default.keys.vendorkeys.google,bounds:r,language:t}}}},{key:"handleResponse",value:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=[];return"OK"===e.status?r=e.results.filter(function(e){return ol.extent.containsXY(t.settings.extent,e.geometry.location.lng,e.geometry.location.lat)}).map(function(e){var r=void 0,n=void 0,i=void 0;return e.address_components.forEach(function(e){var t=e.types,e=(e.short_name,e.long_name);t.find(function(e){return"route"===e})?r=e:t.find(function(e){return"locality"===e})?n=e:t.find(function(e){return"country"===e})&&(i=e)}),{lon:e.geometry.location.lng,lat:e.geometry.location.lat,address:{name:r,road:void 0,postcode:"",city:n,state:void 0,country:i},original:{formatted:e.display_name,details:e.address}}}):"REQUEST_DENIED"===e.status&&(this.active=!1),{results:r,header:{title:this.id}}}}]);var x=S;function S(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=(d(this,S),this.id="Google",this.active=void 0!==o.default.keys.vendorkeys.google,ol.proj.transformExtent(e.viewbox,e.mapCrs,"EPSG:4326"));this.settings={url:"https://maps.googleapis.com/maps/api/geocode/json",extent:e,viewbox:e[1]+","+e[0]+"|"+e[3]+","+e[2]}}function L(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=(this.options={provider:"osm",placeholder:e.placeholder||"Città, indirizzo ... ",noresults:e.noresults||"Nessun risultato ",notresponseserver:e.notresponseserver||"Il server non risponde",lang:o.default.language||"it-IT",limit:e.limit||5,keepOpen:!0,preventDefault:!1,autoComplete:!1,autoCompleteMinLength:4,debug:!1,viewbox:e.bbox,bounded:1,mapCrs:e.mapCrs,fontIcon:s.default.getFontClass("search")},this.options),t=e.placeholder,r=e.fontIcon,n=e.mapCrs,e=e.viewbox,i=(this.providers=[new x({mapCrs:n,viewbox:e}),new b({mapCrs:n,viewbox:e})],this.layer=new ol.layer.Vector({source:new ol.source.Vector,style:new ol.style.Style({text:new ol.style.Text({offsetY:-15,text:"",font:'900 3em "Font Awesome 5 Free"',stroke:new ol.style.Stroke({color:"red",width:3}),fill:new ol.style.Fill({color:"rgba(255, 0,0, 0.7)"})})})}),this.projection,y.namespace+" "+y.inputText.container),a=this,n=Vue.extend({functional:!0,render:function(e){return e("div",{class:c({},i,!0)},[e("div",{class:c({},y.inputText.control,!0)},[e("input",{attrs:{type:"text",id:y.inputQueryId,autocomplete:"off"},class:c({},y.inputText.input,!0),directives:[{name:"t-placeholder",value:t}]}),e("button",{attrs:{type:"button",id:"search_nominatim"},class:{btn:!0},on:{click:function(){var e=$("input."+y.inputText.input).val();a.query(e)}}},[e("i",{attrs:{"aria-hidden":!0},style:{color:"#ffffff"},class:c({},r,!0)})]),e("button",{attrs:{type:"button",id:y.inputResetId},class:c({},y.inputText.reset+"  "+y.hidden,!0)})]),e("ul",{class:c({},y.inputText.result,!0)})])}});this.container=(new n).$mount().$el,this.lastQuery="",this.registeredListeners={mapClick:!1},this.showMarker=function(e){var t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{transform:!0}).transform,t=(this.hideMarker(),e=t?ol.proj.transform(e,"EPSG:4326",this.getMap().getView().getProjection()):e,new ol.geom.Point(e)),r=new ol.Feature(t);this.layer.getSource().addFeature(r),this.getMap().addLayer(this.layer),s.default.getService("map").zoomToGeometry(t)},this.hideMarker=function(){this.layer.getSource().clear(),this.getMap().removeLayer(this.layer)},this.createControl=function(){var r=this,n=void 0,i=void 0;this.control=_.find("."+y.inputText.control,this.container),this.input=_.find("."+y.inputText.input,this.container),this.reset=_.find("."+y.inputText.reset,this.container),this.result=_.find("."+y.inputText.result,this.container);this.input.addEventListener("keyup",function(e){var t=e.target.value.trim();(e.key?"Enter"!==e.key:e.which?13!==e.which:!e.keyCode||13!==e.keyCode)||(e.preventDefault(),r.query(t))},!1),this.input.addEventListener("input",function(e){var t=e.target.value.trim();t.length?_.removeClass(r.reset,y.hidden):_.addClass(r.reset,y.hidden),r.options.autoComplete&&t!==i&&(i=t,n&&clearTimeout(n),n=setTimeout(function(){return t.length>=r.options.autoCompleteMinLength&&r.query(t)},200))},!1),this.reset.addEventListener("click",function(){r.input.focus(),r.input.value="",r.lastQuery="",_.addClass(r.reset,y.hidden),r.clearResults()},!1)},this.query=function(d){var r,p=this;return this.hideMarker(),new Promise((r=u(regeneratorRuntime.mark(function e(t,r){var n,i,a,o,s,l,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=null,a=!(n=function(e){return"Number"===g(e)&&!Number.isNaN(e)}),d){l=d.split(","),l=f(l,3),o=l[0],s=l[1],l=l[2],i=n(+o)&&n(+s)?[+o,+s]:null;try{l&&m.get("EPSG:"+l.trim())&&(i=ol.proj.transform(i,m.get("EPSG:"+l.trim()),"EPSG:4326"),a=!0)}catch(e){}}i?(p.showMarker(i,{transform:a}),t(i),e.next=19):e.next=9;break;case 9:if(p.lastQuery===d&&p.result.firstChild)return e.abrupt("return");e.next=11;break;case 11:return u=[],(c=p.providers.filter(function(e){return e.active})).forEach(function(e){var e=e.getParameters({query:d,lang:p.options.lang,countrycodes:p.options.countrycodes,limit:p.options.limit}),t=e.url,e=e.params;p.lastQuery=d,p.clearResults(),_.addClass(p.reset,y.spin),u.push(v.get({url:t,params:e}))}),e.next=16,Promise.allSettled(u);case 16:e.sent.forEach(function(e,t){var r=e.status,e=e.value;"fulfilled"===r&&(e=(r=c[t].handleResponse(e)).header,r=r.results,c[t].active)&&p.createList({header:e,results:r})}),_.removeClass(p.reset,y.spin);case 19:case"end":return e.stop()}},e,p)})),function(e,t){return r.apply(this,arguments)}))},this.createList=function(){var t,n=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.header,e=e.results,e=void 0===e?{}:e,i=this.result;i.appendChild(this.createHeaderProviderResults(r)),e.length?e.forEach(function(t){var r=n.addressTemplate(t.address),e=['<a href="#">',r,"</a>"].join(""),e=_.createElement("li",e);e.addEventListener("click",function(e){e.preventDefault(),n.chosen(t,r,t.address,t.original)},!1),i.appendChild(e)}):(t=this.options.noresults,r=(new(Vue.extend({functional:!0,render:function(e){return e("li",{class:{"nominatim-noresult":!0},directives:[{name:"t",value:t}]})}}))).$mount().$el,i.appendChild(r))},this.chosen=function(e,t,r,n){e=[parseFloat(e.lon),parseFloat(e.lat)];!1===this.options.keepOpen&&this.clearResults(!0),this.showMarker(e)},this.createHeaderProviderResults=function(){var e='\n      <div style="display: flex; justify-content: space-between; padding: 5px">\n        <span  style="color: #FFFFFF; font-weight: bold">'+(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).title+"</span>\n      </div>",e=_.createElement("li",e);return e.classList.add("skin-background-color"),e},this.addressTemplate=function(e){var t=[];return e.name&&t.push(['<div class="',y.road,'">{name}</div>'].join("")),(e.road||e.building||e.house_number)&&t.push(['<div class="',y.road,'">{building} {road} {house_number}</div>'].join("")),(e.city||e.town||e.village)&&t.push(['<div class="',y.city,'">{postcode} {city} {town} {village}</div>'].join("")),(e.state||e.country)&&t.push(['<div class="',y.country,'">{state} {country}</div>'].join("")),_.template(t.join("<br>"),e)},this.expand=function(){var e=this;_.removeClass(this.input,y.spin),_.addClass(this.control,y.glass.expanded),setTimeout(function(){return e.input.focus()},100)},this.collapse=function(){this.input.value="",this.input.blur(),_.addClass(this.reset,y.hidden),this.clearResults()},this.clearResults=function(){_.removeAllChildren(this.result),this.hideMarker()},this.getSource=function(){return this.layer.getSource()},this.addLayer=function(){var t=this,e=this.getMap();e.getLayers().find(function(e){return e===t.layer})||e.addLayer(this.layer)},this.createControl(),p.call(this,{element:this.container,name:"nominatim",offline:!1})}ol.inherits(L,p),t.exports=L},{"./control":79,"core/utils/utils":68,"g3w-ol/projection/projections":111,"services/gui":361,"store/application-state":373}],81:[function(e,t,r){var a=e("g3w-ol/controls/interactioncontrol");function n(){this._layer=new ol.layer.Vector({source:new ol.source.Vector,style:new ol.style.Style({text:new ol.style.Text({offsetY:-15,text:"",font:'900 3em "Font Awesome 5 Free"',fill:new ol.style.Fill({color:"red"})})})}),a.call(this,{visible:!1,offline:!1,name:"geolocation",tipLabel:"sdk.mapcontrols.geolocation.tooltip",label:""})}ol.inherits(n,a);e=n.prototype;e._showMarker=function(e){var t=e.map,r=e.coordinates,e=e.show,e=void 0===e||e;this._layer&&(this._layer.getSource().clear(),e?(t.getView().setCenter(r),e=new ol.Feature({geometry:new ol.geom.Point(r)}),this._layer.getSource().addFeature(e),t.addLayer(this._layer)):t.removeLayer(this._layer))},e.getMap=function(){return a.prototype.getMap.call(this)},e.setMap=function(t){var r=this,n=void 0,i=(a.prototype.setMap.call(this,t),new ol.Geolocation({projection:t.getView().getProjection(),tracking:!0,trackingOptions:{enableHighAccuracy:!0}}));i.on("change:position",function(){var e=i.getPosition();e?(r.isVisible()||(r.setVisible(!0),$(r.element).removeClass("g3w-ol-disabled"),i.dispatchEvent("authorized")),r._showMarker({map:t,coordinates:e,show:r.isToggled()})):r.hideControl()}),i.once("error",function(e){r.hideControl(),r._layer=null,1!==e.code&&r.dispatchEvent("error"),ol.Observable.unByKey(n),n=null}),i.once("authorized",function(){n=r.on("toggled",function(){var e=i.getPosition();r._showMarker({map:t,coordinates:e,show:r.isToggled()})})})},t.exports=n},{"g3w-ol/controls/interactioncontrol":83}],82:[function(e,t,r){var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=e("g3w-ol/controls/screenshotcontrol");function a(){i.call(this,n({name:"maptoimagegeo",tipLabel:"Geo Screenshot",label:""},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}))}ol.inherits(a,i),t.exports=a},{"g3w-ol/controls/screenshotcontrol":95}],83:[function(e,t,r){var a=e("g3w-ol/constants"),o=i(e("services/gui")),n=i(e("store/map-controls"));function i(e){return e&&e.__esModule?e:{default:e}}function g(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=void 0===(r=t.visible)||r,n=void 0===(n=t.enabled)||n,i=void 0!==(a=t.toggled)&&a,a=void 0!==(a=t.clickmap)&&a,o=void 0===(o=t.interactionClass)?null:o,s=void 0!==(s=t.autountoggle)&&s,l=void 0===(l=t.geometryTypes)?[]:l,u=void 0!==(u=t.onhover)&&u,c=void 0===(c=t.help)?null:c,d=t.toggledTool,p=void 0===(p=t.interactionClassOptions)?{}:p,f=t.layers,h=t.spatialMethod;this.layers=void 0===f?[]:f,this.unwatches=[],this.listenLayersVisibilityChange(),this._visible=r,this._toggled=!1,this.clickmap=a,this._interactionClass=o,this._interaction=null,this._autountoggle=s,this._geometryTypes=l,this._onhover=u,this._help=c,this._helpButton,this._toolButton,this.spatialMethod=h,this.toggledTool,this._interactionClassOptions=p,t.buttonClickHandler=g.prototype._handleClick.bind(this),v.call(this,t),!0===i&&this.on("setMap",function(){return e.toggle(i)}),this._help&&this._createModalHelp(),d&&this.createControlTool(d),this.setEnable(n),this.spatialMethod&&this.handleChangeSpatialMethod(this.spatialMethod)}var s=e("core/i18n/i18n.service").t,v=e("g3w-ol/controls/control"),e=(ol.inherits(g,v),g.prototype);e.onSelectLayer=function(){},e.runSpatialQuery=function(){},e.clear=function(){},e.onAddExternalLayer=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.layer,e.unWatches},e.onRemoveExternalLayer=function(e){},e.handleSelectedLayer=function(e){},e.handleExternalSelectedLayer=function(e){},e.checkVisibile=function(e){return!0},e.checkVisibile=function(e){return!0},e.listenLayersVisibilityChange=function(){},e.change=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=(this.layers=e,this.checkVisibile(e));this.setVisible(e),this.setEnable(!1),this.listenLayersVisibilityChange()},e.isClickMap=function(){return this.clickmap},e.enable=function(){$(this.element).removeClass("g3w-disabled")},e.disable=function(){$(this.element).addClass("g3w-disabled")},e.createControlTool=function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.type,n=e.component,e=e.how,e=void 0===e?"toggled":e;switch(r){case"spatialMethod":var i=this.getSpatialMethod();this.toggledTool={data:function(){return this.methods=a.SPATIALMETHODS,{method:i}},template:'\n          <div style="width: 100%; padding: 5px;">\n            <select ref="select" style="width: 100%"  :search="false" v-select2="\'method\'">\n              <option v-for="method in methods">{{method}}</option>\n            </select>\n          </div>',watch:{method:function(e){return t.setSpatialMethod(e)}},created:function(){o.default.setCloseUserMessageBeforeSetContent(!1)},beforeDestroy:function(){o.default.setCloseUserMessageBeforeSetContent(!0)}};break;case"custom":this.toggledTool=n}"hover"===e&&this._createToolOnHoverButton()},e._createToolOnHoverButton=function(){var t=this;this._onhover&&(this._toolButton=$('<span style="display:none" class="tool_mapcontrol_button"><i class="'+o.default.getFontClass("tool")+'"></i></span>'),$(this.element).prepend(this._toolButton),this._toolButton.on("click",function(e){e.stopPropagation(),t.showToggledTool(!0)}),$(this.element).hover(function(){return t._toggled&&t._toolButton.show()}),$(this.element).mouseleave(function(){return t._toolButton.hide()}))},e.showToggledTool=function(){!(0<arguments.length&&void 0!==arguments[0])||arguments[0]?o.default.showUserMessage({title:"",type:"tool",size:"small",closable:!!this._toolButton,hooks:{body:this.toggledTool}}):o.default.closeUserMessage()},e._showModalHelp=function(){o.default.showModalDialog({title:s(this._help.title),message:s(this._help.message)})},e._createModalHelp=function(){var t=this;this._onhover&&(this._helpButton=$('<span style="display:none" class="info_mapcontrol_button">i</span>'),$(this.element).prepend(this._helpButton),this._helpButton.on("click",function(e){e.stopPropagation(),t._showModalHelp()}),$(this.element).hover(function(){return t._helpButton.show()}),$(this.element).mouseleave(function(){return t._helpButton.hide()}))},e.getGeometryTypes=function(){return this._geometryTypes},e.isToggled=function(){return this._toggled},e.getControlBottom=function(){return $(this.element).find("button").first()},e.addClassToControlBottom=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";this.getControlBottom().addClass(e)},e.removeClassToControlBottom=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";this.getControlBottom().removeClass(e)},e.toggle=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!this._toggled;this._toggled!==e&&((this._toggled=e)?(this._interaction&&this._interaction.setActive(!0),this.addClassToControlBottom("g3w-ol-toggled"),this._toolButton&&this._toolButton.show()):(this._help&&this._helpButton.hide(),this._interaction&&this._interaction.setActive(!1),this.removeClassToControlBottom("g3w-ol-toggled"),this._toolButton&&this._toolButton.hide(),this.toggledTool&&this.showToggledTool(!1)),void 0===this._toolButton&&this.toggledTool&&this.showToggledTool(this._toggled),this.dispatchEvent({type:"toggled",toggled:e}))},e.getGeometryTypes=function(){return this._geometryTypes},e.setGeometryTypes=function(e){this._geometryTypes=e},e.setMap=function(e){v.prototype.setMap.call(this,e),!this._interaction&&this._interactionClass&&(this._interaction=new this._interactionClass(this._interactionClassOptions),e.addInteraction(this._interaction),this._interaction.setActive(!1)),this.dispatchEvent({type:"setMap",map:e})},e._handleClick=function(e){this._enabled&&(this.toggle(),v.prototype._handleClick.call(this,e))},e.getInteraction=function(){return this._interaction},e.setSpatialMethod=function(){this.spatialMethod=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"intersects",this.dispatchEvent({type:"change-spatial-method",spatialMethod:this.spatialMethod})},e.getSpatialMethod=function(){return this.spatialMethod},e.setLayers=function(){this.layers=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]},e.setSelectedLayer=function(e){n.default.setSelectedLayer(e)},e.getSelectedLayer=function(){return n.default.getSelectedLayer()},e.getExternalLayers=function(){return n.default.getExternalLayers()},e.handleChangeSpatialMethod=function(t){var r=this,n=null;this.on("toggled",function(e){!0===e.toggled?n=r.on("change-spatial-method",r.runSpatialQuery):null!==n&&(ol.Observable.unByKey(n),n=null,r.setSpatialMethod(t),r.clear())})},e.watchLayer=function(e,t){return a.VM.$watch(e,t)},e.isSelectedLayerVisible=function(){return"function"==typeof this.getSelectedLayer().isVisible?this.getSelectedLayer().isVisible():this.getSelectedLayer().visible},e.hasVisibleProjectLayer=function(){return!!(0<this.layers.length&&this.layers.find(function(e){return e.isVisible()}))},e.hasVisibleExternalLayer=function(){var t=this;return!!this.getExternalLayers().find(function(e){return e!==t.layer&&!0===e.visible})},e.hasVisibleLayers=function(){return!(!this.hasVisibleProjectLayer()&&!this.hasVisibleExternalLayer())},e.addExternalLayerToResult=function(){var t=this;return null===this.getSelectedLayer()||void 0!==this.getExternalLayers().find(function(e){return e===t.getSelectedLayer()})},e.isExternalLayerSelected=function(){var t=this;return null!==this.getSelectedLayer()&&void 0!==this.getExternalLayers().find(function(e){return e===t.getSelectedLayer()})},t.exports=g},{"core/i18n/i18n.service":13,"g3w-ol/constants":75,"g3w-ol/controls/control":79,"services/gui":361,"store/map-controls":376}],84:[function(e,t,r){function n(){var e=i.merge(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},{tipLabel:"sdk.mapcontrols.measures.length.tooltip",label:"",clickmap:!0,interactionClass:a});o.call(this,e)}var i=e("core/utils/ol"),a=e("g3w-ol/interactions/lengthinteraction"),o=e("g3w-ol/controls/measurecontrol");ol.inherits(n,o),t.exports=n},{"core/utils/ol":66,"g3w-ol/controls/measurecontrol":85,"g3w-ol/interactions/lengthinteraction":103}],85:[function(e,t,r){function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._map=null,i.call(this,e)}var i=e("g3w-ol/controls/interactioncontrol"),e=(ol.inherits(n,i),n.prototype);e.setMap=function(e){i.prototype.setMap.call(this,e)},e.toggle=function(e){i.prototype.toggle.call(this,e),!this.isToggled()&&this.getInteraction()&&this.getInteraction().clear()},t.exports=n},{"g3w-ol/controls/interactioncontrol":83}],86:[function(e,t,r){function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.target=e.target||"mouse-position-control",ol.control.MousePosition.call(this,e)}ol.inherits(n,ol.control.MousePosition);t=(t.exports=n).prototype;t.offline=!0,t.setEnable=function(e){$(this.element)},t.setMap=function(e){e&&($(this.element).removeClass("ol-control"),ol.control.MousePosition.prototype.setMap.call(this,e))}},{}],87:[function(e,t,r){function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};switch(this._control=null,this.positionCode=e.position||"tl",e.type){case"zoom":this._control=new ol.control.Zoom(e);break;case"zoomtoextent":this._control=new ol.control.ZoomToExtent(e);break;case"scaleline":this._control=new ol.control.ScaleLine(e);break;case"overview":this._control=new ol.control.OverviewMap(e)}$(this._control.element).addClass("ol-control-"+this.positionCode),ol.control.Control.call(this,{element:this._control.element})}ol.inherits(n,ol.control.Control);t=(t.exports=n).prototype;t.offline=!0,t.getOlControl=function(){return this._control},t.getPosition=function(e){e=e||this.positionCode;var t={};return t.top=-1<e.indexOf("t"),t.left=-1<e.indexOf("l"),t},t.layout=function(e){var t,r;e&&(t=this.getPosition(),e=e.getViewport(),(e=$(e).find(".ol-control-"+this.positionCode)).length)&&(previusControl=e.last(),e=t.left?previusControl.position().left:previusControl.position().right,t=t.left?"left":"right",r=previusControl[0].offsetWidth,e=$(this.element).position()[t]+e+r+2,$(this.element).css(t,e+"px"))},t.changelayout=function(){},t.showHide=function(){$(this.element).toggle()},t.setMap=function(e){this.layout(e),this._control.setMap(e)}},{}],88:[function(e,t,r){function i(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var a=e("g3w-ol/controls/control");function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._originalonlick=null,this._onclick=e.onclick,a.call(this,e)}ol.inherits(n,a);e=n.prototype;e.overwriteOnClickEvent=function(e){this._originalonlick=this._originalonlick||this._onclick,this._onclick=e},e.resetOriginalOnClickEvent=function(){this._onclick=this._originalonlick||this._onclick,this._originalonlick=null},e.setMap=function(e){var t=this,e=(a.prototype.setMap.call(this,e),$(this.element)),r=e.children("button"),n=!1;e.on("click",i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n)e.next=9;else{if(n=!0,r.addClass("g3w-ol-disabled"),e.t0=t._onclick,e.t0)return e.next=7,t._onclick();e.next=7}break;case 7:r.removeClass("g3w-ol-disabled"),n=!1;case 9:case"end":return e.stop()}},e,t)})))},t.exports=n},{"g3w-ol/controls/control":79}],89:[function(e,t,r){var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=e("g3w-ol/constants"),o=l(e("services/gui")),n=l(e("services/data")),s=l(e("store/projects"));function l(e){return e&&e.__esModule?e:{default:e}}function u(){var r=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=void 0===(t=e.spatialMethod)?a.SPATIALMETHODS[0]:t;this._startCoordinate=null,this.unwatches=[];(n=o.default.getService("map").filterableLayersAvailable(h)||[]).forEach(function(e){return e.setTocHighlightable(!0)});var n=i({},e,{layers:n,offline:!1,name:"querybbox",tipLabel:"sdk.mapcontrols.querybybbox.tooltip",label:e.label||"",clickmap:!0,interactionClass:ol.interaction.DragBox,onhover:!0,toggledTool:{type:"spatialMethod",how:"toggled"},spatialMethod:t,help:{title:"sdk.mapcontrols.querybybbox.help.title",message:"sdk.mapcontrols.querybybbox.help.message"}});p.call(this,n),this.setEnable(this.hasVisibleLayers()),this.bbox=null,this.on("toggled",function(e){var t=e.toggled;r.getExternalLayers().forEach(function(e){return e.tochighlightable=t})})}var c,d=e("core/utils/utils").throttle,p=e("g3w-ol/controls/interactioncontrol"),f={SELECTED_OR_ALL:!0,FILTERABLE:!0,VISIBLE:!0},h={filtrable:{ows:"WFS"}},e=(ol.inherits(u,p),u.prototype);e.change=function(){this.layers=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],this.setEnable(this.hasVisibleLayers()),this.listenLayersVisibilityChange()},e.checkVisible=function(){return 0<this.layers.length||0<this.getExternalLayers().length},e.setMap=function(e){var t=this;p.prototype.setMap.call(this,e),this._interaction.on("boxstart",function(e){return t._startCoordinate=e.coordinate}),this._interaction.on("boxend",d(function(e){t.bbox=ol.extent.boundingExtent([t._startCoordinate,e.coordinate]),t.dispatchEvent({type:"bboxend",extent:t.bbox}),t._startCoordinate=null,t._autountoggle&&t.toggle()})),this.setEventKey({eventType:"bboxend",eventKey:this.on("bboxend",this.runSpatialQuery)})},e.onSelectLayer=function(t){var e;t?(e=this.layers.find(function(e){return e===t}),this.setEnable(!!e&&e.isVisible())):this.setEnable(this.hasVisibleLayers()),this.toggle(this.isToggled()&&this.getEnable())},e.listenLayersVisibilityChange=function(){var r=this;this.unwatches.forEach(function(e){return e()}),this.unwatches.splice(0),this.layers.forEach(function(t){r.unwatches.push(r.watchLayer(function(){return t.state.visible},function(e){!0===t.state.selected?r.setEnable(e):r.setEnable(r.hasVisibleLayers()),r.toggle(r.isToggled()&&r.getEnable())}))})},e.runSpatialQuery=(c=regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null===this.bbox)return e.abrupt("return");e.next=2;break;case 2:return o.default.closeOpenSideBarComponent(),e.prev=3,e.next=6,n.default.getData("query:bbox",{inputs:{bbox:this.bbox,feature_count:s.default.getCurrentProject().getQueryFeatureCount(),addExternal:this.addExternalLayerToResult(),layersFilterObject:f,filterConfig:{spatialMethod:this.getSpatialMethod()},condition:h,multilayers:s.default.getCurrentProject().isQueryMultiLayers(this.name)}});case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3);case 11:case"end":return e.stop()}},e,this,[[3,8]])}),function(){var s=c.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}),e.onAddExternalLayer=function(e){var t=this,r=e.layer,e=e.unWatches;r.tochighlightable=this.isToggled()&&this.getEnable(),e.push(this.watchLayer(function(){return r.selected},function(e){t.setEnable(!0===e?r.visible:t.hasVisibleLayers()),t.toggle(t.isToggled()&&t.getEnable())})),e.push(this.watchLayer(function(){return r.visible},function(){t.setEnable(t.hasVisibleLayers()),t.toggle(t.isToggled()&&t.getEnable())})),this.setEnable(this.hasVisibleLayers())},e.onRemoveExternalLayer=function(){this.setEnable(this.isThereVisibleLayerNotSelected())},e.clear=function(){this.bbox=null},t.exports=u},{"core/utils/utils":68,"g3w-ol/constants":75,"g3w-ol/controls/interactioncontrol":83,"services/data":358,"services/gui":361,"store/projects":379}],90:[function(e,t,r){var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=s(e("services/gui")),a=s(e("services/data")),o=s(e("store/projects"));function s(e){return e&&e.__esModule?e:{default:e}}function l(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=i.default.getService("map").filterableLayersAvailable({filtrable:{ows:"WFS"}})||[],e=n({},e,{name:"querybydrawpolygon",tipLabel:"sdk.mapcontrols.querybydrawpolygon.tooltip",customClass:i.default.getFontClass("draw"),clickmap:!0,interactionClass:ol.interaction.Draw,interactionClassOptions:{type:"Polygon"},layers:t,help:{title:"sdk.mapcontrols.querybybbox.help.title",message:"sdk.mapcontrols.querybybbox.help.message"}});d.call(this,e),this.setEnable(this.hasVisibleLayers()),this.feature=null}var u,c=e("core/utils/utils").throttle,d=e("g3w-ol/controls/basequerypolygoncontrol"),e=(ol.inherits(l,d),l.prototype);e.setMap=function(e){var t=this;d.prototype.setMap.call(this,e),this._interaction.on("drawend",c(function(e){t.feature=e.feature,t.dispatchEvent({type:"drawend",feature:t.feature}),t._autountoggle&&t.toggle()})),this.setEventKey({eventType:"drawend",eventKey:this.on("drawend",this.runSpatialQuery)})},e.onSelectLayer=function(t){var e;t?(e=this.layers.find(function(e){return e===t}),this.setEnable(!!e&&e.isVisible())):this.setEnable(this.hasVisibleLayers()),this.toggle(this.isToggled()&&this.getEnable())},e.listenLayersVisibilityChange=function(){var t=this;this.unwatches.forEach(function(e){return e()}),this.unwatches.splice(0),this.layers.forEach(function(e){t.unwatches.push(t.watchLayer(function(){return e.state.visible},function(e){null===t.getSelectedLayer()?t.setEnable(t.hasVisibleLayers()):t.setEnable(t.isSelectedLayerVisible()),t.toggle(t.isToggled()&&t.getEnable())}))})},e.onAddExternalLayer=function(e){var t=this,r=e.layer,e=e.unWatches;e.push(this.watchLayer(function(){return r.selected},function(e){t.setEnable(!0===e?r.visible:t.hasVisibleLayers()),t.toggle(t.isToggled()&&t.getEnable())})),e.push(this.watchLayer(function(){return r.visible},function(e){t.setEnable(!0===r.selected?e:t.hasVisibleLayers()),t.toggle(t.isToggled()&&t.getEnable())})),this.setEnable(this.hasVisibleLayers())},e.onRemoveExternalLayer=function(){this.setEnable(this.hasVisibleLayers())},e.runSpatialQuery=(u=regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i.default.closeOpenSideBarComponent(),e.prev=1,e.next=4,a.default.getData("query:polygon",{inputs:{layerName:"Draw",feature:this.feature,excludeSelected:null===this.getSelectedLayer(),external:{add:this.addExternalLayerToResult(),filter:{SELECTED:this.isExternalLayerSelected()}},filterConfig:{spatialMethod:this.getSpatialMethod()},multilayers:o.default.getCurrentProject().isQueryMultiLayers(this.name)},outputs:{show:function(e){e=e.error;return!(void 0!==e&&e)}}});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1);case 9:case"end":return e.stop()}},e,this,[[1,6]])}),function(){var s=u.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}),e.clear=function(){this.feature=null},t.exports=l},{"core/utils/utils":68,"g3w-ol/controls/basequerypolygoncontrol":78,"services/data":358,"services/gui":361,"store/projects":379}],91:[function(e,t,r){var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=s(e("services/gui")),a=s(e("services/data")),o=s(e("store/projects"));function s(e){return e&&e.__esModule?e:{default:e}}function l(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}function u(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function c(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=f({QUERYABLE:!0,SELECTED_OR_ALL:!0}),r=i.default.getService("map").filterableLayersAvailable(y),e=n({},e,{offline:!1,enabled:!1,name:"querybypolygon",tipLabel:"sdk.mapcontrols.querybypolygon.tooltip",label:e.label||"",interactionClass:v,layers:r.length?[].concat(u(new Set([].concat(u(r),u(t))))):[],help:{title:"sdk.mapcontrols.querybypolygon.help.title",message:"sdk.mapcontrols.querybypolygon.help.message"}});g.call(this,e),this.data={layer:null,feature:null,coordinates:null}}var d=e("core/utils/utils").throttle,p=e("core/utils/geo"),f=p.getMapLayersByFilter,h=p.Geometry,g=e("g3w-ol/controls/basequerypolygoncontrol"),v=e("g3w-ol/interactions/pickcoordinatesinteraction"),m=h.getAllPolygonGeometryTypes(),y={filtrable:{ows:"WFS"}},p=(ol.inherits(c,g),c.prototype);p.change=function(){this.layers=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],this.setEnable(!1),this.listenLayersVisibilityChange()},p.checkVisibile=function(e){var t;return!(!e.length||1===e.length)&&(t=e.filter(function(e){return e.isFilterable()}),1===(e=e.filter(function(e){return-1!==m.indexOf(e.getGeometryType())})).length&&1===t.length?t[0]!==e[0]:0<e.length&&0<t.length)},p.setMap=function(e){var t,r=this;g.prototype.setMap.call(this,e),this._interaction.on("picked",d((t=l(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r.data.coordinates=t.coordinate,r.dispatchEvent({type:"picked",coordinates:r.data.coordinates}),r._autountoggle&&r.toggle();case 3:case"end":return e.stop()}},e,r)})),function(e){return t.apply(this,arguments)}))),this.setEventKey({eventType:"picked",eventKey:this.on("picked",this.getPolygonFeatureFromCoordinates)}),this.setEnable(!1)},p.onSelectLayer=function(e){e&&e.isQueryable()&&-1!==this.getGeometryTypes().indexOf(e.getGeometryType())?(this.setEnable(this.isThereVisibleLayerNotSelected()),this.toggle(this.isToggled()&&this.getEnable())):(this.setEnable(!1),this.toggle(!1))},p.listenLayersVisibilityChange=function(){var r=this;this.unwatches.forEach(function(e){return e()}),this.unwatches.splice(0),this.layers.forEach(function(t){r.unwatches.push(r.watchLayer(function(){return t.state.visible},function(e){t===r.getSelectedLayer()?r.setEnable(e&&r.isThereVisibleLayerNotSelected()):r.setEnable(r.isThereVisibleLayerNotSelected()),r.toggle(r.isToggled()&&r.getEnable())}))})},p.getPolygonFeatureFromCoordinates=l(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i.default.closeOpenSideBarComponent(),e.prev=1,e.next=4,a.default.getData("query:coordinates",{inputs:{feature_count:o.default.getCurrentProject().getQueryFeatureCount(),coordinates:this.data.coordinates},outputs:{show:function(e){var t=e.data,e=e.query,t=0===(void 0===t?[]:t).length;return e.coordinates=t?e.coordinates:null,t}}});case 4:t=e.sent,t=t.data,(t=void 0===t?[]:t).length&&t[0].features.length&&(this.data.feature=t[0].features[0],this.data.layer=t[0].layer,this.runSpatialQuery()),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1);case 13:case"end":return e.stop()}},e,this,[[1,10]])})),p.isThereVisibleLayerNotSelected=function(){var t=this;return!(!this.getSelectedLayer()||!this.isSelectedLayerVisible()||!this.layers.find(function(e){return e!==t.getSelectedLayer()&&e.isVisible()&&e.isFilterable(y.filtrable)})&&!this.getExternalLayers().find(function(e){return e!==t.getSelectedLayer()&&!0===e.visible}))},p.listenPolygonLayersChange=function(){this.listenLayersVisibilityChange()},p.onAddExternalLayer=function(e){var t=this,r=e.layer,e=e.unWatches;h.isPolygonGeometryType(r.geometryType)&&(e.push(this.watchLayer(function(){return r.selected},function(e){!0===e?t.setEnable(r.visible&&t.isThereVisibleLayerNotSelected()):t.setEnable(!1),t.toggle(t.isToggled()&&t.getEnable())})),e.push(this.watchLayer(function(){return r.visible},function(e){r.selected?t.setEnable(e&&t.isThereVisibleLayerNotSelected()):t.setEnable(t.isThereVisibleLayerNotSelected()),t.toggle(t.isToggled()&&t.getEnable())}))),this.setEnable(this.isThereVisibleLayerNotSelected())},p.onRemoveExternalLayer=function(){this.setEnable(this.isThereVisibleLayerNotSelected())},p.runSpatialQuery=l(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null===this.data.coordinates||null===this.data.feature||null===this.data.layer)return e.abrupt("return");e.next=2;break;case 2:return e.next=4,a.default.getData("query:polygon",{inputs:{layerName:this.data.layer.getName?this.data.layer.getName():this.data.layer.get("name"),excludeSelected:!0,feature:this.data.feature,external:{add:!0,filter:{SELECTED:!1}},filterConfig:{spatialMethod:this.getSpatialMethod()},multilayers:o.default.getCurrentProject().isQueryMultiLayers(this.name)},outputs:{show:function(e){e=e.error;return!(void 0!==e&&e)}}});case 4:case"end":return e.stop()}},e,this)})),p.clear=function(){this.data.layer=this.data.feature=this.data.coordinates=null},t.exports=c},{"core/utils/geo":64,"core/utils/utils":68,"g3w-ol/controls/basequerypolygoncontrol":78,"g3w-ol/interactions/pickcoordinatesinteraction":105,"services/data":358,"services/gui":361,"store/projects":379}],92:[function(e,t,r){var i=n(e("services/gui")),a=n(e("store/projects")),o=n(e("services/data"));function n(e){return e&&e.__esModule?e:{default:e}}function s(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}function l(){var e={offline:!1,name:"querylayer",tipLabel:"sdk.mapcontrols.query.tooltip",label:(t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).label||"",clickmap:!0,interactionClass:f},t=d.merge(t,e);p.call(this,t)}var u,c=e("core/utils/utils").throttle,d=e("core/utils/ol"),p=e("g3w-ol/controls/interactioncontrol"),f=e("g3w-ol/interactions/pickcoordinatesinteraction"),e=(ol.inherits(l,p),l.prototype);e.setMap=function(t){var r=this,n=null;this.on("toggled",function(e){!0!==e.toggled?(ol.Observable.unByKey(n),n=null):null===n&&t&&(n=t.on("singleclick",c(function(e){return r.dispatchEvent({type:"picked",coordinates:e.coordinate})})))}),this.setEventKey({eventType:"picked",eventKey:this.on("picked",this.runQuery)}),p.prototype.setMap.call(this,t)},e.runQuery=(u=s(regeneratorRuntime.mark(function e(t){var r,n=t.coordinates;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i.default.closeOpenSideBarComponent(),e.prev=1,r=a.default.getCurrentProject(),e.next=5,o.default.getData("query:coordinates",{inputs:{coordinates:n,feature_count:r.getQueryFeatureCount(),query_point_tolerance:r.getQueryPointTolerance(),multilayers:r.isQueryMultiLayers(this.name)}});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1);case 10:case"end":return e.stop()}},e,this,[[1,7]])})),function(e){return u.apply(this,arguments)}),t.exports=l},{"core/utils/ol":66,"core/utils/utils":68,"g3w-ol/controls/interactioncontrol":83,"g3w-ol/interactions/pickcoordinatesinteraction":105,"services/data":358,"services/gui":361,"store/projects":379}],93:[function(e,t,r){function n(e){this._toggled=!0,this._startCoordinate=null,e=i.merge(e,{name:"reset",tipLabel:"Pan",label:""}),a.call(this,e)}var i=e("core/utils/ol"),a=e("g3w-ol/controls/interactioncontrol");ol.inherits(n,a),(t.exports=n).prototype._postRender=function(){this.toggle(!0)}},{"core/utils/ol":66,"g3w-ol/controls/interactioncontrol":83}],94:[function(e,t,r){function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.isMobile=e.isMobile||!1,e.target="scale-control",ol.control.Control.call(this,e)}var i=e("app/constant"),l=e("core/i18n/i18n.service").t,e=e("core/utils/ol"),u=e.getResolutionFromScale,c=e.getScaleFromResolution,e=(ol.inherits(n,ol.control.Control),(t.exports=n).prototype);e.offline=!0,e.changelayout=function(e){this.position,$(this.element)},e.layout=function(r){var n=this,i=!1,a=!1,t=$(this.element).children("select").select2({tags:!0,dropdownParent:$(r.getTargetElement()),width:"120px",height:"20px",language:{noResults:function(e){return l("sdk.mapcontrols.scale.no_valid_scale")}},minimumResultsForSearch:this.isMobile?-1:0,createTag:function(e){var t=null,r=void 0;return-1!==e.term.indexOf("1:")?r=e.term.split("1:")[1]:Number.isInteger(Number(e.term))&&0<Number(e.term)&&+(r=Number(e.term))<=n.scales[0]&&(t={id:r,text:"1:"+e.term,new:!0},o()),t}});function o(){t.find("option").each(function(e,t){return-1===n.scales.indexOf(+t.value)&&$(t).remove()})}function s(e){(t.find("option[value='"+e.id+"']").length?t.val(e.id):(o(),e=new Option(e.text,e.id,!0,!0),t.append(e))).trigger("change")}r.on("change:size",function(){return t.select2("close")}),r.on("moveend",function(){var e,t;i?(t=(e=this.getView()).getResolution(),e=e.getProjection().getUnits(),s({id:t=parseInt(c(t,e)),text:"1:"+t,new:!0}),i=!1):a=!1});function e(){r.getView().on("change:resolution",function(){return i=!a})}e(),r.on("change:view",e),t.on("select2:select",function(e){a=!0;var e=e.params.data,t=(e.new&&(o(),s(e)),r.getView().getProjection().getUnits()),e=+e.id,e=u(e,t);r.getView().setResolution(e)})},e._setScales=function(e){var t=e.getView().getProjection().getUnits(),e=e.getView().getResolution(),r=parseInt(c(e,t));this.scales=i.PRINT_SCALES.map(function(e){return e.value}).filter(function(e){return e<r}),this.scales.unshift(r),this._createControl()},e._createControl=function(){var e,t=document.createElement("div"),r=document.createElement("select"),n=document.createElement("optgroup");n.label="",this.scales.forEach(function(e,t){var r=document.createElement("option");r.value=e,r.text="1:"+e,r.selected=0===t,n.appendChild(r)}),r.appendChild(n),this.isMobile||((e=document.createElement("optgroup")).label="Custom",r.appendChild(e)),t.appendChild(r),this.element=t,$(this.element).css("height","20px")},e.setMap=function(e){e&&(this._setScales(e),this.layout(e),ol.control.Control.prototype.setMap.call(this,e))}},{"app/constant":4,"core/i18n/i18n.service":13,"core/utils/ol":66}],95:[function(e,t,r){var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=e("services/gui"),a=(i=i)&&i.__esModule?i:{default:i};var o=e("core/utils/utils").sameOrigin,s=e("g3w-ol/controls/onclickcontrol");function l(){var e=n({name:"maptoimage",tipLabel:"Screenshot",label:"",toggled:!1,visible:!0,layers:[]},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{});this.layers=e.layers,s.call(this,e),this.setVisible(this.checkVisible(this.layers)),this.isVisible()&&(a.default.getService("map").onafter("loadExternalLayer",this._addLayer.bind(this)),a.default.getService("map").onafter("unloadExternalLayer",this._removeLayer.bind(this)))}ol.inherits(l,s);i=l.prototype;function u(e){var t,r=void 0;return!((t=e).getVisible&&!t.getVisible()||e instanceof ol.layer.Vector)&&((t=e)instanceof ol.layer.Tile||t instanceof ol.layer.Image?(r=e.getSource().getUrl())&&!o(r,location):!(!(t=e).getConfig().source||!t.getConfig().source.external)&&(r=e.getConfig().source.url)&&!o(r,location))}i._addLayer=function(e){var t=this;this.layers.push(e),this.change(this.layers),e.on("change:visible",function(){return t.change(t.layers)})},i._removeLayer=function(t){this.layers=this.layers.filter(function(e){return e!==t}),this.change(this.layers)},i.change=function(){this.setVisible(this.checkVisible(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]))},i.checkVisible=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return this.isVisible()&&!e.some(u)},t.exports=l},{"core/utils/utils":68,"g3w-ol/controls/onclickcontrol":88,"services/gui":361}],96:[function(e,t,r){var n=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=o(e("store/application-state")),a=o(e("services/gui"));function o(e){return e&&e.__esModule?e:{default:e}}function s(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r={offline:!1,visible:!0,name:"streetview",tipLabel:"StreetView",clickmap:!0,label:"",interactionClass:p},n=(this.key=i.default.keys.vendorkeys.google,this.keyError,this.key&&l.get({url:f+"streetview?location=0,0&size=456x456&key="+this.key}).catch(function(e){return t.keyError=e.responseText}),$script(f+"js?"+(this.key?"key="+this.key:"")),this._sv=null,this._panorama=null,this._map=null,this._projection=null,this._lastposition=null,this._streetViewFeature=new ol.Feature,new ol.source.Vector({features:[]}));this.active=!1,this._layer=new ol.layer.Vector({source:n,style:function(e){var e=e.getGeometry().getCoordinates(),t=(this._lastposition=this._lastposition||e,e[0]-this._lastposition[0]),r=e[1]-this._lastposition[1],r=-Math.atan2(r,t),t=[new ol.style.Style({text:new ol.style.Text({text:"",font:"bold 18px icomoon",fill:new ol.style.Fill({color:"#ffffff"})})}),new ol.style.Style({image:new ol.style.Icon({src:"/static/client/images/streetviewarrow.png",rotation:r})})];return this._lastposition=e,t}}),e=u.merge(e,r),d.call(this,e)}var l=e("core/utils/utils").XHR,u=e("core/utils/ol"),c=e("gui/streetview/vue/streetview"),d=e("g3w-ol/controls/interactioncontrol"),p=e("g3w-ol/interactions/pickcoordinatesinteraction"),f="https://maps.googleapis.com/maps/api/",e=(ol.inherits(s,d),s.prototype);e.setProjection=function(e){this._projection=e},e.setPosition=function(e){var r,t=this,n=this;this.active=!0;this._sv||(this._sv=new google.maps.StreetViewService),this._sv.getPanorama({location:e},function(e,t){n._panorama=new google.maps.StreetViewPanorama(document.getElementById("streetview"),{imageDateControl:!0}),n._panorama.addListener("position_changed",function(){var e;n.isToggled()&&(e=ol.proj.transform([this.getPosition().lng(),this.getPosition().lat()],"EPSG:4326",n._projection.getCode()),n._streetViewFeature.setGeometry(new ol.geom.Point(e)),(r=n._map.getPixelFromCoordinate(e))[0]+15>n._map.getSize()[0]||r[1]+15>n._map.getSize()[1]||r[0]<15||r[1]<15)&&n._map.getView().setCenter(e)}),e&&e.location&&(n._panorama.setPov({pitch:0,heading:0}),n._panorama.setPosition(e.location.latLng))}).then(function(e){void 0===e&&a.default.closeContent()}).catch(function(){return t.toggle()})},e.setMap=function(e){var t=this;this._map=e,d.prototype.setMap.call(this,e),this.setProjection(this._map.getView().getProjection()),this._map.addLayer(this._layer),this._interaction.on("picked",function(e){e=e.coordinate;t.showStreetView(e),t._autountoggle&&t.toggle()})},e.showStreetView=function(e){var t=ol.proj.transform(e,this._map.getView().getProjection().getCode(),"EPSG:4326"),t=n(t,2),r=t[0],t=t[1];this.key?(a.default.setContent({content:new c({keyError:this.keyError}),title:"StreetView"}),this.keyError||this.setPosition({lng:r,lat:t})):(this._streetViewFeature.setGeometry(new ol.geom.Point(e)),window.open("https://www.google.com/maps/@?api=1&map_action=pano&viewpoint="+t+","+r))},e.clearMarker=function(){this._streetViewFeature.setGeometry(null)},e.clear=function(){this._layer.getSource().clear(),this._streetViewFeature.setGeometry(null),this.clearMarker(),this._panorama=null,this.active&&a.default.closeContent(),this.active=!1},e.toggle=function(e){d.prototype.toggle.call(this,e),this.isToggled()?this._layer.getSource().addFeatures([this._streetViewFeature]):this.clear()},t.exports=s},{"core/utils/ol":66,"core/utils/utils":68,"g3w-ol/controls/interactioncontrol":83,"g3w-ol/interactions/pickcoordinatesinteraction":105,"gui/streetview/vue/streetview":182,"services/gui":361,"store/application-state":373}],97:[function(e,t,r){var e=e("core/utils/ol.controls"),e=(e=e)&&e.__esModule?e:{default:e};t.exports=e.default},{"core/utils/ol.controls":65}],98:[function(e,t,r){function n(e){this._startCoordinate=null;var t={name:"zoombox",tipLabel:"Zoom to box",label:"",interactionClass:ol.interaction.DragBox};e=Object.assign({},e,t),i.call(this,e)}var i=e("g3w-ol/controls/interactioncontrol");ol.inherits(n,i),(t.exports=n).prototype.setMap=function(e){var r=this;i.prototype.setMap.call(this,e),this._interaction.on("boxstart",function(e){return r._startCoordinate=e.coordinate}),this._interaction.on("boxend",function(e){var t=r._startCoordinate,e=e.coordinate,t=ol.extent.boundingExtent([t,e]);r.dispatchEvent({type:"zoomend",extent:t}),r._startCoordinate=null,r._autountoggle&&r.toggle()})}},{"g3w-ol/controls/interactioncontrol":83}],99:[function(e,t,r){var n=e("components/MapControlZoomHistory.vue"),i=(n=n)&&n.__esModule?n:{default:n};var a=e("g3w-ol/controls/control");function o(){var e=Vue.extend(i.default);a.call(this,{name:"zoomhistory",tipLabel:"sdk.mapcontrols.addlayer.tooltip",element:(new e).$mount().$el})}ol.inherits(o,a);n=o.prototype;n.setMap=function(e){a.prototype.setMap.call(this,e)},n.layout=function(e){a.prototype.layout.call(this,e)},t.exports=o},{"components/MapControlZoomHistory.vue":256,"g3w-ol/controls/control":79}],100:[function(e,t,r){var n=e("core/utils/ol"),e=e("g3w-ol/map/maphelpers"),n=n.merge({},e);t.exports={helpers:n}},{"core/utils/ol":66,"g3w-ol/map/maphelpers":109}],101:[function(e,t,r){function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.geometryType="Polygon",i.call(this,e)}var i=e("g3w-ol/interactions/measureinteraction");ol.inherits(n,i),t.exports=n},{"g3w-ol/interactions/measureinteraction":104}],102:[function(e,t,r){function n(e,t,r,n){this.type=e,this.features=r,this.coordinate=n}function i(e){ol.interaction.Pointer.call(this,{handleDownEvent:i.handleDownEvent_,handleMoveEvent:i.handleMoveEvent_,handleUpEvent:i.handleUpEvent_,handleEvent:i.handleEvent_}),this.previousCursor_=void 0,this.startCursor_=void 0,this.lastCoordinate_=null,this.features_=void 0!==e.features?e.features:null,this.layer_=void 0!==e.layer?e.layer:null,this.map_=null}ol.inherits(i,ol.interaction.Pointer),i.handleEvent_=function(e){return"keydown"!=e.type?ol.interaction.Pointer.handleEvent.call(this,e):this.features_.getArray().length&&46==e.originalEvent.keyCode?(this.dispatchEvent(new n("deleteend",this.layer_,this.features_,event.coordinate)),!0):void 0},i.handleDownEvent_=function(e){return this.lastFeature_=this.featuresAtPixel_(e.pixel,e.map),!!this.lastFeature_&&(i.handleMoveEvent_.call(this,e),this.dispatchEvent(new n("deleteend",this.layer_,this.features_,e.coordinate)),!0)},i.handleMoveEvent_=function(e){var r=this,t=(this.map_=e.map,this.map_.getTargetElement());void 0===this.startCursor_&&(this.startCursor_=t.style.cursor),this.map_.forEachFeatureAtPixel(e.pixel,function(e,t){return e=t==r.layer_?e:null})?(this.previousCursor_=t.style.cursor,t.style.cursor="pointer"):(t.style.cursor=void 0!==this.previousCursor_?this.previousCursor_:"",this.previousCursor_=void 0)},i.prototype.featuresAtPixel_=function(e,t){var r=null,t=t.forEachFeatureAtPixel(e,function(e){return e});return r=this.features_&&_.includes(this.features_.getArray(),t)?t:r},i.prototype.clear=function(){this.map_&&(this.map_.getTargetElement().style.cursor=this.startCursor_)},t.exports=i},{}],103:[function(e,t,r){function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.geometryType="LineString",i.call(this,e)}var i=e("g3w-ol/interactions/measureinteraction");ol.inherits(n,i),t.exports=n},{"g3w-ol/interactions/measureinteraction":104}],104:[function(e,t,r){function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(this._helpTooltip,this._measureTooltipElement,this._measureTooltip,this._featureGeometryChangelistener,this._poinOnMapMoveListener,this.testTooltip,this._helpMsg=e.help,this._projection=e.projection,this.feature=e.feature,e.drawColor||"rgba(0, 0, 0, 0.5)"),t=(u(this._projection),new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ol.style.Stroke({color:t,lineDash:[10,10],width:3}),image:new ol.style.Circle({radius:5,stroke:new ol.style.Stroke({color:"rgba(0, 0, 0, 0.7)"}),fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"})})})),e=e.geometryType||"LineString",r=new ol.source.Vector;this._helpTooltipElement,this._map=null,this._feature=null,this._layer=new ol.layer.Vector({source:r,style:function(){return[new ol.style.Style({stroke:new ol.style.Stroke({lineDash:[10,10],width:3}),fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"})})]}}),ol.interaction.Draw.call(this,{source:r,type:e,style:t}),this.set("beforeRemove",this.clear),this.set("layer",this._layer),this.on("drawstart",this._drawStart),this.on("drawend",this._drawEnd)}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=e("core/i18n/i18n.service").t,e=e("core/utils/ol"),o=e.createMeasureTooltip,s=e.setMeasureTooltipStatic,l=e.removeMeasureTooltip,u=e.needUseSphereMethods,e=(ol.inherits(n,ol.interaction.Draw),n.prototype);e.setDrawMessage=function(e){this._helpMsg=e},e.clear=function(){this._layer.getSource().clear(),this._clearMessagesAndListeners(),this._map&&(l(i({map:this._map},this.measureTooltip)),this.measureTooltip=null,this._map.removeLayer(this._layer))},e._clearMessagesAndListeners=function(){this._feature=null,this._map&&(this._measureTooltipElement=null,this._helpTooltipElement.innerHTML="",this._helpTooltipElement.classList.add("hidden"),ol.Observable.unByKey(this._featureGeometryChangelistener),ol.Observable.unByKey(this._poinOnMapMoveListener),$(document).off("keydown",this._keyDownEventHandler))},e._removeLastPoint=function(e){var t=this._feature.getGeometry();46===e.keyCode&&(t instanceof ol.geom.Polygon&&2<t.getCoordinates()[0].length||t instanceof ol.geom.LineString&&1<t.getCoordinates().length)&&this.removeLastPoint()},e._drawStart=function(e){var r=this;this._map=this.getMap(),this._map.removeLayer(this._layer),this._feature=e.feature,this.feature&&this._feature.setGeometry(this.feature.getGeometry()),this._keyDownEventHandler=this._removeLastPoint.bind(this),$(document).on("keydown",this._keyDownEventHandler),this._layer.getSource().clear(),this._poinOnMapMoveListener=this._map.on("pointermove",function(e){var t;e.dragging||r._feature&&r._helpMsg&&(t=a(r._helpMsg),r._helpTooltipElement.innerHTML=t,r._helpTooltip.setPosition(e.coordinate),r._helpTooltipElement.classList.remove("hidden"))}),this._createHelpTooltip(),this._createMeasureTooltip()},e._drawEnd=function(){var e=this.measureTooltip.tooltip;s(e),this._clearMessagesAndListeners(),this._map.addLayer(this._layer)},e._createHelpTooltip=function(){this._helpTooltipElement&&this._helpTooltipElement.parentNode.removeChild(this._helpTooltipElement),this._helpTooltip&&this._map.removeOverlay(this._helpTooltip),this._helpTooltipElement=document.createElement("div"),this._helpTooltipElement.className="mtooltip hidden",this._helpTooltip=new ol.Overlay({element:this._helpTooltipElement,offset:[15,0],positioning:"center-left"}),this._map.addOverlay(this._helpTooltip)},e._createMeasureTooltip=function(){this.measureTooltip&&l(i({},this.measureTooltip,{map:this._map})),this.measureTooltip=o({map:this._map,feature:this._feature})},t.exports=n},{"core/i18n/i18n.service":13,"core/utils/ol":66}],105:[function(e,t,r){function n(e,t){this.type=e,this.coordinate=t}function i(e){this.previousCursor_=null,this._centerMap=null,ol.interaction.Pointer.call(this,{handleDownEvent:i.handleDownEvent_,handleUpEvent:i.handleUpEvent_,handleMoveEvent:i.handleMoveEvent_})}var a="picked";ol.inherits(i,ol.interaction.Pointer),i.handleDownEvent_=function(e){var t=this;return this._centerMap=e.map.getView().getCenter(),setTimeout(function(){t._centerMap===e.map.getView().getCenter()&&i.handleUpEvent_.call(t,e)},300),!1},i.handleUpEvent_=function(e){return this.dispatchEvent(new n(a,e.coordinate)),!1},i.handleMoveEvent_=function(e){return e.map.getTargetElement().style.cursor="pointer",!0},i.prototype.shouldStopEvent=function(){return!1},i.prototype.setActive=function(e){var t=this.getMap();t&&(t.getTargetElement().style.cursor=""),ol.interaction.Pointer.prototype.setActive.call(this,e)},i.prototype.setMap=function(e){e||(this.getMap().getTargetElement().style.cursor=""),ol.interaction.Pointer.prototype.setMap.call(this,e)},t.exports=i},{}],106:[function(e,t,r){function n(e,t,r,n){this.type=e,this.feature=n,this.coordinate=t,this.layer=r}function i(){var r=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(ol.interaction.Pointer.call(this,{handleDownEvent:i.handleDownEvent_,handleUpEvent:i.handleUpEvent_,handleMoveEvent:i.handleMoveEvent_}),e.features);this.features_=Array.isArray(t)&&t.length&&t||null,this.layers_=e.layers||null,this.pickedFeature_=null,this.pickedLayer_=null,this.layerFilter_=function(e){var t=_.includes(r.layers_,e);return r.pickedLayer_=t&&e,t}}var a="picked";ol.inherits(i,ol.interaction.Pointer),i.handleDownEvent_=function(e){return this.pickedFeature_=this.featuresAtPixel_(e.pixel,e.map),this.pickedFeature_},i.handleUpEvent_=function(e){return this.pickedFeature_&&this.dispatchEvent(new n(a,e.coordinate,this.pickedLayer_,this.pickedFeature_)),!0},i.handleMoveEvent_=function(e){var t=e.map.getTargetElement(),e=this.featuresAtPixel_(e.pixel,e.map);t.style.cursor=e?"pointer":""},i.prototype.featuresAtPixel_=function(e,t){var r=this,n=null,t=t.forEachFeatureAtPixel(e,function(e){return!r.features_||-1<r.features_.indexOf(e)?e:null},{layerFilter:this.layerFilter_,hitTolerance:isMobile&&isMobile.any?10:0});return n=t?t:n},i.prototype.shouldStopEvent=function(){return!1},i.prototype.setMap=function(e){e||(this.getMap().getTargetElement().style.cursor=""),ol.interaction.Pointer.prototype.setMap.call(this,e)},t.exports=i},{}],107:[function(e,t,r){var c=e("g3w-ol/layers/rasters"),e={OSM:{}};e.OSM.get=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.title,r=e.id,e=e.url;return new ol.layer.Tile({source:new ol.source.OSM({url:e}),id:r||"osm",title:t||"OSM",basemap:!0})},e.TMS={get:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.visible,r=void 0!==t&&t,t=e.url,n=void 0===t?null:t,t=e.source_type,i=e.minZoom,a=e.maxZoom,o=e.projection,s=e.attributions,e=e.crossOrigin,l=void 0===e?"anonymous":e,u=void 0;switch(void 0===t?"xyz":t){case"xyz":u=c.XYZLayer({url:n,visible:r,minZoom:i,maxZoom:a,attributions:s,projection:o,crossOrigin:l});break;case"arcgismapserver":u=c.TiledArgisMapServer({url:n,visible:r,projection:o,attributions:s})}return u}},e.WMS={get:function(e){var t=e.url,r=e.projection,n=e.attributions,i=e.layers,a=e.singleTile,e=e.opacity;return c.WMSLayer({url:t,projection:r,attributions:n,layers:i,tiled:void 0!==a&&a,opacity:void 0===e?1:e})}},e.WMTS={get:function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.layer,n=(e.visible,e.attributions),i=e.matrixSet,a=e.projection,o=e.requestEncoding,s=e.style,s=void 0===s?"default":s,l=e.format,l=void 0===l?"image/png":l,e=e.opacity,e=void 0===e?.7:e,u=a.getExtent(),c=new Array(14),d=ol.extent.getWidth(u)/256,p=new Array(14),f=0;f<14;++f)c[f]=d/Math.pow(2,f),p[f]=f;return new ol.layer.Tile({opacity:e,source:new ol.source.WMTS({url:t,projection:a,layer:r,matrixSet:i,requestEncoding:o,format:l,attributions:n,tileGrid:new ol.tilegrid.WMTS({origin:ol.extent.getTopLeft(u),resolutions:c,matrixIds:p}),style:s})})}},e.BING={},e.BING.get=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.imagerySet||"Aerial";return new ol.layer.Tile({name:t,visible:!1,preload:1/0,source:new ol.source.BingMaps({imagerySet:t,key:e.key}),basemap:!0})},t.exports=e},{"g3w-ol/layers/rasters":108}],108:[function(e,t,r){function g(e){var a=void 0===(t=e.method)?"GET":t,t=void 0===(t=e.type)?"image":t,e=void 0===(e=e.sourceOptions)?{}:e;window.URL=window.URL||window.webkitURL,e[t+"LoadFunction"]=function(t,e){var r=new XMLHttpRequest,n=e.split("?"),n=o(n,2),i=n[0],n=n[1];r.open(a,"POST"===a&&i||e),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),r.responseType="blob",r.onload=function(){var e=this.response;void 0!==e?t.getImage().src=window.URL.createObjectURL(e):t.setState(ol.TileState.ERROR)},r.onerror=function(){image.setState(ol.TileState.ERROR)},r.send("POST"===a&&n)}}var o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},v=e("core/utils/ol").getDPI(),n={};n.TiledWMSLayer=function(e,t){return n._WMSLayer({layerObj:e,extraParams:t||{},tiled:!0})},n.WMSLayer=function(e){return n._WMSLayer({layerObj:e,extraParams:1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},method:2<arguments.length&&void 0!==arguments[2]?arguments[2]:"GET"})},n.WMTSLayer=function(e,t){ol.source.WMTS.optionsFromCapabilities;return new ol.layer.Tile({opacity:1,source:new ol.source.WMTS(options)})},n.ImageArgisMapServer=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return new ol.layer.Image({source:new ol.source.ImageArcGISRest({ratio:e.ratio,params:{FORMAT:e.format},url:e.url})})},n.TiledArgisMapServer=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.visible,r=void 0===r||r,n=e.extent,i=e.projection,a=e.attributions,e=e.crossOrigin,t=new ol.source.TileArcGISRest({url:t,projection:i,attributions:a,crossOrigin:e});return new ol.layer.Tile({extent:n,visible:r,source:t})},n._WMSLayer=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layerObj,r=e.method,r=void 0===r?"GET":r,n=e.extraParams,e=e.tiled,e=void 0!==e&&e,i=t.iframe_internal,i=void 0!==i&&i,a=t.layers,o=t.version,s=t.sld_version,l=t.id,u=t.name,c=t.opacity,c=void 0===c?1:c,d=t.visible,p=t.extent,f=t.maxResolution,h=t.format,a={LAYERS:void 0===a?"":a,VERSION:void 0===o?"1.3.0":o,TRANSPARENT:!0,SLD_VERSION:void 0===s?"1.1.0":s,DPI:v},o=(void 0!==h&&(a.FORMAT=h),{url:t.url,params:Object.assign({},a,n),ratio:1,projection:t.projection?t.projection.getCode():null}),s=(!i&&"POST"!==r||g({method:r,sourceOptions:o,type:"image"}),{id:l,name:u,opacity:c,visible:d,extent:p,maxResolution:f});return new(e?(s.source=new ol.source.TileWMS(o),ol.layer.Tile):(s.source=new ol.source.ImageWMS(o),ol.layer.Image))(s)},n.XYZLayer=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.iframe_internal||!1,r=e.url,n=e.projection,i=e.maxZoom,a=e.minZoom,o=e.visible,o=void 0===o||o,e=e.crossOrigin;if(r)return r={url:r,maxZoom:i,minZoom:a,projection:n,crossOrigin:e},t&&g({method:1<arguments.length&&void 0!==arguments[1]?arguments[1]:"GET",type:"tile",sourceOptions:r}),"degrees"===n.getUnits()&&(a=n.getExtent(),(e=ol.tilegrid.createXYZ({extent:a,maxZoom:i}).getResolutions()).splice(0,1),r.tileGrid=new ol.tilegrid.TileGrid({extent:a,resolutions:e})),t=new ol.source.XYZ(r),new ol.layer.Tile({visible:o,projection:n,source:t})},t.exports=n},{"core/utils/ol":66}],109:[function(e,t,r){var n=e("../layers/bases"),e={createViewer:function(){return new i(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}},i=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=ol.control.defaults({attribution:!1,zoom:!1}),r=ol.interaction.defaults().extend([new ol.interaction.DragRotate]),n=(r.removeAt(1),e.view instanceof ol.View?e.view:new ol.View(e.view)),t={controls:t,interactions:r,ol3Logo:!1,view:n,keyboardEventTarget:document},r=(t.target=e.id,new ol.Map(t));this.map=r};i.prototype.destroy=function(){this.map&&(this.map.dispose(),this.map=null)},i.prototype.getView=function(){return this.map.getView()},i.prototype.updateMap=function(e){},i.prototype.updateView=function(){},i.prototype.getMap=function(){return this.map},i.prototype.setTarget=function(e){this.map.setTarget(e)},i.prototype.zoomTo=function(e,t){var r=this.map.getView();r.setCenter(e),r.setZoom(t)},i.prototype.goTo=function(e,t){var r=(t=t||{}).animate||!0,t=t.zoom||!1,n=this.map.getView(),i=void 0;r?(r={duration:300,center:e},i=t?{duration:300,zoom:t}:{duration:300,resolution:n.getResolution()},n.animate(r,i)):(n.setCenter(e),t&&n.setZoom(t))},i.prototype.goToRes=function(e,t){var r=(t=t||{}).animate||!0,n=this.map.getView(),t=t.resolution||n.getResolution();r?n.animate({duration:200,center:e},{duration:200,resolution:t}):(n.setCenter(e),n.setResolution(t))},i.prototype.fit=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=this.map.getView();!t.animate&&0||(r.animate({duration:200,center:r.getCenter()}),r.animate({duration:200,resolution:r.getResolution()})),t.animate&&delete t.animate,t.constrainResolution=void 0===t.constrainResolution||t.constrainResolution,t.size=this.map.getSize(),r.fit(e,t)},i.prototype.getZoom=function(){return this.map.getView().getZoom()},i.prototype.getResolution=function(){return this.map.getView().getResolution()},i.prototype.getCenter=function(){return this.map.getView().getCenter()},i.prototype.getBBOX=function(){return this.map.getView().calculateExtent(this.map.getSize())},i.prototype.getLayerByName=function(e){for(var t=this.map.getLayers(),r=t.getLength(),n=0;n<r;n++)if(e===t.item(n).get("name"))return t.item(n);return null},i.prototype.removeLayerByName=function(e){e=this.getLayerByName(e);e&&this.map.removeLayer(e)},i.prototype.getActiveLayers=function(){var r=[];return this.map.getLayers().forEach(function(e){var t=e.getProperties();!0!==t.basemap&&t.visible&&r.push(e)}),r},i.prototype.removeLayers=function(){this.map.getLayers().clear()},i.prototype.getLayersNoBase=function(){var t=[];return this.map.getLayers().forEach(function(e){1!=e.getProperties().basemap&&t.push(e)}),t},i.prototype.addBaseLayer=function(e){var t=void 0,t=e?n[e]:n.BING.Aerial;this.map.addLayer(t)},i.prototype.changeBaseLayer=function(e){var t=this.getLayerByName(layername);this.map.getLayers().insertAt(0,t)},t.exports=e},{"../layers/bases":107}],110:[function(e,t,r){function n(){if(!(i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).crs)return null;var e=(i=i.crs).epsg,t=i.proj4,r=void 0!==(r=i.geographic)&&r,n=void 0!==(n=i.axisinverted)&&n,i=i.extent,t=(t&&proj4.defs(e,t),this._axisOrientation=n?"neu":"enu",r);ol.proj.Projection.call(this,{code:e,extent:i,axisOrientation:this._axisOrientation,units:t?"degrees":"m"})}ol.inherits(n,ol.proj.Projection);var i=n.prototype;i.getAxisOrientation=function(){return this._axisOrientation},i.isInvertedAxisOrientation=function(){return"neu"===this._axisOrientation},i.getOlProjection=function(){},t.exports=n},{}],111:[function(e,t,r){var a=e("constant"),n=e("./projection"),o=e("core/utils/utils").XHR,s=e("core/utils/geo").normalizeEpsg;t.exports={isRegistered:function(e){return ol.proj.get(e)},get:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=this.isRegistered(e.epsg);return t||(t=new n({crs:e}),ol.proj.addProjection(t),ol.proj.proj4.register(proj4),t)},registerProjection:function(e){var i=this;return new Promise(function(r,t){var n=i.isRegistered(e);n?r(n):o.get({url:""+a.API_BASE_URLS.CRS+e.split(":")[1]}).then(function(e){var t=e.result,e=e.data;t&&(e.epsg=s(e.epsg),n=i.get(e),ol.proj.proj4.register(proj4),r(n))}).catch(function(e){return t(e)})})}}},{"./projection":110,constant:4,"core/utils/geo":64,"core/utils/utils":68}],112:[function(e,t,r){var i=n(e("store/catalog-layers")),a=n(e("store/projects")),o=n(e("services/application"));function n(e){return e&&e.__esModule?e:{default:e}}function s(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var l=e("core/utils/utils"),u=l.base;function c(){var n=this;this.state={prstate:a.default.state,highlightlayers:!1,external:{wms:[],vector:[]},layerstrees:[],layersgroups:[]},this.setters={addExternalLayer:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,e=e.type,e=void 0===e?"vector":e;t.removable=!0,this.state.external[e].push(t)},removeExternalLayer:function(){var r=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=e.name,e=e.type,i=void 0===e?"vector":e;this.state.external[i].filter(function(e,t){if(e.name===n)return r.state.external[i].splice(t,1),!0})},setSelectedExternalLayer:function(e){var t=e.layer,r=e.type,n=e.selected;this.state.external[r].forEach(function(e){void 0!==e.selected&&(e.selected=t===e&&n)})}},u(this),i.default.getLayersStores().forEach(function(e){return n.addLayersStoreToLayersTrees(e)}),i.default.onafter("addLayersStore",function(e){n.addLayersStoreToLayersTrees(e)}),i.default.onafter("removeLayersStore",function(r){n.state.layerstrees.find(function(e,t){if(e.storeid===r.getId())return n.state.layerstrees.splice(t,1),!0})}),i.default.onafter("removeLayersStores",function(){n.state.layerstrees.forEach(function(e,t){n.state.layerstrees.splice(t,1)})})}(0,l.inherit)(c,e("core/g3wobject"));var d,l=c.prototype;l.createLayersGroup=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.title,t=void 0===t?"Layers Group":t,e=e.layers,r=[];return(void 0===e?[]:e).forEach(function(e){return r.push(e)}),{title:t,nodes:r}},l.getMajorQgisVersion=function(){return a.default.getCurrentProject().getQgisVersion({type:"major"})},l.addLayersGroup=function(e){this.state.layersgroups.push(e)},l.addLayersStoreToLayersTrees=function(e){this.state.layerstrees.push({tree:e.getLayersTree(),storeid:e.getId()})},l.changeMapTheme=(d=s(regeneratorRuntime.mark(function e(t){var r,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o.default.changeProjectView(!0),i=this.state.prstate.currentProject,(r=this.state.layerstrees[0]).checked=!0,n=r.tree[0].nodes,e.next=7,i.setLayersTreePropertiesFromMapTheme({map_theme:t,layerstree:n,rootNode:r});case 7:return i=e.sent,o.default.changeProjectView(!1),e.abrupt("return",i);case 10:case"end":return e.stop()}},e,this)})),function(e){return d.apply(this,arguments)}),l.getExternalLayers=function(e){e=e.type;return this.state.external[void 0===e?"vector":e]},l.getExternalSelectedLayers=function(e){e=e.type;return this.getExternalLayers({type:void 0===e?"vector":e}).filter(function(e){return e.selected})},l.getExternalLayerById=function(e){var t=e.id,e=e.type;return this.state.external[void 0===e?"vector":e].find(function(e){return e.id===t})},l.isExternalLayerSelected=function(e){var t=e.id,e=e.type,t=this.getExternalLayerById({id:t,type:e});return t&&t.selected},t.exports=c},{"core/g3wobject":12,"core/utils/utils":68,"services/application":351,"store/catalog-layers":374,"store/projects":379}],113:[function(e,t,r){var n=d(e("components/Catalog.vue")),i=d(e("components/CatalogLayersGroup.vue")),a=d(e("components/CatalogTristateTree.vue")),o=d(e("components/CatalogLayersLegend.vue")),s=d(e("components/CatalogLayersLegendItems.vue")),l=c(e("store/components")),u=c(e("services/gui"));function c(e){return e&&e.__esModule?e:{default:e}}function d(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}var p=e("core/utils/utils"),f=p.inherit,h=p.base,p=e("gui/component/component"),g=e("gui/catalog/catalogservice"),v=Vue.extend(n);function m(){function t(e){var t=e.getService();r.state.visible=!t.state.hidden,t.onafter("setHidden",function(e){r.state.visible=!t.state.hidden,r.state.expanded=!0})}var r=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=(e.resizable=!0,h(this,e),e.config.legend),e=(this.title="catalog",this.mapComponentId=e.mapcomponentid,e.service||new g);this.setService(e),this.setInternalComponent(new v({service:e,legend:n})),this.internalComponent.state=this.getService().state;!this.mapComponentId||!(e=u.default.getComponent(this.mapComponentId))&&l.default.on("componentregistered",function(e){return e.getId()===r.mapComponentId&&t(e)})||t(e)}Vue.component("g3w-catalog",n),Vue.component("layers-group",i),Vue.component("tristate-tree",a),Vue.component("layerslegend",o),Vue.component("layerslegend-items",s),f(m,p),t.exports=m},{"components/Catalog.vue":196,"components/CatalogLayersGroup.vue":200,"components/CatalogLayersLegend.vue":201,"components/CatalogLayersLegendItems.vue":202,"components/CatalogTristateTree.vue":203,"core/utils/utils":68,"gui/catalog/catalogservice":112,"gui/component/component":117,"services/gui":361,"store/components":375}],114:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=new Vue;r.default=n},{}],115:[function(e,t,r){var n=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/ChangeMapMenu.vue"));var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=i.merge,i=e("gui/component/component"),l=Vue.extend(n);function u(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.id="changemapmenu",a(this,e),this.state.visible=!0,s(this,e),this.internalComponent=new l}o(u,i),t.exports=u},{"components/ChangeMapMenu.vue":204,"core/utils/utils":68,"gui/component/component":117}],116:[function(e,t,r){var n=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},e=e("components/C3XYLine.vue");e={CHARTS:{c3:{lineXY:((e=e)&&e.__esModule?e:{default:e}).default}},build:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.type,e=e.hooks,e=void 0===e?{}:e,t=t.split(":"),t=n(t,2),r=t[0],t=t[1],r=this.CHARTS[void 0===r?"c3":r][void 0===t?"lineXY":t];return Object.assign(e,r)}};t.exports=e},{"components/C3XYLine.vue":195}],117:[function(e,t,r){function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._firstLayout=!0,this.internalComponent=null,this._components=[];var t=void 0===(t=e.id)?1e3*Math.random():t,r=void 0===(r=e.title)?"":r,n=void 0===(n=e.visible)||n,i=void 0!==(i=e.open)&&i,a=void 0!==(a=e.resizable)&&a,o=void 0===(o=e.info)?null:o,s=void 0!==(s=e.loading)&&s,l=void 0!==(l=e.disabled)&&l,u=void 0===(u=e.closewhenshowviewportcontent)||u;this.id=t,this.title=r,this.state={visible:n,open:i,resizable:a,info:o,loading:s,disabled:l,closewhenshowviewportcontent:u,sizes:{width:0,height:0}},this.setters={setOpen:function(e){this.state.open=e,this._setOpen(e)},setVisible:function(e){this.state.visible=e,this._setVisible(e)},setLoading:function(){this.state.loading=0<arguments.length&&void 0!==arguments[0]&&arguments[0]},setDisabled:function(){this.state.disabled=0<arguments.length&&void 0!==arguments[0]&&arguments[0]},reload:function(){this._reload()}},d(this,e),c(this),this.events=e.events,this.events&&this.handleEventsComponent()}var i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},a=e("core/utils/utils"),c=a.base,o=a.inherit,d=a.merge,s=a.noop,l=a.capitalize_first_letter,u=a.resolve,a=e("core/g3wobject"),p=["methods","computed","data","components"],e=(o(n,a),n.prototype);e.init=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(this.vueComponent=this.createVueComponent(e.vueComponentObject),this._components=e.components||[],e.service||s),r=e.template,n=e.propsData;this.setService(t),this._service.init&&this._service.init(e),r&&this.setInternalComponentTemplate(r),this.setInternalComponent=function(){var e=Vue.extend(this.vueComponent);this.internalComponent=new e({service:this._service,template:r,propsData:n}),this.internalComponent.state=this.getService().state},this.setInternalComponent()},e.getId=function(){return this.id},e.setId=function(e){this.id=e},e.getOpen=function(){return this.state.open},e.closeWhenViewportContentIsOpen=function(){return this.getOpen()&&this.state.closewhenshowviewportcontent},e.getVisible=function(){return this.state.visible},e.getTitle=function(){return this.state.title},e.setTitle=function(e){this.state.title=e},e.getService=function(){return this._service},e.setService=function(e){this._service=e},e.handleEventsComponent=function(){var e,t,r=this.events,n=r.open;r.visible;n&&(r=n.when,e=n.cb,t=void 0===e?function(){}:e,n.guiEvents,this["on"+(void 0===r?"after":r)]("setOpen",function(e){return t(e)}))},e.insertComponentAt=function(e,t){this._components.splice(e,0,t)},e.removeCompomentAt=function(e){this._components.splice(e,1)},e.addComponent=function(e){this._components.push(e)},e.popComponent=function(){return this._components.pop()},e.removeComponent=function(r){var n=this;this._components.forEach(function(e,t){if(e===r)return n.splice(t,1),!1})},e.setComponents=function(e){this._components=Array.isArray(e)?e:[]},e.exendComponents=function(e){_.merge(this._components,e)},e.getInternalComponent=function(){return this.internalComponent},e.setInternalComponent=function(e){var n=this,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},t=(!e&&this.internalComponentClass?this.internalComponent=new this.internalComponentClass:this.internalComponent=e,t.events);(void 0===t?[]:t).forEach(function(e){var t=e.name,r=e.handler;n.internalComponent.$on(t,function(e){return r&&r(e)||n["set"+l(t)](e)})})},e.createVueComponent=function(e){return _.cloneDeep(e)},e.addInternalComponentData=function(e){_.merge(this.internalComponent,e)},e.overwriteServiceMethod=function(e,t){this._service[e]=t},e.overwriteServiceMethods=function(e){var r=this;Object.entries(e).forEach(function(e){var e=i(e,2),t=e[0],e=e[1];return r.overwriteServiceMethod(t,e)})},e.extendService=function(e){this._service&&d(this._service,e)},e.extendInternalComponent=function(e){var n=this;this.vueComponent?Object.entries(e).forEach(function(e){var e=i(e,2),t=e[0],r=e[1];if(-1<p.indexOf(t))switch(t){case"methods":n.extendInternalComponentMethods(r);break;case"components":n.extendInternalComponentComponents(r);break;default:d(n.vueComponent[t],r)}}):this.vueComponent=e},e.extendInternalComponentComponents=function(e){e&&d(this.vueComponent.components,e)},e.extendComponents=function(e){this.extendInternalComponentComponents(e)},e.addComponent=function(e){e&&(this.vueComponent.components[e.key]=e.value)},e.extendInternalComponentMethods=function(r){r&&(Object.entries(r).forEach.forEach(function(e){var e=i(e,2),t=e[0];return!(e[1]instanceof Function)&&delete r[t]}),d(this.vueComponent.methods,r))},e.extendInternalComponentComputed=function(r){r&&(Object.entries(r).forEach(function(e){var e=i(e,2),t=e[0];return!(e[1]instanceof Function)&&delete r[t]}),d(this.vueComponent.computed,r))},e.setInternalComponentTemplate=function(e){e&&(this.vueComponent.template=e)},e.getInternalTemplate=function(){return this.vueComponent.template},e.destroy=function(){},e.click=function(){},e.show=function(){},e._setOpen=function(e){},e._setVisible=function(){},e._reload=function(){},e.mount=function(e,t){var r=this,n=$.Deferred();return this.internalComponent||this.setInternalComponent(),t?(t=this.internalComponent.$mount(),$(e).append(t.$el)):this.internalComponent.$mount(e),this.internalComponent.$nextTick(function(){$(e).localize(),r.emit("ready"),n.resolve(!0)}),this.emit("mount"),n.promise()},e.unmount=function(){return this.internalComponent&&(this.state.resizable&&this.internalComponent.$off("resize-component",this.internalComponent.layout),this.state.open=!1,this.internalComponent.$destroy(!0),$(this.internalComponent.$el).remove(),this.internalComponent=null,this.emit("unmount")),u()},e.ismount=function(){return this.internalComponent&&this.internalComponent.$el},e.layout=function(e,t){var r=this;this.state.resizable&&this._firstLayout&&(this.internalComponent.$on("resize-component",this.internalComponent.layout),this._firstLayout=!1),this.internalComponent.$nextTick(function(){r.internalComponent.$emit("resize-component",{width:e,height:t})}),this.emit("layout")},t.exports=n},{"core/g3wobject":12,"core/utils/utils":68}],118:[function(e,t,r){var n=e("services/gui"),d=(n=n)&&n.__esModule?n:{default:n};var a=e("gui/component/component");t.exports={build:function(e){var t=e.vueComponentObject,r=e.service,n=e.propsData,i=new a(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{});return i.init({vueComponentObject:t,service:r,propsData:n}),i},buildSidebar:function(e){var t=e.vueComponentObject,r=(e.service,e.propsData,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}),n=r.id,i=r.title,a=r.open,o=r.collapsible,s=r.isolate,l=r.mobile,l=void 0===l||l,u=r.iconConfig,u=void 0===u?{}:u,c=r.events,c=void 0===c?{}:c,r=r.sidebarOptions,r=void 0===r?{position:1}:r,t=this.build({vueComponentObject:t},{id:n,title:i,open:void 0!==a&&a,collapsible:void 0===o||o,isolate:void 0!==s&&s,iconColor:u.color&&u.color,icon:u.icon&&d.default.getFontClass(u.icon),mobile:l,events:c});return d.default.addComponent(t,"sidebar",r),t}}},{"gui/component/component":117,"services/gui":361}],119:[function(e,t,r){var n=e("core/i18n/i18n.service").t;t.exports={matcher:function(e,t){e=e.term&&e.term.toLowerCase();return""===$.trim(e)?t:void 0!==t.text&&-1<t.text.toLowerCase().indexOf(e)?$.extend({},t,!0):null},language:{noResults:function(){return n("sdk.search.no_results")},errorLoading:function(){return n("sdk.search.error_loading")},searching:function(){return n("sdk.search.searching")},inputTooShort:function(e){e=e.minimum-e.input.length;return n("sdk.search.autocomplete.inputshort.pre")+" "+e+" "+n("sdk.search.autocomplete.inputshort.post")}}}},{"core/i18n/i18n.service":13}],120:[function(e,t,r){var n=l(e("components/FieldText.vue")),i=l(e("components/FieldLink.vue")),a=l(e("components/FieldImage.vue")),o=l(e("components/FieldGeo.vue")),s=l(e("components/FieldMedia.vue")),e=l(e("components/FieldVue.vue"));function l(e){return e&&e.__esModule?e:{default:e}}n={simple_field:n.default,text_field:n.default,link_field:i.default,image_field:a.default,geo_field:o.default,photo_field:a.default,media_field:s.default,vue_field:e.default};t.exports=n},{"components/FieldGeo.vue":207,"components/FieldImage.vue":208,"components/FieldLink.vue":209,"components/FieldMedia.vue":210,"components/FieldText.vue":211,"components/FieldVue.vue":212}],121:[function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("store/catalog-layers"),a=(i=i)&&i.__esModule?i:{default:i};var o=e("./fields"),s=e("core/utils/utils").toRawType,l=/^(https?:\/\/[^\s]+)/g,u=/[^\s]+.(png|jpg|jpeg|gif)$/g,c="simple",d="geo",p="link",f="photo",h="image",g="vue";t.exports={getType:function(e){var t=e.type;return"vue"!==t&&((e=!(e=e.value)||"Object"!==s(e)||e.coordinates||e.vue?e:e.value)?"object"==(void 0===e?"undefined":n(e))?e.coordinates?t=d:e.vue&&(t=g):t=e&&Array.isArray(e)?e.length&&e[0].photo?f:c:e.toString().toLowerCase().match(u)?f:e.toString().match(l)?p:c:t=c),t+"_field"},isSimple:function(e){return this.getType(e)===c+"_field"},isLink:function(e){return this.getType(e)===p+"_field"},isImage:function(e){return this.getType(e)===h+"_field"},isPhoto:function(e){return this.getType(e)===f+"_field"},isVue:function(e){return this.getType(e)===g+"_field"},add:function(e){var t=e.type,e=e.field;o[t]=e},remove:function(e){delete o[e]},changeConfigFieldType:function(e){var t=e.layerId,e=e.field,e=void 0===e?{}:e;a.default.getLayerById(t).changeConfigFieldType(e)},resetConfigFieldType:function(e){var t=e.layerId,e=e.field,e=void 0===e?{}:e;a.default.getLayerById(t).resetConfigField(e)}}},{"./fields":120,"core/utils/utils":68,"store/catalog-layers":374}],122:[function(e,t,r){var n=e("core/expression/inputservice"),s=(n=n)&&n.__esModule?n:{default:n};function o(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var n=e("core/utils/utils"),i=n.inherit,a=n.base;function l(){var e=this;this.state=null,this.eventBus=new Vue,this.force={update:!1,valid:!1},this.layer,this.setters={setInitForm:function(){this._setInitForm(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},setFormStructure:function(e){this.state.formstructure=e},setFormFields:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];this.state.fields=e,this.handleFieldsWithExpression(e)},setupFields:function(){this._setupFields()},setFormData:function(e){this.setFormFields(e)},setField:function(e){},setState:function(e){this._setState(e)},addActionsForForm:function(e){},postRender:function(e){}},a(this),this.init=function(){this._setInitForm(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},this._setInitForm=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.fields,r=e.feature,n=e.parentData,i=e.layer,a=e.title,a=void 0===a?"Form":a,o=e.formId,s=e.name,l=e.buttons,l=void 0===l?{}:l,u=e.context_inputs,c=e.isnew,d=e.footer,d=void 0===d?{}:d,p=e.headerComponent;this.layer=i,this.feature=r.clone(),this.title=a,this.formId=o,this.name=s,this.buttons=l,this.context_inputs=u,this.parentData=n,this.headerComponent=p,this.state={layerid:i.getId(),loading:!1,components:[],disabledcomponents:[],component:null,headers:[],currentheaderid:null,fields:null,buttons:this.buttons,disabled:!1,isnew:c,valid:!0,update:r.isNew(),tovalidate:{},feature:r,componentstovalidate:{},footer:d,ready:!1},this.force.update=r.isNew(),this.filter_expression_fields_dependencies={},this.default_expression_fields_dependencies={},this.default_expression_fields_on_update=[],this.listenChangeInput=!0,this.setFormFields(t),this.layer&&e.formStructure&&this.setFormStructure(this.layer.getLayerEditingFormStructure(t))},this.eventBus.$on("set-loading-form",function(){return e.state.loading=0<arguments.length&&void 0!==arguments[0]&&arguments[0]})}i(l,e("core/g3wobject"));var u,n=l.prototype;n.setReady=function(){this.state.ready=0<arguments.length&&void 0!==arguments[0]&&arguments[0]},n.changeInput=function(e){!0===this.listenChangeInput&&(this.evaluateFilterExpressionFields(e),this.evaluateDefaultExpressionFields(e),this.isValid(e),this.isUpdated(e))},n.isUpdated=function(e){this.state.update=this.force.update||(this.state.update?!!this.state.fields.find(function(e){return e.update}):e.update)},n.setUpdate=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).force;this.force.update=void 0!==t&&t,this.state.update=this.force.update||e,!1===this.state.update&&this.state.fields.forEach(function(e){e._value=e.value})},n.evaluateDefaultExpressionFields=function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=this.default_expression_fields_dependencies[e.name];r&&(this.feature.set(e.name,e.value),r.forEach(function(e){s.default.handleDefaultExpressionFormInput({parentData:t.parentData,qgs_layer_id:t.layer.getId(),field:t._getField(e),feature:t.feature})}))},n.evaluateFilterExpressionFields=function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=this.filter_expression_fields_dependencies[e.name];r&&((e=this._getField(e.name))&&this.feature.set(e.name,e.value),r.forEach(function(e){s.default.handleFilterExpressionFormInput({parentData:t.parentData,qgs_layer_id:t.layer.getId(),field:t._getField(e),feature:t.feature})}))},n._handleFieldWithFilterExpression=function(t,e){var r,n,i=this;e&&(r=void 0===(r=e.referencing_fields)?[]:r,e=void 0===(e=e.referenced_columns)?[]:e,n=new Set,[].concat(o(e),o(r)).forEach(function(e){return n.add(e)}),n.forEach(function(e){void 0===i.filter_expression_fields_dependencies[e]&&(i.filter_expression_fields_dependencies[e]=[]),i.filter_expression_fields_dependencies[e].push(t.name)}),s.default.handleFilterExpressionFormInput({parentData:this.parentData,qgs_layer_id:this.layer.getId(),field:t,feature:this.feature}))},n._handleFieldWithDefaultExpression=function(t,e){var r,n,i,a=this;e&&(r=void 0===(r=e.referencing_fields)?[]:r,n=void 0===(n=e.referenced_columns)?[]:n,(e=void 0!==(e=e.apply_on_update)&&e)||this.state.isnew)&&(i=new Set,[].concat(o(n),o(r)).forEach(function(e){return i.add(e)}),e&&(this.default_expression_fields_on_update.push(t),i.forEach(function(e){void 0===a.default_expression_fields_dependencies[e]&&(a.default_expression_fields_dependencies[e]=[]),a.default_expression_fields_dependencies[e].push(t.name)})),this.state.isnew)&&s.default.handleDefaultExpressionFormInput({field:t,feature:this.feature,qgs_layer_id:this.layer.getId(),parentData:this.parentData})},n.handleFieldsWithExpression=function(){var r=this;(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(e){var t=e.input.options,t=void 0===t?{}:t;r._handleFieldWithFilterExpression(e,t.filter_expression),r._handleFieldWithDefaultExpression(e,t.default_expression)}),Object.keys(this.filter_expression_fields_dependencies).forEach(function(e){r.evaluateFilterExpressionFields({name:e})})},n.setCurrentFormPercentage=function(e){this.layer.setFormPercentage(e)},n.setLoading=function(){this.state.loading=0<arguments.length&&void 0!==arguments[0]&&arguments[0]},n.setValidComponent=function(e){var t=e.id,e=e.valid;this.state.componentstovalidate[t]=e,this.isValid()},n.getValidComponent=function(e){return this.state.componentstovalidate[e]},n.isValid=function(e){var t,r=this;if(e){if(!e.validate.mutually||e.validate.required||e.validate.empty||(e.validate._valid=e.validate.valid,e.validate.mutually_valid=e.validate.mutually.reduce(function(e,t){return e&&r.state.tovalidate[t].validate.empty},!0),e.validate.valid=e.validate.mutually_valid&&e.validate.valid),e.validate.mutually&&!e.validate.required&&e.validate.empty){e.value=null,e.validate.mutually_valid=!0,e.validate.valid=!0,e.validate._valid=!0;for(var n=[],i=e.validate.mutually.length;i--;){var a=e.validate.mutually[i];this.state.tovalidate[a].validate.empty||n.push(a)}n.length<2&&n.forEach(function(e){r.state.tovalidate[e].validate.mutually_valid=!0,r.state.tovalidate[e].validate.valid=!0,setTimeout(function(){r.state.tovalidate[e].validate.valid=r.state.tovalidate[e].validate._valid,r.state.valid=r.state.valid&&r.state.tovalidate[e].validate.valid})})}e.validate.mutually||e.validate.empty||!e.validate.min_field&&!e.validate.max_field||(t=e.validate.min_field||e.validate.max_field,e.validate.valid=e.validate.min_field?this.state.tovalidate[e.validate.min_field].validate.empty||+e.value>+this.state.tovalidate[e.validate.min_field].value:this.state.tovalidate[e.validate.max_field].validate.empty||+e.value<+this.state.tovalidate[e.validate.max_field].value,e.validate.valid&&(this.state.tovalidate[t].validate.valid=!0))}this.state.valid=Object.values(this.state.tovalidate).reduce(function(e,t){return e&&t.validate.valid},!0)&&Object.values(this.state.componentstovalidate).reduce(function(e,t){return e&&t},!0)},n.addComponents=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=!0,r=!1,n=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;this.addComponent(o)}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}},n.addComponent=function(e){var t=e.id,r=e.title,n=e.name,i=e.icon,a=e.valid,o=e.headerComponent,s=e.header,s=void 0===s||s;void 0!==a&&(this.state.componentstovalidate[t]=a,this.state.valid=this.state.valid&&a,this.eventBus.$emit("add-component-validate",{id:t,valid:a})),s&&(this.state.headers.push({title:r,name:n,id:t,icon:i,component:o}),this.state.currentheaderid=this.state.currentheaderid||t),this.state.components.push(e)},n.replaceComponent=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,e=e.component,r=this.state.components.findIndex(function(e){return e.id===t});this.state.components.splice(r,1,e)},n.disableComponent=function(e){var t=e.id;e.disabled?this.state.disabledcomponents.push(t):this.state.disabledcomponents=this.state.disabledcomponents.filter(function(e){return disabledId!==t})},n.setCurrentComponentById=function(t){if(-1===this.state.disabledcomponents.indexOf(t))return this.setIdHeader(t),this.state.component=this.state.components.find(function(e){return e.id===t}).component,this.state.component},n.setRootComponent=function(){this.state.component=this.state.components.find(function(e){return e.root}).component},n.getRootComponent=function(){return this.state.components.find(function(e){return e.root}).component},n.isRootComponent=function(e){return this.getRootComponent()==e},n.getComponentById=function(t){return this.state.components.find(function(e){return e.id===t})},n.setComponent=function(e){this.state.component=e},n.addedComponentTo=function(){this.state.addedcomponentto[0<arguments.length&&void 0!==arguments[0]?arguments[0]:"body"]=!0},n.addToValidate=function(e){this.state.tovalidate[e.name]=e,this.state.ready&&this.isValid(e)},n.removeToValidate=function(e){delete this.state.tovalidate[e.name],this.isValid()},n.getState=function(){return this.state},n._setState=function(e){this.state=e},n.getFields=function(){return this.state.fields},n._getField=function(t){return this.state.fields.find(function(e){return e.name===t})},n.getEventBus=function(){return this.eventBus},n.setIdHeader=function(e){this.state.currentheaderid=e},n.getContext=function(){return this.context_inputs.context},n.getSession=function(){return this.getContext().session},n.getInputs=function(){return this.context_inputs.inputs},n.handleRelation=function(e){e.relationId,e.feature},n.clearAll=function(){this.eventBus.$off("addtovalidate"),this.eventBus.$off("set-main-component"),this.eventBus.$off("set-loading-form"),this.eventBus.$off("component-validation"),this.eventBus.$off("disable-component")},n.saveDefaultExpressionFieldsNotDependencies=(u=regeneratorRuntime.mark(function e(){var a,r,t,n,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0===this.default_expression_fields_on_update.length)return e.abrupt("return");e.next=2;break;case 2:this.listenChangeInput=!1,a=[],r=[],t=regeneratorRuntime.mark(function e(r){var n,t,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=Object.keys(o.default_expression_fields_dependencies).filter(function(t){return o.default_expression_fields_on_update.find(function(e){return e.name===t})&&o.default_expression_fields_dependencies[t].find(function(e){return e===o.default_expression_fields_on_update[r].name})}),t=regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==a.find(function(e){return e===n[t]}))return e.abrupt("return","continue");e.next=2;break;case 2:return e.prev=2,e.next=5,s.default.handleDefaultExpressionFormInput({field:o._getField(n[t]),feature:o.feature,qgs_layer_id:o.layer.getId(),parentData:o.parentData});case 5:r=e.sent,o.feature.set(n[t],r),a.push(n[t]),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2);case 13:case"end":return e.stop()}},e,o,[[2,10]])}),i=0;case 3:if(i<n.length)return e.delegateYield(t(i),"t0",5);e.next=11;break;case 5:if("continue"===e.t0)return e.abrupt("continue",8);e.next=8;break;case 8:i++,e.next=3;break;case 11:case"end":return e.stop()}},e,o)}),n=0;case 7:if(n<this.default_expression_fields_on_update.length)return e.delegateYield(t(n),"t0",9);e.next=12;break;case 9:n++,e.next=7;break;case 12:return this.default_expression_fields_on_update.forEach(function(t){void 0===a.find(function(e){return e===t.name})&&r.push(s.default.handleDefaultExpressionFormInput({field:t,feature:o.feature,qgs_layer_id:o.layer.getId(),parentData:o.parentData}))}),e.prev=13,e.next=16,Promise.allSettled(r);case 16:e.next=21;break;case 18:e.prev=18,e.t1=e.catch(13);case 21:this.listenChangeInput=!0;case 22:case"end":return e.stop()}},e,this,[[13,18]])}),function(){var s=u.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}),t.exports=l},{"core/expression/inputservice":10,"core/g3wobject":12,"core/utils/utils":68}],123:[function(e,t,r){var a=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/Form.vue")),o=n(e("components/FormBody.vue")),s=n(e("services/gui"));function n(e){return e&&e.__esModule?e:{default:e}}var i=e("core/utils/utils"),l=i.base,i=i.inherit,u=e("gui/component/component"),c=e("gui/form/formservice");function d(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,t=void 0===t?"form":t,r=e.name,n=e.title,i=e.headerComponent,t=(l(this,e),e.service=new(e.service||c),e.vueComponentObject=e.vueComponentObject||a,e.components||[{id:t,title:n,name:r,root:!0,component:o.default,headerComponent:i}]);e.perc=null!==e.layer.getFormPercentage()?e.layer.getFormPercentage():e.perc,this.init(e),this.getService().addComponents(t),this.getService().setComponent(t[0].component),this.addBodyFormComponent=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.component,e=e.where,e=void 0===e?"after":e;this.getInternalComponent().body.components[e].push(t)},this.addBodyFormComponents=function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.components,r=void 0===r?[]:r,e=e.where,n=void 0===e?"after":e;r.forEach(function(e){return t.addBodyFormComponent({component:e,where:n})})},this.addFormComponents=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];this.getService().addComponents(e)},this.addFormComponent=function(e){e&&this.getService().addComponent(e)},this.addDependecyComponents=function(e){this.getService().addDependecyComponents(e)},this.addComponentBeforeBody=function(e){},this.addComponentAfterBody=function(e){},this.addComponentBeforeFooter=function(){},this.addComponentAfterFooter=function(e){},this.mount=function(e,t){return l(this,"mount",e,t).then(function(){s.default.setModal(!0)})},this.layout=function(){this.internalComponent.reloadLayout()}}i(d,u),t.exports=d},{"components/Form.vue":214,"components/FormBody.vue":215,"core/utils/utils":68,"gui/component/component":117,"gui/form/formservice":122,"services/gui":361}],124:[function(e,t,r){var n=e("core/utils/utils"),i=n.inherit,a=n.base;function o(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.state.input.options.values.find(function(e){return!1===e.checked});e.validatorOptions={values:e.state.input.options.values.map(function(e){return e})},null!==e.state.value||e.state.forceNull||(e.state.value=t.value),a(this,e)}i(o,e("gui/inputs/service"));n=o.prototype;n.convertCheckedToValue=function(t){t=null!=t&&t;var e=this.state.input.options.values.find(function(e){return e.checked===t});return this.state.value=e.value,this.state.value},n.convertValueToChecked=function(){var e,t=this.state.value;return null!=t&&(void 0===(e=this.state.input.options.values.find(function(e){return e.value==t}))&&(e=this.state.input.options.values.find(function(e){return!1===e.checked}),this.state.value=e.value),e.checked)},t.exports=o},{"core/utils/utils":68,"gui/inputs/service":147}],125:[function(e,t,r){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/InputCheckbox.vue"));e=Vue.extend(e);t.exports=e},{"components/InputCheckbox.vue":235}],126:[function(e,t,r){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/InputColor.vue"));e=Vue.extend(e);t.exports=e},{"components/InputColor.vue":236}],127:[function(e,t,r){var n=e("services/application"),i=(n=n)&&n.__esModule?n:{default:n};var n=e("core/utils/utils"),a=n.inherit,o=n.base,s=n.convertQGISDateTimeFormatToMoment;function l(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.validatorOptions={},o(this,e)}a(l,e("gui/inputs/service"));n=l.prototype;n.getLocale=function(){var e=i.default.getConfig();return e.user.i18n||"en"},n.convertQGISDateTimeFormatToMoment=function(e){return s(e)},n.setValidatorOptions=function(e){this.validatorOptions=e},t.exports=l},{"core/utils/utils":68,"gui/inputs/service":147,"services/application":351}],128:[function(e,t,r){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/InputDateTimePicker.vue"));e=Vue.extend(e);t.exports=e},{"components/InputDateTimePicker.vue":237}],129:[function(e,t,r){var n=e("core/utils/utils"),i=n.base;function a(){i(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}(0,n.inherit)(a,e("gui/inputs/service")),t.exports=a},{"core/utils/utils":68,"gui/inputs/service":147}],130:[function(e,t,r){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/InputFloat.vue"));e=Vue.extend(e);t.exports=e},{"components/InputFloat.vue":238}],131:[function(e,t,r){var n=o(e("store/application-state")),i=o(e("components/InputBase.vue")),a=e("mixins");function o(e){return e&&e.__esModule?e:{default:e}}var s=e("./services"),e={props:["state"],mixins:[a.baseInputMixin],components:{baseinput:i.default},watch:{notvalid:function(e){e&&this.service.setErrorMessage(this.state)},"state.value":function(){var e=this;void 0!==this.state.input.options.default_expression&&setTimeout(function(){return e.change()})}},created:function(){var e=this;this.service=new s[this.state.input.type]({state:this.state}),this.$watch(function(){return n.default.language},function(){return e.service.setErrorMessage(e.state)}),this.state.editable&&this.state.validate.required&&this.service.validate(),this.$emit("addinput",this.state),this.state.value_from_default_value&&this.$emit("changeinput",this.state)},destroyed:function(){this.$emit("removeinput",this.state)}};t.exports=e},{"./services":148,"components/InputBase.vue":234,mixins:343,"store/application-state":373}],132:[function(e,t,r){e={text_input:e("./text/vue/text"),texthtml_input:e("./texthtml/vue/texthtml"),textarea_input:e("./textarea/vue/textarea"),integer_input:e("./integer/vue/integer"),string_input:e("./text/vue/text"),float_input:e("./float/vue/float"),radio_input:e("./radio/vue/radio"),check_input:e("./checkbox/vue/checkbox"),range_input:e("./range/vue/range"),datetimepicker_input:e("./datetimepicker/vue/datetimepicker"),unique_input:e("./unique/vue/unique"),select_input:e("./select/vue/select"),media_input:e("./media/vue/media"),select_autocomplete_input:e("./select/vue/select"),picklayer_input:e("./picklayer/vue/picklayer"),color_input:e("./color/vue/color"),slider_input:e("./sliderrange/vue/sliderrange"),lonlat_input:e("./lonlat/vue/lonlat")};t.exports=e},{"./checkbox/vue/checkbox":125,"./color/vue/color":126,"./datetimepicker/vue/datetimepicker":128,"./float/vue/float":130,"./integer/vue/integer":134,"./lonlat/vue/lonlat":136,"./media/vue/media":138,"./picklayer/vue/picklayer":140,"./radio/vue/radio":142,"./range/vue/range":144,"./select/vue/select":146,"./sliderrange/vue/sliderrange":150,"./text/vue/text":151,"./textarea/vue/textarea":152,"./texthtml/vue/texthtml":153,"./unique/vue/unique":155}],133:[function(e,t,r){var n=e("core/utils/utils"),i=n.base;function a(){i(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}(0,n.inherit)(a,e("gui/inputs/service")),t.exports=a},{"core/utils/utils":68,"gui/inputs/service":147}],134:[function(e,t,r){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/InputInteger.vue"));e=Vue.extend(e);t.exports=e},{"components/InputInteger.vue":241}],135:[function(e,t,r){var n=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=e("services/gui"),a=(i=i)&&i.__esModule?i:{default:i};var i=e("core/utils/utils"),o=i.base;function s(){var t=this;o(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),this.coordinatebutton,this.mapService=a.default.getComponent("map").getService(),this.mapEpsg=this.mapService.getCrs(),this.mapControlToggleEventHandler=function(e){e.target.isToggled()&&e.target.isClickMap()&&t.coordinatebutton.active&&t.toggleGetCoordinate()},this.map=a.default.getComponent("map").getService().getMap(),this.outputEpsg=this.state.epsg||this.mapEpsg,this.eventMapKey}(0,i.inherit)(s,e("gui/inputs/service"));i=s.prototype;i.setCoordinateButtonReactiveObject=function(e){this.coordinatebutton=e},i.validate=function(){this.state.values.lon<-180?this.state.values.lon=-180:180<this.state.values.lon&&(this.state.values.lon=180),this.state.values.lat<-90?this.state.values.lon=-90:90<this.state.values.lat&&(this.state.values.lon=90),this.state.validate.valid=!Number.isNaN(+this.state.values.lon)},i.toggleGetCoordinate=function(){this.coordinatebutton.active=!this.coordinatebutton.active,this.coordinatebutton.active?this.startToGetCoordinates():this.stopToGetCoordinates()},i.startToGetCoordinates=function(){var r=this;this.mapService.deactiveMapControls(),this.mapService.on("mapcontrol:toggled",this.mapControlToggleEventHandler),this.eventMapKey=this.map.on("click",function(e){e.originalEvent.stopPropagation(),e.preventDefault();var e=r.mapEpsg!==r.outputEpsg?ol.proj.transform(e.coordinate,r.mapEpsg,r.outputEpsg):e.coordinate,e=(r.state.value=[e],n(e,2)),t=e[0],e=e[1];r.state.values.lon=t,r.state.values.lat=e})},i.stopToGetCoordinates=function(){ol.Observable.unByKey(this.eventMapKey),this.mapService.off("mapcontrol:toggled",this.mapControlToggleEventHandler)},i.clear=function(){this.stopToGetCoordinates()},t.exports=s},{"core/utils/utils":68,"gui/inputs/service":147,"services/gui":361}],136:[function(e,t,r){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/InputLonLat.vue"));e=Vue.extend(e);t.exports=e},{"components/InputLonLat.vue":242}],137:[function(e,t,r){var n=e("core/utils/utils"),i=n.inherit,a=n.base;function o(){a(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}i(o,e("gui/inputs/service")),t.exports=o},{"core/utils/utils":68,"gui/inputs/service":147}],138:[function(e,t,r){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/InputMedia.vue"));e=Vue.extend(e);t.exports=e},{"components/InputMedia.vue":243}],139:[function(e,t,r){var s=n(e("store/map-layers")),l=n(e("services/gui"));function n(e){return e&&e.__esModule?e:{default:e}}var i=e("g3w-ol/interactions/pickfeatureinteraction"),a=e("g3w-ol/interactions/pickcoordinatesinteraction"),u=e("core/utils/geo").getQueryLayersPromisesByCoordinates;function o(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.pick_type=e.pick_type||"wms",this.ispicked=!1,this.fields=e.fields||[e.value],this.layerId=e.layer_id,this.mapService=l.default.getService("map"),this.interaction="map"===this.pick_type?new i({layers:[this.mapService.getLayerById(this.layerId)]}):new a}e=o.prototype;e.isPicked=function(){return this.ispicked},e.escKeyUpHandler=function(e){var t=e.keyCode,e=e.data.owner;27===t&&e.unpick()},e.unbindEscKeyUp=function(){$(document).unbind("keyup",this.escKeyUpHandler)},e.bindEscKeyUp=function(){$(document).on("keyup",{owner:this},this.escKeyUpHandler)},e.pick=function(){var o=this;return new Promise(function(r,n){o.bindEscKeyUp();function i(e){var t;e?(t=e.getProperties(),o.fields.forEach(function(e){a[e]=t[e]}),r(a)):n(),o.ispicked=!1,o.unpick()}var a={};o.ispicked=!0;l.default.setModal(!1),o.mapService.addInteraction(o.interaction),o.interaction.once("picked",function(e){var t;"map"===o.pick_type?(t=e.feature,i(t)):"wms"===o.pick_type&&(t=s.default.getLayerById(o.layerId))&&u([t],{map:o.mapService.getMap(),feature_count:1,coordinates:e.coordinate}).then(function(e){e=e[0].data,e=void 0===e?[]:e,e=e.length&&e[0].features[0]||null;i(e)})})})},e.unpick=function(){this.mapService.removeInteraction(this.interaction),l.default.setModal(!0),this.unbindEscKeyUp(),this.ispicked=!1},e.clear=function(){this.isPicked()&&this.unpick(),this.mapService=this.interaction=this.field=null},t.exports=o},{"core/utils/geo":64,"g3w-ol/interactions/pickcoordinatesinteraction":105,"g3w-ol/interactions/pickfeatureinteraction":106,"services/gui":361,"store/map-layers":377}],140:[function(e,t,r){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/InputPickLayer.vue"));e=Vue.extend(e);t.exports=e},{"components/InputPickLayer.vue":244}],141:[function(e,t,r){var n=e("core/utils/utils"),i=n.inherit,a=n.base;function o(){a(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}i(o,e("gui/inputs/service")),t.exports=o},{"core/utils/utils":68,"gui/inputs/service":147}],142:[function(e,t,r){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/InputRadio.vue"));e=Vue.extend(e);t.exports=e},{"components/InputRadio.vue":245}],143:[function(e,t,r){var n=e("core/utils/utils"),i=n.inherit,a=n.base,n=e("gui/inputs/service"),o=e("core/utils/validators");function s(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.state.input.options.values[0],r=t.min,t=t.max,e=(e.state.info="[MIN: "+r+" - MAX: "+t+"]",a(this,e),o.get("range",{min:+r,max:+t}));this.setValidator(e)}i(s,n),n.prototype.isValueInRange=function(e,t,r){return e<=r&&t<=e},t.exports=s},{"core/utils/utils":68,"core/utils/validators":69,"gui/inputs/service":147}],144:[function(e,t,r){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/InputRange.vue"));e=Vue.extend(e);t.exports=e},{"components/InputRange.vue":246}],145:[function(e,t,r){var i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},n=e("store/catalog-layers"),a=(n=n)&&n.__esModule?n:{default:n};var n=e("core/utils/utils"),o=n.inherit,s=n.base;function l(){s(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),this.layer=null}o(l,e("gui/inputs/service"));n=l.prototype;n._getLayerById=function(e){return a.default.getLayerById(e)},n.addValue=function(e){this.state.input.options.values.push(e)},n.getKeyByValue=function(){var r=this,e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).search,t=this.state.input.options,n=t.value,t=t.key;this.getData({key:n,value:t,search:e}).then(function(e){var e=i(e,1)[0],t=e.$value,e=e.text;r.addValue({key:t,value:e})}).catch(function(e){})},n.getData=function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.layer_id,n=void 0===r?this.state.input.options.layer_id:r,r=t.key,a=void 0===r?this.state.input.options.key:r,r=t.value,o=void 0===r?this.state.input.options.value:r,r=t.search,s=(a+"|"+r).trim();return new Promise(function(i,t){e._layer||(e._layer=e._getLayerById(n)),e._layer.getDataTable({suggest:s,ordering:a}).then(function(e){for(var t=[],r=e.features,n=0;n<r.length;n++)t.push({text:r[n].properties[a],id:n,$value:r[n].properties[o]});i(t)}).fail(function(e){return t(e)})})},t.exports=l},{"core/utils/utils":68,"gui/inputs/service":147,"store/catalog-layers":374}],146:[function(e,t,r){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/InputSelect.vue"));e=Vue.extend(e);t.exports=e},{"components/InputSelect.vue":247}],147:[function(e,t,r){var n=e("core/utils/validators"),i=e("core/utils/utils").toRawType,a=e("core/i18n/i18n.service").t;function o(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(this.state=e.state||{},this.setValue(this.state.value),this.setEmpty(this.state.value),this.state.type),r=e.validatorOptions||this.state.input.options||{};this._validator=n.get(t,r),this.setErrorMessage(e.state)}e=o.prototype;e.getState=function(){return this.state},e.getValue=function(){return this.state.value},e.setValue=function(e){var t,r;null==e&&(t=(e=this.state.input.options).default,Array.isArray(e)&&(e[0].default?t=e[0].default:Array.isArray(e.values)&&0<e.values.length&&(t=e.values[0]&&(e.values[0].value||e.values[0]))),(r=this.state.get_default_value&&null!=t)&&void 0===e.default_expression&&(this.state.value=t),this.state.value_from_default_value=r)},e.addValueToValues=function(e){this.state.input.options.values.unshift(e)},e._getValidatorType=function(){return this.state.type},e.setState=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.state=_.isObject(e)?e:{}},e.getValidator=function(){return this._validator},e.setValidator=function(e){this._validator=e},e.setEmpty=function(){this.state.validate.empty=!(Array.isArray(this.state.value)&&this.state.value.length||!_.isEmpty(_.trim(this.state.value)))},e.validate=function(){return this.state.validate.empty?(this.state.validate.empty=!0,this.state.value=null,this.state.validate.unique=!0,this.state.validate.valid=!this.state.validate.required&&this._validator.validate(this.state.value)):("integer"!==this.state.input.type&&"float"!==this.state.input.type||(+this.state.value<0?(this.state.value=null,this.state.validate.empty=!0,this.state.validate.valid=!this.state.validate.required):this.state.validate.valid=this._validator.validate(this.state.value)),this.state.validate.exclude_values&&this.state.validate.exclude_values.size?this.state.validate.valid=!this.state.validate.exclude_values.has(this.state.value):this.state.validate.valid=this._validator.validate(this.state.value)),this.state.validate.valid},e.setErrorMessage=function(e){var t=void 0;e.validate.mutually&&!e.validate.mutually_valid?this.state.validate.message=a("sdk.form.inputs.input_validation_mutually_exclusive")+" ( "+e.validate.mutually.join(",")+" )":e.validate.max_field?this.state.validate.message=a("sdk.form.inputs.input_validation_max_field")+" ("+e.validate.max_field+")":e.validate.min_field?this.state.validate.message=a("sdk.form.inputs.input_validation_min_field")+" ("+e.validate.min_field+")":e.validate.unique&&e.validate.exclude_values&&e.validate.exclude_values.size?this.state.validate.message=""+a("sdk.form.inputs.input_validation_exclude_values"):e.validate.required?(t=a("sdk.form.inputs.input_validation_error")+" ( "+a("sdk.form.inputs."+e.type)+" )",this.state.info&&(t=t+"\n                 <div>\n                  <b>"+this.state.info+"</b>\n                 </div>         \n      "),this.state.validate.message=this.state.info||t):this.state.validate.message=this.state.info},e.setUpdate=function(){var e=this.state,t=e.value,e=e._value;"media"===this.state.input.type&&"Object"!==i(t)&&"Object"!==i(e)?this.state.update=t.value!=e.value:"datetimepicker"===this.state.input.type?this.state.update=(null!==t?t.toUpperCase():t)!=(e&&e.toUpperCase()):this.state.update=t!=e},t.exports=o},{"core/i18n/i18n.service":13,"core/utils/utils":68,"core/utils/validators":69}],148:[function(e,t,r){e={text:e("./service"),textarea:e("./service"),texthtml:e("./service"),integer:e("./integer/service"),string:e("./service"),float:e("./float/service"),radio:e("./radio/service"),check:e("./checkbox/service"),range:e("./range/service"),datetimepicker:e("./datetimepicker/service"),unique:e("./unique/service"),select:e("./select/service"),media:e("./media/service"),select_autocomplete:e("./select/service"),picklayer:e("./service"),color:e("./service"),slider:e("./sliderrange/service"),lonlat:e("./lonlat/service")};t.exports=e},{"./checkbox/service":124,"./datetimepicker/service":127,"./float/service":129,"./integer/service":133,"./lonlat/service":135,"./media/service":137,"./radio/service":141,"./range/service":143,"./select/service":145,"./service":147,"./sliderrange/service":149,"./unique/service":154}],149:[function(e,t,r){var n=e("core/utils/utils"),i=n.base,n=n.inherit,a=e("gui/inputs/service"),o=e("core/utils/validators");function s(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.state,e=(e.state.info="[MIN: "+t.input.options.min+" - MAX: "+t.input.options.max+"]",i(this,e),o.get("range",{min:+t.input.options.min,max:+t.input.options.max}));this.setValidator(e),this.validate=function(){this.state.value=+this.state.value,this.state.validate.valid=this.state.value>=this.state.input.options.min||this.state.value<=this.state.input.options.max}}n(s,a),s.prototype.changeInfoMessage=function(){this.state.info="[MIN: "+this.state.input.options.min+" - MAX: "+this.state.input.options.max+"]"},t.exports=s},{"core/utils/utils":68,"core/utils/validators":69,"gui/inputs/service":147}],150:[function(e,t,r){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/InputSliderRange.vue"));e=Vue.extend(e);t.exports=e},{"components/InputSliderRange.vue":248}],151:[function(e,t,r){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/InputText.vue"));e=Vue.extend(e);t.exports=e},{"components/InputText.vue":249}],152:[function(e,t,r){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/InputTextArea.vue"));e=Vue.extend(e);t.exports=e},{"components/InputTextArea.vue":250}],153:[function(e,t,r){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/InputTextHtml.vue"));e=Vue.extend(e);t.exports=e},{"components/InputTextHtml.vue":251}],154:[function(e,t,r){var n=e("core/utils/utils"),i=n.inherit,a=n.base;function o(){a(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}i(o,e("gui/inputs/service")),t.exports=o},{"core/utils/utils":68,"gui/inputs/service":147}],155:[function(e,t,r){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/InputUnique.vue"));e=Vue.extend(e);t.exports=e},{"components/InputUnique.vue":252}],156:[function(e,t,r){var n=e("g3w-ol/controls/resetcontrol"),i=e("g3w-ol/controls/querycontrol"),a=e("g3w-ol/controls/zoomboxcontrol"),o=e("g3w-ol/controls/querybboxcontrol"),s=e("g3w-ol/controls/querybypolygoncontrol"),l=e("g3w-ol/controls/geolocationcontrol"),u=e("g3w-ol/controls/streetviewcontrol"),c=e("g3w-ol/controls/addlayers"),d=e("g3w-ol/controls/lengthcontrol"),p=e("g3w-ol/controls/areacontrol"),f=e("g3w-ol/controls/olcontrol"),h=e("g3w-ol/controls/geocodingcontrol"),g=e("g3w-ol/controls/mousepositioncontrol"),v=e("g3w-ol/controls/scalecontrol"),m=e("g3w-ol/controls/onclickcontrol"),y=e("g3w-ol/controls/screenshotcontrol"),_=e("g3w-ol/controls/geoscreenshotcontrol"),b=e("g3w-ol/controls/zoomhistorycontrol"),w=e("g3w-ol/controls/querybydrawpolygoncontrol"),e=e("g3w-ol/controls/interactioncontrol"),x={create:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=x.CONTROLS[e.type];if(t)return new t(e)}};x.CONTROLS={reset:n,zoombox:a,zoomtoextent:f,query:i,querybbox:o,querybypolygon:s,geolocation:l,streetview:u,zoom:f,scaleline:f,overview:f,geocoding:h,addlayers:c,length:d,area:p,mouseposition:g,scale:v,onclick:m,ontoggle:e,screenshot:y,geoscreenshot:_,querybydrawpolygon:w,zoomhistory:b,nominatim:h},t.exports=x},{"g3w-ol/controls/addlayers":76,"g3w-ol/controls/areacontrol":77,"g3w-ol/controls/geocodingcontrol":80,"g3w-ol/controls/geolocationcontrol":81,"g3w-ol/controls/geoscreenshotcontrol":82,"g3w-ol/controls/interactioncontrol":83,"g3w-ol/controls/lengthcontrol":84,"g3w-ol/controls/mousepositioncontrol":86,"g3w-ol/controls/olcontrol":87,"g3w-ol/controls/onclickcontrol":88,"g3w-ol/controls/querybboxcontrol":89,"g3w-ol/controls/querybydrawpolygoncontrol":90,"g3w-ol/controls/querybypolygoncontrol":91,"g3w-ol/controls/querycontrol":92,"g3w-ol/controls/resetcontrol":93,"g3w-ol/controls/scalecontrol":94,"g3w-ol/controls/screenshotcontrol":95,"g3w-ol/controls/streetviewcontrol":96,"g3w-ol/controls/zoomboxcontrol":98,"g3w-ol/controls/zoomhistorycontrol":99}],157:[function(t,e,N){var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},y=t("app/constant"),u=(r(t("gui/wms/vue/wms")),r(t("services/data"))),p=r(t("store/map-layers")),f=r(t("store/projects")),i=r(t("services/application")),s=r(t("store/map-controls")),b=r(t("services/gui"));function r(e){return e&&e.__esModule?e:{default:e}}function n(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}function h(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}t("core/i18n/i18n.service").t;var a=t("core/utils/utils"),c=a.inherit,d=a.base,g=a.copyUrl,w=a.uniqueId,v=a.throttle,m=a.toRawType,x=a.createFilterFromString,a=t("core/g3wobject"),S=t("core/utils/geo"),L=S.createVectorLayerFromFile,C=S.createWMSLayer,k=S.createSelectedStyle,E=S.getMapLayersByFilter,M=S.getGeoTIFFfromServer,T=t("core/layers/providers/wfsprovider"),I=t("g3w-ol/g3w.ol").helpers,S=t("core/utils/ol"),D=S.getScaleFromResolution,G=S.getResolutionFromScale,P=t("gui/map/control/factory"),F=t("core/layers/vectorlayer");function O(){function e(t,e){e&&n.getMapLayers().forEach(function(e){return e.update(n.state,t)})}var n=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.state={mapUnits:"m",bbox:[],hidemaps:[],resolution:null,center:null,loading:!1,hidden:!0,scale:0,mapcontrolsalignement:"rv",mapcontrolDOM:null,mapcontrolready:!1,mapcontrolSizes:{height:47,width:47,minWidth:47,minHeight:47},mapControl:{grid:[],length:0,currentIndex:0,update:!0,disabled:!1},map_info:{info:null,style:null},mapunits:["metric"]},this.id="MapService",this._ready=new Promise(function(e,t){n.once("viewerset",function(){p.default.getLayersStores().forEach(n._setUpEventsKeysToLayersStore.bind(n)),p.default.onafter("addLayersStore",n._setUpEventsKeysToLayersStore.bind(n)),p.default.onafter("removeLayersStore",n._removeEventsKeysToLayersStore.bind(n)),e()})}),this.viewer=null,this.target=t.target||null,this.layersCount=0,this.maps_container=t.maps_container||null,this._layersStoresEventKeys={},this._keyEvents={ol:[],g3wobject:[],eventemitter:[]},this.project=null,this._mapControls=[],this._changeMapMapControls=[],this._mapLayers=[],this._externalMapLayers=[],this._externalLayers=[],this._externalInteractions=[],this.mapBaseLayers={},this.defaultsLayers={_style:{highlightLayer:{color:void 0},selectionLayer:{color:"red"}},highlightLayer:new ol.layer.Vector({source:new ol.source.Vector,style:function(e){var t=[],e=e.getGeometry().getType(),e=k({geometryType:e,color:n.defaultsLayers._style.highlightLayer.color,fill:!1});return t.push(e),t}}),selectionLayer:new ol.layer.Vector({source:new ol.source.Vector,style:function(e){var t=[],e=e.getGeometry().getType(),e=k({geometryType:e,color:n.defaultsLayers._style.selectionLayer.color,fill:!1});return t.push(e),t}})},this.layersExtraParams={},this._greyListenerKey=null,this._drawShadow={type:"coordinate",outer:[],inner:[],scale:null,rotation:null},this.config=t.config||i.default.getConfig(),this._howManyAreLoading=0,this._layersLoadingError=!1,this._incrementLoaders=function(){0===n._howManyAreLoading&&(n.emit("loadstart"),b.default.showSpinner({container:$("#map-spinner"),id:"maploadspinner",style:"transparent"})),n._howManyAreLoading+=1},this._decrementLoaders=function(){--n._howManyAreLoading,0===n._howManyAreLoading&&(n.emit("loadend"),b.default.hideSpinner("maploadspinner"))},this._mapLayerLoadError=function(){n._layersLoadingError||(b.default.notify.warning("sdk.errors.layers.load"),n._layersLoadingError=!0),n._decrementLoaders()},t.project?this.project=t.project:(this.project=f.default.getCurrentProject(),t=f.default.onafter("setCurrentProject",function(e){n.removeLayers(),n._removeListeners();function t(){n._resetView(),n._setupAllLayers(),n._checkMapControls(),n.setUpMapOlEvents(),n.setupCustomMapParamsToLegendUrl()}var r=n.project.getId()===e.getId();n.project=e;i.default.isIframe()&&t(),r?t():n.getMap().once("change:size",t)}),this._keyEvents.g3wobject.push({who:f.default,setter:"setCurrentProject",key:t})),this._setupListeners(),this._marker=null,this._bboxLayer=new ol.layer.Vector({source:new ol.source.Vector({})}),this.debounces={setupCustomMapParamsToLegendUrl:{fnc:function(){n._setupCustomMapParamsToLegendUrl.apply(n,arguments)},delay:1e3}},this.setters={setupControls:function(){return this._setupControls()},addHideMap:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=(e.ratio,e.layers,e.mainview,e.switchable),e=void 0!==e&&e,e={id:"hidemap_"+Date.now(),map:null,switchable:e};return this.state.hidemaps.push(e),e},updateMapView:function(e,t,r){this.state.bbox=e,this.state.resolution=t,this.state.center=r,this.updateMapLayers()},setHidden:function(e){this.state.hidden=e},setupViewer:function(e,t){0!==e&&0!==t&&(this.viewer&&(this.viewer.destroy(),this.viewer=null),this._setupViewer(e,t),this.state.bbox=this.viewer.getBBOX(),this.state.resolution=this.viewer.getResolution(),this.state.center=this.viewer.getCenter(),this._setupAllLayers(),this.setUpMapOlEvents(),this.emit("viewerset"))},controlClick:function(e){},loadExternalLayer:function(e){},unloadExternalLayer:function(e){}},this._onCatalogSelectLayer=function(e){s.default.catalogSelectedLayer(e)},this.on("cataloglayerselected",this._onCatalogSelectLayer),this._keyEvents.eventemitter.push({event:"cataloglayerselected",listener:this._onCatalogSelectLayer});this.on("extraParamsSet",e),this._keyEvents.eventemitter.push({event:"extraParamsSet",listener:e}),d(this)}c(O,a);var R,A,S=O.prototype,j=(S.isReady=function(){return this._ready},S.setUpMapOlEvents=function(){var t=this,r=this.project.getContextBaseLegend(),e=(this._keyEvents.ol.forEach(function(e){return ol.Observable.unByKey(e)}),this.viewer.map.getView().on("change:resolution",function(e){t._updateMapView(),r&&t.setupCustomMapParamsToLegendUrl()}));this._keyEvents.ol.push(e),r?(e=this.viewer.map.on("moveend",function(e){return t.setupCustomMapParamsToLegendUrl()}),this._keyEvents.ol.push(e)):this.setupCustomMapParamsToLegendUrl()},S.clear=function(){var r=this;Object.keys(this._keyEvents).forEach(function(e){switch(e){case"ol":r._keyEvents[e].forEach(function(e){return ol.Observable.unByKey(e)});break;case"g3wobject":r._keyEvents[e].forEach(function(e){var t=e.who,r=e.setter,e=e.key;t.un(r,e)});break;case"eventemitter":r._keyEvents[e].forEach(function(e){var t=e.event,e=e.listener;r.removeListener(t,e)})}}),this._keyEvents=null,p.default.getLayersStores().forEach(this._removeEventsKeysToLayersStore.bind(this))},S.showMapSpinner=function(){b.default.showSpinner({container:$("#map-spinner"),id:"maploadspinner",style:"transparent"})},S.hideMapSpinner=function(){b.default.hideSpinner("maploadspinner")},S.getScaleFromExtent=function(e){e=this.getMap().getView().getResolutionForExtent(e,this.getMap().getSize());return D(e,this.getMapUnits())},S._addHideMap=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.ratio,r=e.layers,n=void 0===r?[]:r,r=e.mainview,e=void 0!==r&&r,i=this.state.hidemaps[this.state.hidemaps.length-1],r=this.getMap().getView(),a={projection:r.getProjection(),center:r.getCenter(),resolution:this.getResolution()},e=I.createViewer({id:i.id,view:e?r:a});i.map=e.getMap(),t&&(r=i.map.getSize(),e=(a=l(r,2))[0],a[1],i.map.setSize([e,e*t]));for(var o=0;o<n.length;o++){var s=n[o];i.map.addLayer(s)}return i.map},S.removeHideMap=function(e){for(var t=void 0,r=0;r<this.state.hidemaps.length;r++)if(e===this.state.hidemaps[r].id){t=r;break}void 0!==t&&this.state.hidemaps.splice(t,1)},S._showHideMapElement=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.map,e=e.show;void 0!==e&&e?$(t.getTargetElement()).addClass("show"):$(t.getTargetElement()).removeClass("show")},S.createMapImage=function(){var n=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=e.map;e.background;return new Promise(function(t,r){try{var e=n.getMapCanvas(i);navigator.msSaveBlob?t(e.msToBlob()):e.toBlob(function(e){return t(e)})}catch(e){r(e)}})},S.getApplicationAttribution=function(){var e=this.config.group,t=e.header_terms_of_use_link,e=e.header_terms_of_use_text;return!!e&&(t?'<a href="'+t+'">'+e+"</a>":'<span class="skin-color" style="font-weight: bold">'+e+"</span>")},S.slaveOf=function(e,t){},S.setLayersExtraParams=function(e,t){this.layersExtraParams=_.assign(this.layersExtraParams,e),this.emit("extraParamsSet",e,t)},S.getProject=function(){return this.project},S.getMap=function(){try{return this.viewer.map}catch(e){}},S.getMapCanvas=function(e){e=e?e.getViewport():$("#"+this.maps_container+" .g3w-map").last().children(".ol-viewport")[0];return $(e).children("canvas")[0]},S.getProjection=function(){return this.project.getProjection()},S.isMapHidden=function(){return this.state.hidden},S.isAxisOrientationInverted=function(){return"neu"===this.getProjection().getAxisOrientation()},S.getCrs=function(){return this.getProjection().getCode()},S.getViewerElement=function(){return this.viewer.map.getTargetElement()},S.getViewport=function(){return this.viewer.map.getViewport()},S.getResolution=function(){return this.viewer.map.getView().getResolution()},S.getEpsg=function(){return this.viewer.map.getView().getProjection().getCode()},S.getGetFeatureInfoUrlForLayer=function(e,t,r,n,i){return this.getMapLayerForLayer(e).getGetFeatureInfoUrl(t,r,n,i)},S.showMarker=function(e){var t=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1e3;this._marker.setPosition(e),setTimeout(function(){return t._marker.setPosition()},r)},S.getLayerByName=function(t){return this.getMap().getLayers().getArray().find(function(e){return e.get("name")===t})},S.getLayerById=function(t){return this.getMap().getLayers().getArray().find(function(e){return e.get("id")===t})},S.getVectorLayerFeaturesFromCoordinates=function(e,t){var r=void 0,n=[],i=this.getMap(),a=this.getLayerById(e);if(Array.isArray(t)){if(2===t.length){e=i.getPixelFromCoordinate(t);i.forEachFeatureAtPixel(e,function(e){return n.push(e)},{layerFilter:function(e){return e===a}})}else if(4===t.length)switch(r=ol.geom.Polygon.fromExtent(t),a.constructor){case F:n=a.getIntersectedFeatures(r);break;case ol.layer.Vector:a.getSource().getFeatures().forEach(function(e){r.intersectsExtent(e.getGeometry().getExtent())&&n.push(e)})}}else if(t instanceof ol.geom.Polygon||t instanceof ol.geom.MultiPolygon)switch(r=t,a.constructor){case F:n=a.getIntersectedFeatures(r);break;case ol.layer.Vector:a.getSource().getFeatures().forEach(function(e){r.intersectsExtent(e.getGeometry().getExtent())&&n.push(e)})}return n},S.getQueryLayerByCoordinates=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=e.layer,i=e.coordinates,a=this.getProjection(),o=this.getResolution();return new Promise(function(t,r){n.query({coordinates:i,mapProjection:a,resolution:o}).then(function(e){return t(e)}).fail(function(e){return r(e)})})},S.getQueryLayerPromiseByCoordinates=function(){var i=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=e.layer,o=e.coordinates;return new Promise(function(t,r){var e=i.getProjection(),n=i.getResolution();a.query({coordinates:o,mapProjection:e,resolution:n}).then(function(e){t(e)}).fail(function(e){r(e)})})},S.activeMapControl=function(t){var e=this._mapControls.find(function(e){return e.type===t}).control;e.isToggled()||e.toggle()},S.createMapControl=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=t.id,n=t.add,n=void 0===n||n,i=t.toggled,a=t.visible,t=t.options,i=P.create(o({type:e,toggled:void 0!==i&&i},void 0===t?{}:t)),a=void 0===a?!i.isVisible||i.isVisible():a;return i&&this.addControl(r||e,e,i,n,a),i},S.addScaleLineUnits=function(){var t=this;(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(e){return t.state.mapunits.push(e)})},S.changeScaleLineUnit=function(e){var t=this.getMapControlByType({type:"scaleline"});t&&t.getOlControl().setUnits(e)},S.showAddLayerModal=function(){this.emit("addexternallayer")},S._checkMapControls=function(){this._changeMapMapControls.forEach(function(e){var t=e.control,e=e.getLayers;t.change(e())})},S._setupControls=function(){var c,d=this,e=E({BASELAYER:!0});if(this.getMapLayers().forEach(function(e){return e.getSource().setAttributions(d.getApplicationAttribution())}),(this.getApplicationAttribution()||e.length)&&(e=new ol.control.Attribution({collapsible:!1,target:"map_footer_left"}),this.getMap().addControl(e)),this.config&&this.config.mapcontrols)return e=this.config.mapcontrols,c="intersects",e.forEach(function(e){var t,r,n,i,a,o=void 0,s="String"===m(e)?e:e.name;switch(s){case"reset":isMobile.any||(o=P.create({type:s})),d.addControl(s,o,!1);break;case"zoom":o=d.createMapControl(s,{options:{zoomInLabel:"",zoomOutLabel:""}});break;case"zoombox":isMobile.any||(o=d.createMapControl(s,{})).on("zoomend",function(e){d.viewer.fit(e.extent)});break;case"zoomtoextent":o=d.createMapControl(s,{options:{label:"",extent:d.project.state.initextent}});break;case"mouseposition":isMobile.any||(t="m"===d.getProjection().getUnits()?["X","Y"]:["Lng","Lat"],r=d.getCrs(),o=d.createMapControl(s,{add:!1,options:{coordinateFormat:function(e){return ol.coordinate.format(e," "+t[0]+": {x}, "+t[1]+": {y}   ["+r+"] ",4)},undefinedHTML:!1,projection:d.getCrs()}}),"EPSG:4326"!==d.getEpsg()&&(n=d.getEpsg(),i=["Lng","Lat"],a=d.getCrs(),o=d.createMapControl(s,{add:!1,options:{target:"mouse-position-control-epsg-4326",coordinateFormat:function(e){return e=ol.proj.transform(e,n,"EPSG:4326"),ol.coordinate.format(e," "+i[0]+": {x}, "+i[1]+": {y}   ["+a+"] ",4)},undefinedHTML:!1,projection:d.getCrs()}})));break;case"screenshot":case"geoscreenshot":isMobile.any||(o=d.createMapControl(s,{options:{layers:[].concat(h(p.default.getLayers()),h(d._externalLayers)),onclick:d._handlePrint.bind(d,s)}}));break;case"scale":o=d.createMapControl(s,{add:!1,options:{coordinateFormat:ol.coordinate.createStringXY(4),projection:d.getCrs(),isMobile:isMobile.any}});break;case"query":o=d.createMapControl(s,{add:!0,toggled:!0});break;case"querybypolygon":case"querybbox":case"querybydrawpolygon":isMobile.any||(o=d.createMapControl(s,{options:{spatialMethod:c}}));break;case"streetview":o=d.createMapControl(s,{});break;case"scaleline":o=d.createMapControl(s,{add:!1,options:{position:"br"}});break;case"overview":if(!isMobile.any){if(!d.config.overviewproject)return;var l=d.config.overviewproject.gid;l&&f.default.getProject(l).then(function(e){var t=d.getOverviewMapLayers(e),e=d._calculateViewOptions({width:200,height:150,project:e}),r=new ol.View(e),n=d.getMap().getView();r.on("change:center",function(){var e=this.getCenter(),t=n.constrainCenter(e);t[0]===e[0]&&t[1]!==e[1]&&r.setCenter(t)}),o=d.createMapControl(s,{add:!1,options:{position:"bl",className:"ol-overviewmap ol-custom-overviewmap",collapseLabel:$('<span class="'+b.default.getFontClass("arrow-left")+'"></span>')[0],label:$('<span class="'+b.default.getFontClass("arrow-right")+'"></span>')[0],collapsed:!1,layers:t,view:r}})})}break;case"geocoding":case"nominatim":var l=d.project.state,u=l.extent,l=l.crs.epsg;o=d.createMapControl(s,{add:!1,options:{isMobile:isMobile.any,bbox:u,mapCrs:l,placeholder:"mapcontrols.nominatim.placeholder",noresults:"mapcontrols.nominatim.noresults",notresponseserver:"mapcontrols.nominatim.notresponseserver"}});break;case"geolocation":(o=d.createMapControl(s)).on("click",v(function(e){return d.showMarker(e.coordinates)})),o.on("error",function(e){b.default.showUserMessage({type:"warning",message:"mapcontrols.geolocations.error",autoclose:!0})});break;case"addlayers":isMobile.any||(o=d.createMapControl(s,{})).on("addlayer",function(){return d.emit("addexternallayer")});break;case"length":isMobile.any||(o=d.createMapControl(s,{options:{tipLabel:"sdk.mapcontrols.measures.length.tooltip",interactionClassOptions:{projection:d.getProjection(),help:"sdk.mapcontrols.measures.length.help"}}}));break;case"area":isMobile.any||(o=d.createMapControl(s,{options:{tipLabel:"sdk.mapcontrols.measures.area.tooltip",interactionClassOptions:{projection:d.getProjection(),help:"sdk.mapcontrols.measures.area.help"}}}));break;case"zoomhistory":o=d.createMapControl(s,{add:!1}),d._addControlToMapControlsLeftBottom(o)}}),this.getMapControls()},S.setZIndexLayer=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,e=e.zindex,e=void 0===e?this.getMap().getLayers().getLength():e;t&&t.setZIndex(e)},S.getLayerZindex=function(e){return e&&e.getZIndex()},S.getCenter=function(){return this.getMap().getView().getCenter()},S.zoomToFid=n(regeneratorRuntime.mark(function e(){var t,r,n,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"|";return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.split(a),r=l(r,2),t=r[0],r=r[1],void 0!==t&&void 0!==r)return t=this.project.getLayerById(t),e.next=5,u.default.getData("search:fids",{inputs:{layer:t,fids:[r]},outputs:{show:{loading:!1,condition:function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).data,e=void 0===e?[]:e;return e[0]&&0<e[0].features.length}}}});e.next=10;break;case 5:t=e.sent,r=t.data,(n=(n=void 0===r?[]:r)[0]&&n[0].features[0])&&this.zoomToFeatures([n]);case 10:case"end":return e.stop()}},e,this)})),S.handleZoomToFeaturesUrlParameter=n(regeneratorRuntime.mark(function e(){var t,r,n,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=i.zoom_to_features,o=void 0===a?"":a,a=i.search_endpoint,s=void 0===a?"api":a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=o.split(":"),n=l(n,2),t=n[0],n=n[1],t&&n)if(r=this.project.getLayers().find(function(e){return e.id===t||e.name===t||e.origname===t}))return r=this.project.getLayerById(r.id),n=x({layer:r,search_endpoint:s,filter:n}),e.next=9,u.default.getData("search:features",{inputs:{layer:r,filter:n,search_endpoint:s},outputs:{show:{loading:!1}}});e.next=12;break;case 9:r=e.sent,(n=r.data)&&n[0]&&n[0].features&&this.zoomToFeatures(n[0].features);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0);case 17:case"end":return e.stop()}},e,this,[[0,14]])})),S.getMapExtent=function(){var e=this.getMap();return e.getView().calculateExtent(e.getSize())},S.addMapExtentUrlParameterToUrl=function(e,t){return(e=new URL(e)).searchParams.set("map_extent",(void 0!==t&&this.getEpsg()!==t?ol.proj.transformExtent(this.getMapExtent(),this.getEpsg(),t):this.getMapExtent()).toString()),e.toString()},S.getMapExtentUrl=function(){var e=new URL(location.href),t=this.getMapExtent().toString();return e.searchParams.set("map_extent",t),e.toString()},S.createCopyMapExtentUrl=function(){var e=this.getMapExtentUrl();g(e)},S._setMapControlsGrid=function(e){var t,r=this.state.mapControl.grid;e<2?(t=r[r.length-1],r.push({rows:2*t.rows,columns:2})):2===e?r.length?(t=r[r.length-1],r.push({rows:t.columns,columns:t.rows})):r.push({rows:1,columns:2}):3===e?(t=r[r.length-1],r.push({rows:2*t.rows,columns:e})):(r.push({rows:r.length+1+(Number.isInteger(e)?0:1),columns:Number.isInteger(e)?e:parseInt(e)+1}),t=Number.isInteger(e)?e:parseInt(e),this._setMapControlsGrid(t/2))},S._setMapControlsInsideContainerLenght=function(){var r=this;this.state.mapControl.length=1,this._mapControls.forEach(function(e){var t=r.getMap();r.state.mapControl.length+=e.mapcontrol?"zoom"===e.id?2:1:0,e.control.changelayout&&e.control.changelayout(t)}),this.state.mapControl.length+=this.state.mapControl.length%2,this.state.mapControl.grid=[],this._setMapControlsGrid(this.state.mapControl.length)},S.filterableLayersAvailable=function(){return E({FILTERABLE:!0,SELECTED_OR_ALL:!0},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).filter(function(e){return e.getProvider("filter")instanceof T})},S.setMapControlsAlignement=function(){this.state.mapcontrolsalignement=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"rv"},S.getMapControlsAlignement=function(){return this.state.mapcontrolsalignement},S.isMapControlsVerticalAlignement=function(){return-1!==this.state.mapcontrolsalignement.indexOf("v")},S.setMapControlsVerticalAlignement=function(){this.state.mapcontrolsalignement=this.state.mapcontrolsalignement[0]+"v"},S.setMapControlsHorizontalAlignement=function(){this.state.mapcontrolsalignement=this.state.mapcontrolsalignement[0]+"h"},S.flipControlsHorizontally=function(){this.state.mapcontrolsalignement="r"===this.state.mapcontrolsalignement[0]?"l"+this.state.mapcontrolsalignement[1]:"r"+this.state.mapcontrolsalignement[1]},S.flipMapControlsVertically=function(){this.state.mapcontrolsalignment="v"===this.state.mapcontrolsalignement[1]?this.state.mapcontrolsalignement[0]+"h":this.state.mapcontrolsalignement[0]+"v"},S.setMapControlsContainer=function(e){this.state.mapcontrolDOM=e},S._updateMapControlsLayout=function(){var n,i=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.width,a=e.height;0==t||0==a?this.state.mapcontrolDOM.css("z-index",0):this.state.mapcontrolDOM.css("z-index",1),this.state.mapcontrolready&&this.state.mapControl.update&&(n={changed:!1,space:!1},this._mapControls.forEach(function(e){var t=i.getMap();e.control.changelayout&&e.control.changelayout(t)}),this.isMapControlsVerticalAlignement()?function e(){var t=i.state.mapControl.grid[i.state.mapControl.currentIndex].columns*i.state.mapcontrolSizes.minWidth,r=$(".ol-control-b"+i.getMapControlsAlignement()[0]),r=r.length?$(r[r.length-1]).position().top:a,r=0<r?r-t:a-t;r<10?(i.state.mapControl.currentIndex=i.state.mapControl.currentIndex===i.state.mapControl.grid.length-1?i.state.mapControl.currentIndex:i.state.mapControl.currentIndex+1,n.changed=!0):15+(0<i.state.mapControl.currentIndex?i.state.mapControl.grid[i.state.mapControl.currentIndex-1].columns*i.state.mapcontrolSizes.minWidth-t:t)<r&&(n.changed=!0,n.space=!0,i.state.mapControl.currentIndex=0===i.state.mapControl.currentIndex?i.state.mapControl.currentIndex:i.state.mapControl.currentIndex-1),n.changed&&(t=i.state.mapControl.grid[i.state.mapControl.currentIndex].columns*i.state.mapcontrolSizes.minWidth,r=i.state.mapControl.grid[i.state.mapControl.currentIndex].rows*i.state.mapcontrolSizes.minWidth,i.state.mapcontrolDOM.css("height",t+"px"),i.state.mapcontrolDOM.css("width",r+"px"),n.changed=!1,n.space)&&setTimeout(e)}():isMobile.any&&this.setMapControlsAlignement("rv"))},S._setMapControlVisible=function(e){var t=e.control,e=e.visible;t&&t.setVisible(void 0===e||e)},S._addControlToMapControls=function(e){var t=e.element;1<arguments.length&&void 0!==arguments[1]&&!arguments[1]&&(e.element.style.display="none"),$(".g3w-map-controls").append(t)},S._addControlToMapControlsLeftBottom=function(e){1<arguments.length&&void 0!==arguments[1]&&!arguments[1]&&(e.element.style.display="none"),$(".g3w-map-controls-left-bottom").append(e.element)},S.getMapControlByType=function(){var t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).type,e=this._mapControls.find(function(e){return t===e.type});return e&&e.control},S.addControl=function(e,t,r){var n=this,i=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],a=!(4<arguments.length&&void 0!==arguments[4])||arguments[4],o=(this.state.mapcontrolready=!1,this.viewer.map.addControl(r),r.on("toggled",function(e){return n.emit("mapcontrol:toggled",e)}),this._mapControls.push({id:e,type:t,control:r,visible:a,mapcontrol:i&&a}),r.on("controlclick",function(e){var e=e.target,t=e.isClickMap&&e.isClickMap()||!1;t&&n._externalInteractions.forEach(function(e){return e.setActive(!1)}),n.controlClick(e,{clickmap:t})}),$(r.element).find("button"));o.tooltip({placement:"bottom",trigger:b.default.isMobile()?"click":"hover"}),b.default.isMobile()&&o.on("shown.bs.tooltip",function(){var e=this;setTimeout(function(){return $(e).tooltip("hide")},600)}),i?this._addControlToMapControls(r,a):(o=$("#"+this.getMap().getTarget()),this._updateMapControlsLayout({width:o.width(),height:o.height()})),s.default.registerControl(t,r),this._setMapControlsInsideContainerLenght(),this.state.mapcontrolready=!0},S.showControl=function(e){this.showControls([e])},S.hideControl=function(e){this.hideControls([e])},S.showControls=function(e){this.toggleControls(!0,e)},S.hideControls=function(e){this.toggleControls(!1,e)},S.showAllControls=function(){this.toggleControls(!0)},S.hideAllControls=function(){this.toggleControls(!1)},S.toggleControls=function(t,r){this._removeControls(),this._mapControls.forEach(function(e){(!r||-1<r.indexOf(e.type))&&(e.visible=t)}),this._layoutControls()},S._layoutControls=function(){var t=this;this._mapControls.forEach(function(e){e.visible&&t.viewer.map.addControl(e.control)})},S.getMapControls=function(){return this._mapControls},S.removeControlById=function(r){var n=this;this._mapControls.find(function(e,t){if(r===e.id)return n._mapControls.splice(t,1),t=e.control,n.viewer.map.removeControl(t),t.hideControl&&t.hideControl(),!0})},S.removeControl=function(r){var n=this;this._mapControls.find(function(e,t){if(r===e.type)return n._mapControls.splice(t,1),t=e.control,n.viewer.map.removeControl(t),t.hideControl&&t.hideControl(),!0})},S._removeControls=function(){var t=this;this._mapControls.forEach(function(e){return t.viewer.map.removeControl(e.control)})},S._unToggleControls=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).close,t=void 0===e||e;this._mapControls.forEach(function(e){e.control.isToggled&&e.control.isToggled()&&(e.control.toggle(!1),t)&&b.default.closeContent()})},S.deactiveMapControls=function(){this._unToggleControls({close:!1})},S.disableClickMapControls=function(){var t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this._mapControls.forEach(function(e){e=e.control;!!e.isClickMap&&e.isClickMap()&&(e.isToggled()&&e.toggle(),e[t?"disable":"enable"]())})},S.addMapLayers=function(e){var t=this;e.reverse().forEach(function(e){return t.addMapLayer(e)})},S._setupCustomMapParamsToLegendUrl=function(){var e,t,r,n;0<arguments.length&&void 0!==arguments[0]&&!arguments[0]||(t=(e=this.getMap())&&e.getSize().filter(function(e){return 0<e})||null,r=t&&2===t.length?e.getView().calculateExtent(t):this.project.state.initextent,r="neu"===e.getView().getProjection().getAxisOrientation()?[r[1],r[0],r[3],r[2]]:r,n=this.getEpsg(),this.getMapLayers().forEach(function(e){e.setupCustomMapParamsToLegendUrl&&e.setupCustomMapParamsToLegendUrl({crs:n,bbox:r})}),this.emit("change-map-legend-params"))},S.addMapLayer=function(e){this._mapLayers.push(e),this.addLayerToMap(e)},S.getMapLayerByLayerId=function(t){return this.getMapLayers().find(function(e){return e.getLayerConfigs().find(function(e){return e.getId()===t})})},S.getMapLayers=function(){return this._mapLayers},S.getBaseLayers=function(){return this.mapBaseLayers},S.getMapLayerForLayer=function(e){var t="layer_"+e.getMultiLayerId();return this.getMapLayers().find(function(e){return e.getId()===t})},S.getProjectLayer=function(e){return p.default.getLayerById(e)},S._setSettings=function(){var e=y.MAP_SETTINGS.ZOOM,t=this.getScaleFromExtent(this.project.state.initextent);e.maxScale=e.maxScale>t?t:e.maxScale},S._resetView=function(){var e=this.viewer.map.getSize(),e=l(e,2),t=e[0],e=e[1],r=this.project.state.extent,t=ol.extent.getWidth(r)/t,e=ol.extent.getHeight(r)/e,t=Math.max(t,e)>this.viewer.map.getView().getMaxResolution()?Math.max(t,e):this.viewer.map.getView().getMaxResolution(),e=new ol.View({extent:r,projection:this.viewer.map.getView().getProjection(),center:this.viewer.map.getView().getCenter(),resolution:this.viewer.map.getView().getResolution(),maxResolution:t});this._setSettings(),this.viewer.map.setView(e)},S._calculateViewOptions=function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.project,n=e.width,e=e.height,i=new URLSearchParams(location.search),a=i.get("map_extent"),o=i.get("zoom_to_fid"),s=i.get("ztf"),l=i.get("lat")&&i.get("lon")&&{lat:+i.get("lat"),lon:+i.get("lon")},u=i.get("x")&&i.get("y")&&{x:+i.get("x"),y:+i.get("y")},i=(o?this.zoomToFid(o):s?this.handleZoomToFeaturesUrlParameter({zoom_to_features:s}):!l||Number.isNaN(l.lat)||Number.isNaN(l.lon)?!u||Number.isNaN(u.x)||Number.isNaN(u.y)||setTimeout(function(){var e=new ol.geom.Point([u.x,u.y]);t.zoomToGeometry(e)}):setTimeout(function(){var e=new ol.geom.Point(ol.proj.transform([l.lon,l.lat],"EPSG:4326",t.getEpsg()));e.getExtent()&&t.zoomToGeometry(e)}),a?a.split(",").map(function(e){return+e}):r.state.initextent),o=this.getProjection(),s=r.state.extent,a=ol.extent.getWidth(s)/n,r=ol.extent.getHeight(s)/e,a=Math.max(a,r),r=ol.extent.getWidth(i)/n,n=ol.extent.getHeight(i)/e,e=Math.max(r,n);return{projection:o,center:ol.extent.getCenter(i),extent:s,maxResolution:a,resolution:e}},S._setupViewer=function(e,t){var n=this;this.viewer=I.createViewer({id:this.target,view:this._calculateViewOptions({width:e,height:t,project:this.project})}),this._setSettings(),this.state.size=this.viewer.map.getSize(),this.state.mapUnits=this.viewer.map.getView().getProjection().getUnits(),this.config.background_color&&$("#"+this.target).css("background-color",this.config.background_color),$(this.viewer.map.getViewport()).prepend('<div id="map-spinner" style="position:absolute; top: 50%; right: 50%"></div>'),this.viewer.map.getInteractions().forEach(function(e){return n._watchInteraction(e)}),this.viewer.map.getInteractions().on("add",function(e){return n._watchInteraction(e.element)}),this.viewer.map.getInteractions().on("remove",function(e){}),this._marker=new ol.Overlay({position:null,positioning:"center-center",element:document.getElementById("marker"),stopEvent:!1}),this.viewer.map.addOverlay(this._marker),this.viewer.map.getLayers().on("add",function(e){var e=e.element,t=e.get("basemap"),r=e.get("position"),r=r&&"bottom"===r?0:t&&0,r=n.setLayerZIndex({layer:e,zindex:r});n.moveDefaultLayersOnTop(r)}),this.viewer.map.getLayers().on("remove",function(e){e.element.getZIndex()===n.layersCount&&--n.layersCount})},S.getMapUnits=function(){return this.state.mapUnits},S._removeListeners=function(){this._setBaseLayerListenerKey&&this.project.un("setBaseLayer",this._setBaseLayerListenerKey)},S._removeEventsKeysToLayersStore=function(r){var e=r.getId();this._layersStoresEventKeys[e]&&(this._layersStoresEventKeys[e].forEach(function(e){Object.entries(e).forEach(function(e){var e=l(e,2),t=e[0],e=e[1];return r.un(t,e)})}),delete this._layersStoresEventKeys[e])},S._setUpEventsKeysToLayersStore=function(e){var t=this,r=e.getId();this._layersStoresEventKeys[r]=[],this._layersStoresEventKeys[r].push({addLayer:e.onafter("addLayer",function(e){"vector"===e.getType()&&t.addLayerToMap(e.getMapLayer())})}),this._layersStoresEventKeys[r].push({removeLayer:e.onafter("removeLayer",function(e){"vector"===e.getType()&&t.viewer.map.removeLayer(e.getOLLayer())})})},S._setupListeners=function(){var e=this;this._setBaseLayerListenerKey=this.project.onafter("setBaseLayer",function(){e.updateMapLayers()})},S._setupAllLayers=function(){this._setupBaseLayers(),this._setupMapLayers(),this._setupVectorLayers(),this._setUpDefaultLayers()},S._setupBaseLayers=function(){var r=this,e=E({BASELAYER:!0});e.length&&(e.forEach(function(e){var t=e.getMapLayer();r.registerMapLayerListeners(t),r.mapBaseLayers[e.getId()]=t}),Object.values(this.mapBaseLayers).reverse().forEach(function(e){e.update(r.state,r.layersExtraParams),r.addLayerToMap(e)}))},S._setupMapLayers=function(){var i=this,e=E({BASELAYER:!1,VECTORLAYER:!1}),r=(this._setMapProjectionToLayers(e),{}),e=_.groupBy(e,function(e){var t=e.getMultiLayerId();return t=e.isQtimeseries()?(r[t]=void 0===r[t]?0:r[t]+1,t+"_"+r[t]):void 0===r[t]?t:t+"_"+(r[t]+1)}),r=null,a=[];return Object.entries(e).forEach(function(e){var e=l(e,2),t=e[0],e=e[1],t="layer_"+t,r=void 0,n=e[0]||[];1===e.length?(r=n.getMapLayer({id:t,projection:i.getProjection(),format:n.getSource()&&n.getSource().format},{})).addLayer(n):(r=n.getMapLayer({id:t,projection:i.getProjection()},i.layersExtraParams),e.reverse().forEach(function(e){return r.addLayer(e)})),a.push(r),i.registerMapLayerListeners(r)}),this.addMapLayers(a),this.updateMapLayers(),a},S._setupVectorLayers=function(){var t=this,e=E({VECTORLAYER:!0});this._setMapProjectionToLayers(e),e.forEach(function(e){e=e.getMapLayer();t.addLayerToMap(e)})},S._setUpDefaultLayers=function(){this.getMap().addLayer(this.defaultsLayers.highlightLayer),this.getMap().addLayer(this.defaultsLayers.selectionLayer)},S.moveDefaultLayersOnTop=function(e){this.setZIndexLayer({layer:this.defaultsLayers.highlightLayer,zindex:e+1}),this.setZIndexLayer({layer:this.defaultsLayers.selectionLayer,zindex:e+2})},S.removeDefaultLayers=function(){this.defaultsLayers.highlightLayer.getSource().clear(),this.defaultsLayers.selectionLayer.getSource().clear(),this.getMap().removeLayer(this.defaultsLayers.highlightLayer),this.getMap().removeLayer(this.defaultsLayers.selectionLayer)},S.setDefaultLayerStyle=function(e){e&&this.defaultsLayers[e]&&(this.defaultsLayers._style[e]=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{})},S.resetDefaultLayerStyle=function(e){e&&this.defaultsLayers[e]&&(this.defaultsLayers._style[e]={color:"highlightLayer"===e?void 0:"red"})},S.removeLayers=function(){this._removeBaseLayers(),this._removeMapLayers(),this.removeExternalLayers(),this.removeDefaultLayers()},S.removeAllLayers=function(){this.viewer.removeLayers()},S.setLayerZIndex=function(e){var t=e.layer,e=e.zindex,e=void 0===e?this.layersCount+=1:e;return t.setZIndex(e),e},S.addLayerToMap=function(e){e=e.getOLLayer();e&&this.getMap().addLayer(e)},S._setMapProjectionToLayers=function(e){var t=this;e.forEach(function(e){return e.setMapProjection(t.getProjection())})},S.createMapLayer=function(e){e.setMapProjection(this.getProjection());var t="layer_"+e.getMultiLayerId(),t=e.getMapLayer({id:t,projection:this.getProjection()},this.layersExtraParams);return t.addLayer(e),t},S.getOverviewMapLayers=function(i){var a=t("core/layers/map/wmslayer"),e=i.getLayersStore().getLayers({GEOLAYER:!0,BASELAYER:!1}),e=_.groupBy(e,function(e){return e.getMultiLayerId()}),o=[];return Object.entries(e).forEach(function(e){var e=l(e,2),t=e[0],e=e[1],t="overview_layer_"+t,r=e[0].state.tiled,t={url:i.getWmsUrl(),id:t,tiled:r},n=new a(t);e.reverse().forEach(function(e){return n.addLayer(e)}),o.push(n.getOLLayer(!0))}),o.reverse()},S.updateMapLayer=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{force:!1},r=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).showSpinner,r=void 0===r||r;return t.force&&(t.g3w_time=Date.now()),r!==e.showSpinnerWhenLoading&&this[(e.showSpinnerWhenLoading=r)?"registerMapLayerLoadingEvents":"unregisterMapLayerLoadingEvents"](e),e.update(this.state,t),e},S.updateMapLayers=function(){var t=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=(this.getMapLayers().forEach(function(e){return t.updateMapLayer(e,r)}),this.getBaseLayers());Object.values(e).forEach(function(e){return e.update(t.state,t.layersExtraParams)})},S.registerMapLayerListeners=function(t){var r=this,e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];this.registerMapLayerLoadingEvents(t),e&&t.layers&&Array.isArray(t.layers)&&t.layers.forEach(function(e){e.onbefore("change",function(){return r.updateMapLayer(t,{force:!0})}),e.on("filtertokenchange",function(){return r.updateMapLayer(t,{force:!0})})})},S.registerMapLayerLoadingEvents=function(e){e.on("loadstart",this._incrementLoaders),e.on("loadend",this._decrementLoaders),e.on("loaderror",this._mapLayerLoadError)},S.unregisterMapLayerLoadingEvents=function(e){e.off("loadstart",this._incrementLoaders),e.off("loadend",this._decrementLoaders),e.off("loaderror",this._mapLayerLoadError)},S.unregisterMapLayerListeners=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this.unregisterMapLayerLoadingEvents(e),t&&e.layers&&Array.isArray(e.layers)&&e.layers.forEach(function(e){e.un("change"),e.removeEvent("filtertokenchange")})},S.setTarget=function(e){this.target=e},S.getCurrentToggledMapControl=function(){var e=this._mapControls.find(function(e){e=e.control;return e&&e.isToggled&&e.isToggled()});return e&&e.control},S.addInteraction=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{active:!0,close:!0},r=t.active,r=void 0===r||r,n=this.getCurrentToggledMapControl(),i=n&&n.isToggled&&n.isToggled()||!1;return(!n||!n.isClickMap||n.isClickMap())&&r&&this._unToggleControls(t),this.getMap().addInteraction(e),e.setActive(r),this._externalInteractions.push(e),{control:n,toggled:i}},S.removeInteraction=function(t){t&&t.setActive(!1),this.viewer.map.removeInteraction(t),this._externalInteractions=this._externalInteractions.filter(function(e){return t!==e})},S._watchInteraction=function(e){var t=this;e.on("change:active",function(e){e.target instanceof ol.interaction.Pointer&&e.target.getActive()&&t.emit("mapcontrol:active",e.target)})},S.showMapInfo=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.info,e=e.style;this.state.map_info.info=t,this.state.map_info.style=e||this.state.map_info.style},S.hideMapInfo=function(){this.state.map_info.info=null,this.state.map_info.style=null},S.zoomTo=function(e){this.viewer.zoomTo(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:6)},S.goTo=function(e,t){this.viewer.goTo(e,{zoom:t||6})},S.goToRes=function(e,t){this.viewer.goToRes(e,{resolution:t})},S.getGeometryAndExtentFromFeatures=function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=void 0,r=void 0,n=void 0,i=void 0,a=[],o=0;o<e.length;o++){var s,l=e[o],u=l.getGeometry?l.getGeometry():l.geometry;u&&(u instanceof ol.geom.Geometry?(s=[].concat(h(u.getExtent())),t=t?ol.extent.extend(t,s):s,r=r||u.getType(),i=u.getCoordinates(),r.includes("Multi")?a=[].concat(h(a),h(i)):a.push(i)):(s=l.bbox,t=t?ol.extent.extend(t,s):s,r=u.type,i=u.coordinates),r.includes("Multi")?a=[].concat(h(a),h(i)):a.push(i))}try{var c=r.includes("Multi")?r:"Multi"+r,n=new ol.geom[c](a);void 0===t&&(t=n.getExtent())}catch(e){}return{extent:t,geometry:n}},S.highlightFeatures=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=this.getGeometryAndExtentFromFeatures(e).geometry;t.zoom=!1,this.highlightGeometry(r,t)},S.zoomToGeometry=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{highlight:!1},r=e&&e.getExtent();t.highlight&&r&&(t.highLightGeometry=e),r&&this.zoomToExtent(r,t)},S.zoomToFeatures=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{highlight:!1},r=this.getGeometryAndExtentFromFeatures(e),n=r.geometry,r=r.extent;return t.highlight&&r&&(t.highLightGeometry=n),r&&this.zoomToExtent(r,t)||Promise.resolve()},S.zoomToExtent=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return this.goToRes(ol.extent.getCenter(e),this.getResolutionForZoomToExtent(e,{force:t.force||!1})),t.highLightGeometry?this.highlightGeometry(t.highLightGeometry,{zoom:!1,duration:t.duration}):Promise.resolve()},S.zoomToProjectInitExtent=function(){this.zoomToExtent(this.project.state.initextent)},S.compareExtentWithProjectMaxExtent=function(e){var t=this.project.state.extent;return ol.extent.containsExtent(t,e)?e:t},S.getResolutionForZoomToExtent=function(e){var t,r,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{force:!1},i=this.getMap();return!1===ol.extent.containsExtent(this.project.state.extent,e)?i.getView().getResolutionForExtent(this.project.state.extent,i.getSize()):(t=i.getView().getResolutionForExtent(e,i.getSize()),!0===n.force?t:(n=void 0,(i=i.getView().getResolution())<(n=(r=G(y.MAP_SETTINGS.ZOOM.maxScale,this.getMapUnits()))<t?t:r)&&t<i?i:n))},S.goToBBox=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.getEpsg();e=t===this.getEpsg()?e:ol.proj.transformExtent(e,t,this.getEpsg()),this.viewer.fit(this.compareExtentWithProjectMaxExtent(e))},S.goToWGS84=function(e,t){e=ol.proj.transform(e,"EPSG:4326",this.project.state.crs.epsg),this.goTo(e,t)},S.extentToWGS84=function(e){return ol.proj.transformExtent(e,this.project.state.crs.epsg,"EPSG:4326")},!(S.getResolutionForMeters=function(e){var t=this.viewer.map.getViewport();return e/Math.max(t.clientWidth,t.clientHeight)}));S.setSelectionFeatures=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"add",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=t.feature,t=t.color,n=(t&&this.setDefaultLayerStyle("selectionLayer",{color:t}),this.defaultsLayers.selectionLayer.getSource());switch(e){case"add":n.addFeature(r);break;case"remove":n.removeFeature(r);break;case"update":var i=r.getId();n.getFeatureById(i).setGeometry(r.getGeometry());break;case"clear":n.clear()}},S.clearSelectionFeatures=function(){this.defaultsLayers.selectionLayer.getSource().clear()},S.seSelectionLayerVisible=function(){this.defaultsLayers.selectionLayer.setVisible(!(0<arguments.length&&void 0!==arguments[0])||arguments[0])},S.highlightGeometry=function(d){var p=this,f=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(e,t){function r(e){var t=[],e=e.getGeometry().getType(),e=k({geometryType:e,color:i,fill:!1});return t.push(e),t}var n,i=f.color,a=(p.clearHighlightGeometry(),p.setDefaultLayerStyle("highlightLayer",{color:i}),"boolean"!=typeof f.zoom||f.zoom),o=(o=f.hide)&&("function"==typeof o?o:null),s=f.style,l=y.MAP_SETTINGS.ANIMATION,u="boolean"!=typeof f.highlight||f.highlight,l=f.duration||l.duration,c=void 0;c=d instanceof ol.geom.Geometry?d:(new ol.format.GeoJSON).readGeometry(d),a&&(a=c.getExtent(),p.zoomToExtent(a)),u?(a=new ol.Feature({geometry:c}),n=p.defaultsLayers.highlightLayer,s&&n.setStyle(s),n.getSource().addFeature(a),o?o(function(){n.getSource().clear(),s&&n.setStyle(r),e()}):l&&l!==1/0&&(j=!0,setTimeout(function(){n.getSource().clear(),s&&n.setStyle(r),j=!1,e()},l))):e()})},S.clearHighlightGeometry=function(){j||this.defaultsLayers.highlightLayer.getSource().clear(),this.resetDefaultLayerStyle("highlightLayer")},S.refreshMap=function(){this.updateMapLayers(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{force:!0})},S.layout=function(e){var t=e.width,e=e.height,r=t<=0||e<=0;this.viewer?r||(this.getMap().updateSize(),this.state.hidemaps.forEach(function(e){return e.map.updateSize()}),this._updateMapView()):(this.setupViewer(t,e),this.viewer&&(this.setupControls(),this.emit("ready"))),this.setHidden(r),this._mapControls.length&&this._updateMapControlsLayout({width:t,height:e})},S._removeBaseLayers=function(){var t=this;Object.keys(this.mapBaseLayers).forEach(function(e){t.viewer.map.removeLayer(t.mapBaseLayers[e].getOLLayer())})},S._removeMapLayers=function(){var t=this;this.getMapLayers().forEach(function(e){t.unregisterMapLayerListeners(e),t.viewer.map.removeLayer(e.getOLLayer())}),this._mapLayers=[]},S.getMapBBOX=function(){return this.viewer.getBBOX()},S._updateMapView=function(){var e=this.viewer.getBBOX(),t=this.viewer.getResolution(),r=this.viewer.getCenter(),n=this.getMap().getSize();this.updateMapView(e,t,r,n)},S.getMapSize=function(){return this.viewer.map.getSize()},S.setInnerGreyCoverScale=function(e){this._drawShadow.scale=e},S._resetDrawShadowInner=function(){this._drawShadow={type:"coordinate",outer:[],inner:[],scale:null,rotation:null}},S.setInnerGreyCoverBBox=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=this.viewer.map,r=e.type||"coordinate",n=e.inner||null,i=e.rotation,e=e.scale,a=void 0,o=void 0;if(n){switch(r){case"coordinate":a=t.getPixelFromCoordinate([n[0],n[1]]),o=t.getPixelFromCoordinate([n[2],n[3]]);break;case"pixel":a=[n[0],n[1]],o=[n[2],n[3]]}var r=a[1]*ol.has.DEVICE_PIXEL_RATIO,s=a[0]*ol.has.DEVICE_PIXEL_RATIO,l=o[1]*ol.has.DEVICE_PIXEL_RATIO,u=o[0]*ol.has.DEVICE_PIXEL_RATIO;this._drawShadow.inner[0]=s,this._drawShadow.inner[1]=r,this._drawShadow.inner[2]=u,this._drawShadow.inner[3]=l}_.isNil(e)?this._drawShadow.scale=this._drawShadow.scale||1:this._drawShadow.scale=e,_.isNil(i)?this._drawShadow.rotation=this._drawShadow.rotation||0:this._drawShadow.rotation=i,this._drawShadow.outer&&t.render()},S.startDrawGreyCover=function(o){var s=this,e=this.viewer.map,l=void 0,u=void 0,c=void 0,d=void 0,p=void 0;this.stopDrawGreyCover();this._greyListenerKey=e.on("postcompose",function(e){var t=e.context,e=s.getMap().getSize(),r=e[1]*ol.has.DEVICE_PIXEL_RATIO,n=e[0]*ol.has.DEVICE_PIXEL_RATIO;if(s._drawShadow.outer=[0,0,n,r],t.restore(),t.beginPath(),t.moveTo(0,0),t.lineTo(n,0),t.lineTo(n,r),t.lineTo(0,r),t.lineTo(0,0),t.closePath(),s._drawShadow.inner.length&&(t.save(),l=s._drawShadow.inner[0],c=s._drawShadow.inner[3],u=s._drawShadow.inner[2],d=s._drawShadow.inner[1],p=s._drawShadow.rotation,s._drawShadow.scale,t.translate((u+l)/2,(d+c)/2),t.rotate(p*Math.PI/180),t.moveTo(-(u-l)/2,(d-c)/2),t.lineTo((u-l)/2,(d-c)/2),t.lineTo((u-l)/2,-(d-c)/2),t.lineTo(-(u-l)/2,-(d-c)/2),t.lineTo(-(u-l)/2,(d-c)/2),t.closePath()),t.fillStyle="rgba(0, 5, 25, 0.40)",t.fill(),o){t.font="bold 25px Arial",t.fillStyle="#ffffff",t.textAlign="center";for(var i=o.split("\n"),a=0;a<i.length;a++)t.fillText(i[a],n/2,r/2+30*a)}t.restore()})},S.stopDrawGreyCover=function(){var e=this.getMap();this._greyListenerKey&&(ol.Observable.unByKey(this._greyListenerKey),this._greyListenerKey=null,this._drawShadow.inner.length)&&this._resetDrawShadowInner(),e.render()},S.removeExternalLayers=function(){var t=this;this._externalLayers.forEach(function(e){t.removeExternalLayer(e.get("name"))}),this._externalLayers=[]},S.changeLayerVisibility=function(e){var t=e.id,e=(e.external,e.visible),r=this.getLayerById(t);r&&(r.setVisible(e),this.emit("change-layer-visibility",{id:t,visible:e}))},S.changeLayerOpacity=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,e=e.opacity,e=void 0===e?1:e,r=this.getLayerById(t);r&&r.setOpacity(e),this.emit("change-layer-opacity",{id:t,opacity:e})},S.changeLayerMapPosition=function(e){var t=e.id,e=e.position,e=void 0===e?y.MAP_SETTINGS.LAYER_POSITIONS.default:e,r=this.getLayerById(t);switch(e){case"top":r.setZIndex(this.layersCount);break;case"bottom":r.setZIndex(0)}this.emit("change-layer-position-map",{id:t,position:e})},S.removeExternalLayer=function(e){var r=this,n=this.getLayerByName(e),t=(b.default.getService("queryresults").unregisterVectorLayer(n),this.viewer.map.removeLayer(n),n._type||"vector");b.default.getService("catalog").removeExternalLayer({name:e,type:t}),"wms"==t&&(this._externalMapLayers=this._externalMapLayers.filter(function(e){var t=e.getId()===n.id;return t&&r.unregisterMapLayerListeners(e,n.projectLayer),!t})),this._externalLayers=this._externalLayers.filter(function(e){return e.get("id")!==n.get("id")}),this.unloadExternalLayer(n),this.emit("remove-external-layer",e)},S.addExternalWMSLayer=function(){var i=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=e.url,o=e.layers,s=e.name,t=e.epsg,t=void 0===t?this.getEpsg():t,r=e.position,l=void 0===r?y.MAP_SETTINGS.LAYER_POSITIONS.default:r,u=e.opacity,r=e.visible,c=void 0===r||r,d=ol.proj.get(t);return new Promise(function(e,t){var r=C({name:s,url:a,layers:o,projection:d}),n=r.wmslayer,r=r.olLayer;n.once("loadend",function(){e(n)}),n.once("loaderror",function(e){t(e)}),i.addExternalLayer(r,{position:l,opacity:u,visible:c}),i.addExternalMapLayer(n,!1)})},S.getExternalLayers=function(){return this._externalLayers},S.addExternalMapLayer=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this._externalMapLayers.push(e),this.registerMapLayerListeners(e,t)},S.addExternalLayer=(R=n(regeneratorRuntime.mark(function e(a){var t,r,n,i,o,s,l,u,c,d,p,f,h,g,v=this,m=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=o=i=n=r=t=void 0,g=m.position,l=void 0===g?y.MAP_SETTINGS.LAYER_POSITIONS.default:g,g=m.opacity,u=void 0===g?1:g,g=m.visible,c=void 0===g||g,d=this.viewer.map,p=b.default.getService("catalog"),f=b.default.getService("queryresults"),a instanceof ol.layer.Vector){(g=void 0)===a.get("id")&&a.set("id",w()),(t=a).filter={active:!1},t.selection={active:!1,features:[]};try{h=a.getStyle(),g=h._g3w_options?h._g3w_options.color:"blue"}catch(e){g="blue"}r=t.get("name")||t.get("id"),o="vector",a={id:a.get("id"),name:r,projectLayer:!1,title:r,removable:!0,external:!0,crs:m.crs,type:m.type,_type:o,download:m.download||!1,downloadUrl:m.downloadUrl,visible:c,checked:!0,position:l,opacity:u,color:g,filter:t.filter,selection:t.selection,tochighlightable:!1}}else a instanceof ol.layer.Image?(o="wms",r=a.get("name"),a.id=a.get("id"),a.removable=!0,a.projectLayer=!1,a.name=r,a.title=r,a._type=o,a.opacity=u,a.position=l,a.external=!0,a.checked=c):(r=a.name,o=a.type,s=a.crs,n=a.data,a.color);g=function(e,t){var r,n,i;return e?(r=void 0,"vector"===t&&((n=e.getSource().getFeatures()).length&&(i=0,n.forEach(function(e){e.setId(i++)}),a.geometryType=n[0].getGeometry().getType(),a.selected=!1),r=e.getSource().getExtent(),a.bbox={minx:r[0],miny:r[1],maxx:r[2],maxy:r[3]}),e.set("position",l),e.setOpacity(u),e.setVisible(c),d.addLayer(e),v._externalLayers.push(e),f.registerVectorLayer(e),p.addExternalLayer({layer:a,type:t}),r&&d.getView().fit(r),v.loadExternalLayer(e),Promise.resolve(e)):Promise.reject()},this.getLayerByName(r)?e.next=20:(e.t0=o,e.next="vector"===e.t0?12:"wms"===e.t0?13:14);break;case 12:return e.abrupt("return",g(t,o));case 13:return e.abrupt("return",g(a,o));case 14:return e.next=16,L({name:r,type:o,crs:s,mapCrs:mapCrs,data:n,style:i});case 16:return t=e.sent,e.abrupt("return",g(t));case 18:e.next=21;break;case 20:b.default.notify.warning("layer_is_added",!1);case 21:case"end":return e.stop()}},e,this)})),function(e){return R.apply(this,arguments)}),S.setExternalLayerStyle=function(e,t){e="rgba("+(e=e.rgba).r+","+e.g+","+e.b+","+e.a+")";var n={Point:new ol.style.Style({image:new ol.style.Circle({fill:new ol.style.Fill({color:e}),radius:5,stroke:new ol.style.Stroke({color:e,width:1})})}),LineString:new ol.style.Style({stroke:new ol.style.Stroke({color:e,width:3})}),Polygon:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255,255,255,0.5)"}),stroke:new ol.style.Stroke({color:e,width:3})}),MultiPoint:new ol.style.Style({image:new ol.style.Circle({fill:new ol.style.Fill({color:e}),radius:5,stroke:new ol.style.Stroke({color:e,width:1})})}),MultiLineString:new ol.style.Style({stroke:new ol.style.Stroke({color:e,width:3})}),MultiPolygon:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255,255,255,0.5)"}),stroke:new ol.style.Stroke({color:e,width:3})})};return function(e,t){var r=e.getStyleFunction();return r?r.call(e,t):n[e.getGeometry().getType()]}},S._handlePrint=(A=n(regeneratorRuntime.mark(function e(t){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.default.setDownload(!0),e.prev=1,e.next=4,this.createMapImage();case 4:n=e.sent,"screenshot"!==t?e.next=9:(saveAs(n,"map_"+Date.now()+".png"),e.next=15);break;case 9:return e.t0=saveAs,e.next=12,M({url:"/"+this.project.getType()+"/api/asgeotiff/"+this.project.getId()+"/",method:"POST",params:{image:n,csrfmiddlewaretoken:this.getCookie("csrftoken"),bbox:this.getMapBBOX().toString()}});case 12:e.t1=e.sent,e.t2="map_"+Date.now()+".tif",(0,e.t0)(e.t1,e.t2);case 15:e.next=20;break;case 17:e.prev=17,e.t3=e.catch(1),b.default.showUserMessage({type:"SecurityError"===e.t3.name?"warning":"alert",message:"SecurityError"===e.t3.name?"mapcontrols.screenshot.securityError":"mapcontrols.screenshot.error",autoclose:!1});case 20:return i.default.setDownload(!1,r),e.abrupt("return",!0);case 22:case"end":return e.stop()}},e,this,[[1,17]])})),function(e){return A.apply(this,arguments)}),e.exports=O},{"app/constant":4,"core/g3wobject":12,"core/i18n/i18n.service":13,"core/layers/map/wmslayer":45,"core/layers/providers/wfsprovider":53,"core/layers/vectorlayer":57,"core/utils/geo":64,"core/utils/ol":66,"core/utils/utils":68,"g3w-ol/g3w.ol":100,"gui/map/control/factory":156,"gui/wms/vue/wms":192,"services/application":351,"services/data":358,"services/gui":361,"store/map-controls":376,"store/map-layers":377,"store/projects":379}],158:[function(e,t,r){var n=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/Map.vue"));var i=e("core/utils/utils"),a=i.base,o=i.merge,i=i.inherit,s=e("gui/component/component"),l=e("gui/map/mapservice"),u=Vue.extend(n);function c(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(a(this,e),this.id="map-component",this.title="Map Component",e.target||"map"),r=e.maps_container||"g3w-maps",n=(e.target=t,e.maps_container=r,new l(e));this.setService(n),o(this,e),this.internalComponent=new u({service:n,target:t,maps_container:r}),n.getCookie=this.internalComponent.$cookie.get}Vue.component("g3w-map",n),i(c,s),c.prototype.layout=function(e,t){$("#"+this.target).height(t),$("#"+this.target).width(e),this._service.layout({width:e,height:t})},t.exports=c},{"components/Map.vue":254,"core/utils/utils":68,"gui/component/component":117,"gui/map/mapservice":157}],159:[function(e,t,r){var a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=i(e("store/projects")),n=i(e("services/gui"));function i(e){return e&&e.__esModule?e:{default:e}}var s=e("core/utils/utils").inherit,l=e("core/g3wobject"),u=e("gui/metadata/vue/components/project/project"),c={general:["title","name","description","abstract","keywords","fees","accessconstraints","contactinformation","wms_url"],spatial:["crs","extent"],layers:["layers"]};function d(){this.content=null,this.show=!1,this.state={name:"",groups:{}},this._buildProjectGroupMetadata()}s(d,l);e=d.prototype;e._buildProjectGroupMetadata=function(){var n=o.default.getCurrentProject().getState(),i=(this.state.name=n.title,{});Object.entries(c).forEach(function(e){var e=a(e,2),r=e[0],e=e[1];i[r]={},e.forEach(function(e){var t=(n.metadata&&n.metadata[e]?n.metadata:n)[e];t&&(i[r][e]={label:["sdk","metadata","groups",r,"fields",e].join("."),value:t})})}),this.state.groups=i},e.getProjectMetadata=function(){return this.state},e.getLayersMetadata=function(){return this.state.groups.layers},e.getLayerMetadata=function(t){return this.state.groups.layers.filter(function(e){return e.id===t})[0]},e.showMetadata=function(e){this.show=e,this.show?(this.content=new u({state:this.getProjectMetadata(),service:this}),n.default.setContent({content:this.content,title:"sdk.metadata.title",perc:100}),this.show=!0):n.default.closeContent()},e.reload=function(){this.emit("reload"),this._buildProjectGroupMetadata()},t.exports=d},{"core/g3wobject":12,"core/utils/utils":68,"gui/metadata/vue/components/project/project":160,"services/gui":361,"store/projects":379}],160:[function(e,t,r){var n=e("components/MetadataProject.vue"),i=(n=n)&&n.__esModule?n:{default:n};var n=e("core/utils/utils"),a=n.inherit,o=n.base;function s(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.state,t=void 0===t?{}:t,e=e.service,r=(o(this),Vue.extend(i.default));this.setService(e),this.internalComponent=new r({state:t}),this.layout=function(){}}a(s,e("gui/component/component")),t.exports=s},{"components/MetadataProject.vue":262,"core/utils/utils":68,"gui/component/component":117}],161:[function(e,t,r){var n=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/Metadata.vue")),i=e("services/gui"),a=(i=i)&&i.__esModule?i:{default:i};function o(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=(l(this,t),this.title="sdk.metadata.title",t.service||new u(t));this.setService(r),this._service.on("reload",function(){e.setOpen(!1)}),this.setInternalComponent=function(){return this.internalComponent=new c({service:r}),this.internalComponent.state=r.state,this.internalComponent},this._setOpen=function(e){this._service.showMetadata(e)},a.default.on("closecontent",function(){e.state.open=!1})}var i=e("core/utils/utils"),s=i.inherit,l=i.base,i=e("gui/component/component"),u=e("gui/metadata/metadataservice"),c=Vue.extend(n);s(o,i),t.exports=o},{"components/Metadata.vue":260,"core/utils/utils":68,"gui/component/component":117,"gui/metadata/metadataservice":159,"services/gui":361}],162:[function(e,t,r){var n=e("services/gui"),i=(n=n)&&n.__esModule?n:{default:n};function a(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.id=e.id||null,this.title=e.title||"",this.internalPanel=e.panel||null,this.service=e.service}var n=e("core/utils/utils"),o=n.inherit,s=n.resolve,n=(o(a,e("core/g3wobject")),a.prototype);n.getId=function(){return this.id},n.getTitle=function(){return this.title},n.getService=function(){return this.service},n.setService=function(e){this.service=e},n.getInternalPanel=function(){return this.internalPanel},n.setInternalPanel=function(e){this.internalPanel=e},n.show=function(){i.default.showPanel(this)},n.close=function(){i.default.closePanel()},n.mount=function(e){var t=this.internalPanel,r=t.$mount();return $(e).append(r.$el),r.$nextTick(function(){$(e).localize(),t.onShow&&t.onShow()}),s(!0)},n.unmount=function(){var e=this.internalPanel,t=$.Deferred();return e.$destroy(!0),$(e.$el).remove(),e.onClose&&e.onClose(),this.internalComponent=null,t.resolve(),t.promise()},n.onResize=function(e,t){},t.exports=a},{"core/g3wobject":12,"core/utils/utils":68,"services/gui":361}],163:[function(e,t,r){var i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},n=l(e("store/projects")),a=l(e("services/application")),o=e("app/constant"),s=l(e("services/gui"));function l(e){return e&&e.__esModule?e:{default:e}}function u(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var c=e("core/utils/utils"),d=c.base,p=c.inherit,f=c.downloadFile,h=e("core/i18n/i18n.service").t,c=e("core/g3wobject"),g=e("core/print/printservice"),v=e("core/utils/ol"),m=v.getScaleFromResolution,y=v.getResolutionFromScale,b=v.getMetersFromDegrees,w=e("gui/print/vue/printpage");function x(){d(this),this.printService=new g,this._initialized=!1,this.state={loading:!1},this._moveMapKeyEvent=null,this._page=null,this._mapService=null,this._map=null,this._mapUnits,this._scalesResolutions={},this.init=function(){this._project=n.default.getCurrentProject(),this.state.print=this._project.getPrint()||[],this.state.visible=0<this.state.print.length,this.state.isShow=!1,this.state.url=null,this.state.output={url:null,method:this._project.getOwsMethod(),layers:!0,format:null,loading:!1,type:null},this.state.printextent={minx:[0,0],miny:[0,0],maxx:[0,0],maxy:[0,0]},this.state.visible&&this.setInitState()}}p(x,c);v=x.prototype;v.setInitState=function(){this.state.template=this.state.print[0].name,this.state.atlas=this.state.print[0].atlas,this.state.atlasValues=[],this.state.rotation=0,this.state.inner=[0,0,0,0],this.state.center=null,this.state.size=null,this.state.scale=o.PRINT_SCALES,this.state.scala=null,this.state.dpis=o.PRINT_RESOLUTIONS,this.state.dpi=o.PRINT_RESOLUTIONS[0],this.state.formats=o.PRINT_FORMATS,this.state.output.format=o.PRINT_FORMATS[0].value,this.state.maps=this.state.print[0].maps,this.state.labels=this.state.print[0].labels},v.changeTemplate=function(){var e,t,r,n,i=this;this.state.template&&(e=this.state.atlas,t=(n=this.state.print.find(function(e){return e.name===i.state.template})).atlas,r=n.maps,n=n.labels,this.state.maps=r,this.state.atlas=t,this.state.labels=n,this.state.atlasValues=[],this.state.atlas?this._clearPrint():e?this.showPrintArea(!0):this._setPrintArea())},v.changeScale=function(){this.state.scala&&this._setPrintArea()},v.changeRotation=function(){this._mapService.setInnerGreyCoverBBox({rotation:this.state.rotation})},v._getPrintExtent=function(){var e=[].concat(u(this.state.printextent.lowerleft),u(this.state.printextent.upperright)),t=e[0],r=e[1],n=e[2],e=e[3];return(this._mapService.isAxisOrientationInverted()?[r,t,e,n]:[t,r,n,e]).join()},v.getOverviewExtent=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.xmin,r=e.xmax,n=e.ymin,e=e.ymax;return(this._mapService.isAxisOrientationInverted()?[n,t,e,r]:[t,n,r,e]).join()},v._getOptionsPrint=function(){var t=this,r=!1,e=this.state.maps.map(function(e){return r=r||void 0!==e.preset_theme,{name:e.name,preset_theme:e.preset_theme,scale:e.overview?e.scale:t.state.scala,extent:e.overview?t.getOverviewExtent(e.extent):t._getPrintExtent()}});return{rotation:this.state.rotation,dpi:this.state.dpi,template:this.state.template,maps:e,scale:this.state.scala,format:this.state.output.format,labels:this.state.labels,is_maps_preset_theme:r}},v.setPrintAreaAfterCloseContent=function(){this._map.once("postrender",this._setPrintArea.bind(this)),this.stopLoading()},v.print=function(){var i=this;return new Promise(function(t,r){var n,e;s.default.disableSideBar(!0),i.state.atlas?(n=a.default.setDownload(!0),i.state.loading=!0,i.printService.printAtlas({template:i.state.template,field:i.state.atlas.field_name||"$id",values:i.state.atlasValues,download:!0}).then(function(e){e=e.url;f({url:e,filename:i.state.template,mime_type:"application/pdf"}).then(function(){t()}).catch(function(e){i.showError(e),r()}).finally(function(){i.state.loading=!1,a.default.setDownload(!1,n),s.default.disableSideBar(!1)})})):(i.state.output.url=null,i.state.output.layers=!0,i._page=new w({service:i}),s.default.setContent({content:i._page,title:"print",perc:100}),e=i._getOptionsPrint(),i.printService.print(e,method=i.state.output.method).then(function(e){i.state.output.url=e.url,i.state.output.layers=e.layers,i.state.output.mime_type=e.mime_type,t()}).catch(function(e){i.showError(),r(e)}).finally(function(){i.state.output.layers||s.default.disableSideBar(!1)}))})},v.startLoading=function(){this.state.output.loading=!0},v.stopLoading=function(){this.state.output.loading=!1},v.showError=function(e){s.default.notify.error(e||h("info.server_error")),s.default.closeContent()},v._calculateInternalPrintExtent=function(){var e=this._map.getView().getResolution(),t=parseFloat(this.state.scala),r=this.state.maps.find(function(e){return!e.overview}),n=r.h,r=r.w,e="m"===this._mapService.getMapUnits()?e:b(e),r=r/1e3*t/e,n=n/1e3*t/e,t=[this.state.size[0]/2,this.state.size[1]/2],e=t[0]-r/2,i=t[1]-n/2,r=t[0]+r/2,t=t[1]+n/2;this.state.printextent.lowerleft=this._map.getCoordinateFromPixel([e,t])?this._map.getCoordinateFromPixel([e,t]):this.state.printextent.lowerleft,this.state.printextent.upperright=this._map.getCoordinateFromPixel([r,i])?this._map.getCoordinateFromPixel([r,i]):this.state.printextent.upperright,this.state.inner=[e,t,r,i]},v._setPrintArea=function(){this.state.size=this._map.getSize();var e=this._map.getView().getResolution();this.state.currentScala=m(e,this._mapUnits),this.state.center=this._map.getView().getCenter(),this._calculateInternalPrintExtent(),this._mapService.setInnerGreyCoverBBox({type:"pixel",inner:this.state.inner,rotation:this.state.rotation})},v._clearPrint=function(){ol.Observable.unByKey(this._moveMapKeyEvent),this._moveMapKeyEvent=null,this._mapService.stopDrawGreyCover()},v._setAllScalesBasedOnMaxResolution=function(e){function r(e){o.push(e),n=y(e.value,t._mapUnits),t._scalesResolutions[e.value]=n,n/=2}var t=this,n=e,i=m(n,this._mapUnits),a=_.orderBy(this.state.scale,["value"],["desc"]),o=[],s=!1;a.forEach(function(e,t){i>e.value&&(s||(t=a[t-1],r(t),s=!0),r(e))}),this.state.scale=o},v._setInitialScalaSelect=function(){this.state.scala=this.state.scale[0].value,$("#scala").val(this.state.scala)},v._setCurrentScala=function(r){var n=this;Object.entries(this._scalesResolutions).find(function(e){var e=i(e,2),t=e[0],e=e[1];if(r<=e)return n.state.scala=t,!0})},v._setMoveendMapEvent=function(){this._moveMapKeyEvent=this._map.on("moveend",this._setPrintArea.bind(this))},v._showPrintArea=function(){void 0===this.state.atlas&&(this._setPrintArea(),this._mapService.startDrawGreyCover())},v._initPrintConfig=function(){this._initialized||(e=this._map.getView().getMaxResolution(),this._setAllScalesBasedOnMaxResolution(e),this._initialized=!0);var e=this._map.getView().getResolution();this._setCurrentScala(e)},v.showPrintArea=function(t){var r=this;this.state.isShow=t,s.default.closeContent().then(function(e){setTimeout(function(){r._mapService=e.getService(),r._mapUnits=r._mapService.getMapUnits(),r._mapService.getMap().once("postrender",function(e){r._map=e.map,t?(r._setMoveendMapEvent(),r._initPrintConfig(),r._showPrintArea()):r._clearPrint()}),r._mapService.getMap().renderSync()})})},v.reload=function(){var t=this;this._project=n.default.getCurrentProject(),this._mapService=s.default.getService("map"),this._map=this._mapService.viewer.map,this.state.print=this._project.state.print||[],this.state.visible=0<this.state.print.length,this.state.visible?(this.state.template=this.state.print[0].name,this._initialized||this.init(),this._initPrintConfig(),this._mapService.on("changeviewaftercurrentproject",function(){var e=t._map.getView().getMaxResolution();t.state.scale=o.PRINT_SCALES,t._setAllScalesBasedOnMaxResolution(e)})):this._clearPrint()},t.exports=x},{"app/constant":4,"core/g3wobject":12,"core/i18n/i18n.service":13,"core/print/printservice":60,"core/utils/ol":66,"core/utils/utils":68,"gui/print/vue/printpage":165,"services/application":351,"services/gui":361,"store/projects":379}],164:[function(e,t,r){var n=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/Print.vue"));var i=e("core/utils/utils"),a=i.inherit,o=i.base,i=e("gui/component/component"),s=e("gui/print/printservice");function l(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(o(this,e),this.title="print",this.vueComponent=n,this.internalComponent=null,e.service||new s);this.setService(t),this._service.init(),this.setInternalComponent=function(){var e=Vue.extend(this.vueComponent);return this.internalComponent=new e({service:t}),this.state.visible=t.state.visible,this.internalComponent.state=t.state,this.internalComponent},this._reload=function(){var e=this.getService();e.reload(),this.state.visible=e.state.visible},this._setOpen=function(e){this._service.showPrintArea(e)}}a(l,i),t.exports=l},{"components/Print.vue":271,"core/utils/utils":68,"gui/component/component":117,"gui/print/printservice":163}],165:[function(e,t,r){var n=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/PrintPage.vue"));function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=(s(this),e.service),t=(this.setService(e),new l({service:e}));this.setInternalComponent(t),this.internalComponent.state=e.state.output,this.unmount=function(){return this.getService().setPrintAreaAfterCloseContent(),s(this,"unmount")}}var a=e("core/utils/utils"),o=a.inherit,s=a.base,a=e("gui/component/component"),l=Vue.extend(n);o(i,a),t.exports=i},{"components/PrintPage.vue":273,"core/utils/utils":68,"gui/component/component":117}],166:[function(e,t,r){var n=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/ProjectsMenu.vue"));var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=i.merge,i=e("gui/component/component"),l=Vue.extend(n);function u(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(a(this,e),this.title=e.title||"menu",this.state.visible=!0,this.state.menuitems=e.menuitems,e.host);s(this,e),this.internalComponent=new l({service:this,host:t}),this.internalComponent.state=this.state}o(u,i),u.prototype.trigger=function(e){},t.exports=u},{"components/ProjectsMenu.vue":275,"core/utils/utils":68,"gui/component/component":117}],167:[function(e,t,r){var n=a(e("store/projects")),i=a(e("services/application"));function a(e){return e&&e.__esModule?e:{default:e}}var o=e("core/utils/utils"),s=o.base;function l(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=(t.id="projectsmenu",s(this,t),this.state.menuitems=[],t.host),e=t.projects||n.default.getListableProjects();this.state.menuitems=e.map(function(e){return{title:e.title,description:e.description,thumbnail:e.thumbnail,gid:e.gid,cbk:t.cbk||function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).gid;return i.default.changeProject({gid:e,host:r})}}})}(0,o.inherit)(l,e("gui/projectsmenu/menu")),t.exports=l},{"core/utils/utils":68,"gui/projectsmenu/menu":166,"services/application":351,"store/projects":379}],168:[function(e,t,r){var n=e("gui/querybuilder/vue/querybuilder"),i=e("gui/querybuilder/vue/panel/querybuilderpanel");t.exports={type:null,show:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.type,e=e.options,r=void 0;return this.type=null===this.type?void 0===t?"sidebar":t:this.type,"modal"===this.type?(t=(r=new n({options:e})).$mount().$el,GUI.showModalDialog({title:"Query Builder",message:t,className:"modal-background-dark "})):(r=(t=new i({options:e})).getInternalPanel(),t.show()),r}}},{"gui/querybuilder/vue/panel/querybuilderpanel":169,"gui/querybuilder/vue/querybuilder":170}],169:[function(e,t,r){var n=e("core/utils/utils"),i=n.inherit,a=n.base,n=e("gui/panel"),o=e("gui/querybuilder/vue/querybuilder");function s(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=(e.title="Query Builder",a(this,e),new o(e));this.setInternalPanel(e)}i(s,n),t.exports=s},{"core/utils/utils":68,"gui/panel":162,"gui/querybuilder/vue/querybuilder":170}],170:[function(e,t,r){e=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/QueryBuilder.vue"));e=Vue.extend(e);t.exports=e},{"components/QueryBuilder.vue":276}],171:[function(e,t,N){var M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},h=n(e("services/gui")),g=e("constant"),r=n(e("store/projects")),s=n(e("services/data")),v=n(e("store/catalog-layers")),T=n(e("components/QueryResultsActionDownloadFormats.vue")),m=n(e("components/QueryResultsActionQueryPolygonCSVAttributes.vue")),y=n(e("services/application"));function n(e){return e&&e.__esModule?e:{default:e}}function I(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}function d(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function b(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var i=e("core/utils/utils"),a=i.base,o=i.inherit,l=i.noop,u=i.downloadFile,p=i.throttle,w=i.getUniqueDomId,f=i.copyUrl,i=e("core/utils/geo"),x=i.createFeatureFromFeatureObject,S=i.intersects,L=i.within,i=e("core/utils/geo"),D=i.getAlphanumericPropertiesFromFeature,G=i.createFeatureFromGeometry,V=i.createFeatureFromBBOX,U=i.createFeatureFromCoordinates,C=e("core/i18n/i18n.service").t,P=e("core/layers/layer"),i=e("core/g3wobject"),q=e("core/layers/vectorlayer"),B=e("core/print/printservice"),k=e("gui/relations/vue/relationspage"),z=e("g3w-ol/interactions/pickcoordinatesinteraction"),W=new Vue;function E(){var t=this,e=(this.printService=new B,this._currentLayerIds=[],r.default.onafter("setCurrentProject",function(e){t._project=e,t._setRelations(e),t._setAtlasActions(e),t.state.download_data=!1,t.plotLayerIds=[]}),this.unlistenerlayeractionevents=[],this._actions={zoomto:E.zoomToElement,highlightgeometry:this.highlightGeometry.bind(this),clearHighlightGeometry:this.clearHighlightGeometry.bind(this)},this._relations=[],this._atlas=[],this.plotLayerIds=[],this._project=r.default.getCurrentProject());this._projectLayerIds=this._project.getConfigLayers().map(function(e){return e.id}),this.state={zoomToResult:!0,components:[],layers:[],changed:!1,query:null,type:"ows",layersactions:{},actiontools:{},currentactiontools:{},currentactionfeaturelayer:{},layeractiontool:{},layersFeaturesBoxes:{},layerscustomcomponents:{}},this.init=function(){this.clearState()},this.resultsQueryLayer=new ol.layer.Vector({source:new ol.source.Vector,style:function(e){var t=new ol.style.Fill({color:"rgba(0, 0, 255, 0.7)"}),r=new ol.style.Stroke({color:"blue",width:3});return"Point"===e.getGeometry().getType()?new ol.style.Style({text:new ol.style.Text({text:"",font:'900 3em "Font Awesome 5 Free"',fill:t,stroke:r,offsetY:-15})}):new ol.style.Style({stroke:r})}}),this._vectorLayers=[],this._addFeaturesLayerResultInteraction={id:null,interaction:null,mapcontrol:null,toggleeventhandler:null},this.setters={setQueryResponse:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{add:!1};if(e.data||(e.data=[]),e.query||(e.query={external:{add:!1,filter:{SELECTED:!1}}}),e.query.external||(e.query.external={add:!1,filter:{SELECTED:!1}}),!t.add)switch(this.clearState(),this.state.query=e.query,this.state.type=e.type,!0===e.query.external.add&&this._addVectorLayersDataToQueryResponse(e),this.state.query.type){case"coordinates":this.showCoordinates(this.state.query.coordinates);break;case"bbox":this.showBBOX(this.state.query.bbox);break;case"polygon":this.state.query.geometry&&this.showGeometry(this.state.query.geometry)}this.setLayersData(this._digestFeaturesForLayers(e.data),t)},setLayersData:function(e){var t=this,r=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{add:!1}).add;r||(this._currentLayerIds=e.map(function(e){return e.id}),this._orderResponseByProjectLayers(e)),e.forEach(function(e){r?t.updateLayerResultFeatures(e):t.state.layers.push(e)}),this.setActionsForLayers(e,{add:r}),this.state.changed=!0},addComponent:function(e){this._addComponent(e)},addActionsForLayers:function(e,t){},postRender:function(e){},closeComponent:function(){},changeLayerResult:function(e){this._changeLayerResult(e)},activeMapInteraction:function(){},editFeature:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.layer,e.feature},openCloseFeatureResult:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.open,e.layer,e.feature,e.container}},a(this),this.addLayersPlotIds=function(){this.plotLayerIds=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]},this.getPlotIds=function(){return this.plotLayerIds},this.findPlotId=function(t){return this.plotLayerIds.find(function(e){return e==t})},this._setRelations(e),this._setAtlasActions(e),this._asyncFnc={todo:l,zoomToLayerFeaturesExtent:{async:!1},goToGeometry:{async:!1}},h.default.onbefore("setContent",function(e){e=e.perc;t.mapService=t.mapService||y.default.getApplicationService("map"),100===e&&h.default.isMobile()&&(t._asyncFnc.zoomToLayerFeaturesExtent.async=!0,t._asyncFnc.goToGeometry.async=!0)})}o(E,i);var F,O,R,A,j,e=E.prototype;e.registerCustomComponent=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,t=void 0===t?w():t,r=e.layerId,n=e.component,i=e.type,i=void 0===i?"feature":i,e=e.position,e=void 0===e?"after":e;return void 0===this.state.layerscustomcomponents[r]&&(this.state.layerscustomcomponents[r]={layer:{before:[],after:[]},feature:{before:[],after:[]}}),this.state.layerscustomcomponents[r][i][e].push({id:t,component:n}),t},e.unRegisterCustomComponent=function(e){var t=this,r=e.id,n=e.layerId,i=e.type,e=e.position;e?this.state.layerscustomcomponents[n][i][e]=this.state.layerscustomcomponents[n][i][e].filter(function(e){return e.id!==r}):Object.keys(this.state.layerscustomcomponents[n][i]).forEach(function(e){t.state.layerscustomcomponents[n][i][e]=t.state.layerscustomcomponents[n][i][e].filter(function(e){return e.id!==r})})},e.addFeatureLayerToResult=function(e,t){this.state.layersFeaturesBoxes[this.getBoxId(e,t)].collapsed=!0},e.removeFeatureLayerFromResult=function(e,t){var r=e.id,e=e.external;this.updateLayerResultFeatures({id:r,external:e,features:[t]})},e.downloadApplicationWrapper=(F=b(regeneratorRuntime.mark(function e(t){var r,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=y.default.setDownload(!0),h.default.setLoadingContent(!0),e.prev=2,e.next=5,t(n);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),h.default.showUserMessage({type:"alert",message:e.t0||"server_error",textMessage:!!e.t0});case 10:y.default.setDownload(!1,r),h.default.setLoadingContent(!1);case 12:case"end":return e.stop()}},e,this,[[2,7]])})),function(e){return F.apply(this,arguments)}),e.updateLayerResultFeatures=function(i){var a,o,s,l=this,e=i.features,u=void 0===e?[]:e,t=this.state.layers.find(function(e){return e.id===i.id});t&&u.length&&(a=t.external,o=[],s=u.map(function(e){return a?e.id:e.attributes[g.G3W_FID]}),t.features=t.features.filter(function(e){var t,r=s.indexOf(a?e.id:e.attributes[g.G3W_FID]),n=-1===r;return n?l.state.layersFeaturesBoxes[l.getBoxId(i,e)].collapsed=!0:(o.push(r),t=u[r],l.state.layersFeaturesBoxes[l.getBoxId(i,e)].collapsed=!0,setTimeout(function(){return delete l.state.layersFeaturesBoxes[l.getBoxId(i,t)]})),n}),(u=u.filter(function(e,t){return-1===o.indexOf(t)})).length&&(e=[].concat(d(t.features),d(u)),t.features=e),1===t.features.length&&this.state.layersFeaturesBoxes[this.getBoxId(t,t.features[0])]&&setTimeout(function(){return l.state.layersFeaturesBoxes[l.getBoxId(t,t.features[0])].collapsed=!1}),this.checkIfLayerHasNoFeatures(t)),1===this.state.layers.length&&this.highlightFeaturesPermanently(this.state.layers[0]),this.changeLayerResult(t)},e.addRemoveFeaturesToLayerResult=e.updateLayerResultFeatures,e._changeLayerResult=function(t){this.state.layersactions[t.id].forEach(function(e){return e.change&&e.change(t)}),this.resetCurrentActionToolsLayer(t)},e.checkIfLayerHasNoFeatures=function(t){var e=this;0===t.features.length&&setTimeout(function(){e.state.layers=e.state.layers.filter(function(e){return e.id!==t.id}),e.clearHighlightGeometry(t),e.removeAddFeaturesLayerResultInteraction({toggle:!0})})},e.getBoxId=function(e,t,r){return null!=r?e.id+"_"+t.id+"_"+r:e.id+"_"+t.id},e.setActionsForLayers=function(e){var u=this;(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{add:!1}).add||(this.unlistenerlayeractionevents=[],e.forEach(function(n){u.state.layeractiontool[n.id]=Vue.observable({component:null,config:null});var r,i,e,t,a={},o={},s=(n.features.forEach(function(e,t){o[t]=a[t]=null}),u.state.currentactiontools[n.id]=Vue.observable(a),u.state.currentactionfeaturelayer[n.id]=Vue.observable(o),n.external||!!n.source&&"wms"===n.source.type),l=(u.state.layersactions[n.id]||(u.state.layersactions[n.id]=[]),n.hasgeometry&&u.state.layersactions[n.id].push({id:"gotogeometry",download:!1,mouseover:!0,class:h.default.getFontClass("marker"),hint:"sdk.mapcontrols.query.actions.zoom_to_feature.hint",cbk:p(u.goToGeometry.bind(u))}),u._relations&&(l=u._relations[n.id]&&u._relations[n.id].filter(function(e){return"MANY"===e.type}))&&l.length&&(r=[],l.forEach(function(t){var e=u.plotLayerIds.find(function(e){return e===t.referencingLayer});e&&r.push(e)}),u.state.layersactions[n.id].push({id:"show-query-relations",download:!1,class:h.default.getFontClass("relation"),hint:"sdk.mapcontrols.query.actions.relations.hint",cbk:u.showQueryRelations,relations:l,chartRelationIds:r}),l=u.createActionState({layer:n}),r.length)&&u.state.layersactions[n.id].push({id:"show-plots-relations",download:!1,opened:!0,class:h.default.getFontClass("chart"),state:l,hint:"sdk.mapcontrols.query.actions.relations_charts.hint",cbk:p(u.showRelationsChart.bind(u,r))}),u.getAtlasByLayerId(n.id).length&&u.state.layersactions[n.id].push({id:"printatlas",download:!0,class:h.default.getFontClass("print"),hint:"sdk.tooltips.atlas",cbk:u.printAtlas.bind(u)}),u.createActionState({layer:n}));1===n.downloads.length?(t=c(n.downloads,1)[0],i=u.downloadFeatures.bind(u,t),n[t]=Vue.observable({active:!1}),u.state.layersactions[n.id].push({id:"download_"+t+"_feature",download:!0,state:l,class:h.default.getFontClass("download"),hint:"sdk.tooltips.download_"+t,cbk:function(e,t,r,n){r.state.toggled[n]=!r.state.toggled[n],r.state.toggled[n]?i(e,t,r,n):u.setCurrentActionLayerFeatureTool({index:n,action:r,layer:e})}})):1<n.downloads.length&&(t=T.default.name,e=[],n.downloads.forEach(function(i){e.push({id:"download_"+i+"_feature",download:!0,format:i,class:h.default.getFontClass(i),hint:"sdk.tooltips.download_"+i,cbk:function(e,t,r,n){u.downloadFeatures(i,e,t,r,n);r=u.state.layersactions[e.id].find(function(e){return"downloads"===e.id});"polygon"!==u.state.query.type&&r.cbk(e,t,r,n)}})}),u.state.actiontools[t]=u.state.actiontools[t]||{},u.state.actiontools[t][n.id]={downloads:e},u.state.layersactions[n.id].push({id:"downloads",download:!0,class:h.default.getFontClass("download"),state:l,toggleable:!0,hint:"Downloads",change:function(e){var r=this;e.features.forEach(function(e,t){void 0===r.state.toggled[t]?W.$set(r.state.toggled,t,!1):r.state.toggled[t]=!1})},cbk:function(e,t,r,n){r.state.toggled[n]=!r.state.toggled[n],u.setCurrentActionLayerFeatureTool({layer:e,index:n,action:r,component:r.state.toggled[n]?T.default:null})}})),s||u.state.layersactions[n.id].push({id:"removefeaturefromresult",download:!1,mouseover:!0,class:h.default.getFontClass("minus-square"),style:{color:"red"},hint:"sdk.mapcontrols.query.actions.remove_feature_from_results.hint",cbk:u.removeFeatureLayerFromResult.bind(u)}),void 0!==n.selection.active&&(t=u.createActionState({layer:n}),u.state.layersactions[n.id].push({id:"selection",download:!1,class:h.default.getFontClass("success"),hint:"sdk.mapcontrols.query.actions.add_selection.hint",state:t,init:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.feature,r=e.index,e=e.action;void 0!==n.selection.active&&u.checkFeatureSelection({layer:n,index:r,feature:t,action:e})},cbk:p(u.addToSelection.bind(u))}),u.listenClearSelection(n,"selection")),!s&&n.hasgeometry&&u.state.layersactions[n.id].push({id:"link_zoom_to_fid",download:!1,class:h.default.getFontClass("link"),hint:"sdk.mapcontrols.query.actions.copy_zoom_to_fid_url.hint",hint_change:{hint:"sdk.mapcontrols.query.actions.copy_zoom_to_fid_url.hint_change",duration:1e3},cbk:u.copyZoomToFidUrl.bind(u)}),n.editable&&!n.inediting&&u.state.layersactions[n.id].push({id:"editing",class:h.default.getFontClass("pencil"),hint:"Editing",cbk:function(e,t){u.editFeature({layer:e,feature:t})}})}),this.addActionsForLayers(this.state.layersactions,this.state.layers))},e.createActionState=function(e){var t=e.layer,e=e.dynamicProperties,r=(void 0===e?["toggled"]:e).reduce(function(e,t){return e[t]={},e},{});return t.features.map(function(e,t){Object.keys(r).forEach(function(e){r[e][t]=null})}),Vue.observable(r)},e.getActionLayerById=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,r=e.id;return this.state.layersactions[t.id].find(function(e){return e.id===r})},e.setCurrentActionLayerFeatureTool=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,r=e.action,n=e.index,e=e.component,e=void 0===e?null:e;e?(this.state.currentactiontools[t.id][n]&&r.id!==this.state.currentactionfeaturelayer[t.id][n].id&&this.state.currentactionfeaturelayer[t.id][n].toggleable&&(this.state.currentactionfeaturelayer[t.id][n].state.toggled[n]=!1),this.state.currentactionfeaturelayer[t.id][n]=r):this.state.currentactionfeaturelayer[t.id][n]=null,this.state.currentactiontools[t.id][n]=e},e.addCurrentActionToolsLayer=function(e){var t=e.id,r=e.layer,e=e.config,e=void 0===e?{}:e;this.state.actiontools[t]={},this.state.actiontools[t][r.id]=e},e.resetCurrentActionToolsLayer=function(r){var n=this;r.features.forEach(function(e,t){n.state.currentactiontools[r.id]&&(void 0===n.state.currentactiontools[r.id][t]?Vue.set(n.state.currentactiontools[r.id],t,null):n.state.currentactiontools[r.id][t]=null,n.state.currentactionfeaturelayer[r.id][t]=null)})},e.setLayerActionTool=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,r=e.component,e=e.config,e=void 0===e?null:e;this.state.layeractiontool[t.id].component=void 0===r?null:r,this.state.layeractiontool[t.id].config=e},e.copyZoomToFidUrl=function(e,t,r){var t=t.attributes[g.G3W_FID],n=new URL(location.href),e=e.id+"|"+t;n.searchParams.set("zoom_to_fid",e),f(n.toString()),r.hint_changed=!0},e.clear=function(){this.runAsyncTodo(),this.unlistenerEventsActions(),this.mapService.clearHighlightGeometry(),this.resultsQueryLayer.getSource().clear(),this.removeAddFeaturesLayerResultInteraction({toggle:!0}),this._asyncFnc=null,this._asyncFnc={todo:l,zoomToLayerFeaturesExtent:{async:!1},goToGeometry:{async:!1}},this.clearState(),this.closeComponent(),this.removeQueryResultLayerFromMap()},e.getCurrentLayersIds=function(){return this._currentLayerIds},e.runAsyncTodo=function(){this._asyncFnc.todo()},e._orderResponseByProjectLayers=function(e){var r=this;e.sort(function(e,t){e=r._projectLayerIds.indexOf(e.id);return r._projectLayerIds.indexOf(t.id)<e?1:-1})},e.setZoomToResults=function(){this.state.zoomToResult=!(0<arguments.length&&void 0!==arguments[0])||arguments[0]},e.highlightFeaturesPermanently=function(e){e=e.features;this.mapService.highlightFeatures(e,{duration:1/0})},e.isOneLayerResult=function(){return 1===this.state.layers.length},e.removeAddFeaturesLayerResultInteraction=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).toggle,e=void 0!==e&&e;this._addFeaturesLayerResultInteraction.interaction&&this.mapService.removeInteraction(this._addFeaturesLayerResultInteraction.interaction),this._addFeaturesLayerResultInteraction.interaction=null,this._addFeaturesLayerResultInteraction.id=null,e&&this._addFeaturesLayerResultInteraction.mapcontrol&&this._addFeaturesLayerResultInteraction.mapcontrol.toggle(!0),this._addFeaturesLayerResultInteraction.mapcontrol=null,this._addFeaturesLayerResultInteraction.toggleeventhandler&&this.mapService.off("mapcontrol:toggled",this._addFeaturesLayerResultInteraction.toggleeventhandler),this._addFeaturesLayerResultInteraction.toggleeventhandler=null},e.addLayerFeaturesToResultsAction=function(i){var a,e,t,o=this;null!==this._addFeaturesLayerResultInteraction.id&&this._addFeaturesLayerResultInteraction.id!==i.id&&((e=this.state.layers.find(function(e){return e.id===o._addFeaturesLayerResultInteraction.id}))&&(e.addfeaturesresults.active=!1),this._addFeaturesLayerResultInteraction.interaction)&&this.mapService.removeInteraction(this._addFeaturesLayerResultInteraction.interaction),this._addFeaturesLayerResultInteraction.id=i.id,i.addfeaturesresults.active=!i.addfeaturesresults.active,i.addfeaturesresults.active?(this.activeMapInteraction(),a=i.external,this._addFeaturesLayerResultInteraction.mapcontrol||(this._addFeaturesLayerResultInteraction.mapcontrol=this.mapService.getCurrentToggledMapControl()),this._addFeaturesLayerResultInteraction.interaction=new z,this.mapService.addInteraction(this._addFeaturesLayerResultInteraction.interaction,{close:!1}),this._addFeaturesLayerResultInteraction.interaction.on("picked",(t=b(regeneratorRuntime.mark(function e(t){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.coordinate,a){e.next=6;break}return e.next=4,s.default.getData("query:coordinates",{inputs:{coordinates:r,query_point_tolerance:o._project.getQueryPointTolerance(),layerIds:[i.id],multilayers:!1},outputs:{show:{add:!0}}});case 4:e.next=9;break;case 6:n=o._vectorLayers.find(function(e){return i.id===e.get("id")}),n=o.getVectorLayerFeaturesFromQueryRequest(n,{coordinates:r}),o.setQueryResponse({data:[n],query:{coordinates:r}},{add:!0});case 9:case"end":return e.stop()}},e,o)})),function(e){return t.apply(this,arguments)})),this._addFeaturesLayerResultInteraction.toggleeventhandler=e=function(e){e.target.isToggled()&&e.target.isClickMap()&&(i.addfeaturesresults.active=!1)},this.mapService.once("mapcontrol:toggled",e)):this.removeAddFeaturesLayerResultInteraction({toggle:!0})},e.deactiveQueryInteractions=function(){this.state.layers.forEach(function(e){e.addfeaturesresults&&(e.addfeaturesresults.active=!1)}),this.removeAddFeaturesLayerResultInteraction()},e.zoomToLayerFeaturesExtent=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=e.features;t.highlight=!this.isOneLayerResult(),this._asyncFnc.zoomToLayerFeaturesExtent.async?this._asyncFnc.todo=this.mapService.zoomToFeatures.bind(this.mapService,r,t):this.mapService.zoomToFeatures(r,t)},e.clearState=function(){this.state.layers.splice(0),this.state.query=null,this.state.querytitle="",this.state.changed=!1,Object.values(this.state.layersactions).forEach(function(e){return e.forEach(function(e){return e.clear&&e.clear()})}),this.state.layersactions={},this.state.actiontools={},this.state.layeractiontool={},this.state.currentactiontools={},this.state.layersFeaturesBoxes={},this.removeAddFeaturesLayerResultInteraction()},e.getState=function(){return this.state},e.setState=function(e){this.state=e},e._setRelations=function(e){e=e.getRelations();this._relations=e?_.groupBy(e,"referencedLayer"):[]},e.getAtlasByLayerId=function(t){return this._atlas.filter(function(e){return e.atlas.qgs_layer_id===t})},e._setAtlasActions=function(e){this._atlas=e.getPrint().filter(function(e){return e.atlas})||[]},e.setTitle=function(e){this.state.querytitle=e||""},e.reset=function(){this.clearState()},e._digestFeaturesForLayers=function(e){function t(e){var r=void 0,t=void 0,n=void 0,i=!1,a=!1,o=!1,s=e.layer,l=[],u=[],c=void 0,d={},p={};if(s instanceof P){a=s.isEditable(),o=s.isInEditing(),n=s.getSource(),u=s.getInfoFormats(),c=s.getInfoFormat(),-1===[P.SourceTypes.WMS,P.SourceTypes.WCS,P.SourceTypes.WMST].indexOf(s.getSourceType())&&(d=s.state.filter,p=s.state.selection),l=s.getDownloadableFormats();try{t=s.getSourceType()}catch(e){}if(L="ows"===x.state.type?s.getAttributes().map(function(e){e=M({},e);return e.name=e.name.replace(/ /g,"_"),e}):s.getAttributes(),C=[],k=s.getTitle(),E=s.getId(),s.hasFormStructure()){var f=s.getLayerEditingFormStructure();if(x._relations&&x._relations.length){function h(e){if(e.nodes){var t=!0,r=!1,n=void 0;try{for(var i,a=e.nodes[Symbol.iterator]();!(t=(i=a.next()).done);t=!0)h(i.value)}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}}else e.name&&(e.relation=!0)}var g=!0,v=!1,m=void 0;try{for(var y,_=f[Symbol.iterator]();!(g=(y=_.next()).done);g=!0)h(y.value)}catch(e){v=!0,m=e}finally{try{!g&&_.return&&_.return()}finally{if(v)throw m}}}r={structure:f,fields:s.getFields().filter(function(e){return e.show})}}}else s instanceof ol.layer.Vector?(p=s.selection,L=s.getProperties(),C=[],k=s.get("name"),E=s.get("id"),i=!0):("string"==typeof s||s instanceof String)&&(t=P.LayerTypes.VECTOR,v=e.features[0],L=v?v.getProperties():[],C=[],m=s.split("_"),k=4<m.length?m.slice(0,m.length-4).join(" "):s,E=s,i=!0);I(f={title:k,id:E,infoformat:c,infoformats:u,attributes:[],features:[],hasgeometry:!1,atlas:x.getAtlasByLayerId(E),source:n,downloads:l,show:!0,filter:d,addfeaturesresults:{active:!1}},T.default.name,{active:!1}),I(f,"external",i),I(f,"editable",a),I(f,"inediting",o),I(f,"selection",p),I(f,"expandable",!0),I(f,"hasImageField",!1),I(f,"relationsattributes",C),I(f,"formStructure",r),I(f,"error",""),I(f,"rawdata",null),I(f,"loading",!1);var b,w=f;e.rawdata?(w.rawdata=e.rawdata,S.push(w)):e.features&&e.features.length?((b=s instanceof P?L.filter(function(e){try{return"_"===e.name[0]||Number.isInteger(+e.name[0])}catch(e){return!1}}).map(function(e){return{alias:e.name.replace(/_/,""),name:e.name}}):[]).length&&e.features.forEach(function(e){return x._setSpecialAttributesFeatureProperty(b,e)}),w.attributes=x._parseAttributes(L,e.features[0],t),w.attributes.forEach(function(t){r&&!s.getFields().find(function(e){return e.name===t.name})&&r.fields.push(t),"image"===t.type&&(w.hasImageField=!0)}),e.features.forEach(function(e){var t=x.getFeaturePropertiesAndGeometry(e),r=t.id,n=t.geometry,i=t.properties,t=t.selection,e=(n&&(w.hasgeometry=!0),{id:w.external?e.getId():r,attributes:i,geometry:n,selection:t,show:!0});w.features.push(e),0}),S.push(w)):e.error&&(w.error=e.error)}var x=this,S=[],L=void 0,C=void 0,k=void 0,E=void 0;return(e=e||[]).forEach(function(e){Array.isArray(e)?e.forEach(t):t(e)}),S},e._setSpecialAttributesFeatureProperty=function(e,r){var t=r.getProperties(),n=Object.keys(t);e.length&&e.forEach(function(t){n.find(function(e){if(e===t.alias)return r.set(t.name,r.get(e)),!0})})},e.getFeaturePropertiesAndGeometry=function(e){return e instanceof ol.Feature?{selection:e.selection,properties:e.getProperties(),geometry:e.getGeometry(),id:e.getId()}:{selection:e.selection,properties:e.properties,geometry:e.geometry,id:e.id}},e._parseAttributes=function(e,t,r){var n,t=this.getFeaturePropertiesAndGeometry(t).properties,i=Object.keys(t),i=D(i);return e&&e.length?e.filter(function(e){return-1<i.indexOf(e.name)}):(t=P.SourceTypes,n=[t.GDAL,t.WMS,t.WCS,t.WMST],i.map(function(e){return{name:e,label:e,show:e!==g.G3W_FID&&(void 0===r||-1!==n.indexOf(r)),type:"varchar"}}))},e.trigger=(O=b(regeneratorRuntime.mark(function e(t,r,n,i,a){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((o=this._actions[t])&&o(r,n,i),r)if((o=this.state.layersactions[r.id])&&(o=o.find(function(e){return e.id===t}),e.t0=o,e.t0))return e.next=10,this.triggerLayerAction(o,r,n,i,a);e.next=10;break;case 10:case"end":return e.stop()}},e,this)})),function(e,t,r,n,i){return O.apply(this,arguments)}),e.triggerLayerAction=(R=b(regeneratorRuntime.mark(function e(t,r,n,i,a){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.cbk,e.t0)return e.next=4,t.cbk(r,n,t,i,a);e.next=4;break;case 4:t.route&&(o=t.route,o=o.replace(/{(\w*)}/g,function(e,t){return n.attributes.hasOwnProperty(t)?n.attributes[t]:""}))&&""!==o&&h.default.goto(o);case 5:case"end":return e.stop()}},e,this)})),function(e,t,r,n,i){return R.apply(this,arguments)}),e.registerVectorLayer=function(e){-1===this._vectorLayers.indexOf(e)&&this._vectorLayers.push(e)},e.unregisterVectorLayer=function(t){var r=this;this._vectorLayers=this._vectorLayers.filter(function(e){return r.state.layers=r.state.layers&&r.state.layers.filter(function(e){return e.id!==t.get("id")}),e!==t})},e.getVectorLayerFeaturesFromQueryRequest=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=e.coordinates,n=e.bbox,i=e.geometry,e=e.filterConfig,a=void 0===e?{}:e,o=[];if(r&&Array.isArray(r)){e=this.mapService.viewer.map.getPixelFromCoordinate(r);this.mapService.viewer.map.forEachFeatureAtPixel(e,function(e,t){o.push(e)},{layerFilter:function(e){return e===t}})}else if((i=n&&Array.isArray(n)?ol.geom.Polygon.fromExtent(n):i)instanceof ol.geom.Polygon||i instanceof ol.geom.MultiPolygon)switch(t.constructor){case q:o=t.getIntersectedFeatures(i);break;case ol.layer.Vector:t.getSource().getFeatures().forEach(function(e){var t=void 0;switch(a.spatialMethod){case"intersects":t=S(i,e.getGeometry());break;case"within":t=L(i,e.getGeometry());break;default:t=i.intersectsExtent(e.getGeometry().getExtent())}!0===t&&o.push(e)})}return{features:o,layer:t}},e._addVectorLayersDataToQueryResponse=function(r){var n=this,i=h.default.getService("catalog"),a=r.query.external.filter.SELECTED;this._vectorLayers.forEach(function(e){var t=i.isExternalLayerSelected({id:e.get("id"),type:"vector"});e.getVisible()&&(!0===t&&!0===a||!1===t&&!1===a||void 0===a)&&r.data.push(n.getVectorLayerFeaturesFromQueryRequest(e,r.query))})},e._addComponent=function(e){this.state.components.push(e)},e._printSingleAtlas=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.atlas,t=void 0===t?{}:t,e=e.features,e=void 0===e?[]:e,r=t.name,t=t.atlas.field_name,n=(void 0===t?"":t)||"$id",t=e.map(function(e){return e.attributes["$id"===n?g.G3W_FID:n]}),i=y.default.setDownload(!0);return this.printService.printAtlas({field:n,values:t,template:r,download:!0}).then(function(e){e=e.url;u({url:e,filename:r,mime_type:"application/pdf"}).catch(function(e){h.default.showUserMessage({type:"alert",error:e})}).finally(function(){y.default.setDownload(!1,i),h.default.setLoadingContent(!1)})})},e.showChart=function(e,t,r){this.emit("show-chart",e,t,r)},e.hideChart=function(e){this.emit("hide-chart",e)},e.showRelationsChart=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],r=arguments[2],n=arguments[3],i=arguments[4],a=arguments[5];n.state.toggled[i]=!n.state.toggled[i],n.state.toggled[i]?(n={relations:this._relations[t.id],fid:r.attributes[g.G3W_FID],height:400},this.emit("show-chart",e,a,n)):this.hideChart(a)},e.printAtlas=function(e,t){var n,i,r=this,a=t?[t]:e.features,o=this.getAtlasByLayerId(e.id);o.length<=1?this._printSingleAtlas({features:a,atlas:o[0]}):(n="g3w_atlas_index",i="",o.forEach(function(e,t){var r=w();i=(i+='<input id="'+r+'" '+n+'="'+t+'" class="magic-radio" type="radio" name="template" value="'+e.name+'"/>')+'<label for="'+r+'">'+e.name+"</label><br>"}),h.default.showModalDialog({title:C("sdk.atlas.template_dialog.title"),message:i,buttons:{success:{label:"OK",className:"skin-button",callback:function(){var e=$('input[name="template"]:checked').attr(n);if(void 0===e)return!1;r._printSingleAtlas({features:a,atlas:o[e]})}}}}))},e.showLayerDownloadFormats=function(e){var t=T.default.name;e[t].active=!e[t].active,this.setLayerActionTool({layer:e,component:e[t].active?T.default:null,config:e[t].active?this.state.actiontools[t][e.id]:null})},e.downloadFeatures=(A=b(regeneratorRuntime.mark(function e(i,a){var t,o,r,n,s,l,u,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],d=this,p=arguments[3],f=arguments[4];return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=a.id,u=this.state.query,u=void 0===u?{}:u,c=c&&(Array.isArray(c)?c:[c]),o={fids:c.map(function(e){return e.attributes[g.G3W_FID]}).join(",")},r=function(){var e=b(regeneratorRuntime.mark(function e(){var t,r,n=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return 1<c.length&&(a[T.default.name].active=n,d.setLayerActionTool({layer:a})),r=v.default.getLayerById(a.id),t=y.default.setDownload(!0),h.default.setLoadingContent(!0),e.prev=4,e.next=7,r.getDownloadFilefromDownloadDataType(i,{data:o});case 7:if(e.t0=e.sent,e.t0){e.next=10;break}Promise.resolve();case 10:e.next=15;break;case 12:e.prev=12,e.t1=e.catch(4),h.default.notify.error(e.t1||C("info.server_error"));case 15:y.default.setDownload(!1,t),h.default.setLoadingContent(!1),r=d.state.layersactions[a.id].find(function(e){return"downloads"===e.id}),1<c.length?void 0===r?(a[i].active=!1,d.setLayerActionTool({layer:a})):a[T.default.name].active=!1:(void 0===r?p.state.toggled[f]=!1:r.state.toggled[f]=!1,d.setCurrentActionLayerFeatureTool({index:f,action:p,layer:a}));case 19:case"end":return e.stop()}},e,d,[[4,12]])}));return function(){return e.apply(this,arguments)}}(),"polygon"===u.type?(n=this.state.layersactions[a.id].find(function(e){return"downloads"===e.id}),s=u.fid,l=u.layer,u={choices:[{id:w(),type:"feature",label:"sdk.mapcontrols.querybypolygon.download.choiches.feature.label"},{id:w(),type:"polygon",label:"sdk.mapcontrols.querybypolygon.download.choiches.feature_polygon.label"}],download:function(e){"polygon"===e?(o.sbp_qgs_layer_id=l.getId(),o.sbp_fid=s):(delete o.sbp_fid,delete o.sbp_qgs_layer_id),r(!0)}},1===c.length?(void 0===n&&(p.state.toggled[f]=!0),this.state.actiontools[m.default.name]=this.state.actiontools[t]||{},this.state.actiontools[m.default.name][t]=u,this.setCurrentActionLayerFeatureTool({layer:a,index:f,action:p,component:m.default})):void 0!==n||(a[i].active=!a[i].active,a[i].active)?this.setLayerActionTool({layer:a,component:m.default,config:u}):this.setLayerActionTool({layer:a})):r();case 6:case"end":return e.stop()}},e,this)})),function(e,t){return A.apply(this,arguments)}),e.downloadGpx=function(){var e=this,t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).id,r=arguments[1],r=r?r.attributes[g.G3W_FID]:null;v.default.getLayerById(t).getGpx({fid:r}).catch(function(e){h.default.notify.error(C("info.server_error"))}).finally(function(){e.layerMenu.loading.shp=!1,e._hideMenu()})},e.downloadXls=function(){var e=this,t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).id,r=arguments[1],r=r?r.attributes[g.G3W_FID]:null;v.default.getLayerById(t).getXls({fid:r}).catch(function(e){h.default.notify.error(C("info.server_error"))}).finally(function(){e.layerMenu.loading.shp=!1,e._hideMenu()})},e.listenClearSelection=function(n,t){var e,r,i=this;n.external?n.features.forEach(function(t){var e=n.selection.features.find(function(e){return t.id===e.getId()});t.selection=e?e.selection:{selected:!1}}):((e=v.default.getLayerById(n.id)).on("unselectionall",r=function(){var r=i.state.layersactions[n.id].find(function(e){return e.id===t});n.features.forEach(function(e,t){return r.state.toggled[t]=!1})}),this.unlistenerlayeractionevents.push({layer:e,event:"unselectionall",handler:r}))},e.clearSelectionExtenalLayer=function(e){var r=this,n=(e.selection.active=!1,this.state.layersactions[e.id]&&this.state.layersactions[e.id].find(function(e){return"selection"===e.id}));e.selection.features.forEach(function(e,t){e.selection.selected&&(e.selection.selected=!1,n&&(n.state.toggled[t]=!1),r.mapService.setSelectionFeatures("remove",{feature:e}))})},e.unlistenerEventsActions=function(){this.unlistenerlayeractionevents.forEach(function(e){return e.layer.off(e.event,e.handler)}),this.unlistenerlayeractionevents=[]},e.addRemoveFilter=function(e){v.default.getLayerById(e.id).toggleFilterToken()},e.selectionFeaturesLayer=function(e){var r=this,t=e.id,n=this.state.layersactions[t].find(function(e){return"selection"===e.id}),i=Object.values(n.state.toggled).reduce(function(e,t){return e&&t},!0),a=e.external?e:v.default.getLayerById(t);e.features.forEach(function(e,t){n.state.toggled[t]=!i,r._addRemoveSelectionFeature(a,e,t,i?"remove":"add")})},e._addRemoveSelectionFeature=(j=b(regeneratorRuntime.mark(function e(t,r,n,i){var a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t.external&&t.external){if(void 0===t.selection.features&&(t.selection.features={}),t.selection.features.find(function(e){return e.getId()===r.id})||((s=x({feature:r,id:r.id})).__layerId=t.id,s.selection=r.selection,t.selection.features.push(s)),"add"===i&&r.selection.selected||"remove"===i&&!r.selection.selected)return e.abrupt("return");e.next=7}else e.next=12;break;case 7:r.selection.selected=!r.selection.selected;case 8:this.mapService.setSelectionFeatures(r.selection.selected?"add":"remove",{feature:t.selection.features.find(function(e){return r.id===e.getId()})}),t.selection.active=t.selection.features.reduce(function(e,t){return e||t.selection.selected},!1),e.next=28;break;case 12:a=r?r.attributes[g.G3W_FID]:null,(o=t.getFilterActive()||t.hasSelectionFid(a))||r&&r.geometry&&!t.getOlSelectionFeature(a)&&t.addOlSelectionFeature({id:a,feature:r}),void 0!==i?e.next=19:(t[o?"excludeSelectionFid":"includeSelectionFid"](a),e.next=27);break;case 19:if(o||"add"!==i){e.next=24;break}return e.next=22,t.includeSelectionFid(a);case 22:e.next=27;break;case 24:if(o&&"remove"===i)return e.next=27,t.excludeSelectionFid(a);e.next=27;break;case 27:t.getFilterActive()&&(s=this.state.layers.find(function(e){return e.id===t.getId()}),0<t.getSelectionFids().size&&s&&s.features.splice(n,1),this.mapService.clearHighlightGeometry(),1!==this.state.layers.length||this.state.layers[0].features.length||this.state.layers.splice(0));case 28:case"end":return e.stop()}},e,this)})),function(e,t,r,n){return j.apply(this,arguments)}),e.checkFeatureSelection=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,r=e.feature,n=e.index,e=e.action;t.external?e.state.toggled[n]=r.selection.selected:(t=v.default.getLayerById(t.id),r&&(r=r?r.attributes[g.G3W_FID]:null,e.state.toggled[n]=t.getFilterActive()||t.hasSelectionFid(r)))},e.addToSelection=function(e,t,r,n){var i=e.external,i=void 0!==i&&i,r=(r.state.toggled[n]=!r.state.toggled[n],i?e:v.default.getLayerById(e.id));this._addRemoveSelectionFeature(r,t,n)},e.removeQueryResultLayerFromMap=function(){this.resultsQueryLayer.getSource().clear(),this.mapService.getMap().removeLayer(this.resultsQueryLayer)},e.addQueryResultsLayerToMap=function(e){e=e.feature;this.removeQueryResultLayerFromMap(),this.resultsQueryLayer.getSource().addFeature(e),this.mapService.getMap().addLayer(this.resultsQueryLayer),this.mapService.setZIndexLayer({layer:this.resultsQueryLayer})},e.showCoordinates=function(e){e=U(e);this.addQueryResultsLayerToMap({feature:e})},e.showBBOX=function(e){e=V(e);this.addQueryResultsLayerToMap({feature:e})},e.showGeometry=function(e){e=G({geometry:e});this.addQueryResultsLayerToMap({feature:e})},e.goToGeometry=function(e,t){var r,n=this;t.geometry&&(r={mapServiceMethod:this.isOneLayerResult()?"zoomToFeatures":"highlightGeometry",firstParam:this.isOneLayerResult()?[t]:t.geometry,options:this.isOneLayerResult()?{}:{layerId:e.id,duration:1500}},this._asyncFnc.goToGeometry.async?this._asyncFnc.todo=this.mapService[r.mapServiceMethod].bind(this.mapService,r.firstParam,r.options):setTimeout(function(){return n.mapService[r.mapServiceMethod](r.firstParam,r.options)}))},e.saveLayerResult=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,e=e.type;this.downloadFeatures(void 0===e?"csv":e,t,t.features)},e.highlightGeometry=function(e,t){t.geometry&&this.mapService.highlightGeometry(t.geometry,{layerId:e.id,zoom:!1,duration:1/0})},e.clearHighlightGeometry=function(e){this.mapService.clearHighlightGeometry(),this.isOneLayerResult()&&this.highlightFeaturesPermanently(e)},e.showRelation=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.relation,r=e.layerId,e=e.feature,n=t.name,t=t.nmRelationId,i=[],n=this._project.getRelationById(n),t=this._project.getRelationById(t);this.findPlotId(n.referencingLayer)&&i.push(n.referencingLayer),h.default.pushContent({content:new k({currentview:"relation",relations:[n],chartRelationIds:i,nmRelation:t,feature:e,layer:{id:r}}),crumb:{title:n.name},title:n.name,closable:!1})},e.showQueryRelations=function(e,t,r){h.default.changeCurrentContentOptions({crumb:{title:e.title}}),h.default.pushContent({content:new k({relations:r.relations,chartRelationIds:r.chartRelationIds,feature:t,layer:e}),backonclose:!0,title:g.LIST_OF_RELATIONS_TITLE,id:g.LIST_OF_RELATIONS_ID,crumb:{title:g.LIST_OF_RELATIONS_TITLE,trigger:null},closable:!1})},t.exports=E},{"components/QueryResultsActionDownloadFormats.vue":280,"components/QueryResultsActionQueryPolygonCSVAttributes.vue":282,constant:4,"core/g3wobject":12,"core/i18n/i18n.service":13,"core/layers/layer":34,"core/layers/vectorlayer":57,"core/print/printservice":60,"core/utils/geo":64,"core/utils/utils":68,"g3w-ol/interactions/pickcoordinatesinteraction":105,"gui/relations/vue/relationspage":175,"services/application":351,"services/data":358,"services/gui":361,"store/catalog-layers":374,"store/projects":379}],172:[function(e,t,r){var n=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/QueryResults.vue"));function i(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var a=e("core/utils/utils"),o=a.base,a=a.inherit,s=e("gui/component/component"),l=e("gui/queryresults/queryresultsservice"),u=Vue.extend(n);function c(){var t=this;o(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),this.id="queryresults",this.title="Query Results",this._service=new l,this.setInternalComponent=function(){this.internalComponent=new u({queryResultsService:this._service}),this.internalComponent.querytitle=this._service.state.querytitle},this.getElement=function(){if(this.internalComponent)return this.internalComponent.$el},this._service.onafter("setLayersData",i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.internalComponent||t.setInternalComponent(),e.next=3,t.internalComponent.$nextTick();case 3:case"end":return e.stop()}},e,t)}))),this.layout=function(e,t){},this.unmount=function(){return this.getService().closeComponent(),o(this,"unmount")}}a(c,s),t.exports=c},{"components/QueryResults.vue":278,"core/utils/utils":68,"gui/component/component":117,"gui/queryresults/queryresultsservice":171}],173:[function(e,t,r){var l=e("app/constant"),i=a(e("services/relations")),u=a(e("services/application")),n=a(e("services/gui"));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var s=e("core/utils/utils"),c=s.inherit,d=s.base;function p(){this.state={},this._options={},d(this)}c(p,e("core/g3wobject"));var f,h,s=p.prototype;s.getRelations=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this._options=e,i.default.getRelations(e)},s.getRelationsNM=(f=o(regeneratorRuntime.mark(function e(t){var r=t.nmRelation,n=t.features;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.default.getRelationsNM({nmRelation:r,features:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),function(e){return f.apply(this,arguments)}),s.saveRelations=(h=o(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._options.type=t,r=u.default.setDownload(!0),e.prev=2,e.next=5,i.default.save(this._options);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),n.default.showUserMessage({type:"alert",message:e.t0||"info.server_error",closable:!0});case 10:u.default.setDownload(!1,r);case 11:case"end":return e.stop()}},e,this,[[2,7]])})),function(e){return h.apply(this,arguments)}),s.buildRelationTable=function(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],r=arguments[1],r=u.default.getCurrentProject().getLayerById(r),n=r.getTableHeaders(),i=null,a=[],o=[],s=void 0;return e.length&&(t=Object.keys(e[0].attributes),i=n.filter(function(e){return-1!==t.indexOf(e.name)}),a=e.map(function(t){return o.push(t.attributes[l.G3W_FID]),i.map(function(e){return t.attributes[e.name]})}),i=(s=i).map(function(e){return e.label})),{columns:i,rows:a,rows_fid:o,features:e,fields:s,formStructure:r.getLayerEditingFormStructure(),rowFormStructure:null,layerId:r.getId()}},t.exports=p},{"app/constant":4,"core/g3wobject":12,"core/utils/utils":68,"services/application":351,"services/gui":361,"services/relations":367}],174:[function(e,t,r){t.exports=new Vue},{}],175:[function(e,t,r){var n=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/RelationsPage.vue"));function i(){c(this,l=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{});var e=l.service||new d,t=l.layer,r=void 0===(r=l.relation)?null:r,n=void 0===(n=l.relations)?[]:n,i=void 0===(i=l.feature)?null:i,a=void 0===(a=l.table)?null:a,o=void 0===(o=l.chartRelationIds)?[]:o,s=l.nmRelation,l=void 0===(l=l.currentview)?"relations":l,u=(this.setService(e),new p({previousview:l,service:e,relations:n,relation:r,nmRelation:s,chartRelationIds:o,feature:i,currentview:l,layer:t,table:a}));this.setInternalComponent(u),u.state=e.state,this.layout=function(){u.reloadLayout()}}var a=e("core/utils/utils"),c=a.base,a=a.inherit,o=e("gui/component/component"),d=e("gui/relations/relationsservice"),p=Vue.extend(n);a(i,o),t.exports=i},{"components/RelationsPage.vue":288,"core/utils/utils":68,"gui/component/component":117,"gui/relations/relationsservice":173}],176:[function(e,t,r){var n=a(e("services/querybuilder")),i=a(e("store/projects"));function a(e){return e&&e.__esModule?e:{default:e}}var o=e("core/utils/utils"),s=o.base,o=o.inherit,l=e("core/g3wobject"),u=e("gui/search/vue/panel/searchpanel");function c(){s(this);var t=i.default.getCurrentProject().state;this.title=t.search_title||"search",this.init=function(e){this.state.searches=e||t.search},this.state={searches:[],searchtools:[],querybuildersearches:n.default.getCurrentProjectItems()}}o(c,l);e=c.prototype;e.removeItem=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.type,e=e.index;"querybuilder"===t&&this.state.querybuildersearches.splice(e,1)},e.getTitle=function(){return this.title},e.showPanel=function(){var e=new u(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{});return e.show(),e},e.cleanSearchPanels=function(){this.state.panels={}},e.stop=function(){var e=$.Deferred();return e.resolve(),e.promise()},e.addTool=function(e){this.state.searchtools.push(e)},e.addTools=function(e){var t=!0,r=!1,n=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;this.addTool(o)}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}},e.addQueryBuilderSearch=function(e){this.state.querybuildersearches.push(e)},e.removeTool=function(e){},e.removeTools=function(){this.state.searchtools.splice(0)},e.reload=function(){this.state.searches=i.default.getCurrentProject().state.search,this.state.querybuildersearches=n.default.getCurrentProjectItems()},t.exports=c},{"core/g3wobject":12,"core/utils/utils":68,"gui/search/vue/panel/searchpanel":177,"services/querybuilder":366,"store/projects":379}],177:[function(e,t,r){var n=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/SearchPanel.vue"));var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=i.uniqueId,i=e("gui/panel"),l=e("gui/search/vue/panel/searchservice"),u=Vue.extend(n);function c(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.service||new l(e);this.setService(t),this.id=s(),this.title="search";e=new(e.component||u)({service:t});this.setInternalPanel(e),this.unmount=function(){return a(this,"unmount").then(function(){t.clear()})}}o(c,i),t.exports=c},{"components/SearchPanel.vue":291,"core/utils/utils":68,"gui/panel":162,"gui/search/vue/panel/searchservice":178}],178:[function(c,e,t){var r,l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},d=(r=y(regeneratorRuntime.mark(function e(t,r){var n,i,a,o,s,l,u,c,d,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.search_endpoint,i=r.feature_count,a=r.relation_id,o=r.output_title,s=t.data[0]||{},s=s.features,s=void 0===s?[]:s,l=h.default.getCurrentProject(),s.length){e.next=6;break}return f.default.showEmptyOutputs(),e.abrupt("return",[]);case 6:if(u=l.getRelationById(a))return c=[],d=new Set,s.forEach(function(e){e=e.getProperties()[u.fieldRef.referencingField];d.has(e)||(d.add(e),c.push({attribute:u.fieldRef.referencedField,logicop:"OR",operator:"eq",value:e}))}),p=l.getLayerById(u.referencedLayer),e.next=14,f.default.getData("search:features",{inputs:{layer:p,search_endpoint:n,filter:x({layer:p,search_endpoint:n,inputs:c}),formatter:1,feature_count:i},outputs:{title:o}});e.next=15;break;case 14:t=e.sent;case 15:return e.abrupt("return",t);case 16:case"end":return e.stop()}},e,this)})),function(e,t){return r.apply(this,arguments)}),m=c("app/constant"),s=n(c("store/catalog-layers")),f=n(c("services/data")),h=n(c("store/projects")),p=n(c("services/gui"));function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}function _(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var i=c("core/utils/utils"),g=i.base,v=i.inherit,b=i.toRawType,w=i.getUniqueDomId,x=i.createFilterFormInputs,S=i.createSingleFieldParameter,L=i.isEmptyObject,C=i.sortAlphabeticallyArray,k=i.sortNumericArray,i=c("core/g3wobject"),E=[null,void 0,m.SEARCH_ALLVALUE];function M(){var a=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(this.debounces={run:{fnc:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=a.mapService.getMap().getSize(),n=o(n,2),i=n[0],n=n[1];!p.default.isMobile()||0!==i&&0!==n?a._run.apply(a,t):(p.default.hideSidebar(),setTimeout(function(){a._run.apply(a,t)},600))}}},g(this),this.state={title:null,forminputs:[],loading:{},searching:!1},this.config=e,this.config.options),t=void 0===t?{}:t,r=t.querylayerid||t.layerid||null;this.inputdependance={},this.inputdependencies={},this.cachedependencies={},this.project=h.default.getCurrentProject(),this.mapService=p.default.getService("map"),this.searchLayer=null,this.filter=null,this.inputs=[],this.state.title=e.name,this.search_endpoint=e.search_endpoint,this.url=t.queryurl,this.filter=t.filter,this.type=this.config.type||"search",this.return=t.return||"data",this.show="data"===this.return&&"search"===this.type,this.searchLayer=s.default.getLayerById(r),this.searchLayers=[r].concat(_(t.otherquerylayerids||[])).map(function(e){return s.default.getLayerById(e)}),this.createInputsFormFromFilter({filter:t.filter||[]})}v(M,i);var T,I,P,F,O,v=M.prototype;v.createInputsFormFromFilter=y(regeneratorRuntime.mark(function e(){var a,t,r,o=this,n=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).filter,s=void 0===n?[]:n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(a=s.length-1,t=function(e){var t=s[e],r={label:t.label,attribute:t.attribute,type:t.input.type||"textfield",options:u({},t.input.options),value:null,operator:t.op,logicop:e===a?null:t.logicop,id:t.id||w(),loading:!1,widget:null},e=r.options,n=e.dependance,i=e.dependance_strict;"selectfield"!==r.type&&"autocompletefield"!==r.type||(r.loading="autocompletefield"!==r.type,t=new Promise(function(e,t){void 0===r.options.values?r.options.values=[]:n?i?(r.loading=!1,e()):o.getValuesFromField(r).then(function(e){e=o.valuesToKeysValues(e),r.options.values=e}).catch(function(){return r.options.values=[]}).finally(function(){r.loading=!1,e()}):o.getValuesFromField(r).then(function(e){e=o.valuesToKeysValues(e),r.options.values=e}).catch(function(){return r.options.values=[]}).finally(function(){r.loading=!1,e()})}),n&&(o.inputdependance[r.attribute]=n,o.state.loading[n]=!1,r.options.disabled=i,o.setInputDependencies({master:n,slave:r}),r.options.values.length?(r.widget="valuemap",r.options._values=[].concat(_(r.options.values))):r.options.layer_id&&(r.widget="valuerelation")),t.then(function(){"autocompletefield"!==r.type&&(r.options.values.length?r.options.values[0].value!==m.SEARCH_ALLVALUE&&r.options.values.unshift({value:m.SEARCH_ALLVALUE}):r.options.values.push({value:m.SEARCH_ALLVALUE}),r.value=m.SEARCH_ALLVALUE)})),o.state.forminputs.push(r)},r=0;r<=a;r++)t(r);case 3:case"end":return e.stop()}},e,this)})),v.getReturnType=function(){return this.return},v.setReturnType=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"data";this.return=e,this.show="data"===e},v.getAutoFieldDependeciesParamField=function(e){var t,e=this.getCurrentFieldDependance(e);if(e)return t=(e=o(Object.entries(e)[0],2))[0],e=e[1],this.createFieldsDependenciesAutocompleteParameter({field:t,value:e})},v.createFieldsDependenciesAutocompleteParameter=function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.fields,r=void 0===r?[]:r,n=t.field,t=t.value,i=this.getCurrentFieldDependance(n);return void 0!==t&&r.push(S({field:n,value:t,operator:this.getFilterInputFromField(n).op})),i?(n=(t=o(Object.entries(i)[0],2))[0],void 0!==(i=t[1])&&(e=(t=this.getFilterInputFromField(n)).op,t=t.logicop,r.unshift(n+"|"+e.toLowerCase()+"|"+encodeURI(i)+"|"+(r.length?t.toLowerCase():""))),this.createFieldsDependenciesAutocompleteParameter({fields:r,dfield:n})):r.length&&r.join()||void 0},v.getValuesFromField=(T=y(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.options.layer_id)return e.next=3,this.getUniqueValuesFromField({field:t.attribute});e.next=5;break;case 3:return r=e.sent,e.abrupt("return",this.getValueRelationValues(t,x({layer:s.default.getLayerById(t.options.layer_id),search_endpoint:this.getSearchEndPoint(),inputs:r.map(function(e){return{value:e,attribute:t.options.value,logicop:"OR",operator:"eq"}})})));case 5:if(t.options.values.length)return e.abrupt("return",this.getValueMapValues(t));e.next=7;break;case 7:return e.abrupt("return",this.getUniqueValuesFromField({field:t.attribute}));case 8:case"end":return e.stop()}},e,this)})),function(e){return T.apply(this,arguments)}),v.getValueRelationValues=(I=y(regeneratorRuntime.mark(function e(t,r){var n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.default.getData("search:features",{inputs:{layer:s.default.getLayerById(t.options.layer_id),search_endpoint:this.getSearchEndPoint(),filter:r,ordering:t.options.key},outputs:!1});case 3:return n=e.sent,n=n.data,i=[],((n=void 0===n?[]:n)&&n[0]&&n[0].features||[]).forEach(function(e){i.push({key:e.get(t.options.key),value:e.get(t.options.value)})}),e.abrupt("return",i);case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return",[]);case 14:case"end":return e.stop()}},e,this,[[0,11]])})),function(e,t){return I.apply(this,arguments)}),v.getValueMapValues=(P=y(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.options.values.filter(function(e){return m.SEARCH_ALLVALUE!==e}));case 1:case"end":return e.stop()}},e,this)})),function(e){return P.apply(this,arguments)}),v.getLayersFilterData=(F=y(regeneratorRuntime.mark(function e(t){var r,n,i,a,o,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.field,n=s.suggest,i=s.unique,a=s.ordering,e.next=3,Promise.allSettled(t.map(function(e){return e.getFilterData({field:r,suggest:n,unique:i,ordering:a})}));case 3:o=e.sent,o=Array.from(o.filter(function(e){return"fulfilled"===e.status}).reduce(function(e,t){t=t.value,t=void 0===t?[]:t;return new Set([].concat(_(e),_(t)))},[])),e.t0=o.length&&l(o[0]),e.next="string"===e.t0?8:"number"===e.t0?9:10;break;case 8:return e.abrupt("return",C(o));case 9:return e.abrupt("return",k(o));case 10:return e.abrupt("return",o);case 11:case"end":return e.stop()}},e,this)})),function(e){return F.apply(this,arguments)}),v.getUniqueValuesFromField=(O=y(regeneratorRuntime.mark(function e(t){var r,n=t.field,i=t.value,a=t.output;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],e.prev=1,e.next=4,this.getLayersFilterData(1===this.searchLayers.length?[this.searchLayer]:this.searchLayers,{field:this.getAutoFieldDependeciesParamField(n),suggest:void 0!==i?n+"|"+i:void 0,unique:n,ordering:n});case 4:r=e.sent,"autocomplete"===a&&(r=r.map(function(e){return{id:e,text:e}})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1);case 11:return e.abrupt("return",r);case 12:case"end":return e.stop()}},e,this,[[1,8]])})),function(e){return O.apply(this,arguments)}),v.doSearch=y(regeneratorRuntime.mark(function e(){var t,r,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=n.filter,a=n.search_endpoint,o=void 0===a?this.getSearchEndPoint():a,a=n.queryUrl,s=void 0===a?this.url:a,a=n.feature_count,l=void 0===a?1e4:a,a=n.show,u=void 0===a?this.show:a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=i||this.createFilter(),this.state.searching=!0,t=void 0,e.prev=3,e.next=6,f.default.getData("search:features",{inputs:{layer:this.searchLayers,search_endpoint:o,filter:i,queryUrl:s,formatter:1,feature_count:l,raw:"search"===this.return},outputs:u&&{title:this.state.title}});case 6:if(t=e.sent,u)e.next=19;else{if("search_1n"===this.type)return e.next=11,d(t,{search_endpoint:o,feature_count:l,relation_id:this.config.options.search_1n_relationid,output_title:this.state.title});e.next=14}break;case 11:e.t0=e.sent,e.next=15;break;case 14:e.t0=function(e,t){"search"===t&&(p.default.closeContent(),e=e.data[0].data,L(e)?f.default.showCustomOutputDataPromise(Promise.resolve({})):new(c("gui/search/vue/panel/searchpanel"))(e).show());return e}(t,this.return);case 15:r=e.t0,t=r||t,e.next=20;break;case 19:this.project.state.autozoom_query&&t&&1===t.data.length&&this.mapService.zoomToFeatures(t.data[0].features);case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(3);case 25:return this.state.searching=!1,e.abrupt("return",t);case 27:case"end":return e.stop()}},e,this,[[3,22]])})),v.filterValidFormInputs=function(){return this.state.forminputs.filter(function(e){return-1===E.indexOf(e.value)&&""!==e.value.toString().trim()})},v.getSearchEndPoint=function(){return this.search_endpoint||this.searchLayer.getSearchEndPoint()},v.createFilter=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.getSearchEndPoint();return x({layer:this.searchLayers,inputs:this.filterValidFormInputs(),search_endpoint:e})},v._run=function(){this.doSearch()},v.changeInput=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,e=e.value;this.state.forminputs.find(function(e){return t==e.id}).value=e},v.createQueryFilterFromConfig=function(e){var t,r=e.filter,n=void 0;for(t in r)n=function r(n){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];var i=a({},n,[]);e.forEach(function(e){for(var t in e)if(Array.isArray(e[t])){r(t,e[t]);break}i[n].push(a({},e.op,a({},e.attribute,null)))});return i}(t,r[t]);return n},v.getFilterInputFromField=function(t){return this.filter.find(function(e){return e.attribute===t})},v._getExpressionOperatorFromInput=function(e){e=this.getFilterInputFromField(e);return e?e.op:null},v._getCascadeDependanciesFilter=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],r=this.getFilterInputFromField(e).input.options.dependance;return r&&(t.unshift(r),this._getCascadeDependanciesFilter(r,t)),t},v.getCurrentFieldDependance=function(e){e=this.inputdependance[e];return e&&a({},e,this.cachedependencies[e]&&m.SEARCH_ALLVALUE!==this.cachedependencies[e]._currentValue?this.cachedependencies[e]._currentValue:void 0)},v.getDependanceCurrentValue=function(t){return this.inputdependance[t]?this.cachedependencies[this.inputdependance[t]]._currentValue:this.state.forminputs.find(function(e){return e.attribute===t}).value},v.fillDependencyInputs=function(){var d=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},p=e.field,t=e.subscribers,f=void 0===t?[]:t,t=e.value,h=void 0===t?m.SEARCH_ALLVALUE:t,g=void 0===this.inputdependance[p],v=h===m.SEARCH_ALLVALUE||null==h||""===h.toString().trim();return new Promise(function(e,t){f.forEach(function(e){"autocompletefield"===e.type?e.options.values.splice(0):(void 0===e.options._allvalues&&(e.options._allvalues=[].concat(_(e.options.values))),v?(e.options.values.splice(0),setTimeout(function(){return e.options.values=[].concat(_(e.options._allvalues))})):e.options.values.splice(1)),e.value="selectfield"!==e.type?m.SEARCH_ALLVALUE:null}),d.cachedependencies[p]=d.cachedependencies[p]||{},d.cachedependencies[p]._currentValue=h;var r,c=f.filter(function(e){return"autocompletefield"!==e.type});if(h&&h!==m.SEARCH_ALLVALUE){var n,i=void 0,a=void 0;if(a=g?(i=void 0!==(n=d.cachedependencies[p]&&d.cachedependencies[p][h]))&&n:(n=d.getDependanceCurrentValue(p),(i=void 0!==(n=d.cachedependencies[p]&&d.cachedependencies[p][n]&&d.cachedependencies[p][n][h]))&&n),i)for(var o=0;o<f.length;o++){var s=f[o],l=a[s.attribute];if(l&&l.length)for(var u=0;u<l.length;u++)s.options.values.push(l[u]);s.options.disabled=!1,e()}else d.state.loading[p]=!0,g?d.cachedependencies[p][h]=d.cachedependencies[p][h]||{}:(n=d.getDependanceCurrentValue(p),d.cachedependencies[p][n]=d.cachedependencies[p][n]||{},d.cachedependencies[p][n][h]=d.cachedependencies[p][n][h]||{}),c.length?(i=d.createFieldsDependenciesAutocompleteParameter({field:p,value:h}),d.searchLayer.getFilterData({field:i}).then((r=y(regeneratorRuntime.mark(function e(t){var u,r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:u=t.data[0].features||[],r=regeneratorRuntime.mark(function e(t){var r,n,i,a,o,s,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=c[t],n=r.attribute,i=r.widget,a=new Set,"valuemap"!==i?e.next=11:(s=[].concat(_(r.options._values)),u.forEach(function(e){e=e.get(n);e&&a.add(e)}),o=[].concat(_(a)),(s=s.filter(function(e){e=e.key;return-1!==o.indexOf(e)})).forEach(function(e){return r.options.values.push(e)}),e.next=29);break;case 11:if("valuerelation"!==i)e.next=27;else{if(u.forEach(function(e){e=e.get(n);e&&a.add(e)}),0<a.size)return s=S({field:r.options.key,value:[].concat(_(a))}),e.prev=15,e.next=18,d.getValueRelationValues(r,s);e.next=25}break;case 18:e.sent.forEach(function(e){return r.options.values.push(e)}),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(15);case 25:e.next=29;break;case 27:u.forEach(function(e){e=e.get(n);e&&a.add(e)}),d.valuesToKeysValues([].concat(_(a)).sort()).forEach(function(e){return r.options.values.push(e)});case 29:g?d.cachedependencies[p][h][r.attribute]=r.options.values.slice(1):(l=d.getDependanceCurrentValue(p),d.cachedependencies[p][l][h][r.attribute]=r.options.values.slice(1)),r.options.disabled=!1;case 31:case"end":return e.stop()}},e,d,[[15,22]])}),n=0;case 3:if(n<c.length)return e.delegateYield(r(n),"t0",5);e.next=8;break;case 5:n++,e.next=3;break;case 8:case"end":return e.stop()}},e,d)})),function(e){return r.apply(this,arguments)})).catch(function(e){return t(e)}).finally(function(){d.state.loading[p]=!1,e()})):(f.forEach(function(e){e.options.dependance_strict&&(e.options.disabled=!1)}),d.state.loading[p]=!1,e())}else f.forEach(function(e){return e.options.disabled=e.options.dependance_strict}),e()})},v.getDependencies=function(e){return this.inputdependencies[e]||[]},v.setInputDependencies=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.master,e=e.slave;this.inputdependencies[t]=void 0!==this.inputdependencies[t]?this.inputdependencies[t]:[],this.inputdependencies[t].push(e)},v.valuesToKeysValues=function(e){return e.length&&"Object"!==b(e[0])?e.map(function(e){return{key:e,value:e}}):e},v.createQueryFilterObject=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.ogcService,t=void 0===t?"wms":t,e=e.filter,e=void 0===e?{}:e;return Object.assign(this.getInfoFromLayer(t),{ogcService:t,filter:e})},v.getInfoFromLayer=function(e){return{url:"wfs"===e?this.searchLayer.getProject().getWmsUrl():this.searchLayer.getQueryUrl(),layers:[],infoFormat:this.searchLayer.getInfoFormat(e),crs:this.searchLayer.getCrs(),serverType:this.searchLayer.getServerType()}},v.setSearchLayer=function(e){this.searchLayer=e},v.getSearchLayer=function(){return this.searchLayer},v.clear=function(){this.state=null},e.exports=M},{"app/constant":4,"core/g3wobject":12,"core/utils/utils":68,"gui/search/vue/panel/searchpanel":177,"services/data":358,"services/gui":361,"store/catalog-layers":374,"store/projects":379}],179:[function(e,t,r){var n=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/Search.vue"));var i=e("core/utils/utils"),a=i.inherit,o=i.base,i=e("gui/component/component"),s=e("gui/search/service"),l=Vue.extend(n);function u(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this.id="search",this._service=e.service||new s,this._service.init(),this.title=this._service.getTitle(),this.internalComponent=new l({service:this._service}),this.internalComponent.state=this._service.state,this.state.visible=!0,this._reload=function(){this._service.reload()},this.unmount=function(){return this._searches_searchtools.$destroy(),o(this,"unmount")}}a(u,i),t.exports=u},{"components/Search.vue":289,"core/utils/utils":68,"gui/component/component":117,"gui/search/service":176}],180:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=new Vue},{}],181:[function(e,t,r){var n=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/SpatialBookMarks.vue")),i=e("services/gui"),a=(i=i)&&i.__esModule?i:{default:i};function o(){var e=this;l(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),this.title="sdk.spatialbookmarks.title",this.setInternalComponent=function(){return this.internalComponent=new u,this.internalComponent},a.default.on("closecontent",function(){e.state.open=!1})}var i=e("core/utils/utils"),s=i.inherit,l=i.base,i=e("gui/component/component"),u=Vue.extend(n);s(o,i),t.exports=o},{"components/SpatialBookMarks.vue":299,"core/utils/utils":68,"gui/component/component":117,"services/gui":361}],182:[function(e,t,r){var n=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/StreetView.vue"));function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=(o(this),e.keyError),e=new s({keyError:e});this.setInternalComponent(e),this.unmount=function(){return o(this,"unmount")}}var a=e("core/utils/utils"),o=a.base,a=a.inherit,e=e("gui/component/component"),s=Vue.extend(n);a(i,e),t.exports=i},{"components/StreetView.vue":300,"core/utils/utils":68,"gui/component/component":117}],183:[function(e,t,r){var n=i(e("store/catalog-layers")),u=i(e("services/data")),f=i(e("services/gui"));function i(e){return e&&e.__esModule?e:{default:e}}function a(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}function o(){var i=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=(this.currentPage=0,this.layer=e.layer,this.formatter=e.formatter,this.getHeaders());this.allfeaturesnumber,this.nopaginationsfilter=[],this.selectedfeaturesfid=this.layer.getSelectionFids(),this.geolayer=this.layer.isGeoLayer(),this.relationsGeometry=[],this.geolayer||this.layer.getRelations().getArray().forEach(function(e){var t=n.default.getLayerById(e.getChild());t.isGeoLayer()&&i.relationsGeometry.push({layer:t,child_field:e.getChildField(),field:e.getFatherField(),features:{}})}),this.projection=this.geolayer?this.layer.getProjection():null,this.mapService=f.default.getService("map"),this.getAll=!1,this.paginationfilter=!1,this.mapBBoxEventHandlerKey={key:null,cb:null},this.clearAllSelection=function(){i.state.features.forEach(function(e){return e.selected=!1}),i.state.tools.show=!1,i.state.selectAll=!1},this.state={pageLengths:v,pageLength:this.layer.getAttributeTablePageLength()||v[0],features:[],title:this.layer.getTitle(),headers:e,geometry:!0,loading:!1,allfeatures:0,pagination:!this.getAll,selectAll:!1,nofilteredrow:!1,tools:{geolayer:{show:this.geolayer,active:!1,in_bbox:void 0},show:!1,filter:this.layer.state.filter}},this._async={state:!1,fnc:d},f.default.onbefore("setContent",function(e){i._async.state=100===e.perc}),this.layer.on("unselectionall",this.clearAllSelection),this.filterChangeHandler=a(regeneratorRuntime.mark(function e(){var t,r,n=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).type;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i.allfeaturesnumber=void 0,t=[],r="in_bbox"===n||!i.selectedfeaturesfid.has(g.ALL),i.state.pagination)e.next=12;else{if(r)return e.next=7,i.reloadData();e.next=10}break;case 7:e.t0=e.sent,e.next=11;break;case 10:e.t0=[];case 11:t=e.t0;case 12:r&&i.emit("redraw",t);case 13:case"end":return e.stop()}},e,i)})),this.layer.on("filtertokenchange",this.filterChangeHandler)}var s,l=e("core/utils/utils"),c=l.inherit,d=l.noop,l=e("core/g3wobject"),h=e("core/i18n/i18n.service").t,p=e("core/utils/geo").coordinatesToGeometry,g=e("core/layers/layer").SELECTION_STATE,v=[10,25,50],e=(c(o,l),o.prototype);e.toggleFilterToken=a(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.layer.toggleFilterToken();case 2:case"end":return e.stop()}},e,this)})),e.getHeaders=function(){return[null].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(this.layer.getTableHeaders()))},e.setDataForDataTable=function(){var t=this,i=[];return this.state.features.forEach(function(e){var r=e.attributes||e.properties,n=[null];t.state.headers.forEach(function(e){var t;e&&(t=r[e.name],e.value=t,n.push(t))}),i.push(n)}),i},e.addRemoveSelectedFeature=function(e){var t;e.selected=!e.selected,this.state.selectAll?(this.state.selectAll=!1,this.layer.excludeSelectionFid(e.id,this.state.pagination)):this.selectedfeaturesfid.has(g.EXCLUDE)?(this.layer[e.selected?"includeSelectionFid":"excludeSelectionFid"](e.id),1===(t=this.selectedfeaturesfid.size)?(this.state.tools.filter.active||this.layer.setSelectionFidsAll(),this.state.selectAll=!0):t-1===this.state.features.length&&this.layer.clearSelectionFids()):(this.layer[e.selected?"includeSelectionFid":"excludeSelectionFid"](e.id),this.selectedfeaturesfid.size===this.allfeaturesnumber&&(this.state.selectAll=!0,this.state.tools.filter.active||this.layer.setSelectionFidsAll())),this.state.tools.show=0<this.selectedfeaturesfid.size,this.state.pagination||this.nopaginationsfilter.length&&(this.state.selectAll=this.state.features.filter(function(e){return e.selected}).length===this.nopaginationsfilter.length)},e.createFeatureForSelection=function(e){return{attributes:e.attributes||e.properties,geometry:this._returnGeometry(e)}},e.getAllFeatures=function(n){var i=this;return f.default.setLoadingContent(!0),new Promise(function(r,e){i.layer.getDataTable(n||{}).then(function(e){var t,e=e.features;i.geolayer&&e&&(n||(t=i.state.features.map(function(e){return e.id}),e.forEach(function(e){-1===t.indexOf(e.id)&&e.geometry&&i.layer.addOlSelectionFeature({id:e.id,feature:i.createFeatureForSelection(e)})}),i.getAll=!0),r(e))}).fail(function(){return e()}).always(function(){return f.default.setLoadingContent(!1)})})},e.switchSelection=a(regeneratorRuntime.mark(function e(){var r,n,t,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.state.pagination?e.next=4:(this.nopaginationsfilter.length?(r=!1,n=[],this.state.features.forEach(function(e,t){-1!==i.nopaginationsfilter.indexOf(t)&&n.push(e),e.selected=!e.selected,i.layer[e.selected?"includeSelectionFid":"excludeSelectionFid"](e.id),r=r||e.selected}),this.state.tools.show=r,this.checkSelectAll(n)):(this.state.features.forEach(function(e){e.selected=!e.selected}),this.layer.invertSelectionFids(),this.checkSelectAll(),this.state.tools.show=0<this.selectedfeaturesfid.size),e.next=13);break;case 4:if(t=!1,this.state.features.forEach(function(e){e.selected=!e.selected,t=e.selected}),e.t0=!this.getAll,e.t0)return e.next=10,this.getAllFeatures();e.next=10;break;case 10:this.state.selectAll=this.paginationfilter?t:this.state.selectAll,this.layer.invertSelectionFids(),this.state.tools.show=0<this.selectedfeaturesfid.size;case 13:case"end":return e.stop()}},e,this)})),e.clearLayerSelection=function(){this.layer.clearSelectionFids()},e.selectAllFeatures=a(regeneratorRuntime.mark(function e(){var r,t,n,i,a,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.state.selectAll=!this.state.selectAll,this.state.pagination?e.next=5:(this.nopaginationsfilter.length?(r=!1,this.state.features.forEach(function(e,t){-1!==o.nopaginationsfilter.indexOf(t)&&(e.selected=o.state.selectAll,o.layer[e.selected?"includeSelectionFid":"excludeSelectionFid"](e.id),r=r||e.selected)}),this.state.tools.show=r):(this.state.tools.show=this.state.selectAll,this.layer[this.state.selectAll?"setSelectionFidsAll":"clearSelectionFids"](),this.state.features.forEach(function(e){return e.selected=o.state.selectAll})),e.next=25);break;case 5:this.paginationfilter?this.state.featurescount>=this.state.allfeatures?(this.state.features.forEach(function(e){e.selected=o.state.selectAll,o.layer[e.selected?"includeSelectionFid":"excludeSelectionFid"](e.id)}),e.next=15):e.next=10:e.next=18;break;case 10:return a=this.paginationParams,t=a.search,n=a.ordering,i=a.formatter,a=a.in_bbox,e.next=13,this.getAllFeatures({search:t,ordering:n,formatter:i,in_bbox:a});case 13:e.sent.forEach(function(e){!o.getAll&&o.geolayer&&e.geometry&&o.layer.addOlSelectionFeature({id:e.id,feature:o.createFeatureForSelection(e)}),o.layer[o.state.selectAll?"includeSelectionFid":"excludeSelectionFid"](e.id)});case 15:this.state.features.forEach(function(e){return e.selected=o.state.selectAll}),e.next=24;break;case 18:if(this.state.features.forEach(function(e){return e.selected=o.state.selectAll}),e.t0=!this.getAll,e.t0)return e.next=23,this.getAllFeatures();e.next=23;break;case 23:this.layer[this.state.selectAll?"setSelectionFidsAll":"clearSelectionFids"]();case 24:this.state.tools.show=this.state.selectAll||0<this.selectedfeaturesfid.size;case 25:case"end":return e.stop()}},e,this)})),e.setFilteredFeature=function(e){var t=this;this.nopaginationsfilter=e,this.checkSelectAll(e.length===this.allfeaturesnumber||0===e.length?void 0:this.nopaginationsfilter.map(function(e){return t.state.features[e]}))},e.setAttributeTablePageLength=function(e){this.layer.setAttributeTablePageLength(e)},e.getData=function(){var o=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.start,s=void 0===t?0:t,t=e.order,l=void 0===t?[]:t,t=e.length,u=void 0===t?this.state.pageLength:t,t=e.columns,c=void 0===t?[]:t,t=e.search,d=void 0===t?{value:null}:t,t=e.firstCall,p=void 0!==t&&t;return f.default.setLoadingContent(!0),this.setAttributeTablePageLength(u),new Promise(function(r,t){var e,n,i,a;o.state.headers.length?(e=d.value&&0<d.value.length?d.value:null,o.state.features.splice(0),l.length||l.push({column:1,dir:"asc"}),n="asc"===l[0].dir?o.state.headers[l[0].column].name:"-"+o.state.headers[l[0].column].name,o.currentPage=0===s||o.state.pagination&&o.state.tools.filter.active?1:s/u+1,i=o.state.tools.geolayer.in_bbox,a=o.state.pagination?c.filter(function(e){return e.search&&e.search.value}).map(function(e){return e.name+"|ilike|"+e.search.value+"|and"}).join(","):void 0,o.paginationParams={field:a||void 0,page:o.currentPage,page_size:u,search:e,in_bbox:i,formatter:o.formatter,ordering:n},(o.state.pagination?o.layer.getDataTable(o.paginationParams):o.layer.getDataTable({ordering:n,in_bbox:i,formatter:o.formatter})).then(function(e){var t=e.features,t=void 0===t?[]:t;o.state.allfeatures=e.count||o.state.features.length,o.state.featurescount=t.length,o.allfeaturesnumber=void 0===o.allfeaturesnumber?e.count:o.allfeaturesnumber,o.paginationfilter=e.count!==o.allfeaturesnumber,o.state.pagination=p?o.state.tools.filter.active||t.length<o.allfeaturesnumber:o.state.pagination,o.addFeatures(t),r({data:o.setDataForDataTable(),recordsFiltered:e.count,recordsTotal:e.count})}).fail(function(e){f.default.notify.error(h("info.server_error")),t(e)}).always(function(){f.default.setLoadingContent(!1)})):r({data:[],recordsTotal:0,recordsFiltered:0})})},e.setInBBoxParam=function(){this.state.tools.geolayer.in_bbox=this.state.tools.geolayer.active?this.mapService.getMapBBOX().join(","):void 0},e.resetMapBBoxEventHandlerKey=function(){ol.Observable.unByKey(this.mapBBoxEventHandlerKey.key),this.mapBBoxEventHandlerKey.key=null,this.mapBBoxEventHandlerKey.cb=null},e.getDataFromBBOX=a(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.state.tools.geolayer.active=!this.state.tools.geolayer.active,this.state.tools.geolayer.active?(this.mapBBoxEventHandlerKey.cb=this.state.pagination?function(){t.setInBBoxParam(),t.emit("ajax-reload")}:a(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.setInBBoxParam(),t.filterChangeHandler({type:"in_bbox"});case 2:case"end":return e.stop()}},e,t)})),this.mapBBoxEventHandlerKey.key=this.mapService.getMap().on("moveend",this.mapBBoxEventHandlerKey.cb),this.mapBBoxEventHandlerKey.cb()):(this.mapBBoxEventHandlerKey.cb&&this.mapBBoxEventHandlerKey.cb(),this.resetMapBBoxEventHandlerKey());case 2:case"end":return e.stop()}},e,this)})),e.addFeature=function(e){var t={id:e.id,selected:this.state.tools.filter.active||this.layer.hasSelectionFid(e.id),attributes:e.attributes||e.properties};this.geolayer&&e.geometry&&(this.layer.getOlSelectionFeature(t.id)||this.layer.addOlSelectionFeature({id:t.id,feature:this.createFeatureForSelection(e)}),t.geometry=e.geometry),this.state.features.push(t)},e.checkSelectAll=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.state.features;this.state.selectAll=this.selectedfeaturesfid.has(g.ALL)||e.length&&e.reduce(function(e,t){return e&&t.selected},!0)},e.addFeatures=function(){var t=this;(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(e){return t.addFeature(e)}),this.state.tools.show=this.layer.getFilterActive()||0<this.selectedfeaturesfid.size,this.checkSelectAll()},e.reloadData=a(regeneratorRuntime.mark(function e(){var t,r,n=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.features.splice(0),this.state.pagination=n,e.next=4,this.getData();case 4:return t=e.sent,r=t.data,r=void 0===r?[]:r,t.reloadData,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)})),e._setLayout=function(){},e._returnGeometry=function(e){var t=void 0;return e.attributes?t=e.geometry:e.geometry&&(t=p(e.geometry.type,e.geometry.coordinates)),t},e.zoomAndHighLightFeature=function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],r=e.geometry;r&&(this._async.state?this._async.fnc=this.mapService.highlightGeometry.bind(mapService,r,{zoom:t}):this.mapService.highlightGeometry(r,{zoom:t}))},e.zoomAndHighLightGeometryRelationFeatures=(s=a(regeneratorRuntime.mark(function e(a){var n,o,s,i=this,l=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.relationsGeometry.length)return n=[],o=[],s=[],this.relationsGeometry.forEach(function(e){var t,r=e.layer,n=e.child_field,i=e.field,e=e.features,i=a.attributes[i];s.push(i),void 0===e[i]?(t=void 0,t=l?u.default.getData("search:features",{inputs:{layer:r,filter:n+"|eq|"+i,formatter:1,search_endpoint:"api"},outputs:!1}):Promise.reject(),o.push(t)):o.push(Promise.resolve({data:[{features:e[i]}]}))}),e.next=7,Promise.allSettled(o);e.next=10;break;case 7:e.sent.forEach(function(e,t){var r=e.status,e=e.value;"fulfilled"===r&&((r=e.data[0]?e.data[0].features:[]).forEach(function(e){return n.push(e)}),void 0===i.relationsGeometry[t].features[s[t]])&&(i.relationsGeometry[t].features[s[t]]=r)}),l?this.mapService.zoomToFeatures(n,{highlight:!0}):this.mapService.highlightFeatures(n);case 10:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)}),e.clear=function(){var e=this;this.layer.off("unselectionall",this.clearAllSelection),this.layer.off("filtertokenchange",this.filterChangeHandler),this.resetMapBBoxEventHandlerKey(),this.allfeaturesnumber=null,this.mapService=null,this._async.state&&setTimeout(function(){e._async.fnc(),e._async.state=!1,e._async.fnc=d})},t.exports=o},{"core/g3wobject":12,"core/i18n/i18n.service":13,"core/layers/layer":34,"core/utils/geo":64,"core/utils/utils":68,"services/data":358,"services/gui":361,"store/catalog-layers":374}],184:[function(e,t,r){var n=a(e("components/Table.vue")),i=a(e("services/gui"));function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=(u(this),this.id="openattributetable",t.layer),n=t.formatter,t=t.service||new d({layer:r,formatter:n}),i=(this.setService(t),new p({service:t}));this.setInternalComponent(i),i.state=t.state,t.on("redraw",function(){e.layout()}),this.unmount=function(){return u(this,"unmount")},this.layout=function(){i.reloadLayout()}}var s=e("core/i18n/i18n.service").t,l=e("core/utils/utils"),u=l.base,l=l.inherit,c=e("gui/component/component"),d=e("gui/table/tableservice"),p=Vue.extend(n.default),e=(l(o,c),o.prototype);e.show=function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=this.getService();i.default.closeOpenSideBarComponent(),r.getData({firstCall:!0}).then(function(){i.default.showContent({content:e,perc:50,split:i.default.isMobile()?"h":"v",push:!1,title:t.title})}).catch(function(e){return i.default.notify.error(s("info.server_error"))}).finally(function(){return e.emit("show")})},e.unmount=function(){var e=this;return u(this,"unmount").then(function(){e._service.clear()})},t.exports=o},{"components/Table.vue":301,"core/i18n/i18n.service":13,"core/utils/utils":68,"gui/component/component":117,"gui/table/tableservice":183,"services/gui":361}],185:[function(e,t,r){var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n=e("store/projects"),o=(n=n)&&n.__esModule?n:{default:n};var n=e("core/utils/utils"),s=n.base;function i(){var n=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.config=null,this.state=a({},e,{toolsGroups:[],visible:!1,loading:!1}),this.setters={addTool:function(e,t){return e.state=e.state||{type:null,message:null},this._addTool(e,t)},addTools:function(e,t){return this._addTools(e,t)},addToolGroup:function(e,t){return this._addToolGroup(e,t)},removeToolGroup:function(e){return this._removeToolGroup(e)},removeTools:function(){return this._removeTools()}},s(this);var t,e=o.default.getCurrentProject().getState().tools,i=void 0===e?{}:e;for(t in i)!function(t){var e=t.toUpperCase(),r=(n.addToolGroup(0,e),i[t].map(function(e){return{name:e.name,action:ToolsService.ACTIONS[t].bind(null,e)}}));n.addTools(r,{position:0,title:e})}(t)}(0,n.inherit)(i,e("core/g3wobject"));n=i.prototype;n.reload=function(){this.removeTools()},n._addTool=function(e,t){var r=t.position,t=t.title,r=this._addToolGroup(r,t);void 0===e.action&&e.type&&(e.action=i.ACTIONS[e.type]?i.ACTIONS[e.type].bind(null,e.options):function(){}),r.tools.push(e)},n._addTools=function(e,t){var r=this;e.forEach(function(e){return r.addTool(e,t)})},n.setLoading=function(){this.state.loading=0<arguments.length&&void 0!==arguments[0]&&arguments[0]},n._removeTool=function(e){this.state.toolsGroups=this.state.toolsGroups.splice(e,1)},n._removeTools=function(){this.state.toolsGroups.splice(0)},n.updateToolsGroup=function(e,t){Vue.set(this.state.toolsGroups,e,t)},n.getState=function(){return this.state},n._removeToolGroup=function(t){this.state.toolsGroups=this.state.toolsGroups.filter(function(e){return e.name!==t})},n._addToolGroup=function(e,t){var r=this.state.toolsGroups.find(function(e){return e.name===t});return r||this.state.toolsGroups.splice(e,0,r={name:t,tools:[]}),r},n.setToolState=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,e=e.state,r=void 0===e?{type:null,message:null}:e;this.state.toolsGroups.find(function(e){e=e.tools.find(function(e){return e.name===t});if(e)return e.state.type=r.type,e.state.message=r.message,!0})},i.ACTIONS={},t.exports=i},{"core/g3wobject":12,"core/utils/utils":68,"store/projects":379}],186:[function(e,t,r){var n=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/Tools.vue")),i=e("services/gui"),a=(i=i)&&i.__esModule?i:{default:i};var i=e("core/utils/utils"),o=i.base,i=i.inherit,s=e("gui/component/component"),l=e("gui/tools/service"),u=Vue.extend(n);function c(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=(o(this,e),this._service=new l(e),this.title="tools",new u({toolsService:this._service}));e.state=this._service.state,this.setInternalComponent(e,{events:[{name:"visible"}]}),this._setOpen=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];(this.internalComponent.state.open=e)&&a.default.closeContent()}}i(c,s),t.exports=c},{"components/Tools.vue":306,"core/utils/utils":68,"gui/component/component":117,"gui/tools/service":185,"services/gui":361}],187:[function(e,t,r){var n=e("core/utils/utils"),i=n.resolve,n=n.inherit,a=e("core/g3wobject"),o=e("gui/component/component"),s=e("gui/panel");function l(){this._parent=null,this.state={contentsdata:[]}}n(l,a);e=l.prototype;e.push=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return this._parent=t.parent,this._mount(e,t)},e.pop=function(){var e,t=this,r=$.Deferred();return this.state.contentsdata.length?(e=this.state.contentsdata.slice(-1)[0].content,this._unmount(e).then(function(){var e=t.state.contentsdata.pop();r.resolve(e)})):r.resolve(),r.promise()},e.clear=function(){var t,r=this,e=$.Deferred();return this.state.contentsdata.length?(t=[],this.state.contentsdata.forEach(function(e){t.push(r._unmount(e.content))}),$.when(t).then(function(){r.state.contentsdata.splice(0,r.state.contentsdata.length),e.resolve()})):e.resolve(),e.promise()},e.getContentData=function(){return this.state.contentsdata},e.getCurrentContentData=function(){return this.state.contentsdata[this.state.contentsdata.length-1]},e.getPreviousContentData=function(){return this.state.contentsdata[this.state.contentsdata.length-2]},e._mount=function(e,t){var r;return e instanceof jQuery?this._setJqueryContent(e):_.isString(e)?((r=$(e)).length||(r=$("<div>"+e+"</div>")),this._setJqueryContent(r)):e.mount&&"function"==typeof e.mount?(this._checkDuplicateVueContent(e),this._setVueContent(e,t)):this._setDOMContent(e)},e._setJqueryContent=function(e,t){return $(this._parent).append(e),this.state.contentsdata.push({content:e,options:t}),i()},e._setDOMContent=function(e,t){return this._parent.appendChild(e),this.state.contentsdata.push({content:e,options:t}),i()},e._setVueContent=function(e){var t=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=$.Deferred(),i=r.append||!1;return e.mount(this._parent,i).then(function(){$(t._parent).localize(),t.state.contentsdata.push({content:e,options:r}),n.resolve(e)}),n.promise()},e._checkDuplicateVueContent=function(e){var t=this,r=null,n=e.getId();this.state.contentsdata.forEach(function(e,t){e.content.getId&&e.content.getId()==n&&(r=t)}),_.isNull(r)||this.state.contentsdata[r].content.unmount().then(function(){return t.state.contentsdata.splice(r,1)})},e._unmount=function(e){var t=$.Deferred();return e instanceof o||e instanceof s?e.unmount().then(function(){return t.resolve()}):($(this._parent).empty(),t.resolve()),t.promise()},e.forEach=function(t){this.state.contentsdata.forEach(function(e){return t(e.content)})},e.getLength=function(){return this.state.contentsdata.length},t.exports=l},{"core/g3wobject":12,"core/utils/utils":68,"gui/component/component":117,"gui/panel":162}],188:[function(e,t,r){t.exports={barstack:e("./barstack")}},{"./barstack":187}],189:[function(e,t,r){var n=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/ViewportContentsViewer.vue"));var i=e("core/utils/utils"),a=i.base,i=i.inherit,o=e("gui/utils/utils").barstack,e=e("gui/component/component"),s=Vue.extend(n);function l(){a(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),this.stack=new o,this.setService(this),this.title="contents",this.contentsdata=this.stack.state.contentsdata,this.state.visible=!0;var e=new s({service:this});this.setInternalComponent(e),this.internalComponent.state=this.state}i(l,e);n=l.prototype;n.setContent=function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.push,r=void 0!==r&&r,n=t.content,i=(t.crumb,$.Deferred());return r?this.addContent(n,t).then(function(){return i.resolve(t)}):this.clearContents().then(function(){e.addContent(n,t).then(function(){return i.resolve(t)})}),this.setOpen(!0),i.promise()},n.addContent=function(e){var t=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=$.Deferred();return r.parent=this.internalComponent.$el,r.append=!0,this.stack.push(e,r).then(function(){t.contentsdata=t.stack.state.contentsdata,t.updateContentVisibility(),n.resolve()}),n.promise()},n.removeContent=function(){return this.setOpen(!1),this.clearContents()},n.popContent=function(){var e=this;return this.stack.pop().then(function(){e.contentsdata=e.stack.state.contentsdata,e.updateContentVisibility()})},n.getComponentByClass=function(t){var r=void 0;return this.stack.getContentData().forEach(function(e){if(e.content instanceof t)return r=e.content,!1}),r},n.getComponentById=function(t){var r=void 0;return this.stack.getContentData().forEach(function(e){if(e.content.id==t)return r=e.content,!1}),r},n.getContentData=function(){return this.stack.getContentData()},n.getCurrentContentData=function(){return this.stack.getCurrentContentData()},n.getPreviousContentData=function(){return this.stack.getPreviousContentData()},n.updateContentVisibility=function(){var e=$(this.internalComponent.$el).children();e.hide(),e.last().show()},n.clearContents=function(){var e=this;return this.stack.clear().then(function(){return e.contentsdata=e.stack.state.contentsdata})},n.layout=function(r,e){var n=this,i=$(this.internalComponent.$el);Vue.nextTick(function(){var e=n.stack.state.contentsdata,t=i.parent().height()-i.siblings(".close-panel-block").outerHeight(!0)-i.siblings(".content_breadcrumb").outerHeight(!0)-10;i.height(t),i.children().first().height(t),e.forEach(function(e){"function"==typeof e.content.layout&&e.content.layout(r+.5,t)})})},t.exports=l},{"components/ViewportContentsViewer.vue":309,"core/utils/utils":68,"gui/component/component":117,"gui/utils/utils":188}],190:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n=u(e("gui/wms/vue/panel/wmslayerspanel")),a=e("app/constant"),o=u(e("services/data")),s=u(e("store/projects")),l=u(e("services/application")),p=u(e("services/gui"));function u(e){return e&&e.__esModule?e:{default:e}}function c(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var f=e("core/utils/utils").uniqueId;function d(){var t,r=this,e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).wmsurls,e=void 0===e?[]:e;this.projectId=s.default.getCurrentProject().getId(),this.panel,this.state={adminwmsurls:e,localwmsurls:[]},p.default.isReady().then(function(){p.default.getService("map").isReady().then(c(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.loadClientWmsUrls();case 2:r.state.localwmsurls=e.sent;case 3:case"end":return e.stop()}},e,r)})))}),s.default.onafter("setCurrentProject",(t=c(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r.projectId=t.getId(),r.state.adminwmsurls=t.wmsurls||[];case 2:case"end":return e.stop()}},e,r)})),function(e){return t.apply(this,arguments)}))}var h,g,e=d.prototype;e.loadClientWmsUrls=c(regeneratorRuntime.mark(function e(){var r,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===(r=this.getLocalWMSData())&&(r={urls:[],wms:{}},this.updateLocalWMSData(r)),e.next=4,p.default.isReady();case 4:return setTimeout(function(){var e=p.default.getService("map");e.on("remove-external-layer",function(e){return n.deleteWms(e)}),e.on("change-layer-position-map",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,e=e.position;return n.changeLayerData(t,{key:"position",value:e})}),e.on("change-layer-opacity",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,e=e.opacity;return n.changeLayerData(t,{key:"opacity",value:e})}),e.on("change-layer-visibility",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,e=e.visible;return n.changeLayerData(t,{key:"visible",value:e})}),Object.keys(r.wms).forEach(function(t){r.wms[t].forEach(function(e){n.loadWMSLayerToMap(i({url:t},e))})})}),e.abrupt("return",r.urls);case 6:case"end":return e.stop()}},e,this)})),e.changeLayerData=function(r){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=this.getLocalWMSData();Object.keys(i.wms).find(function(e){var e=i.wms[e],t=e.findIndex(function(e){return e.name==r});if(-1!==t)return e[t][n.key]=n.value,!0}),this.updateLocalWMSData(i)},e.getRequestStatusObject=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.error,e=e.added;return{error:void 0!==t&&t,added:void 0!==e&&e}},e.addNewUrl=c(regeneratorRuntime.mark(function e(){var t,r,n,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=i.id,o=i.url;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.state.localwmsurls.find(function(e){var t=e.id;return e.url==o||t==a}),t=this.getRequestStatusObject({added:!!r}),r){e.next=13;break}return e.prev=3,e.next=6,this.getWMSLayers(o);case 6:(r=e.sent).result?(n=this.getLocalWMSData(),this.state.localwmsurls.push({id:a,url:o}),n.urls=this.state.localwmsurls,this.updateLocalWMSData(n),r.wmsurl=o,this.showWmsLayersPanel(r)):t.error=!0,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),t.error=!0;case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}},e,this,[[3,10]])})),e.deleteWms=function(n){var i=this.getLocalWMSData();Object.keys(i.wms).find(function(e){var t=i.wms[e],r=t.findIndex(function(e){return e.name==n});if(-1!==r)return t.splice(r,1),0==t.length&&delete i.wms[e],!0}),this.updateLocalWMSData(i)},e.checkIfWMSAlreadyAdded=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.url,e=e.layers,n=void 0===e?[]:e,e=!1,r=this.getLocalWMSData();return e=r.wms[t]?!!r.wms[t].find(function(e){var r=e.layers,e=n.length;if(r.length===e)return n.reduce(function(e,t){return e+r.indexOf(t)!==-1?1:0},0)===e}):e},e.deleteWmsUrl=function(t){this.state.localwmsurls=this.state.localwmsurls.filter(function(e){e=e.id;return t!==e});var e=this.getLocalWMSData();e.urls=this.state.localwmsurls,this.updateLocalWMSData(e)},e.loadWMSDataAndShowWmsLayersPanel=(h=c(regeneratorRuntime.mark(function e(t){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.getRequestStatusObject(),e.prev=1,e.next=4,this.getWMSLayers(t);case 4:n=e.sent,r.error=!n.result,n.result&&(n.wmsurl=t,this.showWmsLayersPanel(n)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),r.error=!0;case 12:return e.abrupt("return",r);case 13:case"end":return e.stop()}},e,this,[[1,9]])})),function(e){return h.apply(this,arguments)}),e.showWmsLayersPanel=function(){return this.panel=new n.default({service:this,config:0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}}),this.panel.show(),this.panel},e.getWMSLayers=(g=c(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={result:!1,layers:[],info_formats:[],abstract:null,map_formats:[],title:null},e.prev=1,e.next=4,o.default.getData("ows:wmsCapabilities",{inputs:{url:t},outputs:!1});case 4:r=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1);case 10:if(r.result)return e.abrupt("return",r);e.next=12;break;case 12:return e.abrupt("return",r);case 13:case"end":return e.stop()}},e,this,[[1,7]])})),function(e){return g.apply(this,arguments)}),e.loadWMSLayerToMap=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.name,n=e.epsg,i=e.position,a=e.opacity,o=e.visible,o=void 0===o||o,e=e.layers,e=void 0===e?[]:e;return p.default.getService("map").addExternalWMSLayer({url:t,name:r,layers:e,epsg:n,position:i,visible:o,opacity:a})},e.addWMSlayer=c(regeneratorRuntime.mark(function e(){var t,r,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=n.url,a=n.name,o=void 0===a?"wms_"+f():a,s=n.epsg,l=n.position,a=n.layers,u=void 0===a?[]:a,a=n.opacity,c=void 0===a?1:a,a=n.visible,d=void 0===a||a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getLocalWMSData(),r={url:i,name:o,layers:u,epsg:s,position:l,visible:d,opacity:c},void 0===t.wms[i]?t.wms[i]=[r]:t.wms[i].push(r),this.updateLocalWMSData(t),e.prev=4,e.next=7,this.loadWMSLayerToMap(r);case 7:e.next=15;break;case 9:e.prev=9,e.t0=e.catch(4),p.default.getService("map").removeExternalLayer(o),this.deleteWms(o),setTimeout(function(){p.default.showUserMessage({type:"warning",message:"sidebar.wms.layer_add_error"})});case 15:this.panel.close();case 16:case"end":return e.stop()}},e,this,[[4,9]])})),e.getLocalWMSData=function(){return l.default.getLocalItem(a.LOCALSTORAGE_EXTERNALWMS_ITEM)&&l.default.getLocalItem(a.LOCALSTORAGE_EXTERNALWMS_ITEM)[this.projectId]},e.updateLocalWMSData=function(e){var t=l.default.getLocalItem(a.LOCALSTORAGE_EXTERNALWMS_ITEM)||{};t[this.projectId]=e,l.default.setLocalItem({id:a.LOCALSTORAGE_EXTERNALWMS_ITEM,data:t})},e.clear=function(){this.panel=null},r.default=d},{"app/constant":4,"core/utils/utils":68,"gui/wms/vue/panel/wmslayerspanel":191,"services/application":351,"services/data":358,"services/gui":361,"store/projects":379}],191:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/WMSLayersPanel.vue"));var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=i.uniqueId,i=e("gui/panel"),l=Vue.extend(n);function u(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.service,e=e.config;this.setService(t),this.id=s(),this.title="sidebar.wms.panel.title";e=new l({service:t,config:e});this.setInternalPanel(e),this.unmount=function(){return a(this,"unmount").then(function(){t.clear()})}}o(u,i),r.default=u},{"components/WMSLayersPanel.vue":311,"core/utils/utils":68,"gui/panel":162}],192:[function(e,t,r){var n=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("components/WMS.vue")),i=o(e("gui/wms/service")),a=o(e("services/gui"));function o(e){return e&&e.__esModule?e:{default:e}}var s=e("core/utils/utils"),l=s.base,s=s.inherit,e=e("gui/component/component"),u=Vue.extend(n);function c(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=(l(this,e),this._service=new i.default(e),this.title="WMS",new u({service:this._service}));e.state=this._service.state,this.setInternalComponent(e),this._setOpen=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];(this.internalComponent.state.open=e)&&a.default.closeContent()}}s(c,e),t.exports=c},{"components/WMS.vue":310,"core/utils/utils":68,"gui/component/component":117,"gui/wms/service":190,"services/gui":361}],193:[function(e,t,r){var a=n(e("store/application-state")),o=n(e("services/gui"));function n(e){return e&&e.__esModule?e:{default:e}}function s(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}t.exports=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).steps,t=void 0===e?{}:e;return{data:function(){return{steps:t,currentStep:0}},watch:{steps:{handler:function(e){var r=this;Object.values(e).find(function(e,t){if(!e.done)return r.currentStep=t,!0})},deep:!1}},render:function(n){var i=this;return n("ul",{style:{alignSelf:"flex-start",listStyle:"none",padding:(a.default.ismobile?5:10)+"px !important",marginBottom:0}},Object.values(this.steps).map(function(e,t){var r={current:!e.done&&t===i.currentStep,done:e.done,todo:!e.done&&t!==i.currentStep};return n("li",{style:{fontWeight:e.done||!e.done&&t===i.currentStep?"bold":null,marginBottom:"5px",color:e.done&&"green",display:e.buttonnext&&"inline-flex"}},[n("i",{style:{marginRight:"5px",fontWeight:e.done&&"bold"},class:(s(t={},o.default.getFontClass("arrow-right"),r.current),s(t,o.default.getFontClass("empty-circle"),r.todo),s(t,o.default.getFontClass("success"),r.done),t)}),n("span",{directives:[{name:e.directive,value:e.description}],style:{display:e.buttonnext?"inline-flex":"inline",flexDirection:e.buttonnext&&"row-reverse"}}),void 0!==e.dynamic&&n("span",{style:{alignSelf:"center",padding:"3px"}},e.dynamic),e.buttonnext&&n("button",{on:{click:function(){e.done=!0,e.buttonnext.done()}},directives:[{name:"t",value:"sdk.workflow.next"}],style:{fontWeight:"bold"},class:{btn:!0,"btn-success":!0,"g3w-disabled":e.buttonnext.disabled}})])}))}}}},{"services/gui":361,"store/application-state":373}],194:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var u=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},n=s(e("vue-cookie-law")),i=s(e("components/HeaderItem.vue")),a=s(e("store/projects")),c=s(e("services/application")),d=s(e("services/gui")),o=e("mixins"),p=e("constant");function s(e){return e&&e.__esModule?e:{default:e}}function l(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var f=e("core/utils/utils").uniqueId,h=e("core/i18n/i18n.service").t;if("undefined"==typeof jQuery)throw new Error("LayoutManager requires jQuery");$.LayoutManager=$.LayoutManager||{options:{navbarMenuSlimscroll:!0,navbarMenuSlimscrollWidth:"0px",navbarMenuHeight:"200px",animationSpeed:"fast",sidebarToggleSelector:"[data-toggle='offcanvas']",sidebarPushMenu:!0,sidebarSlimScroll:!1,sidebarExpandOnHover:!1,enableBoxRefresh:!0,enableFastclick:!0,enableControlSidebar:!0,controlSidebarOptions:{toggleBtnSelector:"[data-toggle='control-sidebar']",selector:".control-sidebar",slide:!0},enableBoxWidget:!0,boxWidgetOptions:{boxWidgetIcons:{collapse:"fa-minus",open:"fa-plus",remove:"fa-times"},boxWidgetSelectors:{remove:'[data-widget="remove"]',collapse:'[data-widget="collapse"]'}},directChat:{enable:!0,contactToggleSelector:'[data-widget="chat-pane-toggle"]'},colors:{lightBlue:"#3c8dbc",red:"#f56954",green:"#00a65a",aqua:"#00c0ef",yellow:"#f39c12",blue:"#0073b7",navy:"#001F3F",teal:"#39CCCC",olive:"#3D9970",lime:"#01FF70",orange:"#FF851B",fuchsia:"#F012BE",purple:"#8E24AA",maroon:"#D81B60",black:"#222222",gray:"#d2d6de"},screenSizes:{xs:480,sm:768,md:992,lg:1200}},_init:function(){"use strict";return $.LayoutManager.layout={activate:function(){var e=this;e.fix(),e.fixSidebar(),$(window,".wrapper").resize(function(){e.fix(),e.fixSidebar()})},fix:function(){var e,t=$(".main-header").outerHeight()+$(".main-footer").outerHeight(),r=$(window).height(),n=$(".sidebar").height();$("body").hasClass("fixed")?($(".content-wrapper, .right-side").css("min-height",r-$(".main-footer").outerHeight()),$(".content-wrapper, .right-side").css("height",r-$(".main-footer").outerHeight())):(e=void 0,e=n<=r?($(".content-wrapper, .right-side").css("min-height",r-t),r-t):($(".content-wrapper, .right-side").css("min-height",n),n),void 0!==(r=$($.LayoutManager.options.controlSidebarOptions.selector))&&r.height()>e&&$(".content-wrapper, .right-side").css("min-height",r.height()))},fixSidebar:function(){$("body").hasClass("fixed")?(void 0===$.fn.slimScroll&&window.console&&window.console.error("Error: the fixed layout requires the slimscroll plugin!"),$.LayoutManager.options.sidebarSlimScroll&&!isMobile.any?void 0!==$.fn.slimScroll&&($("#g3w-sidebar").slimScroll({destroy:!0}).height("auto"),$("#g3w-sidebar").slimScroll({touchScrollStep:50,height:$(window).height()-$(".navbar-header").height()-10+"px",color:"rgba(255,255,255,0.7)",size:"3px"})):($(".sidebar").css({height:$(window).height()-$(".navbar-header").height()+"px"}),$(".sidebar").css("overflow-y","auto"))):void 0!==$.fn.slimScroll&&$(".sidebar").slimScroll({destroy:!0}).height("auto")}},$.LayoutManager.pushMenu={activate:function(e){var t=$.LayoutManager.options.screenSizes;$(e).on("click",function(e){e.preventDefault(),$(window).width()>t.sm-1?$("body").hasClass("sidebar-collapse")?$("body").removeClass("sidebar-collapse").trigger("expanded.pushMenu"):$("body").addClass("sidebar-collapse").trigger("collapsed.pushMenu"):$("body").hasClass("sidebar-open")?$("body").removeClass("sidebar-open").removeClass("sidebar-collapse").trigger("collapsed.pushMenu"):$("body").addClass("sidebar-open").trigger("expanded.pushMenu")}),($.LayoutManager.options.sidebarExpandOnHover||$("body").hasClass("fixed")&&$("body").hasClass("sidebar-mini"))&&this.expandOnHover()},expandOnHover:function(){var e=this,t=$.LayoutManager.options.screenSizes.sm-1;$(".main-sidebar").hover(function(){$("body").hasClass("sidebar-mini")&&$("body").hasClass("sidebar-collapse")&&$(window).width()>t&&e.expand()},function(){$("body").hasClass("sidebar-mini")&&$("body").hasClass("sidebar-expanded-on-hover")&&$(window).width()>t&&e.collapse()})},expand:function(){$("body").removeClass("sidebar-collapse").addClass("sidebar-expanded-on-hover")},collapse:function(){$("body").hasClass("sidebar-expanded-on-hover")&&$("body").removeClass("sidebar-expanded-on-hover").addClass("sidebar-collapse")}},$.LayoutManager.tree=function(e){var a=this,o=$.LayoutManager.options.animationSpeed;$(document).on("click",e+" li a",function(e){var t,r,n=$(this),i=n.next();i.is(".treeview-menu")&&i.is(":visible")?i.slideUp(o,function(){i.parent("li.treeview").removeClass("active"),i.removeClass("menu-open")}):i.is(".treeview-menu")&&!i.is(":visible")&&(t=n.parents("ul").first(),n=(r=n.parent("li")).siblings(),t.height(),t.find("li.header").outerHeight(),r.outerHeight(),n.not(".header").each(function(e,t){$(t).find("a").outerHeight()}),t.find("ul.treeview-menu:visible").slideUp(o).removeClass("menu-open"),i.slideDown(o,function(){i.addClass("menu-open"),t.find("li.treeview.active").removeClass("active"),r.addClass("active"),a.layout.fix()})),i.is(".treeview-menu")&&e.preventDefault()})},$.LayoutManager.floatBar=$.LayoutManager.controlSidebar={activate:function(){var t=this,r=$.LayoutManager.options.controlSidebarOptions,n=$(r.selector),e=($(r.toggleBtnSelector).on("click",function(e){e.preventDefault(),n.hasClass("control-sidebar-open")||$("body").hasClass("control-sidebar-open")?t.close(n,r.slide):t.open(n,r.slide)}),$(".control-sidebar-bg"));t._fix(e),$("body").hasClass("fixed")?t._fixForFixed(n):$(".content-wrapper, .right-side").height()<n.height()&&t._fixForContent(n)},open:function(e,t){(t?e:$("body")).addClass("control-sidebar-open")},close:function(e,t){(t?e:$("body")).removeClass("control-sidebar-open")},_fix:function(e){var t=this;$("body").hasClass("layout-boxed")?(e.css("position","absolute"),e.height($(".wrapper").height()),$(window).resize(function(){t._fix(e)})):e.css({position:"fixed",height:"auto"})},_fixForFixed:function(e){e.css({position:"fixed","max-height":"100%","padding-bottom":"50px"})},_fixForContent:function(e){$(".content-wrapper, .right-side").css("min-height",e.height())}},$.LayoutManager.boxWidget={selectors:$.LayoutManager.options.boxWidgetOptions.boxWidgetSelectors,icons:$.LayoutManager.options.boxWidgetOptions.boxWidgetIcons,animationSpeed:$.LayoutManager.options.animationSpeed,activate:function(e){var t=this;e=e||document,$(e).on("click",t.selectors.collapse,function(e){e.preventDefault(),t.collapse($(this))}),$(e).on("click",t.selectors.remove,function(e){e.preventDefault(),t.remove($(this))})},collapse:function(e){var t=e.parents(".box").first(),r=t.find("> .box-body, > .box-footer, > form  >.box-body, > form > .box-footer");t.hasClass("collapsed-box")?(e.find(".btn-collapser").removeClass(this.icons.open).addClass(this.icons.collapse),r.slideDown(this.animationSpeed,function(){t.removeClass("collapsed-box")})):(e.find(".btn-collapser").removeClass(this.icons.collapse).addClass(this.icons.open),r.slideUp(this.animationSpeed,function(){t.addClass("collapsed-box")}))},remove:function(e){e.parents(".box").first().slideUp(this.animationSpeed)}},$.LayoutManager},addRefreshButton:function(){"use strict";return $.fn.boxRefresh=function(e){var r=$.extend({trigger:".refresh-btn",source:"",onLoadStart:function(e){return e},onLoadDone:function(e){return e}},e),n=$('<div class="overlay"><div class="fa fa-refresh fa-spin"></div></div>');return this.each(function(){var t;""===r.source?window.console&&window.console.log("Please specify a source first - boxRefresh()"):(t=$(this)).find(r.trigger).first().on("click",function(e){e.preventDefault(),(e=t).append(n),r.onLoadStart.call(e),t.find(".box-body").load(r.source,function(){var e;(e=t).find(n).remove(),r.onLoadDone.call(e)})})})},$.LayoutManager},activateBox:function(){"use strict";return $.fn.activateBox=function(){$.LayoutManager.boxWidget.activate(this)},$.LayoutManager},listCustomPlugin:function(){"use strict";return $.fn.todolist=function(e){var t=$.extend({onCheck:function(e){return e},onUncheck:function(e){return e}},e);return this.each(function(){void 0!==$.fn.iCheck?($("input",this).on("ifChecked",function(){var e=$(this).parents("li").first();e.toggleClass("done"),t.onCheck.call(e)}),$("input",this).on("ifUnchecked",function(){var e=$(this).parents("li").first();e.toggleClass("done"),t.onUncheck.call(e)})):$("input",this).on("change",function(){var e=$(this).parents("li").first();e.toggleClass("done"),($("input",e).is(":checked")?t.onCheck:t.onUncheck).call(e)})})},$.LayoutManager},setup:function(){"use strict";$("body").removeClass("hold-transition"),"undefined"!=typeof LayoutManagerOptions&&$.extend(!0,$.LayoutManager.options,LayoutManagerOptions);var e=$.LayoutManager.options;return $.LayoutManager._init(),$.LayoutManager.layout.activate(),$.LayoutManager.tree(".sidebar"),e.enableControlSidebar&&$.LayoutManager.controlSidebar.activate(),e.navbarMenuSlimscroll&&void 0!==$.fn.slimscroll&&$(".navbar .menu").slimscroll({height:e.navbarMenuHeight,alwaysVisible:!1,size:e.navbarMenuSlimscrollWidth}).css("width","100%"),e.sidebarPushMenu&&$.LayoutManager.pushMenu.activate(e.sidebarToggleSelector),e.enableBoxWidget&&$.LayoutManager.boxWidget.activate(),e.enableFastclick&&"undefined"!=typeof FastClick&&FastClick.attach(document.body),e.directChat.enable&&$(document).on("click",e.directChat.contactToggleSelector,function(){$(this).parents(".direct-chat").first().toggleClass("direct-chat-contacts-open")}),$('.btn-group[data-toggle="btn-toggle"]').each(function(){var t=$(this);$(this).find(".btn").on("click",function(e){t.find(".btn.active").removeClass("active"),$(this).addClass("active"),e.preventDefault()})}),$.LayoutManager.addRefreshButton().activateBox().listCustomPlugin()},loading:function(e){$("#initerror").remove(),(e=!_.isBoolean(e)||e)?$("body").append('\n          <div id="startingspinner">\n          <div class="double-bounce1"></div>\n          <div class="double-bounce2"></div>\n          </div>'):$("#startingspinner").remove()}};var g,v,m,y=$.LayoutManager,e=(r.default={name:"app",mixins:[o.resizeMixin],data:function(){return{customcredits:!1,appState:c.default.getState(),current_custom_modal_content:null,language:null,cookie_law_buttonText:h("cookie_law.buttonText")}},components:{HeaderItem:i.default,CookieLaw:n.default},computed:{app:function(){return this.appState.gui.app},languages:function(){var e;return 1<(e=Array.isArray(this.appconfig.i18n)&&this.appconfig.i18n||[]).length&&e},currentProject:function(){return a.default.getCurrentProject()},appconfig:function(){return c.default.getConfig()},isIframe:function(){return!!this.appconfig.group.layout.iframe},urls:function(){return this.appconfig.urls},staticurl:function(){return this.urls.staticurl},powered_by:function(){return this.appconfig.group.powered_by},clienturl:function(){return this.urls.clienturl},g3w_suite_logo:function(){return this.clienturl+"images/g3wsuite_logo.png"},credits_logo:function(){return this.clienturl+"images/logo_gis3w_156_85.png"},logo_url:function(){var e=this.currentProject.getThumbnail();return e||""+this.appconfig.mediaurl+this.appconfig.logo_img},logo_link:function(){return this.getLogoLink()||"#"},logo_link_target:function(){return this.getLogoLink()?"_blank":""},project_title:function(){return this.currentProject.getState().name},user:function(){return this.appconfig.user&&this.appconfig.user.username?this.appconfig.user:null},login_url:function(){return this.appconfig.user.login_url},numberOfProjectsInGroup:function(){return this.appconfig.projects.length},hasRelatedMaps:function(){return 1<this.appconfig.macrogroups.length+this.appconfig.groups.length+this.appconfig.projects.length},frontendurl:function(){return this.urls.frontendurl},main_title:function(){var e=this.appconfig.main_map_title,t=this.appconfig.group.name||this.appconfig.group.slug;return e?e+" - "+t:t}},methods:{templateResultLanguages:function(e){return e.id?$('\n        <div style="font-weight: bold; display:flex; align-items: center; justify-content: space-around;">\n          <img src="'+this.staticurl+"img/flags/"+e.element.value.toLowerCase()+'.png" />\n          <span style="margin-left: 5px;">'+e.text+"</span> \n        </span>"):e.text},resize:(m=l(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isIframe){e.next=5;break}return e.next=3,this.$nextTick();case 3:t=0<this.$refs.navbar_toggle.offsetWidth?this.$refs.navbar.offsetWidth-this.$refs.navbar_toggle.offsetWidth:this.$refs.mainnavbar.offsetWidth-this.$refs["app-navbar-nav"].offsetWidth,this.$refs.main_title_project_title.style.maxWidth=t-this.logoWidth-15+"px";case 5:case"end":return e.stop()}},e,this)})),function(){return m.apply(this,arguments)}),showCustomModalContent:function(t){var e=this.custom_modals.find(function(e){return e.id===t}).content;this.current_custom_modal_content=e},closePanel:function(){sidebarService.closePanel()},getLogoLink:function(){return this.appconfig.logo_link||null},openProjectsMenu:function(){d.default.openProjectsMenu()},initDialogMessages:(v=l(regeneratorRuntime.mark(function e(){var o,s,t,r,l=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.currentProject.getMessages()){e.next=3;break}return e.abrupt("return");case 3:s=this.currentProject.getId(),t=regeneratorRuntime.mark(function e(t){var r,n,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=o.items[t],void 0===(n=c.default.getLocalItem(p.LOCAL_ITEM_IDS.MESSAGES.id)||p.LOCAL_ITEM_IDS.MESSAGES.value)[s]&&(n[s]=[]),void 0!==n[s].find(function(e){return e===r.id}))return e.abrupt("return","continue");e.next=5;break;case 5:return i=new(Vue.extend({data:function(){return{id:f(),checked:!1}},template:'\n            <div style="display: flex; margin-top: 10px;">\n              <input :id="id"\n                v-model="checked"\n                class="magic-checkbox"\n                type="checkbox"/>\n              <label :for="id" v-t="\'dont_show_again\'"/>\n            </div>\n          '})),(a=document.createElement("div")).append.apply(a,function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}((new DOMParser).parseFromString(r.body,"text/html").body.childNodes)),a.append(i.$mount().$el),e.next=11,new Promise(function(e){d.default.showModalDialog({title:r.title,message:a,size:"large",closeButton:!1,className:"g3w-modal-project-message "+Object.entries(o.levels).find(function(e){e=u(e,2);e[0];return e[1]===r.level})[0],buttons:{close:{label:h("close"),className:"btn-secondary",callback:function(){i.checked&&(n[s].push(r.id),c.default.setLocalItem({id:p.LOCAL_ITEM_IDS.MESSAGES.id,data:n})),e()}}}})});case 11:case"end":return e.stop()}},e,l)}),r=0;case 6:if(r<o.items.length)return e.delegateYield(t(r),"t0",8);e.next=14;break;case 8:if("continue"===e.t0)return e.abrupt("continue",11);e.next=11;break;case 11:r++,e.next=6;break;case 14:case"end":return e.stop()}},e,this)})),function(){return v.apply(this,arguments)}),openChangeMapMenu:function(){d.default.openChangeMapMenu()}},watch:{language:function(e,t){t&&(c.default.changeLanguage(e),this.cookie_law_buttonText=h("cookie_law.buttonText"))}},beforeCreate:function(){this.delayType="debounce",this.delayTime=0},created:function(){var r=this;this.language=this.appconfig._i18n.language,this.custom_modals=[],this.custom_header_items_position={0:[],1:[],2:[],3:[],4:[]},this.customlinks=Array.isArray(this.appconfig.header_custom_links)?this.appconfig.header_custom_links.filter(function(e){var t;return null!==e&&(t=e.id=f(),"modal"===e.type&&r.custom_modals.push({id:t,content:e.content}),t=4<(t=+(e.position||0))?4:t<0||Number.isNaN(t)?0:t,r.custom_header_items_position[t].push(e),!0)}):[],this.appconfig.credits&&$.get(this.appconfig.credits).then(function(e){return r.customcredits="None"!==e&&e})},mounted:(g=l(regeneratorRuntime.mark(function e(){var t,r,n,i,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=function(){$(y.options.controlSidebarOptions.selector).css("max-height",$(window).innerHeight()),$(".g3w-sidebarpanel").css("height",$(window).height()-$("#main-navbar").height())},this.initDialogMessages(),this.logoWidth=0,e.next=5,this.$nextTick();case 5:for(t=this.isIframe?[]:this.$refs.mainnavbar.getElementsByTagName("ul"),r=t.length,this.rightNavbarWidth=15,n=0;n<r;n++)this.rightNavbarWidth+=t.item(n).offsetWidth;return this.language=this.appconfig.user.i18n,e.next=12,this.$nextTick();case 12:this.isIframe||this.$refs.img_logo.addEventListener("load",function(){a.logoWidth=a.$refs.img_logo.offsetWidth+15,a.resize()},{once:!0}),y.loading(!1),y.setup(),y.pushMenu.expandOnHover(),y.controlSidebar._fix($(".control-sidebar-bg")),y.controlSidebar._fix($(".control-sidebar")),i(),$(window).resize(function(){i(),$("#g3w-modal-overlay").css("height",$(window).height())});case 20:case"end":return e.stop()}},e,this)})),function(){return g.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default),"function"==typeof t.exports?t.exports.options:t.exports);e.render=function(){var r=this,e=r.$createElement,t=r._self._c||e;return t("div",{directives:[{name:"disabled",rawName:"v-disabled",value:r.app.disabled,expression:"app.disabled"}],staticClass:"wrapper"},[t("cookie-law",{attrs:{theme:"dark-lime",buttonText:r.cookie_law_buttonText}},[t("div",{directives:[{name:"t",rawName:"v-t",value:"cookie_law.message",expression:"'cookie_law.message'"}],attrs:{slot:"message"},slot:"message"})]),r._v(" "),r.isIframe?r._e():t("header",{staticClass:"main-header"},[t("nav",{ref:"navbar",staticClass:"navbar navbar-inverse navbar-fixed-top",attrs:{role:"navigation"}},[t("div",{staticClass:"container-fluid"},[t("div",{staticClass:"navbar-header"},[t("button",{ref:"navbar_toggle",staticClass:"navbar-toggle",attrs:{type:"button","data-toggle":"collapse","data-target":"#main-navbar"}},[t("i",{class:r.g3wtemplate.getFontClass("ellips-v"),staticStyle:{"font-size":"1.3em"}})]),r._v(" "),t("a",{staticClass:"sidebar-toggle",attrs:{id:"g3w-small-screen-hamburger-sidebar",href:"#","data-toggle":"offcanvas",role:"button"}},[t("i",{class:r.g3wtemplate.getFontClass("bars"),staticStyle:{"font-size":"1.3em"}})]),r._v(" "),t("div",{staticClass:"logo-wrapper",class:{mobile:r.isMobile()}},[r.logo_url?t("a",{staticClass:"project_logo_link",attrs:{href:r.logo_link,target:r.logo_link_target}},[t("img",{ref:"img_logo",staticClass:"img-responsive",staticStyle:{"max-width":"250px"},attrs:{src:r.logo_url}})]):r._e(),r._v(" "),t("div",{ref:"main_title_project_title",staticClass:"project_title_content"},[t("div",{staticClass:"main_title"},[r._v(r._s(r.main_title))]),r._v(" "),t("div",{staticClass:"sub_title"},[r._v(r._s(r.project_title))])])])]),r._v(" "),t("div",{ref:"mainnavbar",staticClass:"collapse navbar-collapse",staticStyle:{"text-align":"center",overflow:"hidden",margin:"0 0"},attrs:{id:"main-navbar"}},[t("navbarleftitems"),r._v(" "),t("navbarrightitems"),r._v(" "),t("ul",{ref:"app-navbar-nav",staticClass:"nav navbar-nav navbar-right app-navbar-nav"},[r.user?r._e():t("li",{staticClass:"dropdown user user-menu"},[t("a",{attrs:{href:r.login_url}},[t("i",{class:r.g3wtemplate.getFontClass("sign-in"),attrs:{"aria-hidden":"true"}}),r._v(" "),t("span",{directives:[{name:"t",rawName:"v-t",value:"sign_in",expression:"'sign_in'"}]})])]),r._v(" "),r._l(r.custom_header_items_position[0],function(e){return t("header-item",{key:e.id,attrs:{state:e},on:{"show-custom-modal-content":r.showCustomModalContent}})}),r._v(" "),r.hasRelatedMaps?t("li",{staticClass:"dropdown user",attrs:{id:"changemaps"}},[t("a",{staticClass:"dropdown-toggle",attrs:{href:"#","data-toggle":"dropdown"},on:{click:r.openChangeMapMenu}},[t("i",{class:r.g3wtemplate.getFontClass("change-map"),attrs:{"aria-hidden":"true"}}),r._v(" "),t("span",{directives:[{name:"t",rawName:"v-t",value:"changemap",expression:"'changemap'"}]})])]):r._e(),r._v(" "),r._l(r.custom_header_items_position[1],function(e){return t("header-item",{key:e.id,attrs:{state:e},on:{"show-custom-modal-content":r.showCustomModalContent}})}),r._v(" "),r.user?t("li",{staticClass:"dropdown user user-menu"},[t("a",{staticClass:"dropdown-toggle",attrs:{href:"#","data-toggle":"dropdown"}},[t("i",{class:r.g3wtemplate.getFontClass("user")}),r._v(" "),t("span",{staticClass:"hidden-xs"},[r._v(r._s(r.user.username))])]),r._v(" "),t("ul",{staticClass:"dropdown-menu"},[t("li",{staticClass:"user-header"},[t("p",[r._v("\n                    "+r._s(r.user.first_name)+" "+r._s(r.user.last_name)+"\n                  ")])]),r._v(" "),t("li",{staticClass:"user-footer"},[r.user.admin_url?t("div",{staticClass:"pull-left"},[t("a",{staticClass:"btn btn-default btn-flat skin-color bold",attrs:{href:r.user.admin_url}},[t("i",{class:r.g3wtemplate.getFontClass("folder")}),r._v(" Admin\n                    ")])]):r._e(),r._v(" "),t("div",{staticClass:"pull-right"},[t("a",{directives:[{name:"t",rawName:"v-t",value:"logout",expression:"'logout'"}],staticClass:"btn btn-default btn-flat skin-color bold",attrs:{href:r.user.logout_url}},[t("i",{class:r.g3wtemplate.getFontClass("sign-out"),staticStyle:{"margin-right":"2px"}})])])])])]):r._e(),r._v(" "),r._l(r.custom_header_items_position[2],function(e){return t("header-item",{key:e.id,attrs:{state:e},on:{"show-custom-modal-content":r.showCustomModalContent}})}),r._v(" "),t("li",{staticClass:"dropdown user user-menu"},[t("a",{staticClass:"dropdown-toggle",attrs:{href:"#","data-toggle":"modal","data-target":"#credits"}},[t("i",{class:r.g3wtemplate.getFontClass("credits"),attrs:{"aria-hidden":"true"}}),r._v(" "),t("span",[r._v("Credits")])])]),r._v(" "),r._l(r.custom_header_items_position[3],function(e){return t("header-item",{key:e.id,attrs:{state:e},on:{"show-custom-modal-content":r.showCustomModalContent}})}),r._v(" "),r.languages?t("li",{staticClass:"g3w-languages"},[t("select",{directives:[{name:"select2",rawName:"v-select2",value:"language",expression:"'language'"},{name:"model",rawName:"v-model",value:r.language,expression:"language"}],staticClass:"form-control",staticStyle:{cursor:"pointer",width:"130px"},attrs:{templateSelection:r.templateResultLanguages,templateResult:r.templateResultLanguages},on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});r.language=e.target.multiple?t:t[0]}}},r._l(r.languages,function(e){return t("option",{key:e[0],domProps:{value:e[0],selected:e[0]===r.language&&"selected"}},[r._v("\n                  "+r._s(e[1])+"\n                ")])}),0)]):r._e(),r._v(" "),r.frontendurl?t("li",{staticClass:"dropdown"},[t("a",{attrs:{href:r.frontendurl}},[t("span",[t("i",{class:r.g3wtemplate.getFontClass("home")}),r._v(" Home")])])]):r._e(),r._v(" "),r._l(r.custom_header_items_position[4],function(e){return t("header-item",{key:e.id,attrs:{state:e},on:{"show-custom-modal-content":r.showCustomModalContent}})})],2)],1)])])]),r._v(" "),t("sidebar"),r._v(" "),t("div",{staticClass:"content-wrapper",style:{paddingTop:r.isIframe?0:null}},[t("viewport",{attrs:{appState:r.appState}})],1),r._v(" "),t("floatbar"),r._v(" "),t("div",{staticClass:"control-sidebar-bg"}),r._v(" "),t("div",{staticClass:"modal fade modal-fullscreen force-fullscreen",attrs:{id:"full-screen-modal",tabindex:"-1",role:"dialog","data-backdrop":"static","data-keyboard":"false","aria-labelledby":"full-screen-modal","aria-hidden":"true"}}),r._v(" "),t("div",{staticClass:"modal fade",attrs:{id:"credits"}},[t("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[t("div",{staticClass:"modal-content"},[t("div",{staticClass:"modal-header"},[r._m(0),r._v(" "),t("div",{staticStyle:{display:"flex","flex-direction":"column","justify-content":"space-around","justify-items":"center","align-items":"center"}},[r.customcredits?t("div",{staticClass:"customcredits",domProps:{innerHTML:r._s(r.customcredits)}}):r._e(),r._v(" "),r.powered_by?t("div",[t("div",{staticClass:"g3w-credits-block"},[t("div",{directives:[{name:"t",rawName:"v-t",value:"credits.g3wSuiteFramework",expression:"'credits.g3wSuiteFramework'"}],staticClass:"credit-title-logo",staticStyle:{"background-color":"#95ad36",padding:"5px","border-radius":"3px",color:"#ffffff"}}),r._v(" "),t("a",{attrs:{target:"_blank",href:"https://g3wsuite.it/"}},[t("img",{staticClass:"g3w-suite-logo",attrs:{src:r.g3w_suite_logo,alt:""}})]),r._v(" "),t("div",{directives:[{name:"t",rawName:"v-t",value:"credits.g3wSuiteDescription",expression:"'credits.g3wSuiteDescription'"}],staticStyle:{"margin-top":"10px"}})]),r._v(" "),t("div",{directives:[{name:"t",rawName:"v-t:pre",value:"credits.productOf",expression:"'credits.productOf'",arg:"pre"}],staticClass:"credit-title-logo g3w-credits-block",staticStyle:{"font-size":"1em",display:"flex","justify-content":"center"}},[t("a",{staticStyle:{"text-align":"center!important"},attrs:{href:"http://www.gis3w.it",target:"_blank"}},[t("img",{staticClass:"img-responsive center-block",staticStyle:{"margin-left":"5px"},attrs:{width:"60",src:r.credits_logo,alt:""}})])]),r._v(" "),t("address",{staticStyle:{"line-height":"1.3","text-align":"center","margin-top":"5px",display:"flex","justify-content":"center"},attrs:{id:"address-credits"}},[t("span",{staticStyle:{padding:"2px"}},[t("span",{class:r.g3wtemplate.getFontClass("marker"),staticStyle:{color:"#95ad36","font-weight":"bold"},attrs:{"aria-hidden":"true"}}),r._v(" Montecatini Terme - Italy\n                ")]),r._v(" "),t("span",{staticStyle:{padding:"2px"}},[t("span",{class:r.g3wtemplate.getFontClass("mobile"),staticStyle:{color:"#95ad36"},attrs:{"aria-hidden":"true"}}),r._v("  +39 393 8534336\n                ")]),r._v(" "),t("span",{staticStyle:{padding:"2px"}},[t("span",{class:r.g3wtemplate.getFontClass("mail"),staticStyle:{color:"#95ad36"},attrs:{"aria-hidden":"true"}}),r._v(" "),t("a",{staticStyle:{color:"#000000"},attrs:{href:"mailto:info@gis3w.it"}},[r._v(" info@gis3w.it")])])])]):r._e()])])])])]),r._v(" "),t("div",{staticClass:"modal fade",attrs:{id:"custom_modal"}},[t("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[t("div",{staticClass:"modal-content",domProps:{innerHTML:r._s(r.current_custom_modal_content)}})])])],1)},e.staticRenderFns=[function(){var e=this.$createElement,e=this._self._c||e;return e("button",{staticClass:"close",staticStyle:{color:"#ffffff","font-weight":"bold",opacity:"1",position:"absolute",right:"25px",top:"20px"},attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[e("span",{attrs:{"aria-hidden":"true"}},[this._v("×")])])}]},{"components/HeaderItem.vue":233,constant:4,"core/i18n/i18n.service":13,"core/utils/utils":68,mixins:343,"services/application":351,"services/gui":361,"store/projects":379,"vue-cookie-law":"vue-cookie-law"}],195:[function(e,t,r){function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function i(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=e("services/gui"),o=(u=u)&&u.__esModule?u:{default:u},l=e("core/utils/utils").getUniqueDomId,r.default={name:"c3xyline",props:{showdata:{type:Boolean,default:!0}},data:function(){return{id:"graphline"+l(),selectitems:[],data:[],components:[],config:{data:{columns:[["x"],["y"]]}},size:{width:0,height:0}}},methods:{addComponent:function(e){this.components.push(e)},addComponents:function(){var t=this;(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(e){return t.addComponent(e)})},setConfig:function(){this.config=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}},setDataOffset:function(e){for(var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=this.getData(),n=0;n<r.length;n++)r[n].value+=e;t&&this.resize()},getSelectedItems:function(){return this.selectitems},selectItem:function(e){this.chart.select(["y"],[e])},unselectItem:function(e){this.chart.unselect(["y"],[e])},selectItems:function(){this.chart.select([y],0<arguments.length&&void 0!==arguments[0]?arguments[0]:[])},unselectItems:function(){this.chart.unselect(["y"],0<arguments.length&&void 0!==arguments[0]?arguments[0]:[])},unselectAll:function(){this.chart.unselect()},selectAll:function(){this.chart.select()},getData:function(){return this.data},resize:(s=i(regeneratorRuntime.mark(function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.width,n=t.height;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.chart.resize({width:r,height:n||$("#"+this.id).height()-4});case 3:case"end":return e.stop()}},e,this)})),function(){return s.apply(this,arguments)}),_setAllowedSpace:function(){this.components&&this.components.length&&(this.size.height=document.querySelector(".g3wform_content").offsetHeight-this.$el.offsetHeight-document.querySelector(".g3wform_header").offsetHeight-50)},_setMaxMin:function(e){var t=e.value,r=e.max,e=e.min,r=t?+t:+r;(e=t?+t:+e)<this.chart.axis.min().y?this.chart.axis.min(e):r>this.chart.axis.max().y?this.chart.axis.max(r):(t=this.data.map(function(e){return+e.value}),this.chart.axis.max(Math.max.apply(Math,n(t))),this.chart.axis.min(Math.min.apply(Math,n(t)))),this.resize()},changeItems:function(e){var t;1===e.length?this._setMaxMin(e[0].value):(t=Math.max.apply(Math,n(e.map(function(e){return+e.value}))),e=Math.min.apply(Math,n(e.map(function(e){return+e.value}))),this._setMaxMin({max:t,min:e})),this.resize()},changeItem:function(e){var t=e.item,e=e.render,e=void 0===e||e,t=t.value;this._setMaxMin({value:t}),e&&this.resize()}},mounted:function(){var t=this;this.$nextTick(function(){o.default.on("resize",t.resize);var r=t;t.config.data.onselected=function(e){e=[].concat(n(r.selectitems),[e]);r.selectitems=e},t.config.data.onunselected=function(t){r.selectitems=r.selectitems.filter(function(e){return e.index!==t.index})},t.chart=c3.generate(a({bindto:"#"+t.id},t.config)),(t.chart.data()[0]?t.chart.data()[0].values:[]).forEach(function(e){t.data.push(e)}),t._setAllowedSpace(),t.$emit("chart-ready",t.chart)})},beforeDestroy:function(){this.data=this.selectitems=null,this.chart.destroy(),this.chart=null,o.default.off("resize",this.resize)}},t.exports.__esModule&&(t.exports=t.exports.default);var a,o,s,l,u="function"==typeof t.exports?t.exports.options:t.exports;u.render=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"chart_wrapper",staticStyle:{height:"100%",width:"100%"}},[r("div",{staticStyle:{height:"100%","min-height":"200px","background-color":"#ffffff"},attrs:{id:t.id}}),t._v(" "),t._l(t.components,function(e){return r("div",[r("span",{staticClass:"divider"}),t._v(" "),r(e,{tag:"component",attrs:{data:t.data,selectitems:t.selectitems,size:t.size},on:{"change-item":t.changeItem,"change-items":t.changeItems,"select-item":t.selectItem,"select-all":t.selectAll,"unselect-all":t.unselectAll,"unselect-item":t.unselectItem}})],1)})],2)},u.staticRenderFns=[]},{"core/utils/utils":68,"services/gui":361}],196:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),a=e("app/constant"),o=n(e("gui/catalog/vue/catalogeventhub")),s=n(e("components/CatalogChangeMapThemes.vue")),l=n(e("components/CatalogLayerContextMenu.vue")),u=n(e("store/catalog-layers")),c=n(e("services/application")),d=n(e("store/map-controls")),p=n(e("services/gui")),r.default={name:"catalog",data:function(){return this.$options.legend.place=c.default.getCurrentProject().getLegendPosition()||"tab",{state:null,legend:this.$options.legend,showlegend:!1,currentBaseLayer:null,activeTab:null,loading:!1}},components:{changemapthemes:s.default,cataloglayercontextmenu:l.default},computed:{showTocTools:function(){var e=this.project.state.map_themes;return 1<(void 0===e?[]:e).length},project:function(){return this.state.prstate.currentProject},title:function(){return this.project.state.name},baselayers:function(){return this.project.state.baselayers},hasBaseLayers:function(){return 0<this.project.state.baselayers.length},hasLayers:function(){var t=0;return this.state.layerstrees.forEach(function(e){return t+=e.tree.length}),0<this.state.external.vector.length||0<t||0<this.state.layersgroups.length}},methods:{changeMapTheme:(h=i(regeneratorRuntime.mark(function e(t){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return p.default.closeContent(),e.next=3,this.$options.service.changeMapTheme(t);case 3:r=e.sent,n=Object.keys(r.layers).filter(function(e){if(r.layers[e].style)return r.layers[e].visible||((e=u.default.getLayerById(e)).clearCategories(),e.change()),!0}),"tab"===this.legend.place?o.default.$emit("layer-change-style"):n.forEach(function(e){o.default.$emit("layer-change-style",{layerId:e})});case 6:case"end":return e.stop()}},e,this)})),function(e){return h.apply(this,arguments)}),delegationClickEventTab:function(e){this.activeTab=e.target.attributes["aria-controls"]?e.target.attributes["aria-controls"].value:this.activeTab},showLegend:function(e){this.showlegend=e},setBaseLayer:function(e){this.currentBaseLayer=e,this.project.setBaseLayer(e),c.default.setBaseLayerId(e)},getSrcBaseLayerImage:function(e){var t=void 0,r=!1;switch(e&&e.servertype||e){case"OSM":t="osm.png";break;case"Bing":t="bing"+e.source.subtype+".png";break;case"TMS":case"WMTS":if(e.icon){r=!0,t=e.icon;break}default:t="nobaselayer.png"}return r?t:p.default.getResourcesUrl()+"images/"+t}},watch:{"state.external.wms":function(e,t){t&&0===e.length&&(this.activeTab=this.project.state.catalog_tab||"layers")},"state.prstate.currentProject":{handler:(f=i(regeneratorRuntime.mark(function e(t,r){var n,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.state.catalog_tab||"layers",this.loading="baselayers"===n,e.next=4,this.$nextTick();case 4:setTimeout(function(){i.loading=!1,i.activeTab=n},"baselayers"===n?500:0);case 5:case"end":return e.stop()}},e,this)})),function(e,t){return f.apply(this,arguments)}),immediate:!1}},created:function(){var r,n=this;this.layerpositions=a.MAP_SETTINGS.LAYER_POSITIONS.getPositions(),o.default.$on("unselectionlayer",function(e,t){t.external?p.default.getService("queryresults").clearSelectionExtenalLayer(t):u.default.getLayersStore(e).getLayerById(t.id).clearSelectionFids()}),o.default.$on("activefiltertokenlayer",(r=i(regeneratorRuntime.mark(function e(t,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.default.getLayersStore(t).getLayerById(r.id).toggleFilterToken();case 2:r.filter.active=e.sent;case 3:case"end":return e.stop()}},e,n)})),function(e,t){return r.apply(this,arguments)})),o.default.$on("treenodevisible",function(e){p.default.getService("map").emit("cataloglayervisible",e)}),o.default.$on("treenodeselected",function(e,t){var r=u.default.getLayersStore(e).getLayerById(t.id);r.isSelected()||p.default.getService("catalog").setSelectedExternalLayer({layer:null,type:"vector",selected:!1}),setTimeout(function(){u.default.getLayersStore(e).selectLayer(t.id,!r.isSelected()),p.default.getService("map").emit("cataloglayerselected",r)})}),o.default.$on("treenodeexternalselected",function(e){p.default.getService("catalog").setSelectedExternalLayer({layer:e,type:"vector",selected:!e.selected}).then(function(){e.selected&&u.default.getLayersStores().forEach(function(e){e.selectLayer(null,!1)})})}),d.default.onafter("registerControl",function(e,t){"querybbox"===e&&t.getInteraction().on("propertychange",function(e){"active"===e.key&&(n.state.highlightlayers=!e.oldValue)})})},beforeMount:function(){this.currentBaseLayer=this.project.state.initbaselayer}},t.exports.__esModule&&(t.exports=t.exports.default);var a,o,s,l,u,c,d,p,f,h,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("div",{staticClass:"tabbable-panel catalog",attrs:{id:"catalog"},on:{contextmenu:function(e){e.preventDefault(),e.stopPropagation()}}},[n("div",{staticClass:"tabbable-line"},[n("ul",{staticClass:"nav nav-tabs catalalog-nav-tabs",attrs:{role:"tablist"},on:{"!click":function(e){return r.delegationClickEventTab(e)}}},[r.hasLayers?n("li",{class:{active:"layers"===r.activeTab&&"hasLayers"},attrs:{role:"presentation"}},[n("a",{directives:[{name:"t",rawName:"v-t",value:"data",expression:"'data'"}],attrs:{href:"#layers","aria-controls":"layers",role:"tab","data-toggle":"tab","data-i18n":"tree"}})]):r._e(),r._v(" "),r.state.external.wms.length?n("li",{class:{active:"externalwms"===r.activeTab},attrs:{role:"presentation"}},[n("a",{directives:[{name:"t",rawName:"v-t",value:"externalwms",expression:"'externalwms'"}],attrs:{href:"#externalwms","aria-controls":"externalwms",role:"tab","data-toggle":"tab","data-i18n":"externalwms"}})]):r._e(),r._v(" "),r.hasBaseLayers?n("li",{class:{active:"baselayers"===r.activeTab},attrs:{role:"presentation"}},[n("a",{directives:[{name:"t",rawName:"v-t",value:"baselayers",expression:"'baselayers'"}],attrs:{href:"#baselayers","aria-controls":"baselayers",role:"tab","data-toggle":"tab","data-i18n":"baselayers"}})]):r._e(),r._v(" "),r.showlegend&&"tab"===r.legend.place?n("li",{class:{active:"legend"===r.activeTab},attrs:{role:"presentation"}},[n("a",{directives:[{name:"t",rawName:"v-t",value:"legend",expression:"'legend'"}],attrs:{href:"#legend","aria-controls":"legend",role:"tab","data-toggle":"tab","data-i18n":"legend"}})]):r._e()]),r._v(" "),n("div",{staticClass:"tab-content catalog-tab-content"},[n("bar-loader",{attrs:{loading:r.loading}}),r._v(" "),n("div",{staticClass:"tab-pane",class:{active:"layers"===r.activeTab&&"hasLayers"},attrs:{role:"tabpanel",id:"layers"}},[n("helpdiv",{attrs:{message:"catalog_items.helptext"}}),r._v(" "),r.showTocTools?n("div",{staticStyle:{margin:"2px"},attrs:{id:"g3w-catalog-toc-layers-toolbar"}},[n("changemapthemes",{key:r.project.state.gid,attrs:{map_themes:r.project.state.map_themes},on:{"change-map-theme":r.changeMapTheme}})],1):r._e(),r._v(" "),r._l(r.state.layerstrees,function(t){return n("ul",{key:t.storeid,staticClass:"tree-root root project-root"},r._l(t.tree,function(e){return n("tristate-tree",{key:e.id,staticClass:"item",attrs:{highlightlayers:r.state.highlightlayers,layerstree:e,parentFolder:!1,root:!0,legendplace:r.legend.place,parent_mutually_exclusive:!1,storeid:t.storeid}})}),1)}),r._v(" "),r.state.external.vector.length?n("ul",{staticClass:"g3w-external_layers-group"},r._l(r.state.external.vector,function(e){return n("tristate-tree",{key:e.id,staticClass:"item",attrs:{externallayers:r.state.external.vector,layerstree:e}})}),1):r._e(),r._v(" "),r._l(r.state.layersgroups,function(e){return n("ul",[n("layers-group",{attrs:{layersgroup:e}})],1)})],2),r._v(" "),r.state.external.wms.length?n("div",{staticClass:"tab-pane",class:{active:"externalwms"===r.activeTab},attrs:{id:"externalwms",role:"tabpanel"}},[n("ul",{staticClass:"g3w-external_wms_layers-group"},r._l(r.state.external.wms,function(e){return n("tristate-tree",{key:e.id,staticClass:"item",attrs:{externallayers:r.state.external.wms,layerstree:e}})}),1)]):r._e(),r._v(" "),r.hasBaseLayers?n("div",{staticClass:"tab-pane baselayers",class:{active:"baselayers"===r.activeTab||!r.hasLayers},attrs:{id:"baselayers",role:"tabpanel"}},[n("ul",{class:{mobile:r.isMobile()},style:{gridTemplateColumns:"repeat(auto-fill, minmax("+(4<r.baselayers.length?80:120)+"px, 1fr))"},attrs:{id:"baselayers-content"}},[r._l(r.baselayers,function(t){return t.fixed?r._e():n("li",{key:t.title},[n("img",{staticClass:"img-responsive img-thumbnail baselayer",style:{opacity:t.id===r.currentBaseLayer?1:.5},attrs:{src:r.getSrcBaseLayerImage(t)},on:{click:function(e){return e.stopPropagation(),r.setBaseLayer(t.id)}}}),r._v(" "),n("div",{staticClass:"baseselayer-text text-center"},[r._v(r._s(t.title))])])}),r._v(" "),n("li",{on:{click:function(e){return e.stopPropagation(),r.setBaseLayer(null)}}},[n("img",{staticClass:"img-responsive img-thumbnail baselayer",style:{opacity:null===r.currentBaseLayer?1:.5},attrs:{src:r.getSrcBaseLayerImage(null)}}),r._v(" "),n("div",{directives:[{name:"t",rawName:"v-t",value:"nobaselayer",expression:"'nobaselayer'"}],staticClass:"baseselayer-text text-center"})])],2)]):r._e(),r._v(" "),r._l(r.state.layerstrees,function(e){return"tab"===r.legend.place?n("layerslegend",{key:e.id,attrs:{legend:r.legend,active:"legend"===r.activeTab,layerstree:e},on:{showlegend:r.showLegend}}):r._e()})],2)]),r._v(" "),n("cataloglayercontextmenu",{attrs:{external:r.state.external}})],1)},e.staticRenderFns=[]},{"app/constant":4,"components/CatalogChangeMapThemes.vue":197,"components/CatalogLayerContextMenu.vue":198,"gui/catalog/vue/catalogeventhub":114,"services/application":351,"services/gui":361,"store/catalog-layers":374,"store/map-controls":376}],197:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),e=e("store/projects"),n=(e=e)&&e.__esModule?e:{default:e},r.default={name:"changemapthemes",data:function(){var e="collapsed"===n.default.getCurrentProject().state.toc_themes_init_status,t=this.map_themes.find(function(e){return e.default});return{current_map_theme:t?t.theme:null,collapsed:e}},props:{map_themes:{type:Array,default:[]}},watch:{current_map_theme:{immediate:!1,handler:function(e){this.$emit("change-map-theme",e)}}}},t.exports.__esModule&&(t.exports=t.exports.default);var n,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("ul",{staticClass:"sidebar-menu"},[n("li",{staticClass:"treeview sidebaritem skin-border-color",staticStyle:{"margin-bottom":"5px","border-bottom":"2px solid"},attrs:{id:"g3w-catalog-toc-views"}},[n("a",{ref:"g3w-map-theme-ancor",staticStyle:{display:"flex","align-items":"center",padding:"5px 5px 5px 2px"},attrs:{href:"#"}},[n("i",{class:r.g3wtemplate.getFontClass("caret-down"),staticStyle:{padding:"3px"}}),r._v(" "),n("i",{class:r.g3wtemplate.getFontClass("eye"),staticStyle:{padding:"0 0 0 4px"}}),r._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:r.current_map_theme,expression:"current_map_theme "}],staticClass:"treeview-label g3w-long-text",staticStyle:{overflow:"hidden","white-space":"normal","text-overflow":"ellipsis"}},[n("span",{directives:[{name:"t",rawName:"v-t:pre",value:"sdk.catalog.current_map_theme_prefix",expression:"'sdk.catalog.current_map_theme_prefix'",arg:"pre"}],staticStyle:{color:"#cccccc !important"}},[r._v(":")]),r._v(" "),n("span",{staticClass:"skin-color",staticStyle:{"font-size":"1.1em"}},[r._v(r._s(r.current_map_theme))])]),r._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:!r.current_map_theme,expression:"!current_map_theme"}],staticClass:"treeview-label",staticStyle:{color:"#cccccc !important","font-weight":"bold"}},[n("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.choose_map_theme",expression:"'sdk.catalog.choose_map_theme'"}]})])]),r._v(" "),n("ul",{staticClass:"treeview-menu",class:{"menu-open":!r.collapsed},style:{display:r.collapsed?"none":"block"},attrs:{id:"g3w-catalog-views"}},[n("li",{staticStyle:{padding:"5px 5px 5px 17px"}},r._l(r.map_themes,function(t,e){return n("div",{key:t.theme},[n("input",{directives:[{name:"model",rawName:"v-model",value:r.current_map_theme,expression:"current_map_theme"}],staticClass:"magic-radio",attrs:{type:"radio",name:"radio",id:"g3w-map_theme-"+e},domProps:{value:t.theme,checked:t.default,checked:r._q(r.current_map_theme,t.theme)},on:{change:function(e){r.current_map_theme=t.theme}}}),r._v(" "),n("label",{staticStyle:{display:"flex","justify-content":"space-between"},attrs:{for:"g3w-map_theme-"+e}},[n("span",{staticClass:"g3w-long-text"},[r._v(r._s(t.theme))])])])}),0)])])])},e.staticRenderFns=[]},{"store/projects":379}],198:[function(e,t,r){var n,i,a,o,s,l,u,c,d,p,f,h,g,v,m,y;e("vueify/lib/insert-css").insert("li .item-text[data-v-601a8731]{font-weight:700}");function _(e){return e&&e.__esModule?e:{default:e}}function b(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=e("vue-color"),a=_(e("components/LayerOpacityPicker.vue")),o=_(e("gui/catalog/vue/catalogeventhub")),s=_(e("store/catalog-layers")),l=_(e("services/application")),u=_(e("services/gui")),h=e("core/i18n/i18n.service").t,g=e("shp-write"),v=e("gui/table/vue/table"),m=e("core/utils/utils").downloadFile,y=15,r.default={name:"Cataloglayermenu",props:{external:{type:Object}},data:function(){return{layerMenu:{show:!1,top:0,left:0,tooltip:!1,name:"",layer:null,loading:{data_table:!1,shp:!1,csv:!1,gpx:!1,gpkg:!1,xls:!1},colorMenu:{show:!1,top:0,left:0,color:null},stylesMenu:{show:!1,top:0,left:0,style:null,default:null},metadatainfoMenu:{show:!1,top:0,left:0}}}},components:{"chrome-picker":i.Chrome,"layer-opacity-picker":a.default},directives:{"click-outside-layer-menu":{bind:function(t,r,n){this.event=function(e){t===e.target||t.contains(e.target)||(e.stopPropagation(),n.context[r.expression](e))},document.body.addEventListener("click",this.event,!0)},unbind:function(e){document.body.removeEventListener("click",this.event,!0)}}},methods:{addLayerMenuItem:function(){this.layerMenu=n({},this.layerMenu,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},_hideMenu:function(){this.layerMenu.show=!1,this.layerMenu.styles=!1,this.layerMenu.loading.data_table=!1,this.layerMenu.loading.shp=!1,this.layerMenu.loading.csv=!1,this.layerMenu.loading.gpx=!1,this.layerMenu.loading.gpkg=!1,this.layerMenu.loading.xls=!1,this.layerMenu.loading.geotiff=!1,this.layerMenu.loading.unknow=!1},closeLayerMenu:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._hideMenu(),this.showColorMenu(!1),e.show=!1},onbeforeDestroyChangeColor:function(){this.$refs.color_picker.$off()},onChangeColor:function(e){var t=u.default.getService("map"),t=(this.layerMenu.layer.color=e,t.getLayerByName(this.layerMenu.name)),r=t.getStyle();r._g3w_options.color=e,t.setStyle(r)},canShowWmsUrl:function(e){e=s.default.getLayerById(e);return!!e&&!(e.isType("table")||!e.getFullWmsUrl())},canShowWfsUrl:function(e){e=s.default.getLayerById(e);return e&&!e.isType("table")&&e.isWfsActive()},canDownloadXls:function(e){e=s.default.getLayerById(e);return!!e&&e.isXlsDownlodable()},canDownloadGpx:function(e){e=s.default.getLayerById(e);return!!e&&e.isGpxDownlodable()},canDownloadGpkg:function(e){e=s.default.getLayerById(e);return!!e&&e.isGpkgDownlodable()},canDownloadCsv:function(e){e=s.default.getLayerById(e);return!!e&&e.isCsvDownlodable()},canDownloadGeoTIFF:function(e){e=s.default.getLayerById(e);return!!e&&e.isGeoTIFFDownlodable()},canDownloadShp:function(e){e=s.default.getLayerById(e);return!!e&&e.isShpDownlodable()},getWmsUrl:function(e){return s.default.getLayerById(e).getCatalogWmsUrl()},getWfsUrl:function(e){return s.default.getLayerById(e).getCatalogWfsUrl()},copyUrl:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.evt,n=t.layerId,t=this["get"+t.type+"Url"](n),n=document.createElement("a"),t=(n.href=t,document.createElement("input"));t.value=n.href,document.body.appendChild(t),t.select(),document.execCommand("copy"),$(r.target).attr("data-original-title",h("sdk.catalog.menu.wms.copied")).tooltip("show"),$(r.target).attr("title",this.copywmsurltooltip).tooltip("fixTitle"),document.body.removeChild(t),n=null,setTimeout(function(){return e._hideMenu()},600)},downloadGeoTIFF:function(e){var t=this,r=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=l.default.setDownload(!0);this.layerMenu.loading.geotiff=!0,s.default.getLayerById(e).getGeoTIFF({data:r?{map_extent:u.default.getService("map").getMapExtent().toString()}:void 0}).catch(function(e){return u.default.notify.error(h("info.server_error"))}).finally(function(){t.layerMenu.loading.geotiff=!1,l.default.setDownload(!1,n),t._hideMenu()})},downloadShp:function(e){var t=this,r=l.default.setDownload(!0);this.layerMenu.loading.shp=!0,s.default.getLayerById(e).getShp().catch(function(e){return u.default.notify.error(h("info.server_error"))}).finally(function(){t.layerMenu.loading.shp=!1,l.default.setDownload(!1,r),t._hideMenu()})},downloadCsv:function(e){var t=this,r=l.default.setDownload(!0);this.layerMenu.loading.csv=!0,s.default.getLayerById(e).getCsv().catch(function(e){return u.default.notify.error(h("info.server_error"))}).finally(function(){t.layerMenu.loading.csv=!1,l.default.setDownload(!1,r),t._hideMenu()})},downloadXls:function(e){var t=this,r=l.default.setDownload(!0);this.layerMenu.loading.xls=!0,s.default.getLayerById(e).getXls().catch(function(e){return u.default.notify.error(h("info.server_error"))}).finally(function(){t.layerMenu.loading.xls=!1,l.default.setDownload(!1,r),t._hideMenu()})},downloadGpx:function(e){var t=this,r=l.default.setDownload(!0);this.layerMenu.loading.gpx=!0,s.default.getLayerById(e).getGpx().catch(function(e){return u.default.notify.error(h("info.server_error"))}).finally(function(){t.layerMenu.loading.gpx=!1,l.default.setDownload(!1,r),t._hideMenu()})},downloadGpkg:function(e){var t=this,r=l.default.setDownload(!0);this.layerMenu.loading.gpkg=!0,s.default.getLayerById(e).getGpkg().catch(function(e){return u.default.notify.error(h("info.server_error"))}).finally(function(){t.layerMenu.loading.gpkg=!1,l.default.setDownload(!1,r),t._hideMenu()})},changeLayerMapPosition:function(e){var t=e.position,e=e.layer,r=u.default.getService("map"),n=e.position!==t;n&&(e.position=t,r.changeLayerMapPosition({id:e.id,position:t}),n)&&this._hideMenu()},setWMSOpacity:function(e){var t=e.id,t=void 0===t?this.layerMenu.layer.id:t,e=e.value;this.layerMenu.layer.opacity=e,u.default.getService("map").changeLayerOpacity({id:t,opacity:e})},zoomToLayer:function(e){u.default.getService("map").goToBBox([e.bbox.minx,e.bbox.miny,e.bbox.maxx,e.bbox.maxy],e.epsg),this._hideMenu()},canZoom:function(e){return e.bbox&&[e.bbox.minx,e.bbox.miny,e.bbox.maxx,e.bbox.maxy].find(function(e){return 0<e})},getGeometryType:function(t){var e,r=void 0;return 1<arguments.length&&void 0!==arguments[1]&&arguments[1]?(e=this.external.vector.find(function(e){return e.id===t}))&&(r=e.geometryType):r=s.default.getLayerById(t).config.geometrytype,r=r&&"NoGeometry"!==r?r:""},downloadExternal:function(e){this.layerMenu.loading.unknow=!0,m({url:e}),this.layerMenu.loading.unknow=!1},downloadExternalShapefile:(f=b(regeneratorRuntime.mark(function e(t){var r,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="EPSG:4326",this.layerMenu.loading.shp=!0,i=u.default.getService("map"),i=i.getLayerByName(t.name),n=new ol.format.GeoJSON,i=i.getSource().getFeatures(),t.crs!==r&&(i=i.map(function(e){e=e.clone();return e.getGeometry().transform(t.crs,r),e})),n=n.writeFeaturesObject(i,{featureProjection:r}),i=t.name.split("."+t.type)[0],g.download(n,{folder:i,types:{point:i,mulipoint:i,polygon:i,multipolygon:i,line:i,polyline:i,multiline:i}}),e.next=12,this.$nextTick();case 12:this.layerMenu.loading.shp=!1,this._hideMenu();case 14:case"end":return e.stop()}},e,this)})),function(e){return f.apply(this,arguments)}),showAttributeTable:function(e){var t=this,e=(this.layerMenu.loading.data_table=!1,u.default.closeContent(),s.default.getLayerById(e)),r=(this.layerMenu.loading.data_table=!0,new v({layer:e,formatter:1}));r.on("show",function(){t.isMobile()&&u.default.hideSidebar(),t.layerMenu.loading.data_table=!1,t._hideMenu()}),r.show({title:e.getName()})},startEditing:function(){var t=this,r=void 0;s.default.getLayersStores().forEach(function(e){if(r=e.getLayerById(t.layerMenu.layer.id))return r.getLayerForEditing(),!1})},setCurrentLayerStyle:function(r){var e,t,n=this,i=!1;this.layerMenu.layer.styles.forEach(function(e,t){t===r?(n.layerMenu.stylesMenu.style=e.name,i=!e.current,e.current=!0):e.current=!1}),i&&(e=this.layerMenu.layer.id,t=s.default.getLayerById(this.layerMenu.layer.id))&&(o.default.$emit("layer-change-style",{layerId:e,style:this.layerMenu.stylesMenu.style}),t.change()),this.closeLayerMenu(this.layerMenu.stylesMenu)},showSubMenuContext:(p=b(regeneratorRuntime.mark(function e(t){var r,n,i,a,o=t.menu,s=t.bool,l=t.evt;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s)return r=$(l.target),o.top=r.offset().top,o.left=r.offset().left+r.width()+(r.outerWidth()-r.width())/2+y,r=$(this.$refs["layer-menu"]),n=$(l.target),i=n.children("ul"),i=i.height(),a=r.height(),o.maxHeight=a<=i?a:null,o.overflowY=a<=i?"scroll":null,o.top=(a<=i?r:n).offset().top,o.left=this.isMobile()?0:n.offset().left+n.width()+(n.outerWidth()-n.width())/2+y,e.next=15,this.$nextTick();e.next=15;break;case 15:o.show=s;case 16:case"end":return e.stop()}},e,this)})),function(e){return p.apply(this,arguments)}),showStylesMenu:(d=b(regeneratorRuntime.mark(function e(t,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.showSubMenuContext({menu:this.layerMenu.stylesMenu,bool:t,evt:r});case 1:case"end":return e.stop()}},e,this)})),function(e,t){return d.apply(this,arguments)}),showMetadataInfo:(c=b(regeneratorRuntime.mark(function e(t,r){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t)return n=$(r.target),this.layerMenu.metadatainfoMenu.top=n.offset().top,this.layerMenu.metadatainfoMenu.left=n.offset().left+n.width()+(n.outerWidth()-n.width())/2+y,e.next=6,this.$nextTick();e.next=6;break;case 6:this.layerMenu.metadatainfoMenu.show=t;case 7:case"end":return e.stop()}},e,this)})),function(e,t){return c.apply(this,arguments)}),showColorMenu:function(e,t){var r;e&&(t=$(t.target),r=$(this.$refs["layer-menu"]),this.layerMenu.colorMenu.top=r.offset().top,this.layerMenu.colorMenu.left=t.offset().left+t.width()+(t.outerWidth()-t.width())/2-y),this.layerMenu.colorMenu.show=e},getStyleName:function(e){return e.name+(e.name===this.layerMenu.layer.defaultstyle&&1<this.layerMenu.layer.styles.length?" ("+h("default")+")":"")},isExternalWMSLayer:function(e){return!e.projectLayer&&"wms"===e._type},isExternalVectorLayer:function(e){return!e.projectLayer&&"wms"!==e._type},canShowStylesMenu:function(e){return e.geolayer&&e.styles&&1<e.styles.length},hasMetadataInfo:function(e){return e.metadata&&e.metadata.abstract},canShowOpacityPicker:function(e){return e.geolayer&&e.visible}},created:function(){var r,n=this;o.default.$on("showmenulayer",(r=b(regeneratorRuntime.mark(function e(t,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n._hideMenu(),e.next=3,n.$nextTick();case 3:return n.layerMenu.left=r.x,n.layerMenu.name=t.name,n.layerMenu.layer=t,n.layerMenu.show=!0,n.layerMenu.colorMenu.color=t.color,e.next=10,n.$nextTick();case 10:n.layerMenu.top=$(r.target).offset().top-$(n.$refs["layer-menu"]).height()+$(r.target).height()/2,$('.catalog-menu-wms[data-toggle="tooltip"]').tooltip();case 12:case"end":return e.stop()}},e,n)})),function(e,t){return r.apply(this,arguments)}))}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var r=this,e=r.$createElement,n=r._self._c||e;return r.layerMenu.show?n("ul",{directives:[{name:"click-outside-layer-menu",rawName:"v-click-outside-layer-menu",value:r.closeLayerMenu,expression:"closeLayerMenu"}],ref:"layer-menu",style:{top:r.layerMenu.top+"px",left:r.layerMenu.left+"px"},attrs:{id:"layer-menu",tabindex:"-1"}},[n("li",{staticClass:"title"},[n("div",[r._v(r._s(r.layerMenu.layer.title))]),r._v(" "),n("div",{staticStyle:{"font-weight":"normal","font-size":"0.8em"}},[r._v(r._s(r.getGeometryType(r.layerMenu.layer.id,r.layerMenu.layer.external)))])]),r._v(" "),r.layerMenu.layer.projectLayer?r._e():n("li",[n("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"}},[n("layerspositions",{staticStyle:{display:"flex","flex-direction":"column","justify-content":"space-between"},attrs:{position:r.layerMenu.layer.position},on:{"layer-position-change":function(e){return r.changeLayerMapPosition({position:e,layer:r.layerMenu.layer})}}})],1)]),r._v(" "),r.hasMetadataInfo(r.layerMenu.layer)?n("li",{on:{mouseleave:function(e){return e.target!==e.currentTarget?null:r.showMetadataInfo(!1)},mouseover:function(e){return e.target!==e.currentTarget?null:r.showMetadataInfo(!0,e)}}},[n("span",{staticClass:"menu-icon skin-color-dark",class:r.g3wtemplate.getFontClass("info")}),r._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"Metadata",expression:"'Metadata'"}],staticClass:"item-text"}),r._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:r.layerMenu.metadatainfoMenu.show,expression:"layerMenu.metadatainfoMenu.show"}],staticStyle:{position:"fixed","background-color":"#FFFFFF",color:"#000000","padding-left":"0","border-radius":"0 3px 3px 0"},style:{top:r.layerMenu.metadatainfoMenu.top+"px",left:r.layerMenu.metadatainfoMenu.left+1+"px"}},[n("div",{staticClass:"layer-menu-metadata-info",staticStyle:{padding:"5px"},domProps:{innerHTML:r._s(r.layerMenu.layer.metadata.abstract)}})])]):r._e(),r._v(" "),r.canShowStylesMenu(r.layerMenu.layer)?n("li",{staticClass:"menu-icon",on:{mouseleave:function(e){return e.target!==e.currentTarget?null:r.showStylesMenu(!1,e)},mouseover:function(e){return e.target!==e.currentTarget?null:r.showStylesMenu(!0,e)}}},[n("span",{staticClass:"menu-icon skin-color-dark",class:r.g3wtemplate.getFontClass("palette")}),r._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"catalog_items.contextmenu.styles",expression:"'catalog_items.contextmenu.styles'"}],staticClass:"item-text"}),r._v(" "),n("span",{staticClass:"menu-icon",class:r.g3wtemplate.getFontClass("arrow-right"),staticStyle:{position:"absolute",right:"0","margin-top":"3px"}}),r._v(" "),n("ul",{directives:[{name:"show",rawName:"v-show",value:r.layerMenu.stylesMenu.show,expression:"layerMenu.stylesMenu.show"}],staticStyle:{position:"fixed","padding-left":"0","background-color":"#FFFFFF",color:"#000000"},style:{top:r.layerMenu.stylesMenu.top+"px",left:r.layerMenu.stylesMenu.left+"px",maxHeight:r.layerMenu.stylesMenu.maxHeight+"px",overflowY:r.layerMenu.stylesMenu.overflowY}},r._l(r.layerMenu.layer.styles,function(e,t){return n("li",{key:e.name,on:{click:function(e){return e.stopPropagation(),r.setCurrentLayerStyle(t)}}},[e.current?n("span",{class:r.g3wtemplate.getFontClass("circle"),staticStyle:{"font-size":"0.8em"}}):r._e(),r._v(" "),n("span",[r._v(r._s(r.getStyleName(e)))])])}),0)]):r._e(),r._v(" "),r.canShowOpacityPicker(r.layerMenu.layer)?n("li",{staticClass:"menu-icon",staticStyle:{"padding-right":"0"}},[n("layer-opacity-picker",{attrs:{layer:r.layerMenu.layer},on:{"init-menu-item":r.addLayerMenuItem,"show-menu-item":r.showSubMenuContext}})],1):r._e(),r._v(" "),r.canZoom(r.layerMenu.layer)?n("li",{on:{click:function(e){return e.preventDefault(),e.stopPropagation(),r.zoomToLayer(r.layerMenu.layer)}}},[n("span",{staticClass:"menu-icon skin-color-dark",class:r.g3wtemplate.getFontClass("search")}),r._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"catalog_items.contextmenu.zoomtolayer",expression:"'catalog_items.contextmenu.zoomtolayer'"}],staticClass:"item-text"})]):r._e(),r._v(" "),r.layerMenu.layer.openattributetable?n("li",{on:{click:function(e){return e.preventDefault(),e.stopPropagation(),r.showAttributeTable(r.layerMenu.layer.id)}}},[n("bar-loader",{attrs:{loading:r.layerMenu.loading.data_table}}),r._v(" "),n("span",{staticClass:"menu-icon skin-color-dark",class:r.g3wtemplate.getFontClass("list")}),r._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"catalog_items.contextmenu.open_attribute_table",expression:"'catalog_items.contextmenu.open_attribute_table'"}],staticClass:"item-text"})],1):r._e(),r._v(" "),r.isExternalVectorLayer(r.layerMenu.layer)?n("li",{on:{click:function(e){e.preventDefault(),e.stopPropagation()},mouseleave:function(e){return e.target!==e.currentTarget?null:r.showColorMenu(!1,e)},mouseover:function(e){return e.target!==e.currentTarget?null:r.showColorMenu(!0,e)}}},[n("span",{directives:[{name:"t",rawName:"v-t",value:"catalog_items.contextmenu.vector_color_menu",expression:"'catalog_items.contextmenu.vector_color_menu'"}],staticClass:"item-text"}),r._v(" "),n("span",{staticClass:"menu-icon skin-color-dark",class:r.g3wtemplate.getFontClass("arrow-right"),staticStyle:{position:"absolute",right:"0","margin-top":"3px"}}),r._v(" "),r.layerMenu.colorMenu.show?n("ul",{staticStyle:{position:"fixed"},style:{top:r.layerMenu.colorMenu.top+"px",left:r.layerMenu.colorMenu.left+"px"}},[n("li",{staticStyle:{padding:"0"}},[n("chrome-picker",{ref:"color_picker",staticStyle:{width:"100%"},on:{click:function(e){e.preventDefault(),e.stopPropagation()},"hook:beforeDestroy":r.onbeforeDestroyChangeColor,input:r.onChangeColor},model:{value:r.layerMenu.colorMenu.color,callback:function(e){r.$set(r.layerMenu.colorMenu,"color",e)},expression:"layerMenu.colorMenu.color"}})],1)]):r._e()]):r._e(),r._v(" "),r.isExternalVectorLayer(r.layerMenu.layer)&&r.layerMenu.layer.downloadUrl?n("li",{directives:[{name:"download",rawName:"v-download"}],on:{click:function(e){e.preventDefault(),e.stopPropagation()}}},[n("div",{on:{click:function(e){return e.preventDefault(),e.stopPropagation(),r.downloadExternal(r.layerMenu.layer.downloadUrl)}}},[n("bar-loader",{attrs:{loading:r.layerMenu.loading.unknow}}),r._v(" "),n("span",{staticClass:"menu-icon skin-color-dark",class:r.g3wtemplate.getFontClass("download")}),r._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.unknow",expression:"'sdk.catalog.menu.download.unknow'"}],staticClass:"item-text"})],1)]):r._e(),r._v(" "),r.isExternalVectorLayer(r.layerMenu.layer)&&!r.layerMenu.layer.downloadUrl?n("li",{directives:[{name:"download",rawName:"v-download"}],on:{click:function(e){e.preventDefault(),e.stopPropagation()}}},[n("div",{on:{click:function(e){return e.preventDefault(),e.stopPropagation(),r.downloadExternalShapefile(r.layerMenu.layer)}}},[n("bar-loader",{attrs:{loading:r.layerMenu.loading.shp}}),r._v(" "),n("span",{staticClass:"menu-icon skin-color-dark",class:r.g3wtemplate.getFontClass("shapefile")}),r._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.shp",expression:"'sdk.catalog.menu.download.shp'"}],staticClass:"item-text"})],1)]):r._e(),r._v(" "),r.isExternalWMSLayer(r.layerMenu.layer)?n("li",{on:{click:function(e){e.preventDefault(),e.stopPropagation()}}},[n("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[n("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.setwmsopacity",expression:"'sdk.catalog.menu.setwmsopacity'"}],staticClass:"item-text"}),r._v(" "),n("span",{staticStyle:{"font-weight":"bold","margin-left":"5px"}},[r._v(r._s(r.layerMenu.layer.opacity))])]),r._v(" "),n("range",{attrs:{value:r.layerMenu.layer.opacity,min:0,max:1,step:.1,sync:!0},on:{changed:r._hideMenu,"change-range":r.setWMSOpacity}})],1):r._e(),r._v(" "),r.canDownloadGeoTIFF(r.layerMenu.layer.id)?n("li",{directives:[{name:"download",rawName:"v-download"}]},[n("div",{on:{click:function(e){return e.preventDefault(),e.stopPropagation(),r.downloadGeoTIFF(r.layerMenu.layer.id)}}},[n("bar-loader",{attrs:{loading:r.layerMenu.loading.geotiff}}),r._v(" "),n("span",{staticClass:"menu-icon skin-color-dark",class:r.g3wtemplate.getFontClass("geotiff")}),r._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.geotiff",expression:"'sdk.catalog.menu.download.geotiff'"}],staticClass:"item-text"})],1)]):r._e(),r._v(" "),r.canDownloadGeoTIFF(r.layerMenu.layer.id)?n("li",{directives:[{name:"download",rawName:"v-download"}]},[n("div",{staticStyle:{position:"relative"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),r.downloadGeoTIFF(r.layerMenu.layer.id,!0)}}},[n("bar-loader",{attrs:{loading:r.layerMenu.loading.geotiff}}),r._v(" "),n("span",{staticClass:"menu-icon skin-color-dark",class:r.g3wtemplate.getFontClass("geotiff"),staticStyle:{color:"#777"}}),r._v(" "),n("span",{staticClass:"menu-icon skin-color-dark",class:r.g3wtemplate.getFontClass("crop"),staticStyle:{position:"absolute",left:"-7px",bottom:"8px","font-size":"1.2em"}}),r._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.geotiff_map_extent",expression:"'sdk.catalog.menu.download.geotiff_map_extent'"}],staticClass:"item-text"})],1)]):r._e(),r._v(" "),r.canDownloadShp(r.layerMenu.layer.id)?n("li",{directives:[{name:"download",rawName:"v-download"}]},[n("div",{on:{click:function(e){return e.preventDefault(),e.stopPropagation(),r.downloadShp(r.layerMenu.layer.id)}}},[n("bar-loader",{attrs:{loading:r.layerMenu.loading.shp}}),r._v(" "),n("span",{staticClass:"menu-icon skin-color-dark",class:r.g3wtemplate.getFontClass("shapefile")}),r._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.shp",expression:"'sdk.catalog.menu.download.shp'"}],staticClass:"item-text"})],1)]):r._e(),r._v(" "),r.canDownloadGpx(r.layerMenu.layer.id)?n("li",[n("div",{directives:[{name:"download",rawName:"v-download"}],on:{click:function(e){return e.preventDefault(),e.stopPropagation(),r.downloadGpx(r.layerMenu.layer.id)}}},[n("bar-loader",{attrs:{loading:r.layerMenu.loading.gpx}}),r._v(" "),n("span",{staticClass:"menu-icon skin-color-dark",class:r.g3wtemplate.getFontClass("gpx")}),r._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.gpx",expression:"'sdk.catalog.menu.download.gpx'"}],staticClass:"item-text"})],1)]):r._e(),r._v(" "),r.canDownloadGpkg(r.layerMenu.layer.id)?n("li",[n("div",{directives:[{name:"download",rawName:"v-download"}],on:{click:function(e){return e.preventDefault(),e.stopPropagation(),r.downloadGpkg(r.layerMenu.layer.id)}}},[n("bar-loader",{attrs:{loading:r.layerMenu.loading.gpkg}}),r._v(" "),n("span",{staticClass:"menu-icon skin-color-dark",class:r.g3wtemplate.getFontClass("gpkg")}),r._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.gpkg",expression:"'sdk.catalog.menu.download.gpkg'"}],staticClass:"item-text"})],1)]):r._e(),r._v(" "),r.canDownloadCsv(r.layerMenu.layer.id)?n("li",[n("div",{directives:[{name:"download",rawName:"v-download"}],on:{click:function(e){return e.preventDefault(),e.stopPropagation(),r.downloadCsv(r.layerMenu.layer.id)}}},[n("bar-loader",{attrs:{loading:r.layerMenu.loading.csv}}),r._v(" "),n("span",{staticClass:"menu-icon skin-color-dark",class:r.g3wtemplate.getFontClass("csv")}),r._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.csv",expression:"'sdk.catalog.menu.download.csv'"}],staticClass:"item-text"})],1)]):r._e(),r._v(" "),r.canDownloadXls(r.layerMenu.layer.id)?n("li",{directives:[{name:"download",rawName:"v-download"}]},[n("div",{on:{click:function(e){return e.preventDefault(),e.stopPropagation(),r.downloadXls(r.layerMenu.layer.id)}}},[n("bar-loader",{attrs:{loading:r.layerMenu.loading.xls}}),r._v(" "),n("span",{staticClass:"menu-icon skin-color-dark",class:r.g3wtemplate.getFontClass("xls")}),r._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.xls",expression:"'sdk.catalog.menu.download.xls'"}],staticClass:"item-text"})],1)]):r._e(),r._v(" "),r.canShowWmsUrl(r.layerMenu.layer.id)?n("li",[n("div",{staticStyle:{display:"flex","max-width":"300px","align-items":"center"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),r.copyUrl({evt:e,layerId:r.layerMenu.layer.id,type:"Wms"})}}},[n("span",{staticClass:"menu-icon skin-color-dark",class:r.g3wtemplate.getFontClass("map")}),r._v(" "),n("div",{staticStyle:{display:"inline-flex","justify-content":"space-between",width:"100%","align-items":"baseline"}},[n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.catalog.menu.wms.copy",expression:"'sdk.catalog.menu.wms.copy'"}],staticClass:"item-text catalog-menu-wms skin-tooltip-top",attrs:{"data-toggle":"tooltip"}},[r._v("WMS URL")]),r._v(" "),n("span",{staticClass:"bold catalog-menu-wms wms-url-tooltip skin-tooltip-top skin-color-dark",class:r.g3wtemplate.getFontClass("eye"),attrs:{"data-placement":"top","data-toggle":"tooltip",title:r.getWmsUrl(r.layerMenu.layer.id)}})])])]):r._e(),r._v(" "),r.canShowWfsUrl(r.layerMenu.layer.id)?n("li",[n("div",{staticStyle:{display:"flex","max-width":"300px","align-items":"center"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),r.copyUrl({evt:e,layerId:r.layerMenu.layer.id,type:"Wfs"})}}},[n("span",{staticClass:"menu-icon skin-color-dark",class:r.g3wtemplate.getFontClass("map")}),r._v(" "),n("div",{staticStyle:{display:"inline-flex","justify-content":"space-between",width:"100%","align-items":"baseline"}},[n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.catalog.menu.wms.copy",expression:"'sdk.catalog.menu.wms.copy'"}],staticClass:"item-text catalog-menu-wms skin-tooltip-top",attrs:{"data-toggle":"tooltip"}},[r._v("WFS URL")]),r._v(" "),n("span",{staticClass:"bold catalog-menu-wms wms-url-tooltip skin-tooltip-top skin-color-dark",class:r.g3wtemplate.getFontClass("eye"),attrs:{"data-placement":"top","data-toggle":"tooltip",title:r.getWfsUrl(r.layerMenu.layer.id)}})])])]):r._e()]):r._e()},e.staticRenderFns=[],e._scopeId="data-v-601a8731"},{"components/LayerOpacityPicker.vue":253,"core/i18n/i18n.service":13,"core/utils/utils":68,"gui/catalog/vue/catalogeventhub":114,"gui/table/vue/table":184,"services/application":351,"services/gui":361,"shp-write":"shp-write","store/catalog-layers":374,"vue-color":"vue-color","vueify/lib/insert-css":1}],199:[function(e,t,r){var n,i,a,o,s,l,u,c,d,p,f;e("vueify/lib/insert-css").insert(".layer-legend[data-v-de40554c]{padding-left:36px}");function h(e){return e&&e.__esModule?e:{default:e}}function g(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),c=h(e("services/gui")),d=h(e("gui/catalog/vue/catalogeventhub")),p=h(e("store/catalog-layers")),f=h(e("store/projects")),e=h(e("mixins/click")),r.default={name:"layerlegend",props:{legendplace:{type:String},layer:{type:Object}},data:function(){return{loading:!1,categories:[],currentstyle:this.layer.styles.find(function(e){return!0===e.current}).name}},mixins:[e.default],computed:{showfeaturecount:function(){return void 0!==this.layer.featurecount},externallegend:function(){return"wms"===this.layer.source.type},legend:function(){return this.layer.legend},show:function(){return this.layer.expanded&&this.layer.visible&&("toc"===this.legendplace||"tab"===this.legendplace&&this.layer.categories)}},methods:{onCategoryClick:function(){this.handleClick({1:function(){},2:function(){}},this)},showCategoryMenu:function(){this.$emit("showmenucategory")},getWmsSourceLayerLegendUrl:function(){return this.getProjectLayer().getLegendUrl({width:16,height:16})},getProjectLayer:function(){return p.default.getLayerById(this.layer.id)},isDisabled:function(e){return this.categories[e].disabled},showHideLayerCategory:function(e){this.categories[e].checked=!this.categories[e].checked,this.getProjectLayer().change(),"tab"===this.legendplace?this.layer.legend.change=!0:this.categories[e].checked&&this.mapReady&&this.setLayerCategories(!1)},setError:function(){this.legend.error=!0,this.legend.loading=!1},urlLoaded:(u=g(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.legend.loading=!1;case 1:case"end":return e.stop()}},e,this)})),function(){return u.apply(this,arguments)}),onChangeLayerLegendStyle:(l=g(regeneratorRuntime.mark(function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loading=!0,this.externallegend)return e.abrupt("return");e.next=3;break;case 3:if(e.prev=3,void 0!==t.style&&t.layerId===this.layer.id)return e.next=7,this.setLayerCategories(!0);e.next=13;break;case 7:return e.next=9,this.getProjectLayer().getStyleFeatureCount(t.style);case 9:if(this.currentstyle=t.style,this.dynamic)return e.next=13,this.setLayerCategories(!1);e.next=13;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3);case 18:this.loading=!1;case 19:case"end":return e.stop()}},e,this,[[3,15]])})),function(){return l.apply(this,arguments)}),setLayerCategories:(s=g(regeneratorRuntime.mark(function e(){var t,r,n,i=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t=this.getProjectLayer(),r=t.getCategories(),i&&r?(this.categories=r,e.next=13):e.next=7;break;case 7:return e.next=9,t.getLegendGraphic({all:i});case 9:n=e.sent,n=n.nodes,n=void 0===n?[]:n,i?this._setAllLayerCategories(n):this._updateLayerCategories(n,r);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),this.setError();case 18:case"end":return e.stop()}},e,this,[[0,15]])})),function(){return s.apply(this,arguments)}),_setAllLayerCategories:function(e){var t=this.getProjectLayer(),a=[];e.forEach(function(e){var t=e.icon,r=e.title,n=e.ruleKey,i=e.checked,e=e.symbols,e=void 0===e?[]:e;t?a.push({icon:t,title:r,ruleKey:n,checked:i,disabled:!1}):e.forEach(function(e){e._checked=e.checked,e.disabled=!1,a.push(e)})}),t.setCategories(a),this.categories=a},_updateLayerCategories:function(e,i){this.getProjectLayer().setCategories(i),this.categories=i,e.length?e.forEach(function(e){var t=e.icon,r=e.title,e=e.symbols,n=t?[{icon:t,title:r}]:void 0===e?[]:e;i.forEach(function(t){var e=n.find(function(e){return e.icon===t.icon&&e.title===t.title}),r=void 0===t.checked||t.checked;t.disabled=r&&void 0===e})}):i.forEach(function(e){return e.disabled=void 0===e.checked||e.checked})},onChangeMapLegendParams:(o=g(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.mapReady=!0,this.layer.visible&&!1===this.externallegend&&("toc"===this.legendplace||this.layer.categories)&&this.setLayerCategories(!1);case 2:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)}),runInitLayerVisibleAction:(a=g(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setLayerCategories(!0);case 2:if(this.dynamic)return e.next=5,this.setLayerCategories(!1);e.next=6;break;case 5:c.default.getService("map").on("change-map-legend-params",this.onChangeMapLegendParams);case 6:this.initialize=!0;case 7:case"end":return e.stop()}},e,this)})),function(){return a.apply(this,arguments)})},watch:{"layer.visible":(i=g(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=t&&!1===this.externallegend)&&!1===this.initialize)return e.next=4,this.runInitLayerVisibleAction();e.next=4;break;case 4:if(r&&!1!==this.initialize)return e.next=7,this.setLayerCategories(!this.dynamic);e.next=7;break;case 7:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},created:(n=g(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.initialize=!1,this.dynamic=f.default.getCurrentProject().getContextBaseLegend(),this.mapReady=!1,d.default.$on("layer-change-style",this.onChangeLayerLegendStyle),!1===this.externallegend&&!0===this.layer.visible)return e.next=7,this.runInitLayerVisibleAction();e.next=7;break;case 7:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)}),beforeDestroy:function(){d.default.$off("layer-change-style",this.onChangeLayerLegendStyle)}},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:r.show,expression:"show"}],staticClass:"layer-legend",on:{click:function(e){e.stopPropagation(),e.preventDefault()}}},[r.legend?n("bar-loader",{attrs:{loading:r.legend.loading}}):r._e(),r._v(" "),r.externallegend?n("figure",[n("img",{attrs:{src:r.getWmsSourceLayerLegendUrl()}})]):n("figure",{directives:[{name:"disabled",rawName:"v-disabled",value:r.loading,expression:"loading"}]},[n("bar-loader",{attrs:{loading:r.loading}}),r._v(" "),r._l(r.categories,function(e,t){return n("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.disabled,expression:"category.disabled"}],staticStyle:{display:"flex","align-items":"center",width:"100%"},on:{contextmenu:function(e){return e.preventDefault(),e.stopPropagation(),r.showCategoryMenu(e)}}},[e.ruleKey?n("span",{class:r.g3wtemplate.getFontClass(e.checked?"check":"uncheck"),staticStyle:{"padding-right":"3px"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),r.showHideLayerCategory(t)}}}):r._e(),r._v(" "),"toc"===r.legendplace?n("img",{attrs:{src:e.icon&&"data:image/png;base64,"+e.icon},on:{error:function(e){return r.setError()},load:function(e){return r.urlLoaded()}}}):r._e(),r._v(" "),"tab"===r.legendplace&&e.ruleKey||"toc"===r.legendplace?n("span",{staticClass:"g3w-long-text",staticStyle:{"padding-left":"3px"},on:{click:function(e){return e.stopPropagation(),r.onCategoryClick(e)}}},[n("span",[r._v(r._s(e.title))]),r._v(" "),r.showfeaturecount&&void 0!==e.ruleKey?n("span",{staticStyle:{"font-weight":"bold"}},[r._v("\n          ["+r._s(r.layer.stylesfeaturecount[r.currentstyle][e.ruleKey])+"]\n        ")]):r._e()]):r._e()])})],2)],1)},r.staticRenderFns=[],r._scopeId="data-v-de40554c"},{"gui/catalog/vue/catalogeventhub":114,"mixins/click":339,"services/gui":361,"store/catalog-layers":374,"store/projects":379,"vueify/lib/insert-css":1}],200:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default={name:"catalog-layers-group",props:{layersgroup:{type:Object}}},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticStyle:{border:"1px solid #ffffff33",margin:"5px"}},[t("h4",{staticStyle:{margin:"5px","font-weight":"bold"}},[this._v(this._s(this.layersgroup.title))]),this._v(" "),this._l(this.layersgroup.nodes,function(e){return t("tristate-tree",{staticClass:"item",attrs:{layerstree:e}})})],2)},r.staticRenderFns=[]},{}],201:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default={name:"catalog-layers-legend",props:["layerstree","legend","active"],data:function(){return{}},computed:{visiblelayers:function(){var l=[];return function e(t){var r=!0,n=!1,i=void 0;try{for(var a,o=t[Symbol.iterator]();!(r=(a=o.next()).done);r=!0){var s=a.value;!_.isNil(s.id)&&s.visible&&s.geolayer&&!s.exclude_from_legend&&l.push(s),_.isNil(s.nodes)||e(s.nodes)}}catch(e){n=!0,i=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw i}}}(this.layerstree.tree),l}},watch:{layerstree:{handler:function(e,t){},deep:!0},visiblelayers:function(e){this.$emit("showlegend",!!e.length)}},created:function(){this.$emit("showlegend",!!this.visiblelayers.length)}},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var e=this.$createElement,e=this._self._c||e;return e("div",{staticClass:"tab-pane",class:{active:this.active},attrs:{role:"tabpanel",id:"legend"}},[e("layerslegend-items",{attrs:{active:this.active,legend:this.legend,layers:this.visiblelayers}})],1)},r.staticRenderFns=[]},{}],202:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),_=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},l=n(e("gui/catalog/vue/catalogeventhub")),u=n(e("store/catalog-layers")),c=n(e("services/application")),d=n(e("store/projects")),p=n(e("services/gui")),r.default={name:"catalog-layers-legend-items",props:{layers:{default:[]},legend:{type:Object},active:{default:!0}},data:function(){return{legendurls:[]}},watch:{layers:{handler:function(){this.getLegendSrc()},immediate:!1},active:(s=i(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t)if(r=this.layers.filter(function(e){return e.legend.change}),0===this.legendurls.length||this.dynamic||r.length)return e.next=5,this.getLegendSrc(this.layers);e.next=6;break;case 5:r.forEach(function(e){return e.legend.change=!1});case 6:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)})},methods:{setError:function(e){e.error=!0,e.loading=!1},urlLoaded:function(e){e.loading=!1},getLegendUrl:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=u.default.getLayerById(e.id);if(r)return r.getLegendUrl(t,{all:!this.dynamic,format:"image/png",categories:e.categories})},getLegendUrlParams:function(){var e="",r={LAYERS:[],STYLES:[],LEGEND_ON:[],LEGEND_OFF:[]};return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).reduce(function(e,t){return r.LAYERS.push(t.layerName),r.STYLES.push(t.style),t.legend_on&&r.LEGEND_ON.push(t.legend_on),t.legend_off&&r.LEGEND_OFF.push(t.legend_off),r},r),e=(e+="LAYERS="+encodeURIComponent(r.LAYERS.join(",")))+("&STYLES="+encodeURIComponent(r.STYLES.join(","))),r.LEGEND_ON.length&&(e+="&LEGEND_ON="+encodeURIComponent(r.LEGEND_ON.join(","))),r.LEGEND_OFF.length&&(e+="&LEGEND_OFF="+encodeURIComponent(r.LEGEND_OFF.join(","))),c.default.getFilterToken()&&(e+="&filtertoken="+c.default.getFilterToken()),e},getLegendSrc:(o=i(regeneratorRuntime.mark(function e(){var t,o,r,n,i,a,s,l,u,c,d,p,f,h,g,v,m,y=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.legendurls=[],e.next=3,this.$nextTick();case 3:if(this.active){e.next=5;break}return e.abrupt("return");case 5:t={GET:{},POST:{}},r=(o=this).layers.filter(function(e){return e.geolayer}),n=0;case 9:if(n<r.length){if(i=r[n],a=Array.isArray(i.styles)&&i.styles.find(function(e){return e.current}),s=i.source&&i.source.url||i.external?t.GET:t[i.ows_method],void 0===(l=""+this.getLegendUrl(i,this.legend.config)))return e.abrupt("continue",17);e.next=16}else e.next=20;break;case 16:i.source&&i.source.url?s[l]=[]:(d=c=u=void 0,p=l.split("LAYER="),p=_(p,2),u=p[0],layerName=p[1],p=u.split("LEGEND_ON="),p=_(p,2),u=p[0],c=p[1],p=u.split("LEGEND_OFF="),p=_(p,2),u=p[0],d=p[1],s[u]||(s[u]=[]),s[u].unshift({layerName:layerName,style:a&&a.name,legend_on:(c||"").replace("&",""),legend_off:(d||"").replace("&","")}));case 17:n++,e.next=9;break;case 20:for(f in t)if(h=t[f],"GET"===f)for(g in h)h[g].length&&(g+=""+this.getLegendUrlParams(h[g])),this.legendurls.push({loading:!0,error:!1,url:g});else for(m in v=function(e){var t=new XMLHttpRequest,r=[],n=e.split("?"),n=_(n,2),i=n[0],n=n[1],a=((n=n.split("&")).forEach(function(e){var e=e.split("="),e=_(e,2),t=e[0],e=e[1];t&&r.push(t+"="+encodeURIComponent(e))}),n=r.join("&")+"&"+y.getLegendUrlParams(h[e]),{loading:!0,url:null,error:!1});t.open("POST",i),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),t.responseType="blob",o.legendurls.push(a),t.onload=function(){void 0!==this.response&&(a.url=window.URL.createObjectURL(this.response)),a.loading=!1},t.onerror=function(){a.loading=!1},t.send(n)},h)v(m);case 21:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)})},created:function(){var e=this;this.dynamic=d.default.getCurrentProject().getContextBaseLegend(),this.mapReady=!1,l.default.$on("layer-change-style",function(){e.getLegendSrc()})},mounted:(a=i(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.dynamic?p.default.getService("map").on("change-map-legend-params",function(){t.mapReady=!0,t.getLegendSrc()}):this.mapReady=!0;case 3:case"end":return e.stop()}},e,this)})),function(){return a.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default);var a,o,s,_,l,u,c,d,p,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("div",{staticClass:"legend-item"},r._l(r.legendurls,function(t){return n("figure",[n("bar-loader",{attrs:{loading:t.loading}}),r._v(" "),n("img",{directives:[{name:"show",rawName:"v-show",value:!t.loading&&!t.error,expression:"!legendurl.loading && !legendurl.error"}],attrs:{src:t.url},on:{error:function(e){return r.setError(t)},load:function(e){return r.urlLoaded(t)}}}),r._v(" "),n("span",{staticClass:"divider"})],1)}),0)},e.staticRenderFns=[]},{"gui/catalog/vue/catalogeventhub":114,"services/application":351,"services/gui":361,"store/catalog-layers":374,"store/projects":379}],203:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),a=n(e("components/CatalogLayerLegend.vue")),o=n(e("gui/catalog/vue/catalogeventhub")),s=n(e("store/catalog-layers")),l=n(e("mixins/click")),u=n(e("services/gui")),d=e("core/utils/utils").downloadFile,r.default={name:"catalog-tristate-tree",props:["layerstree","storeid","legend","legendplace","highlightlayers","parent_mutually_exclusive","parentFolder","externallayers","root","parent"],components:{layerlegend:a.default},mixins:[l.default],data:function(){return{expanded:this.layerstree.expanded,isGroupChecked:!0,controltoggled:!1,n_childs:null,filtered:!1}},computed:{showfeaturecount:function(){return void 0!==this.layerstree.featurecount},showLegendLayer:function(){return!this.layerstree.exclude_from_legend},showLayerTocLegend:function(){return!this.isGroup&&this.showLegendLayer&&this.layerstree.geolayer},isGroup:function(){return!!this.layerstree.nodes},legendlayerposition:function(){return this.showLegendLayer&&this.layerstree.legend?this.legendplace:"tab"},showscalevisibilityclass:function(){return!this.isGroup&&this.layerstree.scalebasedvisibility},showScaleVisibilityToolip:function(){return this.showscalevisibilityclass&&this.layerstree.disabled&&this.layerstree.checked},isTable:function(){return!this.isGroup&&!this.layerstree.geolayer&&!this.layerstree.external},isHidden:function(){return this.layerstree.hidden&&!0===this.layerstree.hidden},selected:function(){this.layerstree.selected=(!this.layerstree.disabled||!this.layerstree.selected)&&this.layerstree.selected},isHighLight:function(){return this._isHighLightProjectLayer||this._isHighLightExternalLayer},isInGrey:function(){return!this.isGroup&&!this.isTable&&!this.layerstree.external&&(!this.layerstree.visible||this.layerstree.disabled)},getFeatureCount:function(){return Object.values(this.layerstree.featurecount).reduce(function(e,t){return e+ +t},0)},_isHighLightProjectLayer:function(){return this.highlightlayers&&!this.isGroup&&s.default.getLayerById(this.layerstree.id).getTocHighlightable()&&this.layerstree.visible},_isHighLightExternalLayer:function(){return this.layerstree.external&&this.layerstree.visible&&this.layerstree._type&&!0===this.layerstree.tochighlightable}},watch:{"layerstree.disabled":function(e){},"layerstree.checked":function(e,t){this.isGroup?this.handleGroupChecked(this.layerstree):this.handleLayerChecked(this.layerstree)}},methods:{init:function(){var t=this;this.isGroup&&!this.layerstree.checked&&this.handleGroupChecked(this.layerstree),this.isGroup&&!this.root&&this.layerstree.nodes.forEach(function(e){e.id&&t.parent_mutually_exclusive&&!t.layerstree.mutually_exclusive&&(e.uncheckable=!0)})},handleGroupChecked:function(t){function n(e){var t=e.nodes,r=e.visible;t.forEach(function(e){void 0!==e.id?e.parentGroup.checked&&e.checked&&s.default.getLayerById(e.id).setVisible(r):n({nodes:e.nodes,visible:r&&e.checked})})}var e=t.checked,r=t.parentGroup,i=t.nodes;if(e){var a=!r||r.checked;for(r&&r.mutually_exclusive?r.nodes.forEach(function(e){e.checked=e.groupId===t.groupId,e.checked&&n({nodes:e.nodes,visible:a})}):n({nodes:i,visible:a});r;)r.checked=r.root||r.checked,r=r.parentGroup}else i.forEach(function(e){void 0!==e.id?e.checked&&s.default.getLayerById(e.id).setVisible(!1):n({nodes:e.nodes,visible:!1})})},handleLayerChecked:function(e){var t=e.checked,r=e.id,n=e.disabled,i=e.projectLayer,a=e.parentGroup;if(void 0!==i&&i){i=s.default.getLayerById(r);if(t){i.setVisible(!n);for(a.mutually_exclusive&&a.nodes.forEach(function(e){return e.checked=e.id===r});a;)a.checked=!0,a=a.parentGroup}else i.setVisible(!1);o.default.$emit("treenodevisible",i)}else e.visible=t,u.default.getService("map").changeLayerVisibility({id:r,visible:t})},toggleFilterLayer:function(){o.default.$emit("activefiltertokenlayer",this.storeid,this.layerstree)},clearSelection:function(){o.default.$emit("unselectionlayer",this.storeid,this.layerstree)},toggle:function(){this.layerstree.checked=!this.layerstree.checked},expandCollapse:function(){this.layerstree.expanded=!this.layerstree.expanded},select:function(){void 0!==this.layerstree.selected&&(this.layerstree.external&&!1===this.layerstree.projectLayer?o.default.$emit("treenodeexternalselected",this.layerstree):this.isGroup||this.isTable||o.default.$emit("treenodeselected",this.storeid,this.layerstree))},zoomToLayer:function(e){u.default.getService("map").goToBBox([e.bbox.minx,e.bbox.miny,e.bbox.maxx,e.bbox.maxy],e.epsg)},canZoom:function(e){return e.bbox&&[e.bbox.minx,e.bbox.miny,e.bbox.maxx,e.bbox.maxy].find(function(e){return 0<e})},onTreeItemClick:function(){var e=this;this.handleClick({1:function(){return!e.isTable&&!e.isGroup&&e.select()},2:function(){return!e.isTable&&e.canZoom(e.layerstree)&&e.zoomToLayer(e.layerstree)}},this)},triClass:function(){return this.g3wtemplate.getFontClass(this.layerstree.checked?"check":"uncheck")},downloadExternalLayer:function(e){e.file?d(e.file):e.url},removeExternalLayer:function(e,t){u.default.getService("map").removeExternalLayer(e,wms)},showLayerMenu:function(e,t){!this.isGroup&&(this.layerstree.openattributetable||this.layerstree.downloadable||this.layerstree.geolayer||this.layerstree.external)&&o.default.$emit("showmenulayer",e,t)}},created:function(){this.init()},mounted:(c=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:$("span.scalevisibility").tooltip();case 3:case"end":return e.stop()}},e,this)})),function(){return c.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default);var a,o,s,l,u,c,d,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("li",{staticClass:"tree-item",class:{selected:(!t.isGroup||!t.isTable)&&t.layerstree.selected,itemmarginbottom:!t.isGroup,disabled:t.isInGrey,group:t.isGroup},style:{marginLeft:t.isGroup?"0":"5px"},on:{contextmenu:function(e){return e.preventDefault(),e.stopPropagation(),t.showLayerMenu(t.layerstree,e)},click:function(e){return e.stopPropagation(),t.onTreeItemClick(e)}}},[t.isGroup?r("span",{staticClass:"root collapse-expande-collapse-icon",class:[{bold:t.isGroup},t.g3wtemplate.getFontClass(t.layerstree.expanded?"caret-down":"caret-right")],staticStyle:{"padding-right":"2px"},on:{click:function(e){return e.stopPropagation(),t.expandCollapse(e)}}}):t._e(),t._v(" "),t.isGroup?r("span",{class:[t.triClass()],staticStyle:{color:"#ffffff"},on:{click:function(e){return e.stopPropagation(),t.toggle()}}}):t.isTable?r("span",{directives:[{name:"show",rawName:"v-show",value:!t.layerstree.hidden,expression:"!layerstree.hidden"}],class:[t.parentFolder?"child":"root",t.g3wtemplate.getFontClass("table")],staticStyle:{"padding-left":"18px"}}):[t.layerstree.external&&t.layerstree.removable?r("span",{class:t.g3wtemplate.getFontClass("trash"),staticStyle:{color:"red","padding-left":"1px"},on:{click:function(e){return e.stopPropagation(),t.removeExternalLayer(t.layerstree.name,t.layerstree._type)}}}):t._e(),t._v(" "),t.layerstree.external&&t.layerstree.download?r("span",{class:t.g3wtemplate.getFontClass("download"),staticStyle:{color:"#ffffff","margin-left":"5px"},on:{click:function(e){return t.downloadExternalLayer(t.layerstree.download)}}}):t._e(),t._v(" "),r("span",{directives:[{name:"show",rawName:"v-show",value:!t.layerstree.hidden,expression:"!layerstree.hidden"}],staticClass:"checkbox-layer",class:t.parentFolder?"child":"root"},["toc"===t.legendlayerposition||!t.isGroup&&t.layerstree.categories?r("span",{staticClass:"collapse-expande-collapse-icon",class:t.g3wtemplate.getFontClass(t.layerstree.visible&&t.layerstree.expanded?"caret-down":"caret-right"),on:{click:function(e){return e.target!==e.currentTarget?null:(e.stopPropagation(),t.expandCollapse(e))}}}):t._e(),t._v(" "),r("span",{class:[t.g3wtemplate.getFontClass(t.layerstree.checked?"check":"uncheck"),{"toc-added-external-layer":!t.layerstree.legend&&t.layerstree.external}],style:{paddingLeft:"toc"===t.legendlayerposition||!t.isGroup&&t.layerstree.categories?"5px":!t.layerstree.legend&&t.layerstree.external?"1px":"18px"},on:{click:function(e){return e.stopPropagation(),t.toggle()}}})])],t._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:!t.layerstree.hidden||t.isGroup,expression:"!layerstree.hidden || isGroup"}],staticClass:"tree-node-title",class:{disabled:!t.layerstree.external&&(t.layerstree.disabled||t.layerstree.id&&!t.layerstree.visible),bold:t.isGroup}},[r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip.text",value:t.showScaleVisibilityToolip?"minscale:"+t.layerstree.minscale+" - maxscale:"+t.layerstree.maxscale:"",expression:"showScaleVisibilityToolip ? `minscale:${layerstree.minscale} - maxscale:${layerstree.maxscale}` : ''",modifiers:{text:!0}}],staticClass:"skin-tooltip-top g3w-long-text",class:{highlightlayer:t.isHighLight,scalevisibility:t.showscalevisibilityclass},attrs:{"data-placement":"top","current-tooltip":t.showScaleVisibilityToolip?"minscale:"+t.layerstree.minscale+" - maxscale: "+t.layerstree.maxscale:""}},[r("span",[t._v(t._s(t.layerstree.title))]),t._v(" "),!t.isGroup&&t.showfeaturecount?r("span",{staticStyle:{"font-weight":"bold"}},[t._v("["+t._s(t.getFeatureCount)+"]")]):t._e()]),t._v(" "),!t.isGroup&&t.layerstree.selection?r("div",[t.layerstree.selection.active?r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"layer_selection_filter.tools.clear",expression:"'layer_selection_filter.tools.clear'",modifiers:{create:!0}}],staticClass:"action-button skin-tooltip-left selection-filter-icon",class:t.g3wtemplate.getFontClass("success"),attrs:{"data-placement":"left","data-toggle":"tooltip"},on:{click:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"caputure",void 0,e.key,void 0)?null:(e.preventDefault(),e.stopPropagation(),t.clearSelection(e))}}}):t._e(),t._v(" "),t.layerstree.external||!t.layerstree.selection.active&&!t.layerstree.filter.active?t._e():r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"layer_selection_filter.tools.filter",expression:"'layer_selection_filter.tools.filter'",modifiers:{create:!0}}],staticClass:"action-button skin-tooltip-left selection-filter-icon",class:[t.g3wtemplate.getFontClass("filter"),t.layerstree.filter.active?"active":""],attrs:{"data-placement":"left","data-toggle":"tooltip"},on:{click:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"caputure",void 0,e.key,void 0)?null:(e.preventDefault(),e.stopPropagation(),t.toggleFilterLayer(e))}}})]):t._e()]),t._v(" "),t.showLayerTocLegend?r("layerlegend",{attrs:{legendplace:t.legendplace,layer:t.layerstree}}):t._e(),t._v(" "),t.isGroup?r("ul",{directives:[{name:"show",rawName:"v-show",value:t.layerstree.expanded,expression:"layerstree.expanded"}],staticClass:"tree-content-items group",class:["g3w-lendplace-"+t.legendplace]},t._l(t.layerstree.nodes,function(e){return r("span",{key:e.id||e.groupId},[r("tristate-tree",{attrs:{root:!1,legendConfig:t.legend,legendplace:t.legendplace,highlightlayers:t.highlightlayers,parentFolder:t.isGroup,layerstree:e,storeid:t.storeid,parent:t.layerstree,parent_mutually_exclusive:!!t.layerstree.mutually_exclusive}})],1)}),0):t._e()],2)},e.staticRenderFns=[]},{"components/CatalogLayerLegend.vue":199,"core/utils/utils":68,"gui/catalog/vue/catalogeventhub":114,"mixins/click":339,"services/gui":361,"store/catalog-layers":374}],204:[function(e,t,r){var o,s,l,n,i,a,u,c,d;e("vueify/lib/insert-css").insert("#g3w-change-map-menu[data-v-70b4a3a6]{width:100%;position:relative}.g3w-change-map-menu-container[data-v-70b4a3a6]{height:100%;display:grid;grid-template-columns:repeat(auto-fill,minmax(30%,1fr));grid-gap:1em;overflow-y:auto}.menu-item[data-v-70b4a3a6]{margin-bottom:20px;margin-top:20px}.menu-item-image[data-v-70b4a3a6]{cursor:pointer;position:relative;overflow:hidden;padding-bottom:50%;opacity:.7}.menu-item-image[data-v-70b4a3a6]:hover{opacity:1}.menu-item-image img[data-v-70b4a3a6]{position:absolute;top:0;bottom:0;left:0;right:0;margin:auto}.menu-item-content[data-v-70b4a3a6]{padding:15px;background:hsla(0,0%,100%,.3)}.menu-item-text[data-v-70b4a3a6]{position:relative;overflow:hidden;height:100%;text-align:justify}.menu-item-title[data-v-70b4a3a6]{text-align:center;font-weight:700;background:hsla(0,0%,100%,.5);padding:5px}");function p(e){return e&&e.__esModule?e:{default:e}}function f(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function h(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),o=p(e("services/application")),s=p(e("store/projects")),l=e("constant"),c=e("g3w-ol/projection/projections"),d=e("core/utils/utils").XHR,r.default={name:"change-map-menu",data:function(){return{state:null,loading:!1,current:"projects",items:[],parent:null,steps:[],currentProjectGroupId:null}},computed:{isChildNode:function(){return"root"!==this.current}},methods:{setFallBackImage:function(e){var t=""+o.default.getConfig().urls.clienturl+l.LOGO_GIS3W;e.thumbnail||e.logo_img?e.thumbnail=t:e.header_logo_img&&(e.header_logo_img=t)},back:function(){var e;1<this.steps.length?(e=this.steps[0],this.steps=[],this.showGroups(e)):this.showRoot()},showRoot:function(){this.current="root",this.items=this.macrogroupsandgroups,this.steps=[]},_onChangeRoot:function(e){void 0===e.srid?this.showGroups(e):this.showProjects(e)},showGroups:(u=h(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,this.parent=t,e.prev=2,e.next=5,d.get({url:encodeURI("/"+o.default.getApplicationUser().i18n+l.API_BASE_URLS.ABOUT.group+t.id+"/")});case 5:this.items=e.sent,this.current="groups",e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),this.items=[];case 12:this.steps.push(this.parent),this.loading=!1;case 14:case"end":return e.stop()}},e,this,[[2,9]])})),function(e){return u.apply(this,arguments)}),showProjects:(a=h(regeneratorRuntime.mark(function e(t){var r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loading=!0,this.parent=t,this.parent.id!==this.currentProjectGroupId?e.next=7:(this.items=s.default.getListableProjects(),this.current="projects",e.next=18);break;case 7:return e.prev=7,e.next=10,d.get({url:encodeURI("/"+o.default.getApplicationUser().i18n+l.API_BASE_URLS.ABOUT.projects.replace("__G3W_GROUP_ID__",t.id))});case 10:this.items=e.sent,this.items.forEach(function(e){return r.setItemImageSrc({item:e,type:"project"})}),this.current="projects",e.next=18;break;case 15:e.prev=15,e.t0=e.catch(7),this.items=[];case 18:this.steps.push(this.parent),this.loading=!1;case 20:case"end":return e.stop()}},e,this,[[7,15]])})),function(e){return a.apply(this,arguments)}),changeMapProject:(i=h(regeneratorRuntime.mark(function e(t){var r,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=void 0,n=s.default.getBaseUrl(),i=this.parent.srid?"EPSG:"+this.parent.srid:this.parent.crs.epsg,e.next=5,c.registerProjection(i);case 5:try{new URL(n),r=""+n+(t.url||t.map_url.replace(/^\//,""))}catch(e){r=""+location.origin+n+(t.url||t.map_url.replace(/^\//,""))}return e.abrupt("return",o.default.changeMapProject({url:r,epsg:i}));case 7:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)}),trigger:(n=h(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.current,e.next="root"===e.t0?3:"macrogroup"===e.t0?4:"groups"===e.t0?5:"projects"===e.t0?8:11;break;case 3:return e.abrupt("return",this._onChangeRoot(t));case 4:return e.abrupt("return",this.showGroups(t));case 5:return e.next=7,this.showProjects(t);case 7:return e.abrupt("return",e.sent);case 8:return e.next=10,this.changeMapProject(t);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)}),setItemImageSrc:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.item;switch(e.type){case"project":t.thumbnail=this._setSrc(t.thumbnail);break;case"group":t.header_logo_img=this._setSrc(t.header_logo_img);break;case"macrogroup":t.logo_img=this._setSrc(t.logo_img)}},_setSrc:function(e){var t=this.$options.host||"",r=s.default.config.mediaurl,n=o.default.getConfig().urls.clienturl,i=e&&-1!==e.indexOf(r),a=e&&-1===e.indexOf("static")&&-1===e.indexOf("media");return""+t+(e?i?e:a?""+r+e:""+n+l.LOGO_GIS3W:""+n+l.LOGO_GIS3W)}},created:function(){var e,t=this;this.items=s.default.getListableProjects(),this.items.forEach(function(e){return t.setItemImageSrc({item:e,type:"project"})}),this.parent=s.default.getCurrentProjectGroup(),this.currentProjectGroupId=this.parent.id,this.macrogroups=o.default.getConfig().macrogroups,this.macrogroups.forEach(function(e){return t.setItemImageSrc({item:e,type:"magrocroup"})}),this.groups=o.default.getConfig().groups,this.groups.forEach(function(e){return t.setItemImageSrc({item:e,type:"group"})}),this.macrogroupsandgroups=[].concat(f(this.macrogroups),f(this.groups)),this.macrogroups.find(function(e){return e.id===t.parent.id})&&(e=this.groups.find(function(e){return e.id===t.parent.id}))&&(this.parent=e,this.currentProjectGroupId=this.parent.id),0===this.items.length&&this.showRoot()}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("div",{attrs:{id:"g3w-change-map-menu"}},[r.isChildNode?[n("div",{staticClass:"skin-background-color",staticStyle:{display:"flex","align-items":"center",color:"#ffffff"}},[n("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:bottom.create",value:"change_session",expression:"'change_session'",arg:"bottom",modifiers:{create:!0}},{name:"disabled",rawName:"v-disabled",value:r.loading,expression:"loading"}],staticStyle:{"font-size":"2em",margin:"5px",cursor:"pointer",padding:"3px",border:"2px solid #ffffff","border-radius":"3px"},on:{click:function(e){return e.stopPropagation(),r.back(e)}}},[n("i",{class:r.g3wtemplate.getFontClass("reply"),staticStyle:{color:"#FFFFFF"}})]),r._v(" "),r.parent?n("div",{staticStyle:{margin:"auto"}},[n("h3",{staticStyle:{"font-weight":"bold"}},[r._v(r._s(r.parent.title||r.parent.name))])]):r._e()])]:r._e(),r._v(" "),r.items.length?n("div",{staticClass:"g3w-change-map-menu-container"},r._l(r.items,function(t){return n("div",{key:t.title,staticClass:"menu-item"},[n("div",{staticClass:"menu-item-image",on:{click:function(e){return e.stopPropagation(),r.trigger(t)}}},[n("img",{staticClass:"img-responsive",attrs:{src:t.thumbnail||t.header_logo_img||t.logo_img,alt:"logo"},on:{error:function(e){return r.setFallBackImage(t)}}})]),r._v(" "),n("div",{staticClass:"menu-item-content"},[n("div",{staticClass:"menu-item-text"},[n("h4",{staticClass:"menu-item-title"},[r._v(r._s(t.title))]),r._v(" "),n("div",{domProps:{innerHTML:r._s(t.description)}})])])])}),0):[n("h3",{directives:[{name:"t",rawName:"v-t",value:"no_other_"+r.current,expression:"`no_other_${current}`"}],staticStyle:{"font-weight":"bold"}})]],2)},e.staticRenderFns=[],e._scopeId="data-v-70b4a3a6"},{constant:4,"core/utils/utils":68,"g3w-ol/projection/projections":111,"services/application":351,"store/projects":379,"vueify/lib/insert-css":1}],205:[function(e,t,r){e("vueify/lib/insert-css").insert(".field[data-v-3e1ec915]{background-color:transparent!important;padding-top:3px;padding-bottom:3px;display:flex;align-items:center}.value[data-v-3e1ec915]{position:relative}.field div[data-v-3e1ec915]{padding-left:3px;padding-right:3px}.field_value[data-v-3e1ec915]{padding-left:0!important}");Object.defineProperty(r,"__esModule",{value:!0}),r.default={name:"field",props:["state"]},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("div",{staticClass:"field",style:{fontSize:e.isMobile()&&"0.8em"}},[e.state.label?t("div",{staticClass:"col-sm-6  field_label"},[e._t("label",[e._v(e._s(e.state.label))])],2):e._e(),e._v(" "),t("div",{staticClass:"field_value",class:[e.state.label?"col-sm-6":null]},[e._t("field",[t("span",{staticStyle:{"word-wrap":"break-word"},domProps:{innerHTML:e._s(e.state.value)}})])],2)])},e.staticRenderFns=[],e._scopeId="data-v-3e1ec915"},{"vueify/lib/insert-css":1}],206:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=e("gui/fields/fieldsservice"),e=e("gui/fields/fields"),r.default={name:"g3w-field",props:{state:{required:!0},feature:{type:Object}},components:n({},e),created:function(){this.type=i.getType(this.state)}},t.exports.__esModule&&(t.exports=t.exports.default);var n,i,r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var e=this.$createElement;return(this._self._c||e)(this.type,{tag:"component",attrs:{feature:this.feature,state:this.state}})},r.staticRenderFns=[],r._scopeId="data-v-92197af4"},{"gui/fields/fields":120,"gui/fields/fieldsservice":121}],207:[function(e,t,r){e("vueify/lib/insert-css").insert(".show-hide-geo[data-v-0d97c5ac]{color:#3c8dbc;cursor:pointer;font-size:1.2em}");Object.defineProperty(r,"__esModule",{value:!0}),e=e("mixins"),r.default={name:"g3w-geospatial",props:{data:{}},mixins:[e.geoMixin],data:function(){return{layerId:"table_layer_"+Date.now(),visible:!1,id:"geo_table_"+Date.now()}}},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",{staticClass:"geo-content"},[e("span",{staticClass:"show-hide-geo",class:[t.visible?t.g3wtemplate.font["eye-close"]:t.g3wtemplate.font.eye],on:{click:function(e){return e.stopPropagation(),t.showLayer()}}})])},r.staticRenderFns=[],r._scopeId="data-v-0d97c5ac"},{mixins:343,"vueify/lib/insert-css":1}],208:[function(e,t,r){e("vueify/lib/insert-css").insert(".img-responsive[data-v-2c267414]{cursor:pointer}");Object.defineProperty(r,"__esModule",{value:!0}),n=(n=n=e("components/Field.vue"))&&n.__esModule?n:{default:n},i=e("core/utils/utils").toRawType,r.default={name:"field-image",props:["state"],data:function(){return{galleryId:"gallery_"+Date.now(),active:null,value:(void 0!==this.state.value.mime_type?this.state.value:this.state).value}},components:{Field:n.default},computed:{values:function(){return Array.isArray(this.value)?this.value:[this.value]}},methods:{getSrc:function(e){return"Object"===i(e)?e.photo:e},showGallery:function(e){this.active=e,"Object"===i(this.value)&&(this.value.active=!0),$("#"+this.galleryId).modal("show")},getGalleryImages:function(){var t=this;return this.values.map(function(e){return{src:t.getSrc(e)}})}}},t.exports.__esModule&&(t.exports=t.exports.default);var n,i,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("field",{attrs:{state:r.state}},[n("div",{staticStyle:{"text-align":"left"},attrs:{slot:"field"},slot:"field"},[r._l(r.values,function(e,t){return n("img",{staticClass:"img-responsive",staticStyle:{"max-height":"50px"},attrs:{src:r.getSrc(e)},on:{click:function(e){return r.showGallery(t)}}})}),r._v(" "),n("g3w-images-gallery",{attrs:{id:r.galleryId,active:r.active,images:r.getGalleryImages()}})],2)])},e.staticRenderFns=[],e._scopeId="data-v-2c267414"},{"components/Field.vue":205,"core/utils/utils":68,"vueify/lib/insert-css":1}],209:[function(e,t,r){e("vueify/lib/insert-css").insert(".field_link[data-v-fc346ca2]{max-width:100%}");Object.defineProperty(r,"__esModule",{value:!0}),n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e=(e=e=e("components/Field.vue"))&&e.__esModule?e:{default:e},r.default={name:"field-link",props:["state"],data:function(){return{value:null}},components:{Field:e.default},methods:{openLink:function(e){window.open(e,"_blank")}},created:function(){this.value=(this.state.value&&"object"===n(this.state.value)?this.state.value:this.state).value}},t.exports.__esModule&&(t.exports=t.exports.default);var n,r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("field",{attrs:{state:t.state}},[e("button",{directives:[{name:"t",rawName:"v-t",value:"info.link_button",expression:"'info.link_button'"}],staticClass:"btn skin-button field_link",attrs:{slot:"field"},on:{click:function(e){return t.openLink(t.value)}},slot:"field"})])},r.staticRenderFns=[],r._scopeId="data-v-fc346ca2"},{"components/Field.vue":205,"vueify/lib/insert-css":1}],210:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),e=e("mixins"),r.default={name:"g3w-media",mixins:[e.mediaMixin],props:["state"],computed:{type:function(){return this.getMediaType(this.state.mime_type).type},value:function(){return this.state.value}}},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var e=this,t=e.$createElement,t=e._self._c||t;return e.value?t("div",{staticClass:"preview"},[t("a",{attrs:{href:e.value,target:"_blank"}},[t("div",{staticClass:"previewtype",class:e.type},[t("i",{staticClass:"fa-2x",class:e.g3wtemplate.font[e.type]})])]),e._v(" "),t("div",{staticClass:"filename"},[e._v(e._s(e.filename))]),e._v(" "),e._t("default")],2):e._e()},r.staticRenderFns=[],r._scopeId="data-v-c44dc002"},{mixins:343}],211:[function(e,t,r){e("vueify/lib/insert-css").insert(".field_text_table[data-v-0234e53c]{background-color:transparent!important}.field_text_table .field_label[data-v-0234e53c]{font-weight:700}");Object.defineProperty(r,"__esModule",{value:!0}),e=(e=e=e("components/Field.vue"))&&e.__esModule?e:{default:e},r.default={name:"field-text",props:["state"],components:{Field:e.default},created:function(){}},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var e=this.$createElement;return(this._self._c||e)("field",{attrs:{state:this.state}})},r.staticRenderFns=[],r._scopeId="data-v-0234e53c"},{"components/Field.vue":205,"vueify/lib/insert-css":1}],212:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),e=(e=e=e("components/Field.vue"))&&e.__esModule?e:{default:e},r.default={name:"vuefield",props:{feature:{type:Object},state:{type:Object,default:{value:null,vueoptions:{component:{}}}}},components:{Field:e.default}},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var e=this.$createElement,e=this._self._c||e;return e("field",{attrs:{state:this.state}},[e("div",{attrs:{slot:"field"},slot:"field"},[e(this.state.vueoptions.component,{tag:"component",attrs:{feature:this.feature,value:this.state.value}})],1)])},r.staticRenderFns=[],r._scopeId="data-v-41d5dd61"},{"components/Field.vue":205}],213:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),e=e("services/floatbar"),n=(e=e)&&e.__esModule?e:{default:e},r.default={name:"Floatbar",data:function(){return{stack:n.default.stack.state}},computed:{panelsinstack:function(){return 0<this.stack.contentsdata.length},panelname:function(){var e=void 0;return e=this.stack.contentsdata.length?this.stack.contentsdata.slice(-1)[0].content.getTitle():e},closable:function(){return n.default.closable}},watch:{"stack.contentsdata":function(){var r=$("#g3w-floatbarpanel-placeholder").children();r.forEach(function(e,t){t==r.length-1?$(e).show():$(e).hide()})}},methods:{closePanel:function(){n.default.closePanel()}}},t.exports.__esModule&&(t.exports=t.exports.default);var n,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("aside",{staticClass:"control-sidebar control-sidebar-light"},[t("a",{directives:[{name:"show",rawName:"v-show",value:e.panelsinstack,expression:"panelsinstack"}],staticClass:"floatbar-aside-toggle",attrs:{href:"#","data-toggle":"control-sidebar",role:"button"}},[t("span",{staticClass:"sr-only"},[e._v("Expand")])]),e._v(" "),t("div",{staticStyle:{position:"absolute"},attrs:{id:"floatbar-spinner"}}),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.panelsinstack,expression:"panelsinstack"}],staticClass:"g3w-sidebarpanel"},[e.closable?t("div",{staticClass:"row"},[t("div",{staticClass:"col-xs-12 col-sm-12 col-md-12"},[t("button",{staticClass:"pull-right close-panel-button",class:e.g3wtemplate.getFontClass("close"),on:{click:e.closePanel}})])]):e._e(),e._v(" "),e.panelname?t("div",[t("h4",{staticClass:"g3w-floatbarpanel-name"},[e._v(e._s(e.panelname))])]):e._e(),e._v(" "),t("div",{staticClass:"g3w-floatbarpanel-placeholder",attrs:{id:"g3w-floatbarpanel-placeholder"}})])])},e.staticRenderFns=[],e._scopeId="data-v-03e575ec"},{"services/floatbar":360}],214:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),o=n(e("components/FormHeader.vue")),e=n(e("components/FormFooter.vue")),r.default={name:"g3w-form",data:function(){return{state:{},switchcomponent:!1,body:{components:{before:[],after:[]}}}},components:{g3wformheader:o.default,G3wFormFooter:e.default},transitions:{addremovetransition:"showhide"},methods:{isRootComponent:function(e){return this.$options.service.isRootComponent(e)},backToRoot:function(){this.$options.service.setRootComponent()},handleRelation:function(e){this.$options.service.handleRelation(e)},disableComponent:function(e){var t=e.id,e=e.disabled;this.$options.service.disableComponent({id:t,disabled:void 0!==e&&e})},resizeForm:function(e){this.$options.service.setCurrentFormPercentage(e)},switchComponent:function(e){this.switchcomponent=!0,this.$options.service.setCurrentComponentById(e)},changeInput:function(e){return this.$options.service.changeInput(e)},addToValidate:function(e){this.$options.service.addToValidate(e)},removeToValidate:function(e){this.$options.service.removeToValidate(e)},reloadLayout:function(){var e,t,r=$(this.$el).height();r&&(t=$(this.$refs.g3w_form_footer.$el),e=$(this.$refs.g3wform_body),t=t.height()?t.height()+50:50,r=r-($(this.$refs.g3wformheader.$el).height()+t),e.height(r))}},updated:(a=i(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.switchcomponent&&setTimeout(function(){return t.switchcomponent=!1},0);case 3:case"end":return e.stop()}},e,this)})),function(){return a.apply(this,arguments)}),created:function(){var r=this;this.$options.service.getEventBus().$on("set-main-component",function(){r.switchComponent(0)}),this.$options.service.getEventBus().$on("component-validation",function(e){var t=e.id,e=e.valid;r.$options.service.setValidComponent({id:t,valid:e})}),this.$options.service.getEventBus().$on("addtovalidate",this.addToValidate),this.$options.service.getEventBus().$on("disable-component",this.disableComponent)},mounted:function(){this.$options.service.isValid(),this.$options.service.setReady(!0)},beforeDestroy:function(){this.$options.service.clearAll()}},t.exports.__esModule&&(t.exports=t.exports.default);var a,o,r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"g3wform_content",staticStyle:{position:"relative"}},[r("bar-loader",{attrs:{loading:t.state.loading}}),t._v(" "),r("g3wformheader",{ref:"g3wformheader",attrs:{currentid:t.state.currentheaderid,headers:t.state.headers,update:t.state.update,valid:t.state.valid},on:{"resize-form":t.resizeForm,clickheader:t.switchComponent}}),t._v(" "),r("div",{ref:"g3wform_body",staticClass:"g3wform_body"},[t._l(t.body.components.before,function(e){return r(e,{tag:"component",attrs:{fields:t.state.fields}})}),t._v(" "),r("keep-alive",[r(t.state.component,{tag:"component",attrs:{handleRelation:t.handleRelation,state:t.state},on:{"hook:activated":t.reloadLayout,addtovalidate:t.addToValidate,removetovalidate:t.removeToValidate,changeinput:t.changeInput}})],1),t._v(" "),t._l(t.body.components.after,function(e){return r(e,{tag:"component",attrs:{fields:t.state.fields}})})],2),t._v(" "),r("g3w-form-footer",{ref:"g3w_form_footer",attrs:{isRootComponent:t.isRootComponent,backToRoot:t.backToRoot,state:t.state}})],1)},r.staticRenderFns=[]},{"components/FormFooter.vue":216,"components/FormHeader.vue":217}],215:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),e=(e=e=e("components/InputG3WFormInputs.vue"))&&e.__esModule?e:{default:e},r.default=Vue.extend({name:"form-body",props:["state","handleRelation"],data:function(){return{show:!0}},components:{G3wFormInputs:e.default},methods:{addToValidate:function(e){this.$emit("addtovalidate",e)},removeToValidate:function(e){this.$emit("removetovalidate",e)},changeInput:function(e){this.$emit("changeinput",e)}},computed:{hasFormStructure:function(){return!!this.state.formstructure}}}),t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("div",[t("form",{staticClass:"form-horizontal g3w-form"},[t("div",{staticClass:"box-primary"},[t("div",{staticClass:"box-body"},[e.hasFormStructure?[t("tabs",{attrs:{layerid:e.state.layerid,feature:e.state.feature,handleRelation:e.handleRelation,contenttype:"editing",addToValidate:e.addToValidate,changeInput:e.changeInput,removeToValidate:e.removeToValidate,tabs:e.state.formstructure,fields:e.state.fields}})]:[t("g3w-form-inputs",{attrs:{state:e.state,addToValidate:e.addToValidate,removeToValidate:e.removeToValidate,changeInput:e.changeInput},on:{changeinput:e.changeInput,addinput:e.addToValidate,removeinput:e.removeToValidate}})]],2)])])])},r.staticRenderFns=[]},{"components/InputG3WFormInputs.vue":240}],216:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.default=Vue.extend({name:"form-footer",props:{state:{type:Object},backToRoot:{type:Function,default:function(){}},isRootComponent:{type:Function}},data:function(){return this.originalbuttons=this.state.buttons.map(function(e){return i({},e)}),{id:"footer",active:!0,show:!0}},computed:{enableSave:function(){return this.state.valid&&this.state.update}},methods:{exec:function(e){e instanceof Function?e(this.state.fields):function(){this.state.fields}()},btnEnabled:function(e){var t=e.enabled,e=e.type;return(void 0===t||t)&&("save"!==e||"save"===e&&this.enableSave)},isValid:function(){return this.state.valid}},watch:{"state.component":function(e){this.show=this.isRootComponent(e)},"state.update":{immediate:!0,handler:function(r){var n=this;this.state.buttons.find(function(e,t){e.eventButtons&&e.eventButtons.update&&(e.eventButtons.update[r]?n.state.buttons.splice(t,1,i({},e,e.eventButtons.update[r])):n.state.buttons.splice(t,1,n.originalbuttons[t]))})}}},activated:function(){this.active=!0},deactivated:function(){this.active=!1}}),t.exports.__esModule&&(t.exports=t.exports.default);var i,r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("div",{staticClass:"form-group g3wform_footer"},[r.show?[r._t("default",[n("div",{staticStyle:{margin:"3px","font-weight":"bold"}},[r._v("\n        * "),n("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.form.footer.required_fields",expression:"'sdk.form.footer.required_fields'"}]}),r._v(" "),r.state.footer.message?n("div",{style:[r.state.footer.style]},[r._v(r._s(r.state.footer.message))]):r._e()]),r._v(" "),r._l(r.state.buttons,function(t){return n("button",{directives:[{name:"disabled",rawName:"v-disabled",value:!r.btnEnabled(t),expression:"!btnEnabled(button)"},{name:"t",rawName:"v-t",value:t.title,expression:"button.title"}],key:t.id,staticClass:"btn ",class:[t.class],attrs:{update:r.state.update,valid:r.state.valid},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),r.exec(t.cbk)}}})})])]:[n("button",{directives:[{name:"t",rawName:"v-t",value:"back",expression:"'back'"}],staticClass:"btn skin-button",on:{click:function(e){return!e.type.indexOf("key")&&r._k(e.keyCode,"prevet",void 0,e.key,void 0)?null:(e.stopPropagation(),r.backToRoot(e))}}})]],2)},r.staticRenderFns=[]},{}],217:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=Vue.extend({name:"form-header",props:{headers:{type:Array,default:[]},currentid:{type:String},update:{type:Boolean},valid:{type:Boolean}},methods:{click:function(e){this.currentid!==e&&1<this.headers.length&&this.$emit("clickheader",e)},resizeForm:function(e){this.$emit("resize-form",e)}}}),t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("div",{staticClass:"g3wform_header box-header with-border",staticStyle:{display:"flex","flex-direction":"column"}},[n("section",{staticClass:"g3wform_header_content"},r._l(r.headers,function(t){return n("span",{key:t.id,staticClass:"title",class:[{item_selected:r.currentid===t.id&&1<r.headers.length},[1<r.headers.length?"tabs":"one"]],staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"},style:{fontSize:r.isMobile()&&"1em !important"},on:{click:function(e){return e.stopPropagation(),r.click(t.id)}}},[t.icon?n("span",{staticStyle:{"margin-right":"5px"}},[n("i",{class:t.icon})]):r._e(),r._v(" "),n("span",{directives:[{name:"t",rawName:"v-t:pre",value:t.title,expression:"header.title",arg:"pre"}],staticClass:"g3w-long-text"},[r._v(r._s(t.name))]),r._v(" "),n(t.component,{tag:"component",attrs:{valid:r.valid,update:r.update}})],1)}),0)])},r.staticRenderFns=[]},{}],218:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default={name:"bar-loader",props:["loading","color"],render:function(e){if(this.loading)return e("div",{style:{backgroundColor:this.color||"#FFFFFF",border:0},class:{"bar-loader":!0}})}}},{}],219:[function(e,t,r){function n(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),u=e("store/application-state"),i=(u=u)&&u.__esModule?u:{default:u},l=e("core/utils/utils").getUniqueDomId,r.default={name:"datetime",props:{type:{type:String,default:"date"},format:{type:String,default:"YYYY-MM-DD"},minDate:{default:!1},maxDate:{default:!1},enabledDates:{default:!1},value:{},label:{default:"Date"}},data:function(){return{datetimevalue:this.value}},methods:{changeInput:function(e){},change:function(e){e=moment(e).format(this.format);this.$emit("change",e)}},mounted:(s=n(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.datetimeinputelement=$(this.$refs.iddatetimepicker),this.datetimeinputelement.datetimepicker({minDate:this.minDate,maxDate:this.maxDate,defaultDate:this.datetimevalue,useCurrent:!1,allowInputToggle:!0,enabledDates:this.enabledDates,showClose:!0,format:this.format,locale:i.default.language,toolbarPlacement:"top",widgetPositioning:{horizontal:"right"}}),this.datetimeinputelement.on("dp.change",function(e){e=e.date;t.change(e)}),this.datetimeinputelement.on("dp.hide",function(e){}),i.default.ismobile&&setTimeout(function(){return datetimeinputelement.blur()});case 7:case"end":return e.stop()}},e,this)})),function(){return s.apply(this,arguments)}),watch:{value:function(e){this.datetimevalue=e,this.datetimeinputelement.data("DateTimePicker").date(e)},minDate:(o=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.datetimeinputelement.data("DateTimePicker").minDate(t);case 1:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)}),maxDate:(a=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.datetimeinputelement.data("DateTimePicker").maxDate(t);case 1:case"end":return e.stop()}},e,this)})),function(e){return a.apply(this,arguments)}),enabledDates:function(e){this.datetimeinputelement.data("DateTimePicker").enabledDates(e)}},created:function(){this.id=l()}},t.exports.__esModule&&(t.exports=t.exports.default);var i,a,o,s,l,u="function"==typeof t.exports?t.exports.options:t.exports;u.render=function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("div",{ref:"datimecontainer"},[t("label",{directives:[{name:"t",rawName:"v-t",value:e.label,expression:"label"}],staticStyle:{display:"block"},attrs:{for:e.id}}),e._v(" "),t("div",{staticClass:"form-group"},[t("div",{ref:"iddatetimepicker",staticClass:"input-group date"},[t("input",{ref:"idinputdatetimepiker",staticClass:"form-control",attrs:{id:e.id,type:"text"},on:{change:e.changeInput}}),e._v(" "),t("span",{staticClass:"input-group-addon caret"},[t("span",{staticClass:"datetimeinput",class:["time"===e.type?e.g3wtemplate.getFontClass("time"):e.g3wtemplate.getFontClass("calendar")]})])])])])},u.staticRenderFns=[],u._scopeId="data-v-63ff8e5a"},{"core/utils/utils":68,"store/application-state":373}],220:[function(e,t,r){e("vueify/lib/insert-css").insert(".divider[data-v-2417f111]{display:block;position:relative;padding:0;margin-bottom:5px;height:0;width:100%;max-height:0;font-size:1px;line-height:0;clear:both;border:none;border-bottom:2px solid #eee}");Object.defineProperty(r,"__esModule",{value:!0}),r.default={name:"divider"},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this.$createElement;return(this._self._c||e)("span",{staticClass:"divider"})},e.staticRenderFns=[],e._scopeId="data-v-2417f111"},{"vueify/lib/insert-css":1}],221:[function(e,t,r){e("vueify/lib/insert-css").insert('.modal-content[data-v-0e2cde6c]{background:hsla(0,0%,100%,.6);border-radius:3px}.modal-dialog[data-v-0e2cde6c]{display:inline-block;text-align:left;vertical-align:middle}.modal[data-v-0e2cde6c]{text-align:center;padding:0!important}.modal[data-v-0e2cde6c]:before{content:"";display:inline-block;height:100%;vertical-align:middle;margin-right:-4px}.carousel .carousel-control span[data-v-0e2cde6c]{color:#3c8dbc}');Object.defineProperty(r,"__esModule",{value:!0}),e=e("store/projects"),n=(e=e)&&e.__esModule?e:{default:e},r.default={name:"g3w-images-gallery",props:{images:{type:Array,default:[]},id:{type:String,default:"gallery"},active:{type:Number}},data:function(){return{carouselId:"carousel_"+Date.now()}},methods:{isActive:function(e){return e===active},isRelativePath:function(e){return _.startsWith(e,"/")||_.startsWith(e,"http")?e:n.default.getConfig().mediaurl+e}}},t.exports.__esModule&&(t.exports=t.exports.default);var n,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("div",{staticClass:"modal fade modal-fullscreen force-fullscreen",attrs:{id:r.id,tabindex:"-1",role:"dialog","aria-labelledby":"","aria-hidden":"true"}},[n("div",{staticClass:"modal-dialog"},[n("div",{staticClass:"modal-content"},[n("div",{staticClass:"modal-body"},[n("div",{staticClass:"carousel slide",attrs:{id:r.carouselId,"data-interval":"false"}},[n("div",{staticClass:"carousel-inner"},r._l(r.images,function(e,t){return n("div",{staticClass:"item",class:r.active==t?"active":""},[n("img",{staticStyle:{margin:"auto"},attrs:{src:r.isRelativePath(e.src)}})])}),0),r._v(" "),1<r.images.length?n("a",{staticClass:"left carousel-control",attrs:{href:"#"+r.carouselId,role:"button","data-slide":"prev"}},[n("span",{class:r.g3wtemplate.getFontClass("arrow-left")})]):r._e(),r._v(" "),1<r.images.length?n("a",{staticClass:"right carousel-control",attrs:{href:"#"+r.carouselId,role:"button","data-slide":"next"}},[n("span",{class:r.g3wtemplate.getFontClass("arrow-left")})]):r._e()])])])])])},e.staticRenderFns=[],e._scopeId="data-v-0e2cde6c"},{"store/projects":379,"vueify/lib/insert-css":1}],222:[function(e,t,r){e("vueify/lib/insert-css").insert(".show-hide-geo[data-v-11a0fd6e]{color:#3c8dbc;cursor:pointer;font-size:1.2em}");Object.defineProperty(r,"__esModule",{value:!0}),e=e("mixins"),r.default={name:"g3w-geospatial",props:{data:{}},mixins:[e.geoMixin],data:function(){return{layerId:"table_layer_"+Date.now(),visible:!1,id:"geo_table_"+Date.now()}}},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",{staticClass:"geo-content"},[e("span",{staticClass:"show-hide-geo",class:[t.visible?t.g3wtemplate.getFontClass("eye-close"):t.g3wtemplate.getFontClass("eye")],on:{click:function(e){return e.stopPropagation(),t.showLayer()}}})])},r.staticRenderFns=[],r._scopeId="data-v-11a0fd6e"},{mixins:343,"vueify/lib/insert-css":1}],223:[function(e,t,r){e("vueify/lib/insert-css").insert(".help_div_container[data-v-1d453408]{color:#fff;text-align:justify;position:relative;border-radius:3px;margin:5px 2px;white-space:pre-line;background-color:#384246!important}.help_icon[data-v-1d453408]{text-align:center;font-size:.7em;margin-top:-4px;margin-left:-4px;background-color:#222d32;font-weight:700;color:#fff;position:absolute;top:0;left:0;width:15px;height:15px;box-shadow:0 3px 5px rgba(0,0,0,.5);border:1px solid #fff;border-radius:50%}.g3w-help-message-content[data-v-1d453408]{max-height:200px;padding:10px;overflow-y:auto}");Object.defineProperty(r,"__esModule",{value:!0}),r.default={name:"helpdiv",props:{message:{type:String,required:!0},type:{type:String,default:"info"}}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this.$createElement,e=this._self._c||e;return e("div",{staticClass:"help_div_container"},[e("span",{staticClass:"help_icon"},[this._v("i")]),this._v(" "),e("div",{directives:[{name:"t",rawName:"v-t",value:this.message,expression:"message"}],staticClass:"g3w-help-message-content"})])},e.staticRenderFns=[],e._scopeId="data-v-1d453408"},{"vueify/lib/insert-css":1}],224:[function(e,t,r){e("vueify/lib/insert-css").insert(".img-responsive[data-v-66f7e35a]{cursor:pointer}.g3w-image[data-v-66f7e35a]{padding-left:0!important;min-width:100px;max-width:100%;cursor:pointer}");Object.defineProperty(r,"__esModule",{value:!0}),n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e=(e=e=e("components/GlobalGallery.vue"))&&e.__esModule?e:{default:e},r.default={name:"g3w-image",props:{value:{}},data:function(){return{galleryId:"gallery_"+Date.now(),active:null}},components:{"g3w-images-gallery":e.default},computed:{values:function(){return Array.isArray(this.value)?this.value:[this.value]}},methods:{getSrc:function(e){return"object"===(void 0===e?"undefined":n(e))?e.photo:e},showGallery:function(e){this.active=e,"object"===n(this.value)&&(this.value.active=!0),$("#"+this.galleryId).modal("show")},getGalleryImages:function(){var t=this,r=[];return this.values.forEach(function(e){r.push({src:t.getSrc(e)})}),r}},created:function(){}},t.exports.__esModule&&(t.exports=t.exports.default);var n,r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("div",{staticClass:"container-fluid"},[n("div",{staticClass:"row"},r._l(r.values,function(e,t){return n("div",{staticClass:"g3w-image col-md-6 col-sm-12"},[n("img",{staticClass:"img-thumbnail",attrs:{src:r.getSrc(e)},on:{click:function(e){return r.showGallery(t)}}})])}),0),r._v(" "),n("g3w-images-gallery",{attrs:{id:r.galleryId,active:r.active,images:r.getGalleryImages()}})],1)},r.staticRenderFns=[],r._scopeId="data-v-66f7e35a"},{"components/GlobalGallery.vue":221,"vueify/lib/insert-css":1}],225:[function(e,t,r){e("vueify/lib/insert-css").insert(".g3w-layer-positions[data-v-4b2d4451]{display:flex;flex-direction:column;margin:5px 0}.g3w-layer-positions-info-message[data-v-4b2d4451]{margin-bottom:5px;font-weight:700}.g3w-layer-positions-checkboxes[data-v-4b2d4451]{display:flex;justify-content:space-between}");Object.defineProperty(r,"__esModule",{value:!0}),n=e("app/constant"),i=e("core/utils/utils").getUniqueDomId,r.default={name:"layerspositions",props:{position:{type:String,default:n.MAP_SETTINGS.LAYER_POSITIONS.default}},data:function(){return{layerpositions:n.MAP_SETTINGS.LAYER_POSITIONS.getPositions()}},methods:{change:function(){this.$emit("layer-position-change",this.position)}},created:function(){var t=this;this.ids={layerpositions:i()},this.layerpositions.forEach(function(e){return t.ids[e]=i()}),this.change()}},t.exports.__esModule&&(t.exports=t.exports.default);var n,i,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("div",{staticClass:"g3w-layer-positions",attrs:{id:r.ids.layerpositions}},[n("div",{directives:[{name:"t",rawName:"v-t",value:"layer_position.message",expression:"`layer_position.message`"}],staticClass:"g3w-layer-positions-info-message"}),r._v(" "),n("div",{staticClass:"g3w-layer-positions-checkboxes"},r._l(r.layerpositions,function(t){return n("div",{key:t},[n("input",{directives:[{name:"model",rawName:"v-model",value:r.position,expression:"position"}],staticClass:"form-control magic-radio",attrs:{type:"radio",id:r.ids[t]},domProps:{value:t,checked:r.position===t,checked:r._q(r.position,t)},on:{change:[function(e){r.position=t},r.change]}}),r._v(" "),n("label",{directives:[{name:"t",rawName:"v-t",value:"layer_position."+t,expression:"`layer_position.${layerposition}`"}],attrs:{for:r.ids[t]}})])}),0)])},e.staticRenderFns=[],e._scopeId="data-v-4b2d4451"},{"app/constant":4,"core/utils/utils":68,"vueify/lib/insert-css":1}],226:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default={name:"progressbar",props:["progress"],render:function(e){if(null!==this.progress&&void 0!==this.progress)return e("div",{style:{margin:"5px 0 5px 0",width:"100%",backgroundColor:"#FFFFFF",border:0,borderRadius:"3px"}},[e("div",{style:{width:(this.progress<10?10:this.progress)+"%",display:"flex",justifyContent:"center",fontWeight:"bold"},class:{"skin-background-color":!0}},[e("span",this.progress+"%")])])}}},{}],227:[function(e,t,r){var n,i;e("vueify/lib/insert-css").insert(".min-max-label[data-v-57e24596]{align-self:end;font-weight:700}");function a(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),i=e("core/utils/utils").debounce,r.default={name:"range",props:{id:{required:!0},label:{type:"String",default:""},min:{type:Number,default:0},max:{type:Number,default:10},step:{type:Number,default:1},labelValue:{},value:{default:0},sync:{type:Boolean,default:!1},showValue:{type:Boolean,default:!1},unit:{type:String,default:""}},data:function(){return{}},methods:{changeBackGround:function(e){this.$refs["range-input"].style.backgroundSize=(e?100*(e-this.min)/(this.max-this.min):0)+"% 100%"},setValue:function(e){this.changedValue(e)},change:function(e){e=+e.target.value;this.changedValue(e)},emitChangeValue:function(e){this.value=e,this.$emit("change-range",{id:this.id,value:e})}},watch:{value:function(e){this.changeBackGround(e),this.sync&&this.emitChangeValue(e)}},created:function(){var t=this;this.changedValue=this.sync?function(){return t.$emit("changed")}:i(function(e){t.emitChangeValue(e)})},mounted:(n=a(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.changeBackGround(this.value);case 3:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)}),beforeDestroy:function(){}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",[e("section",{staticStyle:{display:"flex","justify-content":"space-between","font-weight":"bold"}},[e("section",{staticStyle:{"align-self":"flex-end"}},[e("span",{staticClass:"min-max-label"},[t._v(t._s(t.min))]),t._v(" "),e("span",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(t.unit))])]),t._v(" "),e("div",{staticStyle:{display:"flex","flex-direction":"column",margin:"0 3px"}},[e("label",{directives:[{name:"t",rawName:"v-t",value:t.label,expression:"label"}],staticClass:"skin-color",staticStyle:{display:"block"},attrs:{for:t.id}}),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],ref:"range-input",attrs:{type:"range",id:t.id,min:t.min,max:t.max,step:t.step},domProps:{value:t.value},on:{change:t.change,__r:function(e){t.value=e.target.value}}})]),t._v(" "),e("section",{staticStyle:{"align-self":"flex-end"}},[e("span",{staticClass:"min-max-label"},[t._v(t._s(t.max))]),t._v(" "),e("span",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(t.unit))])])]),t._v(" "),t.showValue?[e("span",[t._v(t._s(t.value))]),t._v(" "),e("span",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(t.unit))])]:t._e()],2)},e.staticRenderFns=[],e._scopeId="data-v-57e24596"},{"core/utils/utils":68,"vueify/lib/insert-css":1}],228:[function(e,t,r){function n(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),e=e("services/gui"),o=(e=e)&&e.__esModule?e:{default:e},r.default={name:"g3w-resize",props:{show:{type:Boolean,required:!0,default:!0},orientation:{type:String,default:"h"},where:{type:String,default:"document"},moveFnc:{type:Function,default:function(e){}}},computed:{style:function(){return{minWidth:"5px",backgroundColor:"#dddddd",cursor:"v"===this.orientation?"ns-resize":"col-resize"}}},methods:{wrapMoveFnc:function(e){this.domElementMoveListen.addEventListener("mouseup",this.stop,{once:!0}),this.moveFnc(e)},start:function(){this.domElementMoveListen.addEventListener("mousemove",this.wrapMoveFnc)},stop:(a=n(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.domElementMoveListen.removeEventListener("mousemove",this.wrapMoveFnc),e.next=3,this.$nextTick();case 3:o.default.emit("resize");case 4:case"end":return e.stop()}},e,this)})),function(){return a.apply(this,arguments)})},mounted:(i=n(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.domElementMoveListen,this.domElementMoveListen="content"===this.where?document.getElementById("g3w-view-content"):document;case 2:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)}),destroyed:function(){this.domElementMoveListen=null}},t.exports.__esModule&&(t.exports=t.exports.default);var i,a,o,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],style:t.style,attrs:{id:t.$attrs.id},on:{mousedown:function(e){return e.stopPropagation(),t.start(e)}}})},e.staticRenderFns=[]},{"services/gui":361}],229:[function(e,t,r){function n(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),e=e("services/gui"),a=(e=e)&&e.__esModule?e:{default:e},r.default={name:"resize-icon",props:{type:{type:String,default:"h"}},data:function(){return{show:void 0!==this.type}},watch:{type:(i=n(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.show=!1,e.next=3,this.$nextTick();case 3:this.show=!0;case 4:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)})},methods:{toggleFull:function(){a.default.toggleFullViewContent(),a.default.emit("resize")},resetToDefault:function(){a.default.resetToDefaultContentPercentage(),a.default.emit("resize")}}},t.exports.__esModule&&(t.exports=t.exports.default);var i,a,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this.$createElement,e=this._self._c||e;return e("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[this.show?e("i",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:bottom.create",value:"enlange_reduce",expression:"'enlange_reduce'",arg:"bottom",modifiers:{create:!0}}],staticClass:"action-button skin-color-dark",class:this.g3wtemplate.getFontClass("resize-"+this.type),staticStyle:{cursor:"pointer","margin-right":"3px"},on:{click:this.toggleFull}}):this._e(),this._v(" "),e("i",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"reset_default",expression:"'reset_default'",arg:"left",modifiers:{create:!0}}],staticClass:"action-button skin-color-dark",class:this.g3wtemplate.getFontClass("resize-default"),staticStyle:{cursor:"pointer"},on:{click:this.resetToDefault}})])},e.staticRenderFns=[]},{"services/gui":361}],230:[function(e,t,r){e("vueify/lib/insert-css").insert(".br[data-v-00ab4ef6]{border-radius:8px}.card[data-v-00ab4ef6]{width:80%;padding:10px 20px;margin:50px auto}.item[data-v-00ab4ef6]{height:15px;background:#ccc;margin-top:15px}.item-light[data-v-00ab4ef6]{background:#ddd}.text80[data-v-00ab4ef6]{width:80%}.chart-wrapper[data-v-00ab4ef6]{height:50px;display:flex;align-items:baseline;margin-bottom:20px}.chart-item[data-v-00ab4ef6]{height:100%;width:15px;background:#ccc;margin-right:10px}.chart-item-80[data-v-00ab4ef6]{height:80%}");Object.defineProperty(r,"__esModule",{value:!0}),r.default={name:"skeleton",mounted:function(){this.$nextTick(function(){})}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this.$createElement;this._self._c;return this._m(0)},e.staticRenderFns=[function(){var e=this.$createElement,e=this._self._c||e;return e("div",{staticClass:"card br"},[e("div",{staticClass:"chart-wrapper"},[e("div",{staticClass:"chart-item br"}),this._v(" "),e("div",{staticClass:"chart-item chart-item-80 item-light br"}),this._v(" "),e("div",{staticClass:"chart-item br"}),this._v(" "),e("div",{staticClass:"chart-item br chart-item-80"})]),this._v(" "),e("div",{staticClass:"item br text80"}),this._v(" "),e("div",{staticClass:"item item-light br"}),this._v(" "),e("div",{staticClass:"item br"}),this._v(" "),e("div",{staticClass:"item item-light br text80"})])}],e._scopeId="data-v-00ab4ef6"},{"vueify/lib/insert-css":1}],231:[function(e,t,r){var n,i,a,o,s,u;e("vueify/lib/insert-css").insert(".formquerytabs[data-v-4f13a336]{overflow:hidden!important;display:flex;flex-wrap:wrap}.formquerytabs>li[data-v-4f13a336]{flex:1;display:flex}.formquerytabs>li>a[data-v-4f13a336]{font-weight:700;flex:1}.tab-content[data-v-4f13a336]{//margin-top:10px}.nav-tabs>li>a.mobile[data-v-4f13a336]{padding:5px 10px}.tab_a[data-v-4f13a336]{padding:5px;margin-right:0!important;//border:1px solid #eee;border-bottom:0;margin-bottom:3px;border-radius:3px 3px 0 0}");function l(e){return e&&e.__esModule?e:{default:e}}function c(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),n=l(e("core/expression/tabservice")),i=l(e("components/GlobalTabsNode.vue")),a=l(e("services/gui")),e=e("core/utils/utils"),u=e.getUniqueDomId,e=e.noop,r.default={name:"tabs",props:{group:{type:Boolean,default:!1},contenttype:{default:"query"},layerid:{required:!0},tabs:{required:!0},feature:{required:!0},fields:{required:!0},addToValidate:{type:Function,default:e},removeToValidate:{type:Function,default:e},changeInput:{type:Function,default:e},showRelationByField:{type:Boolean,default:!0},handleRelation:{type:Function,default:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.relation,r=e.layerId,e=e.feature;return a.default.getService("queryresults").showRelation({relation:t,layerId:r,feature:e})}}},data:function(){return{ids:[]}},computed:{required_fields:function(){return"editing"===this.contenttype&&this.fields.filter(function(e){return e.validate.required}).map(function(e){return e.name})},show:function(){return this.tabs.reduce(function(e,t){return e||void 0===t.visible||!!t.visible},!1)}},methods:{setVisibility:(s=c(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.default.getVisibility({qgs_layer_id:this.layerid,expression:t.visibility_expression.expression,feature:this.feature,contenttype:this.contenttype});case 2:r=e.sent,t.visible=r;case 4:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)}),setEditingRequireTab:function(e){var t=this;return void 0===e.nodes?-1!==this.required_fields.indexOf(e.field_name):!!e.nodes.find(function(e){return t.setEditingRequireTab(e)})},getField:function(t){return this.fields.find(function(e){return e.name===t})}},components:{Node:i.default},created:(o=c(regeneratorRuntime.mark(function e(){var t,r,n,i,a,o,s,l=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(this.unwatch=[],t=function(i){i.visibility_expression&&(void 0===i.visible&&l.$set(i,"visible",0),l.setVisibility(i)),"editing"===l.contenttype&&(void 0===i.required&&(i.required=l.setEditingRequireTab(i)),i.visibility_expression)&&i.visibility_expression.referenced_columns.forEach(function(t){var r,n=l.fields.find(function(e){return e.name===t});l.unwatch.push(l.$watch(function(){return n.value},(r=c(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:l.feature.set(n.name,t),l.setVisibility(i);case 2:case"end":return e.stop()}},e,l)})),function(e){return r.apply(this,arguments)})))}),l.ids.push("tab_"+u())},n=!(r=!0),i=void 0,e.prev=5,a=this.tabs[Symbol.iterator]();!(r=(o=a.next()).done);r=!0)o=o.value,t(o);e.next=13;break;case 9:e.prev=9,e.t0=e.catch(5),n=!0,i=e.t0;case 13:e.prev=13,e.prev=14,!r&&a.return&&a.return();case 16:if(e.prev=16,n)throw i;e.next=19;break;case 19:return e.finish(16);case 20:return e.finish(13);case 21:this.root_tabs=[],this.group?this.root_tabs=[this.tabs]:(s=[],this.tabs.forEach(function(e){e.nodes?s.push(e):(s.length&&(l.root_tabs.push([].concat(s)),s.splice(0)),l.root_tabs.push({nodes:[e]}))}),s.length&&this.root_tabs.push(s));case 23:case"end":return e.stop()}},e,this,[[5,9,13,21],[14,,16,20]])})),function(){return o.apply(this,arguments)}),beforeDestroy:function(){this.unwatch.forEach(function(e){return e()}),this.unwatch=null}},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var r=this,e=r.$createElement,n=r._self._c||e;return r.show?n("div",{staticClass:"tabs-wrapper"},[r._l(r.root_tabs,function(e){return[Array.isArray(e)?[n("ul",{staticClass:"formquerytabs nav nav-tabs"},[r._l(e,function(e,t){return[void 0===e.visible||e.visible?n("li",{class:{active:0===t}},[n("a",{staticClass:"tab_a",class:{mobile:r.isMobile(),"group-title":r.group},style:{fontSize:r.isMobile()?"1.0em":(r.group?"1.1":"1.2")+"em"},attrs:{"data-toggle":"tab",href:"#"+r.ids[t]}},[r._v("\n              "+r._s(e.name)+" "),"editing"===r.contenttype&&e.required?n("span",{staticStyle:{"padding-left":"3px","font-size":"1.1em"}},[r._v("*")]):r._e()])]):r._e()]})],2),r._v(" "),n("div",{staticClass:"tab-content",class:{editing:"editing"===r.contenttype}},[r._l(e,function(e,t){return[void 0===e.visible||e.visible?n("div",{staticClass:"tab-pane fade",class:{"in active":0===t},attrs:{id:r.ids[t]}},[n("node",{attrs:{showRelationByField:r.showRelationByField,handleRelation:r.handleRelation,feature:r.feature,layerid:r.layerid,contenttype:r.contenttype,addToValidate:r.addToValidate,removeToValidate:r.removeToValidate,changeInput:r.changeInput,fields:r.fields,showTitle:!1,node:e}})],1):r._e()]})],2)]:n("node",{attrs:{showRelationByField:r.showRelationByField,handleRelation:r.handleRelation,feature:r.feature,layerid:r.layerid,contenttype:r.contenttype,addToValidate:r.addToValidate,removeToValidate:r.removeToValidate,changeInput:r.changeInput,fields:r.fields,showTitle:!1,node:e}})]})],2):r._e()},r.staticRenderFns=[],r._scopeId="data-v-4f13a336"},{"components/GlobalTabsNode.vue":232,"core/expression/tabservice":11,"core/utils/utils":68,"services/gui":361,"vueify/lib/insert-css":1}],232:[function(e,t,r){var n,i,a;e("vueify/lib/insert-css").insert(".tab-node[data-v-131d3550]{min-width:0;overflow:hidden}.title[data-v-131d3550]{font-weight:700;width:100%;color:#fff;padding:3px;margin-top:5px;margin-bottom:5px;border-radius:2px}.node-row[data-v-131d3550]{margin-bottom:0;column-gap:2px;margin-top:0;display:grid;grid-auto-columns:minmax(0,1fr);grid-auto-flow:column}.row.mobile[data-v-131d3550]{margin-bottom:0!important}");function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=o(e("components/InputG3W.vue")),a=o(e("store/projects")),o(e("services/gui")),e=e("gui/fields/fields"),r.default={name:"node",props:["contenttype","node","fields","showTitle","addToValidate","removeToValidate","changeInput","layerid","feature","showRelationByField","handleRelation"],components:n({G3wInput:i.default},e),data:function(){return{context:this.contenttype,editing_required:!1}},computed:{filterNodes:function(){var e=this;return this.node.nodes&&this.node.nodes.filter(function(r){return"group"===e.getNodeType(r)||(!r.nodes&&r.name&&"group"!=e.getNodeType(r)?r.relation=!0:!!e.fields.find(function(e){var t=r.field_name&&r.field_name.replace(/ /g,"_");return e.name===t||r.relation}))})||[]},nodesLength:function(){return this.filterNodes.length},rows:function(){var e,t=1;return 0===this.nodesLength?t=0:this.columnNumber<=this.nodesLength&&(e=this.nodesLength%this.columnNumber,t=Math.floor(this.nodesLength/this.columnNumber)+e),t},columnNumber:function(){var e=parseInt(this.node.columncount)?parseInt(this.node.columncount):1;return e>this.nodesLength?this.nodesLength:e},showGroupTile:function(){return this.showTitle&&this.node.showlabel&&this.node.groupbox}},methods:{loadingRelation:function(e){return a.default.getCurrentProject().getLayerById(this.layerid).getRelationById(e.name).state},isRelationDisabled:function(e){return void 0===this.getRelationName(e.name)||"editing"===this.contenttype&&this.isRelationChildLayerNotEditable(e)},getRelationName:function(e){e=a.default.getCurrentProject().getRelationById(e);return e&&e.name},isRelationChildLayerNotEditable:function(e){e.nmRelationId;var e=e.name,t=a.default.getCurrentProject(),e=t.getRelationById(e).referencingLayer;return!t.getLayerById(e).isEditable()},getNodes:function(e){e=(e-1)*this.columnNumber;return this.filterNodes.slice(e,this.columnNumber+e)},getNode:function(e,t){return this.getNodes(e)[t-1]},getField:function(r){return r.relation?r:this.fields.find(function(e){var t=r.field_name&&r.field_name.replace(/ /g,"_");return e.name===t})},getNodeType:function(e){var t=e.groupbox||e.nodes?"group":e.relation?"relation":"field";return"field"!=t||void 0!==e.alias&&""!==e.alias||(e.alias=e.field_name),t},getComponent:function(e){return e.relation?void 0:e.query?e.input.type:"g3w-input"}}},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var n=this,e=n.$createElement,i=n._self._c||e;return i("div",{staticClass:"tab-node group"},[n.showGroupTile?i("h5",{staticClass:"title group-title",class:{mobile:n.isMobile()},style:{fontSize:n.isMobile()?"1em":"1.1em"}},[n._v(n._s(n.node.name))]):n._e(),n._v(" "),n._l(n.rows,function(r){return i("div",{staticClass:"node-row",class:{mobile:n.isMobile()}},[n._l(n.columnNumber,function(t){return[n.getNode(r,t)?["field"===n.getNodeType(n.getNode(r,t))?i(n.getComponent(n.getField(n.getNode(r,t))),{tag:"component",staticStyle:{padding:"5px 3px 5px 3px"},attrs:{state:n.getField(n.getNode(r,t)),changeInput:n.changeInput,addToValidate:n.addToValidate,removeToValidate:n.removeToValidate,feature:n.feature},on:{changeinput:n.changeInput,addinput:n.addToValidate,removeinput:n.removeToValidate}}):["group"===n.getNodeType(n.getNode(r,t))?i("tabs",n._b({staticClass:"sub-group",staticStyle:{width:"100% !important"},attrs:{group:!0,tabs:[n.getNode(r,t)]}},"tabs",n.$props,!1)):[n.showRelationByField?i("div",{directives:[{name:"disabled",rawName:"v-disabled",value:n.isRelationDisabled(n.getNode(r,t))||n.loadingRelation(n.getNode(r,t)).loading,expression:"isRelationDisabled(getNode(row, column)) || loadingRelation(getNode(row, column)).loading"}],style:{cursor:n.showRelationByField&&"pointer"},on:{click:function(e){e.stopPropagation(),n.handleRelation({relation:n.getNode(r,t),feature:n.feature,layerId:n.layerid})}}},[i("bar-loader",{attrs:{loading:n.loadingRelation(n.getNode(r,t)).loading}}),n._v(" "),i("div",{staticStyle:{display:"flex","align-items":"center"}},[i("div",{staticClass:"query_relation_field"},[i("i",{class:n.g3wtemplate.font["query"===n.context?"relation":"pencil"]})]),n._v(" "),i("span",{staticClass:"query_relation_field_message g3w-long-text"},[i("span",{staticStyle:{"text-transform":"uppercase"}},[n._v(" "+n._s(n.getRelationName(n.getNode(r,t).name)))])])])],1):n._e()]]]:n._e()]})],2)})],2)},r.staticRenderFns=[],r._scopeId="data-v-131d3550"},{"components/InputG3W.vue":239,"gui/fields/fields":120,"services/gui":361,"store/projects":379,"vueify/lib/insert-css":1}],233:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default={name:"header-item",props:["state"],methods:{showCustomModal:function(e){this.$emit("show-custom-modal-content",e)}},created:function(){this.state.type=this.state.type||"link"}},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("li",{staticClass:"customheaderlink dropdown user user-menu",attrs:{title:t.state.title}},["link"===t.state.type?e("a",{staticClass:"dropdown-toggle",class:{imagelink:!!t.state.img},attrs:{href:t.state.url,target:t.state.target}},[t.state.img?e("img",{staticStyle:{"max-height":"20px"},attrs:{src:t.state.img}}):e("span",[t.state.i18n?e("span",{directives:[{name:"t",rawName:"v-t",value:t.state.title,expression:"state.title"}]}):e("span",[t._v(t._s(t.state.title))])])]):"modal"===t.state.type?e("a",{staticClass:"dropdown-toggle",staticStyle:{cursor:"pointer"},attrs:{"data-toggle":"modal","data-target":"#custom_modal"},on:{click:function(e){return t.showCustomModal(t.state.id)}}},[e("span",[t._v(t._s(t.state.title))])]):t._e()])},r.staticRenderFns=[]},{}],234:[function(e,t,r){e("vueify/lib/insert-css").insert(".control-label[data-v-06ccc3d6]{text-align:left!important;padding-top:0!important;margin-bottom:3px}");Object.defineProperty(r,"__esModule",{value:!0}),n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},e=e("mixins"),r.default=n({name:"InputBase",props:["state"]},e.baseInputMixin),t.exports.__esModule&&(t.exports=t.exports.default);var n,r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var e=this,t=e.$createElement,t=e._self._c||t;return e.state.visible?t("div",{staticClass:"form-group"},[e._t("label",[t("label",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"}],staticClass:"col-sm-12 control-label",attrs:{for:e.state.name}},[e._v(e._s(e.state.label)+"\n      "),e.state.validate&&e.state.validate.required?t("span",[e._v("*")]):e._e(),e._v(" "),e.showhelpicon?t("i",{staticClass:"skin-color",class:e.g3wtemplate.font.info,staticStyle:{"margin-left":"3px",cursor:"pointer"},on:{click:e.showHideHelp}}):e._e(),e._v(" "),e._t("label-action")],2)]),e._v(" "),t("div",{staticClass:"col-sm-12"},[e._t("loading",["loading"===e.loadingState?t("div",{staticStyle:{position:"relative",width:"100%"},attrs:{slot:"loading"},slot:"loading"},[t("bar-loader",{attrs:{loading:"true"}})],1):e._e()]),e._v(" "),e._t("body"),e._v(" "),e._t("message",[e.notvalid?t("p",{staticClass:"g3w-long-text error-input-message",staticStyle:{margin:"0"},domProps:{innerHTML:e._s(e.state.validate.message)}}):e.state.info?t("p",{staticStyle:{margin:"0"},domProps:{innerHTML:e._s(e.state.info)}}):e._e()]),e._v(" "),e.state.help&&this.state.help.visible?t("div",{staticClass:"g3w_input_help skin-background-color extralighten",domProps:{innerHTML:e._s(e.state.help.message)}}):e._e()],2)],2):e._e()},r.staticRenderFns=[],r._scopeId="data-v-06ccc3d6"},{mixins:343,"vueify/lib/insert-css":1}],235:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),n=e("mixins"),i=e("gui/inputs/input"),a=e("core/utils/utils").getUniqueDomId,r.default={name:"input-checkbox",mixins:[i,n.widgetMixins],data:function(){return{value:null,label:null,id:a()}},methods:{setLabel:function(){this.label=this.service.convertCheckedToValue(this.value)},setValue:function(){this.value=this.service.convertValueToChecked()},changeCheckBox:function(){this.setLabel(),this.widgetChanged()},stateValueChanged:function(){this.setValue(),this.setLabel()}},created:function(){this.value=this.state.forceNull?this.value:this.service.convertValueToChecked()},mounted:function(){this.state.forceNull||this.setLabel()}},t.exports.__esModule&&(t.exports=t.exports.default);var n,i,a,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var i=this,e=i.$createElement,e=i._self._c||e;return e("baseinput",{attrs:{state:i.state}},[e("div",{directives:[{name:"disabled",rawName:"v-disabled",value:!i.editable,expression:"!editable"}],staticStyle:{height:"20px","margin-top":"8px"},attrs:{slot:"body"},slot:"body"},[e("input",{directives:[{name:"model",rawName:"v-model",value:i.value,expression:"value"}],staticClass:"magic-checkbox",class:{"input-error-validation":i.notvalid},staticStyle:{width:"100%"},attrs:{tabIndex:i.tabIndex,type:"checkbox",id:i.id},domProps:{checked:Array.isArray(i.value)?-1<i._i(i.value,null):i.value},on:{change:[function(e){var t,r=i.value,e=e.target,n=!!e.checked;Array.isArray(r)?(t=i._i(r,null),e.checked?t<0&&(i.value=r.concat([null])):-1<t&&(i.value=r.slice(0,t).concat(r.slice(t+1)))):i.value=n},i.changeCheckBox]}}),i._v(" "),e("label",{attrs:{for:i.id}},[i._v(i._s(i.label))])])])},e.staticRenderFns=[]},{"core/utils/utils":68,"gui/inputs/input":131,mixins:343}],236:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),e=e("gui/inputs/input"),r.default={name:"input-color",mixins:[e]},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("baseinput",{attrs:{state:t.state}},[e("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!t.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:t.state.value,expression:"state.value"}],staticClass:"form-control",class:{"input-error-validation":t.notvalid},staticStyle:{cursor:"pointer"},attrs:{slot:"body",placeholder:t.state.default,type:"color",tabIndex:t.tabIndex,field:t.state.name,id:t.state.name},domProps:{value:t.state.value},on:{change:t.change,input:function(e){e.target.composing||t.$set(t.state,"value",e.target.value)}},slot:"body"})])},r.staticRenderFns=[]},{"gui/inputs/input":131}],237:[function(e,t,r){function n(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),i=e("store/application-state"),d=(i=i)&&i.__esModule?i:{default:i},i=e("mixins"),s=e("gui/inputs/input"),l=e("core/utils/utils").getUniqueDomId,r.default={name:"input-datetime-picker",mixins:[s,i.resizeMixin],data:function(){var e=l();return{widget_container:{top:0,left:0},iddatetimepicker:"datetimepicker_"+e,idinputdatetimepiker:"inputdatetimepicker_"+e}},methods:{resize:function(){var e=$("#"+this.iddatetimepicker);e&&e.data("DateTimePicker")&&e.data("DateTimePicker").hide()},timeOnly:function(){return!this.state.input.options.formats[0].date},onDatePickerChange:function(){var e=$("#"+this.idinputdatetimepiker).val();this.state.value=_.isEmpty(_.trim(e))?null:moment(e,this.datetimedisplayformat).format(this.datetimefieldformat),this.change()},onDatePickerShow:function(e){var r=this;this.widget_container.top=0,this.widget_container.left=0,setTimeout(function(){var e=r.$refs.datetimepicker_body.getBoundingClientRect(),t=document.querySelector(".bootstrap-datetimepicker-widget").getBoundingClientRect();r.widget_container.top=e.top+(e.top<t.height?e.height+Math.abs(e.top-t.height)+20:0),r.widget_container.left=e.left-(e.width<t.width?t:e).width,r.$emit("datetimepickershow")})},onDatePickerHide:function(e){this.$emit("datetimepickershow")}},watch:{"state.value":(o=n(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==$("#"+this.idinputdatetimepiker).val())return r=null!==t?moment(t,this.datetimefieldformat).format(this.datetimedisplayformat):t,e.next=4,this.$nextTick();e.next=5;break;case 4:$("#"+this.idinputdatetimepiker).val(r);case 5:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)})},mounted:(a=n(regeneratorRuntime.mark(function e(){var t,r,n,i,a,o,s,l,u,c=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.input.options,l=t.formats,l=void 0===l?[]:l,t=t.layout,t=void 0===t?{vertical:"top",horizontal:"left"}:t,l=l[0],r=l.minDate,n=l.maxDate,i=l.fieldformat,a=l.enabledDates,o=l.disabledDates,s=l.displayformat,l=l.useCurrent,e.next=4,this.$nextTick();case 4:this.datetimedisplayformat=this.service.convertQGISDateTimeFormatToMoment(s),this.datetimefieldformat=this.service.convertQGISDateTimeFormatToMoment(i),this.service.setValidatorOptions({fielddatetimeformat:this.datetimefieldformat}),u=moment(this.state.value,this.datetimefieldformat,!0).isValid()?moment(this.state.value,this.datetimefieldformat).toDate():null,$("#"+this.iddatetimepicker).datetimepicker({defaultDate:u,format:this.datetimedisplayformat,ignoreReadonly:!0,allowInputToggle:!0,enabledDates:a,disabledDates:o,useCurrent:l,toolbarPlacement:"top",minDate:r,maxDate:n,widgetParent:$(this.$refs.datimewidget_container),widgetPositioning:{vertical:t.vertical||"top",horizontal:t.horizontal||"left"},showClose:!0,locale:this.service.getLocale()}),$("#"+this.iddatetimepicker).on("dp.change",this.onDatePickerChange),$("#"+this.iddatetimepicker).on("dp.show",this.onDatePickerShow),$("#"+this.iddatetimepicker).on("dp.hide",this.onDatePickerHide),d.default.ismobile&&setTimeout(function(){$("#"+c.idinputdatetimepiker).blur()});case 13:case"end":return e.stop()}},e,this)})),function(){return a.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default);var i,d,a,o,s,l,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("baseinput",{attrs:{state:e.state}},[t("div",{ref:"datetimepicker_body",attrs:{slot:"body"},slot:"body"},[t("div",{ref:"datimewidget_container",style:{top:e.widget_container.top+"px",left:e.widget_container.left+"px",position:"fixed",zIndex:1e4}}),e._v(" "),t("div",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"}],staticClass:"input-group date",attrs:{id:e.iddatetimepicker}},[t("input",{staticClass:"form-control",class:{"input-error-validation":e.notvalid},attrs:{type:"text",id:e.idinputdatetimepiker,tabIndex:e.tabIndex,readonly:!e.editable||e.isMobile()?"readonly":null}}),e._v(" "),t("span",{staticClass:"input-group-addon caret"},[t("span",{class:[e.g3wtemplate.getFontClass(e.timeOnly()?"time":"calendar")]})])])])])},e.staticRenderFns=[]},{"core/utils/utils":68,"gui/inputs/input":131,mixins:343,"store/application-state":373}],238:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),e=e("gui/inputs/input"),r.default={name:"input-float",mixins:[e]},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("baseinput",{attrs:{state:t.state}},[e("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!t.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:t.state.value,expression:"state.value"}],staticClass:"form-control",class:{"input-error-validation":t.notvalid},staticStyle:{width:"100%"},attrs:{slot:"body",tabIndex:t.tabIndex,type:"number",step:t.state.step||1,placeholder:t.state.default},domProps:{value:t.state.value},on:{change:t.change,input:[function(e){e.target.composing||t.$set(t.state,"value",e.target.value)},t.change]},slot:"body"})])},r.staticRenderFns=[]},{"gui/inputs/input":131}],239:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},e=e("gui/inputs/inputs"),r.default={name:"g3w-input",props:{state:{required:!0},addToValidate:{type:Function,required:!0},removeToValidate:{type:Function,required:!0},changeInput:{type:Function,required:!0}},components:n({},e),computed:{type:function(){if("child"!==this.state.type)return this.state.input.type?this.state.input.type+"_input":this.state.type+"_input"}},created:function(){"child"===this.state.type||this.state.input.options||(this.state.input.options={})}},t.exports.__esModule&&(t.exports=t.exports.default);var n,r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.state.visible?r("div",["child"!==t.state.type?r("div",[r(t.type,{tag:"component",attrs:{changeInput:t.changeInput,addToValidate:t.addToValidate,removeToValidate:t.removeToValidate,state:t.state},on:{changeinput:t.changeInput,addinput:t.addToValidate,removeinput:t.removeToValidate}}),t._v(" "),r("span",{staticClass:"divider"})],1):r("div",{staticClass:"skin-border-color field-child",staticStyle:{"border-top":"2px solid"}},[r("h4",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(t.state.label))]),t._v(" "),r("div",[t._v(" "+t._s(t.state.description)+" ")]),t._v(" "),t._l(t.state.fields,function(e){return r("g3w-input",{key:e.name,attrs:{state:e,changeInput:t.changeInput,addToValidate:t.addToValidate,removeToValidate:t.removeToValidate},on:{changeinput:t.changeInput,addinput:t.addToValidate,removeinput:t.removeToValidate}})})],2)]):t._e()},r.staticRenderFns=[],r._scopeId="data-v-2bbb7c94"},{"gui/inputs/inputs":132}],240:[function(e,t,r){e("vueify/lib/insert-css").insert("#g3w-for-inputs-required-inputs-message[data-v-155589a3]{margin-bottom:5px;font-weight:700;text-align:center;display:flex;align-items:center;justify-content:center}.box-body[data-v-155589a3]{padding:5px}");Object.defineProperty(r,"__esModule",{value:!0}),e=(e=e=e("components/InputG3W.vue"))&&e.__esModule?e:{default:e},r.default={name:"g3w-form-inputs",props:{state:{type:Object,default:{fields:[]}},addToValidate:{type:Function},changeInput:{type:Function},show_required_field_message:{type:Boolean,default:!1}},components:{G3wInput:e.default}},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("form",{staticClass:"form-horizontal g3w-form"},[r("div",{staticClass:"box-primary"},[r("div",{staticClass:"box-body"},[t._l(t.state.fields,function(e){return[r("g3w-input",{attrs:{state:e,addToValidate:t.addToValidate,changeInput:t.changeInput},on:{addToValidate:t.addToValidate,changeInput:t.changeInput}})]})],2),t._v(" "),t.show_required_field_message?r("div",{attrs:{id:"g3w-for-inputs-required-inputs-message"}},[r("span",{staticClass:"hide-cursor-caret-color"},[t._v("*")]),t._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.form.footer.required_fields",expression:"'sdk.form.footer.required_fields'"}],staticClass:"hide-cursor-caret-color"})]):t._e()])])},r.staticRenderFns=[],r._scopeId="data-v-155589a3"},{"components/InputG3W.vue":239,"vueify/lib/insert-css":1}],241:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),e=e("gui/inputs/input"),r.default={name:"input-integer",mixins:[e]},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("baseinput",{attrs:{state:t.state}},[e("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!t.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:t.state.value,expression:"state.value"}],staticClass:"form-control",class:{"input-error-validation":t.notvalid},staticStyle:{width:"100%"},attrs:{slot:"body",placeholder:t.state.default,tabIndex:t.tabIndex,type:"number"},domProps:{value:t.state.value},on:{change:t.change,input:[function(e){e.target.composing||t.$set(t.state,"value",e.target.value)},t.change]},slot:"body"})])},r.staticRenderFns=[]},{"gui/inputs/input":131}],242:[function(e,t,r){function n(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),a=e("core/utils/utils").getUniqueDomId,e=e("gui/inputs/input"),r.default={name:"input-lonlat",mixins:[e],data:function(){return{lonId:a(),latId:a(),coordinatebutton:{active:!1}}},computed:{getCoordinateActive:function(){return this.service.state.getCoordinateActive}},methods:{toggleGetCoordinate:function(){this.service.toggleGetCoordinate()},changeLonLat:function(){this.change(),this.setValue()},setValue:function(){this.state.value=[[+this.state.values.lon,+this.state.values.lat]]}},created:function(){this.state.values=this.state.values||{lon:0,lat:0},this.setValue(),this.service.setCoordinateButtonReactiveObject(this.coordinatebutton)},mounted:(i=n(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.$nextTick(function(){$(t.$refs["g3w-input-lat-lon"]).tooltip({trigger:"hover"})});case 3:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)}),destroyed:function(){this.service.clear()}},t.exports.__esModule&&(t.exports=t.exports.default);var i,a,r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",{staticStyle:{position:"relative"}},[e("div",{staticStyle:{display:"flex","justify-content":"flex-end",height:"35px","margin-right":"12px","margin-bottom":"5px"}},[e("button",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.form.inputs.tooltips.lonlat",expression:"'sdk.form.inputs.tooltips.lonlat'"}],ref:"g3w-input-lat-lon",staticClass:"action skin-tooltip-left skin-color skin-border-color",class:t.g3wtemplate.font.crosshairs,staticStyle:{"border-radius":"5px","font-weight":"bold","font-size":"20px",cursor:"pointer"},style:{border:t.coordinatebutton.active?"2px solid":0},attrs:{"data-placement":"left","data-toggle":"tooltip"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.toggleGetCoordinate(e)}}})]),t._v(" "),e("baseinput",{attrs:{state:t.state}},[e("label",{staticClass:"col-sm-4 control-label",attrs:{slot:"label",for:t.lonId},slot:"label"},[t._v(t._s(t.state.labels.lon)+"\n      "),t.state.validate&&t.state.validate.required?e("span",[t._v("*")]):t._e()]),t._v(" "),e("div",{attrs:{slot:"body"},slot:"body"},[e("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!t.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:t.state.values.lon,expression:"state.values.lon"}],staticClass:"form-control",class:{"input-error-validation":t.notvalid},staticStyle:{width:"100%","margin-bottom":"5px"},attrs:{id:t.lonId,tabIndex:t.tabIndex,type:"number",min:"-180",max:"180",placeholder:"Lon"},domProps:{value:t.state.values.lon},on:{change:t.changeLonLat,input:function(e){e.target.composing||t.$set(t.state.values,"lon",e.target.value)}}})])]),t._v(" "),e("baseinput",{attrs:{state:t.state}},[e("label",{staticClass:"col-sm-4 control-label",attrs:{slot:"label",for:t.latId},slot:"label"},[t._v(t._s(t.state.labels.lat)+"\n      "),t.state.validate&&t.state.validate.required?e("span",[t._v("*")]):t._e()]),t._v(" "),e("div",{attrs:{slot:"body"},slot:"body"},[e("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!t.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:t.state.values.lat,expression:"state.values.lat"}],staticClass:"form-control",class:{"input-error-validation":t.notvalid},staticStyle:{width:"100%","margin-bottom":"5px"},attrs:{id:t.latId,tabIndex:t.tabIndex,type:"number",min:"-90",max:"90",placeholder:"Lon"},domProps:{value:t.state.values.lat},on:{change:t.changeLonLat,input:function(e){e.target.composing||t.$set(t.state.values,"lat",e.target.value)}}})])])],1)},r.staticRenderFns=[]},{"core/utils/utils":68,"gui/inputs/input":131}],243:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),n=e("services/gui"),i=(n=n)&&n.__esModule?n:{default:n},n=e("gui/inputs/input"),a=e("core/utils/utils").getUniqueDomId,o=e("core/i18n/i18n.service").t,e=e("gui/fields/fields").media_field,r.default={name:"input-media",mixins:[n],components:{"g3w-media":e},data:function(){return{data:{value:null,mime_type:null},mediaid:"media_"+a(),loading:!1}},methods:{onClick:function(e){document.getElementById(this.mediaid).click()},createImage:function(e,t){var r=new FileReader;r.onload=function(e){t.value=e.target.result},r.readAsDataURL(e)},checkFileSrc:function(e){return e=_.isNil(e)?"":e},clearMedia:function(){this.data.value=this.data.mime_type=this.state.value=null,this.change()}},created:function(){this.state.value&&(this.data.value=this.state.value.value,this.data.mime_type=this.state.value.mime_type)},mounted:function(){var r=this,n=this.state.name,e={name:n,csrfmiddlewaretoken:this.$cookie.get("csrftoken")};this.$nextTick(function(){$("#"+r.mediaid).fileupload({dataType:"json",formData:e,start:function(){r.loading=!0},done:function(e,t){t=t.result[n];t&&(r.data.value=t.value,r.data.mime_type=t.mime_type,r.state.value=r.data,r.change())},fail:function(){i.default.notify.error(o("info.server_error"))},always:function(){r.loading=!1}})})},beforeDestroy:function(){$("#"+this.mediaid).fileupload("destroy")}},t.exports.__esModule&&(t.exports=t.exports.default);var n,i,a,o,r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("baseinput",{attrs:{state:t.state}},[e("div",{directives:[{name:"disabled",rawName:"v-disabled",value:!t.editable,expression:"!editable"}],attrs:{slot:"body"},slot:"body"},[e("div",{staticClass:"g3w_input_button skin-border-color",staticStyle:{"border-style":"solid","border-width":"2px","border-radius":"4px",width:"100%",cursor:"pointer","text-align":"center"},on:{click:t.onClick}},[e("i",{staticClass:"fa-2x skin-color",class:t.g3wtemplate.getFontClass("file-upload"),staticStyle:{padding:"5px"}},[e("input",{class:{"input-error-validation":t.notvalid},staticStyle:{display:"none"},attrs:{id:t.mediaid,name:t.state.name,tabIndex:t.tabIndex,"data-url":t.state.input.options.uploadurl,type:"file"}})])]),t._v(" "),e("bar-loader",{attrs:{loading:t.loading}}),t._v(" "),e("g3w-media",{attrs:{state:t.data}},[e("div",{staticClass:"clearmedia",on:{click:function(e){return t.clearMedia()}}},[e("i",{staticClass:"g3w-icon",class:t.g3wtemplate.font["trash-o"]})])])],1)])},r.staticRenderFns=[]},{"core/i18n/i18n.service":13,"core/utils/utils":68,"gui/fields/fields":120,"gui/inputs/input":131,"services/gui":361}],244:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),n=e("gui/inputs/input"),i=e("gui/inputs/picklayer/service"),r.default={name:"input-picklayer",mixins:[n],methods:{pickLayer:function(){var t=this;this.pickservice.pick().then(function(e){return t.state.value=e}).catch(function(){})},unpick:function(){var e=this;setTimeout(function(){return!e.pickservice.isPicked()&&e.pickservice.unpick()},200)}},created:function(){this.pickservice=new i(this.state.input.options)},beforeDestroy:function(){this.pickservice.clear(),this.pickservice=null}},t.exports.__esModule&&(t.exports=t.exports.default);var n,i,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("baseinput",{attrs:{state:t.state}},[e("div",{attrs:{slot:"body"},slot:"body"},[e("span",{staticClass:"skin-color",class:t.g3wtemplate.font.crosshairs,staticStyle:{left:"0",top:"7px",position:"absolute"}}),t._v(" "),e("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!t.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:t.state.value,expression:"state.value"}],staticClass:"form-control",class:{"input-error-validation":t.notvalid},staticStyle:{width:"100%"},style:{cursor:t.editable?"pointer":null},attrs:{readonly:"readonly",tabIndex:t.tabIndex},domProps:{value:t.state.value},on:{input:[function(e){e.target.composing||t.$set(t.state,"value",e.target.value)},t.change],click:t.pickLayer,blur:t.unpick}})])])},e.staticRenderFns=[]},{"gui/inputs/input":131,"gui/inputs/picklayer/service":139}],245:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),n=e("gui/inputs/input"),i=e("core/utils/utils").getUniqueDomId,r.default={name:"input-radio",mixins:[n],data:function(){return{ids:[i(),i()],name:"name_"+i(),radio_value:this.state.value}},watch:{radio_value:function(){this.state.value=this.radio_value,this.change()}}},t.exports.__esModule&&(t.exports=t.exports.default);var n,i,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("baseinput",{attrs:{state:r.state}},[n("div",{attrs:{slot:"body"},slot:"body"},r._l(r.state.input.options.values,function(t,e){return n("span",{key:t.key},[n("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!r.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:r.radio_value,expression:"radio_value"}],staticClass:"magic-radio",class:{"input-error-validation":r.notvalid},staticStyle:{width:"100%"},attrs:{id:r.ids[e],name:r.name,tabIndex:r.tabIndex,type:"radio"},domProps:{value:t.value,checked:r._q(r.radio_value,t.value)},on:{change:function(e){r.radio_value=t.value}}}),r._v(" "),n("label",{attrs:{for:r.ids[e]}},[r._v(r._s(t.key))])])}),0)])},e.staticRenderFns=[]},{"core/utils/utils":68,"gui/inputs/input":131}],246:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),e=e("gui/inputs/input"),r.default={name:"input-range",mixins:[e],data:function(){var e=this.state.input.options.values[0];return{min:e.min,max:e.max,step:e.Step}},methods:{checkValue:function(){var e=_.isEmpty(_.trim(this.state.value));e&&!this.state.validate.required&&(this.state.value=this.state.input.options.values[0].default),this.state.validate.valid=!this.state.validate.required,e||(this.state.validate.valid=this.service.getValidator().validate(this.state.value)),this.change()}}},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("baseinput",{attrs:{state:t.state}},[e("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!t.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:t.state.value,expression:"state.value"}],staticClass:"form-control",class:{"input-error-validation":t.notvalid},staticStyle:{width:"100%","padding-right":"5px"},attrs:{slot:"body",tabIndex:t.tabIndex,type:"number",step:t.step},domProps:{value:t.state.value},on:{keydown:[function(e){if(!e.type.indexOf("key")&&69!==e.keyCode)return null;e.preventDefault()},function(e){if(!e.type.indexOf("key")&&13!==e.keyCode)return null;e.stopPropagation()}],change:t.checkValue,blur:t.checkValue,input:function(e){e.target.composing||t.$set(t.state,"value",e.target.value)}},slot:"body"})])},r.staticRenderFns=[]},{"gui/inputs/input":131}],247:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),a=n(e("store/catalog-layers")),o=n(e("store/map-layers")),s=n(e("services/gui")),l=e("mixins"),p=e("gui/inputs/picklayer/service"),f=e("core/layers/layer"),e=e("gui/inputs/input"),r.default={name:"input-select",mixins:[e,l.selectMixin,l.select2Mixin],data:function(){return{showPickLayer:!1,picked:!1}},computed:{showNullOption:function(){return void 0===this.state.nullOption||!0===this.state.nullOption},select2NullValue:function(){return this.showNullOption&&null}},watch:{"state.input.options.values":(d=i(regeneratorRuntime.mark(function e(t){var r,n,i,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:r=!1,this.autocomplete||(n=void 0,n=0!==t.length&&(i=t.find(function(e){return e.value==a.state.value}))?i.value:null,r=n!=this.state.value,this.state.value=n,this.setValue()),r&&this.change();case 5:case"end":return e.stop()}},e,this)})),function(e){return d.apply(this,arguments)})},methods:{pickLayerValue:(c=i(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,this.picked?(this.pickLayerInputService.unpick(),this.picked=!1,e.next=16):e.next=6;break;case 6:return this.picked=!0,e.next=9,this.pickLayerInputService.pick();case 9:r=e.sent,t=this.state.input.options.value,r=r[t],this.select2.val(r).trigger("change"),this.changeSelect(r),s.default.showUserMessage({type:"success",autoclose:!0}),this.picked=!1;case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(0),s.default.showUserMessage({type:"warning",message:"sdk.form.inputs.messages.errors.picklayer",autoclose:!0}),this.picked=!1;case 22:case"end":return e.stop()}},e,this,[[0,18]])})),function(){return c.apply(this,arguments)}),setAndListenSelect2Change:function(){var t=this;this.select2.on("select2:select",function(e){e=e.params.data.$value||e.params.data.id,e=t.showNullOption&&null===e?null:e.toString();t.changeSelect(e)})}},created:function(){if(this.open=!1,"select_autocomplete"===this.state.input.type){var e=this.state.input.options.layer_id;try{var t=o.default.getLayerById(e).getEditingLayer()||a.default.getLayerById(e),r=(this.showPickLayer=!!t&&t.getType()!==f.LayerTypes.TABLE,this.state.input.options),n=r.value,i={layer_id:r.layer_id,fields:[n],pick_type:t.isStarted&&t.isStarted()?"map":null};this.pickLayerInputService=this.showPickLayer&&new p(i)}catch(e){}}this.autocomplete&&this.state.value&&this.service.getKeyByValue({search:this.state.value})},mounted:(u=i(regeneratorRuntime.mark(function e(){var t,r,n,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.unwatch,t=$(this.$refs.select),r=this.getLanguage(),n=void 0===this.state.dropdownParent&&$("#g3w-view-content"),this.autocomplete?this.select2=t.select2({minimumInputLength:1,dropdownParent:n,allowClear:this.showNullOption,language:r,ajax:{delay:250,transport:function(e,t,r){e=e.data.term;$(".select2-results__option.loading-results").siblings().hide(),i.resetValues(),i.service.getData({search:e}).then(function(e){return t(e)}).catch(function(e){return r(e)})},processResults:function(e,t){return t.page=t.page||1,{results:e,pagination:{more:!1}}}}}):this.select2=t.select2({language:r,dropdownParent:n,minimumResultsForSearch:this.isMobile()?-1:null}),this.setAndListenSelect2Change(),this.setValue();case 9:case"end":return e.stop()}},e,this)})),function(){return u.apply(this,arguments)}),beforeDestroy:function(){this.pickLayerInputService&&(this.pickLayerInputService.clear(),this.pickLayerInputService=null),this.unwatch&&this.unwatch(),this.unwatch=null}},t.exports.__esModule&&(t.exports=t.exports.default);var a,o,s,l,u,c,d,p,f,r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("baseinput",{attrs:{state:t.state}},[t.showPickLayer?r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.form.inputs.tooltips.picklayer",expression:"'sdk.form.inputs.tooltips.picklayer'"},{name:"disabled",rawName:"v-disabled",value:t.disabled,expression:"disabled"}],staticClass:"skin-color",class:t.g3wtemplate.font.crosshairs,staticStyle:{cursor:"pointer",position:"relative",top:"2px","font-size":"1.2em"},attrs:{slot:"label-action","data-placement":"top"},on:{click:t.pickLayerValue},slot:"label-action"}):t._e(),t._v(" "),r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:t.disabled,expression:"disabled"}],attrs:{slot:"body",tabIndex:t.tabIndex},slot:"body"},[r("select",{ref:"select",staticClass:"form-control",staticStyle:{width:"100%"}},[t.showNullOption?r("option",{domProps:{value:t.select2NullValue}}):t._e(),t._v(" "),t._l(t.state.input.options.values,function(e){return r("option",{key:t.getValue(e.value),domProps:{value:t.getValue(e.value)}},[t._v(t._s(e.key))])})],2)]),t._v(" "),"error"===t.loadingState?r("p",{directives:[{name:"t",rawName:"v-t",value:"server_error",expression:"'server_error'"}],staticClass:"error-input-message",attrs:{slot:"message"},slot:"message"}):t._e()])},r.staticRenderFns=[]},{"core/layers/layer":34,"gui/inputs/input":131,"gui/inputs/picklayer/service":139,mixins:343,"services/gui":361,"store/catalog-layers":374,"store/map-layers":377}],248:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),e=e("gui/inputs/input"),r.default={name:"input-slider-range",mixins:[e],watch:{"state.input.options.min":function(){this.service.changeInfoMessage()},"state.input.options.max":function(){this.service.changeInfoMessage()}}},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("baseinput",{attrs:{state:t.state}},[e("div",{attrs:{slot:"body"},slot:"body"},[e("span",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(t.state.value))]),t._v(" "),e("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!t.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:t.state.value,expression:"state.value"}],class:{"input-error-validation":t.notvalid},staticStyle:{width:"100%","padding-right":"5px"},attrs:{slot:"body",tabIndex:t.tabIndex,min:t.state.input.options.min,max:t.state.input.options.max,type:"range",step:t.state.input.options.step},domProps:{value:t.state.value},on:{change:t.change,__r:function(e){return t.$set(t.state,"value",e.target.value)}},slot:"body"})])])},r.staticRenderFns=[]},{"gui/inputs/input":131}],249:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),e=e("gui/inputs/input"),r.default={name:"input-text",mixins:[e]},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("baseinput",{attrs:{state:t.state}},[e("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!t.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:t.state.value,expression:"state.value"}],staticClass:"form-control",class:{"input-error-validation":t.notvalid},attrs:{slot:"body",placeholder:t.state.default,tabIndex:t.tabIndex,field:t.state.name,id:t.state.name},domProps:{value:t.state.value},on:{keyup:function(e){t.isMobile()?t.mobileChange(e):t.change()},input:function(e){e.target.composing||t.$set(t.state,"value",e.target.value)}},slot:"body"})])},r.staticRenderFns=[]},{"gui/inputs/input":131}],250:[function(e,t,r){e("vueify/lib/insert-css").insert("textarea[data-v-baa98542]{resize:none;border:1px solid #ccc}");Object.defineProperty(r,"__esModule",{value:!0}),e=e("gui/inputs/input"),r.default={name:"input-textarea",mixins:[e]},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("baseinput",{attrs:{state:t.state}},[e("textarea",{directives:[{name:"disabled",rawName:"v-disabled",value:!t.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:t.state.value,expression:"state.value"}],class:{"input-error-validation":t.notvalid},staticStyle:{"max-width":"100%","min-width":"100%"},attrs:{slot:"body",placeholder:t.state.default,rows:"3",tabIndex:t.tabIndex},domProps:{value:t.state.value},on:{keydown:function(e){e.stopPropagation()},input:[function(e){e.target.composing||t.$set(t.state,"value",e.target.value)},t.change],change:t.change},slot:"body"})])},r.staticRenderFns=[],r._scopeId="data-v-baa98542"},{"gui/inputs/input":131,"vueify/lib/insert-css":1}],251:[function(e,t,r){e("vueify/lib/insert-css").insert('button.ql-html{width:40px!important}button.ql-html:after{content:"html"}');function n(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),e("core/utils/utils").getUniqueDomId;var i,e=e("gui/inputs/input"),r=(r.default={name:"input-html",mixins:[e],methods:{setupTableCustomTools:function(){var e=this.$el.querySelector(".ql-column-left"),e=(e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-caret-left-square" viewBox="0 0 16 16"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M10.205 12.456A.5.5 0 0 0 10.5 12V4a.5.5 0 0 0-.832-.374l-4.5 4a.5.5 0 0 0 0 .748l4.5 4a.5.5 0 0 0 .537.082z"/></svg>',e.title="Add column left",this.$el.querySelector(".ql-column-right")),e=(e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-caret-right-square" viewBox="0 0 16 16"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M5.795 12.456A.5.5 0 0 1 5.5 12V4a.5.5 0 0 1 .832-.374l4.5 4a.5.5 0 0 1 0 .748l-4.5 4a.5.5 0 0 1-.537.082z"/></svg>',e.title="Add column right",this.$el.querySelector(".ql-column-remove")),e=(e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-square" viewBox="0 0 16 16"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/></svg>',e.title="Remove column",this.$el.querySelector(".ql-row-above")),e=(e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-caret-up-square" viewBox="0 0 16 16"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M3.544 10.705A.5.5 0 0 0 4 11h8a.5.5 0 0 0 .374-.832l-4-4.5a.5.5 0 0 0-.748 0l-4 4.5a.5.5 0 0 0-.082.537z"/></svg>',e.title="Add row above",this.$el.querySelector(".ql-row-below")),e=(e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-caret-down-square" viewBox="0 0 16 16"><path d="M3.626 6.832A.5.5 0 0 1 4 6h8a.5.5 0 0 1 .374.832l-4 4.5a.5.5 0 0 1-.748 0l-4-4.5z"/><path d="M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm15 0a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2z"/></svg>',e.title="Add row below",this.$el.querySelector(".ql-row-remove"));e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-dash-square" viewBox="0 0 16 16"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M4 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 4 8z"/></svg>',e.title="Remove row"}},created:function(){this.edit_state={edit:!1,show_html:!1},this.state.edit_states||(this.state.edit_states=[]),this.state.edit_states.push(this.edit_state)},mounted:(i=n(regeneratorRuntime.mark(function e(){var t,p=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[[{header:[1,2,3,4,5,6,!1]}],[{align:""},{align:"center"},{align:"right"},{align:"justify"}],[{color:[]},{background:[]}],["bold","italic","underline",{list:"ordered"},{list:"bullet"},"link","clean","html"],["table","column-left","column-right","column-remove","row-above","row-below","row-remove"]],e.next=3,this.$nextTick();case 3:this.quill=new Quill(this.$refs.quill_editor,{modules:{table:!0,toolbar:{container:t,handlers:{html:function(){p.edit_state.show_html=!p.edit_state.show_html,p.edit_state.show_html?p.quill.container.firstChild.innerText=p.quill.container.firstChild.innerHTML:p.quill.container.firstChild.innerHTML=p.quill.container.firstChild.innerText;var e=!0,t=!1,r=void 0;try{for(var n,i=p.$el.querySelectorAll(".ql-formats")[Symbol.iterator]();!(e=(n=i.next()).done);e=!0){var a=n.value,o=!0,s=!1,l=void 0;try{for(var u,c=a.children[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var d=u.value;d.classList.contains("ql-html")?d.classList.toggle("skin-color"):d.classList.toggle("g3w-disabled")}}catch(e){s=!0,l=e}finally{try{!o&&c.return&&c.return()}finally{if(s)throw l}}}}catch(e){t=!0,r=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw r}}},"column-left":function(){return p.table.insertColumnLeft()},"column-right":function(){return p.table.insertColumnRight()},"column-remove":function(){return p.table.deleteColumn()},"row-above":function(){return p.table.insertRowAbove()},"row-below":function(){return p.table.insertRowBelow()},"row-remove":function(){return p.table.deleteRow()}}}},theme:"snow"}),this.quill.container.firstChild.innerHTML=this.state.value,this.table=this.quill.getModule("table"),this.setupTableCustomTools(),this.handler=function(){p.state.value=p.edit_state.show_html?p.quill.container.firstChild.innerText:p.quill.container.firstChild.innerHTML,p.edit_state.edit=!0,p.change(),setTimeout(function(){return p.edit_state.edit=!1})},this.quill.on("text-change",this.handler);case 9:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)}),watch:{"state.value":function(e){this.edit_state.edit||(this.edit_state.show_html?this.quill.container.firstChild.innerText=e:this.quill.container.firstChild.innerHTML=e)}},beforeDestroy:function(){this.quill.off("text-change",this.handler),this.handler=null,this.quill=null,this.edit_state.edit=!1,this.edit_state.show_html=!1}},t.exports.__esModule&&(t.exports=t.exports.default),"function"==typeof t.exports?t.exports.options:t.exports);r.render=function(){var e=this.$createElement,e=this._self._c||e;return e("baseinput",{directives:[{name:"disabled",rawName:"v-disabled",value:!this.editable,expression:"!editable"}],attrs:{state:this.state}},[e("div",{ref:"quill_editor",staticClass:"form-control",style:{border:this.novalid?"1px solid reed":"1px solid #ccc"},attrs:{slot:"body"},on:{keydown:function(e){e.stopPropagation()}},slot:"body"})])},r.staticRenderFns=[]},{"core/utils/utils":68,"gui/inputs/input":131,"vueify/lib/insert-css":1}],252:[function(e,t,r){function n(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),i=e("mixins"),s=e("gui/inputs/input"),l=e("core/utils/utils").getUniqueDomId,r.default={name:"input-unique",mixins:[s,i.selectMixin],data:function(){return{id:"unique_"+l()}},watch:{"state.input.options.values":(o=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.value=this.state.value||null,null!==this.state.value&&-1===t.indexOf(this.state.value)&&this.service.addValueToValues(this.state.value),e.next=4,this.$nextTick();case 4:this.state.value&&this.select2.val(this.state.value).trigger("change");case 5:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)})},mounted:(a=n(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.state.input.options.editable&&(this.select2=$("#"+this.id).select2({dropdownParent:$("#g3w-view-content"),tags:!0,language:this.getLanguage()}),this.select2.val(this.state.value).trigger("change"),this.select2.on("select2:select",function(e){e=e.params.data.$value||e.params.data.id;t.changeSelect(e)}));case 3:case"end":return e.stop()}},e,this)})),function(){return a.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default);var i,a,o,s,l,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("baseinput",{attrs:{state:t.state}},[r("select",{directives:[{name:"disabled",rawName:"v-disabled",value:!t.editable,expression:"!editable"}],staticClass:"form-control",staticStyle:{width:"100%"},attrs:{slot:"body",id:t.id,tabIndex:t.tabIndex},slot:"body"},[r("option",{attrs:{value:"null"}}),t._v(" "),t._l(t.state.input.options.values,function(e){return r("option",{key:e,domProps:{value:t.getValue(e)}},[t._v(t._s(t.getValue(e)))])})],2)])},e.staticRenderFns=[]},{"core/utils/utils":68,"gui/inputs/input":131,mixins:343}],253:[function(e,t,r){var n,i,a;e("vueify/lib/insert-css").insert("li .item-text[data-v-232670c6]{font-weight:700}");function o(e){return e&&e.__esModule?e:{default:e}}function s(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),i=o(e("store/catalog-layers")),a=o(e("gui/catalog/vue/catalogeventhub")),r.default={name:"Layeropacitypicker",props:{layer:{type:Object,required:!0}},data:function(){return{menu:{show:!1,top:0,left:0,overflowY:"none",style:null,default:null}}},methods:{setLayerOpacity:function(e){var t=e.id,t=void 0===t?this.layer.id:t,e=e.value;this.layer.opacity!=e&&(this.layer.opacity=e,e=i.default.getLayerById(t))&&(a.default.$emit("layer-change-opacity",{layerId:t}),e.change())},showLayerOpacityMenu:(n=s(regeneratorRuntime.mark(function e(t,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.$emit("show-menu-item",{menu:this.menu,bool:t,evt:r});case 1:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},created:function(){this.$emit("init-menu-item",{layerOpacity:this.menu})}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",{on:{mouseleave:function(e){return e.target!==e.currentTarget?null:t.showLayerOpacityMenu(!1,e)},mouseover:function(e){return e.target!==e.currentTarget?null:t.showLayerOpacityMenu(!0,e)}}},[e("span",{staticClass:"menu-icon skin-color-dark",class:t.g3wtemplate.getFontClass("slider")}),t._v(" "),e("span",{directives:[{name:"t",rawName:"v-t",value:"catalog_items.contextmenu.layer_opacity",expression:"'catalog_items.contextmenu.layer_opacity'"}],staticClass:"item-text"}),t._v(" "),e("span",{staticClass:"menu-icon",class:t.g3wtemplate.getFontClass("arrow-right"),staticStyle:{position:"absolute",right:"0","margin-top":"3px"}}),t._v(" "),e("ul",{directives:[{name:"show",rawName:"v-show",value:t.layer&&t.menu.show,expression:"layer && menu.show"}],style:{top:t.menu.top+"px",left:t.menu.left-15+"px",maxHeight:t.menu.maxHeight+"px",overflowY:t.menu.overflowY,paddingLeft:0,position:"fixed",backgroundColor:"#FFF",color:"#000"}},[e("li",[e("range",{attrs:{value:t.layer.opacity,min:0,max:100,step:1,sync:!1,showValue:!0,unit:"%"},on:{"change-range":t.setLayerOpacity}})],1)])])},e.staticRenderFns=[],e._scopeId="data-v-232670c6"},{"gui/catalog/vue/catalogeventhub":114,"store/catalog-layers":374,"vueify/lib/insert-css":1}],254:[function(e,t,r){var n,i;e("vueify/lib/insert-css").insert(".g3w-map-controls-left-bottom[data-v-56499137]{position:absolute;bottom:75px;left:10px;z-index:1}");function a(e){return e&&e.__esModule?e:{default:e}}function o(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),i=a(e("components/MapAddLayer.vue")),e=a(e("components/MapFooter.vue")),r.default={name:"g3w-map",data:function(){var e=this.$options,t=e.service;return{target:e.target,maps_container:this.$options.maps_container,service:t,hidemaps:t.state.hidemaps,map_info:t.state.map_info}},components:{addlayer:i.default,MapFooter:e.default},computed:{mapcontrolsalignement:function(){return this.service.state.mapcontrolsalignement},disableMapControls:function(){return this.service.state.mapControl.disabled}},methods:{showHideControls:function(){this.service.getMapControls().forEach(function(e){return"scaleline"!==e.type&&e.control.showHide()})}},mounted:(n=o(regeneratorRuntime.mark(function e(){var s=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.crs=this.service.getCrs(),e.next=3,this.$nextTick();case 3:this.service.setMapControlsContainer($(this.$refs["g3w-map-controls"])),this.service.onafter("addHideMap",o(regeneratorRuntime.mark(function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.ratio,n=t.layers,i=void 0===n?[]:n,n=t.mainview,a=void 0!==n&&n,n=t.switchable,o=void 0!==n&&n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.$nextTick();case 2:s.service._addHideMap({ratio:r,layers:i,mainview:a,switchable:o});case 3:case"end":return e.stop()}},e,s)})));case 5:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)}),destroyed:function(){this.service.clear()}},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:e.maps_container}},[e._l(e.hidemaps,function(e){return r("div",{key:e.id,staticClass:"g3w-map hidemap",attrs:{id:e.id}})}),e._v(" "),r("div",{staticClass:"g3w-map",attrs:{id:e.target}},[r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.disableMapControls,expression:"disableMapControls"}],ref:"g3w-map-controls",staticClass:"g3w-map-controls",class:e.mapcontrolsalignement,staticStyle:{display:"flex"}}),e._v(" "),e.map_info.info?r("div",{ref:"g3w-map-info",style:e.map_info.style,attrs:{id:"g3w-map-info"}},[e._v("\n      "+e._s(e.map_info.info)+"\n    ")]):e._e(),e._v(" "),e._m(0),e._v(" "),r("addlayer",{attrs:{service:e.service}}),e._v(" "),r("div",{staticClass:"g3w-map-controls-left-bottom"})],1),e._v(" "),r("map-footer",{attrs:{service:e.service}})],2)},r.staticRenderFns=[function(){var e=this.$createElement,e=this._self._c||e;return e("div",{staticStyle:{display:"none"}},[e("div",{attrs:{id:"marker"}})])}],r._scopeId="data-v-56499137"},{"components/MapAddLayer.vue":255,"components/MapFooter.vue":257,"vueify/lib/insert-css":1}],255:[function(e,t,r){function n(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),i=e("vue-color"),a=e("app/constant"),c=e("g3w-ol/projection/projections"),e=e("core/utils/geo"),d=e.createVectorLayerFromFile,p=e.createStyleFunctionToVectorLayer,f=["zip","geojson","GEOJSON","kml","kmz","KMZ","KML","json","gpx","gml","csv"],h=[",",";"],i.Chrome.mounted=n(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:$(".vue-color__chrome__toggle-btn").remove(),$(".vue-color__editable-input__label").remove(),$(".vue-color__chrome__saturation-wrap").css("padding-bottom","100px"),$(".vue-color__chrome").css({"box-shadow":"0 0 0 0",border:"1px solid #97A1A8"});case 6:case"end":return e.stop()}},e,this)})),r.default={name:"map-add-layer",props:["service"],data:function(){var t=this.service.getCrs();return void 0===a.EPSG.find(function(e){return e===t})&&a.EPSG.unshift(t),{vectorLayer:null,options:a.EPSG,error:!1,error_message:null,position:null,loading:!1,fields:[],field:null,accepted_extension:f.map(function(e){return"."+e}).join(","),csv:{valid:!1,loading:!1,headers:[],x:null,y:null,separators:h,separator:h[0]},layer:{name:null,type:null,crs:null,mapCrs:null,color:{hex:"#194d33",rgba:{r:25,g:77,b:51,a:1},a:1},data:null,visible:!0,title:null,id:null,external:!0}}},components:{"chrome-picker":i.Chrome},computed:{csv_extension:function(){return"csv"===this.layer.type},add:function(){return this.layer.data||this.csv.valid}},methods:{setLayerMapPosition:function(e){this.position=e},setError:function(e){this.error_message="sdk.errors."+e,this.error=!0},clearError:function(){this.error=!1,this.error_message=null},onChangeColor:function(e){this.layer.color=e},onAddLayer:(u=n(regeneratorRuntime.mark(function e(n){var i,t,a,r,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=new FileReader,r=n.target.files[0].name,t=(t=n.target.files[0].name.split("."))[t.length-1].toLowerCase(),a=$(this.$refs.input_file),-1===f.indexOf(t)?e.next=32:(this.clearError(),this.layer.mapCrs=this.service.getEpsg(),this.layer.name=r,this.layer.title=r,this.layer.id=r,this.layer.type=t,"csv"!==this.layer.type?e.next=17:(i.onload=function(e){a.val(null);function t(e){var t=null,r=(o.csv.loading=!0,n.split(e));return 1<r.length?(o.csv.headers=r,o.fields=r,o.csv.x=r[0],o.csv.y=r[1],t={headers:r,separator:e,x:o.csv.x,y:o.csv.y,values:i},o.csv.valid=!0):(o.csv.headers=o.fields=[],o.vectorLayer=null,o.csv.valid=!1,o.fields.splice(0)),o.csv.loading=!1,t}var e=e.target.result.split(/\r\n|\n/).filter(function(e){return e}),e=(e=e,Array.isArray(e)?e:Array.from(e)),n=e[0],i=e.slice(1);o.layer.data=t(o.csv.separator),o.$watch("csv.separator",function(e){return o.layer.data=t(e)})},i.readAsText(n.target.files[0]),e.next=30));break;case 17:return r=new Promise(function(t,e){var r;"zip"===o.layer.type||"kmz"===o.layer.type?(r=n.target.files[0],a.val(null),t(r)):(i.onload=function(e){e=e.target.result;a.val(null),t(e)},i.readAsText(n.target.files[0]))}),e.next=20,r;case 20:return this.layer.data=e.sent,e.prev=21,this.fields.splice(0),e.next=25,this.createVectorLayer();case 25:this.fields=this.vectorLayer.get("_fields"),e.next=30;break;case 28:e.prev=28,e.t0=e.catch(21);case 30:e.next=33;break;case 32:this.setError("unsupported_format");case 33:case"end":return e.stop()}},e,this,[[21,28]])})),function(e){return u.apply(this,arguments)}),createVectorLayer:(l=n(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d(this.layer);case 3:return this.vectorLayer=e.sent,e.next=6,this.$nextTick();case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.setError("add_external_layer");case 11:case"end":return e.stop()}},e,this,[[0,8]])})),function(){return l.apply(this,arguments)}),addLayer:(s=n(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.layer.data||this.csv.valid)return t=this.layer.crs,e.prev=2,e.prev=3,e.next=6,c.registerProjection(t);e.next=27;break;case 6:e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(3),this.setError(e.t0),e.abrupt("return");case 12:return this.loading=!0,e.next=15,d(this.layer);case 15:return this.vectorLayer=e.sent,this.vectorLayer.setStyle(p({color:this.layer.color,field:this.field})),e.next=19,this.service.addExternalLayer(this.vectorLayer,{crs:this.layer.crs,type:this.layer.type,position:this.position});case 19:$(this.$refs.modal_addlayer).modal("hide"),this.clear(),e.next=26;break;case 23:e.prev=23,e.t1=e.catch(2),this.setError("add_external_layer");case 26:this.loading=!1;case 27:case"end":return e.stop()}},e,this,[[2,23],[3,8]])})),function(){return s.apply(this,arguments)}),clear:function(){this.clearError(),this.loading=!1,this.layer.name=null,this.layer.title=null,this.layer.id=null,this.layer.type=null,this.layer.crs=this.service.getCrs(),this.layer.color={hex:"#194d33",rgba:{r:25,g:77,b:51,a:1},a:1},this.layer.data=null,this.vectorLayer=null,this.fields=[],this.field=null,this.csv.valid=!1},clearLayer:function(){this.clear()}},watch:{"csv.x":function(e){e&&(this.layer.data.x=e)},"csv.y":function(e){e&&(this.layer.data.y=e)}},created:function(){var e=this;this.layer.crs=this.service.getCrs(),this.service.on("addexternallayer",function(){return e.modal.modal("show")})},mounted:(o=n(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.modal=$("#modal-addlayer").modal("hide"),this.modal.on("hide.bs.modal",function(){t.clear()});case 4:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)}),beforeDestroy:function(){this.clear(),this.modal.modal("hide"),this.modal.remove()}},t.exports.__esModule&&(t.exports=t.exports.default);var i,a,o,s,l,u,c,d,p,f,h,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var r=this,e=r.$createElement,t=r._self._c||e;return t("div",{ref:"modal_addlayer",staticClass:"modal fade",attrs:{id:"modal-addlayer",role:"dialog"}},[t("div",{staticClass:"modal-dialog"},[t("div",{staticClass:"modal-content"},[t("div",{staticClass:"modal-header"},[t("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal"}},[r._v("×")]),r._v(" "),t("h4",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.header",expression:"'mapcontrols.add_layer_control.header'"}],staticClass:"modal-title",staticStyle:{"font-weight":"bold"}})]),r._v(" "),t("div",{staticClass:"modal-body"},[t("div",{staticClass:"form-group"},[t("label",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.select_projection",expression:"'mapcontrols.add_layer_control.select_projection'"}],attrs:{for:"projection-layer"}}),r._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:r.layer.crs,expression:"layer.crs"}],staticClass:"form-control",attrs:{id:"projection-layer"},on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});r.$set(r.layer,"crs",e.target.multiple?t:t[0])}}},r._l(r.options,function(e){return t("option",{domProps:{value:e}},[r._v(r._s(e))])}),0)]),r._v(" "),t("layerspositions",{on:{"layer-position-change":function(e){return r.setLayerMapPosition(e)}}}),r._v(" "),t("p",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.select_color",expression:"'mapcontrols.add_layer_control.select_color'"}],staticStyle:{"font-weight":"700"}}),r._v(" "),t("chrome-picker",{staticStyle:{width:"100%",margin:"auto"},on:{input:r.onChangeColor},model:{value:r.layer.color,callback:function(e){r.$set(r.layer,"color",e)},expression:"layer.color"}}),r._v(" "),t("bar-loader",{attrs:{loading:r.loading}}),r._v(" "),t("form",{attrs:{id:"addcustomlayer"}},[t("input",{ref:"input_file",attrs:{type:"file",title:" ",accept:r.accepted_extension},on:{change:function(e){return r.onAddLayer(e)}}}),r._v(" "),t("h4",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.drag_layer",expression:"'mapcontrols.add_layer_control.drag_layer'"}]}),r._v(" "),r.layer.name?t("h4",{staticClass:"skin-color",staticStyle:{"font-weight":"bold"}},[r._v(r._s(r.layer.name))]):r._e(),r._v(" "),t("div",[t("i",{staticClass:"fa-5x",class:r.g3wtemplate.getFontClass("cloud-upload"),attrs:{"aria-hidden":"true"}})]),r._v(" "),t("p",{staticStyle:{"font-weight":"bold"}},[r._v("[.gml, .geojson, .kml, .kmz ,.gpx, .csv, .zip(shapefile)]")])]),r._v(" "),r.csv_extension?t("div",{staticStyle:{padding:"15px",border:"1px solid grey","border-radius":"3px"}},[t("bar-loader",{attrs:{loading:r.csv.loading}}),r._v(" "),t("div",{staticClass:"select_field"},[t("label",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.select_csv_separator",expression:"'mapcontrols.add_layer_control.select_csv_separator'"}],attrs:{for:"g3w-select-field-layer"}}),r._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:r.csv.separator,expression:"csv.separator"}],staticClass:"form-control",attrs:{id:"g3w-select-separator"},on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});r.$set(r.csv,"separator",e.target.multiple?t:t[0])}}},r._l(r.csv.separators,function(e){return t("option",{key:e,domProps:{value:e}},[r._v(r._s(e))])}),0),r._v(" "),t("div",{staticClass:"select_field",class:{"g3w-disabled":!r.csv.headers||0===r.csv.headers.length}},[t("label",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.select_csv_x_field",expression:"'mapcontrols.add_layer_control.select_csv_x_field'"}],attrs:{for:"g3w-select-x-field"}}),r._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:r.csv.x,expression:"csv.x"}],staticClass:"form-control",attrs:{id:"g3w-select-x-field"},on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});r.$set(r.csv,"x",e.target.multiple?t:t[0])}}},r._l(r.csv.headers,function(e){return t("option",{key:e,domProps:{value:e}},[r._v(r._s(e))])}),0)]),r._v(" "),t("div",{staticClass:"select_field",class:{"g3w-disabled":!r.csv.headers||0===r.csv.headers.length}},[t("label",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.select_csv_y_field",expression:"'mapcontrols.add_layer_control.select_csv_y_field'"}],attrs:{for:"g3w-select-y-field"}}),r._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:r.csv.y,expression:"csv.y"}],staticClass:"form-control",attrs:{id:"g3w-select-y-field"},on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});r.$set(r.csv,"y",e.target.multiple?t:t[0])}}},r._l(r.csv.headers,function(e){return t("option",{key:e,domProps:{value:e}},[r._v(r._s(e))])}),0)])])],1):r._e(),r._v(" "),t("div",{staticClass:"select_field",class:{"g3w-disabled":!r.fields||0===r.fields.length}},[t("label",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.select_field_to_show",expression:"'mapcontrols.add_layer_control.select_field_to_show'"}],attrs:{for:"g3w-select-field-layer"}}),r._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:r.field,expression:"field"}],staticClass:"form-control",attrs:{id:"g3w-select-field-layer"},on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});r.field=e.target.multiple?t:t[0]}}},[t("option",{domProps:{value:null}},[r._v("---")]),r._v(" "),r._l(r.fields,function(e){return t("option",{key:e,domProps:{value:e}},[r._v(r._s(e))])})],2)]),r._v(" "),r.error?t("div",{directives:[{name:"t",rawName:"v-t",value:r.error_message,expression:"error_message"}],staticStyle:{"font-weight":"bold","font-size":"1.2em","background-color":"orange",padding:"10px","text-align":"center"}}):r._e(),r._v(" "),t("div",{staticClass:"modal-footer"},[t("button",{directives:[{name:"t",rawName:"v-t",value:"add",expression:"'add'"}],staticClass:"btn btn-success pull-left",attrs:{type:"button",disabled:!r.add},on:{click:function(e){return e.stopPropagation(),r.addLayer(e)}}}),r._v(" "),t("button",{directives:[{name:"t",rawName:"v-t",value:"close",expression:"'close'"}],staticClass:"btn btn-default",attrs:{type:"button","data-dismiss":"modal"}})])],1)])])])},e.staticRenderFns=[]},{"app/constant":4,"core/utils/geo":64,"g3w-ol/projection/projections":111,"vue-color":"vue-color"}],256:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),a=e("services/gui"),n=(a=a)&&a.__esModule?a:{default:a},i=e("core/utils/utils").debounce,r.default={name:"MapControlZoomHistory",data:function(){return{history:{index:0,items:[]}}},methods:{last:function(){this.history.index--,this.setMapExtent()},next:function(){this.history.index++,this.setMapExtent()},setMapExtent:function(){n.default.getService("map").getMap().getView().fit(this.history.items[this.history.index])}},computed:{hasEmptyHistory:function(){return 0===this.history.index&&1===this.history.items.length||this.history.items.length-1===this.history.index}},created:function(){var t=this,r=n.default.getService("map").getMap(),e=r.getView();this.history.items.push(e.calculateExtent(r.getSize())),this.changeKeyEvent=e.on("change",i(function(e){t.history.index!==t.history.items.length-1&&t.history.items.splice(t.history.index-t.history.items.length+1),t.history.items.push(e.target.calculateExtent(r.getSize())),t.history.index++},600))},beforeDestroy:function(){ol.Object.unByKey(this.changeKeyEvent)}},t.exports.__esModule&&(t.exports=t.exports.default);var n,i,a="function"==typeof t.exports?t.exports.options:t.exports;a.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",{staticClass:"ol-zoom-history ol-unselectable ol-control",staticStyle:{display:"flex",gap:"5px"}},[e("div",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top.create",value:"sdk.mapcontrols.zoomhistory.zoom_last",expression:"'sdk.mapcontrols.zoomhistory.zoom_last'",arg:"top",modifiers:{create:!0}}]},[e("button",{directives:[{name:"disabled",rawName:"v-disabled",value:0===t.history.index,expression:"history.index === 0"}],attrs:{type:"button"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.last(e)}}},[e("i",{class:t.g3wtemplate.getFontClass("reply")})])]),t._v(" "),e("div",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top.create",value:"sdk.mapcontrols.zoomhistory.zoom_next",expression:"'sdk.mapcontrols.zoomhistory.zoom_next'",arg:"top",modifiers:{create:!0}}]},[e("button",{directives:[{name:"disabled",rawName:"v-disabled",value:t.hasEmptyHistory,expression:"hasEmptyHistory"}],attrs:{type:"button"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.next(e)}}},[e("i",{class:t.g3wtemplate.getFontClass("share")})])])])},a.staticRenderFns=[],a._scopeId="data-v-2b972d3b"},{"core/utils/utils":68,"services/gui":361}],257:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),i=n(e("components/MapFooterRight.vue")),e=n(e("components/MapFooterLeft.vue")),r.default={name:"Mapfooter",props:{service:{type:Object}},components:{MapFooterRight:i.default,MapFooterLeft:e.default}},t.exports.__esModule&&(t.exports=t.exports.default);var i,r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var e=this.$createElement,e=this._self._c||e;return e("div",{staticClass:"skin-border-color",attrs:{id:"map_footer"}},[e("map-footer-left"),this._v(" "),e("map-footer-right",{attrs:{service:this.service}})],1)},r.staticRenderFns=[]},{"components/MapFooterLeft.vue":258,"components/MapFooterRight.vue":259}],258:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default={name:"Mapfooter"},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var e=this.$createElement;this._self._c;return this._m(0)},r.staticRenderFns=[function(){var e=this.$createElement,e=this._self._c||e;return e("div",{staticStyle:{display:"flex"},attrs:{id:"map_footer_left"}},[e("a",{staticStyle:{"margin-left":"5px","align-self":"center"},attrs:{href:"https://g3wsuite.it/",target:"_blank"}},[e("img",{attrs:{height:"15",src:"/static/client/images/g3wsuite_logo.png",alt:""}})])])}]},{}],259:[function(e,t,r){function n(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),e=e("store/application-state"),a=(e=e)&&e.__esModule?e:{default:e},r.default={name:"map-footer-right",props:{service:{type:Object}},data:function(){return{mouse:{switch_icon:!1,epsg_4326:!1,tooltip:null},mapunit:a.default.map.unit}},computed:{showmapunits:function(){return 1<this.service.state.mapunits.length}},methods:{createCopyMapExtentUrl:function(){this.service.createCopyMapExtentUrl()},switchMapsCoordinateTo4326:function(){this.mouse.epsg_4326=!this.mouse.epsg_4326}},watch:{mapunit:function(e){a.default.map.unit=e,this.service.changeScaleLineUnit(e)}},mounted:(i=n(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.service.once("ready",function(){t.mouse.switch_icon=t.service.getMapControlByType({type:"mouseposition"})&&"EPSG:4326"!==t.service.getEpsg(),t.mouse.tooltip="ESPG "+t.service.getCrs().split(":")[1]+" <--\x3e WGS84"});case 1:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default);var i,a,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var r=this,e=r.$createElement,t=r._self._c||e;return t("div",{staticStyle:{display:"flex"},attrs:{id:"map_footer_right"}},[t("div",{attrs:{id:"scale-control"}}),r._v(" "),r.mouse.switch_icon&&!r.isMobile()?t("div",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top.create",value:r.mouse.tooltip,expression:"mouse.tooltip",arg:"top",modifiers:{create:!0}}],attrs:{id:"switch-mouse-coordinate"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),r.switchMapsCoordinateTo4326(e)}}},[t("span",{staticClass:"skin-color hide-cursor-caret-color",class:r.g3wtemplate.getFontClass("mouse")})]):r._e(),r._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:!r.mouse.epsg_4326,expression:"!mouse.epsg_4326"}],attrs:{id:"mouse-position-control"}}),r._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:r.mouse.epsg_4326,expression:"mouse.epsg_4326"}],attrs:{id:"mouse-position-control-epsg-4326"}}),r._v(" "),r.showmapunits?t("div",{attrs:{id:"scale-line-units"}},[t("select",{directives:[{name:"model",rawName:"v-model",value:r.mapunit,expression:"mapunit"}],staticClass:"skin-color",staticStyle:{padding:"5px 2px","font-weight":"bold",border:"0",cursor:"pointer"},on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});r.mapunit=e.target.multiple?t:t[0]}}},r._l(r.service.state.mapunits,function(e){return t("option",{directives:[{name:"t",rawName:"v-t",value:"sdk.mapcontrols.scaleline.units."+e,expression:"`sdk.mapcontrols.scaleline.units.${unit}`"}],staticStyle:{"font-weight":"bold"},domProps:{value:e,selected:r.mapunit===e}})}),0)]):r._e(),r._v(" "),t("div",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top.create",value:"sdk.tooltips.copy_map_extent_url",expression:"'sdk.tooltips.copy_map_extent_url'",arg:"top",modifiers:{create:!0}}],staticStyle:{"background-color":"#eeeeee"},attrs:{id:"permalink"}},[t("span",{staticClass:"skin-color",class:r.g3wtemplate.getFontClass("link"),on:{click:function(e){return e.stopPropagation(),r.createCopyMapExtentUrl(e)}}})])])},e.staticRenderFns=[]},{"store/application-state":373}],260:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default={name:"metadata",data:function(){return{state:null}}},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var e=this.$createElement;return(this._self._c||e)("div")},r.staticRenderFns=[]},{}],261:[function(e,t,r){e("vueify/lib/insert-css").insert('.layer_header[data-v-409d907d]{padding:5px;margin-bottom:0;margin-top:0;cursor:pointer}.layer-name[data-v-409d907d]{font-weight:700}.layer-header-icon[data-v-409d907d]{margin-right:10px;color:#999}.layer_header span.open-close[data-v-409d907d]{position:absolute;right:5px;color:#999}.metadata-label[data-v-409d907d]{font-weight:700;font-size:1.1em}.row[data-v-409d907d]{padding:10px;border-bottom:1px solid #e2e2e2}.nav-tabs[data-v-409d907d]{border-bottom:0 solid #ddd}.nav-tabs>li.active>a[data-v-409d907d],.nav-tabs>li.active>a[data-v-409d907d]:focus,.nav-tabs>li.active>a[data-v-409d907d]:hover{border-width:0}.nav-tabs>li>a[data-v-409d907d]{border:none;color:#aeaeae}.nav-tabs>li.active>a[data-v-409d907d],.nav-tabs>li>a[data-v-409d907d]:hover{border:none;background:transparent}.nav-tabs>li>a[data-v-409d907d]:after{content:"";height:2px;position:absolute;width:100%;left:0;bottom:-1px;transition:all .25s ease 0s;transform:scale(0)}.nav-tabs>li.active>a[data-v-409d907d]:after,.nav-tabs>li:hover>a[data-v-409d907d]:after{transform:scale(1)}.tab-nav>li>a[data-v-409d907d]:after{background:#21527d none repeat scroll 0 0;color:#fff}.tab-content[data-v-409d907d]{margin:10px;background-color:#eee;overflow:auto}.spatial-tab[data-v-409d907d]{font-weight:700}');Object.defineProperty(r,"__esModule",{value:!0}),e=e("mixins"),r.default={name:"layer",mixins:[e.metadataMixin],props:{state:{}},data:function(){return{show:!1}},computed:{isSpatial:function(){return"NoGeometry"!=this.state.geometrytype}},methods:{showHideInfo:function(){this.show=!this.show}},mounted:function(){}},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("div",{staticClass:"row-info"},[n("h4",{staticClass:"layer_header",attrs:{"data-toggle":"collapse","data-target":"#"+r.state.id},on:{click:r.showHideInfo}},[n("i",{staticClass:"layer-header-icon action-button nohover",class:[r.isSpatial?r.g3wtemplate.font.map:r.g3wtemplate.font.table],attrs:{"aria-hidden":"true"}}),r._v(" "),n("span",{staticClass:"layer-name"},[r._v(r._s(r.state.name))]),r._v(" "),n("span",{staticClass:"action-button nohover open-close",class:[r.show?r.g3wtemplate.getFontClass("minus"):r.g3wtemplate.getFontClass("plus")]})]),r._v(" "),n("div",{staticClass:"collapse",attrs:{id:r.state.id}},[n("ul",{staticClass:"metadata-nav-tabs nav nav-tabs",attrs:{role:"tablist"}},[n("li",{staticClass:"active spatial-tab",attrs:{role:"presentation"}},[n("a",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.groups.general",expression:"'sdk.metadata.groups.layers.groups.general'"}],attrs:{href:"#layer_general_"+r.state.id,"aria-controls":"general",role:"tab","data-toggle":"tab"}})]),r._v(" "),r.isSpatial?n("li",{staticClass:"spatial-tab",attrs:{role:"presentation"}},[n("a",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.groups.spatial",expression:"'sdk.metadata.groups.layers.groups.spatial'"}],attrs:{href:"#layer_spatial_"+r.state.id,"aria-controls":"profile",role:"tab","data-toggle":"tab"}})]):r._e()]),r._v(" "),n("div",{staticClass:"tab-content"},[n("div",{staticClass:"tab-pane active",attrs:{role:"tabpanel",id:"layer_general_"+r.state.id}},[n("div",{staticClass:"container-fluid"},[r.findAttributeFormMetadataAttribute("title")?n("div",{staticClass:"row"},[n("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.title",expression:"'sdk.metadata.groups.layers.fields.subfields.title'"}],staticClass:"col-md-2 col-sm-12 metadata-label"}),r._v(" "),n("div",{staticClass:"col-md-10 col-sm-12 value"},[r._v(r._s(r.state.metadata.title))])]):r._e(),r._v(" "),r.findMetadataAttribute("name")?n("div",{staticClass:"row"},[n("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.name",expression:"'sdk.metadata.groups.layers.fields.subfields.name'"}],staticClass:"col-md-2 col-sm-12 metadata-label"}),r._v(" "),n("div",{staticClass:"col-md-10 col-sm-12 value"},[r._v(r._s(r.state.name))])]):r._e(),r._v(" "),r.findMetadataAttribute("source")?n("div",{staticClass:"row metadata-layer-source"},[n("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.source",expression:"'sdk.metadata.groups.layers.fields.subfields.source'"}],staticClass:"col-md-2 col-sm-12 metadata-label metadata-layer-source-value-key"}),r._v(" "),n("div",{staticClass:"col-md-10 col-sm-12 value metadata-layer-source-value"},[r._v(r._s(r.state.source.type))])]):r._e(),r._v(" "),r.findAttributeFormMetadataAttribute("abstract")?n("div",{staticClass:"row"},[n("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.abstract",expression:"'sdk.metadata.groups.layers.fields.subfields.abstract'"}],staticClass:"col-md-2 col-sm-12 metadata-label"}),r._v(" "),n("div",{staticClass:"col-md-10 col-sm-12 value",domProps:{innerHTML:r._s(r.state.metadata.abstract)}})]):r._e(),r._v(" "),r.findAttributeFormMetadataAttribute("keywords")?n("div",{staticClass:"row"},[n("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.keywords",expression:"'sdk.metadata.groups.layers.fields.subfields.keywords'"}],staticClass:"col-md-2 col-sm-12 metadata-label"}),r._v(" "),n("div",{staticClass:"col-md-10 col-sm-12 value"},[n("div",[r._v(r._s(r.state.metadata.keywords.join(", ")))])])]):r._e(),r._v(" "),r.findAttributeFormMetadataAttribute("metadataurl")&&r.state.metadata.metadataurl.onlineresources?n("div",{staticClass:"row"},[n("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.metadataurl",expression:"'sdk.metadata.groups.layers.fields.subfields.metadataurl'"}],staticClass:"col-md-2 col-sm-12 metadata-label"}),r._v(" "),n("div",{staticClass:"col-md-10 col-sm-12 value"},[n("a",{attrs:{href:r.state.metadata.metadataurl.onlineresources}},[r._v(r._s(r.state.metadata.metadataurl.onlineresources))])])]):r._e(),r._v(" "),r.findAttributeFormMetadataAttribute("dataurl")&&r.state.metadata.dataurl.onlineresources?n("div",{staticClass:"row"},[n("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.dataurl",expression:"'sdk.metadata.groups.layers.fields.subfields.dataurl'"}],staticClass:"col-md-2 col-sm-12 metadata-label"}),r._v(" "),n("div",{staticClass:"col-md-10 col-sm-12 value"},[n("a",{attrs:{href:r.state.metadata.dataurl.onlineresources}},[r._v(r._s(r.state.metadata.dataurl.onlineresources))])])]):r._e(),r._v(" "),r.findAttributeFormMetadataAttribute("attributes")?n("div",{staticClass:"row"},[n("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.attributes",expression:"'sdk.metadata.groups.layers.fields.subfields.attributes'"}],staticClass:"col-md-2 col-sm-12 metadata-label"}),r._v(" "),n("div",{staticClass:"col-md-10 col-sm-12 value",staticStyle:{overflow:"auto"}},[n("table",{staticClass:"table table-striped",staticStyle:{"background-color":"#eeeeee !important"}},[n("thead",[n("tr",r._l(r.state.metadata.attributes[0],function(e,t){return n("th",[r._v(r._s(t))])}),0)]),r._v(" "),n("tbody",r._l(r.state.metadata.attributes,function(e){return n("tr",r._l(e,function(e,t){return n("td",[r._v(r._s(e))])}),0)}),0)])])]):r._e()])]),r._v(" "),n("div",{staticClass:"tab-pane",attrs:{role:"tabpanel",id:"layer_spatial_"+r.state.id}},[n("div",{staticClass:"container-fluid"},[r.findMetadataAttribute("crs")?n("div",{staticClass:"row"},[n("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.crs",expression:"'sdk.metadata.groups.layers.fields.subfields.crs'"}],staticClass:"col-sm-2 metadata-label"}),r._v(" "),n("div",{staticClass:"col-sm-10 value"},[r._v(r._s(r.state.crs.epsg))])]):r._e(),r._v(" "),r.findMetadataAttribute("geometrytype")?n("div",{staticClass:"row"},[n("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.geometrytype",expression:"'sdk.metadata.groups.layers.fields.subfields.geometrytype'"}],staticClass:"col-sm-2 metadata-label"}),r._v(" "),n("div",{staticClass:"col-sm-10 value"},[r._v(r._s(r.state.geometrytype))])]):r._e(),r._v(" "),r.findMetadataAttribute("bbox")?n("div",{staticClass:"row"},[n("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.bbox",expression:"'sdk.metadata.groups.layers.fields.subfields.bbox'"}],staticClass:"col-sm-2 metadata-label"}),r._v(" "),n("div",{staticClass:"col-sm-10 value"},r._l(r.state.bbox,function(e,t){return n("p",[n("span",{staticStyle:{"font-weight":"bold","margin-right":"5px"}},[r._v(r._s(t))]),r._v(" "),n("span",[r._v(r._s(e))])])}),0)]):r._e(),r._v(" "),r.findAttributeFormMetadataAttribute("crs")?n("div",{staticClass:"row"},[n("div",{staticClass:"col-sm-2 metadata-label"},[r._v("CRS")]),r._v(" "),n("div",{staticClass:"col-sm-10 value"},r._l(r.state.metadata.crs,function(e){return n("div",[n("span",[r._v(r._s(e))])])}),0)]):r._e()])])])])])},r.staticRenderFns=[],r._scopeId="data-v-409d907d"},{mixins:343,"vueify/lib/insert-css":1}],262:[function(e,t,r){var n,i,a,o;e("vueify/lib/insert-css").insert(".metadata-nav-bar li a[data-v-032bed45]{text-align:center}.metadata-nav-bar li a i[data-v-032bed45]{margin-right:5px}.metadata-item-tab[data-v-032bed45]{margin-right:10px;border-radius:3px;margin-bottom:10px}.metadata-body[data-v-032bed45]{overflow-y:auto;overflow-x:hidden;padding-left:0;padding-right:0}.tab-title[data-v-032bed45]{position:absolute;bottom:10px;right:auto}.row-info[data-v-032bed45]{margin:0!important;padding-top:10px;padding-bottom:10px;border-bottom:1px solid #eee}.row-info .label[data-v-032bed45]{font-weight:700}.h_90[data-v-032bed45]{height:90%}.h_100[data-v-032bed45]{height:100%}#project-catalog[data-v-032bed45]{position:relative;overflow:auto}.nav-tabs-wrapper[data-v-032bed45]{display:inline-block;margin-bottom:-6px;margin-left:1.25%;margin-right:1.25%;position:relative;width:100%}.nav-tabs[data-v-032bed45]{border-bottom:0 none}.nav-stacked[data-v-032bed45]{font-size:1.2em;font-weight:700;padding:10px 0}.nav-stacked li a[data-v-032bed45]{color:#fff}.left-vertical-tabs[data-v-032bed45]{padding-left:0!important}");function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=s(e("components/MetadataLayer.vue")),a=s(e("components/MetadataProjectTabContent.vue")),o=s(e("components/MetadataProjectBBoxContent.vue")),e=s(e("components/MetadataProjectContactsContent.vue")),r.default={name:"project",data:function(){return{state:this.$options.state,iconsClass:{info:this.g3wtemplate.getFontClass("info-circle"),globe:this.g3wtemplate.getFontClass("globe"),bars:this.g3wtemplate.getFontClass("bars")}}},components:{"metadata-layer":i.default,"metadata-tab-content":a.default,"metadata-bbox-content":o.default,"metadata-contacts-content":e.default},methods:{isArrayorObject:function(e){return Array.isArray(e)||"object"===(void 0===e?"undefined":n(e))},setComponent:function(e){var t=void 0;switch(e){case"extent":t="metadata-bbox-content";break;case"contactinformation":t="metadata-contacts-content";break;default:t="metadata-tab-content"}return t}}},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("div",{attrs:{id:"project-catalog"}},[n("div",{class:r.isMobile()?"mobile":null,staticStyle:{padding:"0"},attrs:{id:"project-catalog-container"}},[n("ul",{staticClass:"nav nav-tabs metadata-nav-bar",attrs:{role:"tablist"}},[n("li",{staticClass:"active"},[n("a",{staticClass:"metadata-item-tab general",attrs:{"data-toggle":"tab",href:"#general"}},[n("i",{staticClass:"action-button nohover",class:r.g3wtemplate.getFontClass("info"),attrs:{"aria-hidden":"true"}}),r._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.general.title",expression:"'sdk.metadata.groups.general.title'"}],staticStyle:{"font-weight":"bold"}})])]),r._v(" "),n("li",[n("a",{staticClass:"metadata-item-tab spatial",attrs:{"data-toggle":"tab",href:"#spatial"}},[n("i",{staticClass:"action-button nohover",class:r.iconsClass.globe,attrs:{"aria-hidden":"true"}}),r._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.spatial.title",expression:"'sdk.metadata.groups.spatial.title'"}],staticStyle:{"font-weight":"bold"}})])]),r._v(" "),n("li",[n("a",{staticClass:"metadata-item-tab layers",attrs:{"data-toggle":"tab",href:"#metadata_layers"}},[n("i",{staticClass:"action-button nohover",class:r.iconsClass.bars,attrs:{"aria-hidden":"true"}}),r._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.title",expression:"'sdk.metadata.groups.layers.title'"}],staticStyle:{"font-weight":"bold"}})])])])]),r._v(" "),n("div",{staticClass:"col-sm-12 metadata-body tab-content"},[n("div",{staticClass:"tab-pane fade in active",attrs:{id:"general"}},[r._l(r.state.groups.general,function(e,t){return n("div",{staticClass:"row h_100 row-info"},[n(r.setComponent(t),{tag:"component",attrs:{data:e,fieldName:t}})],1)})],2),r._v(" "),n("div",{staticClass:"tab-pane fade",attrs:{id:"spatial"}},[n("div",[r._l(r.state.groups.spatial,function(e,t){return n("div",{staticClass:"row row-info"},[n(r.setComponent(t),{tag:"component",attrs:{data:e,fieldName:t}})],1)})],2)]),r._v(" "),n("div",{staticClass:"tab-pane fade",attrs:{id:"metadata_layers"}},r._l(r.state.groups.layers.layers.value,function(e){return n("metadata-layer",{attrs:{state:e}})}),1)])])},r.staticRenderFns=[],r._scopeId="data-v-032bed45"},{"components/MetadataLayer.vue":261,"components/MetadataProjectBBoxContent.vue":263,"components/MetadataProjectContactsContent.vue":264,"components/MetadataProjectTabContent.vue":265,"vueify/lib/insert-css":1}],263:[function(e,t,r){e("vueify/lib/insert-css").insert(".metadata-label[data-v-4f6ab04a]{font-weight:700;font-size:1.1em}.bbox-labels[data-v-4f6ab04a]{font-weight:700}");Object.defineProperty(r,"__esModule",{value:!0}),r.default={name:"metadata-bbox",props:{data:{}},data:function(){return{bboxlabels:["MINX","MINY","MAXX","MAXY"]}}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("div",{staticClass:"wrap-content-tab"},[n("div",{directives:[{name:"t",rawName:"v-t",value:r.data.label,expression:"data.label"}],staticClass:"col-sm-2 metadata-label"}),r._v(" "),n("div",{staticClass:"col-sm-10 value",staticStyle:{"margin-top":"0"}},r._l(r.data.value,function(e,t){return n("div",[n("span",{staticClass:"bbox-labels"},[r._v(r._s(r.bboxlabels[t]))]),r._v(" "+r._s(e)+"\n      ")])}),0)])},e.staticRenderFns=[],e._scopeId="data-v-4f6ab04a"},{"vueify/lib/insert-css":1}],264:[function(e,t,r){e("vueify/lib/insert-css").insert(".metadata-label[data-v-734c25d1]{font-weight:700;font-size:1.1em}.metadata-contact-label[data-v-734c25d1]{font-weight:700}.contact-icon[data-v-734c25d1]{margin-right:3px}.row[data-v-734c25d1]{margin-bottom:5px}");Object.defineProperty(r,"__esModule",{value:!0}),n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r.default={name:"metadatacontatcs",props:{data:{}},data:function(){return{iconsClass:{contactelectronicmailaddress:this.g3wtemplate.getFontClass("mail"),personprimary:this.g3wtemplate.getFontClass("user"),contactvoicetelephone:this.g3wtemplate.getFontClass("mobile")}}},methods:{sanitizeValue:function(e){return null!=e&&("object"===(void 0===e?"undefined":n(e))?e=Object.keys(e).length?e:"":Array.isArray(e)&&(e=e.length?e:"")),e},geti18n:function(e){}}},t.exports.__esModule&&(t.exports=t.exports.default);var n,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("div",{staticClass:"wrap-content-tab"},[n("div",{directives:[{name:"t",rawName:"v-t",value:r.data.label,expression:"data.label"}],staticClass:"col-sm-2 metadata-label"}),r._v(" "),n("div",{staticClass:"col-sm-10 value",staticStyle:{"margin-top":"0"}},r._l(r.data.value,function(e,t){return n("div",[n("div",{staticClass:"row"},[n("div",{staticClass:"col-sm-2 metadata-contact-label"},[n("i",{staticClass:"contact-icon",class:r.iconsClass[t],attrs:{"aria-hidden":"true"}}),r._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.general.fields.subfields.contactinformation."+t,expression:"'sdk.metadata.groups.general.fields.subfields.contactinformation.' + key"}]})]),r._v(" "),n("div",{staticClass:"col-sm-10"},["personprimary"===t?r._l(e,function(e,t){return n("div",[n("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.general.fields.subfields.contactinformation."+t,expression:"'sdk.metadata.groups.general.fields.subfields.contactinformation.' + key"}],staticClass:"metadata-contact-label"}),r._v(" "),n("span",[r._v(r._s(e))])])}):n("div",["contactelectronicmailaddress"===t?[n("a",{staticStyle:{"font-weight":"bold"},attrs:{href:"mailto:"+r.sanitizeValue(e)}},[r._v(r._s(r.sanitizeValue(e)))])]:[r._v("\n              "+r._s(r.sanitizeValue(e))+"\n            ")]],2)],2)])])}),0)])},e.staticRenderFns=[],e._scopeId="data-v-734c25d1"},{"vueify/lib/insert-css":1}],265:[function(e,t,r){e("vueify/lib/insert-css").insert(".metadata-label[data-v-16751e49]{font-weight:700;font-size:1.1em}");Object.defineProperty(r,"__esModule",{value:!0}),n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r.default={name:"metadata-tab-content",props:{data:{},fieldName:{}},computed:{arrayToString:function(){return this.data.value.join(", ")}},methods:{isArrayorObject:function(e){return Array.isArray(e)||"object"===(void 0===e?"undefined":n(e))}}},t.exports.__esModule&&(t.exports=t.exports.default);var n,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("div",{staticClass:"wrap-content-tab"},[n("div",{directives:[{name:"t",rawName:"v-t",value:r.data.label,expression:"data.label"}],staticClass:"col-sm-2 metadata-label"}),r._v(" "),"keywords"==r.fieldName?n("div",{staticClass:"col-sm-10 value"},[r._v("\n    "+r._s(r.arrayToString)+"\n  ")]):"wms_url"==r.fieldName?n("div",{staticClass:"col-sm-10 value",staticStyle:{"margin-top":"0"}},[n("span",[r._v(r._s(r.data.value))])]):!r.isArrayorObject(r.data.value)||"abstract"==r.fieldName?n("div",{staticClass:"col-sm-10 value",staticStyle:{"margin-top":"0"}},[n("span",{domProps:{innerHTML:r._s(r.data.value)}})]):n("div",{staticClass:"col-sm-10 value",staticStyle:{"margin-top":"0"}},r._l(r.data.value,function(e,t){return n("div",[n("span",[r._v(r._s(e))])])}),0)])},e.staticRenderFns=[],e._scopeId="data-v-16751e49"},{"vueify/lib/insert-css":1}],266:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),e=e("services/navbaritems"),n=(e=e)&&e.__esModule?e:{default:e},r.default={name:"NavbaritemLeft",data:function(){return{items:n.default.state.items.right}}},t.exports.__esModule&&(t.exports=t.exports.default);var n,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this.$createElement,t=this._self._c||e;return t("ul",{staticClass:"nav navbar-nav navbar-left"},this._l(this.items,function(e){return t(e,{key:e.id,tag:"li"})}),1)},e.staticRenderFns=[],e._scopeId="data-v-214afbb2"},{"services/navbaritems":365}],267:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),e=e("services/navbaritems"),n=(e=e)&&e.__esModule?e:{default:e},r.default={name:"navbar-item-right",data:function(){return{items:n.default.state.items.right}}},t.exports.__esModule&&(t.exports=t.exports.default);var n,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this.$createElement,t=this._self._c||e;return t("ul",{staticClass:"nav navbar-nav navbar-right"},this._l(this.items,function(e){return t(e,{key:e.id,tag:"li"})}),1)},e.staticRenderFns=[],e._scopeId="data-v-45599481"},{"services/navbaritems":365}],268:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default={name:"download-notify"},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var e=this.$createElement,e=this._self._c||e;return e("div",{directives:[{name:"download",rawName:"v-download.show",modifiers:{show:!0}}],staticClass:"skin-color",attrs:{id:"download_notification",title:"DOWNLOAD"}},[e("bar-loader",{attrs:{loading:"true"}}),this._v(" "),e("i",{class:this.g3wtemplate.getFontClass("download"),staticStyle:{padding:"3px"}})],1)},r.staticRenderFns=[]},{}],269:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default={name:"online-notify"},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var e=this.$createElement,e=this._self._c||e;return e("div",{directives:[{name:"online",rawName:"v-online:hide",arg:"hide"}],staticStyle:{color:"#999"},attrs:{id:"offline_notification"}},[e("i",{class:this.g3wtemplate.getFontClass("wifi")}),this._v(" "),e("div",{staticStyle:{"font-weight":"bold","font-size":"0.4em"}},[this._v("offline")])])},r.staticRenderFns=[]},{}],270:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default={name:"plugins-notify"},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var e=this.$createElement,e=this._self._c||e;return e("div",{directives:[{name:"plugins",rawName:"v-plugins"}],staticStyle:{color:"#994b10"},attrs:{id:"plugins_notification"}},[e("bar-loader",{attrs:{loading:"true"}}),this._v(" "),e("i",{class:this.g3wtemplate.getFontClass("plugin")})],1)},r.staticRenderFns=[]},{}],271:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),o=n(e("components/PrintSelectAtlasFieldValues.vue")),e=n(e("components/PrintFidAtlasValues.vue")),r.default={name:"print",data:function(){return{state:null,templateChanged:!1,button:{class:"btn-success",type:"stampa",disabled:!1}}},components:{SelectAtlasFieldValues:o.default,FidAtlasValues:e.default},computed:{disabled:function(){return this.state.output.loading||!!this.state.atlas&&0===this.state.atlasValues.length}},methods:{setDisabledPrintButton:function(){this.button.disabled=0<arguments.length&&void 0!==arguments[0]&&arguments[0]},setAtlasValues:function(){this.state.atlasValues=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]},onChangeTemplate:(a=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.templateChanged=!0,this.$options.service.changeTemplate(),e.next=4,this.$nextTick();case 4:this.templateChanged=!1;case 5:case"end":return e.stop()}},e,this)})),function(){return a.apply(this,arguments)}),onChangeScale:function(){this.$options.service.changeScale()},onChangeFormat:function(){},onChangeDpi:function(){},onChangeRotation:function(e){0<=this.state.rotation&&!_.isNil(this.state.rotation)&&""!=this.state.rotation?(this.state.rotation=360<this.state.rotation?360:this.state.rotation,e.target.value=this.state.rotation):this.state.rotation<0?(this.state.rotation=this.state.rotation<-360?-360:this.state.rotation,e.target.value=this.state.rotation):this.state.rotation=0,this.$options.service.changeRotation()},print:function(){this.$options.service.print()}}},t.exports.__esModule&&(t.exports=t.exports.default);var a,o,r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("ul",{staticClass:"treeview-menu",attrs:{id:"print"}},[n("li",[n("form",{staticClass:"g3w-search-form form-horizonal"},[n("div",{staticClass:"box-body"},[n("transition",{attrs:{duration:500,name:"fade"}},[n("bar-loader",{attrs:{loading:r.state.loading}})],1),r._v(" "),n("helpdiv",{attrs:{message:"sdk.print.help"}}),r._v(" "),n("label",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.template",expression:"'sdk.print.template'"}],attrs:{for:"templates"}}),r._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:r.state.template,expression:"state.template"}],staticClass:"form-control",style:{marginBottom:this.state.atlas&&"10px"},attrs:{id:"templates"},on:{change:[function(e){var t=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});r.$set(r.state,"template",e.target.multiple?t:t[0])},r.onChangeTemplate]}},r._l(r.state.print,function(e){return n("option",{domProps:{value:e.name}},[r._v(r._s(e.name)+"\n          ")])}),0),r._v(" "),r.state.atlas?r.templateChanged?r._e():[r.state.atlas.field_name?[n("select-atlas-field-values",{attrs:{atlas:r.state.atlas,reset:!r.state.isShow},on:{"disable-print-button":r.setDisabledPrintButton,"set-values":r.setAtlasValues}})]:[n("fid-atlas-values",{attrs:{atlas:r.state.atlas,reset:!r.state.isShow},on:{"disable-print-button":r.setDisabledPrintButton,"set-values":r.setAtlasValues}})]]:[n("label",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.scale",expression:"'sdk.print.scale'"}],attrs:{for:"scala"}}),r._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:r.state.scala,expression:"state.scala"}],staticClass:"form-control",attrs:{id:"scala"},on:{change:[function(e){var t=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});r.$set(r.state,"scala",e.target.multiple?t:t[0])},r.onChangeScale]}},r._l(r.state.scale,function(e){return n("option",{domProps:{value:e.value}},[r._v(r._s(e.label)+"\n            ")])}),0),r._v(" "),n("label",{attrs:{for:"dpi"}},[r._v("dpi")]),r._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:r.state.dpi,expression:"state.dpi"}],staticClass:"form-control",attrs:{id:"dpi"},on:{change:[function(e){var t=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});r.$set(r.state,"dpi",e.target.multiple?t:t[0])},r.onChangeDpi]}},r._l(r.state.dpis,function(e){return n("option",[r._v(r._s(e))])}),0),r._v(" "),n("label",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.rotation",expression:"'sdk.print.rotation'"}],attrs:{for:"rotation"}}),r._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:r.state.rotation,expression:"state.rotation"}],staticClass:"form-control",attrs:{min:"-360",max:"360",id:"rotation",type:"number"},domProps:{value:r.state.rotation},on:{input:[function(e){e.target.composing||r.$set(r.state,"rotation",e.target.value)},r.onChangeRotation]}}),r._v(" "),n("label",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.format",expression:"'sdk.print.format'"}],attrs:{for:"format"}}),r._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:r.state.output.format,expression:"state.output.format"}],staticClass:"form-control",attrs:{id:"format"},on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});r.$set(r.state.output,"format",e.target.multiple?t:t[0])}}},r._l(r.state.formats,function(e){return n("option",{domProps:{value:e.value}},[r._v(r._s(e.label))])}),0)],r._v(" "),r.state.labels&&r.state.labels.length?[n("div",{staticClass:"print-labels-content",staticStyle:{"margin-top":"5px"}},[n("label",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.labels",expression:"'sdk.print.labels'"}],staticClass:"skin-color",staticStyle:{"font-weight":"bold","font-size":"1.1em",display:"block","border-bottom":"2px solid #ffffff","margin-bottom":"5px"}}),r._v(" "),n("div",{staticClass:"labels-input-content",staticStyle:{"max-height":"120px","overflow-y":"auto"}},r._l(r.state.labels,function(t){return n("span",{key:t.id},[n("label",{attrs:{for:"g3w_label_id_input_"+t.id}},[r._v(r._s(t.id))]),r._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"label.text"}],staticClass:"form-control",attrs:{id:"g3w_label_id_input_"+t.id},domProps:{value:t.text},on:{input:function(e){e.target.composing||r.$set(t,"text",e.target.value)}}})])}),0)])]:r._e()],2),r._v(" "),n("div",{staticClass:"box-footer",staticStyle:{"background-color":"transparent"}},[n("span",[n("button",{directives:[{name:"disabled",rawName:"v-disabled",value:r.button.disabled,expression:"button.disabled"},{name:"download",rawName:"v-download"},{name:"t",rawName:"v-t",value:"create_print",expression:"'create_print'"}],staticClass:"sidebar-button-run btn",staticStyle:{width:"100%","font-weight":"bold"},attrs:{id:"printbutton"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),r.print(e)}}})])])])])])},r.staticRenderFns=[]},{"components/PrintFidAtlasValues.vue":272,"components/PrintSelectAtlasFieldValues.vue":274}],272:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default={name:"fid-atlas-values",props:{atlas:{type:Object},reset:{type:Boolean,default:!1}},data:function(){return{value:""}},methods:{validateValue:function(e){return e=e&&+e,Number.isInteger(e)&&0<=e&&e<this.atlas.feature_count||null}},watch:{value:{immediate:!0,handler:function(e){var r=this,o=(this.value=e,new Set);e&&e.split(",").forEach(function(e){var n,t;e&&(-1!==e.indexOf("-")?(t=e.split("-"),(n=t.filter(function(e){return null!==r.validateValue(e)})).length===t.length&&n.reduce(function(e,t,r){return e&&(0===r||n[r-1]<=t)},!0)&&function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=e.length,r=1;r<t;r++)for(var n=e[r-1],i=e[r],a=n;a<i;a++)o.add(a+"");o.add(e[t-1])}(n)):(t=e,null!==r.validateValue(t)&&o.add(t)))}),this.$emit("set-values",Array.from(o)),this.$emit("disable-print-button",""===e.trim())}},reset:function(e){e&&(this.value="",this.$emit("set-values",[]),this.$emit("disable-print-button",!0))}},beforeDestroy:function(){this.value=null,this.$emit("disable-print-button",!1)}},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",{staticClass:"form-group",staticStyle:{width:"100%"}},[e("label",{staticStyle:{display:"block"},attrs:{for:t.print_atlas_fid}},[e("span",[t._v("fids [max: "+t._s(t.atlas.feature_count-1)+"]")])]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],staticClass:"form-control",domProps:{value:t.value},on:{keydown:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"space",32,e.key,[" ","Spacebar"]))return null;e.preventDefault()},input:function(e){e.target.composing||(t.value=e.target.value)}}}),t._v(" "),e("div",{staticStyle:{"margin-top":"5px",color:"#ffffff"},attrs:{id:"fid-print-atals-instruction"}},[e("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.fids_instruction",expression:"'sdk.print.fids_instruction'"}],staticStyle:{"white-space":"pre-line"},attrs:{id:"fids_intruction"}}),t._v(" "),e("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.fids_example",expression:"'sdk.print.fids_example'"}],staticStyle:{"margin-top":"3px","font-weight":"bold"},attrs:{id:"fids_examples_values"}})])])},r.staticRenderFns=[],r._scopeId="data-v-7c31f398"},{}],273:[function(e,t,r){function n(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),i=e("app/constant"),u=e("services/gui"),a=(u=u)&&u.__esModule?u:{default:u},l=e("core/utils/utils").imageToDataURL,r.default={name:"print-page",data:function(){return{state:null,disableddownloadbutton:!0,downloadImageName:"",format:null}},computed:{loading:function(){return this.state.loading&&this.state.layers}},methods:{setLoading:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];a.default.disableSideBar(e),this.state.loading=e,this.disableddownloadbutton=e},downloadImage:function(){var t=this;this.setLoading(!0),"jpg"!==this.format&&"png"!==this.format||(this.downloadImageName="download."+this.state.format,l({src:this.state.url,type:"image/"+this.state.format,callback:function(e){return setTimeout(function(){return t.setLoading(!1)})}}))}},watch:{"state.url":(s=n(regeneratorRuntime.mark(function e(t){var r,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t)return this.format=this.state.format,e.next=4,this.$nextTick();e.next=6;break;case 4:r=setTimeout(function(){n.setLoading(!1),a.default.showUserMessage({type:"alert",message:"timeout"})},i.TIMEOUT),$(this.$refs.printoutput).load(t,function(e,t){n.$options.service.stopLoading(),"error"===t&&n.$options.service.showError(),clearTimeout(r),n.setLoading(!1)});case 6:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)})},mounted:(o=n(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.state.layers&&this.$options.service.startLoading();case 3:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)}),beforeDestroy:function(){this.state.url&&"POST"===this.state.method&&window.URL.revokeObjectURL(this.state.url)}},t.exports.__esModule&&(t.exports=t.exports.default);var i,a,o,s,l,u="function"==typeof t.exports?t.exports.options:t.exports;u.render=function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("div",{staticStyle:{height:"100%",position:"relative"},attrs:{id:"print-output"}},[t("transition",{attrs:{duration:500,name:"fade"}},[t("bar-loader",{attrs:{loading:e.loading}})],1),e._v(" "),"pdf"===e.format?t("iframe",{ref:"printoutput",staticStyle:{border:"0",width:"100%",height:"100%"},attrs:{type:e.state.mime_type,src:e.state.url}}):"png"===e.format?t("div",{staticClass:"g3w-print-png-output",staticStyle:{display:"flex","flex-direction":"column",position:"relative",height:"100%"}},[t("div",{staticStyle:{display:"flex","justify-content":"flex-end","align-items":"flex-end","margin-top":"5px","margin-bottom":"5px"},attrs:{id:"g3w-print-header"}},[t("div",{class:{"g3w-disabled":e.disableddownloadbutton}},[t("a",{attrs:{href:e.state.url,download:e.downloadImageName}},[t("button",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"sdk.print.download_image",expression:"'sdk.print.download_image'",modifiers:{create:!0}}],staticClass:"btn skin-button skin-tooltip-left",class:e.g3wtemplate.getFontClass("download"),staticStyle:{"font-weight":"bold"},attrs:{"data-placement":"left","data-toggle":"tooltip",role:"button"},on:{click:e.downloadImage}})])])]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:"png"===e.format&&e.state.url,expression:"format==='png' && state.url"}],staticStyle:{height:"100%",width:"100%",position:"relative","overflow-y":"auto"}},[t("img",{ref:"printoutput",staticStyle:{height:"auto","max-width":"100%"},attrs:{src:e.state.url}})])]):e._e(),e._v(" "),e.state.layers?e._e():t("h4",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.no_layers",expression:"'sdk.print.no_layers'"}],staticStyle:{"font-weight":"bold"}})],1)},u.staticRenderFns=[]},{"app/constant":4,"core/utils/utils":68,"services/gui":361}],274:[function(e,t,r){function i(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=e("mixins"),u=e("gui/external/select2/options/autocomplete"),r.default={name:"selectAtlasFieldValues",mixins:[a.autocompleteMixin,a.select2Mixin],props:{atlas:{type:Object,required:!0},reset:{type:Boolean,default:!1}},methods:{emitValues:(s=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.$emit("set-values",this.values);case 3:case"end":return e.stop()}},e,this)})),function(){return s.apply(this,arguments)})},data:function(){return{values:[]}},watch:{values:{immediate:!0,handler:function(e){this.$emit("disable-print-button",0===e.length)}},reset:function(e){e&&(this.select2&&this.select2.val(null).trigger("change"),this.values=[],this.emitValues())}},mounted:(o=i(regeneratorRuntime.mark(function e(){var t,o,s,l=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:t=this.atlas,o=t.field_name,s=t.qgs_layer_id,this.select2=$("#print_atlas_autocomplete").select2(n({width:"100%",multiple:!0,dropdownParent:$(this.$el),minimumInputLength:1,ajax:{delay:500,transport:function(){var n=i(regeneratorRuntime.mark(function e(t,r,n){var i,a=t.data.q;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.autocompleteRequest({layerId:s,field:o,value:a});case 3:i=e.sent,r({results:i}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),n(e.t0);case 10:case"end":return e.stop()}},e,l,[[0,7]])}));return function(e,t,r){return n.apply(this,arguments)}}()}},u)),this.select2.on("select2:select",function(e){e=e.params.data.id;l.values.push(e),l.emitValues()}),this.select2.on("select2:unselect",function(){var t=i(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=t.params.data.id,l.values=l.values.filter(function(e){return e!=r}),l.emitValues();case 3:case"end":return e.stop()}},e,l)}));return function(e){return t.apply(this,arguments)}}());case 6:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)}),beforeDestroy:function(){this.values=null,this.$emit("disable-print-button",!1)}},t.exports.__esModule&&(t.exports=t.exports.default);var n,a,o,s,u,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this.$createElement,e=this._self._c||e;return e("div",{staticClass:"form-group",staticStyle:{width:"100%"}},[e("label",{staticStyle:{display:"block"},attrs:{for:this.print_atlas_autocomplete}},[e("span",[this._v(this._s(this.atlas.field_name))])]),this._v(" "),e("select",{staticClass:"form-control",attrs:{name:this.atlas.field_name,id:"print_atlas_autocomplete"}})])},e.staticRenderFns=[],e._scopeId="data-v-f0e3ed96"},{"gui/external/select2/options/autocomplete":119,mixins:343}],275:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),i=n(e("store/projects")),a=n(e("services/gui")),o=e("core/i18n/i18n.service").t,s="/static/client/images/FakeProjectThumb.png",r.default={name:"projects-menu",data:function(){return{state:null,loading:!1}},methods:{trigger:function(e){e.cbk?this._initCallback(e):e.href?window.open(e.href,"_blank"):e.route&&a.default.goto(e.route)},_initCallback:function(e){var t=this;this._toggleModal(!0),e.cbk.call(e,{gid:e.gid}).then(function(e){e.then(function(e){e&&(document.title=e.state.html_page_title)}).fail(function(){a.default.notify.error("<h4>"+o("error_map_loading")+"</h4><h5>"+o("check_internet_connection_or_server_admin")+"</h5>")}).always(function(){t._toggleModal(!1)})})},_toggleModal:function(e){a.default.showFullModal({show:e}),a.default.setLoadingContent(e)},logoSrc:function(e){var t=this.$options.host||"",r=e&&-1!==e.indexOf(i.default.config.mediaurl),n=e&&-1===e.indexOf("static")&&-1===e.indexOf("media");return""+t+(e?r?e:n?""+i.default.config.mediaurl+e:s:s)}}},t.exports.__esModule&&(t.exports=t.exports.default);var i,a,o,s,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("div",{staticClass:"container",attrs:{id:"menu-projects"}},[n("div",{staticClass:"row row-equal"},[r._l(r.state.menuitems,function(t){return n("div",{key:t.title,staticClass:"col-xs-12 col-sm-4 project-menu",on:{click:function(e){return r.trigger(t)}}},[n("div",{staticClass:"project-menu-item-image"},[n("img",{staticClass:"img-responsive",attrs:{src:r.logoSrc(t.thumbnail)}})]),r._v(" "),n("div",{staticClass:"project-menu-item-content"},[n("div",{staticClass:"project-menu-item-text"},[n("h4",{staticClass:"project-menu-item-title"},[r._v(r._s(t.title))]),r._v(" "),n("div",{domProps:{innerHTML:r._s(t.description)}})])])])}),r._v(" "),r.state.menuitems.length?r._e():n("div",{staticStyle:{"margin-left":"15px"}},[n("h2",{directives:[{name:"t",rawName:"v-t",value:"no_other_projects",expression:"'no_other_projects'"}]})])],2)])},e.staticRenderFns=[]},{"core/i18n/i18n.service":13,"services/gui":361,"store/projects":379}],276:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function a(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),o=n(e("services/querybuilder")),s=e("app/constant"),l=n(e("store/projects")),f=Object.values(s.FILTER_OPERATORS),r.default={name:"query-builder",data:function(){var e=this.$options.options,t=void 0!==e;return{edit:t,currentlayer:null,message:"",filter:t?e.filter:"",loading:{test:!1,values:!1},values:[],manual:!0,manualvalue:null,select:{field:null,value:null}}},computed:{fields:function(){return this.currentlayer?this.currentlayer.fields:[]},disabled:function(){return!this.filter}},watch:{"select.field":function(){this.values=[],this.manual=!0}},methods:{addToExpression:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.value;switch(e.type){case"operator":t=" "+t+" ";break;case"field":t='"'+t+'"';break;case"value":t="'"+t+"'"}t&&(this.filter=""+this.filter+t)},all:(p=a(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading.values=!0,e.prev=1,e.next=4,o.default.getValues({layerId:this.currentlayer.id,field:this.select.field});case 4:this.values=e.sent,e.next=9;break;case 7:e.prev=7,e.t0=e.catch(1);case 9:return this.loading.values=!1,e.next=12,this.$nextTick();case 12:this.manualvalue=null,this.manual=!1;case 14:case"end":return e.stop()}},e,this,[[1,7]])})),function(){return p.apply(this,arguments)}),reset:function(){this.filter="",this.message="",this.filterElement.previous=null,this.filterElement.current=null,this.filterElement.operator=null},test:(d=a(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.currentlayer.id,this.loading.test=!0,r=void 0,e.prev=3,e.next=6,o.default.test({layerId:t,filter:this.filter});case 6:r=e.sent,this.message=void 0!==r?" "+r:"",e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),this.message=e.t0;case 13:return this.loading.test=!1,e.next=16,this.$nextTick();case 16:case"end":return e.stop()}},e,this,[[3,10]])})),function(){return d.apply(this,arguments)}),run:(c=a(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.currentlayer.id,this.loading.test=!0,e.prev=2,e.next=5,o.default.run({layerId:t,filter:this.filter});case 5:e.sent,e.next=10;break;case 8:e.prev=8,e.t0=e.catch(2);case 10:this.loading.test=!1;case 11:case"end":return e.stop()}},e,this,[[2,8]])})),function(){return c.apply(this,arguments)}),save:function(){o.default.save({layerId:this.currentlayer.id,filter:this.filter,projectId:this.projectId,name:this.edit&&this.$options.options.name,id:this.edit&&this.$options.options.id})}},created:function(){var t=this,n=(this.filterElement={current:null,previous:null,operator:null},l.default.getCurrentProject());this.layers=n.getLayers().filter(function(e){return!e.baselayer&&e.geometrytype&&"NoGeometry"!==e.geometrytype&&Array.isArray(e.fields)}).map(function(e){var t=n.getRelationsByLayerId({layerId:e.id,type:"ONE"}),r=[];return t.forEach(function(e){var t=e.customPrefix,e=n.getLayerById(e.referencingLayer),t=void 0===t?e.getName()+"_":t,e=e.getFields().map(function(e){return""+t+e.name});r=[].concat(i(r),i(e))}),{id:e.id,label:e.name,fields:e.fields.filter(function(e){return e.show}).map(function(e){return{label:e.label,name:e.name}}).filter(function(e){return-1===r.indexOf(e)})}}),this.operators=f,this.currentlayer=this.edit?this.layers.find(function(e){return e.id===t.$options.options.layerId}):this.layers[0]},mounted:(u=a(regeneratorRuntime.mark(function e(){var t,r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.select2=$("#query_builder_layers_select").select2({width:"100%"}),this.edit&&(t=this.layers.indexOf(this.currentlayer),this.select2.val(t),this.select2.trigger("change")),this.select2.on("select2:select",function(e){r.currentlayer=r.layers[e.params.data.id],r.select.field=null,r.select.value=null,r.reset()});case 5:case"end":return e.stop()}},e,this)})),function(){return u.apply(this,arguments)}),beforeDestroy:function(){this.select2.select2("destroy"),this.select2=null}},t.exports.__esModule&&(t.exports=t.exports.default);var o,s,l,u,c,d,p,f,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("div",{staticClass:"form-group",staticStyle:{"flex-wrap":"nowrap !important"},attrs:{id:"query_builder"}},[n("div",{attrs:{id:"query_builder_header"}}),r._v(" "),n("div",{staticClass:"margin-between-element",attrs:{id:"query_builder_layers"}},[n("label",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.layers",expression:"'sdk.querybuilder.panel.layers'"}],staticClass:"querybuilder-title"}),r._v(" "),n("select",{staticClass:"form-control",attrs:{id:"query_builder_layers_select"}},r._l(r.layers,function(e,t){return n("option",{key:e.label,staticClass:"bold",domProps:{value:t}},[r._v(r._s(e.label))])}),0)]),r._v(" "),n("div",{staticClass:"margin-between-element",attrs:{id:"query_builder_fields"}},[n("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.fields",expression:"'sdk.querybuilder.panel.fields'"}],staticClass:"querybuilder-title",attrs:{id:"query_builder_fields_title"}}),r._v(" "),n("div",{staticClass:"querybuilder-content",attrs:{id:"query_builder_fields_content"}},[n("table",{staticClass:"table table-striped content-table"},[n("tbody",r._l(r.fields,function(e){var t=e.name,e=e.label;return n("tr",{key:t,class:{"skin-background-color lighten":r.select.field===t},staticStyle:{cursor:"pointer"},on:{click:function(e){r.select.field=t},dblclick:function(e){return r.addToExpression({value:t,type:"field"})}}},[n("th",{attrs:{scope:"row"}},[r._v(r._s(e))])])}),0)])])]),r._v(" "),n("div",{staticClass:"margin-between-element",attrs:{id:"query_builder_values"}},[n("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.values",expression:"'sdk.querybuilder.panel.values'"}],staticClass:"querybuilder-title",attrs:{id:"query_builder_values_title"}}),r._v(" "),r.manual?n("div",{staticClass:"margin-between-element",staticStyle:{display:"flex","justify-content":"space-between","align-items":"stretch"},attrs:{id:"querybuilder-manual"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:r.manualvalue,expression:"manualvalue"}],staticClass:"form-control",staticStyle:{border:"0"},attrs:{style:"border: 0;"},domProps:{value:r.manualvalue},on:{input:function(e){e.target.composing||(r.manualvalue=e.target.value)}}}),r._v(" "),n("span",{class:r.g3wtemplate.getFontClass("plus"),staticStyle:{cursor:"pointer","font-size":"1.2em","background-color":"white",color:"#000000",padding:"9px"},on:{click:function(e){r.manualvalue&&r.addToExpression({value:r.manualvalue,type:"value"})}}})]):n("div",{staticClass:"querybuilder-content margin-between-element",attrs:{id:"query_builder_values_content"}},[n("bar-loader",{attrs:{loading:r.loading.values}}),r._v(" "),n("table",{staticClass:"table table-striped content-table"},[n("tbody",[r._l(r.values,function(t){return n("tr",{key:t,class:{"skin-background-color lighten":r.select.value===t},staticStyle:{cursor:"pointer"},on:{click:function(e){r.select.value=t},dblclick:function(e){return r.addToExpression({value:t,type:"value"})}}},[n("th",{attrs:{scope:"row"}},[r._v(r._s(t))])])}),r._v(" "),r._m(0)],2)])],1),r._v(" "),n("div",{staticClass:"content-end skin-color",attrs:{id:"query_builder_values_buttons"}},[n("button",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.button.manual",expression:"'sdk.querybuilder.panel.button.manual'"}],staticClass:"query_builder_button btn btn-secondary bold ",class:{"skin-border-color":r.manual},attrs:{id:"query_builder_values_buttons_sample"},on:{click:function(e){r.manual=!0}}}),r._v(" "),n("button",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.button.all",expression:"'sdk.querybuilder.panel.button.all'"}],staticClass:"query_builder_button btn btn-secondary bold ",class:{"skin-border-color":!r.manual},attrs:{id:"query_builder_values_buttons_all",disabled:null===r.select.field},on:{click:r.all}})])]),r._v(" "),n("div",{staticClass:"margin-between-element",staticStyle:{"margin-top":"auto !important"},attrs:{id:"query_builder_operators"}},[n("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.operators",expression:"'sdk.querybuilder.panel.operators'"}],staticClass:"querybuilder-title",attrs:{id:"query_builder_operators_title"}}),r._v(" "),n("div",{staticClass:"content-wrap",attrs:{id:"query_builder_operators_content"}},r._l(r.operators,function(t){return n("button",{key:t,staticClass:"query_builder_button btn btn-secondary skin-color bold",on:{click:function(e){return r.addToExpression({value:t,type:"operator"})}}},[r._v(r._s(t))])}),0)]),r._v(" "),n("div",{attrs:{id:"query_builder_footer"}},[n("div",{attrs:{id:"query_builder_expression"}},[n("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.expression",expression:"'sdk.querybuilder.panel.expression'"}],staticClass:"querybuilder-title",attrs:{id:"query_builder_expression_title"}}),r._v(" "),n("div",{attrs:{id:"query_builder_expression_content"}},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:r.filter,expression:"filter"}],staticStyle:{width:"100%",resize:"none",height:"100px",color:"#000000"},domProps:{value:r.filter},on:{input:function(e){e.target.composing||(r.filter=e.target.value)}}})])]),r._v(" "),n("div",{staticClass:"margin-between-element",attrs:{id:"query_builder_message"}},[n("bar-loader",{attrs:{loading:r.loading.test}}),r._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:r.message,expression:"message"},{name:"t",rawName:"v-t",value:"sdk.querybuilder.messages.number_of_features",expression:"'sdk.querybuilder.messages.number_of_features'"}],staticClass:"bold skin-color"}),n("span",{staticClass:"bold skin-color"},[r._v(r._s(r.message))])],1),r._v(" "),n("div",{staticClass:"content-end margin-between-element",attrs:{id:"query_builder_footer_buttons"}},[n("button",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.button.test",expression:"'sdk.querybuilder.panel.button.test'"}],staticClass:"query_builder_button btn btn-secondary  bold",attrs:{disabled:r.disabled},on:{click:r.test}}),r._v(" "),n("button",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.button.clear",expression:"'sdk.querybuilder.panel.button.clear'"}],staticClass:"query_builder_button btn btn-secondary  bold",on:{click:r.reset}}),r._v(" "),n("button",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.button.run",expression:"'sdk.querybuilder.panel.button.run'"}],staticClass:"query_builder_button btn btn-secondary  bold",attrs:{disabled:r.disabled},on:{click:r.run}}),r._v(" "),n("button",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.button.save",expression:"'sdk.querybuilder.panel.button.save'"}],staticClass:"query_builder_button btn btn-secondary  bold",attrs:{disabled:r.disabled},on:{click:r.save}})])])])},e.staticRenderFns=[function(){var e=this.$createElement,e=this._self._c||e;return e("tr",[e("th",{attrs:{scope:"row"}})])}]},{"app/constant":4,"services/querybuilder":366,"store/projects":379}],277:[function(e,t,r){function n(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),s=e("services/querybuilder"),i=(s=s)&&s.__esModule?s:{default:s},o=e("gui/querybuilder/querybuilderuifactory"),r.default={name:"g3w-querybuilder-search",props:{querybuildersearch:{required:!0}},data:function(){return{loading:!1,showinfo:!1}},methods:{remove:(a=n(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.default.delete(this.querybuildersearch);case 3:this.$emit("delete"),e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}},e,this,[[0,6]])})),function(){return a.apply(this,arguments)}),edit:function(){o.show({options:{id:this.querybuildersearch.id,name:this.querybuildersearch.name,layerId:this.querybuildersearch.layerId,filter:this.querybuildersearch.filter}})},run:function(){var e=this;this.loading=!0,i.default.run({layerId:this.querybuildersearch.layerId,filter:this.querybuildersearch.filter}).finally(function(){e.loading=!1})}}},t.exports.__esModule&&(t.exports=t.exports.default);var i,a,o,s="function"==typeof t.exports?t.exports.options:t.exports;s.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("li",[e("div",{staticStyle:{position:"relative"}},[e("bar-loader",{attrs:{loading:t.loading}}),t._v(" "),e("div",{staticClass:"querybuliserch-tools",staticStyle:{display:"flex","align-items":"baseline"}},[e("i",{class:t.g3wtemplate.getFontClass("filter"),staticStyle:{"margin-right":"14px","margin-left":"1px"}}),t._v(" "),e("span",{staticStyle:{"white-space":"pre-wrap"}},[t._v(t._s(t.querybuildersearch.name))]),t._v(" "),e("div",{staticStyle:{"margin-left":"auto"}},[e("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.querybuilder.search.run",expression:"'sdk.querybuilder.search.run'"}],staticClass:"icon-search-action skin-tooltip-bottom",attrs:{"data-placement":"bottom","data-toggle":"tooltip"}},[e("i",{class:t.g3wtemplate.getFontClass("run"),staticStyle:{color:"green",padding:"3px","font-size":"1.3em"},on:{click:function(e){return e.stopPropagation(),t.run(e)}}})]),t._v(" "),e("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.querybuilder.search.info",expression:"'sdk.querybuilder.search.info'"}],staticClass:"icon-search-action skin-tooltip-bottom",attrs:{"data-placement":"bottom","data-toggle":"tooltip"}},[e("i",{class:t.g3wtemplate.getFontClass("info"),staticStyle:{color:"#FFFFFF",padding:"3px","font-size":"1.3em"},on:{click:function(e){e.stopPropagation(),t.showinfo=!t.showinfo}}})]),t._v(" "),e("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.querybuilder.search.edit",expression:"'sdk.querybuilder.search.edit'"}],staticClass:"icon-search-action skin-tooltip-bottom",attrs:{"data-placement":"bottom","data-toggle":"tooltip"}},[e("i",{class:t.g3wtemplate.getFontClass("pencil"),staticStyle:{color:"#307095",padding:"3px","font-size":"1.3em"},on:{click:function(e){return e.stopPropagation(),t.edit(e)}}})]),t._v(" "),e("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.querybuilder.search.delete",expression:"'sdk.querybuilder.search.delete'"}],staticClass:"icon-search-action skin-tooltip-bottom",attrs:{"data-placement":"bottom","data-toggle":"tooltip"}},[e("i",{class:t.g3wtemplate.getFontClass("trash"),staticStyle:{color:"red",padding:"3px","font-size":"1.3em"},on:{click:function(e){return e.stopPropagation(),t.remove(e)}}})])])]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showinfo,expression:"showinfo"}],staticClass:"querybuildsearch-info",staticStyle:{"margin-top":"5px"}},[e("div",[e("span",{staticStyle:{"font-weight":"bold","white-space":"pre"}},[t._v("LAYER: ")]),t._v(" "),e("span",{staticStyle:{"white-space":"pre-wrap"}},[t._v(t._s(t.querybuildersearch.layerName))])]),t._v(" "),e("div",[e("span",{staticStyle:{"font-weight":"bold"}},[t._v("EXPRESSION: ")]),t._v(" "),e("span",{staticStyle:{"white-space":"pre-wrap"}},[t._v(t._s(t.querybuildersearch.filter))])])])],1)])},s.staticRenderFns=[],s._scopeId="data-v-4f0104b0"},{"gui/querybuilder/querybuilderuifactory":168,"services/querybuilder":366}],278:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=e("mixins"),o=n(e("components/QueryResultsTableAttributeFieldValue.vue")),s=n(e("components/QueryResultsActionInfoFormats.vue")),l=n(e("components/QueryResultsHeaderFeatureBody.vue")),f=e("core/utils/utils").throttle,h=["varchar","integer","float","date"],r.default={name:"queryresults",data:function(){return{state:this.$options.queryResultsService.state,headerExpandActionCellWidth:10,headerActionsCellWidth:10}},mixins:[a.fieldsMixin],components:{TableAttributeFieldValue:o.default,infoformats:s.default,"header-feature-body":l.default},computed:{onelayerresult:function(){return 1===this.state.layers.length},hasLayers:function(){return this.hasResults||!!this.state.components.length},hasResults:function(){return 0<this.state.layers.length},info:function(){if(this.state.query){var e=this.state.query;switch(e.type){case"coordinates":return{icon:"marker",message:"  "+e.coordinates[0]+", "+e.coordinates[1]};case"bbox":return{icon:"square",message:"  ["+e.bbox.join(" , ")+"]"};case"polygon":return{icon:"draw",message:e.layerName?e.layerName+" "+(void 0!==e.fid?" - Feature Id: "+e.fid:""):" "}}}else this.state.search;return{icon:null,message:null}}},methods:{getLayerCustomComponents:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"feature";return this.state.layerscustomcomponents[e]&&this.state.layerscustomcomponents[e][t]&&this.state.layerscustomcomponents[e][t][2<arguments.length&&void 0!==arguments[2]?arguments[2]:"after"]||[]},getLayerField:function(e){var t=e.layer,r=e.feature,n=e.fieldName,e=t.attributes.find(function(e){return e.name===n});return c({},e,{label:null,value:r.attributes[n]})},getQueryFields:function(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e.formStructure.fields[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=o.value,u=c({},l);u.query=!0,u.value=t.attributes[l.name],u.input={type:""+this.getFieldType(u)},r.push(u)}}catch(e){i=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw a}}return r},getColSpan:function(e){return this.attributesSubsetLength(e)+(this.state.layersactions[e.id].length?1:0)+ +!this.hasLayerOneFeature(e)},getDownloadActions:function(e){return this.state.layersactions[e.id].find(function(e){return e.formats})},addLayerFeaturesToResults:function(e){this.$options.queryResultsService.addLayerFeaturesToResultsAction(e)},showDownloadAction:function(e){var t=e.target.children[0].style.display;e.target.children[0].style.display="none"===t?"inline-block":"none"},printAtlas:function(e){this.$options.queryResultsService.printAtlas(e)},showLayerDownloadFormats:function(e){this.$options.queryResultsService.showLayerDownloadFormats(e)},saveLayerResult:function(e){this.$options.queryResultsService.saveLayerResult({layer:e,type:1<arguments.length&&void 0!==arguments[1]?arguments[1]:"csv"})},hasLayerOneFeature:function(e){return 1===e.features.length},addRemoveFilter:function(e){this.$options.queryResultsService.addRemoveFilter(e)},getContainerFromFeatureLayer:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,e=e.index;return $("#"+t.id+"_"+e+" > td")},hasOneLayerAndOneFeature:function(e){return this.hasLayerOneFeature(e)},hasFormStructure:function(e){return!!e.formStructure},layerHasFeatures:function(e){return!!(e.features&&0<e.features.length)},selectionFeaturesLayer:function(e){this.$options.queryResultsService.selectionFeaturesLayer(e)},layerHasActions:function(e){return 0<this.state.layersactions[e.id].length},featureHasActions:function(e,t){return this.geometryAvailable(t)},geometryAvailable:function(e){return!!e.geometry},extractAttributesFromFirstTabOfFormStructureLayers:function(n){var i=this,a=new Set;return n.formStructure.structure.length&&n.formStructure.structure.forEach(function e(t){var r;t.nodes?t.nodes.forEach(e):(r=n.formStructure.fields.find(function(e){return e.name===t.field_name}))&&("ows"===i.state.type&&((r=c({},r)).name=r.name.replace(/ /g,"_")),a.add(r))}),Array.from(a)},attributesSubset:function(e){var e=this.hasFormStructure(e)?this.extractAttributesFromFirstTabOfFormStructureLayers(e):e.attributes,t=e.filter(function(e){return e.show&&-1!==h.indexOf(e.type)}),e=Math.min(3,e.length);return t.slice(0,e)},relationsAttributesSubset:function(e){var r=[],e=(_.forEach(e,function(e,t){Array.isArray(e)||r.push({label:t,value:e})}),Math.min(3,r.length));return r.slice(0,e)},relationsAttributes:function(e){var r=[];return _.forEach(e,function(e,t){r.push({label:t,value:e})}),r},attributesSubsetLength:function(e){return this.attributesSubset(e).length},cellWidth:function(e,t){var r=3+this.state.layersactions[t.id].length,n=this.attributesSubsetLength(t),r=r-n,t=(90-(t.hasgeometry?10:0))/3;return e===n-1&&0<r?t*(1+r):t},featureBoxColspan:function(e){var t=this.attributesSubsetLength(e);return e.expandable&&(t+=1),e.hasgeometry&&(t+=1),t},relationsAttributesSubsetLength:function(e){return this.relationsAttributesSubset(e).length},getLayerFormStructure:function(e){return e.formStructure.structure},isAttributeOrTab:function(e,t){var r=void 0!==t.field_name;return{type:r?"field":"tab",item:r&&this.getLayerAttributeFromStructureItem(e,t.field_name)||[t]}},getLayerAttributeFromStructureItem:function(e,t){return e.attributes.find(function(e){return e.name===t})},getLayerFeatureBox:function(r,n,e){var i=this,t=this.getBoxId(r,n,e);return void 0===this.state.layersFeaturesBoxes[t]&&(this.state.layersFeaturesBoxes[t]=Vue.observable({collapsed:!0}),this.$watch(function(){return i.state.layersFeaturesBoxes[t].collapsed},function(e){var t=r.features.findIndex(function(e){return n.id===e.id}),t=i.getContainerFromFeatureLayer({layer:r,index:t});i.$options.queryResultsService.openCloseFeatureResult({open:!e,layer:r,feature:n,container:t})}),this.state.layersFeaturesBoxes[t].collapsed=1<r.features.length),this.state.layersFeaturesBoxes[t]},collapsedFeatureBox:function(e,t,r){e=this.getBoxId(e,t,r);return!this.state.layersFeaturesBoxes[e]||this.state.layersFeaturesBoxes[e].collapsed},showFeatureInfo:function(e,t){this.$options.queryResultsService.emit("show-query-feature-info",{layer:e,tabs:this.hasFormStructure(e),show:!!this.state.layersFeaturesBoxes[t]&&!this.state.layersFeaturesBoxes[t].collapsed})},getBoxId:function(e,t,r){return this.$options.queryResultsService.getBoxId(e,t,r)},toggleFeatureBox:(p=i(regeneratorRuntime.mark(function e(t,r,n){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.getBoxId(t,r,n),this.state.layersFeaturesBoxes[i].collapsed=!this.state.layersFeaturesBoxes[i].collapsed,e.next=4,this.$nextTick();case 4:this.showFeatureInfo(t,i);case 5:case"end":return e.stop()}},e,this)})),function(e,t,r){return p.apply(this,arguments)}),toggleFeatureBoxAndZoom:function(e,t,r){this.hasLayerOneFeature(e)||this.toggleFeatureBox(e,t,r)},trigger:(d=i(regeneratorRuntime.mark(function e(t,r,n,i){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.opened&&"none"===$("#"+r.id+"_"+i).css("display"))return this.toggleFeatureBox(r,n),e.next=4,this.$nextTick();e.next=4;break;case 4:return a=this.getContainerFromFeatureLayer({layer:r,index:i}),e.next=7,this.$options.queryResultsService.trigger(t.id,r,n,i,a);case 7:case"end":return e.stop()}},e,this)})),function(e,t,r,n){return d.apply(this,arguments)}),showFullPhoto:function(e){this.$options.queryResultsService.showFullPhoto(e)},openLink:function(e){window.open(e,"_blank")}},watch:{"state.layers":(u=i(regeneratorRuntime.mark(function e(t){var r,n,i,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.forEach(function(n){n.attributes.length<=3&&!n.hasImageField&&(n.expandable=!1),n.features.forEach(function(t){a.getLayerFeatureBox(n,t),t.attributes.relations&&t.attributes.relations.forEach(function(e){var r=n.id+"_"+t.id+"_"+e.name;e.elements.forEach(function(e,t){a.state.layersFeaturesBoxes[r+t]={collapsed:!0}})})})}),this.onelayerresult&&this.hasLayerOneFeature(t[0])&&(r=t[0],n=r.features[0],i=this.getBoxId(r,n),this.$options.queryResultsService.onceafter("postRender",function(){a.showFeatureInfo(r,i)})),requestAnimationFrame(function(){return a.$options.queryResultsService.postRender(a.$el)}),e.next=5,this.$nextTick();case 5:case"end":return e.stop()}},e,this)})),function(e){return u.apply(this,arguments)}),onelayerresult:function(e){e&&this.$options.queryResultsService.highlightFeaturesPermanently(this.state.layers[0])}},created:function(){var t=this;this.zoomToLayerFeaturesExtent=f(function(e){t.$options.queryResultsService.zoomToLayerFeaturesExtent(e,{highlight:!0})})},beforeDestroy:function(){this.state.zoomToResult=!0},destroyed:function(){this.$options.queryResultsService.clear()}},t.exports.__esModule&&(t.exports=t.exports.default);var c,a,o,s,l,u,d,p,f,h,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var n=this,e=n.$createElement,i=n._self._c||e;return i("div",{staticClass:"queryresults-wrapper",attrs:{id:"search-results"}},[n.info.message?i("div",{staticClass:"skin-color",staticStyle:{"font-weight":"bold","margin-bottom":"3px","font-size":"1.1em"}},[n.info.icon?i("span",{staticClass:"action-button skin-tooltip-bottom",class:n.g3wtemplate.getFontClass(n.info.icon)}):n._e(),n._v(" "),i("span",[n._v(n._s(n.info.message))])]):n._e(),n._v(" "),i("div",{staticClass:"queryresults-container"},[n.state.layers.length?[n.hasLayers?i("ul",{staticClass:"queryresults",staticStyle:{position:"relative"},attrs:{id:"queryresults"}},[n._l(n.state.layers,function(r){return i("li",{directives:[{name:"show",rawName:"v-show",value:(n.layerHasFeatures(r)||r.rawdata)&&r.show,expression:"(layerHasFeatures(layer) || layer.rawdata) && layer.show"}]},[i("bar-loader",{attrs:{loading:r.loading}}),n._v(" "),i("div",{staticClass:"box box-primary"},[i("div",{staticClass:"box-header with-border",class:{mobile:n.isMobile()},attrs:{"data-widget":"collapse"}},[i("div",{staticClass:"box-title query-layer-title",style:{fontSize:n.isMobile()&&"1em !important"}},[n._v(n._s(r.title)+"\n                "),i("span",{directives:[{name:"show",rawName:"v-show",value:!r.rawdata,expression:"!layer.rawdata"}],staticClass:"query-layer-feature-count"},[n._v("("+n._s(r.features.length)+")")])]),n._v(" "),i("div",{staticClass:"box-features-action",on:{click:function(e){e.stopPropagation()}}},[i("infoformats",{attrs:{layer:r}}),n._v(" "),1<r.features.length?[r.hasgeometry?i("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"sdk.mapcontrols.query.actions.zoom_to_features_extent.hint",expression:"'sdk.mapcontrols.query.actions.zoom_to_features_extent.hint'",arg:"left",modifiers:{create:!0}}],staticClass:"action-button",on:{click:function(e){return e.stopPropagation(),n.zoomToLayerFeaturesExtent(r)}}},[i("span",{staticClass:"action-button-icon",class:n.g3wtemplate.getFontClass("marker")})]):n._e(),n._v(" "),r.atlas.length?i("span",{directives:[{name:"download",rawName:"v-download"},{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"sdk.mapcontrols.query.actions.atlas.hint",expression:"'sdk.mapcontrols.query.actions.atlas.hint'",arg:"left",modifiers:{create:!0}}],staticClass:"action-button",on:{click:function(e){return e.stopPropagation(),n.printAtlas(r)}}},[i("span",{staticClass:"action-button-icon",class:n.g3wtemplate.getFontClass("print")})]):n._e(),n._v(" "),1===r.downloads.length?[i("span",{directives:[{name:"download",rawName:"v-download"},{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"sdk.mapcontrols.query.actions.download_features_"+r.downloads[0]+".hint",expression:"`sdk.mapcontrols.query.actions.download_features_${layer.downloads[0]}.hint`",arg:"left",modifiers:{create:!0}}],staticClass:"action-button",class:{toggled:r[r.downloads[0]].active}},[i("span",{staticClass:"action-button-icon",class:n.g3wtemplate.getFontClass("download"),on:{click:function(e){return e.stopPropagation(),n.saveLayerResult(r,r.downloads[0])}}})])]:1<r.downloads.length?[i("span",{directives:[{name:"download",rawName:"v-download"},{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"Downloads",expression:"'Downloads'",arg:"left",modifiers:{create:!0}}],staticClass:"action-button",class:{toggled:r.downloadformats.active}},[i("span",{staticClass:"action-button-icon",class:n.g3wtemplate.getFontClass("download"),on:{click:function(e){return e.stopPropagation(),n.showLayerDownloadFormats(r)}}})])]:n._e()]:n._e(),n._v(" "),r.external||r.source&&"wms"!==r.source.type?i("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"sdk.mapcontrols.query.actions.add_features_to_results.hint",expression:"'sdk.mapcontrols.query.actions.add_features_to_results.hint'",arg:"left",modifiers:{create:!0}}],staticClass:"action-button",class:{toggled:r.addfeaturesresults.active},on:{click:function(e){return e.stopPropagation(),n.addLayerFeaturesToResults(r)}}},[i("span",{staticClass:"action-button-icon",class:n.g3wtemplate.getFontClass("plus-square")})]):n._e(),n._v(" "),1<r.features.length&&(r.external||r.source&&"wms"!==r.source.type)?i("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"sdk.mapcontrols.query.actions.add_selection.hint",expression:"'sdk.mapcontrols.query.actions.add_selection.hint'",arg:"left",modifiers:{create:!0}}],staticClass:"action-button skin-tooltip-left",class:{toggled:r.selection.active},on:{click:function(e){return e.stopPropagation(),n.selectionFeaturesLayer(r)}}},[i("span",{staticClass:"action-button-icon",class:n.g3wtemplate.getFontClass("success")})]):n._e(),n._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:r.selection.active&&!r.external,expression:"layer.selection.active && !layer.external"},{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"layer_selection_filter.tools.filter",expression:"'layer_selection_filter.tools.filter'",arg:"left",modifiers:{create:!0}}],staticClass:"action-button skin-tooltip-left",class:{toggled:r.filter.active},on:{click:function(e){return e.stopPropagation(),n.addRemoveFilter(r)}}},[i("span",{staticClass:"action-button-icon",class:n.g3wtemplate.getFontClass("filter")})])],2),n._v(" "),i("button",{staticClass:"btn btn-box-tool",attrs:{"data-widget":"collapse"}},[i("i",{staticClass:"btn-collapser skin-color",class:n.g3wtemplate.font.minus})])]),n._v(" "),n.state.layeractiontool[r.id].component?[i("div",{staticClass:"g3w-layer-action-tools with-border",class:{mobile:n.isMobile()},staticStyle:{padding:"5px"}},[i(n.state.layeractiontool[r.id].component,{tag:"component",attrs:{layer:r,config:n.state.layeractiontool[r.id].config}})],1)]:n._e(),n._v(" "),n._l(n.getLayerCustomComponents(r.id,"layer","before"),function(e){e=e.component;return i(e,{tag:"component",attrs:{layer:r}})}),n._v(" "),i("div",{staticClass:"box-body",class:{mobile:n.isMobile()}},[r.rawdata?[i("div",{staticClass:"queryresults-text-html",class:{text:"text/plain"===r.infoformat},domProps:{innerHTML:n._s(r.rawdata)}})]:n.hasFormStructure(r)?[i("table",{staticClass:"table",class:{mobile:n.isMobile()}},[i("thead",[i("tr",[n.state.layersactions[r.id].length?i("th",{style:{width:26*n.state.layersactions[r.id].length+"px",maxWidth:26*n.state.layersactions[r.id].length+"px"}}):n._e(),n._v(" "),n._l(n.attributesSubset(r),function(e,t){return i("th",{staticClass:"centered"},[n._v(n._s(e.label))])}),n._v(" "),n.hasLayerOneFeature(r)?n._e():i("th",{staticClass:"collapsed"})],2)]),n._v(" "),i("tbody",[n._l(r.features,function(t,e){return t.show?[i("header-feature-body",{attrs:{actions:n.state.layersactions[r.id],layer:r,feature:t,index:e,onelayerresult:n.onelayerresult,trigger:n.trigger,toggleFeatureBoxAndZoom:n.toggleFeatureBoxAndZoom,hasLayerOneFeature:n.hasLayerOneFeature,boxLayerFeature:n.getLayerFeatureBox(r,t),attributesSubset:n.attributesSubset,getLayerField:n.getLayerField}}),n._v(" "),i("tr",{staticClass:"g3w-feature-result-action-tools"},[n.state.currentactiontools[r.id][e]?[i("td",{attrs:{colspan:n.getColSpan(r)}},[i(n.state.currentactiontools[r.id][e],{tag:"component",attrs:{colspan:n.getColSpan(r),layer:r,feature:t,featureIndex:e,config:n.state.actiontools[n.state.currentactiontools[r.id][e].name][r.id]}})],1)]:n._e()],2),n._v(" "),n._l(n.getLayerCustomComponents(r.id,"feature","before"),function(e){e=e.component;return i("tr",[i("td",{attrs:{colspan:n.getColSpan(r)}},[i(e,{tag:"component",attrs:{layer:r,feature:t}})],1)])}),n._v(" "),i("tr",{directives:[{name:"show",rawName:"v-show",value:!n.collapsedFeatureBox(r,t)||n.hasOneLayerAndOneFeature(r),expression:"!collapsedFeatureBox(layer,feature) || hasOneLayerAndOneFeature(layer)"}],staticClass:"featurebox-body",attrs:{id:r.id+"_"+e}},[i("td",{attrs:{colspan:n.getColSpan(r)}},[i("tabs",{attrs:{fields:n.getQueryFields(r,t),layerid:r.id,feature:t,tabs:n.getLayerFormStructure(r)}})],1)]),n._v(" "),n._l(n.getLayerCustomComponents(r.id,"feature","after"),function(e){e=e.component;return i("tr",[i("td",{attrs:{colspan:n.getColSpan(r)}},[i(e,{tag:"component",attrs:{layer:r,feature:t}})],1)])})]:n._e()})],2)])]:i("table",{staticClass:"table",class:{mobile:n.isMobile()}},[i("thead",[i("tr",[n.state.layersactions[r.id].length?i("th",{style:{width:26*n.state.layersactions[r.id].length+"px",maxWidth:26*n.state.layersactions[r.id].length+"px"}}):n._e(),n._v(" "),n._l(n.attributesSubset(r),function(e,t){return i("th",{staticClass:"centered"},[n._v(n._s(e.label))])}),n._v(" "),n.hasLayerOneFeature(r)?n._e():i("th",{staticClass:"collapsed"})],2)]),n._v(" "),n._l(r.features,function(t,e){return t.show?i("tbody",{key:t.id},[i("header-feature-body",{attrs:{actions:n.state.layersactions[r.id],layer:r,feature:t,index:e,onelayerresult:n.onelayerresult,trigger:n.trigger,toggleFeatureBoxAndZoom:n.toggleFeatureBoxAndZoom,hasLayerOneFeature:n.hasLayerOneFeature,boxLayerFeature:n.getLayerFeatureBox(r,t),attributesSubset:n.attributesSubset,getLayerField:n.getLayerField}}),n._v(" "),i("tr",{staticClass:"g3w-feature-result-action-tools"},[n.state.currentactiontools[r.id][e]?[i("td",{attrs:{colspan:n.getColSpan(r)}},[i(n.state.currentactiontools[r.id][e],{tag:"component",attrs:{colspan:n.getColSpan(r),layer:r,feature:t,featureIndex:e,config:n.state.actiontools[n.state.currentactiontools[r.id][e].name][r.id]}})],1)]:n._e()],2),n._v(" "),n._l(n.getLayerCustomComponents(r.id,"feature","before"),function(e){e=e.component;return i("tr",[i("td",{attrs:{colspan:"getColSpan(layer)"}},[i(e,{tag:"component",staticClass:"box-body",attrs:{layer:r,feature:t}})],1)])}),n._v(" "),i("tr",{directives:[{name:"show",rawName:"v-show",value:!n.collapsedFeatureBox(r,t)||n.hasOneLayerAndOneFeature(r),expression:"!collapsedFeatureBox(layer,feature) || hasOneLayerAndOneFeature(layer)"}],staticClass:"featurebox-body",attrs:{id:r.id+"_"+e}},[i("td",{attrs:{colspan:n.getColSpan(r)}},[i("table",{staticClass:"feature_attributes"},n._l(r.attributes.filter(function(e){return e.show}),function(e){return i("tr",[i("td",{staticClass:"attr-label"},[n._v(n._s(e.label))]),n._v(" "),i("td",{staticClass:"attr-value",attrs:{attribute:e.name}},[i("table-attribute-field-value",{attrs:{feature:t,field:n.getLayerField({layer:r,feature:t,fieldName:e.name})}})],1)])}),0)])]),n._v(" "),n._l(n.getLayerCustomComponents(r.id,"feature","after"),function(e){e=e.component;return i("tr",[i("td",{attrs:{colspan:"getColSpan(layer)"}},[i(e,{tag:"component",staticClass:"box-body",attrs:{layer:r,feature:t}})],1)])})],2):i("tbody")})],2)],2),n._v(" "),n._l(n.getLayerCustomComponents(r.id,"layer","after"),function(e){e=e.component;return i("div",{staticClass:"box-body",class:{mobile:n.isMobile()}},[i(e,{tag:"component",attrs:{layer:r}})],1)})],2)],1)}),n._v(" "),n._l(n.state.components,function(e){return i("li",[i(e,{tag:"component",on:{showresults:function(e){return n.showResults()}}})],1)})],2):n._e()]:[n.state.changed?i("div",{staticClass:"query-results-not-found"},[i("h4",{directives:[{name:"t",rawName:"v-t",value:"info.no_results",expression:"'info.no_results'"}],staticClass:"skin-color",staticStyle:{"font-weight":"bold","text-align":"center"}})]):n._e()]],2)])},e.staticRenderFns=[]},{"components/QueryResultsActionInfoFormats.vue":281,"components/QueryResultsHeaderFeatureBody.vue":284,"components/QueryResultsTableAttributeFieldValue.vue":285,"core/utils/utils":68,mixins:343}],279:[function(e,t,r){function n(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),l=e("core/i18n/i18n.service").t,r.default={name:"action",data:function(){return{show:!0}},props:{featureIndex:{type:Number},feature:{type:Object},layer:{type:Object},trigger:{type:Function},action:{type:Object,required:!0}},methods:{clickAction:(o=n(regeneratorRuntime.mark(function e(t,r,n,i,a){var o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.trigger(t,r,n,i);case 2:t.hint_change&&(o=$(a.target).parent(),s=o.attr("data-original-title"),o.attr("data-original-title",l(t.hint_change.hint)),o.tooltip("show"),setTimeout(function(){o.attr("data-original-title",s),o.tooltip("show")},t.hint_change.duration||600)),this.$emit("action-clicked",t);case 4:case"end":return e.stop()}},e,this)})),function(e,t,r,n,i){return o.apply(this,arguments)})},created:(a=n(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.action.init&&this.action.init({layer:this.layer,feature:this.feature,index:this.featureIndex,action:this.action}),"function"!=typeof this.action.condition)e.next=11;else{if((t=this.action.condition({layer:this.layer,feature:this.feature}))instanceof Promise)return e.next=6,t;e.next=9}break;case 6:e.t0=e.sent,e.next=10;break;case 9:e.t0=t;case 10:this.show=e.t0;case 11:case"end":return e.stop()}},e,this)})),function(){return a.apply(this,arguments)}),mounted:(i=n(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:$('.action-button[data-toggle="tooltip"]').tooltip();case 3:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default);var i,a,o,l,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return t.show?e("span",{directives:[{name:"download",rawName:"v-download",value:t.action.download,expression:"action.download"},{name:"t-title",rawName:"v-t-title",value:t.action.hint,expression:"action.hint"}],staticClass:"action-button skin-tooltip-right",class:{toggled:t.action.state&&t.action.state.toggled[t.featureIndex]},attrs:{"data-placement":"right","data-toggle":"tooltip"},on:{contextmenu:function(e){e.preventDefault(),e.stopPropagation()},click:function(e){return e.stopPropagation(),t.clickAction(t.action,t.layer,t.feature,t.featureIndex,e)}}},[e("span",{class:"action-button-icon "+t.action.class,staticStyle:{padding:"2px"},style:t.action.style})]):t._e()},e.staticRenderFns=[],e._scopeId="data-v-6e02064e"},{"core/i18n/i18n.service":13}],280:[function(e,t,r){function n(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),r.default={name:"downloadformats",data:function(){return{download_format:this.config.downloads[0].format}},props:{featureIndex:{type:Number},feature:{type:Object},layer:{type:Object},config:{type:Object,default:null}},methods:{download:(i=n(regeneratorRuntime.mark(function e(){var t,r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.config.downloads.find(function(e){return e.format===r.download_format}),e.next=4,t.cbk(this.layer,this.feature||this.layer.features,t,this.featureIndex);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}},e,this,[[0,6]])})),function(){return i.apply(this,arguments)})}},t.exports.__esModule&&(t.exports=t.exports.default);var i,r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"g3w-download-formats-content",staticStyle:{width:"100%",display:"flex"},on:{click:function(e){e.preventDefault(),e.stopPropagation()}}},[r("select",{directives:[{name:"select2",rawName:"v-select2",value:"download_format",expression:"'download_format'"}],staticClass:"form-control",staticStyle:{"flex-grow":"1"},attrs:{search:!1}},t._l(t.config.downloads,function(e){return r("option",{directives:[{name:"download",rawName:"v-download"}],key:e.id,domProps:{value:e.format}},[r("span",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(e.format))])])}),0),t._v(" "),r("button",{directives:[{name:"download",rawName:"v-download"}],staticClass:"btn skin-button",staticStyle:{"border-radius":"0 3px 3px 0"},on:{click:function(e){return e.stopPropagation(),t.download(e)}}},[r("span",{class:t.g3wtemplate.getFontClass("download")})])])},r.staticRenderFns=[],r._scopeId="data-v-12f80c6a"},{}],281:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=n(e("store/catalog-layers")),s=n(e("services/gui")),c=e("core/utils/parsers").response,d=e("core/utils/geo").getAlphanumericPropertiesFromFeature,r.default={name:"Infoformats",props:{layer:{type:Object,required:!0}},data:function(){return{infoformat:this.layer.infoformat}},computed:{infoformats:function(){return this.layer.infoformats||[]},hasInfo:function(){return this.infoformats.length}},methods:{reloadLayerDataWithChangedContentType:(u=i(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.layer.loading=!0,e.prev=1,e.next=4,this.projectLayer.changeProxyDataAndReloadFromServer("wms",{headers:{"Content-Type":t},params:{INFO_FORMAT:t}});case 4:r=e.sent,this.layer.infoformat=t,this.projectLayer.setInfoFormat(this.layer.infoformat),r=c.get(t)({layers:[this.projectLayer],response:r}),r=a(r,1),(r=r[0]).features?this.__parsedata(r):this.__parserawdata(r),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1);case 14:this.layer.loading=!1;case 15:case"end":return e.stop()}},e,this,[[1,11]])})),function(e){return u.apply(this,arguments)}),__parsedata:function(e){var n=this,i=s.default.getService("queryresults");this.layer.rawdata=null,e.features.forEach(function(e){var e=i.getFeaturePropertiesAndGeometry(e),t=e.id,r=e.geometry,e=e.properties;0===n.layer.attributes.length&&(n.layer.hasgeometry=!!r,i.setActionsForLayers([n.layer]),d(e).forEach(function(e){n.layer.attributes.push({name:e,label:e,show:!0})})),n.layer.features.push({id:t,attributes:e,geometry:r,show:!0})})},__parserawdata:(l=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.layer.features.splice(0),e.next=3,this.$nextTick();case 3:this.layer.rawdata=t.rawdata;case 4:case"end":return e.stop()}},e,this)})),function(e){return l.apply(this,arguments)})},watch:{infoformat:function(e){this.reloadLayerDataWithChangedContentType(e)}},created:function(){this.projectLayer=o.default.getLayerById(this.layer.id)},beforeDestroy:function(){this.projectLayer&&this.projectLayer.clearProxyData("wms"),this.projectLayer=null}},t.exports.__esModule&&(t.exports=t.exports.default);var a,o,s,l,u,c,d,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.hasInfo?r("select",{directives:[{name:"select2",rawName:"v-select2",value:"infoformat",expression:"'infoformat'"}],staticClass:"skin-color",attrs:{select2_value:t.infoformat,search:!1}},t._l(t.infoformats,function(e){return r("option",{key:e,domProps:{value:e}},[t._v(t._s(e))])}),0):t._e()},e.staticRenderFns=[]},{"core/utils/geo":64,"core/utils/parsers":67,"services/gui":361,"store/catalog-layers":374}],282:[function(e,t,r){e("vueify/lib/insert-css").insert(".g3w-polygonattributes-types-title[data-v-17e3cba2]{font-weight:700;padding:3px;color:#fff;margin:0 0 5px}.g3w-polygonattributes-types-content[data-v-17e3cba2]{display:flex;justify-content:space-between;padding:3px;border-radius:3px;border:1px solid #f4f4f4}");Object.defineProperty(r,"__esModule",{value:!0}),a=e("store/application-state"),n=(a=a)&&a.__esModule?a:{default:a},i=e("core/i18n/i18n.service").t,r.default={name:"queryresults-querypolygonaddattributes",props:{layer:{type:Object},config:{type:Object,default:null}},data:function(){return{type:this.config.choices[0].type}},created:function(){var t=this;this.unwatch=this.$watch(function(){return n.default.language},function(){t.config.choices.forEach(function(e){return $(t.$refs[e.type]).text(i(e.label))}),$(t.$refs.g3w_select_feature_featurepolygon).select2().trigger("change")})},beforeDestroy:function(){this.unwatch&&this.unwatch(),this.unwatch=null}},t.exports.__esModule&&(t.exports=t.exports.default);var n,i,a="function"==typeof t.exports?t.exports.options:t.exports;a.render=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticStyle:{width:"100%"}},[r("h5",{directives:[{name:"t",rawName:"v-t",value:"sdk.mapcontrols.querybypolygon.download.title",expression:"'sdk.mapcontrols.querybypolygon.download.title'"}],staticClass:"skin-background-color g3w-polygonattributes-types-title"}),t._v(" "),r("div",{staticClass:"g3w-polygonattributes-types-content"},[r("select",{directives:[{name:"select2",rawName:"v-select2",value:"type",expression:"'type'"}],ref:"g3w_select_feature_featurepolygon",staticClass:"form-control",staticStyle:{width:"100%"},attrs:{search:!1}},t._l(t.config.choices,function(e){return r("option",{directives:[{name:"t",rawName:"v-t",value:e.label,expression:"choice.label"}],key:e.type,ref:e.type,refInFor:!0,domProps:{value:e.type}})}),0),t._v(" "),r("button",{staticClass:"btn skin-button",staticStyle:{"border-radius":"0 3px 3px 0"},on:{click:function(e){return e.stopPropagation(),t.config.download(t.type)}}},[r("span",{class:t.g3wtemplate.getFontClass("download")})])])])},a.staticRenderFns=[],a._scopeId="data-v-17e3cba2"},{"core/i18n/i18n.service":13,"store/application-state":373,"vueify/lib/insert-css":1}],283:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),e=(e=e=e("components/QueryResultsAction.vue"))&&e.__esModule?e:{default:e},r.default={name:"actions",props:{featureIndex:{type:Number},feature:{type:Object},layer:{type:Object},trigger:{type:Function},actions:{type:Array,default:[]}},components:{action:e.default}},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.actions.length?r("td",{staticClass:"g3w-feature-actions"},t._l(t.actions,function(e){return r("action",t._b({key:e.id,attrs:{action:e}},"action",t.$props,!1))}),1):t._e()},r.staticRenderFns=[],r._scopeId="data-v-5a8c3f6a"},{"components/QueryResultsAction.vue":279}],284:[function(e,t,r){e("vueify/lib/insert-css").insert(".noAttributes[data-v-18bc8218]{display:flex;justify-content:flex-end}");Object.defineProperty(r,"__esModule",{value:!0}),n=(n=n=e("components/QueryResultsActions.vue"))&&n.__esModule?n:{default:n},e=e("mixins"),r.default={name:"headerfeaturebody",mixins:[e.fieldsMixin],props:{toggleFeatureBoxAndZoom:{type:Function},trigger:{type:Function},hasLayerOneFeature:{type:Function},boxLayerFeature:{type:Object},getLayerField:{type:Function},attributesSubset:{type:Function},layer:{type:Object},feature:{type:Object},index:{type:Number},actions:{type:Array}},components:{actions:n.default}},t.exports.__esModule&&(t.exports=t.exports.default);var n,r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("tr",{staticClass:"featurebox-header",class:[t.boxLayerFeature.collapsed?"":"featurebox-header-open"],on:{click:function(e){return t.toggleFeatureBoxAndZoom(t.layer,t.feature)},mouseover:function(e){return t.trigger({id:"highlightgeometry"},t.layer,t.feature,t.index)},mouseout:function(e){return t.trigger({id:"clearHighlightGeometry"},t.layer,t.feature,t.index)}}},[r("actions",{attrs:{layer:t.layer,featureIndex:t.index,trigger:t.trigger,feature:t.feature,actions:t.actions}}),t._v(" "),t._l(t.attributesSubset(t.layer),function(e){return r("td",{staticClass:"attribute"},[t.isLink(t.getLayerField({layer:t.layer,feature:t.feature,fieldName:e.name}))?r("span",{staticClass:"skin-color",class:t.g3wtemplate.getFontClass("link")}):t.isPhoto(t.getLayerField({layer:t.layer,feature:t.feature,fieldName:e.name}))||t.isImage(t.getLayerField({layer:t.layer,feature:t.feature,fieldName:e.name}))?r("span",{staticClass:"skin-color",class:t.g3wtemplate.getFontClass("image")}):r("span",[t._v(t._s(t.feature.attributes[e.name]))])])}),t._v(" "),t.hasLayerOneFeature(t.layer)?t._e():r("td",{staticClass:"collapsed",class:{noAttributes:0===t.attributesSubset(t.layer).length}},[r("span",{staticClass:"fa link morelink skin-color",class:[t.boxLayerFeature.collapsed?t.g3wtemplate.font.plus:t.g3wtemplate.font.minus]})])],2)},r.staticRenderFns=[],r._scopeId="data-v-18bc8218"},{"components/QueryResultsActions.vue":283,mixins:343,"vueify/lib/insert-css":1}],285:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),i=n(e("components/FieldLink.vue")),a=n(e("components/FieldVue.vue")),e=e("mixins"),r.default={name:"tableattributefieldvalue",props:{field:{type:Object},feature:{type:Object}},mixins:[e.fieldsMixin],components:{"g3w-link":i.default,"g3w-vue":a.default}},t.exports.__esModule&&(t.exports=t.exports.default);var i,a,r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var e=this,t=e.$createElement,t=e._self._c||t;return e.isVue(e.field)?t("g3w-vue",{attrs:{feature:e.feature,state:e.field}}):e.isSimple(e.field)?t("span",{domProps:{innerHTML:e._s(e.field.value)}}):e.isPhoto(e.field)||e.isImage(e.field)?t("g3w-image",{attrs:{value:e.field.value}}):e.isLink(e.field)?t("g3w-link",{attrs:{state:{value:e.field.value}}}):e._e()},r.staticRenderFns=[],r._scopeId="data-v-359d5ff0"},{"components/FieldLink.vue":209,"components/FieldVue.vue":212,mixins:343}],286:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function a(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),o=e("app/constant"),i=n(e("components/FieldG3W.vue")),s=n(e("components/QueryResultsActionDownloadFormats.vue")),l=n(e("store/catalog-layers")),u=n(e("services/gui")),c=e("mixins"),m=e("core/utils/utils").throttle,y=e("gui/relations/vue/relationeventbus"),_=void 0,r.default={name:"relation",props:{table:{},feature:{default:null},relation:{},previousview:{},showChartButton:{},cardinality:{}},inject:["relationnoback"],mixins:[c.fieldsMixin,c.resizeMixin],components:{Field:i.default},data:function(){return{fields:null,chart:!1,headercomponent:null,downloadButton:null,downloadLayer:{state:null,config:{downloads:[]}}}},computed:{showrelationslist:function(){return"relations"===this.previousview&&!this.relationnoback},one:function(){return"ONE"===this.relation.type}},methods:{createTable:(v=a(regeneratorRuntime.mark(function e(){var t,r,n,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.default.getLayerById(this.table.layerId),this.isEditable=t.isEditable()&&!t.isInEditing(),r=t.isDownloadable()?t.getDownloadableFormats():[],0<(n=r.length)&&(this.downloadButton={toggled:!1,tooltip:1<n?"Downloads":"sdk.tooltips.download_"+r[0],handler:1<n?a(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i.downloadButton.toggled=!i.downloadButton.toggled,i.downloadLayer.state=i.downloadLayer.state||t.state,i.downloadLayer.config.downloads=i.downloadLayer.config.downloads.length?i.downloadLayer.config.downloads:r.map(function(e){return{id:e,format:e,cbk:function(){i.saveRelation(t.getDownloadUrl(e)),i.headercomponent=null},download:!0}}),i.headercomponent=i.downloadButton.toggled?s.default:null;case 4:case"end":return e.stop()}},e,i)})):function(){return i.saveRelation(t.getDownloadUrl(r[0]))}}),y.$on("reload",function(){i.reloadLayout()}),this.showChart=m(a(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i.chart=!i.chart,e.next=3,i.$nextTick();case 3:i.chartContainer=i.chartContainer||$("#chart_content"),t={relations:[i.relation],fid:i.feature.attributes[o.G3W_FID]},i.$emit(i.chart?"show-chart":"hide-chart",i.chartContainer,t);case 6:case"end":return e.stop()}},e,i)}))),e.next=9,this.$nextTick();case 9:_=u.default.getSize({element:"sidebar",what:"width"}),this.relation.title=this.relation.name,this.one||(this.relationDataTable=$(this.$refs.relationtable).DataTable({pageLength:10,bLengthChange:!0,scrollResize:!0,scrollCollapse:!0,scrollX:!0,responsive:!0,order:[this.table.formStructure?1:0,"asc"],columnDefs:[{orderable:!this.table.formStructure,targets:0}]}),this.tableHeaderHeight=$(".query-relation  div.dataTables_scrollHeadInner").height()),u.default.on("pop-content",this.resize);case 13:case"end":return e.stop()}},e,this)})),function(){return v.apply(this,arguments)}),resize:(g=a(regeneratorRuntime.mark(function e(){var t,r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.$refs.query_relation&&"none"!==this.$refs.query_relation.parentNode.style.display&&(n=$(".content").height(),t=$(this.$refs.query_relation).find("div.dataTables_scrollBody"),r=$(".content_breadcrumb").outerHeight(),r=r+$(".navbar-header").outerHeight()+$(".close-panel-block").outerHeight()+$(this.$refs["relation-header"]).outerHeight()+$(".dataTables_filter").last().outerHeight()+$(".dataTables_paginate.paging_simple_numbers").outerHeight()+$(".dataTables_scrollHead").last().outerHeight(),t.height(n-this.tableHeaderHeight-r),this.table.rowFormStructure&&(n=t.width()-$(this.$refs.relationtable).find("tr.selected > td").outerWidth()-20,$(".row-wrap-tabs > .tabs-wrapper").width(n)),this.reloadLayout());case 1:case"end":return e.stop()}},e,this)})),function(){return g.apply(this,arguments)}),saveRelation:function(e){this.$emit("save-relation",e),this.downloadButton.toggled=!1},showFormStructureRow:(h=a(regeneratorRuntime.mark(function e(t,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.table.rowFormStructure=this.table.rowFormStructure===r?null:r,this.fields=this.getRowFields(r),e.next=4,this.$nextTick();case 4:$("#relationtable_wrapper div.dataTables_scrollBody").css("overflow-x",this.table.rowFormStructure?"hidden":"auto"),this.resize();case 6:case"end":return e.stop()}},e,this)})),function(e,t){return h.apply(this,arguments)}),editFeature:function(e){u.default.getService("queryresults").editFeature({layer:{id:this.table.layerId,attributes:this.table.fields},feature:this.table.features[e]})},getRowFields:function(r){var n=this;return this.table.fields.map(function(e,t){return e.value=r[t],e.query=!0,e.input={type:""+n.getFieldType(e)},e})},reloadLayout:function(){this.relationDataTable&&this.relationDataTable.columns.adjust()},back:function(){this.$parent.setRelationsList()},fieldIs:function(e,t){return this.getFieldType(t)===e},is:function(e,t){return this.fieldIs(e,t)},moveFnc:function(e){var t=$(".sidebar-collapse").length?0:_,e=e.pageX+2-t;this.$refs.tablecontent.style.width=e+"px",this.$refs.chartcontent.style.width=$(this.$refs.relationwrapper).width()-e-10+"px"}},watch:{table:{immediate:!0,handler:function(e){e&&e.rows.length&&this.createTable()}},chart:(f=a(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.resize();case 3:case"end":return e.stop()}},e,this)})),function(){return f.apply(this,arguments)}),headercomponent:(p=a(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.resize();case 3:case"end":return e.stop()}},e,this)})),function(){return p.apply(this,arguments)})},beforeCreate:function(){this.delayType="debounce"},beforeDestroy:(d=a(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.relationDataTable&&(this.relationDataTable.destroy(),this.relationDataTable=null,this.chartContainer&&this.$emit("hide-chart",this.chartContainer),this.chartContainer=null,this.tableHeaderHeight=null,u.default.off("pop-content",this.resize));case 1:case"end":return e.stop()}},e,this)})),function(){return d.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default);var o,i,s,l,u,c,d,p,f,h,g,v,m,y,_,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var n=this,e=n.$createElement,i=n._self._c||e;return n.table?i("div",{ref:"query_relation",staticClass:"query-relation",class:n.isMobile()?"mobile":null,staticStyle:{"margin-top":"3px"}},[i("div",{ref:"relation-header",staticClass:"header skin-background-color lighten",staticStyle:{padding:"3px",display:"flex","justify-content":"space-between","align-items":"center",width:"100%"}},[i("div",{staticClass:"g3w-long-text",staticStyle:{"border-radius":"3px"},style:{fontSize:n.isMobile()?"1em":"1.3em"}},[n.showrelationslist?i("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:right.create",value:"sdk.relations.back_to_relations",expression:"'sdk.relations.back_to_relations'",arg:"right",modifiers:{create:!0}}],staticClass:"action-button-icon action-button",class:n.g3wtemplate.getFontClass("exit"),staticStyle:{"font-size":"0.8em"},on:{click:function(e){return e.stopPropagation(),n.back(e)}}}):n._e(),n._v(" "),i("span",{staticClass:"relation-tile skin-color",staticStyle:{"font-weight":"bold"}},[n._v(" "+n._s(n.relation.name))])]),n._v(" "),n.table.rows.length?i("div",{staticClass:"relations-table-tools",staticStyle:{"font-size":"1.1em","margin-bottom":"3px"}},[n.downloadButton?i("span",{directives:[{name:"download",rawName:"v-download"},{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:n.downloadButton.tooltip,expression:"downloadButton.tooltip",arg:"left",modifiers:{create:!0}}],staticClass:"action-button-icon action-button",class:[n.g3wtemplate.getFontClass("download"),{"toggled-white":n.downloadButton.toggled}],staticStyle:{padding:"5px"},on:{click:n.downloadButton.handler}}):n._e(),n._v(" "),n.showChartButton?i("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:bottom.create",value:"sdk.tooltips.show_chart",expression:"'sdk.tooltips.show_chart'",arg:"bottom",modifiers:{create:!0}}],staticClass:"action-button-icon action-button",class:[n.g3wtemplate.getFontClass("chart"),n.chart?"toggled-white":""],staticStyle:{padding:"5px"},on:{click:function(e){return e.stopPropagation(),n.showChart(e)}}}):n._e()]):n._e()]),n._v(" "),n.table.rows.length?i("div",{ref:"relationwrapper",staticStyle:{display:"flex","justify-content":"space-between","margin-bottom":"5px","margin-top":"3px",height:"95%"}},[i("div",{ref:"tablecontent",style:{width:n.chart?"70%":"100%",marginRight:n.chart?"8px":"3px",position:"relative"},attrs:{id:"table_content"}},[n.headercomponent?[i("div",{staticStyle:{width:"100%",display:"flex","margin-left":"auto","margin-bottom":"5px","margin-right":"4px"}},[i(n.headercomponent,{tag:"component",attrs:{layer:n.downloadLayer.state,config:n.downloadLayer.config}})],1)]:n._e(),n._v(" "),i("table",{ref:"relationtable",staticClass:"hover relationtable table table-striped row-border",staticStyle:{width:"100%"}},[i("thead",[i("tr",{staticStyle:{height:"0! important"}},[n.table.formStructure||n.isEditable?i("th",{style:{minWidth:30*(+!!n.table.formStructure+ +n.isEditable)+"px",padding:"0 !important"}}):n._e(),n._v(" "),n._l(n.table.columns,function(e){return i("th",[n._v(n._s(e))])})],2)]),n._v(" "),i("tbody",n._l(n.table.rows,function(t,r){return i("tr",{key:n.table.rows_fid[r],class:{selected:n.table.rowFormStructure===t}},[n.table.formStructure||n.isEditable?i("td",[n.table.formStructure?i("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:right.create",value:n.table.rowFormStructure===t?"sdk.tooltips.relations.form_to_row":"sdk.tooltips.relations.row_to_form",expression:"table.rowFormStructure === row ? 'sdk.tooltips.relations.form_to_row': 'sdk.tooltips.relations.row_to_form'",arg:"right",modifiers:{create:!0}}],staticClass:"action-button row-form skin-color",class:[n.table.rowFormStructure===t?n.g3wtemplate.getFontClass("minus"):n.g3wtemplate.getFontClass("table")],staticStyle:{cursor:"pointer"},attrs:{"current-tooltip":n.table.rowFormStructure===t?"sdk.tooltips.relations.form_to_row":"sdk.tooltips.relations.row_to_form"},on:{click:function(e){return e.stopPropagation(),n.showFormStructureRow(e,t)}}}):n._e(),n._v(" "),n.isEditable?i("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:right.create",value:"Edit",expression:"'Edit'",arg:"right",modifiers:{create:!0}}],staticClass:"action-button row-form skin-color",class:n.g3wtemplate.getFontClass("pencil"),on:{click:function(e){return e.stopPropagation(),n.editFeature(r)}}}):n._e()]):n._e(),n._v(" "),n.table.formStructure&&n.table.rowFormStructure===t?[i("td",{staticClass:"row-wrap-tabs",attrs:{colspan:n.table.columns.length}},[i("tabs",{attrs:{layerid:n.table.layerId,feature:n.table.features[r],fields:n.fields,tabs:n.table.formStructure}})],1)]:n._l(t,function(e){return i("td",[i("field",{attrs:{state:{value:e}}})],1)})],2)}),0)])],2),n._v(" "),i("g3w-resize",{staticClass:"skin-border-color lighten",staticStyle:{"border-style":"solid","border-width":"0 1px 0 1px"},attrs:{show:n.chart,moveFnc:n.moveFnc,where:"content"}}),n._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:n.chart,expression:"chart"}],ref:"chartcontent",style:{width:n.chart?"30%":"0",paddingBottom:"5px",marginBottom:"5px",marginLeft:"8px"},attrs:{id:"chart_content"}})],1):i("div",{staticClass:"dataTables_scrollBody",staticStyle:{"font-weight":"bold","margin-top":"10px","font-size":"1.1em",display:"flex","justify-content":"space-between"}},[i("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.relations.no_relations_found",expression:"'sdk.relations.no_relations_found'"}]})])]):n._e()},e.staticRenderFns=[]},{"app/constant":4,"components/FieldG3W.vue":206,"components/QueryResultsActionDownloadFormats.vue":280,"core/utils/utils":68,"gui/relations/vue/relationeventbus":174,mixins:343,"services/gui":361,"store/catalog-layers":374}],287:[function(e,t,r){var n,i,a;e("vueify/lib/insert-css").insert(".relation-grid-item[data-v-6afbae12]{min-width:0;min-height:80px;border:2px solid;cursor:pointer;border-radius:4px;background-color:#fff;display:flex;align-items:center}.relation-grid-item[data-v-6afbae12]:hover{background-color:transparent}");function o(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},r.default={name:"relations",props:["relations","feature","loading"],methods:{showRelation:(i=o(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$parent.showRelation(t);case 2:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)}),featureInfo:function(){var r=[],n=0;return Object.entries(this.feature.attributes).forEach(function(e){var e=a(e,2),t=e[0],e=e[1];if(2<n)return!1;e&&_.isString(e)&&-1===e.indexOf("/")&&(r.push({key:t,value:e}),n+=1)}),r}},mounted:(n=o(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(1===this.relations.length)return(t=this.relations[0]).noback=!0,e.next=5,this.showRelation(t);e.next=5;break;case 5:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)}),beforeDestroy:function(){1===this.relations.length&&delete this.relations[0].noback}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("div",{staticClass:"query-relations",staticStyle:{"overflow-y":"auto"}},[n("div",{staticClass:"header skin-background-color lighten",staticStyle:{"margin-bottom":"10px","border-radius":"4px",padding:"5px"}},[n("div",{staticClass:"skin-color-dark"},[n("span",{directives:[{name:"t",rawName:"v-t:pre",value:"sdk.relations.list_of_relations_feature",expression:"'sdk.relations.list_of_relations_feature'",arg:"pre"}],staticStyle:{"font-size":"1.1em"}}),r._v(" "),r._l(r.featureInfo(),function(e){return n("span",[n("b",[r._v(r._s(e.key))]),r._v(": "+r._s(e.value)+" ")])})],2)]),r._v(" "),n("div",{staticClass:"query-relations-content",staticStyle:{display:"grid","grid-template-columns":"repeat(2, auto)","grid-column-gap":"5px","grid-row-gap":"5px"}},r._l(r.relations,function(t){return n("div",{staticClass:"skin-border-color relation-grid-item",on:{click:function(e){return r.showRelation(t)}}},[n("span",{staticClass:"skin-color g3w-long-text",staticStyle:{"font-weight":"bold",padding:"5px"}},[r._v(r._s(t.name))])])}),0)])},e.staticRenderFns=[],e._scopeId="data-v-6afbae12"},{"vueify/lib/insert-css":1}],288:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),a=n(e("services/gui")),o=n(e("components/Relations.vue")),s=n(e("components/Relation.vue")),l=e("constant"),d=e("core/utils/geo").getFeaturesFromResponseVectorApi,p=e("gui/relations/vue/relationeventbus"),r.default={name:"relation-page",data:function(){this.chartRelationIds=this.$options.chartRelationIds||[];var e=this.$options,t=e.table,r=e.relation,r=void 0===r?null:r,n=e.relations,i=e.nmRelation,a=e.feature,o=e.currentview,e=e.service;return{loading:!1,state:null,error:!1,table:t?e.buildRelationTable(t):null,relation:r,relations:n,nmRelation:i,showChartButton:!1,feature:a,currentview:o,previousview:o}},provide:function(){return{relationnoback:1===this.$options.relations.length}},components:{relations:o.default,relation:s.default},methods:{saveRelations:function(e){this.$options.service.saveRelations(e)},reloadLayout:function(){p.$emit("reload")},showChart:function(e,t){var r=this.relation.referencingLayer;a.default.getService("queryresults").showChart([r],e,t)},hideChart:function(e){a.default.getService("queryresults").hideChart(e)},showRelation:(c=i(regeneratorRuntime.mark(function e(t){var r,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.default.setLoadingContent(!0),this.loading=!0,this.relation=t,r=t.referencingLayer,n=this.feature.attributes[l.G3W_FID],e.prev=5,e.next=8,this.$options.service.getRelations({layer:this.$options.layer,relation:t,fid:n});case 8:if(n=e.sent,i=d(n,{type:"result"}),this.nmRelation)return r=this.nmRelation.referencedLayer,e.next=14,this.$options.service.getRelationsNM({nmRelation:this.nmRelation,features:i});e.next=15;break;case 14:i=e.sent;case 15:return this.showChartButton=!!this.chartRelationIds.find(function(e){return e===r}),this.table=this.$options.service.buildRelationTable(i,r),a.default.changeCurrentContentOptions({title:t.name,crumb:{title:t.name}}),e.next=20,this.$nextTick();case 20:this.previousview=this.currentview,this.currentview="relation",e.next=26;break;case 24:e.prev=24,e.t0=e.catch(5);case 26:a.default.setLoadingContent(!1),this.loading=!0;case 28:case"end":return e.stop()}},e,this,[[5,24]])})),function(e){return c.apply(this,arguments)}),setRelationsList:function(){this.previousview="relation",this.currentview="relations",a.default.changeCurrentContentOptions({crumb:{title:l.LIST_OF_RELATIONS_TITLE}}),this.loading=!1}},beforeMount:function(){("relation"===this.currentview||1===this.relations.length&&"ONE"===this.relations[0].type)&&this.showRelation(this.relations[0])},mounted:(u=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.relations.sort(function(e,t){e=e.name,t=t.name;return e<t?-1:t<e?1:0}),e.next=3,this.$nextTick();case 3:this.error&&requestAnimationFrame(function(){a.default.popContent()}),this.error=!1;case 5:case"end":return e.stop()}},e,this)})),function(){return u.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default);var a,o,s,l,u,c,d,p,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("div",{staticClass:"query-relations-page"},[t(e.currentview,{ref:e.currentview,tag:"component",attrs:{loading:e.loading,previousview:e.previousview,showChartButton:e.showChartButton,relations:e.relations,relation:e.relation,nmRelation:e.nmRelation,feature:e.feature,table:e.table},on:{"save-relation":e.saveRelations,"show-chart":e.showChart,"hide-chart":e.hideChart}})],1)},e.staticRenderFns=[]},{"components/Relation.vue":286,"components/Relations.vue":287,constant:4,"core/utils/geo":64,"gui/relations/vue/relationeventbus":174,"services/gui":361}],289:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),o=n(e("components/Tool.vue")),e=n(e("components/QueryBuilderSearch.vue")),r.default={name:"search",data:function(){return{state:null}},components:{"g3w-tool":o.default,"g3w-search-querybuilder":e.default},computed:{show:function(){return 0<this.state.searches.length+this.state.searchtools.length+this.state.querybuildersearches.length}},methods:{showPanel:function(){this.$options.service.showPanel(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},removeItem:function(e){var t=e.type,e=e.index;this.$options.service.removeItem({type:t,index:e})}},mounted:(a=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:$(".icon-search-action").tooltip();case 3:case"end":return e.stop()}},e,this)})),function(){return a.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default);var a,o,r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var r=this,e=r.$createElement,n=r._self._c||e;return r.show?n("ul",{staticClass:"treeview-menu g3w-search g3w-tools menu-items",attrs:{id:"g3w-search"}},[r._l(r.state.searches,function(t){return n("li",{staticClass:"menu-item",on:{click:function(e){return r.showPanel(t)}}},[n("i",{class:r.g3wtemplate.getFontClass("empty-circle")}),r._v(" "),n("span",[r._v(r._s(t.name))])])}),r._v(" "),r._l(r.state.searchtools,function(e){return n("li",[n("g3w-tool",{attrs:{tool:e}})],1)}),r._v(" "),r._l(r.state.querybuildersearches,function(e,t){return n("g3w-search-querybuilder",{key:e.id,attrs:{querybuildersearch:e},on:{delete:function(e){return r.removeItem({type:"querybuilder",index:t})}}})})],2):r._e()},r.staticRenderFns=[]},{"components/QueryBuilderSearch.vue":277,"components/Tool.vue":305}],290:[function(e,t,r){function n(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),i=e("store/application-state"),a=(i=i)&&i.__esModule?i:{default:i},i=e("core/utils/utils"),s=i.getUniqueDomId,l=i.convertQGISDateTimeFormatToMoment,r.default={name:"Searchdatetime",props:{forminput:{type:Object,require:!0}},created:function(){this.id="search_datetime_"+s()},computed:{time:function(){return this.forminput.options.format.time}},mounted:(o=n(regeneratorRuntime.mark(function e(){var t,r,n,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:t=this.forminput.options.format,r=t.fieldformat,n=t.displayformat,r=l(r),n=l(n),$("#"+this.id).datetimepicker({defaultDate:null,format:n,ignoreReadonly:!0,allowInputToggle:!0,toolbarPlacement:"top",widgetPositioning:{vertical:"bottom",horizontal:"left"},showClose:!0,locale:a.default.language||"en"}),$("#"+this.id).on("dp.change",function(){var e=$("#"+i.forminput.id).val();i.forminput.value=_.isEmpty(_.trim(e))?null:moment(e,n).format(r),i.$emit("change",i.forminput)}),a.default.ismobile&&setTimeout(function(){$("#"+i.forminput.id).blur()});case 9:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default);var i,a,o,s,l,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this.$createElement,e=this._self._c||e;return e("div",{staticClass:"input-group date",attrs:{id:this.id}},[e("input",{staticClass:"form-control",attrs:{id:this.forminput.id,type:"text"}}),this._v(" "),e("span",{staticClass:"input-group-addon skin-color"},[e("span",{class:this.g3wtemplate.getFontClass(this.time?"time":"calendar")})])])},e.staticRenderFns=[]},{"core/utils/utils":68,"store/application-state":373}],291:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=n(e("components/SearchSelect2.vue")),u=n(e("components/SearchDatetime.vue")),e=n(e("components/SearchPanelLabel.vue")),r.default={components:{Select2:l.default,SearchDatetime:u.default,SearchPanelLabel:e.default},data:function(){return{state:this.$options.service.state}},methods:{isSelectDisabled:function(e){return[this.state.loading[e.options.dependance],e.loading,e.options.disabled].reduce(function(e){return e||1<arguments.length&&void 0!==arguments[1]&&arguments[1]},!1)},onFocus:(o=i(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isMobile())return r=$(t.target).position().top-10,e.next=4,this.$nextTick();e.next=5;break;case 4:setTimeout(function(){return $(".sidebar").scrollTop(r)},500);case 5:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)}),autocompleteRequest:(a=i(regeneratorRuntime.mark(function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.$options.service.getUniqueValuesFromField(s({},t,{output:"autocomplete"})));case 1:case"end":return e.stop()}},e,this)})),function(){return a.apply(this,arguments)}),changeDependencyFields:function(e){var t=e.attribute,e=e.value,r=this.$options.service.getDependencies(t);return r.length?this.$options.service.fillDependencyInputs({field:t,subscribers:r,value:e}):Promise.resolve()},changeNumericInput:function(e){e.value=e.value||0===e.value?e.value:null,this.changeInput(e)},changeInput:function(e){var t=this,r=e.id,n=e.attribute,i=e.value,e=e.type;try{i="textfield"===e||"textField"===e?i:i.trim()}catch(e){}this.$options.service.changeInput({id:r,value:i}),this.state.searching=!0,this.changeDependencyFields({attribute:n,value:i}).finally(function(){t.state.searching=!1})},doSearch:function(e){e.preventDefault(),this.$options.service.run()}}},t.exports.__esModule&&(t.exports=t.exports.default);var a,o,s,l,u,r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("div",{directives:[{name:"disabled",rawName:"v-disabled",value:r.state.searching,expression:"state.searching"}],staticClass:"g3w-search-panel form-group"},[n("h4",{},[n("b",[r._v(r._s(r.state.title))])]),r._v(" "),r._t("tools"),r._v(" "),r._t("form",[n("form",{staticClass:"g3w-search-form"},[r._l(r.state.forminputs,function(t){return n("span",{key:t.id},["numberfield"===t.type?n("div",{staticClass:"form-group numeric"},[n("search-panel-label",{attrs:{forminput:t}}),r._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"forminput.value"}],staticClass:"form-control",attrs:{type:"number",min:"0",id:t.id},domProps:{value:t.value},on:{change:function(e){return r.changeNumericInput(t)},input:[function(e){e.target.composing||r.$set(t,"value",e.target.value)},function(e){return r.changeNumericInput(t)}]}})],1):"textfield"===t.type||"textField"===t.type?n("div",{staticClass:"form-group form-item-search  text"},[n("search-panel-label",{attrs:{forminput:t}}),r._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"forminput.value"}],staticClass:"form-control",attrs:{type:"text",id:t.id},domProps:{value:t.value},on:{focus:r.onFocus,change:function(e){return r.changeInput(t)},input:function(e){e.target.composing||r.$set(t,"value",e.target.value)}}})],1):"selectfield"===t.type||"autocompletefield"===t.type?n("div",{directives:[{name:"disabled",rawName:"v-disabled",value:r.isSelectDisabled(t),expression:"isSelectDisabled(forminput)"}],staticClass:"form-group text"},[n("search-panel-label",{attrs:{forminput:t}}),r._v(" "),t.options.dependance?n("bar-loader",{attrs:{loading:r.state.loading[t.options.dependance]||t.loading}}):r._e(),r._v(" "),n("select2",{attrs:{forminput:t,autocompleteRequest:r.autocompleteRequest},on:{"select-change":r.changeInput}})],1):r._e(),r._v(" "),"datetimefield"===t.type?n("div",{directives:[{name:"disabled",rawName:"v-disabled",value:r.state.loading[t.options.dependance]||!1,expression:"state.loading[forminput.options.dependance] || false"}],staticClass:"form-group text"},[n("search-panel-label",{attrs:{forminput:t}}),r._v(" "),n("search-datetime",{attrs:{forminput:t},on:{change:r.changeInput}})],1):r._e(),r._v(" "),t.logicop?n("div",{staticClass:"search-logicop skin-border-color"},[n("h4",[r._v(r._s(t.logicop))])]):r._e()])}),r._v(" "),n("div",{staticClass:"form-group"},[n("button",{directives:[{name:"t",rawName:"v-t",value:"dosearch",expression:"'dosearch'"}],staticClass:"sidebar-button-run btn btn-block pull-right",attrs:{id:"dosearch","data-i18n":"dosearch"},on:{click:function(e){return e.stopPropagation(),r.doSearch(e)}}})])],2)]),r._v(" "),r._t("footer")],2)},r.staticRenderFns=[]},{"components/SearchDatetime.vue":290,"components/SearchPanelLabel.vue":292,"components/SearchSelect2.vue":293}],292:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),n=e("app/constant"),r.default={name:"Searchpanellabel",props:{forminput:{type:Object,require:!0}},methods:{getLabelOperator:function(e){return"[ "+n.FILTER_EXPRESSION_OPERATORS[e]+" ]"}}},t.exports.__esModule&&(t.exports=t.exports.default);var n,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("label",{staticClass:"search-label",staticStyle:{width:"100%",display:"flex","justify-content":"space-between"},attrs:{for:e.forminput.id}},[t("span",[e._v(e._s(e.forminput.label||e.forminput.attribute))]),e._v(" "),t("span",{staticClass:"skin-color"},[e._v(e._s(e.getLabelOperator(e.forminput.operator)))])])},e.staticRenderFns=[]},{"app/constant":4}],293:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n=e("app/constant"),a=e("mixins");function l(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var o,s,u=e("gui/external/select2/options/autocomplete"),e=(e("core/i18n/i18n.service").t,e("core/utils/utils").debounce,r.default={name:"select2",props:["forminput","autocompleteRequest"],mixins:[a.select2Mixin],methods:{emitChangeEvent:function(e){var t=$(e.target).attr("id"),r=$(e.target).attr("name"),e=e.params.data,e=e?e.id:n.SEARCH_ALLVALUE;this.$emit("select-change",{id:t,attribute:r,value:e,type:this.forminput.type})},_initSelect2Element:function(){var n,o=this,e=this.forminput,t=e.type,s=e.attribute,e=e.options,e=e.numdigaut&&!Number.isNaN(+e.numdigaut)&&0<+e.numdigaut&&+e.numdigaut||2,t="autocompletefield"===t;this.select2=$(this.$el).select2(i({width:"100%",dropdownParent:$(".g3w-search-form:visible"),minimumInputLength:t&&e||0,allowClear:t,placeholder:t?"":null,ajax:t?{delay:500,transport:(n=l(regeneratorRuntime.mark(function e(t,r,n){var i,a=t.data.q;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.autocompleteRequest({field:s,value:a});case 3:i=e.sent,r({results:i}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),n(e.t0);case 10:case"end":return e.stop()}},e,o,[[0,7]])})),function(e,t,r){return n.apply(this,arguments)})}:null},u)),this.select2.on("select2:select",function(e){o.emitChangeEvent(e)}),"autocompletefield"===this.forminput.type&&this.select2.on("select2:unselecting",function(e){o.emitChangeEvent(e)})}},watch:{"forminput.value":(s=l(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:t===n.SEARCH_ALLVALUE&&(this.select2.val(t),this.select2.trigger("change"));case 3:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)})},created:function(){this.allvalue=n.SEARCH_ALLVALUE},mounted:(o=l(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this._initSelect2Element();case 3:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default),"function"==typeof t.exports?t.exports.options:t.exports);e.render=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("select",{directives:[{name:"disabled",rawName:"v-disabled",value:t.forminput.options.disabled||t.forminput.loading,expression:"forminput.options.disabled || forminput.loading"}],staticClass:"form-control",attrs:{name:t.forminput.attribute,id:t.forminput.id}},t._l(t.forminput.options.values,function(e){return r("option",{key:e.value,domProps:{value:e.value}},[e.value===t.allvalue?r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.search.all",expression:"'sdk.search.all'"}]}):r("span",[t._v(t._s(e.key))])])}),0)},e.staticRenderFns=[],e._scopeId="data-v-1269cb09"},{"app/constant":4,"core/i18n/i18n.service":13,"core/utils/utils":68,"gui/external/select2/options/autocomplete":119,mixins:343}],294:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),i=n(e("store/application-state")),a=n(e("gui/sidebar/eventbus")),o=n(e("services/sidebar")),s=e("core/i18n/i18n.service").t,r.default={name:"Sidebar",data:function(){return{components:o.default.state.components,panels:o.default.stack.state.contentsdata,bOpen:!0,bPageMode:!1,header:s("main navigation"),state:o.default.state}},computed:{title:function(){return this.state.gui.title},disabled:function(){return i.default.gui.sidebar.disabled},panelsinstack:function(){return 0<this.panels.length},showmainpanel:function(){return 0<this.components.length&&!this.panelsinstack},componentname:function(){return this.components.length?this.components.slice(-1)[0].getTitle():""},panelname:function(){var e="";return e=this.panels.length?this.panels.slice(-1)[0].content.getTitle():e}},methods:{closePanel:function(){o.default.closePanel()},closeAllPanels:function(){o.default.closeAllPanels()}},created:function(){this.iframe=i.default.iframe,a.default.$on("sidebaritemclick",function(){return $(".sidebar-toggle").click()})}},t.exports.__esModule&&(t.exports=t.exports.default);var i,a,o,s,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("aside",{staticClass:"main-sidebar",class:{iframe:e.iframe,"g3w-disabled":e.disabled}},[t("a",{staticClass:"sidebar-aside-toggle",attrs:{href:"#","data-toggle":"offcanvas",role:"button"}},[t("i",{class:e.g3wtemplate.getFontClass("bars")})]),e._v(" "),t("div",{staticClass:"sidebar",attrs:{id:"g3w-sidebar"}},[t("div",{attrs:{id:"disable-sidebar"}}),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.panelsinstack,expression:"panelsinstack"}],staticClass:"g3w-sidebarpanel"},[t("div",{staticStyle:{overflow:"hidden","line-height":"14px","font-size":"1.5em"},attrs:{id:"g3w-sidebarpanel-header-placeholder"}},[t("div",{staticStyle:{display:"flex"},style:{justifyContent:e.state.gui.title?"space-between":"flex-end"}},[e.title?t("h4",{directives:[{name:"t",rawName:"v-t",value:e.title,expression:"title"}],staticStyle:{display:"inline-block","font-weight":"bold"}}):e._e(),e._v(" "),t("div",[1<e.panels.length?t("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"back",expression:"'back'",modifiers:{create:!0}}],staticClass:"skin-tooltip-left g3w-span-button close-pane-button fa-stack",attrs:{"data-placement":"left","data-toggle":"tooltip"},on:{click:e.closePanel}},[t("i",{staticClass:"fa-stack-1x panel-button",class:e.g3wtemplate.getFontClass("circle")}),e._v(" "),t("i",{staticClass:"fa-stack-1x panel-icon",class:e.g3wtemplate.getFontClass("arrow-left")})]):e._e(),e._v(" "),t("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"close",expression:"'close'",modifiers:{create:!0}}],staticClass:"skin-tooltip-left g3w-span-button close-pane-button fa-stack",attrs:{"data-placement":"left","data-toggle":"tooltip"},on:{click:e.closeAllPanels}},[t("i",{staticClass:"fa-stack-1x panel-button",class:e.g3wtemplate.getFontClass("circle")}),e._v(" "),t("i",{staticClass:"fa-stack-1x panel-icon",class:e.g3wtemplate.getFontClass("close")})])])])]),e._v(" "),t("div",{staticClass:"g3w-sidebarpanel-placeholder",attrs:{id:"g3w-sidebarpanel-placeholder"}})]),e._v(" "),t("div",{attrs:{id:"g3w-sidebarcomponents-content"}},[t("ul",{directives:[{name:"show",rawName:"v-show",value:e.showmainpanel,expression:"showmainpanel"}],staticClass:"sidebar-menu",class:{"g3w-disabled":e.state.disabled},attrs:{id:"g3w-sidebarcomponents"}})])])])},e.staticRenderFns=[],e._scopeId="data-v-42a39db7"},{"core/i18n/i18n.service":13,"gui/sidebar/eventbus":180,"services/sidebar":369,"store/application-state":373}],295:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),i=n(e("gui/sidebar/eventbus")),e=n(e("components/SidebarItemAction.vue")),r.default={name:"SidebarItem",data:function(){return{info:this.$options.info||{state:null,style:null,class:null},main:!0,component:this.$options.component,active:!1,title:"",open:!1,icon:null,iconColor:null,collapsible:null}},components:{SidebarItemAction:e.default},methods:{onClickItem:function(e){var t=this;this.component.isolate&&e.stopPropagation(),this.component.isolate||(this.$options.service.state.components.forEach(function(e){e!==t.component&&e.getOpen()&&e.click({open:e.isolate})}),!this.component.collapsible&&isMobile.any&&i.default.$emit("sidebaritemclick")),this.component.setOpen(!this.component.state.open)}},created:function(){var e=this;this.component.openClose=function(){return e.$refs.anchor_click.click()}}},t.exports.__esModule&&(t.exports=t.exports.default);var i,r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("li",{directives:[{name:"show",rawName:"v-show",value:t.state.visible,expression:"state.visible"},{name:"disabled",rawName:"v-disabled",value:t.state.disabled,expression:"state.disabled"}],staticClass:"treeview sidebaritem",class:{active:t.open},attrs:{id:t.component.id}},[r("bar-loader",{attrs:{loading:t.state.loading}}),t._v(" "),r("a",{ref:"anchor_click",staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"},attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.onClickItem(e)}}},[r("div",[r("i",{class:t.icon,style:{color:t.iconColor}}),t._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:t.title,expression:"title"}],staticClass:"treeview-label"})]),t._v(" "),r("div",[t.info.state?r("span",{class:t.info.class,staticStyle:{position:"absolute",right:"5px","font-weight":"bold"},style:t.info.style,attrs:{title:t.info.tooltip}},[t._v(t._s(t.info.state))]):t._e(),t._v(" "),t._l(t.actions,function(e){return r("sidebar-item-action",{key:e.id,attrs:{component:t.component.internalComponent,action:e}})})],2),t._v(" "),t.collapsible?r("i",{staticClass:"pull-right",class:t.g3wtemplate.getFontClass("angle-left")}):t._e()]),t._v(" "),r("div",{attrs:{id:"g3w-sidebarcomponent-placeholder"}})],1)},r.staticRenderFns=[],r._scopeId="data-v-57cd13ea"},{"components/SidebarItemAction.vue":296,"gui/sidebar/eventbus":180}],296:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default={name:"Sidebaritemaction",props:{action:{type:Object,required:!0},component:{type:Object}},methods:{triggerAction:function(){this.action.fnc(this.component)}}},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var t=this,e=t.$createElement;return(t._self._c||e)("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:t.action.tooltip,expression:"action.tooltip",arg:"left",modifiers:{create:!0}}],staticClass:"action skin-tooltip-left",class:t.action.class,staticStyle:{"font-weight":"bold",padding:"3px"},style:t.action.style,on:{click:function(e){return e.stopPropagation(),t.triggerAction(e)}}})},r.staticRenderFns=[]},{}],297:[function(e,t,r){function n(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),e=(e=e=e("components/SpatialBookMarkItem.vue"))&&e.__esModule?e:{default:e},r.default={name:"spatial-bookmark-group",props:{group:{type:Object,required:!0}},components:{SpatialBookMarkItem:e.default},methods:{},mounted:(i=n(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default);var i,r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("li",[r("div",{staticStyle:{"font-weight":"bold",width:"100%"},style:{borderBottom:t.group.expanded?"2px solid #2c3b41":"none"},on:{click:function(e){e.stopPropagation(),t.group.expanded=!t.group.expanded}}},[r("span",{class:[t.g3wtemplate.getFontClass(t.group.expanded?"caret-down":"caret-right")],staticStyle:{"margin-right":"5px"}}),t._v(" "),r("span",[t._v(t._s(t.group.name))])]),t._v(" "),r("ul",{directives:[{name:"show",rawName:"v-show",value:t.group.expanded,expression:"group.expanded"}],staticStyle:{"margin-left":"10px"}},t._l(t.group.nodes,function(e){return r("spatial-book-mark-item",{attrs:{bookmark:e}})}),1)])},r.staticRenderFns=[],r._scopeId="data-v-44c60b5a"},{"components/SpatialBookMarkItem.vue":298}],298:[function(e,t,r){var a,n,i,o;e("vueify/lib/insert-css").insert(".spatial-bookmark[data-v-5372ee08]{display:flex;align-items:baseline;justify-content:space-between;padding:5px!important}");function s(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),l=e("services/gui"),a=(l=l)&&l.__esModule?l:{default:l},o=e("g3w-ol/projection/projections"),r.default={name:"spatial-bookmark-item",props:{bookmark:{type:Object,required:!0}},methods:{removeBookMark:function(){},gotoSpatialBookmark:(i=s(regeneratorRuntime.mark(function e(t){var r,n=t.extent,i=t.crs;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.default.getService("map").getEpsg().split("EPSG:")[1]!==i.epsg)return e.next=3,o.registerProjection("EPSG:"+i.epsg);e.next=5;break;case 3:r=e.sent,n=ol.proj.transformExtent(n,r,a.default.getService("map").getProjection());case 5:a.default.getService("map").zoomToExtent(n,{force:!0});case 6:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},mounted:(n=s(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default);var l="function"==typeof t.exports?t.exports.options:t.exports;l.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("li",{staticClass:"spatial-bookmark",on:{click:function(e){return e.stopPropagation(),t.gotoSpatialBookmark(t.bookmark)}}},[e("div",[e("span",{class:t.g3wtemplate.getFontClass("bookmark"),staticStyle:{"margin-right":"5px","font-size":"0.7em"}}),t._v(" "),e("span",{staticClass:"g3w-long-text"},[t._v(t._s(t.bookmark.name))])]),t._v(" "),t.bookmark.removable?e("span",{staticStyle:{color:"red",margin:"5px",cursor:"pointer"},on:{click:function(e){return e.stopPropagation(),t.$emit("remove-bookmark",t.bookmark.id)}}},[e("i",{class:t.g3wtemplate.getFontClass("trash")})]):t._e()])},l.staticRenderFns=[],l._scopeId="data-v-5372ee08"},{"g3w-ol/projection/projections":111,"services/gui":361,"vueify/lib/insert-css":1}],299:[function(e,t,r){var n,i,a,o,s,l,u,c,d,p,f;e("vueify/lib/insert-css").insert(".content-bookmarks{font-weight:700;color:#fff;padding:5px;border-bottom:2px solid #fff;margin-bottom:5px}.container.add-bookmark-input p.error-input-message{color:#fff}");function h(e){return e&&e.__esModule?e:{default:e}}function g(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),n=e("app/constant"),i=h(e("services/gui")),a=h(e("services/application")),o=h(e("store/projects")),s=h(e("components/SpatialBookMarkGroup.vue")),l=h(e("components/SpatialBookMarkItem.vue")),u=h(e("components/InputText.vue")),d=e("core/utils/utils").uniqueId,p=e("core/i18n/i18n.service").t,f=a.default.getLocalItem(n.LOCAL_ITEM_IDS.SPATIALBOOKMARKS.id),r.default={name:"spatial-bookmarks",components:{SpatialBookMarkGroup:s.default,SpatialBookMarkItem:l.default,InputText:u.default},data:function(){var e=o.default.getCurrentProject();return void 0===f[e.getId()]&&(f[e.getId()]=[]),{showaddform:!1,project:{bookmarks:e.getSpatialBookmarks()||[]},user:{bookmarks:f[e.getId()]},addbookmarkinput:{name:"add-bookmark",label:p("sdk.spatialbookmarks.input.name"),value:null,editable:!0,type:"varchar",input:{type:"text",options:{}},visible:!0,validate:{valid:!1,required:!0}}}},computed:{hasProjectbookmarks:function(){return 0<this.project.bookmarks.length}},methods:{addBookMark:function(){this.user.bookmarks.push({id:d(),name:this.addbookmarkinput.value,extent:i.default.getService("map").getMapExtent(),removable:!0,crs:{epsg:+i.default.getService("map").getCrs().split("EPSG:")[1]}}),this.saveUserBookMarks(),this.showaddform=!1},removeBookMark:function(t){this.user.bookmarks=this.user.bookmarks.filter(function(e){return e.id!==t}),this.saveUserBookMarks()},saveUserBookMarks:function(){f[o.default.getCurrentProject().getId()]=this.user.bookmarks,a.default.setLocalItem({id:n.LOCAL_ITEM_IDS.SPATIALBOOKMARKS.id,data:f})},showAddForm:function(){this.addbookmarkinput.value=null,this.showaddform=!0}},created:function(){var e=this;this.$on("close",function(){e.showaddform=!1})},mounted:(c=g(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)})),function(){return c.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ul",{staticClass:"treeview-menu g3w-spatial-bookmarks menu-items",class:{"g3w-tools":!t.showaddform},attrs:{id:"g3w-spatial-bookmarks"}},[t.showaddform?[r("li",[r("div",{staticStyle:{display:"flex","justify-content":"end"}},[r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"close",expression:"'close'",arg:"left",modifiers:{create:!0}}],staticClass:"sidebar-button sidebar-button-icon",class:t.g3wtemplate.getFontClass("close"),staticStyle:{padding:"5px",margin:"3px"},on:{click:function(e){e.stopPropagation(),t.showaddform=!1}}})]),t._v(" "),r("helpdiv",{attrs:{message:"sdk.spatialbookmarks.helptext"}}),t._v(" "),r("div",{staticClass:"container add-bookmark-input",staticStyle:{padding:"5px",width:"100%"}},[r("input-text",{attrs:{state:t.addbookmarkinput}})],1),t._v(" "),r("div",{staticStyle:{"margin-top":"5px"}},[r("button",{directives:[{name:"t",rawName:"v-t",value:"add",expression:"'add'"},{name:"disabled",rawName:"v-disabled",value:!t.addbookmarkinput.validate.valid,expression:"!addbookmarkinput.validate.valid"}],staticClass:"sidebar-button-run btn btn-block",on:{click:function(e){return e.stopPropagation(),t.addBookMark(e)}}})])],1)]:[t.hasProjectbookmarks?[r("div",{staticClass:"content-bookmarks"},[r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.spatialbookmarks.sections.project.title",expression:"'sdk.spatialbookmarks.sections.project.title'"}]})]),t._v(" "),t._l(t.project.bookmarks,function(e){return[e.nodes?r("spatial-book-mark-group",{attrs:{group:e}}):r("spatial-book-mark-item",{attrs:{bookmark:e}})]})]:t._e(),t._v(" "),r("div",{staticClass:"content-bookmarks",staticStyle:{display:"flex","justify-content":"space-between","align-items":"center","margin-top":"10px"}},[r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.spatialbookmarks.sections.user.title",expression:"'sdk.spatialbookmarks.sections.user.title'"}],staticStyle:{"font-weight":"bold",color:"#ffffff"}}),t._v(" "),r("span",{staticClass:"sidebar-button sidebar-button-icon",class:t.g3wtemplate.getFontClass("plus"),staticStyle:{padding:"5px",cursor:"pointer"},on:{click:function(e){return e.stopPropagation(),t.showAddForm(e)}}})]),t._v(" "),t._l(t.user.bookmarks,function(e){return r("spatial-book-mark-item",{attrs:{bookmark:e},on:{"remove-bookmark":t.removeBookMark}})})]],2)},e.staticRenderFns=[]},{"app/constant":4,"components/InputText.vue":249,"components/SpatialBookMarkGroup.vue":297,"components/SpatialBookMarkItem.vue":298,"core/i18n/i18n.service":13,"core/utils/utils":68,"services/application":351,"services/gui":361,"store/projects":379,"vueify/lib/insert-css":1}],300:[function(e,t,r){e("vueify/lib/insert-css").insert("#streetview-error-key[data-v-1ee8ab3d]{display:flex;justify-content:center;align-items:center;font-weight:700;height:100%;padding:10px;background-color:#fff}");Object.defineProperty(r,"__esModule",{value:!0}),r.default={name:"streetview",data:function(){return{state:null}}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this.$createElement,e=this._self._c||e;return e("div",{attrs:{id:"streetview"}},[this.$options.keyError?e("div",{attrs:{id:"streetview-error-key"}},[e("span",{staticClass:"skin-color"},[this._v(" "+this._s(this.$options.keyError))])]):this._e()])},e.staticRenderFns=[],e._scopeId="data-v-1ee8ab3d"},{"vueify/lib/insert-css":1}],301:[function(e,t,r){var a,n,s,o,l,u,i,c,d,p,f,h,g,v,m;e("vueify/lib/insert-css").insert(".geometry[data-v-7c2ed9e9]{cursor:pointer}#noheaders[data-v-7c2ed9e9]{background-color:#fff;font-weight:700;margin-top:10px}");function y(e){return e&&e.__esModule?e:{default:e}}function _(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n=y(e("components/TableBody.vue")),s=y(e("components/TableSelectRow.vue")),o=y(e("components/TableToolbar.vue")),l=y(e("components/FieldG3W.vue")),u=y(e("services/gui")),i=e("mixins"),h=e("core/utils/utils").debounce,g=void 0,v=[],m={pagination:{},nopagination:{}},r.default={name:"G3WTable",mixins:[i.resizeMixin],data:function(){return{tableBodyComponent:null,state:null,table:null,selectedRow:null}},components:{TableBody:n.default},methods:{getDataFromBBOX:function(){this.$options.service.getDataFromBBOX()},toggleFilterToken:function(){this.$options.service.toggleFilterToken()},clearAllSelection:function(){this.$options.service.clearLayerSelection()},switchSelection:function(){this.$options.service.switchSelection()},selectAllRow:function(){this.state.features.length&&this.$options.service.selectAllFeatures()},_setLayout:function(){this.$options.service._setLayout()},zoomAndHighLightFeature:(f=_(regeneratorRuntime.mark(function e(t){var r=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.geometry?(this.$options.service.zoomAndHighLightFeature(t,r),e.next=6):e.next=4;break;case 4:return e.next=6,this.$options.service.zoomAndHighLightGeometryRelationFeatures(t,r);case 6:case"end":return e.stop()}},e,this)})),function(e){return f.apply(this,arguments)}),addRemoveSelectedFeature:function(e){this.$options.service.addRemoveSelectedFeature(e)},reloadLayout:(p=_(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:g&&g.columns.adjust();case 3:case"end":return e.stop()}},e,this)})),function(){return p.apply(this,arguments)}),hasHeaders:function(){return!!this.state.headers.length},createdContentBody:function(){var o=this;v=v.filter(function(e){return e.$destroy(),!1}),g.rows().nodes().each(function(i,e){var a,t;$(i).css("cursor","pointer"),o.state.features.length&&(a=o.state.features[e],t=!!a.geometry,$(i).addClass("feature_attribute"),a.selected&&$(i).addClass("selected"),$(i).on("click",function(){return t&&o.zoomAndHighLightFeature(a)}),$(i).on("mouseover",function(){return t&&o.zoomAndHighLightFeature(a,!1)}),$(i).children().each(function(e,t){var r,e=o.state.headers[e],n=void 0,n=(null===e?((r=new(Vue.extend(s.default))({propsData:{feature:a}})).$on("selected",function(e){return o.$options.service.addRemoveSelectedFeature(e)}),o.$watch(function(){return a.selected},function(e){e?$(i).addClass("selected"):$(i).removeClass("selected")}),r.$mount()):((r=new(Vue.extend(l.default))({propsData:{state:{value:a.attributes[e.name]}}})).$mount(),v.push(r),r)).$el;$(t).html(n)}))}),setTimeout(function(){return o.reloadLayout()},0)},resize:(d=_(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:t=$(".content").height(),r=$("#open_attribute_table  div.dataTables_scrollHeadInner").height(),$("#open_attribute_table  div.dataTables_scrollBody").height(t-r-130);case 5:case"end":return e.stop()}},e,this)})),function(){return d.apply(this,arguments)})},beforeCreate:function(){this.delayType="debounce"},mounted:(c=_(regeneratorRuntime.mark(function e(){var n,t,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setContentKey=u.default.onafter("setContent",this.resize),n=function(){$(".dataTables_info, .dataTables_length").hide(),$(".dataTables_paginate").css({display:"flex","justify-content":"space-between","font-size":"0.8em","margin-top":"5px"}),$(".dataTables_filter").css("float","right"),$(".dataTables_paginate").css("margin","0")},e.next=4,this.$nextTick();case 4:this.first=!1,t={lengthMenu:this.state.pageLengths,pageLength:this.state.pageLength,scrollX:!0,processing:!1,scrollCollapse:!0,sSearch:!1,order:[1,"asc"],dom:'l<"#g3w-table-toolbar">frtip',columnDefs:[{targets:0,orderable:!1,searchable:!1,width:"1%"}]},this.state.pagination?(g=$(this.$refs.attribute_table).DataTable(a({},t,{columns:this.state.headers,ajax:h(function(e,r){var t;$("#open_attribute_table table tr").each(function(e){$(e).off("click"),$(e).off("mouseover")}),i.$options.service.getData(e).then((t=_(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r(t),e.next=3,i.$nextTick();case 3:i.createdContentBody(),i.isMobile()&&n();case 5:case"end":return e.stop()}},e,i)})),function(e){return t.apply(this,arguments)})).catch(function(e){})},800),serverSide:!0,deferLoading:this.state.allfeatures})),this.$options.service.on("ajax-reload",g.ajax.reload),this.changeColumn=h(function(){var r=_(regeneratorRuntime.mark(function e(t,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:g.columns(r).search(t.target.value.trim()).draw();case 1:case"end":return e.stop()}},e,i)}));return function(e,t){return r.apply(this,arguments)}}())):(g=$(this.$refs.attribute_table).DataTable(a({},t,{searchDelay:600})),t=h(function(){i.$options.service.setFilteredFeature(g.rows({search:"applied"})[0])},600),m.nopagination["search.dt"]=t,g.on("search.dt",t),g.on("length.dt",function(e,t,r){i.$options.service.setAttributeTablePageLength(r)}),this.changeColumn=h(function(){var r=_(regeneratorRuntime.mark(function e(t,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:g.columns(r).search(t.target.value.trim()).draw(),i.$options.service.setFilteredFeature(g.rows({search:"applied"})[0]);case 2:case"end":return e.stop()}},e,i)}));return function(e,t){return r.apply(this,arguments)}}())),this.isMobile()&&n(),t=Vue.extend(o.default),t=new t({propsData:{tools:this.state.tools,geolayer:this.state.geolayer,switchSelection:this.switchSelection,clearAllSelection:this.clearAllSelection,toggleFilterToken:this.toggleFilterToken,getDataFromBBOX:this.getDataFromBBOX}}),$("#g3w-table-toolbar").html(t.$mount().$el),this.$options.service.on("redraw",function(e){g.clear(),g.draw(!1),setTimeout(function(){g.rows.add(e),g.draw(!1),i.createdContentBody(),i.isMobile()&&n()})});case 12:case"end":return e.stop()}},e,this)})),function(){return c.apply(this,arguments)}),beforeDestroy:function(){this.$options.service.clear(),this.$options.service.off("ajax-reload"),this.$options.service.off("redraw"),u.default.un("setContent",this.setContentKey),g.destroy(!0),g=null}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("div",{staticStyle:{"margin-top":"5px"},attrs:{id:"open_attribute_table"}},[r.hasHeaders()?n("table",{ref:"attribute_table",staticClass:"table table-striped row-border compact nowrap",staticStyle:{width:"100%"},attrs:{id:"layer_attribute_table"}},[n("thead",[n("tr",[n("th"),r._v(" "),r._l(r.state.headers,function(e,t){return 0<t?n("th",[n("input",{staticClass:"form-control column-search",staticStyle:{height:"25px","min-width":"40px",padding:"2px"},attrs:{type:"text",placeholder:e.name},on:{keyup:function(e){return r.changeColumn(e,t)}}})]):r._e()})],2),r._v(" "),n("tr",r._l(r.state.headers,function(e,t){return n("th",[n("span",0===t?[n("input",{staticClass:"magic-checkbox",attrs:{type:"checkbox",id:"attribute_table_select_all_rows",disabled:r.state.nofilteredrow||0===r.state.features.length},domProps:{checked:r.state.selectAll}}),r._v(" "),n("label",{staticStyle:{"margin-bottom":"0 !important"},attrs:{for:"attribute_table_select_all_rows"},on:{"!click":function(e){return e.stopPropagation(),e.preventDefault(),r.selectAllRow(e)}}},[n("span",{staticStyle:{padding:"5px"}})])]:[r._v(r._s(e.label))])])}),0)]),r._v(" "),n("table-body",{attrs:{headers:r.state.headers,filter:r.state.tools.filter,features:r.state.features,addRemoveSelectedFeature:r.addRemoveSelectedFeature,zoomAndHighLightFeature:r.zoomAndHighLightFeature}})],1):n("div",{directives:[{name:"t",rawName:"v-t",value:"dataTable.no_data",expression:"'dataTable.no_data'"}],attrs:{id:"noheaders"}})])},e.staticRenderFns=[],e._scopeId="data-v-7c2ed9e9"},{"components/FieldG3W.vue":206,"components/TableBody.vue":302,"components/TableSelectRow.vue":303,"components/TableToolbar.vue":304,"core/utils/utils":68,mixins:343,"services/gui":361,"vueify/lib/insert-css":1}],302:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),i=n(e("components/TableSelectRow.vue")),e=n(e("components/FieldG3W.vue")),r.default={name:"table-body",props:{headers:{required:!0,type:Array},features:{required:!0,type:Array},zoomAndHighLightFeature:{type:Function},addRemoveSelectedFeature:{type:Function},filter:{type:Object,default:{active:!1}}},data:function(){return{selectedRow:null}},components:{Field:e.default,SelectRow:i.default},methods:{getField:function(e,t){return{value:e.attributes[t.name],label:void 0}}}},t.exports.__esModule&&(t.exports=t.exports.default);var i,r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var n=this,e=n.$createElement,i=n._self._c||e;return i("tbody",{attrs:{id:"table_body_attributes"}},n._l(n.features,function(r,e){return i("tr",{key:r.id,staticClass:"feature_attribute",class:[e%2==1?"odd":"pair",{geometry:!!r.geometry},{selected:r.selected}],staticStyle:{cursor:"pointer"},attrs:{role:"row",selected:n.selectedRow===e},on:{mouseover:function(e){return n.zoomAndHighLightFeature(r,!1)},click:function(e){return n.zoomAndHighLightFeature(r,!0)}}},n._l(n.headers,function(e,t){return i("td",{attrs:{"tab-index":1}},[0===t?i("select-row",{attrs:{feature:r},on:{selected:n.addRemoveSelectedFeature}}):i("field",{attrs:{feature:r,state:n.getField(r,e)}})],1)}),0)}),0)},r.staticRenderFns=[],r._scopeId="data-v-4367c62b"},{"components/FieldG3W.vue":206,"components/TableSelectRow.vue":303}],303:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),n=e("core/utils/utils").getUniqueDomId,r.default={name:"select-row",props:{feature:{required:!0}},data:function(){return{id:n()}},methods:{select:function(){this.$emit("selected",this.feature)}},destroyed:function(){this.$off("selected")}},t.exports.__esModule&&(t.exports=t.exports.default);var n,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("span",[e("input",{staticClass:"magic-checkbox",attrs:{type:"checkbox",id:t.id},domProps:{checked:t.feature.selected}}),t._v(" "),e("label",{attrs:{for:t.id},on:{"!click":function(e){return e.stopPropagation(),e.preventDefault(),t.select(e)}}},[e("span")])])},e.staticRenderFns=[],e._scopeId="data-v-709a9af6"},{"core/utils/utils":68}],304:[function(e,t,r){e("vueify/lib/insert-css").insert(".action-button[data-v-3490dc02]{padding:4px}.action-button.toggled[data-v-3490dc02]{border:1px solid #ccc}");Object.defineProperty(r,"__esModule",{value:!0}),e=e("store/application-state"),n=(e=e)&&e.__esModule?e:{default:e},r.default={name:"g3w-table-toolbar",props:{tools:{type:Object},switchSelection:{type:Function},clearAllSelection:{type:Function},toggleFilterToken:{type:Function},getDataFromBBOX:{type:Function}},computed:{disableMapTool:function(){return!this.tools.geolayer.active&&n.default.gui.layout[n.default.gui.layout.__current].rightpanel.height_100}}},t.exports.__esModule&&(t.exports=t.exports.default);var n,e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",{staticStyle:{display:"flex","justify-content":"space-between",padding:"1px"}},[t.tools.geolayer.show?e("div",{directives:[{name:"disabled",rawName:"v-disabled",value:t.disableMapTool,expression:"disableMapTool"},{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"layer_selection_filter.tools.show_features_on_map",expression:"'layer_selection_filter.tools.show_features_on_map'",modifiers:{create:!0}}],staticClass:"skin-color action-button skin-tooltip-right",class:[t.g3wtemplate.getFontClass("map"),t.tools.geolayer.active?"toggled":""],attrs:{"data-placement":"right","data-toggle":"tooltip"},on:{click:function(e){return e.stopPropagation(),t.getDataFromBBOX(e)}}}):t._e(),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.tools.show,expression:"tools.show"},{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"layer_selection_filter.tools.clear",expression:"'layer_selection_filter.tools.clear'",modifiers:{create:!0}}],staticClass:"skin-color action-button skin-tooltip-right",class:t.g3wtemplate.getFontClass("clear"),attrs:{"data-placement":"right","data-toggle":"tooltip"},on:{click:function(e){return e.stopPropagation(),t.clearAllSelection(e)}}}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.tools.show,expression:"tools.show"},{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"layer_selection_filter.tools.invert",expression:"'layer_selection_filter.tools.invert'",modifiers:{create:!0}}],staticClass:"skin-color action-button skin-tooltip-right",class:[t.g3wtemplate.getFontClass("invert"),t.tools.filter.active?"g3w-disabled":""],attrs:{"data-placement":"right","data-toggle":"tooltip"},on:{click:function(e){return e.stopPropagation(),t.switchSelection(e)}}}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.tools.show,expression:"tools.show"},{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"layer_selection_filter.tools.filter",expression:"'layer_selection_filter.tools.filter'",modifiers:{create:!0}}],staticClass:"skin-color action-button skin-tooltip-right",class:[t.g3wtemplate.getFontClass("filter"),t.tools.filter.active?"toggled":""],attrs:{"data-placement":"right","data-toggle":"tooltip"},on:{click:function(e){return e.stopPropagation(),t.toggleFilterToken(e)}}})])},e.staticRenderFns=[],e._scopeId="data-v-3490dc02"},{"store/application-state":373,"vueify/lib/insert-css":1}],305:[function(e,t,r){var n,i,a,o;e("vueify/lib/insert-css").insert(".tool_disabled[data-v-303c314d]{cursor:not-allowed}.tool_disabled>span[data-v-303c314d]{color:#777}");function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),n=s(e("services/application")),i=s(e("services/gui")),a=n.default.getState(),o={alert:{color:"red"},info:{color:"blue"},warning:{color:"orange"}},r.default={name:"g3w-tool",props:{tool:{required:!0}},data:function(){return{}},methods:{fireAction:function(e){this.tool.action(e)},showToolStateMessage:function(){i.default.showModalDialog({title:this.tool.state.type.toUpperCase(),message:this.tool.state.message})}},computed:{disabled:function(){return!this.tool.offline&&!a.online||this.tool.loading||this.tool.disabled},icon:function(){return this.tool.icon||"caret-right"},toolstatecolor:function(){return o[this.tool.state.type].color}}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var a=this,e=a.$createElement,e=a._self._c||e;return e("div",["checkbox"===a.tool.type?e("div",{staticClass:"checkbox"},[e("label",[e("input",{directives:[{name:"model",rawName:"v-model",value:a.tool.isCheck,expression:"tool.isCheck"}],staticStyle:{cursor:"pointer"},attrs:{id:a.tool.layerName,type:"checkbox"},domProps:{value:a.tool.layerName,checked:Array.isArray(a.tool.isCheck)?-1<a._i(a.tool.isCheck,a.tool.layerName):a.tool.isCheck},on:{click:function(e){return a.fireAction(a.tool)},change:function(e){var t,r,n=a.tool.isCheck,e=e.target,i=!!e.checked;Array.isArray(n)?(t=a.tool.layerName,r=a._i(n,t),e.checked?r<0&&a.$set(a.tool,"isCheck",n.concat([t])):-1<r&&a.$set(a.tool,"isCheck",n.slice(0,r).concat(n.slice(r+1)))):a.$set(a.tool,"isCheck",i)}}}),a._v("\n      "+a._s(a.tool.name)+"\n    ")])]):e("div",{staticClass:"tool",class:{tool_disabled:a.disabled},staticStyle:{position:"relative"},on:{click:function(e){a.disabled||a.fireAction(a.tool)}}},[e("bar-loader",{attrs:{loading:a.tool.loading}}),a._v(" "),e("i",{class:a.g3wtemplate.getFontClass(a.icon)}),a._v(" "),a.tool.html?e("span",[e("i",{class:a.tool.html.icon}),a._v("\n      "+a._s(a.tool.html.text||a.tool.name)+"\n    ")]):e("span",{directives:[{name:"t",rawName:"v-t",value:a.tool.name,expression:"tool.name"}]}),a._v(" "),a.tool.state.type?e("span",{staticStyle:{cursor:"pointer","vertical-align":"center",position:"absolute",right:"0",top:"0",padding:"5px"},style:{color:a.toolstatecolor},on:{click:function(e){return e.stopPropagation(),a.showToolStateMessage(e)}}},[e("i",{class:a.g3wtemplate.getFontClass(a.tool.state.type)})]):a._e()],1)])},e.staticRenderFns=[],e._scopeId="data-v-303c314d"},{"services/application":351,"services/gui":361,"vueify/lib/insert-css":1}],306:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),e=(e=e=e("components/Tool.vue"))&&e.__esModule?e:{default:e},r.default={name:"g3w-tools",data:function(){return{state:null}},watch:{"state.toolsGroups":{handler:function(e){this.$emit("visible",0<e.length)}}},components:{G3wTool:e.default}},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ul",{staticClass:"g3w-tools treeview-menu"},[r("bar-loader",{attrs:{loading:t.state.loading}}),t._v(" "),t._l(t.state.toolsGroups,function(e){return r("li",{key:e.name},[r("div",{staticClass:"tool-header"},[r("i",{class:t.g3wtemplate.getFontClass("tool")}),t._v(" "),r("span",{},[t._v(t._s(e.name))])]),t._v(" "),r("div",{staticClass:"tool-box",attrs:{id:e.name+"-tools"}},t._l(e.tools,function(e){return r("g3w-tool",{key:e.name,attrs:{tool:e}})}),1)])})],2)},r.staticRenderFns=[]},{"components/Tool.vue":305}],307:[function(e,t,r){var s,l,n,i,a,u,c;e("vueify/lib/insert-css").insert(".usermessage-content[data-v-ff9caad2]{color:#fff;z-index:1000;position:absolute;line-height:normal;padding:3px;min-width:250px;box-shadow:0 3px 5px rgba(0,0,0,.3);-moz-box-shadow:0 3px 5px rgba(0,0,0,.3)}.usermessage-content.mobile[data-v-ff9caad2]{padding:0;min-width:100%}.usermessage-header-content[data-v-ff9caad2]{display:flex;align-items:baseline;justify-content:space-between;width:100%}.usermessage-header-icontype[data-v-ff9caad2]{padding:10px 0 0 5px;font-weight:700;font-size:1.3em}.usermessage-content.mobile .usermessage-header-icontype[data-v-ff9caad2]{padding:0 0 0 5px;font-size:1.1em}.usermessage-header-title[data-v-ff9caad2],.usermessage-header-title h4[data-v-ff9caad2]{font-weight:700;text-align:center}.usermessage-content.mobile .usermessage-header-title h4[data-v-ff9caad2]{margin:0}.usermessage-header-subtitle[data-v-ff9caad2]{font-weight:700;margin:5px}.usermessage-header-right[data-v-ff9caad2]{padding:5px}.usermessage-header-right-item[data-v-ff9caad2]{font-weight:700!important;font-size:1.2em;cursor:pointer}.usermessage-message[data-v-ff9caad2]{width:100%;padding:0 0 3px 10px;max-height:100px;font-size:1.1em;align-self:flex-start;overflow-y:auto}");function o(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},n=e("app/constant"),e=e("services/gui"),i=(e=e)&&e.__esModule?e:{default:e},u={success:{backgroundColor:"#62ac62",color:"#FFFFFF"},info:{backgroundColor:"#44a0bb",color:"#FFFFFF"},warning:{backgroundColor:"#f29e1d",color:"#FFFFFF"},alert:{backgroundColor:"#c34943",color:"#FFFFFF"},tool:{backgroundColor:"#FFFFFF",color:"#222d32"},loading:{backgroundColor:"#FFFFFF",color:"#222d32",fontWeight:"bold"}},c={success:{},info:{},warning:{},alert:{},tool:{"z-index":n.ZINDEXES.usermessage.tool,left:"40px"},loading:{}},r.default={name:"usermessage",props:{id:{},type:{type:String,default:"info"},title:{type:String,default:null},subtitle:{type:String,default:null},position:{type:String,default:"top"},size:{type:String,default:"fullpage"},message:{type:String,default:""},textMessage:{type:Boolean,default:!1},autoclose:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},duration:{type:Number,default:2e3},closable:{type:Boolean,default:!0}},computed:{showheader:function(){return"loading"!==this.type}},methods:{addClassMobile:function(){return this.isMobile()&&!i.default.isSidebarVisible()},closeUserMessage:function(){this.$emit("close-usermessage")},hideShow:function(){}},created:function(){var e,t,r,n=this.position.split("-"),n=l(n,2),i=n[0],n=n[1],a="100%";switch(this.size){case"small":a="25%";break;case"medium":a="50%";break;default:a="100%"}var i="center"===i?{top:0,bottom:0,maxHeight:"20%"}:(r=50,(t=i)in(e={})?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e),o=s({},i,{width:a});if(n)switch(o.width="25%",n){case"center":o.left="0",o.right="0",o.margin="auto";break;case"right":o.right=0}this.style=s({},u[this.type],o,c[this.type])},mounted:(a=o(regeneratorRuntime.mark(function e(){var t,r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.autoclose)return e.next=3,this.$nextTick();e.next=4;break;case 3:t=setTimeout(function(){r.closeUserMessage(),clearTimeout(t)},this.duration);case 4:case"end":return e.stop()}},e,this)})),function(){return a.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var e=this,t=e.$createElement,t=e._self._c||t;return t("div",{staticClass:"usermessage-content",class:{mobile:e.addClassMobile()},style:e.style,attrs:{id:e.id}},[e.showheader?t("div",{staticClass:"usermessage-header-content"},[t("i",{staticClass:"usermessage-header-icontype",class:e.g3wtemplate.getFontClass(e.type)}),e._v(" "),t("div",{staticClass:"usermessage-header-title"},[e._t("header",[e.title?t("h4",{directives:[{name:"t",rawName:"v-t",value:e.title,expression:"title"}]}):t("h4",[e._v(" "+e._s(e.type.toUpperCase()))]),e._v(" "),e.subtitle?t("h5",{directives:[{name:"t",rawName:"v-t",value:e.subtitle,expression:"subtitle"}],staticClass:"usermessage-header-subtitle"}):e._e()])],2),e._v(" "),t("div",{staticClass:"usermessage-header-right"},[!e.autoclose&&e.closable?t("div",{on:{click:e.closeUserMessage}},[t("i",{staticClass:"usermessage-header-right-item",class:e.g3wtemplate.getFontClass("close")})]):e._e()])]):e._e(),e._v(" "),e._t("body",[e.textMessage?t("div",{staticClass:"usermessage-message"},[e._v(e._s(e.message))]):t("div",{directives:[{name:"t",rawName:"v-t",value:e.message,expression:"message"}],staticClass:"usermessage-message"})]),e._v(" "),e._t("footer")],2)},e.staticRenderFns=[],e._scopeId="data-v-ff9caad2"},{"app/constant":4,"services/gui":361,"vueify/lib/insert-css":1}],308:[function(e,t,r){var n,i,a,o,s,l,u,c;e("vueify/lib/insert-css").insert(".content_breadcrumb[data-v-209fb2db]{font-size:1.2em;padding:0 3px;border-radius:3px}");function d(e){return e&&e.__esModule?e:{default:e}}function p(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(r,"__esModule",{value:!0}),i=d(e("components/UserMessage.vue")),a=d(e("components/NotifyOnline.vue")),o=d(e("components/NotifyDownload.vue")),s=d(e("components/NotifyPlugins.vue")),l=e("app/constant"),u=d(e("services/viewport")),c=d(e("services/gui")),r.default={name:"Viewport",props:{appState:{type:Object}},components:{userMessage:i.default,onlineNotify:a.default,downloadNotify:o.default,pluginsNotify:s.default},data:function(){return{state:u.default.state,updatePreviousTitle:!1,media:{matches:!0}}},computed:{breadcrumb:function(){return this.state.content.contentsdata.filter(function(e){return e.options.crumb}).map(function(e){return e.options.crumb})},showresize:function(){var e=u.default.getCurrentContentLayout()["h"===this.state.split?"width":"height"];return this.state.resized.start&&0<this.state.secondaryPerc&&this.state.secondaryPerc<100&&e<100&&0<e},showresizeicon:function(){return 100!==this.state.secondaryPerc},hooks:function(){return this.usermessage.hooks},usermessage:function(){return this.state.usermessage},showtitle:function(){var e=!0,t=this.state.content.contentsdata;return e=t.length&&(t=t[t.length-1].options,_.isBoolean(t.showtitle))?t.showtitle:e},showContent:function(){return this.state.content.show},styles:function(){return{map:{width:this.state.map.sizes.width+"px",height:this.state.map.sizes.height+"px"},content:{width:this.state.content.sizes.width+"px",height:this.state.content.sizes.height+"px",zIndex:l.ZINDEXES.usermessage.tool+1,minHeight:"v"===this.state.split?l.VIEWPORT.resize.content.min+"px":null}}},contentTitle:function(){var e=this.state.content.contentsdata;if(e.length)return{title:(e=e[e.length-1].options).title,post_title:e.post_title}},backOrBackTo:function(){var e=this.state.content.contentsdata;return!!(1<e.length&&this.state.content.showgoback)&&(e[e.length-2].options.title?"backto":"back")},previousTitle:function(){var e=this,t=this.state.content.contentsdata,t=1<t.length&&this.state.content.showgoback?t[t.length-2].options.title:null;return this.updatePreviousTitle=!0,this.$nextTick(function(){return e.updatePreviousTitle=!1}),t}},methods:{isNotLastCrumb:function(e){return e<this.breadcrumb.length-1},closeContent:function(){c.default.closeContent()},closeMap:function(){u.default.closeMap()},gotoPreviousContent:function(){c.default.popContent()},closeUserMessage:function(){c.default.closeUserMessage()},moveFnc:function(e){var t="h"===this.state.split?"width":"height",r=(e.preventDefault(),"width"==t?$(".sidebar-collapse").length?0:u.default.SIDEBARWIDTH:$("#main-navbar").height()),n=$(this.$el)[t](),e=("width"==t?e.pageX+2:e.pageY+2)-r,r=(e>n-l.VIEWPORT.resize.content.min?e=n-l.VIEWPORT.resize.content.min:e<l.VIEWPORT.resize.map.min&&(e=l.VIEWPORT.resize.map.min),n-e),n=100-Math.round(e/n*100);u.default.resizeViewComponents(this.state.split,{map:f({},t,e),content:f({},t,r)},n)}},mounted:(n=p(regeneratorRuntime.mark(function e(){var t,r,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=function(){n.state.resized.start=!0},e.next=3,this.$nextTick();case 3:r=window.matchMedia("(min-height: 300px)"),this.media.matches=r.matches,r.addListener(function(e){"change"===e.type&&(n.media.matches=e.currentTarget.matches)}),t();case 7:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var r=this,e=r.$createElement,n=r._self._c||e;return n("div",{staticClass:"g3w-viewport"},[n("transition",{attrs:{name:"fade",duration:{enter:500,leave:500}}},[r.usermessage.show?n("user-message",{attrs:{title:r.usermessage.title,subtitle:r.usermessage.subtitle,id:r.usermessage.id,message:r.usermessage.message,draggable:r.usermessage.draggable,closable:r.usermessage.closable,duration:r.usermessage.duration,position:r.usermessage.position,autoclose:r.usermessage.autoclose,textMessage:r.usermessage.textMessage,size:r.usermessage.size,type:r.usermessage.type},on:{"close-usermessage":r.closeUserMessage}},[r.hooks.header?n("template",{slot:"header"},[n(r.hooks.header,{tag:"component"})],1):r._e(),r._v(" "),r.hooks.body?n("template",{slot:"body"},[n(r.hooks.body,{tag:"component"})],1):r._e(),r._v(" "),r.hooks.footer?n("template",{slot:"footer"},[n(r.usermessage.hooks.footer,{tag:"component"})],1):r._e()],2):r._e()],1),r._v(" "),n("div",{staticClass:"g3w-view map",class:"split-"+r.state.split,style:r.styles.map,attrs:{id:"g3w-view-map"}},[n("g3w-resize",{class:"split-"+r.state.split,style:{backgroundColor:"transparent"},attrs:{id:"resize-map-and-content",show:r.showresize,moveFnc:r.moveFnc,orientation:r.state.split}}),r._v(" "),n("div",{attrs:{id:"application-notifications"}},[n("online-notify"),r._v(" "),n("download-notify"),r._v(" "),n("plugins-notify")],1)],1),r._v(" "),n("div",{directives:[{name:"disabled",rawName:"v-disabled",value:r.state.content.disabled,expression:"state.content.disabled"}],staticClass:"g3w-view content",class:"split-"+r.state.split,style:r.styles.content,attrs:{id:"g3w-view-content"}},[1<r.breadcrumb.length?n("section",{ref:r.breadcrumb,staticClass:"content_breadcrumb"},r._l(r.breadcrumb,function(e,t){return n("span",{key:e.title},[n("span",{directives:[{name:"t",rawName:"v-t",value:e.title,expression:"crumb.title"}],staticClass:"skin-color-dark",style:{fontWeight:r.isNotLastCrumb(t)?"bold":"normal"}}),r._v(" "),r.isNotLastCrumb(t)?n("span",{staticStyle:{"font-weight":"bold",margin:"3px 0"}},[r._v("/")]):r._e()])}),0):r._e(),r._v(" "),r.showtitle&&r.contentTitle||r.previousTitle||r.state.content.closable&&r.state.content.aside?n("div",{staticClass:"close-panel-block",staticStyle:{display:"flex","justify-content":"space-between"}},[r.previousTitle?n("div",{staticClass:"g3w_contents_back g3w-long-text"},["back"===r.backOrBackTo?n("div",{class:r.backOrBackTo},[n("span",{staticClass:"action-button",class:r.g3wtemplate.getFontClass("back")}),r._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"back",expression:"'back'"}]})]):n("div",{class:r.backOrBackTo,on:{click:function(e){return e.stopPropagation(),r.gotoPreviousContent()}}},[n("span",{staticClass:"action-button",class:r.g3wtemplate.getFontClass("back")}),r._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:"backto",expression:"'backto'"}]}),r._v(" "),r.updatePreviousTitle?r._e():n("span",{directives:[{name:"t",rawName:"v-t",value:r.previousTitle,expression:"previousTitle"}]})])]):r._e(),r._v(" "),!r.previousTitle&&r.showtitle&&r.contentTitle?n("div",{staticClass:"panel-title",class:{mobile:r.isMobile()},style:[r.state.content.style.title]},[n("span",{attrs:{id:"contenttitle"}},[n("span",{directives:[{name:"t",rawName:"v-t",value:r.contentTitle.title,expression:"contentTitle.title"}]}),r._v(" "),n("span",{directives:[{name:"t",rawName:"v-t",value:r.contentTitle.post_title,expression:"contentTitle.post_title"}]})])]):r._e(),r._v(" "),n("div",{staticClass:"g3-content-header-action-tools",staticStyle:{display:"flex"}},[r._l(r.state.content.headertools,function(e){return n(e,{tag:"component"})}),r._v(" "),r.showresizeicon?n("resize-icon",{staticStyle:{"font-size":"1em",padding:"0","align-self":"center","margin-left":"auto"},style:{marginRight:r.state.content.closable?"5px":"0px"},attrs:{type:r.state.split}}):r._e(),r._v(" "),r.state.content.closable&&r.state.content.aside?n("span",{staticClass:"action-button",class:{mobile:r.isMobile()},staticStyle:{display:"flex","justify-content":"center"},on:{click:r.closeContent}},[n("i",{staticClass:"skin-color-dark",class:r.g3wtemplate.getFontClass("close")})]):r._e()],2)]):r._e(),r._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:r.state.content.loading,expression:"state.content.loading"}],staticClass:"bar-loader"})])],1)},e.staticRenderFns=[],e._scopeId="data-v-209fb2db"},{"app/constant":4,"components/NotifyDownload.vue":268,"components/NotifyOnline.vue":269,"components/NotifyPlugins.vue":270,"components/UserMessage.vue":307,"services/gui":361,"services/viewport":371,"vueify/lib/insert-css":1}],309:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default={name:"viewport-contents-viewer",data:function(){return{state:null}}},t.exports.__esModule&&(t.exports=t.exports.default);r="function"==typeof t.exports?t.exports.options:t.exports;r.render=function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"contents",attrs:{id:"contents"}})},r.staticRenderFns=[]},{}],310:[function(e,t,r){var n,i,a;e("vueify/lib/insert-css").insert(".g3w-add-wms-url-message[data-v-438e4bb8]{font-weight:700;color:#000}.g3w-wmsurl-error[data-v-438e4bb8]{background-color:red}.g3w-wmsurl-already-added[data-v-438e4bb8]{background-color:orange}.wms_url_input_content[data-v-438e4bb8]{margin-bottom:5px}.wms-icon-action[data-v-438e4bb8]{font-weight:700;font-size:1.3em;box-shadow:0 5px 10px #1e282c}.wms-icon-action[data-v-438e4bb8]:hover{box-shadow:none}");function o(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),a=e("core/utils/utils").isURL,r.default={name:"wms",data:function(){return{url:null,id:null,loading:!1,status:{error:!1,added:!1}}},computed:{inputswmsurlvalid:function(){return null!==this.url&&this.url.trim()&&a(this.url)&&null!==this.id&&this.id.trim()}},methods:{addwmsurl:(i=o(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,this.$options.service.addNewUrl({url:this.url,id:this.id});case 3:r=e.sent,t=r.error,r=r.added,this.status.error=t,this.status.added=r,this.loading=!1;case 9:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)}),deleteWmsUrl:function(e){this.$options.service.deleteWmsUrl(e)},showWmsLayersPanel:(n=o(regeneratorRuntime.mark(function e(t){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.loading=!0,e.next=4,this.$options.service.loadWMSDataAndShowWmsLayersPanel(t);case 4:n=e.sent,r=n.error,n=n.added,this.status.error=r,this.status.added=n,this.loading=!1,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0);case 15:case"end":return e.stop()}},e,this,[[0,12]])})),function(e){return n.apply(this,arguments)})}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var n=this,e=n.$createElement,i=n._self._c||e;return i("ul",{staticClass:"treeview-menu g3w-tools menu-items"},[n.loading?i("li",[i("bar-loader",{attrs:{loading:n.loading}})],1):n._e(),n._v(" "),i("li",{staticStyle:{display:"flex","flex-direction":"column","justify-content":"space-between",background:"transparent !important","margin-bottom":"10px"}},[i("div",{staticClass:"wms_url_input_content"},[i("label",{directives:[{name:"t",rawName:"v-t",value:"sidebar.wms.panel.label.name",expression:"'sidebar.wms.panel.label.name'"}],attrs:{for:"add_custom_name_url_wms_input"}}),n._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:n.id,expression:"id"}],staticClass:"form-control",staticStyle:{width:"100%",color:"#000000"},attrs:{id:"add_custom_name_url_wms_input"},domProps:{value:n.id},on:{input:function(e){e.target.composing||(n.id=e.target.value)}}})]),n._v(" "),i("div",{staticClass:"wms_url_input_content"},[i("label",{attrs:{for:"add_custom_url_wms_input"}},[n._v("URL")]),n._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:n.url,expression:"url"}],staticClass:"form-control",staticStyle:{width:"100%",color:"#000000"},attrs:{id:"add_custom_url_wms_input"},domProps:{value:n.url},on:{input:function(e){e.target.composing||(n.url=e.target.value)}}})]),n._v(" "),i("div",[i("button",{directives:[{name:"disabled",rawName:"v-disabled",value:!n.inputswmsurlvalid,expression:"!inputswmsurlvalid"}],staticClass:"btn btn-block skin-background-color",staticStyle:{width:"100%"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),n.addwmsurl(e)}}},[i("i",{class:n.g3wtemplate.getFontClass("plus-square")})])])]),n._v(" "),n.status.error?i("li",[i("div",{directives:[{name:"t",rawName:"v-t",value:"server_error",expression:"'server_error'"}],staticClass:"g3w-add-wms-url-message g3w-wmsurl-error"})]):n.status.added?i("li",[i("div",{directives:[{name:"t",rawName:"v-t",value:"sidebar.wms.url_already_added",expression:"'sidebar.wms.url_already_added'"}],staticClass:"g3w-add-wms-url-message g3w-wmsurl-already-added"})]):n._e(),n._v(" "),i("li",{staticClass:"skin-border-color",staticStyle:{background:"transparent !important","border-top":"2px solid"}},[i("div",{staticStyle:{"max-height":"200px","overflow-y":"auto"}},[n._l(n.state.adminwmsurls,function(e){var t=e.id;e.url;return i("div",{key:n.wmsurl,staticStyle:{display:"flex","justify-content":"space-between","align-items":"center","border-bottom":"1px solid #cccccc","padding-bottom":"3px"}},[i("span",{staticClass:"g3w-long-text",staticStyle:{"flex-grow":"1","margin-right":"15px"}},[n._v(n._s(t))]),n._v(" "),i("span",{staticClass:"skin-color",staticStyle:{padding:"5px"},on:{click:function(e){return e.stopPropagation(),n.showWmsLayersPanel(t)}}},[i("i",{class:n.g3wtemplate.getFontClass("plus-square"),staticStyle:{"font-weight":"bold","font-size":"1.3em"}})])])}),n._v(" "),n._l(n.state.localwmsurls,function(e){var t=e.id,r=e.url;return i("div",{key:t,staticStyle:{"border-bottom":"1px solid #cccccc","padding-bottom":"3px"}},[i("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center","padding-top":"3px"}},[i("span",{staticClass:"g3w-long-text",staticStyle:{"flex-grow":"1","margin-right":"15px","font-weight":"bold"}},[n._v(n._s(t))]),n._v(" "),i("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top.create",value:"sidebar.wms.add_wms_layer",expression:"'sidebar.wms.add_wms_layer'",arg:"top",modifiers:{create:!0}}],staticClass:"skin-color",staticStyle:{padding:"3px",margin:"2px"},on:{click:function(e){return e.stopPropagation(),n.showWmsLayersPanel(r)}}},[i("i",{staticClass:"wms-icon-action",class:n.g3wtemplate.getFontClass("plus-square")})]),n._v(" "),i("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top.create",value:"sidebar.wms.delete_wms_url",expression:"'sidebar.wms.delete_wms_url'",arg:"top",modifiers:{create:!0}}],staticStyle:{color:"red",padding:"3px",margin:"2px"},on:{click:function(e){return e.stopPropagation(),n.deleteWmsUrl(t)}}},[i("i",{staticClass:"wms-icon-action",class:n.g3wtemplate.getFontClass("trash"),staticStyle:{color:"red"}})])]),n._v(" "),i("div",{staticClass:"g3w-long-text",staticStyle:{"font-size":"0.7em"},attrs:{title:r}},[n._v(n._s(r))])])})],2)])])},e.staticRenderFns=[],e._scopeId="data-v-438e4bb8"},{"core/utils/utils":68,"vueify/lib/insert-css":1}],311:[function(e,t,r){var n,i,a,o;e("vueify/lib/insert-css").insert(".g3w-wms-panel-title[data-v-0f3e5a3a]{font-size:1.2em;font-weight:700;margin-bottom:10px}button.wms-add-layer-button[data-v-0f3e5a3a]{width:100%;margin-top:10px}.g3w-wms-external-panel-layer-added-message[data-v-0f3e5a3a]{font-weight:700;color:red;margin:5px 0}");function s(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),o=e("g3w-ol/projection/projections"),r.default={name:"wmpspanel",data:function(){return{loading:!1,position:void 0,name:void 0,title:null,abstract:null,map_formats:[],info_formats:[],layers:[],selectedlayers:[],projections:[],epsg:null,added:!1}},methods:{addWMSlayer:(a=s(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t={url:this.url,name:this.name&&this.name.trim()||void 0,layers:this.selectedlayers,epsg:this.epsg,position:this.position},this.added=this.$options.service.checkIfWMSAlreadyAdded(t),this.added)return e.abrupt("return");e.next=5;break;case 5:return e.prev=5,this.loading=!0,e.next=9,this.$options.service.addWMSlayer(t);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(5);case 14:return e.prev=14,this.loading=!1,e.finish(14);case 17:this.clear();case 18:case"end":return e.stop()}},e,this,[[5,11,14,17]])})),function(){return a.apply(this,arguments)}),clear:function(){this.selectedlayers=[],this.name=null},getLayersByEpsg:function(t){var r=this;return null===t?this.$options.config.layers:this.layers.filter(function(e){e=e.name;return-1!==r.layerProjections[e].crss.indexOf(t)})},getProjectionsByName:function(t){var r=this;return this.projections.filter(function(e){return-1!==r.layerProjections[t].crss.indexOf(e)})}},watch:{selectedlayers:function(e){e.length?1===e.length?(this.epsg=this.layerProjections[e[0]].crss[0],this.projections=this.layerProjections[e[0]].crss):this.projections=this.getProjectionsByName(e[e.length-1]):(this.epsg=null,this.projections=[])},epsg:(i=s(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.layers=this.getLayersByEpsg(this.epsg);case 3:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)})},created:(n=s(regeneratorRuntime.mark(function e(){var t,r,n,i,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=this.$options.config,t=i.layers,r=i.title,n=i.abstract,i=i.wmsurl,this.url=i,this.title=r,this.abstract=n,this.layerProjections={},t.forEach(function(e){var t=e.name,r=e.crss,e=e.title;a.layerProjections[t]={crss:r.map(function(e){return o.get(e),"EPSG:"+e.epsg}).sort(),title:e}}),this.layers=t;case 7:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)}),beforeDestroy:function(){this.$data=null}},t.exports.__esModule&&(t.exports=t.exports.default);e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:t.loading,expression:"loading"}]},[r("bar-loader",{attrs:{loading:t.loading}}),t._v(" "),r("h3",{staticClass:"skin-color g3w-wms-panel-title"},[t._v(t._s(t.title))]),t._v(" "),t.abstract?r("helpdiv",{attrs:{message:t.abstract}}):t._e(),t._v(" "),r("label",{directives:[{name:"t",rawName:"v-t",value:"sidebar.wms.panel.label.layers",expression:"'sidebar.wms.panel.label.layers'"}],attrs:{for:"g3w-wms-layers"}}),t._v(" "),r("select",{directives:[{name:"select2",rawName:"v-select2",value:"selectedlayers",expression:"'selectedlayers'"}],attrs:{id:"g3w-wms-layers",multiple:"multiple",clear:"true"}},t._l(t.layers,function(e){return r("option",{key:e.name,domProps:{value:e.name}},[t._v(t._s(e.title))])}),0),t._v(" "),r("label",{directives:[{name:"t",rawName:"v-t",value:"sidebar.wms.panel.label.projections",expression:"'sidebar.wms.panel.label.projections'"}],attrs:{for:"g3w-wms-projections"}}),t._v(" "),r("select",{directives:[{name:"select2",rawName:"v-select2",value:"epsg",expression:"'epsg'"}],attrs:{id:"g3w-wms-projections"}},t._l(t.projections,function(e){return r("option",{key:e,domProps:{value:e}},[t._v(t._s(e))])}),0),t._v(" "),r("label",{directives:[{name:"t",rawName:"v-t",value:"sidebar.wms.panel.label.name",expression:"'sidebar.wms.panel.label.name'"}],attrs:{for:"g3w-wms-layer-name"}}),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],staticClass:"form-control",attrs:{id:"g3w-wms-layer-name"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}}),t._v(" "),t.added?r("div",{directives:[{name:"t",rawName:"v-t",value:"sidebar.wms.layer_id_already_added",expression:"'sidebar.wms.layer_id_already_added'"}],staticClass:"g3w-wms-external-panel-layer-added-message"}):t._e(),t._v(" "),r("layerspositions",{attrs:{position:t.position},on:{"layer-position-change":function(e){t.position=e}}}),t._v(" "),r("button",{directives:[{name:"disabled",rawName:"v-disabled",value:0===t.selectedlayers.length,expression:"0 === selectedlayers.length"}],staticClass:"btn wms-add-layer-button sidebar-button skin-button",on:{click:function(e){return e.stopPropagation(),t.addWMSlayer(e)}}},[r("i",{class:t.g3wtemplate.getFontClass("plus-square"),staticStyle:{"font-weight":"bold"}})])],1)},e.staticRenderFns=[],e._scopeId="data-v-0f3e5a3a"},{"g3w-ol/projection/projections":111,"vueify/lib/insert-css":1}],312:[function(e,t,r){e("regenerator-runtime");var n=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("vue-color"));window.VueColor=n,window.VueCookie=e("vue-cookie")},{"regenerator-runtime":"regenerator-runtime","vue-color":"vue-color","vue-cookie":"vue-cookie"}],313:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/utils/utils").uniqueId,a=new Vue,o={};r.watch=function(e){var t=e.el,r=e.attr,e=e.watcher,n=i(),t=(t.setAttribute(r,n),o[n]={});return e&&(t.unwatch=a.$watch(e[0],e[1],e[2]||{immediate:!0}),t.handler=e[1]),n},r.unwatch=function(e){var t=e.el,e=e.attr,t=t.getAttribute(e);t&&(o[t].unwatch(),delete o[t])},r.trigger=function(e){var t=e.el,r=e.attr,e=e.data;return o[t.getAttribute(r)].handler(e)}},{"core/utils/utils":68}],314:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){t.value?e.setAttribute("checked","checked"):e.removeAttribute("checked")}},{}],315:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){var r="g3w-disabled";t.value?e.classList.contains(r)||e.classList.add(r):e.classList.remove(r)}},{}],316:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("store/application-state"),i=(n=n)&&n.__esModule?n:{default:n},a=e("directives/utils");var o="g3w-v-download-id";r.default={bind:function(r,n){"boolean"==typeof n.value&&!n.value||(0,a.watch)({el:r,attr:o,watcher:[function(){return i.default.download},function(e){var t=n.modifiers&&n.modifiers.show?"hide":"disabled";r.classList.toggle("g3w-"+t,"hide"==t?!e:e)}]})},unbind:function(e){return(0,a.unwatch)({el:e,attr:o})}}},{"directives/utils":313,"store/application-state":373}],317:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("store/application-state"),i=(n=n)&&n.__esModule?n:{default:n},a=e("directives/utils");var o="g3w-v-offline-id";r.default={bind:function(t,r){(0,a.watch)({el:t,attr:o,watcher:[function(){return i.default.online},function(e){e=r.arg&&"hide"===r.arg?!e:e,t.classList.toggle("g3w-hide",!e)}]})},unbind:function(e){return(0,a.unwatch)({el:e,attr:o})}}},{"directives/utils":313,"store/application-state":373}],318:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("store/application-state"),i=(n=n)&&n.__esModule?n:{default:n},a=e("directives/utils");var o="g3w-v-plugins-id";r.default={bind:function(t){(0,a.watch)({el:t,attr:o,watcher:[function(){return i.default.plugins},function(e){t.classList.toggle("g3w-hide",0===e.length)}]})},unbind:function(e){return(0,a.unwatch)({el:e,attr:o})}}},{"directives/utils":313,"store/application-state":373}],319:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default={inserted:function(e,r,n){var t=n.data.attrs||{},i=t.templateResult,a=t.templateSelection,o=t.multiple,s=void 0!==o&&o,o=t.search,o=void 0===o||o,t=t.select2_value;$(e).select2({width:"100%",dropdownCssClass:"skin-color",templateResult:i,templateSelection:a,minimumResultsForSearch:o?void 0:-1}).on("select2:select",function(e){var t;r.value&&(t=e.params.data.id,s&&0===n.context[r.value].filter(function(e){return t===e}).length?n.context[r.value].push(t):n.context[r.value]=t)}).on("select2:unselect",function(t){r.value&&s&&(n.context[r.value]=n.context[r.value].filter(function(e){return t.params.data.id!==e}))}),r.value&&t&&$(e).val(t).trigger("change")},unbind:function(e){$(e).select2("destroy")}}},{}],320:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){e.toggleAttribute("selected",0===t.value)}},{}],321:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("store/application-state"),i=(n=n)&&n.__esModule?n:{default:n},a=e("directives/utils");var o=e("core/i18n/i18n.service").t,s="g3w-v-t-html-id";r.default={bind:function(e,t){(0,a.watch)({el:e,attr:s,watcher:[function(){return i.default.language},function(){e.innerHTML=""+o(t.value)}]})},unbind:function(e){return(0,a.unwatch)({el:e,attr:s})}}},{"core/i18n/i18n.service":13,"directives/utils":313,"store/application-state":373}],322:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("store/application-state"),i=(n=n)&&n.__esModule?n:{default:n},a=e("directives/utils");var n=e("core/i18n/i18n.service"),o=n.t,s=n.tPlugin,l="g3w-v-t-placeholder-id";r.default={bind:function(e,t){(0,a.watch)({el:e,attr:l,watcher:[function(){return i.default.language},function(){e.setAttribute("placeholder",("plugin"===t.arg?s:o)(t.value))}]})},unbind:function(e){return(0,a.unwatch)({el:e,attr:l})}}},{"core/i18n/i18n.service":13,"directives/utils":313,"store/application-state":373}],323:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("store/application-state"),i=(n=n)&&n.__esModule?n:{default:n},a=e("directives/utils");var o=e("core/i18n/i18n.service").tPlugin,s="g3w-v-t-plugin-id";r.default={bind:function(t,r){var n=t.innerHTML;(0,a.watch)({el:t,attr:s,watcher:[function(){return i.default.language},function(){var e=null!==r.value?o(r.value):"";switch(r.arg||"post"){case"pre":t.innerHTML=e+" "+n;break;case"post":t.innerHTML=n+" "+e}}]})},unbind:function(e){return(0,a.unwatch)({el:e,attr:s})}}},{"core/i18n/i18n.service":13,"directives/utils":313,"store/application-state":373}],324:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("store/application-state"),i=(n=n)&&n.__esModule?n:{default:n},a=e("directives/utils");var n=e("core/i18n/i18n.service"),o=n.t,s=n.tPlugin,l="g3w-v-t-title-id";r.default={bind:function(t,r){(0,a.watch)({el:t,attr:l,watcher:[function(){return i.default.language},function(){var e=("plugin"===r.arg?s:o)(r.value);t.setAttribute("title",e),t.setAttribute("data-original-title",e)}]})},unbind:function(e){return(0,a.unwatch)({el:e,attr:l})}}},{"core/i18n/i18n.service":13,"directives/utils":313,"store/application-state":373}],325:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("store/application-state"),i=(n=n)&&n.__esModule?n:{default:n},a=e("directives/utils");var n=e("core/i18n/i18n.service"),o=n.t,s=n.tPlugin,l="g3w-v-t-tooltip-id";r.default={bind:function(r,n){n.modifiers.create&&(n.arg&&(r.setAttribute("data-placement",n.arg),r.classList.add("skin-color","skin-tooltip-"+n.arg)),$(r).tooltip({trigger:i.default.ismobile?"click":"hover",html:!0}).on("shown.bs.tooltip",function(){i.default.ismobile&&setTimeout(function(){return $(r).tooltip("hide")},600)})),(0,a.watch)({el:r,attr:l,watcher:[function(){return i.default.language},function(e){var e=e.el,e=void 0===e?r:e,t=e.getAttribute("current-tooltip");null===t&&(t=n.value),e.setAttribute("data-original-title",n.modifiers.text?t:("plugin"===n.arg?s:o)(t))}]})},componentUpdated:function(e,t){var r=e.getAttribute("current-tooltip");null!=r&&r!==t.oldValue&&(0,a.trigger)({el:e,attr:l,data:{el:e}})},unbind:function(e){$(e).tooltip("hide"),(0,a.unwatch)({el:e,attr:l})}}},{"core/i18n/i18n.service":13,"directives/utils":313,"store/application-state":373}],326:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("store/application-state"),i=(n=n)&&n.__esModule?n:{default:n},a=e("directives/utils");function o(e){var t=e.el,r=null!==t.__currentBinding.value?s(t.__currentBinding.value):"";switch(t.__currentBinding.arg||"post"){case"pre":t.innerHTML=r+" "+t.__innerHTML;break;case"post":t.innerHTML=t.__innerHTML+" "+r}}var s=e("core/i18n/i18n.service").t,l="g3w-v-t-id";r.default={bind:function(e,t){e.__innerHTML=e.innerHTML,e.__currentBinding=t,(0,a.watch)({el:e,attr:l,watcher:[function(){return i.default.language},function(){return o({el:e})}]})},componentUpdated:function(e,t){e.__currentBinding=t,o({el:e})},unbind:function(e){return(0,a.unwatch)({el:e,attr:l})}}},{"core/i18n/i18n.service":13,"directives/utils":313,"store/application-state":373}],327:[function(e,t,r){window.g3wsdk=e("app/api")},{"app/api":2}],328:[function(g,N,D){var p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")};g("./deprecated"),g("./globals");var n=T(g("store/application-state")),t=T(g("services/application")),a=T(g("services/viewport")),v=T(g("services/gui")),o=T(g("services/floatbar")),s=T(g("services/navbaritems")),l=T(g("services/sidebar")),u=T(g("store/components")),r=T(g("components/App.vue")),e=T(g("components/GlobalImage.vue")),c=T(g("components/GlobalGallery.vue")),d=T(g("components/GlobalGeo.vue")),f=T(g("components/GlobalSkeleton.vue")),h=T(g("components/GlobalBarLoader")),m=T(g("components/GlobalProgressBar")),y=T(g("components/GlobalHelpDiv.vue")),b=T(g("components/GlobalResize.vue")),w=T(g("components/GlobalLayerPositions.vue")),x=T(g("components/GlobalDateTime.vue")),S=T(g("components/GlobalRange.vue")),L=T(g("components/GlobalResizeIcon.vue")),C=T(g("components/GlobalTabs.vue")),k=T(g("components/GlobalDivider.vue")),E=T(g("components/Floatbar.vue")),M=T(g("components/NavbaritemsLeft.vue")),G=T(g("components/NavbaritemsRight.vue")),V=T(g("components/Sidebar.vue")),U=T(g("components/Viewport.vue")),q=T(g("directives/v-disabled")),B=T(g("directives/v-checked")),z=T(g("directives/v-selected-first")),W=T(g("directives/v-select2")),H=T(g("directives/v-t-tooltip")),K=T(g("directives/v-t-html")),Z=T(g("directives/v-t-placeholder")),Y=T(g("directives/v-t-title")),Q=T(g("directives/v-t")),X=T(g("directives/v-t-plugin")),J=T(g("directives/v-plugins")),ee=T(g("directives/v-online")),te=T(g("directives/v-download")),re=g("app/constant");function T(e){return e&&e.__esModule?e:{default:e}}function I(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}function P(e){var f=e.ApplicationService,h=f.getConfig().layout||{};this._isMobile=isMobile.any,this._isIframe=h.iframe,this.sizes={sidebar:{width:0}},this.waitingoutputdataplace=null,this.init=function(){this._createApp()},this._createTemplateConfig=function(){var e=Vue.prototype.g3wtemplate,t=f.getConfig().apptitle||"G3W Suite",r=g("gui/viewport/contentsviewer"),n=g("gui/catalog/vue/catalog"),i=g("gui/search/vue/search"),a=g("gui/querybuilder/querybuilderuifactory"),o=g("gui/print/vue/print"),s=g("gui/metadata/vue/metadata"),l=g("gui/tools/vue/tools"),u=g("gui/wms/vue/wms"),c=g("gui/map/vue/map"),d=g("gui/queryresults/vue/queryresults"),p=g("gui/spatialbookmarks/vue/spatialbookmarks");return{title:t,placeholders:{navbar:{components:[]},sidebar:{components:[new s({id:"metadata",open:!1,collapsible:!1,icon:e.getFontClass("file"),mobile:!0}),new p({id:"spatialbookmarks",open:!1,collapsible:!0,icon:e.getFontClass("bookmark"),mobile:!0}),new o({id:"print",open:!1,collapsible:!0,icon:e.getFontClass("print"),mobile:!1}),new i({id:"search",open:!1,collapsible:!0,icon:e.getFontClass("search"),actions:[{id:"querybuilder",class:e.getFontClass("calculator")+" sidebar-button sidebar-button-icon",tooltip:"Query Builder",fnc:function(){v.default.closeContent(),P.Services.sidebar.closeOpenComponents(),a.show({type:"sidebar"})},style:{color:"#8DC3E3",padding:"6px",fontSize:"1.2em",borderRadius:"3px",marginRight:"5px"}}],mobile:!0}),new l({id:"tools",open:!1,collapsible:!0,icon:e.getFontClass("tools"),mobile:!0}),new u({id:"wms",open:!1,collapsible:!0,icon:e.getFontClass("layers"),mobile:!0}),new n({id:"catalog",open:!1,collapsible:!1,isolate:!0,icon:e.getFontClass("map"),mobile:!0,config:{legend:{config:h.legend}}})]},floatbar:{components:[]}},othercomponents:[new d({id:"queryresults"})],viewport:{components:{map:new c({id:"map"}),content:new r({id:"contents"})}}}},this._createApp=function(){this._setDataTableLanguage();var e,r=this;return(isMobile.any||this._isIframe)&&$("body").addClass("sidebar-collapse"),new Vue({el:"#app",created:function(){r._setupInterface(),r._setupLayout(),r._setUpServices(),r.templateConfig=r._createTemplateConfig(),this.$watch(function(){return n.default.language},function(){r._setDataTableLanguage()})},mounted:(e=I(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:return r._buildTemplate(),r._setUpTemplateDependencies(this),$(document).localize(),r._setViewport(r.templateConfig.viewport),t=$(".navbar").css("background-color"),v.default.skinColor=t&&"#"+t.substr(4,t.indexOf(")")-4).split(",").map(function(e){return parseInt(e).toString(16)}).join(""),e.next=10,this.$nextTick();case 10:r.emit("ready"),r.sizes.sidebar.width=$("#g3w-sidebar").width(),v.default.ready();case 13:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})})},this._setupLayout=function(){isMobile.any||$("<style type='text/css'> .ol-control-tl {top: 7px;left:43px;}</style>").appendTo("head"),Vue.component("sidebar",V.default),Vue.component("navbarleftitems",M.default),Vue.component("navbarrightitems",G.default),Vue.component("viewport",U.default),Vue.component("floatbar",E.default),Vue.component("app",r.default)},this._setDataTableLanguage=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t={language:{sSearch:"",searchPlaceholder:R("dosearch"),sLengthMenu:R("dataTable.lengthMenu"),paginate:{previous:R("dataTable.previous"),next:R("dataTable.next")},info:R("dataTable.info"),zeroRecords:R("dataTable.nodatafilterd"),infoFiltered:""}};$.extend($.fn.dataTableExt.oStdClasses,{sFilterInput:"form-control search"}),e?e.dataTable({oLanguage:t}):$.extend(!0,$.fn.dataTable.defaults,t)},this._addRoutes=function(){var e=f.getRouterService(),r=v.default.getComponent("map").getService();e.addRoute("map/zoomto/{coordinate}/:zoom:",function(e,t){e=_.map(e.split(","),function(e){return Number(e)}),t=t?Number(t):null,e.length&&r.on("ready",function(){this.zoomTo(e,t)})})},this._setUpServices=function(){Object.keys(P.Services).forEach(function(e){var t=P.Services[e];f.registerService(e,t)}),Object.values(v.default.getComponents()).forEach(function(e){f.registerService(e.id,e.getService())}),P.Services.viewport.on("resize",function(){return v.default.emit("resize")})},this._buildTemplate=function(){var r=this,e=(o.default.init(j),this.templateConfig.placeholders);Object.entries(e).forEach(function(e){var e=i(e,2),t=e[0],e=e[1];r._addComponents(e.components,t)}),this._addOtherComponents()},this._addOtherComponents=function(){this.templateConfig.othercomponents&&this._addComponents(this.templateConfig.othercomponents)},this._setViewport=function(e){e&&(P.Services.viewport.init(e),this._addComponents(e.components))},this._addComponent=function(e,t){return this._addComponents([e],t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}),!0},this._addComponents=function(e,t,r){var n=!0;t&&-1<P.PLACEHOLDERS.indexOf(t)&&(t=P.Services[t])&&(n=t.addComponents(e,r)),Object.entries(e).forEach(function(e){e=i(e,2),e[0],e=e[1];n&&(u.default.registerComponent(e),f.registerService(e.id,e.getService()))})},this._removeComponent=function(e,t,r){e=u.default.unregisterComponent(e);t&&P.Services[t]&&P.Services[t].removeComponent(e,r)},this._showModalOverlay=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=arguments[1],r=v.default.getService("map");e?r.startDrawGreyCover(t):r.stopDrawGreyCover()},this._isSidebarVisible=function(){return!$("body").hasClass("sidebar-collapse")},this._showSidebar=function(){$("body").addClass("sidebar-open"),$("body").removeClass("sidebar-collapse")},this._hideSidebar=function(){$("body").removeClass("sidebar-open"),$("body").addClass("sidebar-collapse")},this._setUpTemplateDependencies=function(t){v.default.isMobile=function(){return isMobile.any},v.default.getTemplateInfo=function(){return t.g3wtemplate.getInfo()},v.default.getTemplateInfo=function(){return t.g3wtemplate.getInfo()},v.default.getFontClass=function(e){return t.g3wtemplate.getFontClass(e)}},v.default.errorToMessage=function(e){var t,r,n,i="server_error";switch(O(e)){case"Error":i="CLIENT - "+e.message;break;case"Object":e.responseJSON?!1===(e=e.responseJSON).result&&(t=(n=e.error).code,r=void 0===(r=n.data)?"":r,n=void 0===(n=n.message)?"":n,i=(void 0===t?"":t).toUpperCase()+" "+r+" "+n):e.responseText&&(i=e.responseText);break;case"Array":i=e.map(function(e){return v.default.errorToMessage(e)}).join(" ");break;default:i=e}return i},this._setupInterface=function(){var t,r=this;v.default.layout=j,v.default.getSize=function(e){var t=e.element,e=e.what;if(t&&e)return r.sizes[t][e]},v.default.addComponent=this._addComponent.bind(this),v.default.removeComponent=this._removeComponent.bind(this),v.default.getResourcesUrl=function(){return f.getConfig().resourcesurl},v.default.showList=o.default.showPanel.bind(o.default),v.default.closeList=o.default.closePanel.bind(o.default),v.default.hideList=o.default.hidePanel.bind(o.default),v.default.showTable=function(){},v.default.closeTable=function(){},v.default.outputDataPlace=(t=I(regeneratorRuntime.mark(function e(i){var a,o,s,t,l,u,r,c,d=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t={condition:!0,add:!1,loading:!0},r=n.title,a=void 0===r?"":r,r=n.show,r=void 0===r?t:r,o=n.before,s=n.after,t="Object"!==O(r)?{condition:r,add:!1,loading:!0}:p({},t,r),l=t.condition,u=t.add,r=t.loading,e.t0=this.waitingoutputdataplace,e.t0)return e.next=8,this.waitingoutputdataplace.stop();e.next=8;break;case 8:c=u?v.default.getService("queryresults"):r&&this.showContentFactory("query")(a),this.waitingoutputdataplace=function(){var e,n=!1;return I(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i;case 3:if(t=e.sent,e.t0=o,e.t0)return e.next=8,o(t);e.next=8;break;case 8:t.usermessage&&v.default.showUserMessage({type:t.usermessage.type,message:t.usermessage.message,autoclose:t.usermessage.autoclose}),n||(("Function"===O(l)?l(t):"Boolean"!==O(l)||l)?(c||d.showContentFactory("query")(a)).setQueryResponse(t,{add:u}):v.default.closeContent(),s&&s(t)),e.next=17;break;case 12:e.prev=12,e.t1=e.catch(0),r=d.errorToMessage(e.t1),d.showUserMessage({type:"alert",message:r,textMessage:!0}),d.closeContent();case 17:return e.prev=17,n||(d.waitingoutputdataplace=null),e.finish(17);case 20:case"end":return e.stop()}},e,d,[[0,12,17,20]])}))(),{stop:(e=I(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=!0;case 1:case"end":return e.stop()}},e,d)})),function(){return e.apply(this,arguments)})}}();case 10:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)}),v.default.showContentFactory=function(e){var t=void 0;switch(e){case"query":t=v.default.showQueryResults;break;case"form":t=v.default.showForm}return t},v.default.showForm=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.perc,r=e.split,r=void 0===r?"h":r,n=e.push,i=e.showgoback,a=e.crumb,o=g("gui/form/vue/form"),o=new(e.formComponent||o)(e),e=o.getService();return v.default.setContent({perc:t,content:o,split:r,crumb:a,push:!!n,showgoback:!!i,closable:!1}),e},v.default.closeForm=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).pop,e=void 0!==e&&e;this.emit("closeform",!1),e?v.default.popContent():a.default.removeContent(),v.default.setModal(!1)},v.default.disableElement=function(e){var t=e.element;e.disable&&$(t).addClass("g3w-disabled")||$(t).removeClass("g3w-disabled")},v.default.disableContent=function(e){a.default.disableContent(e)},v.default.disablePanel=function(){v.default.disableElement({element:"#g3w-sidebarpanel-placeholder",disable:0<arguments.length&&void 0!==arguments[0]&&arguments[0]})},v.default.hideContent=function(e,t){return a.default.hideContent(e,t)},v.default.closeContent=function(){return this.emit("closecontent",!1),a.default.closeContent()},v.default.closeOpenSideBarComponent=function(){P.Services.sidebar.closeOpenComponents()},v.default.showQueryResults=function(e,t){var r=v.default.getComponent("queryresults"),n=r.getService();return n.reset(),t&&n.setQueryResponse(t),v.default.showContextualContent({content:r,title:"info.title",crumb:{title:"info.title",trigger:null},push:v.default.getPushContent(),post_title:e}),n},v.default.addNavbarItem=function(e){s.default.addItem(e)},v.default.removeNavBarItem=function(){},v.default.showPanel=l.default.showPanel.bind(l.default),v.default.closePanel=l.default.closePanel.bind(l.default),v.default.disableApplication=function(){f.disableApplication(0<arguments.length&&void 0!==arguments[0]&&arguments[0])},v.default.showUserMessage=function(){return a.default.showUserMessage(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},v.default.closeUserMessage=function(){a.default.closeUserMessage()},v.default.notify={warning:function(e){v.default.showUserMessage({type:"warning",message:e,autoclose:1<arguments.length&&void 0!==arguments[1]&&arguments[1]})},error:function(e){v.default.showUserMessage({type:"alert",message:e,autoclose:1<arguments.length&&void 0!==arguments[1]&&arguments[1]})},info:function(e){v.default.showUserMessage({type:"info",message:e,autoclose:1<arguments.length&&void 0!==arguments[1]&&arguments[1]})},success:function(e){v.default.showUserMessage({type:"success",message:e,autoclose:!0})}},v.default.dialog=bootbox,v.default.showModalDialog=function(){return v.default.dialog.dialog(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},v.default.showSpinner=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.container||"body",r=e.id||"loadspinner",n=e.where||"prepend",i=e.style||"",a=e.transparent?"background-color: transparent":"",e=e.center?"margin: auto":"";$("#"+r).length||$(t)[n].call($(t),'<div id="'+r+'" class="spinner-wrapper '+i+'" style="'+a+'"><div class="spinner '+i+'" style="'+e+'"></div></div>')},v.default.hideSpinner=function(){$("#"+(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"loadspinner")).remove()},v.default.showFloatbar=function(){o.default.open()},v.default.hideFloatbar=function(){o.default.close()},v.default.showSidebar=this._showSidebar.bind(this),v.default.hideSidebar=this._hideSidebar.bind(this),v.default.isSidebarVisible=this._isSidebarVisible.bind(this),v.default.reloadComponents=function(){P.Services.sidebar.reloadComponents()},v.default.setModal=this._showModalOverlay.bind(this),v.default.showFullModal=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.element,e=e.show,e=void 0===e||e;$(void 0===t?"#full-screen-modal":t).modal(e?"show":"hide")},v.default.disableSideBar=function(){n.default.gui.sidebar.disabled=!(0<arguments.length&&void 0!==arguments[0])||arguments[0]},v.default.setPrimaryView=function(e){a.default.setPrimaryView(e)},v.default.showMap=function(){a.default.showMap()},v.default.showContextualMap=function(){a.default.showContextualMap({perc:0<arguments.length&&void 0!==arguments[0]?arguments[0]:30,split:arguments[1]})},v.default.setContextualMapComponent=function(e){a.default.setContextualMapComponent(e)},v.default.resetContextualMapComponent=function(){a.default.resetContextualMapComponent()},v.default.showContent=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return v.default.setLoadingContent(!1),e.perc=r._isMobile?100:e.perc,v.default.setContent(e),!0},v.default.showContextualContent=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e.perc=r._isMobile?100:e.perc,v.default.setContent(e),!0},v.default.pushContent=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.perc=r._isMobile?100:e.perc,e.push=!0,v.default.setContent(e)},v.default.pushContextualContent=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.perc=r._isMobile?100:e.perc,v.default.pushContent(e)},v.default.popContent=function(){a.default.popContent()},v.default.getContentLength=function(){return a.default.contentLength()},v.default.getCurrentContentTitle=function(){return a.default.getCurrentContentTitle()},v.default.getCurrentContentId=function(){return a.default.getCurrentContentId()},v.default.changeCurrentContentTitle=function(e){a.default.changeCurrentContentTitle(e)},v.default.changeCurrentContentOptions=function(){a.default.changeCurrentContentOptions(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},v.default.getCurrentContent=function(){return a.default.getCurrentContent()},v.default.toggleFullViewContent=function(){a.default.toggleFullViewContent()},v.default.resetToDefaultContentPercentage=function(){a.default.resetToDefaultContentPercentage()},v.default.getProjectMenuDOM=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.projects,r=e.host,e=e.cbk;return new A({projects:t&&Array.isArray(t)&&t,cbk:e,host:r}).getInternalComponent().$mount().$el},v.default.setCloseUserMessageBeforeSetContent=function(){this._closeUserMessageBeforeSetContent=!(0<arguments.length&&void 0!==arguments[0])||arguments[0]},v.default._setContent=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};r._closeUserMessageBeforeSetContent&&v.default.closeUserMessage(),e.content=e.content||null,e.title=e.title||"",e.push=!!_.isBoolean(e.push)&&e.push,e.perc=r._isMobile?100:e.perc,e.split=e.split||"h",e.backonclose=!!_.isBoolean(e.backonclose)&&e.backonclose,e.showtitle=!_.isBoolean(e.showtitle)||e.showtitle,a.default.showContent(e)},v.default.hideClientMenu=function(){f.getConfig().user=null},v.default.hideChangeMaps=function(){f.getConfig().projects=[]},v.default.getTemplateClasses=function(){return BootstrapVersionClasses},v.default.getTemplateClass=function(e){var t=e.element,e=e.type;return BootstrapVersionClasses[t][e]},v.default.setLoadingContent=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return P.Services.viewport.setLoadingContent(e),e&&new Promise(function(e){setTimeout(e,200)})},v.default.openProjectsMenu=function(){v.default.getComponent("contents").getComponentById("projectsmenu")?v.default.closeContent():(this.isMobile()&&(v.default.hideSidebar(),$("#main-navbar.navbar-collapse").removeClass("in")),P.Services.sidebar.closeOpenComponents(),v.default.setContent({content:new A,title:"",perc:100}))},v.default.openChangeMapMenu=function(){v.default.getComponent("contents").getComponentById("changemapmenu")?v.default.closeContent():(this.isMobile()&&(v.default.hideSidebar(),$("#main-navbar.navbar-collapse").removeClass("in")),P.Services.sidebar.closeOpenComponents(),v.default.setContent({content:new oe,title:"",perc:100}))}},ne(this)}var F=g("core/utils/utils"),ne=F.base,ie=F.inherit,O=F.toRawType,F=g("core/i18n/i18n.service"),R=F.t,ae=F.tPlugin,F=g("core/g3wobject"),A=g("gui/projectsmenu/projectsmenu"),oe=g("gui/changemapmenu/changemapmenu"),j=(Vue.component(e.default.name,e.default),Vue.component(c.default.name,c.default),Vue.component(d.default.name,d.default),Vue.component(h.default.name,h.default),Vue.component(m.default.name,m.default),Vue.component(f.default.name,f.default),Vue.component(y.default.name,y.default),Vue.component(b.default.name,b.default),Vue.component(w.default.name,w.default),Vue.component(x.default.name,x.default),Vue.component(S.default.name,S.default),Vue.component(L.default.name,L.default),Vue.component(C.default.name,C.default),Vue.component(k.default.name,k.default),Vue.filter("t",function(e){return R(e)}),Vue.filter("tPlugin",function(e){return null!==e?ae(e):""}),Vue.directive("disabled",q.default),Vue.directive("checked",B.default),Vue.directive("selected-first",z.default),Vue.directive("select2",W.default),Vue.directive("t-tooltip",H.default),Vue.directive("t-html",K.default),Vue.directive("t-placeholder",Z.default),Vue.directive("t-title",Y.default),Vue.directive("t",Q.default),Vue.directive("t-plugin",X.default),Vue.directive("plugins",J.default),Vue.directive("online",ee.default),Vue.directive("download",te.default),Vue.use(window.VueCookie),Vue.use({install:function(e){function t(){return r.apply(this,arguments)}var r;e.prototype.g3wtemplate={font:re.FONT_AWESOME_ICONS,get:function(){},getInfo:function(){return{font:this.font}},addFontClass:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.name,e=e.className,r=void 0===this.font[t];return r&&(this.font[t]=e),r},getInfoString:function(){},getFontClass:function(e){return void 0!==this.font[e]?this.font[e]:""}},e.mixin({methods:{isMobile:(r=function(){return isMobile.any},t.toString=function(){return r.toString()},t)}})}},{}),Vue.mixin({inheritAttrs:!1}),$.LayoutManager);j.loading(!0);ie(P,F),P.PLACEHOLDERS=["navbar","sidebar","viewport","floatbar"],P.Services={navbar:null,sidebar:l.default,viewport:a.default,floatbar:null},P.fail=function(e){e=e.error;j.loading(!1),new Vue(p({el:"#app"},Vue.compile('<div class="error-initial-page skin-background-color">\n        <template v-if="isMobile()">\n          <h3 class="oops">Oops!</h3>\n          <h5 class="cause">'+(e||R("error_page.error"))+'</h5>\n          <h6 class="at-moment">'+R("error_page.at_moment")+'</h6>\n          <h4 class="f5">'+R("error_page.f5")+'</h4>\n        </template>\n        <template v-else>\n          <h1 class="oops">Oops!</h1>\n          <h1 class="cause">'+(e||R("error_page.error"))+'</h1>\n          <h3 class="at-moment">'+R("error_page.at_moment")+'</h3>\n          <h2 class="f5">'+R("error_page.error")+"</h2>\n        </template>\n      </div>")))},t.default.init().then(function(){var e=new P({ApplicationService:t.default});e.on("ready",function(){return t.default.postBootstrap()}),e.init()}).catch(function(e){var t=e.error,t=void 0===t?null:t;e.language;t&&(t.responseJSON&&t.responseJSON.error.data?t=t.responseJSON.error.data:t.statusText&&(t=t.statusText)),P.fail({error:t})})},{"./deprecated":312,"./globals":327,"app/constant":4,"components/App.vue":194,"components/Floatbar.vue":213,"components/GlobalBarLoader":218,"components/GlobalDateTime.vue":219,"components/GlobalDivider.vue":220,"components/GlobalGallery.vue":221,"components/GlobalGeo.vue":222,"components/GlobalHelpDiv.vue":223,"components/GlobalImage.vue":224,"components/GlobalLayerPositions.vue":225,"components/GlobalProgressBar":226,"components/GlobalRange.vue":227,"components/GlobalResize.vue":228,"components/GlobalResizeIcon.vue":229,"components/GlobalSkeleton.vue":230,"components/GlobalTabs.vue":231,"components/NavbaritemsLeft.vue":266,"components/NavbaritemsRight.vue":267,"components/Sidebar.vue":294,"components/Viewport.vue":308,"core/g3wobject":12,"core/i18n/i18n.service":13,"core/utils/utils":68,"directives/v-checked":314,"directives/v-disabled":315,"directives/v-download":316,"directives/v-online":317,"directives/v-plugins":318,"directives/v-select2":319,"directives/v-selected-first":320,"directives/v-t":326,"directives/v-t-html":321,"directives/v-t-placeholder":322,"directives/v-t-plugin":323,"directives/v-t-title":324,"directives/v-t-tooltip":325,"gui/catalog/vue/catalog":113,"gui/changemapmenu/changemapmenu":115,"gui/form/vue/form":123,"gui/map/vue/map":158,"gui/metadata/vue/metadata":161,"gui/print/vue/print":164,"gui/projectsmenu/projectsmenu":167,"gui/querybuilder/querybuilderuifactory":168,"gui/queryresults/vue/queryresults":172,"gui/search/vue/search":179,"gui/spatialbookmarks/vue/spatialbookmarks":181,"gui/tools/vue/tools":186,"gui/viewport/contentsviewer":189,"gui/wms/vue/wms":192,"services/application":351,"services/floatbar":360,"services/gui":361,"services/navbaritems":365,"services/sidebar":369,"services/viewport":371,"store/application-state":373,"store/components":375}],329:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default={translation:{error_page:{error:"Verbindungsfehler",at_moment:"Karte anzeigen ist im Moment nicht möglich",f5:"Drücken Sie Strg+F5"},cookie_law:{message:"Diese Website verwendet Cookies, um Ihnen die bestmögliche Erfahrung auf unserer Website zu bieten.",buttonText:"Verstanden!"},default:"default",sign_in:"Anmelden",layer_selection_filter:{tools:{filter:"Filter hinzufügen/entfernen",nofilter:"Filter entfernen",invert:"Auswahl umkehren",clear:"Auswahl löschen",show_features_on_map:"Auf der Karte sichtbare Features anzeigen"}},warning:{not_supported_format:"Nicht unterstütztes Format"},layer_position:{top:"OBEN",bottom:"UNTEN",message:"Position relativ zu den Layern im TOC"},sdk:{atlas:{template_dialog:{title:"Template auswählen"}},spatialbookmarks:{title:"Räumliche Lesezeichen",helptext:"Bewegen Sie sich auf der Kartenausdehnung, fügen Sie den Namen ein und klicken Sie auf Hinzufügen",input:{name:"Name"},sections:{project:{title:"Projekt-Lesezeichen"},user:{title:"Benutzer-Lesezeichen"}}},search:{all:"ALLE",no_results:"Keine Ergebnisse",searching:"Suchen ...",error_loading:"Fehler beim Datenladen",layer_not_searchable:"Layer ist nicht durchsuchbar",layer_not_querable:"Layer ist nicht abfragbar",autocomplete:{inputshort:{pre:"Bitte",post:"oder mehrere Zeichen eingeben"}}},print:{no_layers:"Kein Layer zu drucken",template:"Template",labels:"Labels",scale:"Skala",format:"Format",rotation:"Drehung",download_image:"Bild herunterladen",fids_instruction:"Akzeptierte Werte: von 1 bis [max]. Es ist möglich, ein Intervall einzugeben, z. B. 4-6",fids_example:"Bsp. 1,4-6 druckt id 1,4,5,6",help:"Die im Druck angezeigten Layer können die im Projekt definierten sein und nicht die auf der Karte angezeigten"},querybuilder:{search:{run:"Ausführen",info:"Information",delete:"Löschen",edit:"Bearbeiten"},messages:{changed:"Gespeichert",number_of_features:"Anzahl der Features"},panel:{button:{all:"ALLE",save:"SPEICHERN",test:"TEST",clear:"LÖSCHEN",run:"AUSFÜHREN",manual:"MANUELL"},layers:"LAYERS",fields:"FELDER",values:"WERTE",operators:"OPERATOREN",expression:"AUSDRUCK"},error_run:"Es ist ein Fehler aufgetreten. Bitte überprüfen Sie die Abfrage",error_test:"Während der Ausführung der Abfrage ist ein Fehler aufgetreten",delete:"Soll es gelöscht werden?",additem:"Geben Sie den Namen der neuen Suche ein"},errors:{layers:{load:"Einige Layer sind nicht verfügbar"},unsupported_format:"Nicht unterstütztes Format",add_external_layer:"Fehler im Ladevorgang des Layers"},metadata:{title:"Metadaten",groups:{general:{title:"ALLGEMEIN",fields:{title:"TITEL",name:"NAME",description:"BESCHREIBUNG",abstract:"ABASTRACT",keywords:"SCHLÜSSELWÖRTER",fees:"GEBÜHREN",accessconstraints:"ZUGRIFFSBESCHRÄNKUNG",contactinformation:"KONTAKTE",subfields:{contactinformation:{contactelectronicmailaddress:"Email",personprimary:"Referenzen",contactvoicetelephone:"Telefon",contactorganization:"Firma",ContactOrganization:"Firma",contactposition:"Position",ContactPosition:"Position",contactperson:"Person",ContactPerson:"Person"}},wms_url:"WMS"}},spatial:{title:"SPATIAL",fields:{crs:"EPSG",extent:"BBOX"}},layers:{title:"LAYERS",fields:{layers:"LAYERS",subfields:{crs:"EPSG",bbox:"BBOX",title:"TITEL",name:"NAME",geometrytype:"GEOMETRIE",source:"QUELLE",attributes:"ATTRIBUTE",abstract:"ABSTRACT",attribution:"ATRIBUTION",keywords:"SCHLÜSSELWÖRTER",metadataurl:"METADATEN URL",dataurl:"DATEN URL"}},groups:{general:"ALLGEMEIN",spatial:"SPATIAL"}}}},tooltips:{relations:{form_to_row:"Zeilenansicht",row_to_form:"Formularansicht"},copy_map_extent_url:"Link zur Kartenansicht kopieren",download_shapefile:"Shapefile herunterladen",download_gpx:"DGPX herunterladen",download_gpkg:"GPKG herunterladen",download_csv:"CSV herunterladen",download_xls:"XLS herunterladen",show_chart:"Diagramm anzeigen",atlas:"Atlas drucken"},mapcontrols:{query:{tooltip:"Query layer",actions:{add_selection:{hint:"Auswahl hinzufügen/entfernen"},zoom_to_features_extent:{hint:"Zoom auf Feature-Ausdehnung"},add_features_to_results:{hint:"Hinzufügen/Entfernen von Features zu den Ergebnissen"},remove_feature_from_results:{hint:"Feature aus den Ergebnissen entfernen"},zoom_to_feature:{hint:"Zum Feature zoomen"},relations:{hint:"Relationen anzeigen"},relations_charts:{hint:"Relationship-Diagramm anzeigen"},download_features_shapefile:{hint:"Features Shapefile herunterladen"},download_shapefile:{hint:"Feature Shapefile herunterladen"},download_features_gpx:{hint:"Feature GPX herunterladen"},download_features_gpkg:{hint:"Feature GPKG herunterladen"},download_gpx:{hint:"Feature GPX herunterladen"},download_gpkg:{hint:"Feature GPKG herunterladen"},download_features_csv:{hint:"Features CSV herunterladen"},download_csv:{hint:"Feature CSV herunterladen"},download_features_xls:{hint:"Features XLS herunterladen"},download_xls:{hint:"Feature XLS herunterladen"},atlas:{hint:"Atlas drucken"},copy_zoom_to_fid_url:{hint:"Kopieren der Karten-URL mit dieser Geometrie-Feature-Erweiterung",hint_change:"Kopiert"}}},querybypolygon:{download:{title:"Attribute herunterladen",choiches:{feature:{label:"Nur Features"},feature_polygon:{label:"Features+Query Polygon"}}},tooltip:"Query nach Polygon",no_geometry:"Keine Geometrie in der Antwort",help:{title:"Hilfe - Abfrage nach Polygon",message:"\n                <ul>\n                  <li>Wählen Sie einen Polygon Layer auf TOC.</li>\n                  <li>Stellen Sie sicher, dass der Layer sichtbar ist.</li>\n                  <li>Klicken Sie auf ein Feature des ausgewählten Layers.</li>\n                </ul>"}},querybydrawpolygon:{tooltip:"Abfrage durch Polygon zeichnen"},querybybbox:{tooltip:"BBox Layer abfragen",nolayers_visible:"Es sind keine abfragbaren Layer sichtbar. Bitte setzen Sie mindestens einen sichtbaren wfs Layer, um die Abfrage zu starten",help:{title:"Hilfe - Abfrage des BBox Layers",message:"\n                 <ul>\n                  <li>Ein Quadrat auf der Karte ziehen, um unterstrichene Layer im TOC abzufragen</li>\n                 </ul>"}},addlayer:{messages:{csv:{warning:"Das Ergebnis in der Karte ist unvollständig, da die unten stehende Liste fehlerhafter Einträge enthält:"}},tooltip:"Layer hinzufügen"},geolocation:{tooltip:"Geolokalisierung"},measures:{length:{tooltip:"Länge",help:"Klicken Sie auf die Karte, um die Linie zu zeichnen. Drücken Sie <br>CANC, wenn Sie den letzten Eckpunkt löschen möchten."},area:{tooltip:"Fläche",help:"Drücken Sie <br>CANC, wenn Sie den letzten Eckpunkt löschen wollen."}},scale:{no_valid_scale:"Ungültige Skala"},scaleline:{units:{metric:"Meter",nautical:"Nautische Meile"}},zoomhistory:{zoom_last:"Zoom Vorheriger",zoom_next:"Zoom Nächster"}},relations:{relation_data:"Daten zur Relation",no_relations_found:"Keine Relationen gefunden",back_to_relations:"Zurück zu den Relationen",list_of_relations_feature:"Liste der Relationen des Features",error_missing_father_field:"Ein Feld fehlt"},workflow:{steps:{title:"Schritte"},next:"Weiter"},form:{loading:"Laden ...",inputs:{messages:{errors:{picklayer:"Kein Feature ausgewählt. Prüfen, ob der Layer in Bearbeitung oder im aktuellen Maßstab sichtbar ist"}},tooltips:{picklayer:"Wert aus dem Layer abrufen",lonlat:"Zum Abrufen der Koordinaten auf die Karte klicken"},input_validation_mutually_exclusive:"Feld schließt sich gegenseitig aus mit ",input_validation_error:"Obligatorisches Feld oder falscher Datentyp",input_validation_min_field:"Der Wert muss größer/gleich sein als der Feldwert  ",input_validation_max_field:"Der Wert muss kleiner/gleich sein als der Feldwert ",input_validation_exclude_values:"Wert muss einmalig sein",integer:"integer",bigint:"integer",text:"text",varchar:"text",textarea:"text",string:"string",date:"date",datetime:"date",float:"float",table:"table"},footer:{required_fields:"Erforderliche Felder"},messages:{qgis_input_widget_relation:"Spezifisches Relations-Formular verwenden, um mit Relationen zu arbeiten"}},catalog:{current_map_theme_prefix:"THEMA",choose_map_theme:"THEMA AUSWÄHLEN",menu:{layerposition:"Position des Layers",setwmsopacity:"Opazität einstellen",wms:{title:"",copy:"Klicken Sie hier, um die Url zu kopieren",copied:"Kopiert"},download:{unknow:"Herunterladen",shp:"Shapefile herunterladen",gpx:"GPX herunterladen",gpkg:"GPKG herunterladen",csv:"CSV herunterladen",xls:"XLS herunterladen",geotiff:"GEOTIFF herunterladen",geotiff_map_extent:"GEOTIFF herunterladen (aktueller Ansichtsumfang)"}}},wps:{list_process:"Liste der Prozesse",tooltip:"Karte anklicken"}},credits:{g3wSuiteFramework:"Applikation basiert auf OS-Framework",g3wSuiteDescription:"Veröffentlichen und verwalten Sie Ihre QGIS-Projekte im Internet",productOf:"Framework entwickelt von"},toggle_color_scheme:"Farbschema umschalten",logout:"Logout",no_other_projects:"Kein weiteres Projekt für diese Gruppe",no_other_groups:"Keine weiteren Gruppen für diese Makrogruppe",yes:"Ja",no:"No",back:"Zurück",backto:"Zurück zu ",changemap:"Karte ändern",change_session:"Sitzung ändern",component:"Allgemeine Komponente",search:"Suche",no_results:"Keine Ergebnisse gefunden",print:"Drucken",create_print:"Drucken erstellen",dosearch:"Suche",catalog:"Karte",data:"Daten",externalwms:"WMS",baselayers:"Base",tools:"Tools",tree:"Layers",legend:"Legende",nobaselayer:"Keine Basemap",street_search:"Adresse finden",show:"Anzeigen",hide:"Ausblenden",copy_form_data:"Daten kopieren",paste_form_data:"Einfügen",copy_form_data_from_feature:"Daten von der Karte kopieren",error_map_loading:"Fehler beim Laden der Karte",check_internet_connection_or_server_admin:"Internetverbindung prüfen oder Admin kontaktieren",could_not_load_vector_layers:"Verbindungsfehler: Layers können geladen werden",server_saver_error:"Fehler beim Speichern auf dem Server",server_error:"Server-Verbindungsfehler",save:"Speichern",cancel:"Abbrechen",close:"Schließen",dont_show_again:"Diese Meldung nicht mehr anzeigen",enlange_reduce:"Vergrößern / Verkleinern",reset_default:"Standardgröße",add:"Hinzufügen",exitnosave:"Beenden ohne Speichern",annul:"Abbrechen",layer_is_added:"Layer mit gleichem Namen bereits hinzugefügt",sidebar:{wms:{panel:{title:"WMS Layer hinzufügen",label:{position:"Kartenposition",name:"Name",projections:"Projektion",layers:"Layers"}},add_wms_layer:"WMS Layer hinzufügen",delete_wms_url:"WMS Url löschen",layer_id_already_added:"WMS Layer bereits hinzugefügt",url_already_added:"WMS URL/Name bereits hinzugefügt",layer_add_error:"WMS Layer nicht hinzugefügt. Bitte überprüfen Sie alle WMS-Parameter oder Url"}},info:{title:"Ergebnisse",list_of_relations:"List of Relations",open_link:"Beigefügtes Dokument öffnen",server_error:"Auf dem Server ist ein Fehler aufgetreten",no_results:"Keine Ergebnisse für diese Anfrage/Suche gefunden",link_button:"Öffnen"},mapcontrols:{geolocations:{error:"Position kann nicht bestimmt werden"},nominatim:{placeholder:"Addresse ...",noresults:"Keine Ergebnisse",notresponseserver:"Keine Antwort vom Server"},add_layer_control:{header:"Layer hinzufügen",select_projection:"Layer Projektion auswählen",select_field_to_show:"Feld auswählen, das auf der Karte angezeigt werden soll",select_csv_separator:"Begrenzer auswählen",select_csv_x_field:"X-Feld auswählen",select_csv_y_field:"Y-Feld auswählen",select_color:"Layer Farbe auswählen",drag_layer:"Layer hierher ziehen und ablegen"},query:{input_relation:"Klicken, um Relationen anzuzeigen"},length:{tooltip:"Länge"},area:{tooltip:"Area"},screenshot:{error:"Screenshot Fehlererstellung",securityError:'  \n        <p><b>Sicherheitsfehler</b>: Eine externe Ebene verhindert, dass die Karte gedruckt wird. Gehen Sie zur Überprüfung wie folgt vor:</p>\n        <ol>\n          <li>Entfernen Sie alle manuell hinzugefügten externen Ebenen (z. B. WMS-Ebenen)</li>\n          <li>Neuladen der Seite erzwingen: <code>STRG + F5</code></li>\n          <li>Drucken Sie die Karte erneut</li>\n        </ol>\n        <p>Für weitere Informationen wenden Sie sich bitte an den Serveradministrator zu: <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image" style="color: #000 !important;font -weight: fett;">&#x2139;&#xFE0F; Sicherheit und befleckte Leinwände</a></p>\n        '}},catalog_items:{helptext:"Klicken Sie mit der rechten Maustaste auf einen einzelnen Layer, um auf zusätzliche Funktionen zuzugreifen",contextmenu:{zoomtolayer:"Zoom auf Layer",open_attribute_table:"Attributtabelle öffnen",show_metadata:"Metadaten",styles:"Stile",vector_color_menu:"Farbe einstellen/ändern",layer_opacity:"Opazität"}},dataTable:{previous:"Vorherige",next:"Weiter",lengthMenu:"_MENÜ_ anzeigen",info:"Anzeige von _START_ bis _END_ der _TOTAL_ Einträge",no_data:"Keine Daten",nodatafilterd:"Keine passenden Datensätze gefunden",infoFiltered:"(gefiltert aus _MAX_ Gesamtsätzen)"}}}},{}],330:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default={translation:{error_page:{error:"Connection error",at_moment:"At the moment is not possible show map",f5:"Press Ctrl+F5"},cookie_law:{message:"This website uses cookies to ensure you get the best experience on our website.",buttonText:"Got It!"},default:"default",sign_in:"Sign in",layer_selection_filter:{tools:{filter:"Add/Remove Filter",nofilter:"Remove Filter",invert:"Invert Selection",clear:"Clear Selection",show_features_on_map:"Show features visible on map"}},warning:{not_supported_format:"Not supported format"},layer_position:{top:"TOP",bottom:"BOTTOM",message:"Position relative to layers on TOC"},sdk:{atlas:{template_dialog:{title:"Select Template"}},spatialbookmarks:{title:"Spatial Bookmarks",helptext:"Move on map extent, insert name and click Add",input:{name:"Name"},sections:{project:{title:"Project Bookmarks"},user:{title:"User Bookmarks"}}},search:{all:"ALL",no_results:"No results",searching:"Searching ...",error_loading:"Error Loading Data",layer_not_searchable:"Layer is not searchable",layer_not_querable:"Layer is not querable",autocomplete:{inputshort:{pre:"Please enter",post:"or more characters"}}},print:{no_layers:"No Layer to print",template:"Template",labels:"Labels",scale:"Scale",format:"Format",rotation:"Rotation",download_image:"Download Image",fids_instruction:"Values accepted: from 1 to value of [max]. Is possible to insert a range ex. 4-6",fids_example:"Ex. 1,4-6 will be printed id 1,4,5,6",help:"The layers shown in the print could be those defined on the project and not those displayed on the map"},querybuilder:{search:{run:"Run",info:"Information",delete:"Delete",edit:"Edit"},messages:{changed:"Saved",number_of_features:"Number of features"},panel:{button:{all:"ALL",save:"SAVE",test:"TEST",clear:"CLEAR",run:"RUN",manual:"MANUAL"},layers:"LAYERS",fields:"FIELDS",values:"VALUES",operators:"OPERATORS",expression:"EXPRESSION"},error_run:"An error occurs. Please check the query",error_test:"An error occur during query execution",delete:"Do you want delete it?",additem:"Insert the name of the new search"},errors:{layers:{load:"Some layers are not available"},unsupported_format:"Not supported format",add_external_layer:"Load layer error"},metadata:{title:"Metadata",groups:{general:{title:"GENERAL",fields:{title:"TITLE",name:"NAME",description:"DESCRIPTION",abstract:"ABSTRACT",keywords:"KEYWORDS",fees:"FEES",accessconstraints:"ACCESS CONSTRAINT",contactinformation:"CONTACTS",subfields:{contactinformation:{contactelectronicmailaddress:"Email",personprimary:"References",contactvoicetelephone:"Phone",contactorganization:"Organization",ContactOrganization:"Organization",contactposition:"Position",ContactPosition:"Position",contactperson:"Person",ContactPerson:"Person"}},wms_url:"WMS"}},spatial:{title:"SPATIAL",fields:{crs:"EPSG",extent:"BBOX"}},layers:{title:"LAYERS",fields:{layers:"LAYERS",subfields:{crs:"EPSG",bbox:"BBOX",title:"TITLE",name:"NAME",geometrytype:"GEOMETRY",source:"SOURCE",attributes:"ATTRIBUTES",abstract:"ABSTRACT",attribution:"ATTRIBUTION",keywords:"PAROLE CHIAVE",metadataurl:"METADATA URL",dataurl:"DATA URL"}},groups:{general:"GENERAL",spatial:"SPATIAL"}}}},tooltips:{relations:{form_to_row:"Row View",row_to_form:"Form View"},copy_map_extent_url:"Copy map view link",download_shapefile:"Download Shapefile",download_gpx:"Download GPX",download_gpkg:"Download GPKG",download_csv:"Download CSV",download_xls:"Download XLS",show_chart:"Show Chart",atlas:"Print Atlas"},mapcontrols:{query:{tooltip:"Query layer",actions:{add_selection:{hint:"Add/Remove Selection"},zoom_to_features_extent:{hint:"Zoom to features extent"},add_features_to_results:{hint:"Add/Remove features to results"},remove_feature_from_results:{hint:"Remove feature from results"},zoom_to_feature:{hint:"Zoom to feature"},relations:{hint:"Show Relations"},relations_charts:{hint:"Show relations chart"},download_features_shapefile:{hint:"Download features Shapefile"},download_shapefile:{hint:"Download feature Shapefile"},download_features_gpx:{hint:"Download feature GPX"},download_features_gpkg:{hint:"Download features GPKG"},download_gpx:{hint:"Download feature GPX"},download_gpkg:{hint:"Download feature GPKG"},download_features_csv:{hint:"Download features CSV"},download_csv:{hint:"Download feature CSV"},download_features_xls:{hint:"Download features XLS"},download_xls:{hint:"Download feature XLS"},atlas:{hint:"Print Atlas"},copy_zoom_to_fid_url:{hint:"Copy map URL with this geometry feature extension",hint_change:"Copied"}}},querybypolygon:{download:{title:"Attributes download",choiches:{feature:{label:"Features only"},feature_polygon:{label:"Features+Query Polygon"}}},tooltip:"Query By Polygon",no_geometry:"No geometry on response",help:{title:"Guide - Query By Polygon",message:"\n                <ul>\n                  <li>Select a polygon layer on TOC.</li>\n                  <li>Be sure that layer is visible.</li>\n                  <li>Click on a feature of selected layer.</li>\n                </ul>"}},querybydrawpolygon:{tooltip:"Query by Draw Polygon "},querybybbox:{tooltip:"Query BBox layer",nolayers_visible:"No querable layers are visible. Please set at least one visible wfs layer to run query",help:{title:"Guide - Query BBox layer",message:"\n                  <ul>\n                  <li>Draw a square on map to query underlined layers on TOC</li>\n                  </ul>"}},addlayer:{messages:{csv:{warning:"The result in the map is partial due to the presence of the below incorrect records list:"}},tooltip:"Add Layer"},geolocation:{tooltip:"Geolocation"},measures:{length:{tooltip:"Length",help:"Click on map to draw the line. Press <br>CANC if you want delete last vertex"},area:{tooltip:"Area",help:"Click to draw poligon.Press <br>CANC if you want delete last vertex"}},scale:{no_valid_scale:"Invalid Scale"},scaleline:{units:{metric:"Meters",nautical:"Nautical Mile"}},zoomhistory:{zoom_last:"Zoom Last",zoom_next:"Zoom Next"}},relations:{relation_data:"Relation data",no_relations_found:"No relations found",back_to_relations:"Back to relations",list_of_relations_feature:"List of relations of feature",error_missing_father_field:"Field is missing"},workflow:{steps:{title:"Steps"},next:"Next"},form:{loading:"Loading ...",inputs:{messages:{errors:{picklayer:"No feature selected. Check if layer is on editing or visible at current scale"}},tooltips:{picklayer:"Get value from ma layer",lonlat:"Click on map to get coordinates"},input_validation_mutually_exclusive:"Field mutually exclusive with ",input_validation_error:"Mandatory Field or wrong data type",input_validation_min_field:"Value has to be more/equal to field value  ",input_validation_max_field:"Value has to be less/equal to field value ",input_validation_exclude_values:"Value has to be unique",integer:"integer",bigint:"integer",text:"text",varchar:"text",textarea:"text",string:"string",date:"date",datetime:"date",float:"float",table:"table"},footer:{required_fields:"Required fields"},messages:{qgis_input_widget_relation:"Use relation specific form to work with relation"}},catalog:{current_map_theme_prefix:"THEME",choose_map_theme:"CHOOSE THEME",menu:{layerposition:"Layer Position",setwmsopacity:"Set Opacity",wms:{title:"",copy:"Click here to copy url",copied:"Copied"},download:{unknow:"Download",shp:"Download Shapefile",gpx:"Download GPX",gpkg:"Download GPKG",csv:"Download CSV",xls:"Download XLS",geotiff:"Download GEOTIFF",geotiff_map_extent:"Download GEOTIFF(current view extent)"}}},wps:{list_process:"List of process",tooltip:"Click on map"}},credits:{g3wSuiteFramework:"Application based on OS framework",g3wSuiteDescription:"Publish and manage your QGIS projects on the web",productOf:"Framework developed by"},toggle_color_scheme:"Toggle color scheme",logout:"Logout",no_other_projects:"No more project for this group",no_other_groups:"No more groups for this Macrogroup",yes:"Yes",no:"No",back:"Back",backto:"Back to ",changemap:"Change Map",change_session:"Change Session",component:"Generic Component",search:"Search",no_results:"No results found",print:"Print",create_print:"Create Print",dosearch:"Search",catalog:"Map",data:"Data",externalwms:"WMS",baselayers:"Base",tools:"Tools",tree:"Layers",legend:"Legend",nobaselayer:"No basemap",street_search:"Find Address",show:"Show",hide:"Hide",copy_form_data:"Copy data",paste_form_data:"Paste",copy_form_data_from_feature:"Copy data from map",error_map_loading:"Error occurs loading map",check_internet_connection_or_server_admin:"Check internet connection or contact admin",could_not_load_vector_layers:"Connection error: Layers can be loaded",server_saver_error:"Error in server saving",server_error:"Server connection error",save:"Save",cancel:"Cancel",close:"Close",dont_show_again:"Don't show again",enlange_reduce:"Enlarge / Reduce",reset_default:"Default size",add:"Add",exitnosave:"Exit without save",annul:"Cancel",layer_is_added:"Layer with same name already added",sidebar:{wms:{panel:{title:"Add WMS Layer",label:{position:"Map Position",name:"Name",projections:"Projection",layers:"Layers"}},add_wms_layer:"Add WMS layer",delete_wms_url:"Delete WMS url",layer_id_already_added:"WMS Layer already added",url_already_added:"WMS URL/Name already added",layer_add_error:"WMS Layer not added. Please check all wms parameter or url"}},info:{title:"Results",list_of_relations:"List of Relations",open_link:"Open attached document",server_error:"An error occurred from server",no_results:"No results found for this query/search",link_button:"Open"},mapcontrols:{geolocations:{error:"Can't get your position"},nominatim:{placeholder:"Address ...",noresults:"No results",notresponseserver:"No response from server"},add_layer_control:{header:"Add Layer",select_projection:"Select layer projection",select_field_to_show:"Select Field to show on map",select_csv_separator:"Select delimiter",select_csv_x_field:"Select X field",select_csv_y_field:"Select Y field",select_color:"Select Layer Color",drag_layer:"Drag and drop layer here"},query:{input_relation:"Click to show relations"},length:{tooltip:"Length"},area:{tooltip:"Area"},screenshot:{error:"Screenshot error creation",securityError:'  \n        <p><b>Security Error</b>: an external layer is preventing map from being printed. To check, proceed as follows:</p>\n        <ol>\n          <li>remove any manually added external layers (eg. WMS layers)</li>\n          <li>force page reload: <code>CTRL + F5</code></li>\n          <li>print again the map</li>\n        </ol>\n        <p>For more info please contact server administrator about: <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image" style="color: #000 !important;font-weight: bold;">&#x2139;&#xFE0F; security and tainted canvases</a></p>\n        '}},catalog_items:{helptext:"Right-click on individual layer to access additional features",contextmenu:{zoomtolayer:"Zoom to Layer",open_attribute_table:"Open Attribute Table",show_metadata:"Metadata",styles:"Styles",vector_color_menu:"Set/Change Color",layer_opacity:"Opacity"}},dataTable:{previous:"Previous",next:"Next",lengthMenu:"Show _MENU_",info:"Showing _START_ to _END_ of _TOTAL_ entries",no_data:"No data",nodatafilterd:"No matching records found",infoFiltered:"(filtered from _MAX_ total records)"}}}},{}],331:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default={translation:{error_page:{error:"Yhteysvirhe",at_moment:"Tällä hetkellä ei ole mahdollista näyttää karttaa",f5:"Paina Ctrl+F5"},cookie_law:{message:"This website uses cookies to ensure you get the best experience on our website.",buttonText:"Got It!"},default:"oletuksena",sign_in:"Kirjaudu sisään",layer_selection_filter:{tools:{filter:"Lisätä/Poista Suodattaa",nofilter:"Poista Suodattaa",invert:"Käänteinen Valinta",clear:"Peruuttaa Valinta",show_features_on_map:"Näytä kartalla näkyvät ominaisuudet"}},warning:{not_supported_format:"Not supported format"},layer_position:{top:"TOP",bottom:"BOTTOM",message:"Position relative to layers on TOC"},sdk:{atlas:{template_dialog:{title:"Valitse Template"}},spatialbookmarks:{title:"Tilalliset kirjanmerkit",helptext:"Siirry kartan laajuuteen, lisää nimi ja napsauta Lisää",input:{name:"Nimi"},sections:{project:{title:"Projektin kirjanmerkit"},user:{title:"Käyttäjän kirjanmerkit"}}},search:{all:"KAIKKI",no_results:"Ei tuloksia",searching:"Haetaan ...",error_loading:"Virhe ladattaessa tietoja.",layer_not_searchable:"Taso ei ole haettavissa.",layer_not_querable:"Tasolle ei voi suorittaa kyselyitä.",autocomplete:{inputshort:{pre:"Syötä",post:"tai useampi merkki"}}},print:{no_layers:"Ei tulostettavia tasoja",template:"Template",labels:"Labels",scale:"Mittakaava",format:"Formaatti",rotation:"Kierto",download_image:"Lataa kuva",fids_instruction:"Hyväksytyt arvot: yhdestä arvoon [max]. Salittua syöttää myös väli, esim. 4-6.",fids_example:"Esimerkiksi 1,4-6 tulostuu id 1,4,5,6.",help:"Tulosteessa esiintyvät tasot voivat olla projektissa määriteltyjä ei kartalla esiintyviä."},querybuilder:{search:{run:"Suorita",info:"Informaatio",delete:"Poista",edit:"Muokkaa"},messages:{changed:"Tallennettu",number_of_features:"Ominaisuuksien lukumäärä"},panel:{button:{all:"KAIKKI",save:"TALLENNA",test:"TESTI",clear:"TYHJENNÄ",run:"SUORITA",manual:"MANUAALINEN"},layers:"TASOT",fields:"KENTÄT",values:"ARVOT",operators:"OPERAATTORIT",expression:"LAUSEKE"},error_run:"Tapahtui virhe. Tarkista kysely.",error_test:"Kyselyä suorittaessa tapahtui virhe.",delete:"Haluatko poistaa sen?",additem:"Anna nimi uudelle haulle."},errors:{layers:{load:"Jotkin tasot eivät ole saatavilla."},unsupported_format:"Ei tuettu formaatti",add_external_layer:"Tason latausvirhe"},metadata:{title:"Metatiedot",groups:{general:{title:"YLEINEN",fields:{title:"OTSIKKO",name:"NIMI",description:"KUVAUS",abstract:"TIIVISTELMÄ",keywords:"AVAINSANAT",fees:"MAKSUT",accessconstraints:"PÄÄSYRAJOITUKSET",contactinformation:"YHTEYSTIEDOT",subfields:{contactinformation:{contactelectronicmailaddress:"Sähköposti",personprimary:"Viitteet",contactvoicetelephone:"Puhelin",contactorganization:"Organisaatio",ContactOrganization:"Organisaatio",contactposition:"Asema",ContactPosition:"Asema",contactperson:"Yhteyshenkilö",ContactPerson:"Yhteyshenkilö"}},wms_url:"WMS"}},spatial:{title:"SPATIAL",fields:{crs:"EPSG",extent:"BBOX"}},layers:{title:"TASOT",fields:{layers:"TASOT",subfields:{crs:"EPSG",bbox:"BBOX",title:"OTSIKKO",name:"NIMI",geometrytype:"GEOMETRIA",source:"LÄHDE",attributes:"ATTRIBUUTIT",abstract:"TIIVISTELMÄ",attribution:"ATTRIBUUTIO",keywords:"AVAINSANAT",metadataurl:"METATIEDON URL",dataurl:"DATA URL"}},groups:{general:"YLEINEN",spatial:"SPATIAL"}}}},tooltips:{relations:{form_to_row:"Rivinäkymä",row_to_form:"Taulukkonäkymä"},copy_map_extent_url:"Kopioi kartan katselulinkki",download_shapefile:"Lataa SHP-tiedosto",download_gpx:"Lataa GPX-tiedosto",download_gpkg:"Lataa GPKG-tiedosto",download_csv:"Lataa CSV-tiedosto",download_xls:"Lataa XLS-tiedosto",show_chart:"Näytä kaavio",atlas:"Tulosta Atlas"},mapcontrols:{query:{tooltip:"Kyselytaso",actions:{add_selection:{hint:"Lisää/Poista valinta"},zoom_to_features_extent:{hint:"Tarkenna ominaisuuden laajuuteen"},add_features_to_results:{hint:"Add/Remove features to results"},remove_feature_from_results:{hint:"Remove feature from results"},zoom_to_feature:{hint:"Tarkenna ominaisuuteen"},relations:{hint:"Näytä relaatiot"},relations_charts:{hint:"Näytä relaatiokaavio"},download_features_shapefile:{hint:"Lataa ominaisuuden SHP-tiedosto"},download_shapefile:{hint:"Lataa ominaisuuden SHP-tiedosto"},download_features_gpx:{hint:"Lataa ominaisuuden GPX-tiedosto"},download_features_gpkg:{hint:"Lataa ominaisuuden GPKG-tiedosto"},download_gpx:{hint:"Lataa ominaisuuden GPX-tiedosto"},download_gpkg:{hint:"Lataa ominaisuuden GPKG-tiedosto"},download_features_csv:{hint:"Lataa ominaisuuden CSV-tiedosto"},download_csv:{hint:"Lataa ominaisuuden CSV-tiedosto"},download_features_xls:{hint:"Lataa ominaisuuden XLS-tiedosto"},download_xls:{hint:"Lataa ominaisuuden XLS-tiedosto"},atlas:{hint:"Tulosta Atlas"},copy_zoom_to_fid_url:{hint:"Copy map URL with this geometry feature extension",hint_change:"Copied"}}},querybypolygon:{download:{title:"Attributes download",choiches:{feature:{label:"Features only"},feature_polygon:{label:"Features+Query Polygon"}}},tooltip:"Kysely monikulmiolla",no_geometry:"No geometry on response",help:{title:"Ohje - Kysely monikulmiolla",message:"\n                <ul>\n                  <li>Valitse monikulmiotaso luettelosta.</li>\n                  <li>Tarkista, että taso on näkyvillä.</li>\n                  <li>Valitse ominaisuus valitulla tasolla.</li>\n                </ul>"}},querybydrawpolygon:{tooltip:"Kysely piirtopolygonin mukaan"},querybybbox:{tooltip:"Tasoon kohdituva BBox-kysely",nolayers_visible:"Ei kyseltäviä tasoja näkyvillä. Aseta vähintään yksi WFS-taso näkyväksi suorittaaksesi haun.",help:{title:"Ohje - Tasoon kohdistuva BBox-kysely",message:"\n                 <ul>\n                  <li>Piirrä suorakulmio kartalle suorittaaksesi kyselyn luettelossa alleviivatuille tasoille.</li>\n                 </ul>"}},addlayer:{messages:{csv:{warning:"The result in the map is partial due to the presence of the below incorrect records list:"}},tooltip:"Lisää taso"},geolocation:{tooltip:"Maantieteellinen sijainti"},measures:{length:{tooltip:"Pituus",help:"Piirrä murtoviiva kartalle. Paina <br>CANC, mikäli haluat poistaa edellisen pisteen."},area:{tooltip:"Alue",help:"Piirrä monikulmio kartalle. Paina <br>CANC, mikäli haluat poistaa edellisen pisteen."}},scale:{no_valid_scale:"Väärä mittakaava"},scaleline:{units:{metric:"Meters",nautical:"Nautical Mile"}},zoomhistory:{zoom_last:"Zoom Edellinen",zoom_next:"Zoom Seurata"}},relations:{relation_data:"Relaation tiedot",no_relations_found:"Relaatiota ei löytynyt.",back_to_relations:"Takaisin relaatioihin",list_of_relations_feature:"Lista ominaisuuden relaatioista",error_missing_father_field:"Kenttä puuttu"},workflow:{steps:{title:"Vaiheet"},next:"Seuraava"},form:{loading:"Ladataan...",inputs:{messages:{errors:{picklayer:"Ominaisuuksia ei valiitu. Tarkista, että taso on muokattavissa tai näkyvissä nykyisellä mittakaavalla."}},tooltips:{picklayer:"Valitse arvo karttatasolta",lonlat:"Click on map to get coordinates"},input_validation_mutually_exclusive:"Kenttä toisensa poissulkeva.",input_validation_error:"Pakollinen kenttä tai väärä tietotyyppi.",input_validation_min_field:"Arvon tulee olla suurempi tai yhtäsuuri kuin kentän arvo.",input_validation_max_field:"Arvon tulee olla pienempi tai yhtäsuuri kuin kentän arvo.",input_validation_exclude_values:"Arvon tulee olla uniikki.",integer:"kokonaisluku",bigint:"kokonaisluku",text:"teksti",varchar:"teksti",textarea:"teksti",string:"merkkijono",date:"päiväys",datetime:"päiväys",float:"liukuluku",table:"taulukko"},footer:{required_fields:"Vaaditut kentät"},messages:{qgis_input_widget_relation:"Käytä relaatioiden määrittämiseen tähän tarkoitettua toimintoa"}},catalog:{current_map_theme_prefix:"THEME",choose_map_theme:"CHOOSE THEME",menu:{layerposition:"Layer Position",setwmsopacity:"Set Opacity",wms:{title:"",copy:"Paina tästä kopioidaksesi url:n.",copied:"Kopioitu."},download:{unknow:"Lataa",shp:"Lataa SHP-tiedosto",gpx:"Lataa GPX-tiedosto",gpkg:"Lataa GPKG-tiedosto",csv:"Lataa CSV-tiedosto",xls:"Lataa XLS-tiedosto",geotiff:"Lataa GEOTIFF-tiedosto",geotiff_map_extent:"Lataa GEOTIFF-tiedosto(current view extent)"}}},wps:{list_process:"Lista prosesseista",tooltip:"Valitse kartalta"}},credits:{g3wSuiteFramework:"Sovellus perustuu OS framework",g3wSuiteDescription:"Julkaise ja hallinnoi QGIS-projekteja verkossa.",productOf:"Frameworkin on kehittänyt"},toggle_color_scheme:"Toggle color scheme",logout:"Kirjaudu ulos",no_other_projects:"Ei projekteja tälle ryhmälle",no_other_groups:"Ei enää ryhmiä tälle makroryhmälle",yes:"Kyllä",no:"Ei",back:"Palaa",backto:"Takaisin ",changemap:"Vaihda karttaa",change_session:"Vaihda istuntoa",component:"Yleinen komponentti",search:"Hae",no_results:"Ei hakutuloksia",print:"Tulosta",create_print:"Luo tuloste",dosearch:"Hae",catalog:"Kartta",data:"Data",externalwms:"WMS",baselayers:"Taustakartta",tools:"Työkalut",tree:"Tasot",legend:"Merkintöjen selite",nobaselayer:"Ei taustakarttaa",street_search:"Hae osoite",show:"Näytä",hide:"Piilota",copy_form_data:"Kopioi tiedot",paste_form_data:"Liitä",copy_form_data_from_feature:"Kopioi tiedot kartalta",error_map_loading:"Virhe ladattessa karttaa",check_internet_connection_or_server_admin:"Tarkista internetyhteys tai ota yhteyttä ylläpitäjään.",could_not_load_vector_layers:"Yhteysvirhe, tasoja ei voida ladata.",server_saver_error:"Virhe tallentaessa palvelimelle.",server_error:"Yhteysvirhe palvelimeen",save:"Tallenna",cancel:"Peruuta",close:"Sulje",dont_show_again:"Älä näytä viestiä uudelleen",enlange_reduce:"Suurenna / Pienennä",reset_default:"Oletuskoko",add:"Lisää",exitnosave:"Poistu tallentamatta",annul:"Peruuta",layer_is_added:"Samanniminen taso on jo lisätty.",sidebar:{wms:{panel:{title:"Add WMS Layer",label:{position:"Map Position",name:"Name",projections:"Projection",layers:"Layers"}},add_wms_layer:"Aggiungi WMS layer",delete_wms_url:"Delete WMS url",layer_id_already_added:"WMS Taso on jo lisätty.",url_already_added:"WMS URL/Nimi on jo lisätty.",layer_add_error:"WMS Layer not added. Please check all wms parameter or url"}},info:{title:"Tulokset",list_of_relations:"List of Relations",open_link:"Avaa liitetiedosto",server_error:"Palvelimella tapahtui virhe.",no_results:"Ei tuloksia haulle/kyselylle.",link_button:"Avaa"},mapcontrols:{geolocations:{error:"Sijaintiasi ei saada"},nominatim:{placeholder:"Osoite ...",noresults:"Ei tuloksia",notresponseserver:"Ei vastausta palvelimelta"},add_layer_control:{header:"Lisää taso",select_projection:"Valitse tason projektio",select_field_to_show:"Select Field to show on map",select_csv_separator:"Select delimiter",select_csv_x_field:"Select X field",select_csv_y_field:"Select Y field",select_color:"Valitse tason väri",drag_layer:"Vedä ja pudota taso tähän"},query:{input_relation:"Paina näyttääksesi relaatiot"},length:{tooltip:"Pituus"},area:{tooltip:"Pinta-ala"},screenshot:{error:"Screenshot error creation",securityError:'  \n        <p><b>Turvallisuusvirhe</b>: ulkoinen kerros estää karttaa tulostamasta. Tarkistaaksesi, toimi seuraavasti:</p>\n        <ol>\n          <li>poista manuaalisesti lisätyt ulkoiset tasot (esim. WMS-tasot)</li>\n          <li>Pakota sivun uudelleenlataus: <code>CTRL + F5</code></li>\n          <li>tulosta kartta uudelleen</li>\n        </ol>\n        <p>Saat lisätietoja palvelimen järjestelmänvalvojalta seuraavista aiheista: <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image" style="color: #000 !important;font -paino: lihavoitu;">&#x2139;&#xFE0F; turvallisuus ja likaiset kankaat</a></p>\n        '}},catalog_items:{helptext:"Napsauta hiiren kakkospainikkeella yksittäistä tasoa päästäksesi lisäominaisuuksiin.",contextmenu:{zoomtolayer:"Tarkenna tasoon",open_attribute_table:"Avaa attribuuttitaulu",show_metadata:"Metatiedot",styles:"Tyylejä",vector_color_menu:"Aseta/muuta väriä",layer_opacity:"Peittävyys"}},dataTable:{previous:"Edellinen",next:"Seuraava",lengthMenu:"Show _MENU_ items",info:"Showing _START_ to _END_ of _TOTAL_ entries",no_data:"Ei tietoja",nodatafilterd:"Vastaavia tietueita ei löytynyt",infoFiltered:"(filtered from _MAX_ total records)"}}}},{}],332:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default={translation:{error_page:{error:"Erreur de connexion",at_moment:"Pour le moment, il n'est pas possible d'afficher la carte",f5:"Appuyez sur Ctrl+F5"},cookie_law:{message:"Ce site utilise des cookies pour assurer une bonne convivialité pour l'utilisateur final.",buttonText:"J’ai compris !"},default:"par défaut ",sign_in:"Se connecter ",layer_selection_filter:{tools:{filter:"Ajout/Suppression de filtre ",nofilter:"Supprimer le filtre ",invert:"Sélection inversée ",clear:"Effacer la sélection ",show_features_on_map:"Afficher les caractéristiques visibles sur la carte"}},warning:{not_supported_format:"Not supported format"},layer_position:{top:"TOP",bottom:"BOTTOM",message:"Position relative to layers on TOC"},sdk:{atlas:{template_dialog:{title:"Sélectionnez Template"}},spatialbookmarks:{title:"Signets spatiaux",helptext:"Déplacez-vous sur l'étendue de la carte, insérez le nom et cliquez sur Ajouter",input:{name:"Nom"},sections:{project:{title:"Signets du projet"},user:{title:"Signets de l'utilisateur"}}},search:{all:"TOUTES",no_results:"Aucune valeur trouvée",searching:"Je cherche...",error_loading:"Erreur de chargement des valeurs",layer_not_searchable:"Le layer n’est pas recherchable",layer_not_querable:"Le layer n'est pas interrogeable",autocomplete:{inputshort:{pre:"Tapez au moins",post:"caractères"}}},print:{no_layers:"Aucune layer visible",scale:"Échelle",format:"Format",rotation:"Rotation",download_image:"Télécharger l'image",fids_instruction:"Valeurs acceptées : de 1 à la valeur maximale indiquée par [max]. Il est également possible d'indiquer une fourchette de valeurs, par exemple 4-6",fids_example:"Par exemple 1,4-6 les ids 1,4,5,6 seront imprimés",help:"Les layers montrés dans l'impression peuvent être ceux définis dans le projet et non ceux montrés sur la carte"},querybuilder:{search:{run:"Lancer la recherche",info:"Information",delete:"Supprimer",edit:"Editer"},messages:{changed:"Enregistré correctement",number_of_features:"Nombre de fonctionnalités"},panel:{button:{all:"TOUTES",save:"SAUVEGARDER",test:"TESTER",clear:"NETTOYER",run:"EXECUTER",manual:"MANUEL"},layers:"LAYERS",fields:"CHAMPS",values:"VALEURS",operators:"OPERATEURS",expression:"EXPRESSION"},error_run:"Une erreur s'est produite. Vérifiez si la requête est correcte",error_test:"Erreur d'exécution de la requête",delete:"Voulez-vous confirmer la suppression ?",additem:"Entrer le nom de la requête"},errors:{layers:{load:"Certaines layers du projet ne sont pas disponibles actuellement et n'apparaissent donc pas dans la vue actuelle"},unsupported_format:"Format non supporté",add_external_layer:"Erreur lors du chargement du layer"},metadata:{title:"Métadonnées",groups:{general:{title:"GÉNÉRAL",fields:{title:"TITRE",name:"NOM",description:"DESCRIPTION",abstract:"ABREGE",keywords:"LISTE DE MOTS-CLÉS",fees:"DROITS D'INSCRIPTION",accessconstraints:"CONTRAINTES D'ACCÈS",contactinformation:"CONTACTS",subfields:{contactinformation:{contactelectronicmailaddress:"E-mail",personprimary:"Références",contactvoicetelephone:"Téléphone",contactorganization:"Organisation",ContactOrganization:"Organisation",contactposition:"Localisation",ContactPosition:"Localisation",contactperson:"Personne",ContactPerson:"Personne"}},wms_url:"WMS"}},spatial:{title:"INFO ESPACE",fields:{crs:"EPSG",extent:"BBOX"}},layers:{title:"STRATES",groups:{general:"GENERALE",spatial:"INFO ESPACE"},fields:{layers:"STRATES",subfields:{crs:"EPSG",bbox:"BBOX",title:"TITRE",name:"NOM",geometrytype:"GÉOMÉTRIE",source:"SOURCE",attributes:"ATTRIBUTES",abstract:"ABRÉGÉ",attribution:"ATTRIBUTION",keywords:"MOTS- CLÉS",metadataurl:"URL DE MÉTADONNÉES",dataurl:"URL DES DONNÉES"}}}}},tooltips:{relations:{form_to_row:"Afficher le format de la ligne",row_to_form:"Format du formulaire d'affichage"},zoom_to_features_extent:"Zoom sur les fonctionnalités",copy_map_extent_url:"Copier le lien de visualisation de la carte",download_shapefile:"Télécharger le fichier Shapefile",download_gpx:"Télécharger GPX",download_gpkg:"Télécharger GPKG",download_csv:"Télécharger CSV",download_xls:"Télécharger XLS",show_chart:"Montrer graphique",atlas:"Imprimer l'Atlas"},mapcontrols:{query:{tooltip:"Interrogation layer",actions:{add_selection:{hint:"Ajouter/supprimer une sélection"},zoom_to_features_extent:{hint:"Zoom sur les fonctionnalités"},add_features_to_results:{hint:"Ajouter des fonctionnalités aux résultats"},remove_feature_from_results:{hint:"Supprimer la fonctionnalité des résultats"},zoom_to_feature:{hint:"Zoom sur les fonctionnalités"},relations:{hint:"Voir les relations"},relations_charts:{hint:"Voir les graphiques de relations"},download_features_shapefile:{hint:"Télécharger les fonctionnalités vers Shapefile"},download_shapefile:{hint:"Télécharger le Shapefile"},download_features_gpx:{hint:"Télécharger les fonctionnalités vers GPX"},download_features_gpkg:{hint:"Télécharger les fonctionnalités vers GPKG"},download_gpx:{hint:"Télécharger le GPX"},download_gpkg:{hint:"Télécharger le GPKG"},download_features_csv:{hint:"Télécharger les fonctionnalités vers CSV"},download_csv:{hint:"Télécharger le CSV"},download_features_xls:{hint:"Télécharger les fonctionnalités vers XLS"},download_xls:{hint:"Télécharger le XLS"},atlas:{hint:"Imprimer l'Atlas"},copy_zoom_to_fid_url:{hint:"Copier l'URL de la carte avec l'extension vers cette géométrie",hint_change:"Copié"}}},querybypolygon:{download:{title:"Téléchargement des attributs",choiches:{feature:{label:"Fonctionnalités seulement"},feature_polygon:{label:"Fonctionnalités+Requête Polygon "}}},tooltip:"Requête par polygone",no_geometry:"La réponse ne contient pas de géométrie",help:{title:"Aide - Requête par polygone",message:"\n                <ul>\n                  <li>Sélectionnez un layer de polygone dans la légende.</li>\n                  <li>Vérifiez que le layer est visible dans la carte.</li>\n                  <li>Cliquez sur une géométrie du layer sélectionné.</li>\n                </ul>"}},querybydrawpolygon:{tooltip:"Requête par polygone de dessin"},querybybbox:{tooltip:"Requête pour BBOX",nolayers_visible:"Aucun layer requêtable n'est visible. Assurez-vous qu'au moins un layer wfs est visible pour exécuter la requête",help:{title:"Aide - Requête BBox",message:"\n                  <ul>\n                    <li>Dessinez un rectangle pour interroger les couches surlignées en jaune</li>\n                 </ul>\n            "}},addlayer:{messages:{csv:{warning:"Le résultat de la carte est partiel en raison de la présence des enregistrements incorrects suivants :"}},tooltip:"Ajouter un layer"},geolocation:{tooltip:"Géolocalisation"},measures:{length:{tooltip:"Longueur",help:"Cliquez sur la carte pour continuer à dessiner la ligne.<br>CANC si vous voulez supprimer le dernier vertex inséré"},area:{tooltip:"Zone",help:"Cliquez pour continuer à dessiner le polygone.<br>CANC si vous voulez supprimer le dernier vertex inséré"}},scale:{no_valid_scale:"Échelle invalide"},scaleline:{units:{metric:"Meters",nautical:"Nautical Mile"}},zoomhistory:{zoom_last:"Zoom Précédent",zoom_next:"Zoom Suivant"}},relations:{relation_data:"Données relationnelles",no_relations_found:"Aucune relation trouvée",back_to_relations:"Retour aux relations",list_of_relations_feature:"Liste des relations entre les caractéristiques",error_missing_father_field:"Le champ concerné n'existe pas"},workflow:{steps:{title:"Étapes"},next:"Suivant"},form:{loading:"Chargement...",inputs:{messages:{errors:{picklayer:"Aucune fonction sélectionnée. Vérifier si le layer est en édition ou non visible à l'échelle actuelle"}},tooltips:{picklayer:"Obtenir la valeur de la carte",lonlat:"Cliquez sur la carte pour obtenir les coordonnées"},input_validation_mutually_exclusive:"Champ mutuellement exclusif avec ",input_validation_error:"Champ obligatoire ou type de valeur incorrect",input_validation_min_field:"La valeur doit être supérieure ou égale au camp ",input_validation_max_field:"La valeur doit être inférieure ou égale au champ ",input_validation_exclude_values:"Le champ doit contenir une valeur différente",integer:"entier",bigint:"entier",text:"textuel",varchar:"textuel",textarea:"textuel",string:"chaîne",date:"date",datetime:"date",float:"float",table:"table"},footer:{required_fields:"Champs obligatoires"},messages:{qgis_input_widget_relation:"Gérer les relations via un formulaire dédié"}},catalog:{current_map_theme_prefix:"THEME",choose_map_theme:"SÉLECTIONNEZ LE THÈME",menu:{layerposition:"Layer Position",setwmsopacity:"Set Opacity",wms:{title:"",copy:"Cliquez ici pour copier l'url",copied:"Copié"},download:{unknow:"Télécharger",shp:"Télécharger Shapefile",gpx:"Télécharger GPX",gpkg:"Télécharger GPKG",csv:"Télécharger CSV",xls:"Télécharger XLS",geotiff:"Télécharger GEOTIFF",geotiff_map_extent:"Télécharger GEOTIFF(current view extent)"}}},wps:{list_process:"Liste des processus",tooltip:"Cliquez sur la carte"}},credits:{g3wSuiteFramework:"Application construite avec le framework OS",g3wSuiteDescription:"Publiez et gérez vos projets QGIS sur le Web",productOf:"Framework développé par"},logout:"Quitter",no_other_projects:"Il n'y a pas d'autres projets dans ce groupe de cartes",no_other_groups:"Il n'y a pas d'autres groupes dans ce macrogroupe",yes:"Oui",no:"No",back:"Retour",backto:"Retour à ",changemap:"Changer de carte",change_session:"Changer de séance",component:"Composant générique",search:"Recherches",no_results:"Aucun résultat trouvé",print:"Imprimer",create_print:"Créer une impression",dosearch:"Recherche",catalog:"Carte",data:"Données",externalwms:"WMS",baselayers:"Bases",tools:"Outils",tree:"Strates",legend:"Légende",nobaselayer:"Pas de carte de base",street_search:"Adresse de recherche",show:"Afficher",hide:"Cacher",copy_form_data:"Copier les données du formulaire",paste_form_data:"Coller",copy_form_data_from_feature:"Copier les données de la carte",error_map_loading:"Erreur de chargement de la nouvelle carte",check_internet_connection_or_server_admin:"Vérifiez la connexion internet ou contactez l'administrateur",could_not_load_vector_layers:"Erreur de connexion au serveur : il n'a pas été possible de charger les vecteurs demandés",server_saver_error:"Erreur de sauvegarde sur le serveur",server_error:"Une erreur s'est produite dans la requête au serveur",save:"Sauvegarder",cancel:"Supprimer",close:"Fermer",dont_show_again:"Ne plus afficher ce message",enlange_reduce:"Agrandir / Réduire",reset_default:"Taille par défaut",add:"Ajouter",exitnosave:"Quitter sans sauvegarder",annul:"Annuler",layer_is_added:"Layer avec le même nom déjà ajouté",wms_layer_id_already_added:"WMS Layer déjà ajouté",wms_url_already_added:"WMS URL déjà ajouté",sidebar:{wms:{panel:{title:"Add WMS Layer",label:{position:"Map Position",name:"Name",projections:"Projection",layers:"Layers"}},add_wms_layer:"Add WMS layer",delete_wms_url:"Delete WMS url",layer_id_already_added:"WMS Nivån har redan lagts till.",url_already_added:"WMS URL/Nom har redan lagts till.",layer_add_error:"WMS Layer not added. Please check all wms parameter or url"}},info:{title:"Résultats",list_of_relations:"List of Relations",open_link:"Ouvrir le document joint",server_error:"Une erreur s'est produite dans la requête au serveur",no_results:"Aucun résultat pour cette requête/recherche",link_button:"Ouvrir"},mapcontrols:{geolocations:{title:"",error:"Votre position ne peut être calculée."},nominatim:{placeholder:"Adresse ...",noresults:"Aucun résultat",notresponseserver:"Le serveur ne répond pas"},add_layer_control:{header:"Ajouter un layer",select_projection:"Sélectionnez le système de projection de couches",select_field_to_show:"Sélectionnez le champ à afficher sur la carte",select_csv_separator:"Sélectionner le séparateur",select_csv_x_field:"Sélectionnez le champ X",select_csv_y_field:"Sélectionnez le champ Y",select_color:"Sélectionnez la couleur du layer",drag_layer:"Faire glisser le layer vers cette zone"},query:{input_relation:"Cliquez pour voir les relations"},length:{tooltip:"Longueur"},area:{tooltip:"Zone"},screenshot:{error:"Erreur de création de la capture d'écran",securityError:'  \n        <p><b>Erreur de sécurité</b> : une couche externe empêche l\'impression de la carte. Pour vérifier, procédez comme suit :</p>\n        <ol>\n          <li>supprimer toutes les couches externes ajoutées manuellement (par exemple, les couches WMS)</li>\n          <li>forcer le rechargement de la page : <code>CTRL + F5</code></li>\n          <li>imprimer à nouveau la carte</li>\n        </ol>\n        <p>Pour plus d\'informations, veuillez contacter l\'administrateur du serveur à propos de : <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image" style="color: #000 !important;font -poids : gras ;">&#x2139;&#xFE0F; sécurité et toiles souillées</a></p>\n        '}},catalog_items:{helptext:"Cliquez avec le bouton droit de la souris sur les différents layers pour accéder à des fonctionnalités supplémentaires",contextmenu:{zoomtolayer:"Zoom sur le layer",open_attribute_table:"Table d'attributs ouverte",show_metadata:"Métadonnées",styles:"Styles",vector_color_menu:"Définir/changer la couleur",layer_opacity:"Opacité"}},dataTable:{previous:"Précédent",next:"Suivant",lengthMenu:"Afficher _MENU_",info:"Afficher _START_ à _END_ sur _TOTAL_ lignes",nodatafilterd:"Aucun résultat trouvé",infoFiltered:"(Filtré par _MAX_ rangs totaux)"}}}},{}],333:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=u(e("./it")),i=u(e("./en")),a=u(e("./fi")),o=u(e("./se")),s=u(e("./fr")),l=u(e("./de")),e=u(e("./ro"));function u(e){return e&&e.__esModule?e:{default:e}}n={it:n.default,en:i.default,fi:a.default,se:o.default,fr:s.default,de:l.default,ro:e.default};r.default=n},{"./de":329,"./en":330,"./fi":331,"./fr":332,"./it":334,"./ro":335,"./se":336}],334:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default={translation:{error_page:{error:"Errore di connessione",at_moment:"Al momento non è possibile caricare la mappa",f5:"Premi Ctrl+F5"},cookie_law:{message:"Questo sito utilizza i cookie per garantire una buona usabilità all'utilizzatore finale.",buttonText:"Ho capito!"},default:"predefinito",sign_in:"Accedi",layer_selection_filter:{tools:{filter:"Aggiungi/Rimuovi Filtro",nofilter:"Rimuovi filtro",invert:"Inverti Selezione",clear:"Annulla selezione",show_features_on_map:"Mostra features visibili su mappa"}},warning:{not_supported_format:"Formato non supportato"},layer_position:{top:"SOPRA",bottom:"IN FONDO",message:"Posizione rispetto ai layers della TOC"},sdk:{atlas:{template_dialog:{title:"Seleziona Template"}},spatialbookmarks:{title:"Segnalibri Spaziali",helptext:"Posizionati all'estensione del tuo nuovo segnalibro, definisci il nome e clicca Aggiungi",input:{name:"Nome"},sections:{project:{title:"Segnalibri Progetto"},user:{title:"Segnalibri Utente"}}},search:{all:"TUTTE",no_results:"Nessun valore trovato",searching:"Sto cercando ..",error_loading:"Errore nel caricamento valori",layer_not_searchable:"Il layer non è ricercabile",layer_not_querable:"Il layer non è interrogabile",autocomplete:{inputshort:{pre:"Digita almeno",post:"caratteri"}}},print:{no_layers:"Nessun Layer visibile",template:"Template",labels:"Etichette",scale:"Scala",format:"Formato",rotation:"Rotazione",download_image:"Scarica Immagine",fids_instruction:"Valori accettati: da 1 al valore massimo indicato da [max]. Possibile indicare anche range di valori es. 4-6",fids_example:"Es. 1,4-6 verranno stampati gli id 1,4,5,6",help:"I layers mostrati nella stampa potrebbero essere quelli definiti sul progetto e non quelli visualizzati sulla mappa"},querybuilder:{search:{run:"Lancia ricerca",info:"Informazioni",delete:"Cancella",edit:"Modifica"},messages:{changed:"Salvato correttamente",number_of_features:"Numero di features"},panel:{button:{all:"TUTTI",save:"SALVA",test:"TEST",clear:"PULISCI",run:"ESEGUI",manual:"MANUALE"},layers:"LAYERS",fields:"CAMPI",values:"VALORI",operators:"OPERATORI",expression:"ESPRESSIONE"},error_run:"Si è verificato un errore. Verificare se la query è corretta",error_test:"Errore nell'esecuzione della query",delete:"Vuoi confermare la cancellazione?",additem:"Inserisci nome della ricerca"},errors:{layers:{load:"Alcuni layers presenti nel progetto non sono attualmente disponibili e quindi non compaiono nell'attuale visualizzazione"},unsupported_format:"Formato non supportato",add_external_layer:"Errore nel caricamento del layer"},metadata:{title:"Metadati",groups:{general:{title:"GENERALE",fields:{title:"TITOLO",name:"NOME",description:"DESCRIZIONE",abstract:"ABSTRACT",keywords:"LISTA DELLE PAROLE CHIAVE",fees:"CANONI",accessconstraints:"VINCOLI DI ACCESSO",contactinformation:"CONTATTI",subfields:{contactinformation:{contactelectronicmailaddress:"E-mail",personprimary:"Riferimenti",contactvoicetelephone:"Telefono",contactorganization:"Organizzazione",ContactOrganization:"Organizzazione",contactposition:"Posizione",ContactPosition:"Posizione",contactperson:"Persona",ContactPerson:"Persona"}},wms_url:"WMS"}},spatial:{title:"INFO SPAZIALI",fields:{crs:"EPSG",extent:"BBOX"}},layers:{title:"STRATI",groups:{general:"GENERALE",spatial:"INFO SPAZIALI"},fields:{layers:"STRATI",subfields:{crs:"EPSG",bbox:"BBOX",title:"TITOLO",name:"NOME",geometrytype:"GEOMETRIA",source:"SORGENTE",attributes:"ATTRIBUTI",abstract:"ABSTRACT",attribution:"ATTRIBUTION",keywords:"PAROLE CHIAVE",metadataurl:"METADATA URL",dataurl:"DATA URL"}}}}},tooltips:{relations:{form_to_row:"Visualizza formato Riga",row_to_form:"Visualizza formato Form"},zoom_to_features_extent:"Zoom sulle features",copy_map_extent_url:"Copia map view link",download_shapefile:"Scarica Shapefile",download_gpx:"Scarica GPX",download_gpkg:"Scarica GPKG",download_csv:"Scarica CSV",download_xls:"Scarica XLS",show_chart:"Mostra Grafico",atlas:"Stampa Atlas"},mapcontrols:{query:{tooltip:"Interroga Layer",actions:{add_selection:{hint:"Aggiungi/Rimuovi Selezione"},zoom_to_features_extent:{hint:"Zoom sulle features"},add_features_to_results:{hint:"Aggiungi features ai risultati"},remove_feature_from_results:{hint:"Rimuovi feature dai risultati"},zoom_to_feature:{hint:"Zoom sulla feature"},relations:{hint:"Visualizza Relazioni"},relations_charts:{hint:"Visualizza grafici relazioni"},download_features_shapefile:{hint:"Scarica features in Shapefile"},download_shapefile:{hint:"Scarica feature in Shapefile"},download_features_gpx:{hint:"Scarica features in GPX"},download_features_gpkg:{hint:"Scarica features in GPKG"},download_gpx:{hint:"Scarica feature in GPX"},download_gpkg:{hint:"Scarica feature in GPKG"},download_features_csv:{hint:"Scarica features in CSV"},download_csv:{hint:"Scarica feature in CSV"},download_features_xls:{hint:"Scarica features in XLS"},download_xls:{hint:"Scarica la feature in XLS"},atlas:{hint:"Stampa Atlas"},copy_zoom_to_fid_url:{hint:"Copia URL mappa con estensione a questa geometria",hint_change:"Copiato"}}},querybypolygon:{download:{title:"Download attributi",choiches:{feature:{label:"Solo features"},feature_polygon:{label:"Features+Poligono Interrogazione"}}},tooltip:"Interroga per poligono",no_geometry:"Non contiene la geometria nella risposta",help:{title:"Guida - Interrogazione con Poligono",message:"\n                <ul>\n                  <li>Seleziona uno strato poligonale in legenda.</li>\n                  <li>Assicurati che lo strato sia visibile in mappa.</li>\n                  <li>Clicca su una geometria dello strato selezionato.</li>\n                </ul>"}},querybydrawpolygon:{tooltip:"Disegna un poligono per interrogare"},querybybbox:{tooltip:"Interroga per BBOX",nolayers_visible:"Nessun layer interrogabile è visibile. Assicurarsi che almeno un layer wfs sia visibile per eseguire l'interrogazione",help:{title:"Guida - Interrogazione BBox",message:"\n                  <ul>\n                    <li>Disegna un rettangolo per interrogare gli strati evidenziati in giallo</li>\n                  </ul>\n            "}},addlayer:{messages:{csv:{warning:"Il risultato in mappa è parziale a causa della presenza dei seguenti records non corretti:"}},tooltip:"Aggiungi Layer"},geolocation:{tooltip:"Geolocalizzazione"},measures:{length:{tooltip:"Lunghezza",help:"Clicca sulla mappa per continuare a disegnare la linea.<br>CANC se si vuole cancellare l'ultimo vertice inserito"},area:{tooltip:"Area",help:"Clicca per continuare a disegnare il poligono.<br>CANC se si vuole cancellare l'ultimo vertice inserito"}},scale:{no_valid_scale:"Scala non valida"},scaleline:{units:{metric:"Metri",nautical:"Miglio Nautico"}},zoomhistory:{zoom_last:"Zoom Precedente",zoom_next:"Zoom Successivo"}},relations:{relation_data:"Dati Relazione",no_relations_found:"Nessuna relazione trovata",back_to_relations:"Ritorna alle relazioni",list_of_relations_feature:"Lista delle relazioni della feature",error_missing_father_field:"Il campo relazionato non esiste"},workflow:{steps:{title:"Passi"},next:"Avanti"},form:{loading:"Caricamento ...",inputs:{messages:{errors:{picklayer:"Nessuna feature selezionata. Verificare se il layer è in editing o non visibile alla scala attuale"}},tooltips:{picklayer:"Prendi valore dalla mappa",lonlat:"Clicca sulla mappa per prendere le coordinate"},input_validation_mutually_exclusive:"Campo mutualmente esclusivo con ",input_validation_error:"Campo obbligatorio o tipo valore non corretto",input_validation_min_field:"Valore deve essere magiore uguale a quello del camp ",input_validation_max_field:"Valore deve essere minore uguale a quello del campo ",input_validation_exclude_values:"Campo deve contenere un valore diverso",integer:"intero",bigint:"intero",text:"testuale",varchar:"testuale",textarea:"testuale",string:"stringa",date:"data",datetime:"data",float:"float",table:"table"},footer:{required_fields:"Campi obbligatori"},messages:{qgis_input_widget_relation:"Gestisci le relazioni tramite form dedicato"}},catalog:{current_map_theme_prefix:"TEMA",choose_map_theme:"SCEGLI TEMA",menu:{layerposition:"Posizione Layer",setwmsopacity:"Cambia opacità",wms:{title:"",copy:"Clicca qui per copiare url",copied:"Copiato"},download:{unknow:"Scarica",shp:"Scarica Shapefile",gpx:"Scarica GPX",gpkg:"Scarica GPKG",csv:"Scarica CSV",xls:"Scarica XLS",geotiff:"Scarica GEOTIFF",geotiff_map_extent:"Scarica GEOTIFF(estensione vista corrente)"}}},wps:{list_process:"Lista dei processi",tooltip:"Clicca sulla mappa"}},credits:{g3wSuiteFramework:"Applicativo realizzato con il framework OS",g3wSuiteDescription:"Pubblica e gestisci i tuoi progetti QGIS sul Web",productOf:"Framework sviluppato da"},toggle_color_scheme:"Cambia colore",logout:"Esci",no_other_projects:"Nu există alte proiecte în acest grup de hărți",no_other_groups:"Nu există alte grupuri în acest grup de macrocomenzi",yes:"Si",no:"No",back:"Indietro",backto:"Torna a ",changemap:"Cambia Mappa",change_session:"Cambia Sessione",component:"Componente Generico",search:"Ricerche",no_results:"Nessun risultato trovato",print:"Stampa",create_print:"Crea Stampa",dosearch:"Cerca",catalog:"Mappa",data:"Dati",externalwms:"WMS",baselayers:"Basi",tools:"Strumenti",tree:"Strati",legend:"Legenda",nobaselayer:"Nessuna mappa di base",street_search:"Cerca indirizzo",show:"Mostra",hide:"Nascondi",copy_form_data:"Copia i dati del modulo",paste_form_data:"Incolla",copy_form_data_from_feature:"Copia i dati dalla mappa",error_map_loading:"Errore di caricamento della nuova mappa",check_internet_connection_or_server_admin:"Controllare la connessione internet o contattare l'amministratore",could_not_load_vector_layers:"Errore di connessione al server: non è stato possibile caricare i vettoriali richiesti",server_saver_error:"Errore nel salvataggio sul server",server_error:"Si è verificato un errore nella richiesta al server",save:"Salva",cancel:"Cancella",close:"Chiudi",dont_show_again:"Non mostrare più",enlange_reduce:"Allarga / Riduci",reset_default:"Dimensione predefinita",add:"Aggiungi",exitnosave:"Esci senza salvare",annul:"Annulla",layer_is_added:"Layer con stesso nome già aggiunto",sidebar:{wms:{panel:{title:"Aggiungi WMS Layer",label:{position:"Posizione su Mappa",name:"Nome",projections:"Sistema di riferimento",layers:"Layers"}},add_wms_layer:"Aggiungi WMS layer",delete_wms_url:"Elimina WMS url",layer_id_already_added:"WMS Layer già aggiunto",url_already_added:"WMS URL/Nome già aggiunto",layer_add_error:"WMS Layer non aggiunto. Verificare i parametri o l'url"}},info:{title:"Risultati",list_of_relations:"Lista delle relazioni",open_link:"Apri documento allegato",server_error:"Si è verificato un errore nella richiesta al server",no_results:"Nessun risultato per questa interrogazione/ricerca ",link_button:"Apri"},mapcontrols:{geolocations:{title:"",error:"Non è possibile calcolare la tua posizione."},nominatim:{placeholder:"Indirizzo ...",noresults:"Nessun risultato",notresponseserver:"Il server non risponde"},add_layer_control:{header:"Aggiungi Layer",select_projection:"Seleziona il sistema di proiezione del layer",select_field_to_show:"Seleziona il campo da visualizzare sulla mappa",select_csv_separator:"Seleziona il separatore",select_csv_x_field:"Seleziona il campo X",select_csv_y_field:"Seleziona il campo Y",select_color:"Seleziona il colore del Layer",drag_layer:"Trascina il layer in questa area"},query:{input_relation:"Clicca per consultare le relazioni"},length:{tooltip:"Lunghezza"},area:{tooltip:"Area"},screenshot:{error:"Errore nella creazione dello screenshot",securityError:'  \n        <p><b>Errore di sicurezza</b>: uno strato esterno impedisce la stampa della mappa. Per verificare, procedere come segue:</p>\n        <ol>\n          <li>rimuovi eventuali layer esterni aggiunti manualmente (es. layer WMS)</li>\n          <li>forza il ricaricamento della pagina: <code>CTRL + F5</code></li>\n          <li>stampa nuovamente la mappa</li>\n        </ol>\n        <p>Per maggiori informazioni contattare l\'amministratore del server in merito a: <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image" style="color: #000 !important;font-weight: bold;">&#x2139;&#xFE0F; security and tainted canvases</a></p>\n        '}},catalog_items:{helptext:"Tasto destro sui singoli layer per accedere alle funzionalità aggiuntive",contextmenu:{zoomtolayer:"Zoom to Layer",open_attribute_table:"Apri tabella attributi",show_metadata:"Metadati",styles:"Stili",vector_color_menu:"Setta/Cambia Colore",layer_opacity:"Trasparenza"}},dataTable:{previous:"Precedente",next:"Successivo",lengthMenu:"Visualizza _MENU_",info:"Visualizzazione _START_ a _END_ su _TOTAL_ righe",nodatafilterd:"Nessun risultato trovato",infoFiltered:"(Filtrati da _MAX_ total righe)"}}}},{}],335:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default={translation:{error_page:{error:"Eroare de conexiune",at_moment:"Momentan nu este posibil să afișați harta",f5:"Apăsați Ctrl+F5"},cookie_law:{message:"Acest website foloseste cookie-uri pentru a furniza vizitatorilor o experiență mult mai bună de navigare",buttonText:"Am înțeles!"},default:"Implicit",sign_in:"Logare",layer_selection_filter:{tools:{filter:"Adăugare/Eliminare Filtrare",nofilter:"Eliminare Filtrare",invert:"Inversare Selecție",clear:"Elimină Selecția",show_features_on_map:"Arată entitățile vizibile în cadrul hărții"}},warning:{not_supported_format:"Formatul nu este acceptat"},layer_position:{top:"SUS",bottom:"JOS",message:"Poziție relativă la straturile din TOC"},sdk:{atlas:{template_dialog:{title:"Selectați Template"}},spatialbookmarks:{title:"Marcaje spațiale",helptext:"Deplasați-vă pe întinderea hărții, introduceți numele și faceți clic pe Adăugați",input:{name:"Nume"},sections:{project:{title:"Marcaje de proiect"},user:{title:"Marcaje utilizator"}}},search:{all:"Toate",no_results:"Fără rezultat",searching:"Căutare ...",error_loading:"Încărcarea a eșuat",layer_not_searchable:"Nu se poate căuta pe strat",layer_not_querable:"Stratul nu se poate interoga",autocomplete:{inputshort:{pre:"Te rog introdu",post:"sau mai multe caractere"}}},print:{no_layers:"Nu avem straturi de print",template:"Șablon",labels:"Etichete",scale:"Scară",format:"Format",rotation:"Rotație",download_image:"Descarcă Imaginea",fids_instruction:"Valori acceptate: de la 1 la valoarea [max]. Este posibilă inserarea de interval, de ex. 4-6",fids_example:"Ex. 1,4-6 vor fi tipărite id 1,4,5,6",help:"Straturile prezentate în print pot fi acelea definite în proiect și nu acelea prezentate în cadrul hărții"},querybuilder:{search:{run:"Execută",info:"Info",delete:"Elimină",edit:"Modifică"},messages:{changed:"Salvat",number_of_features:"Număr de entități"},panel:{button:{all:"TOATE",save:"SALVEAZĂ",test:"TEST",clear:"ȘTERGE",run:"RUN",manual:"MANUAL"},layers:"STRATURI",fields:"CÂMPURI",values:"VALORI",operators:"OPERATORI",expression:"EXPRESII"},error_run:"A survenit o eroare. De verificat interogarea",error_test:"A survenit o eroare în timp ce se executa interogarea",delete:"Vrei să o ștergi?",additem:"Introdu numele noii căutări"},errors:{layers:{load:"Câteva straturi nu sunt disponibile"},unsupported_format:"Formatul nu este acceptat",add_external_layer:"Eroare încărcare strat"},metadata:{title:"Metadate",groups:{general:{title:"GENERALITĂȚI",fields:{title:"TITLU",name:"NUME",description:"DESCRIERE",abstract:"ABSTRACT",keywords:"CUVINTE CHEIE",fees:"TAXE",accessconstraints:"CONSTRÂNGERI DE ACCES",contactinformation:"CONTACTE",subfields:{contactinformation:{contactelectronicmailaddress:"Email",personprimary:"Referințe",contactvoicetelephone:"Telefon",contactorganization:"Organizație",ContactOrganization:"Organizație",contactposition:"Poziție",ContactPosition:"Poziție",contactperson:"Persoana",ContactPerson:"Persoana"}},wms_url:"WMS"}},spatial:{title:"SPAȚIAL",fields:{crs:"EPSG",extent:"BBOX"}},layers:{title:"STRATURI",fields:{layers:"STRATURI",subfields:{crs:"EPSG",bbox:"BBOX",title:"TITLU",name:"NUME",geometrytype:"GEOMETRIE",source:"SURSA",attributes:"ATRIBUTE",abstract:"ABSTRACT",attribution:"ATRIBUIRE",keywords:"CUVINTE CHEIE",metadataurl:"URL METADATE",dataurl:"URL DATE"}},groups:{general:"GENERALITĂȚI",spatial:"SPAȚIAL"}}}},tooltips:{relations:{form_to_row:"Vizualizare pe rânduri",row_to_form:"Vizualizare formular"},copy_map_extent_url:"Copiază linkul de vizualizare hartă",download_shapefile:"Descarcă Shapefile",download_gpx:"Descarcă GPX",download_gpkg:"Descarcă GPKG",download_csv:"Descarcă CSV",download_xls:"Descarcă XLS",show_chart:"Arată Diagrama",atlas:"Tipărire Atlas"},mapcontrols:{query:{tooltip:"Interogare strat",actions:{add_selection:{hint:"Adaugă/Elimină Selecția"},zoom_to_features_extent:{hint:"Zoom la încadrarea entităților"},add_features_to_results:{hint:"Adaugă/Elimină entități rezultat"},remove_feature_from_results:{hint:"Elimină entitate din rezultat"},zoom_to_feature:{hint:"Zoom la entitate"},relations:{hint:"Arată Relațiile"},relations_charts:{hint:"Arată diagrama de relații"},download_features_shapefile:{hint:"Descarcă entități în Shapefile"},download_shapefile:{hint:"Descarcă entitate în Shapefile"},download_features_gpx:{hint:"Descarcă entități în GPX"},download_features_gpkg:{hint:"Descarcă entități în GPKG"},download_gpx:{hint:"Descarcă entitate în GPX"},download_gpkg:{hint:"Descarcă entitate în GPKG"},download_features_csv:{hint:"Descarcă entități în CSV"},download_csv:{hint:"Descarcă entitate în CSV"},download_features_xls:{hint:"Descarcă entități în XLS"},download_xls:{hint:"Descarcă entitate în XLS"},atlas:{hint:"Tipărire Atlas"},copy_zoom_to_fid_url:{hint:"Copiază URL hartă cu întinderea geometriei entității",hint_change:"Copiat"}}},querybypolygon:{download:{title:"Descărcare atribute",choiches:{feature:{label:"Doar entități"},feature_polygon:{label:"Entități+Poligon Interogare"}}},tooltip:"Interogare După Poligon",no_geometry:"Nu avem geometrii în răspuns",help:{title:"Ghid - Interogare După Poligon",message:"\n                <ul>\n                  <li>Selectează un strat poligon din TOC.</li>\n                  <li>Asigură-te că stratul este vizibil.</li>\n                  <li>Click pe o entitate a stratului selectat.</li>\n                </ul>"}},querybydrawpolygon:{tooltip:"Interogare prin poligon de desen"},querybybbox:{tooltip:"Interogare BBox strat",nolayers_visible:"Nu este vizibil niciun strat de interogare. Trebuie setat cel puțin un strat WFS vizibil pentru a efectua interogarea",help:{title:"Ghid - Interogare BBox strat",message:"\n                 <ul>\n                  <li>Desenează un pătrat pe hartă pentru a interoga straturile din TOC de sub </li>\n                 </ul>"}},addlayer:{messages:{csv:{warning:"Rezultateul pe hartă este parțial datorită prezenței următoarei liste de rezultate incorecte:"}},tooltip:"Adaugă Strat"},geolocation:{tooltip:"Geolocalizare"},measures:{length:{tooltip:"Lungime",help:"Click pe hartă pentru a desena linia. Apasă <br>CANC dacă dorești să ștergi ultimul vertex"},area:{tooltip:"Aria",help:"Click pentru desen poligon. Apasă <br>CANC dacă dorești să ștergi ultimul vertex"}},scale:{no_valid_scale:"Scară Invalidă"},scaleline:{units:{metric:"Metri",nautical:"Mile Nautice"}},zoomhistory:{zoom_last:"Zoom Anterior",zoom_next:"Zoom Urmatorul"}},relations:{relation_data:"Date Relații",no_relations_found:"Nu am găsit nicio relație",back_to_relations:"Înapoi la relații",list_of_relations_feature:"Lista de relații a entității",error_missing_father_field:"Câmpul de legătură lipsește"},workflow:{steps:{title:"Pași"},next:"Următorul"},form:{loading:"Se încarcă ...",inputs:{messages:{errors:{picklayer:"Nu avem entitate selectată. Verifică dacă stratul este în editare sau vizibil la scara curentă if layer is on editing or visible at current scale"}},tooltips:{picklayer:"Ia valoare din strat",lonlat:"Click pe hartă pentru a prelua coordonate"},input_validation_mutually_exclusive:"Câmp ce se exclude mutual cu ",input_validation_error:"Câmp mandatoriu sau tip de date greșit",input_validation_min_field:"Valoarea trebuie să fie mai mare/egală cu valoare câmpului ",input_validation_max_field:"Valoarea trebuie să fie mai mică/egală cu valoare câmpului ",input_validation_exclude_values:"Valoarea trebuie să fie unică",integer:"integer - nr. întreg",bigint:"integer - nr. întreg",text:"text",varchar:"text",textarea:"text",string:"string - text",date:"data",datetime:"data",float:"float - nr. cu zecimale",table:"tabelă"},footer:{required_fields:"Câmpuri necesare"},messages:{qgis_input_widget_relation:"Folosește formular specific de relații pentru a lucra cu relația"}},catalog:{current_map_theme_prefix:"TEMA",choose_map_theme:"ALEGE TEMA",menu:{layerposition:"Poziție Strat",setwmsopacity:"Alege Opacitatea",wms:{title:"Titlu",copy:"Click pentru copiere URL",copied:"Copiat"},download:{unknow:"Descarcă",shp:"Descarcă Shapefile",gpx:"Descarcă GPX",gpkg:"Descarcă GPKG",csv:"Descarcă CSV",xls:"Descarcă XLS",geotiff:"Descarcă GEOTIFF",geotiff_map_extent:"Descarcă GEOTIFF(ce se vede în cadrul hărții)"}}},wps:{list_process:"Lista de procese",tooltip:"Click pe hartă"}},credits:{g3wSuiteFramework:"Aplicație bazată pe frameworkul",g3wSuiteDescription:"Publică și administrează proiectele de QGIS pe WEB",productOf:"Framework dezvoltat de"},toggle_color_scheme:"Comutare schemă de culori",logout:"Deconectare",no_other_projects:"No more project for this group",no_other_groups:"Nu mai sunt grupuri pentru acest macrogrup",yes:"Da",no:"Nu",back:"Înapoi",backto:"Înapoi la ",changemap:"Schimbare Hartă",change_session:"Schimbați sesiunea",component:"Componentă Generică",search:"Căutare",no_results:"Niciun rezultat găsit",print:"Tipărire",create_print:"Tipărește",dosearch:"Caută",catalog:"Hartă",data:"Data",externalwms:"WMS",baselayers:"Straturi Bază",tools:"Instrumente",tree:"Straturi",legend:"Legendă",nobaselayer:"Fără strat de bază",street_search:"Caută Adresă",show:"Arată",hide:"Ascunde",copy_form_data:"Copiază data",paste_form_data:"Lipește",copy_form_data_from_feature:"Copiază data din hartă",error_map_loading:"Sunt erori la încărcarea hărții",check_internet_connection_or_server_admin:"Verificați conexiune de internet sau contactați administratorul de sistem",could_not_load_vector_layers:"Eroare de conexiune: Straturile nu pot fi încărcate",server_saver_error:"Eroare la salvarea pe server",server_error:"Eroare de conexiune la server",save:"Salvează",cancel:"Anulează",close:"Închide",dont_show_again:"Nu mai afișa mesajul",enlange_reduce:"Mărește / Micșorează",reset_default:"Mărimea implicită",add:"Adaugă",exitnosave:"Ieșire fără salvare",annul:"Anulează",layer_is_added:"Există un strat cu același nume deja adăugat",sidebar:{wms:{panel:{title:"Adaugă strat WMS",label:{position:"Poziție Hartă",name:"Nume",projections:"Proiecție",layers:"Straturi"}},add_wms_layer:"Adaugă strat WMS",delete_wms_url:"Șterge URL WMS",layer_id_already_added:"Strat WMS deja adăugat",url_already_added:"URL WMS/Nume deja adăugat",layer_add_error:"Stratul WMS nu s-a adăugat. Verificați URL-ul sau parametrii WMS"}},info:{title:"Rezultate",list_of_relations:"List of Relations",open_link:"Deschide document atașat",server_error:"Serverul a întâmpinat o eroare",no_results:"Niciun rezultat",link_button:"Deschide"},mapcontrols:{geolocations:{error:"Nu te-am putut localiza"},nominatim:{placeholder:"Adresa ...",noresults:"Niciun rezultat",notresponseserver:"Niciun răspuns de la server"},add_layer_control:{header:"Adăugare Strat",select_projection:"Selectează proiecția strat",select_field_to_show:"Selectează câmpul de arătat pe hartă",select_csv_separator:"Selectează delimitatorul",select_csv_x_field:"Selectează câmpul X - Est",select_csv_y_field:"Selectează câmpul Y - Nord",select_color:"Selectează culoare strat",drag_layer:"Trageți stratul aici (Drag&Drop)"},query:{input_relation:"Click pentru a arăta relațiile"},length:{tooltip:"Lungime"},area:{tooltip:"Arie"},screenshot:{error:"Eroare captură ecran",securityError:'  \n        <p><b>Eroare de securitate</b>: un strat extern împiedică imprimarea hărții. Pentru a verifica, procedați după cum urmează:</p>\n        <ol>\n          <li>eliminați orice straturi externe adăugate manual (de exemplu, straturi WMS)</li>\n          <li>forțați reîncărcarea paginii: <code>CTRL + F5</code></li>\n          <li>tipărește din nou harta</li>\n        </ol>\n        <p>Pentru mai multe informații, vă rugăm să contactați administratorul serverului despre: <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image" style="color: #000 !important;font -greutate: bold;">&#x2139;&#xFE0F; securitate și pânze contaminate</a></p>\n        '}},catalog_items:{helptext:"Click dreapta pe strat pentru a accesa opțiuni",contextmenu:{zoomtolayer:"Zoom pe Strat",open_attribute_table:"Deschide Tabela Atribute",show_metadata:"Metadate",styles:"Stiluri",vector_color_menu:"Setează/Schimbă Culoare",layer_opacity:"Opacitate"}},dataTable:{previous:"Anteriorul",next:"Următorul",lengthMenu:"Arată _MENU_",info:"Arată _START_ până la _END_ din _TOTAL_ de intrări",no_data:"Fără date",nodatafilterd:"Niciun rezultat",infoFiltered:"(filtrat din _MAX_ de rezultate totale)"}}}},{}],336:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default={translation:{error_page:{error:"Anslutningsfel",at_moment:"För närvarande är inte möjligt visa karta",f5:"Tryck på Ctrl+F5"},cookie_law:{message:"This website uses cookies to ensure you get the best experience on our website.",buttonText:"Got It!"},default:"standard",sign_in:"Logga in",layer_selection_filter:{tools:{filter:"Lägg till/Avlägsna Filtrera",nofilter:"Avlägsna Filtrera",invert:"Invertera Urval",clear:"Annullera Urval",show_features_on_map:"Visa funktioner som är synliga på kartan"}},warning:{not_supported_format:"Not supported format"},layer_position:{top:"TOP",bottom:"BOTTOM",message:"Position relative to layers on TOC"},sdk:{atlas:{template_dialog:{title:"Välj Template"}},spatialbookmarks:{title:"Rumsliga bokmärken",helptext:"Flytta på kartans omfattning, ange namn och klicka på Lägg till",input:{name:"Namn"},sections:{project:{title:"Projektbokmärken"},user:{title:"Användarbokmärken"}}},search:{all:"ALLA",no_results:"Inga resultat",searching:"Sökning ...",error_loading:"Fel vid laddning av uppgifter.",layer_not_searchable:"Nivån kan inte sökas.",layer_not_querable:"Förfrågningar kan inte göras på nivån.",autocomplete:{inputshort:{pre:"Mata in",post:"eller flera tecken"}}},print:{no_layers:"Inga nivåer att skriva ut",template:"Template",labels:"Labels",scale:"Skala",format:"Format",rotation:"Rotation",download_image:"Ladda ner bild",fids_instruction:"Godkända värden: Från ett till värdet [max]. Mellanslag tillåts, t.ex. 4-6.",fids_example:"Exempelvis 1,4-6 skriver ut id 1,4,5,6.",help:"Nivåerna på utskriften kan vara specificerade i ett projekt inte sådana som visas på karta."},querybuilder:{search:{run:"Utför",info:"Information",delete:"Ta bort",edit:"Redigera"},messages:{changed:"Sparat",number_of_features:"Antal funktione"},panel:{button:{all:"ALLA",save:"SPARA",test:"TEST",clear:"TÖM",run:"UTFÖR",manual:"MANUELL"},layers:"NIVÅER",fields:"FÄLT",values:"VÄRDEN",operators:"OPERATÖRER",expression:"KLAUSUL"},error_run:"Ett fel inträffade. Kontrollera förfrågan.",error_test:"Ett fel inträffade när förfrågan utfördes.",delete:"Vill du ta bort den?",additem:"Ge den nya sökningen ett namn."},errors:{layers:{load:"Vissa nivåer är inte tillgängliga."},unsupported_format:"Formatet stöds inte",add_external_layer:"Fel vid laddning av nivån"},metadata:{title:"Metadata",groups:{general:{title:"ALLMÄN",fields:{title:"RUBRIK",name:"NAMN",description:"BESKRIVNING",abstract:"SAMMANDRAG",keywords:"NYCKELORD",fees:"AVGIFTER",accessconstraints:"ÅTKOMSTBEGRÄNSNINGAR",contactinformation:"KONTAKTUPPGIFTER",subfields:{contactinformation:{contactelectronicmailaddress:"E-post",personprimary:"Referenser",contactvoicetelephone:"Telefon",contactorganization:"Organisation",ContactOrganization:"Organisation",contactposition:"Ställning",ContactPosition:"Ställning",contactperson:"Kontaktperson",ContactPerson:"Kontaktperson"}},wms_url:"WMS"}},spatial:{title:"SPATIAL",fields:{crs:"EPSG",extent:"BBOX"}},layers:{title:"NIVÅER",fields:{layers:"NIVÅER",subfields:{crs:"EPSG",bbox:"BBOX",title:"RUBRIK",name:"NAMN",geometrytype:"GEOMETRI",source:"KÄLLA",attributes:"ATTRIBUT",abstract:"SAMMANDRAG",attribution:"TILLSKRIVNING",keywords:"NYCKELORD",metadataurl:"METADATA URL",dataurl:"DATA URL"}},groups:{general:"ALLMÄN",spatial:"SPATIAL"}}}},tooltips:{relations:{form_to_row:"Radvy",row_to_form:"Tabellvy"},copy_map_extent_url:"Kopiera länk till karta",download_shapefile:"Ladda SHP-fil",download_gpx:"Ladda GPX-fil",download_gpkg:"Ladda GPKG-fil",download_csv:"Ladda CSV-fil",download_xls:"Ladda XLS-fil",show_chart:"Visa diagram",atlas:"Skriv ut Atlas"},mapcontrols:{query:{tooltip:"Förfrågningsnivå",actions:{add_selection:{hint:"Lägg till/Avlägsna Urval"},zoom_to_features_extent:{hint:"Zooma till egenskapens omfattning"},add_features_to_results:{hint:"Add/Remove features to results"},remove_feature_from_results:{hint:"Remove feature from results"},zoom_to_feature:{hint:"Zooma till egenskapen"},relations:{hint:"Visa relationerna"},relations_charts:{hint:"Visa relationsdiagrammet"},download_features_shapefile:{hint:"Ladda egenskapens SHP-fil"},download_shapefile:{hint:"Ladda egenskapens SHP-fil"},download_features_gpx:{hint:"Ladda egenskapens GPX-fil"},download_features_gpkg:{hint:"Ladda egenskapens GPKG-fil"},download_gpx:{hint:"Ladda egenskapens GPX-fil"},download_gpkg:{hint:"Ladda egenskapens GPKG-fil"},download_features_csv:{hint:"Ladda egenskapens CSV-fil"},download_csv:{hint:"Ladda egenskapens CSV-fil"},download_features_xls:{hint:"Ladda egenskapens XLS-fil"},download_xls:{hint:"Ladda egenskapens XLS-fil"},atlas:{hint:"Skriv ut Atlas"},copy_zoom_to_fid_url:{hint:"Copy map URL with this geometry feature extension",hint_change:"Copied"}}},querybypolygon:{download:{title:"Attributes download",choiches:{feature:{label:"Features only"},feature_polygon:{label:"Features+Query Polygon"}}},tooltip:"Förfrågan med polygon",no_geometry:"No geometry on response",help:{title:"Ohje - Förfrågan med polygon",message:"\n                <ul>\n                  <li>Välj polygonnivå i listan.</li>\n                  <li>Kontrollera att nivån är synlig.</li>\n                  <li>Välj egenskap på önskad nivå.</li>\n                </ul>"}},querybydrawpolygon:{tooltip:"Fråga efter ritpolygon"},querybybbox:{tooltip:"BBox-förfrågan som riktar sig till en nivå",nolayers_visible:"Inga nivåer som förfrågningar kan riktas till. Gör minst en WFS-nivå synlig för att kunna utföra sökningen.",help:{title:"Ohje - BBox-förfrågan som riktar sig till nivån",message:"\n                 <ul>\n                  <li>Rita upp en rektangel på kartan för att utföra förfrågan på de i listan understreckade nivåerna.</li>\n                 </ul>"}},addlayer:{messages:{csv:{warning:"The result in the map is partial due to the presence of the below incorrect records list:"}},tooltip:"Lägg till nivå"},geolocation:{tooltip:"Geografiskt läge"},measures:{length:{tooltip:"Längd",help:"Rita upp en bruten linje på kartan. Tryck <br>CANC, om du vill ta bort föregående punkt."},area:{tooltip:"Område",help:"Rita upp en polygon på kartan. Tryck <br>CANC, om du vill ta bort föregående punkt."}},scale:{no_valid_scale:"Fel skala"},scaleline:{units:{metric:"Meters",nautical:"Nautical Mile"}},zoomhistory:{zoom_last:"Zoom Föregående",zoom_next:"Zoom Nästa"}},relations:{relation_data:"Relationsuppgifter",no_relations_found:"Inga relationer hittades.",back_to_relations:"Tillbaka till relationerna",list_of_relations_feature:"Lista på egenskapens relationer",error_missing_father_field:"Fält saknas"},workflow:{steps:{title:"Skeden"},next:"Nästa"},form:{loading:"Laddning...",inputs:{messages:{errors:{picklayer:"Inga egenskaper har valts. Kontroller att nivån kan redigeras eller att den syns med nuvarande skala."}},tooltips:{picklayer:"Välj värde på kartnivå",lonlat:"Click on map to get coordinates"},input_validation_mutually_exclusive:"Fälten utesluter varandra.",input_validation_error:"Obligatoriskt fält eller fel datatyp.",input_validation_min_field:"Värdet ska vara större eller lika stort som värdet i fältet.",input_validation_max_field:"Värdet ska vara mindre eller lika stort som värdet i fältet.",input_validation_exclude_values:"Värdet ska vara unikt.",integer:"heltal",bigint:"heltal",text:"text",varchar:"text",textarea:"text",string:"teckensträng",date:"datum",datetime:"datum",float:"flyttal",table:"tabell"},footer:{required_fields:"Obligatoriska fält"},messages:{qgis_input_widget_relation:"Använd den specifika funktinen för att bestämma relationer"}},catalog:{current_map_theme_prefix:"THEME",choose_map_theme:"CHOOSE THEME",menu:{layerposition:"Layer Position",setwmsopacity:"Set Opacity",wms:{title:"",copy:"Tryck här för att kopiera url.",copied:"Kopierad."},download:{unknow:"Ladda",shp:"Ladda SHP-fil",gpx:"Ladda GPX-fil",gpkg:"Ladda GPKG-fil",csv:"Ladda CSV-fil",xls:"Ladda XLS-fil",geotiff:"Ladda GEOTIFF-fil",geotiff_map_extent:"Ladda GEOTIFF-fil(current view extent)"}}},wps:{list_process:"Lista på processer",tooltip:"Välj på kartan"}},credits:{g3wSuiteFramework:"Tillämpningen baserar på OS framework",g3wSuiteDescription:"Publicera och hantera QGIS-projekt på nätet.",productOf:"Framework har utvecklats av"},toggle_color_scheme:"Toggle color scheme",logout:"Logga ut",no_other_projects:"Inga projekt för denna grupp",no_other_groups:"Inga fler grupper för denna makrogrupp",yes:"Ja",no:"Nej",back:"Gå tillbaka",backto:"Tillbaka ",changemap:"Byt karta",change_session:"Ändra session",component:"Allmän komponent",search:"Sök",no_results:"Inga sökresultat",print:"Skriv ut",create_print:"Skapa utskrift",dosearch:"Sök",catalog:"Karta",data:"Data",externalwms:"WMS",baselayers:"Bakgrundskarta",tools:"Verktyg",tree:"Nivåer",legend:"Förklaring till beteckningarna",nobaselayer:"Ingen bakgrundskarta",street_search:"Sök adress",show:"Visa",hide:"Dölj",copy_form_data:"Kopiera uppgifterna",paste_form_data:"Infoga",copy_form_data_from_feature:"Kopiera uppgifter från kartan",error_map_loading:"Fel vid laddning av kartan",check_internet_connection_or_server_admin:"Kontrollera internetanslutningen eller kontakta administratören.",could_not_load_vector_layers:"Fel i anslutningen, nivåer kan inte laddas.",server_saver_error:"Fel vid lagring på servern.",server_error:"Fel på anslutningen till servern",save:"Spara",cancel:"Ånga",close:"Stäng",dont_show_again:"Visa inte det här meddelandet igen",enlange_reduce:"Förstora / Förminska",reset_default:"Standardstorlek",add:"Lägg till",exitnosave:"Lämna programmet utan att spara",annul:"Ångra",layer_is_added:"Lagret med samma namn har redan lagts till.",sidebar:{wms:{panel:{title:"Add WMS Layer",label:{position:"Map Position",name:"Name",projections:"Projection",layers:"Layers"}},add_wms_layer:"Aggiungi WMS layer",delete_wms_url:"Delete WMS url",layer_id_already_added:"WMS Nivån har redan lagts till.",url_already_added:"WMS URL/Namn har redan lagts till.",layer_add_error:"WMS Layer not added. Please check all wms parameter or url"}},info:{title:"Resultat",list_of_relations:"List of Relations",open_link:"Öppna filbilaga",server_error:"Ett fel uppstod på servern.",no_results:"Inga resultat för sökningen/förfrågan.",link_button:"Öppna"},mapcontrols:{geolocations:{error:"Du kan inte lokaliseras"},nominatim:{placeholder:"Adress ...",noresults:"Inga resultat",notresponseserver:"Inget svar från servern"},add_layer_control:{header:"Lägg till nivå",select_projection:"Välj projektion för nivån",select_field_to_show:"Select Field to show on map",select_csv_separator:"Select delimiter",select_csv_x_field:"Select X field",select_csv_y_field:"Select Y field",select_color:"Välj färg på nivån",drag_layer:"Dra och släpp nivån hit"},query:{input_relation:"Tryck för att visa relationerna"},length:{tooltip:"Längd"},area:{tooltip:"Areal"},screenshot:{error:"Screenshot error creation",securityError:'  \n        <p><b>Säkerhetsfel</b>: ett externt lager hindrar kartan från att skrivas ut. Gör så här för att kontrollera:</p>\n        <ol>\n          <li>ta bort alla manuellt tillagda externa lager (t.ex. WMS-lager)</li>\n          <li>tvinga om inläsning av sidan: <code>CTRL + F5</code></li>\n          <li>skriv ut kartan igen</li>\n        </ol>\n        <p>För mer information kontakta serveradministratören om: <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image" style="color: #000 !important;font -vikt: fet;">&#x2139;&#xFE0F; säkerhet och nedsmutsade dukar</a></p>\n        '}},catalog_items:{helptext:"Högerklicka på en enskild nivå för att komma till tilläggsegenskaperna.",contextmenu:{zoomtolayer:"Zooma till nivå",open_attribute_table:"Öppna attributtabellen",show_metadata:"Metadata",styles:"Stilar",vector_color_menu:"Ställ in/ändra färg",layer_opacity:"Opacitet"}},dataTable:{previous:"Föregående",next:"Nästa",lengthMenu:"Show _MENU_ items",info:"Showing _START_ to _END_ of _TOTAL_ entries",no_data:"Inga uppgifter",nodatafilterd:"Inga motsvarande poster hittades",infoFiltered:"(filtered from _MAX_ total records)"}}}},{}],337:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,e=e("store/catalog-layers"),s=(e=e)&&e.__esModule?e:{default:e};function i(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}r.default={methods:{autocompleteRequest:(n=i(regeneratorRuntime.mark(function e(){var t,r,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=n.layerId,a=n.field,o=n.value;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],r=s.default.getLayerById(i),e.prev=2,e.next=5,r.getFilterData({suggest:a+"|"+o,unique:a});case 5:t=e.sent,e.next=10;break;case 8:e.prev=8,e.t0=e.catch(2);case 10:return e.abrupt("return",t.map(function(e){return{id:e,text:e}}));case 11:case"end":return e.stop()}},e,this,[[2,8]])})),function(){return n.apply(this,arguments)})}}},{"store/catalog-layers":374}],338:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default={computed:{tabIndex:function(){return this.editable?0:-1},notvalid:function(){return!1===this.state.validate.valid},editable:function(){return this.state.editable},showhelpicon:function(){return this.state.help&&this.state.help.message.trim()},disabled:function(){return!this.editable||"loading"===this.loadingState||"error"===this.loadingState},loadingState:function(){return this.state.input.options.loading?this.state.input.options.loading.state:null}},methods:{showHideHelp:function(){this.state.help.visible=!this.state.help.visible},mobileChange:function(e){this.state.value=e.target.value,this.change()},change:function(){this.service.setEmpty(),this.service.setUpdate(),(this.state.validate.required||this.state.validate.unique)&&this.service.validate(),this.$emit("changeinput",this.state)},isVisible:function(){}}}},{}],339:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default={created:function(){this.__CLICK_EVENT={count:0,timeoutID:null}},methods:{handleClick:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=arguments[1];this.__CLICK_EVENT&&(this.__CLICK_EVENT.count+=1,this.__CLICK_EVENT.timeoutID||(this.__CLICK_EVENT.timeoutID=setTimeout(function(){void 0!==t[e.__CLICK_EVENT.count]&&t[e.__CLICK_EVENT.count].call(r),e.__resetClickMixin()},300)))},__resetClickMixin:function(){this.__CLICK_EVENT.count=0,this.__CLICK_EVENT.timeoutID=null},__clearClickMixin:function(){this.__resetClickMixin(),this.__CLICK_EVENT=null}},beforeDestroy:function(){this.__clearClickMixin()}}},{}],340:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default={methods:{getFieldService:function(){return void 0===this._fieldsService&&(this._fieldsService=e("gui/fields/fieldsservice")),this._fieldsService},getFieldType:function(e){return this.getFieldService().getType(e)},isSimple:function(e){return this.getFieldService().isSimple(e)},isLink:function(e){return this.getFieldService().isLink(e)},isImage:function(e){return this.getFieldService().isImage(e)},isPhoto:function(e){return this.getFieldService().isPhoto(e)},isVue:function(e){return this.getFieldService().isVue(e)},sanitizeFieldValue:function(e){return Array.isArray(e)&&!e.length?"":e}}}},{"gui/fields/fieldsservice":121}],341:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default={data:function(){return{valid:!1}},methods:{addToValidate:function(e){this.tovalidate.push(e)},changeInput:function(e){this.isValid(e)},isValid:function(e){var t,r=this;if(e)if(e.validate.mutually){if(!e.validate.required)if(e.validate.empty){e.value=null,e.validate.mutually_valid=!0,e.validate.valid=!0,e.validate._valid=!0;for(var n=[],i=e.validate.mutually.length;i--;){var a=e.validate.mutually[i];this.tovalidate[a].validate.empty||n.push(a)}n.length<2&&n.forEach(function(e){r.tovalidate[e].validate.mutually_valid=!0,r.tovalidate[e].validate.valid=!0,setTimeout(function(){r.tovalidate[e].validate.valid=r.tovalidate[e].validate._valid,r.state.valid=r.state.valid&&r.tovalidate[e].validate.valid})})}else e.validate._valid=e.validate.valid,e.validate.mutually_valid=e.validate.mutually.reduce(function(e,t){return e&&r.tovalidate[t].validate.empty},!0),e.validate.valid=e.validate.mutually_valid&&e.validate.valid}else e.validate.empty||!e.validate.min_field&&!e.validate.max_field||(t=e.validate.min_field||e.validate.max_field,e.validate.valid=e.validate.min_field?this.tovalidate[e.validate.min_field].validate.empty||+e.value>+this.tovalidate[e.validate.min_field].value:this.tovalidate[e.validate.max_field].validate.empty||+e.value<+this.tovalidate[e.validate.max_field].value,e.validate.valid&&(this.tovalidate[t].validate.valid=!0));this.valid=Object.values(this.tovalidate).reduce(function(e,t){return e&&t.validate.valid},!0)}},created:function(){this.tovalidate=[]},destroyed:function(){this.tovalidate=null}}},{}],342:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var e=e("services/gui"),i=(e=e)&&e.__esModule?e:{default:e};r.default={methods:{showLayer:function(){this.visible=!this.visible,this.layer.setVisible(this.visible)}},created:function(){var e=this.data,t=i.default.getComponent("map").getService(),r=t.getProjection().getCode(),n=void 0;switch(e.type){case"Point":case"MultiPoint":n=[new ol.style.Style({image:new ol.style.Circle({radius:6,fill:new ol.style.Fill({color:[255,255,255,1]}),stroke:new ol.style.Stroke({color:[0,0,0,1],width:2})})}),new ol.style.Style({image:new ol.style.Circle({radius:2,fill:new ol.style.Fill({color:[255,255,255,1]}),stroke:new ol.style.Stroke({color:[0,0,0,1],width:2})})})];break;case"Line":case"MultiLineString":case"Polygon":case"MultiPolygon":n=new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.3)"}),stroke:new ol.style.Stroke({color:[0,0,0,1],width:2})})}this.layer=new ol.layer.Vector({source:new ol.source.Vector({features:(new ol.format.GeoJSON).readFeatures(e,{featureProjection:r})}),visible:!!this.visible,style:n}),t.getMap().addLayer(this.layer)},beforeDestroy:function(){i.default.getComponent("map").getService().getMap().removeLayer(this.layer)}}},{"services/gui":361}],343:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.mixins=r.autocompleteMixin=r.baseInputMixin=r.metadataMixin=r.widgetMixins=r.formInputsMixins=r.select2Mixin=r.selectMixin=r.resizeMixin=r.geoMixin=r.mediaMixin=r.fieldsMixin=void 0;var n=f(e("mixins/autocomplete")),i=f(e("mixins/fields")),a=f(e("mixins/media")),o=f(e("mixins/geo")),s=f(e("mixins/resize")),l=f(e("mixins/select")),u=f(e("mixins/select2")),c=f(e("mixins/form-inputs")),d=f(e("mixins/widget")),p=f(e("mixins/metadata")),e=f(e("mixins/base-input"));function f(e){return e&&e.__esModule?e:{default:e}}var h={autocompleteMixin:n.default,fieldsMixin:i.default,mediaMixin:a.default,geoMixin:o.default,resizeMixin:s.default,selectMixin:l.default,select2Mixin:u.default,formInputsMixins:c.default,widgetMixins:d.default,metadataMixin:p.default,baseInputMixin:e.default};r.fieldsMixin=i.default,r.mediaMixin=a.default,r.geoMixin=o.default,r.resizeMixin=s.default,r.selectMixin=l.default,r.select2Mixin=u.default,r.formInputsMixins=c.default,r.widgetMixins=d.default,r.metadataMixin=p.default,r.baseInputMixin=e.default,r.autocompleteMixin=n.default,r.mixins=h,r.default=h},{"mixins/autocomplete":337,"mixins/base-input":338,"mixins/fields":340,"mixins/form-inputs":341,"mixins/geo":342,"mixins/media":344,"mixins/metadata":345,"mixins/resize":346,"mixins/select":347,"mixins/select2":348,"mixins/widget":349}],344:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.default={computed:{filename:function(){return this.value&&this.value.split("/").pop()}},methods:{isMedia:function(e){return!(!e||"object"!==(void 0===e?"undefined":n(e))||e.constructor!==Object||!e.mime_type)},getMediaType:function(e){var t={type:null,options:{}};switch(e){case"image/gif":case"image/png":case"image/jpeg":case"image/bmp":t.type="image";break;case"application/pdf":t.type="pdf";break;case"video/mp4":case"video/ogg":case"video/x-ms-wmv":case"video/x-msvideo":case"video/quicktime":t.type="video",t.options.format=e;break;case"application/gzip":case"application/zip":t.type="zip";break;case"application/msword":case"application/vnd.oasis.opendocument.text":t.type="text";break;case"application/vnd.ms-office":case"application/vnd.oasis.opendocument.spreadsheet":t.type="excel";break;case"application/vnd.openxmlformats-officedocument.presentationml.presentation":case"application/vnd.ms-powerpoint":case"application/vnd.oasis.opendocument.presentation":t.type="ppt";break;default:t.type="unknow"}return t}}}},{}],345:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default={methods:{findAttributeFormMetadataAttribute:function(e){return!!this.state.metadata&&void 0!==this.state.metadata[e]},findMetadataAttribute:function(e){return void 0!==this.state[e]}}}},{}],346:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("services/gui"),i=(n=n)&&n.__esModule?n:{default:n};function a(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var o,n=e("core/utils/utils"),s={throttle:n.throttle,debounce:n.debounce};r.default={created:function(){var e=this.delayType&&s[this.delayType]||s.throttle;this.delayResize=this.resize?e(this.resize.bind(this),this.delayTime):null,i.default.on("resize",this.delayResize)},mounted:(o=a(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.resize&&this.resize();case 3:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)}),beforeDestroy:function(){i.default.off("resize",this.delayResize),this.delayResize=null,this.delayTime=null}}},{"core/utils/utils":68,"services/gui":361}],347:[function(e,t,r){function n(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i,a=e("core/i18n/i18n.service").getAppLanguage;r.default={methods:{getLanguage:function(){return a()},changeSelect:function(e){this.state.value="null"===e?null:e,this.change()},getValue:function(e){return null===e?"null":e},resetValues:function(){this.state.input.options.values.splice(0)}},computed:{autocomplete:function(){return"select_autocomplete"===this.state.input.type&&this.state.input.options.usecompleter}},watch:{notvalid:(i=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.select2&&(t?this.select2.data("select2").$container.addClass("input-error-validation"):this.select2.data("select2").$container.removeClass("input-error-validation"));case 3:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})}}},{"core/i18n/i18n.service":13}],348:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=i(e("store/application-state")),e=i(e("mixins/resize"));function i(e){return e&&e.__esModule?e:{default:e}}r.default={mixins:[e.default],methods:{setValue:function(){this.select2.val(this.state.value).trigger("change")},resize:function(){this.select2&&!n.default.ismobile&&this.select2.select2("close")}},beforeDestroy:function(){this.select2&&this.select2.select2("destroy"),this.select2.off(),this.select2=null}}},{"mixins/resize":346,"store/application-state":373}],349:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default={data:function(){return{changed:!1}},methods:{widgetChanged:function(){this.changed=!0,this.change()},stateValueChanged:function(e){}},watch:{"state.value":function(e){this.changed?this.changed=!1:this.stateValueChanged(e)}}}},{}],350:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("core/utils/utils"),i=n.base,a=n.inherit,o=n.reject;function s(){this._config=null,this._baseUrl=null,this.init=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=$.Deferred();return this._config=e,this._baseUrl=e.urls.api,this._apiEndpoints=e.urls.apiEndpoints,t.resolve(),t.promise()};var e=0;this._incrementLoaders=function(){0===e&&this.emit("apiquerystart"),e+=1},this._decrementLoaders=function(){0===--e&&this.emit("apiqueryend")},this.get=function(t,e){var r=this,n=this._apiEndpoints[t];return n?(n=this._baseUrl+"/"+n,e.request&&(n=n+"/"+e.request),e=e.params||{},this.emit(t+"querystart"),this._incrementLoaders(),$.get(n,e).done(function(e){return r.emit(t+"queryend",e),e}).fail(function(e){return r.emit(t+"queryfail",e),e}).always(function(){return r._decrementLoaders()})):o()},i(this)}a(s,e("core/g3wobject")),r.default=new s},{"core/g3wobject":12,"core/utils/utils":68}],351:[function(i,e,t){Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=r(i("config")),s=i("app/constant"),l=r(i("store/application-state")),u=r(i("services/data")),c=r(i("store/plugins")),d=r(i("store/projects")),p=r(i("services/api")),f=r(i("services/clipboard")),h=r(i("services/router")),g=r(i("services/gui"));function r(e){return e&&e.__esModule?e:{default:e}}function v(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}function n(){var t,r,n=this;this.version=s.APP_VERSION,l.default.iframe=window.top!==window.self,l.default.online=navigator.onLine,l.default.ismobile=isMobile.any,this.complete=!1,this.baseurl="/",this.download_caller_id=null,this._applicationServices={},this.config={},this._initConfigUrl=null,this._initConfig=null,this._groupId=null,this._gid=null,this.setters={changeProject:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.gid,e=e.host;return this._changeProject({gid:t,host:e})},changeMapProject:function(e){var t=e.url,e=e.epsg,t=g.default.getService("map").addMapExtentUrlParameterToUrl(t,e);history.replaceState(null,null,t),location.replace(t)},online:function(){this.setOnline()},offline:function(){this.setOffline()},setFilterToken:function(e){this._setFilterToken(e)}},b(this),this.on("initconfig",function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).user;n.setApplicationUser(e)}),this.init=v(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.createApplicationConfig();case 3:return r=e.sent,this.setConfig(r),this.setLayout("app",r.layout),e.next=8,this.bootstrap();case 8:return e.abrupt("return",e.sent);case 11:return e.prev=11,e.t0=e.catch(0),t=navigator&&navigator.language||"en",r=o.default.supportedLanguages.find(function(e){return-1!==t.indexOf(e)}),e.abrupt("return",Promise.reject({error:e.t0,language:r}));case 16:case"end":return e.stop()}},e,this,[[0,11]])})),this.setupI18n=function(){var t=this,e=this._config._i18n;e.appLanguages=this._config.i18n.map(function(e){return e[0]}),this.setApplicationLanguage(e.language),y(e),this._groupId=this._config.group.slug||this._config.group.name.replace(/\s+/g,"-").toLowerCase(),$.ajaxSetup({beforeSend:function(e){e.setRequestHeader("Accept-Language",t._config.user.i18n||"en")}})},this.getCurrentProject=function(){return d.default.getCurrentProject()},this.setDownload=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=arguments[1],r=!e&&t&&this.download_caller_id===t,n=!r&&t&&e&&null===this.download_caller_id;return!t&&(l.default.download=e),r&&(l.default.download=!1,this.download_caller_id=null),n&&(l.default.download=e,this.download_caller_id=S()),this.download_caller_id},this.getDownload=function(){return l.default.download},this.loadingPlugin=function(e){l.default.plugins.push(e)},this.loadedPlugin=function(t){l.default.plugins=l.default.plugins.filter(function(e){return e!==t})},this._setFilterToken=function(e){l.default.tokens.filtertoken=e},this.getFilterToken=function(){return l.default.tokens.filtertoken},this.changeLanguage=function(e){_(e),l.default.lng=e,l.default.language=e;var t=window.location.pathname.split("/");t[1]=e,history.replaceState(null,null,t.join("/"))},this.registerOnlineOfflineEvent=function(){var e=this;this.registerWindowEvent({evt:"online",cb:function(){return e.online()}}),this.registerWindowEvent({evt:"offline",cb:function(){return e.offline()}})},this.getBaseLayerId=function(){return l.default.baseLayerId},this.setBaseLayerId=function(e){l.default.baseLayerId=e},this.registerLeavePage=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.bool,t=void 0!==t&&t,r=(e.message,t||void 0);window.onbeforeunload=function(e){return r}},this.unregisterOnlineOfflineEvent=function(){window.removeEventListener("online"),window.removeEventListener("offline")},this.getState=function(){return l.default},this.disableApplication=function(){l.default.gui.app.disabled=0<arguments.length&&void 0!==arguments[0]&&arguments[0]},this.setApplicationLanguage=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"en";l.default.lng=e,l.default.language=e},this.getApplicationLanguage=function(){return l.default.language},this.setOnline=function(){l.default.online=!0},this.setOffline=function(){l.default.online=!1},this.isOnline=function(){return l.default.online},this.setOfflineItem=(t=v(regeneratorRuntime.mark(function e(t){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setLocalItem({id:t,data:r});case 1:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)}),this.setLocalItem=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,e=e.data;try{window.localStorage.setItem(t,JSON.stringify(e))}catch(e){return e}},this.removeLocalItem=function(e){window.localStorage.removeItem(e)},this.getLocalItem=function(e){e=window.localStorage.getItem(e);return e?JSON.parse(e):void 0},this.getOfflineItem=function(e){return this.getLocalItem(e)},this.removeOfflineItem=function(e){this.removeLocalItem(e)},this.isIframe=function(){return l.default.iframe},this.getConfig=function(){return this._config},this.setConfig=function(){this._config=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}},this.getRouterService=function(){return h.default},this.getProxyUrl=function(){return""+this._initConfig.proxyurl},this.getInterfaceOwsUrl=function(){return""+this._initConfig.interfaceowsurl},this.getClipboardService=function(){return f.default},this.createApplicationConfig=(r=v(regeneratorRuntime.mark(function e(t){var r,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=a({},o.default),e.prev=1,t?(e.t0=t,e.next=9):e.next=6;break;case 6:return e.next=8,this.obtainInitConfig({initConfigUrl:""+o.default.server.urls.initconfig});case 8:e.t0=e.sent;case 9:return t=e.t0,this.baseurl=t.baseurl,e.next=13,this.getMacrogroupsGroups();case 13:return i=e.sent,n=i.macrogroups,i=i.groups,r.server.urls.baseurl=t.baseurl,r.server.urls.frontendurl=t.frontendurl,r.server.urls.staticurl=t.staticurl,r.server.urls.clienturl=t.staticurl+t.client,r.server.urls.mediaurl=t.mediaurl,r.server.urls.vectorurl=t.vectorurl,r.server.urls.proxyurl=t.proxyurl,r.server.urls.rasterurl=t.rasterurl,r.server.urls.interfaceowsurl=t.interfaceowsurl,r.main_map_title=t.main_map_title,r.group=t.group,r.user=t.user,r.credits=t.credits,r.i18n=t.i18n,r._i18n.language=r.user.i18n,r.group.layout.iframe=window.top!==window.self,e.abrupt("return",{apptitle:r.apptitle||"",logo_img:r.group.header_logo_img,logo_link:r.group.header_logo_link,terms_of_use_text:r.group.header_terms_of_use_text,terms_of_use_link:r.group.terms_of_use_link,header_custom_links:r.group.header_custom_links,debug:r.client.debug||!1,group:r.group,urls:r.server.urls,mediaurl:r.server.urls.mediaurl,resourcesurl:r.server.urls.clienturl,vectorurl:r.server.urls.vectorurl,rasterurl:r.server.urls.rasterurl,interfaceowsurl:r.server.urls.interfaceowsurl,projects:r.group.projects,initproject:r.group.initproject,overviewproject:r.group.overviewproject&&r.group.overviewproject.gid?r.group.overviewproject:null,baselayers:r.group.baselayers,mapcontrols:r.group.mapcontrols,background_color:r.group.background_color,crs:r.group.crs,minscale:r.group.minscale,maxscale:r.group.maxscale,main_map_title:r.main_map_title,credits:r.credits,_i18n:r._i18n,i18n:r.i18n,layout:r.group.layout||{},getWmsUrl:function(e){return r.server.urls.baseurl+r.server.urls.ows+"/"+r.group.id+"/"+e.type+"/"+e.id+"/"},getProjectConfigUrl:function(e){return r.server.urls.baseurl+r.server.urls.config+"/"+r.group.id+"/"+e.type+"/"+e.id+"?_t="+e.modified},plugins:r.group.plugins,tools:r.tools,views:r.views||{},user:r.user||null,groups:i,macrogroups:n});case 35:return e.prev=35,e.t1=e.catch(1),e.abrupt("return",Promise.reject(e.t1));case 38:case"end":return e.stop()}},e,this,[[1,35]])})),function(e){return r.apply(this,arguments)}),this.getMacrogroupsGroups=v(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],r=[],e.prev=2,e.next=5,x.get({url:"/"+this.getApplicationUser().i18n+s.API_BASE_URLS.ABOUT.macrogroups});case 5:t=e.sent,e.next=10;break;case 8:e.prev=8,e.t0=e.catch(2);case 10:return e.prev=10,e.next=13,x.get({url:"/"+this.getApplicationUser().i18n+s.API_BASE_URLS.ABOUT.nomacrogoups});case 13:r=e.sent,e.next=18;break;case 16:e.prev=16,e.t1=e.catch(10);case 18:return e.abrupt("return",{macrogroups:t,groups:r});case 19:case"end":return e.stop()}},e,this,[[2,8],[10,16]])})),this.obtainInitConfig=v(regeneratorRuntime.mark(function e(){var t,r,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=n.initConfigUrl,a=n.url,o=n.host;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._initConfigUrl?this.clearInitConfig():this._initConfigUrl=i,this._initConfig=window.initConfig,t=void 0,(r=a?a.split("?")[1]:location.search.substring(1))?r.split("&").forEach(function(e){t=-1<e.indexOf("project")?e.split("=")[1]:t}):this._gid&&(t=this._groupId+"/"+this._gid.split(":").join("/")),e.prev=5,t)return e.next=9,this.getInitConfig(""+(o||"")+this.baseurl+this._initConfigUrl+"/"+t);e.next=10;break;case 9:this._initConfig=e.sent;case 10:e.next=15;break;case 12:return e.prev=12,e.t0=e.catch(5),e.abrupt("return",Promise.reject(e.t0));case 15:return e.prev=15,window.initConfig=this._initConfig,this.emit("initconfig",this._initConfig),this.setInitVendorKeys(this._initConfig),e.abrupt("return",Promise.resolve(this._initConfig));case 21:case"end":return e.stop()}},e,this,[[5,12,15,21]])})),this.getInitConfig=function(e){var n=this;return new Promise(function(t,r){n._initConfig?t(n._initConfig):x.get({url:e}).then(function(e){return t(e)}).catch(function(e){return r(e)})})},this.getInitConfigUrl=function(){return this._initConfigUrl},this.setInitConfigUrl=function(e){this._initConfigUrl=e},this.setEPSGApplication=function(e){l.default.map.epsg=e.state.crs.epsg},this.setApplicationUser=function(e){l.default.user=e},this.getApplicationUser=function(){return l.default.user},this.bootstrap=function(){var i=this;return new Promise(function(t,r){i.setupI18n();var n=setTimeout(function(){r("Timeout")},s.TIMEOUT);l.default.ready||$.when(d.default.init(i._config),p.default.init(i._config)).then(function(){clearTimeout(n),i.registerOnlineOfflineEvent(),i.emit("ready"),l.default.ready=i.initialized=!0;var e=d.default.getCurrentProject();i._gid=e.getGid(),i.setEPSGApplication(e),l.default.iframe&&i.startIFrameService({project:e}),u.default.init(),i.initLocalItems(),t(!0)}).fail(function(e){return r(e)})})},this.postBootstrap=v(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.complete){e.next=13;break}return e.prev=1,h.default.init(),e.next=5,c.default.init({pluginsBaseUrl:this._config.urls.staticurl,pluginsConfigs:this._config.plugins,otherPluginsConfig:d.default.getCurrentProject().getState()});case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(1);case 9:return e.prev=9,this.complete=!0,this.emit("complete"),e.finish(9);case 13:case"end":return e.stop()}},e,this,[[1,7,9,13]])})),this.startIFrameService=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).project;i("core/iframe/routerservice").init({project:e})},this.registerWindowEvent=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.evt,e=e.cb;window.addEventListener(t,e)},this.unregisterWindowEvent=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.evt,e=e.cb;window.removeEventListener(t,e)},this.registerService=function(e,t){this._applicationServices[e]=t},this.unregisterService=function(e){delete this._applicationServices[e]},this.getApplicationService=function(e){return this._applicationServices[e]},this.getService=function(e){return this._applicationServices[e]},this.errorHandler=function(e){},this.clearInitConfig=function(){window.initConfig=this._initConfig=null},this.setInitVendorKeys=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.group.vendorkeys||{};e.group.baselayers.forEach(function(e){e.apikey&&(t[e.servertype?e.servertype.toLowerCase():null]=e.apikey)}),this.setVendorKeys(t)},this.setVendorKeys=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};Object.keys(t).forEach(function(e){return l.default.keys.vendorkeys[e]=t[e]})},this.changeProjectView=function(e){l.default.changeProjectview=e},this.isProjectViewChanging=function(){return l.default.changeProjectview},this.reloadCurrentProject=function(){return this.changeProject({gid:d.default.getCurrentProject().getGid()})},this._changeProject=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.gid,e=(e.host,e.crs),r=$.Deferred(),t=(this._gid=t,d.default.getProjectUrl(t)),t=g.default.getService("map").addMapExtentUrlParameterToUrl(t,e);try{history.replaceState(null,null,t)}catch(e){}return location.replace(t),r.resolve(),r.promise()},this.setLayout=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"app",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=t.rightpanel||{width:50,height:50,width_default:50,height_default:50,width_100:!1,height_100:!1};t.rightpanel=Object.assign(r,{width:t.rightpanel.width||r.width,height:t.rightpanel.height||r.width,width_default:t.rightpanel.width||r.width,height_default:t.rightpanel.height||r.width,width_100:!1,height_100:!1}),l.default.gui.layout[e]=t},this.removeLayout=function(e){e&&delete l.default.gui.layout[e]},this.setCurrentLayout=function(){l.default.gui.layout.__current=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"app"},this.getCurrentLayout=function(){return l.default.gui.layout[l.default.gui.layout.__current]},this.getCurrentLayoutName=function(){return l.default.gui.layout.__current},this.cloneLayout=function(){return JSON.parse(JSON.stringify(l.default.gui.layout[0<arguments.length&&void 0!==arguments[0]?arguments[0]:"app"]))},this.clear=function(){this.unregisterOnlineOfflineEvent()},this.initLocalItems=function(){var t=this;Object.keys(s.LOCAL_ITEM_IDS).forEach(function(e){void 0===t.getLocalItem(e)&&t.setLocalItem({id:e,data:s.LOCAL_ITEM_IDS[e].value})})}}var m=i("core/i18n/i18n.service"),y=m.init,_=m.changeLanguage,m=i("core/utils/utils"),b=m.base,w=m.inherit,x=m.XHR,S=m.uniqueId;w(n,i("core/g3wobject")),t.default=new n},{"app/constant":4,config:3,"core/g3wobject":12,"core/i18n/i18n.service":13,"core/iframe/routerservice":14,"core/utils/utils":68,"services/api":350,"services/clipboard":352,"services/data":358,"services/gui":361,"services/router":368,"store/application-state":373,"store/plugins":378,"store/projects":379}],352:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=new function(){this._data={},this.set=function(e,t){e=e.split("form")[0];this._data[e]=t},this.get=function(e){var t=this._data[e]||{};return this._data[e]={},t}}},{}],353:[function(e,t,r){function n(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/data/service"),a=e("core/utils/utils"),o=a.base,s=a.inherit,l=a.XHR,u=e("core/utils/geo").getFeaturesFromResponseVectorApi;function c(){o(this),this.expression=n(regeneratorRuntime.mark(function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=this,e.next=4,this.handleRequest({url:""+this.project.getUrl("vector_data")+t.layer_id+"/",params:t});case 4:return e.t1=e.sent,e.abrupt("return",e.t0.handleResponse.call(e.t0,e.t1));case 8:return e.prev=8,e.t2=e.catch(0),e.abrupt("return",Promise.reject(e.t2));case 11:case"end":return e.stop()}},e,this,[[0,8]])})),this.expression_eval=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this.handleRequest({url:this.project.getUrl("expression_eval"),params:e})},this.handleRequest=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.params,e=e.contentType;return l.post({url:t,contentType:void 0===e?"application/json":e,data:JSON.stringify(void 0===r?{}:r)})},this.handleResponse=function(){return u(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}}s(c,i),r.default=new c},{"core/data/service":5,"core/utils/geo":64,"core/utils/utils":68}],354:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("services/application"),i=(n=n)&&n.__esModule?n:{default:n};function a(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var n=e("core/utils/utils"),o=n.base,s=n.inherit,l=n.XHR;function u(){o(this),this.wmsCapabilities=a(regeneratorRuntime.mark(function e(){var t,r,n=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).url;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=""+i.default.getInterfaceOwsUrl(),e.prev=1,t={url:n,service:"wms"},t=JSON.stringify(t),e.next=6,l.post({url:r,contentType:"application/json",data:t});case 6:return r=e.sent,e.abrupt("return",r);case 10:return e.prev=10,e.t0=e.catch(1),e.abrupt("return");case 13:case"end":return e.stop()}},e,this,[[1,10]])}))}s(u,e("core/data/service")),r.default=new u},{"core/data/service":5,"core/utils/utils":68,"services/application":351}],355:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("services/application"),u=(n=n)&&n.__esModule?n:{default:n};function i(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var n=e("core/utils/utils"),a=n.base,o=n.inherit,c=n.XHR;function s(){a(this),this.wms=i(regeneratorRuntime.mark(function e(){var t,r,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=n.url,a=n.method,o=void 0===a?"GET":a,a=n.params,s=void 0===a?{}:a,a=n.headers,l=void 0===a?{}:a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=""+u.default.getProxyUrl(),"GET"===o&&(i=new URL(i),Object.keys(s).forEach(function(e){return i.searchParams.set(e,s[e])}),i=i.toString()),e.prev=2,t=JSON.stringify({url:i,params:s,headers:l,method:o}),e.next=6,c.post({url:r,contentType:"application/json",data:t});case 6:return r=e.sent,e.abrupt("return",{response:r,data:t});case 10:return e.prev=10,e.t0=e.catch(2),e.abrupt("return");case 13:case"end":return e.stop()}},e,this,[[2,10]])})),this.data=function(){}}o(s,e("core/data/service")),r.default=new s},{"core/data/service":5,"core/utils/utils":68,"services/application":351}],356:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p=e("app/constant");function n(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var i=e("core/utils/utils"),a=i.base,i=i.inherit,c=e("core/i18n/i18n.service").t,o=e("core/data/service"),e=e("core/utils/geo"),f=e.getQueryLayersPromisesByCoordinates,d=e.getQueryLayersPromisesByGeometry,h=e.getQueryLayersPromisesByBBOX,g=e.getMapLayersByFilter;function s(){var t;a(this),this.condition={filtrable:{ows:"WFS"}},this.polygon=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.feature,r=e.feature_count,r=void 0===r?this.project.getQueryFeatureCount():r,n=e.filterConfig,n=void 0===n?{}:n,i=e.multilayers,i=void 0!==i&&i,a=e.condition,a=void 0===a?this.condition:a,o=e.layerName,o=void 0===o?"":o,s=e.excludeSelected,s=void 0===s?null:s,e=e.external,e=void 0===e?{add:!0,filter:{SELECTED:!1}}:e,l=this.hasExternalLayerSelected({type:"vector"})?t.getId():t.get(p.G3W_FID),t=t.getGeometry();return t?this.handleRequest(d(g(u({},"boolean"==typeof s?{SELECTED:!s}:{SELECTED_OR_ALL:!0},{FILTERABLE:!0,VISIBLE:!0}),a),{geometry:t,multilayers:i,feature_count:r,filterConfig:n,projection:this.project.getProjection()}),{fid:l,geometry:t,layerName:o,type:"polygon",filterConfig:n,external:e}):this.returnExceptionResponse({usermessage:{type:"warning",message:o+" - "+c("sdk.mapcontrols.querybypolygon.no_geometry"),messagetext:!0,autoclose:!1}})},this.bbox=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.bbox,r=e.feature_count,r=void 0===r?this.project.getQueryFeatureCount():r,n=e.filterConfig,n=void 0===n?{}:n,i=e.multilayers,i=void 0!==i&&i,a=e.condition,a=void 0===a?this.condition:a,o=e.excludeSelected,o=void 0===o?null:o,s=e.addExternal,s=void 0===s||s,e=e.layersFilterObject,e=void 0===e?{SELECTED_OR_ALL:!0,FILTERABLE:!0,VISIBLE:!0}:e,l=this.hasExternalLayerSelected({type:"vector"}),s={bbox:t,type:"bbox",filterConfig:n,external:{add:s,filter:{SELECTED:l||"boolean"==typeof o&&o}}};return l?this.handleRequest(this.getEmptyRequest(),s):this.handleRequest(h(g(e,a),{bbox:t,feature_count:r,filterConfig:n,multilayers:i}),s)},this.coordinates=n(regeneratorRuntime.mark(function e(){var t,r,n,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=i.coordinates,o=i.layerIds,s=void 0===o?[]:o,o=i.multilayers,l=void 0!==o&&o,o=i.query_point_tolerance,u=void 0===o?p.QUERY_POINT_TOLERANCE:o,o=i.addExternal,c=void 0===o||o,d=i.feature_count;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.hasExternalLayerSelected({type:"vector"}),t={coordinates:a,type:"coordinates",external:{add:c,filter:{SELECTED:n}}},n&&0===s.length)return e.abrupt("return",this.handleRequest(this.getEmptyRequest(),t));e.next=4;break;case 4:return r={QUERYABLE:!0,SELECTED_OR_ALL:0===s.length,VISIBLE:!0},Array.isArray(s)&&s.forEach(function(e){r.IDS||(r.IDS=[]),r.IDS.push(e)}),1===(n=g(r)).length&&n[0].isSelected()&&(t.external.add=!1),e.abrupt("return",this.handleRequest(f(n,{multilayers:l,feature_count:d,query_point_tolerance:u,coordinates:a}),t));case 9:case"end":return e.stop()}},e,this)})),this.handleRequest=function(r){var n=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(t,e){r.then(function(e){e=n.handleResponse(e,i);t(e)}).fail(e)})},this.handleResponse=function(e){var t={query:1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},type:"ows",data:[],result:!0};return e.forEach(function(e){return e.data&&e.data.forEach(function(e){return t.data.push(e)})}),t},this.returnExceptionResponse=(t=n(regeneratorRuntime.mark(function e(t){var r=t.usermessage;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{data:[],usermessage:r,result:!0,error:!0});case 1:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})}i(s,o),r.default=new s},{"app/constant":4,"core/data/service":5,"core/i18n/i18n.service":13,"core/utils/geo":64,"core/utils/utils":68}],357:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function n(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var i=e("core/utils/utils"),a=i.base,i=i.inherit,l=e("core/utils/geo").createOlFeatureFromApiResponseFeature;function o(){a(this),this.features=n(regeneratorRuntime.mark(function e(){var u=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{layer:layer,search_endpoint:search_endpoint,filter:filter,raw:!1,queryUrl:queryUrl,feature_count:feature_count,ordering:ordering};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n(regeneratorRuntime.mark(function e(){var r,t,n,i,a,o,s,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],t=u.layer,n=function(e,t){var r,n={};for(r in e)0<=t.indexOf(r)||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(u,["layer"]),l=u.raw,i=void 0!==l&&l,l=u.filter,a={data:[],query:{type:"search",search:l},type:n.search_endpoint},o=Array.isArray(t)?t:[t],n.filter=Array.isArray(n.filter)?n.filter:[n.filter],"api"===n.search_endpoint?o.forEach(function(e,t){return r.push(e.searchFeatures(c({},n,{filter:n.filter[t]})))}):(s=o[0].getProvider("search"),l=new Promise(function(t,e){s.query(c({},n,{layers:o},o[0].getSearchParams())).then(function(e){t({data:e})}).fail(e)}),r.push(l)),e.next=9,Promise.allSettled(r);case 9:return e.sent.forEach(function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.status,e=e.value;"fulfilled"===t&&(i?a.data.push("api"===n.search_endpoint?{data:e}:e):(e=void 0===(t=e.data)?[]:t,"api"===n.search_endpoint?e.length&&a.data.push(e[0]):a.data=e))}),e.abrupt("return",a);case 12:case"end":return e.stop()}},e,this)}))());case 1:case"end":return e.stop()}},e,this)})),this.fids=n(regeneratorRuntime.mark(function e(){var t,r,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=n.layer,a=n.formatter,o=void 0===a?0:a,a=n.fids,s=void 0===a?[]:a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t={data:[{layer:i,features:[]}],query:{type:"search"}},e.prev=1,e.t0=i,e.t0)return e.next=6,i.getFeatureByFids({fids:s,formatter:o});e.next=7;break;case 6:e.t0=e.sent;case 7:(r=e.t0)&&r.forEach(function(e){return t.data[0].features.push(l(e))}),e.next=13;break;case 11:e.prev=11,e.t1=e.catch(1);case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}},e,this,[[1,11]])})),this.layersfids=n(regeneratorRuntime.mark(function e(){var r,t,n=this,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=i.layers,o=void 0===a?[]:a,a=i.fids,s=void 0===a?[]:a,a=i.formatter,l=void 0===a?0:a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],t={data:[],query:{type:"search"}},o.forEach(function(e,t){r.push(n.fids({layer:e,fids:s[t],formatter:l}))}),e.prev=3,e.next=6,Promise.all(r);case 6:e.sent.forEach(function(e){return t.data.push(e.data)}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3);case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}},e,this,[[3,10]])}))}i(o,e("core/data/service")),r.default=new o},{"core/data/service":5,"core/utils/geo":64,"core/utils/utils":68}],358:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=n(e("services/data-expression")),a=n(e("services/data-ows")),o=n(e("services/data-proxy")),s=n(e("services/data-query")),l=n(e("services/data-search")),u=n(e("services/iframe-plugin")),c=n(e("services/gui"));function n(e){return e&&e.__esModule?e:{default:e}}function d(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}function p(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var f=e("core/utils/utils").splitContextAndMethod;r.default=new function(){var t,r,n;this.defaultoutputplaces=["gui"],this.currentoutputplaces=[].concat(p(this.defaultoutputplaces)),this.ouputplaces={gui:(r=d(regeneratorRuntime.mark(function e(t){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c.default.setLoadingContent(!0),e.prev=1,c.default.outputDataPlace(t,r),e.next=5,t;case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(1);case 9:c.default.setLoadingContent(!1);case 10:case"end":return e.stop()}},e,this,[[1,7]])})),function(e){return r.apply(this,arguments)}),iframe:(t=d(regeneratorRuntime.mark(function e(t){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:u.default.outputDataPlace(t,r);case 1:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},this.init=d(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.services={query:s.default,search:l.default,expression:i.default,proxy:o.default,ows:a.default};case 1:case"end":return e.stop()}},e,this)})),this.getData=(n=d(regeneratorRuntime.mark(function e(t){var r,n,i,a,o,s,l=this,u=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=f(t),n=r.context,r=r.method,n=this.getService(n),i=u.inputs,i=void 0===i?{}:i,s=u.outputs,a=void 0===s?{}:s,o=n[r](i),a&&this.currentoutputplaces.forEach(function(e){l.ouputplaces[e](o,a)}),e.next=7,o;case 7:return s=e.sent,e.next=10,s;case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)}),this.showEmptyOutputs=function(){var t=this,r=Promise.resolve({data:[]});this.currentoutputplaces.forEach(function(e){t.ouputplaces[e](r)})},this.showCustomOutputDataPromise=function(t){var r=this;this.currentoutputplaces.forEach(function(e){r.ouputplaces[e](t,{})})},this.getService=function(e){return this.services[e]},this.setOutputPlaces=function(){this.currentoutputplaces=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]},this.addCurrentOutputPlace=function(e){e&&-1===this.currentoutputplaces.indexOf(e)&&this.currentoutputplaces.push(e)},this.addNewOutputPlace=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.place,e=e.method,r=!1;return void 0===this.ouputplaces[t]&&(this.ouputplaces[t]=void 0===e?function(){}:e,r=!0),r},this.resetDefaultOutput=function(){this.currentoutputplaces=[].concat(p(this.defaultoutputplaces))}}},{"core/utils/utils":68,"services/data-expression":353,"services/data-ows":354,"services/data-proxy":355,"services/data-query":356,"services/data-search":357,"services/gui":361,"services/iframe-plugin":364}],359:[function(e,t,r){function a(){this.execute=function(t,e,r){var n,i=void 0;e.forEach(function(e){i=e.feature,r&&i[a.Actions[i.getState()].opposite](),n=a.Actions[i.getState()].fnc,t[n](i)})}}Object.defineProperty(r,"__esModule",{value:!0}),a.Actions={add:{fnc:"addFeature",opposite:"delete"},delete:{fnc:"removeFeature",opposite:"add"},update:{fnc:"updateFeature",opposite:"update"}},r.default=new a},{}],360:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("services/gui"),i=(n=n)&&n.__esModule?n:{default:n};var a=e("gui/utils/utils").barstack;r.default=new function(){this.stack=new a,this.init=function(e){this.layout=e,this.sidebarEl=$(this.layout.options.controlSidebarOptions.selector),this._zindex=this.sidebarEl.css("z-index"),this._modalOverlay=null,this._modal=!1,this._isopen=!1},this.isOpen=function(){return this._isopen},this.open=function(){this.layout.floatBar.open(this.sidebarEl,!0),this._isopen=!0},this.close=function(){this.layout.floatBar.close(this.sidebarEl,!0),this._isopen=!1},this.showPanel=function(e,t){t=t||{},t.modal;t.parent="#g3w-floatbarpanel-placeholder",this.stack.push(e,t),this._isopen||this.open()},this.closePanel=function(e){e?this.stack.remove(e):this.stack.pop(),this.stack.getLength()||(this._modal?(i.default.setModal(!1),this.close(),$(".control-sidebar-bg").toggleClass("control-sidebar-bg-shadow"),this.sidebarEl.css("z-index",""),this.sidebarEl.css("padding-top","50px"),$(".control-sidebar-bg").css("z-index",""),this._modal=!1):this.close())},this.hidePanel=function(){this.close()}}},{"gui/utils/utils":188,"services/gui":361}],361:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=a(e("services/router")),i=a(e("store/components"));function a(e){return e&&e.__esModule?e:{default:e}}var o=e("core/utils/utils"),s=o.base,l=o.inherit,u=o.noop;function c(){this.setters={setContent:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.emit("opencontent",!0),this._setContent(e)}},this.isready=!1,this.getResourcesUrl=u,this.showForm=u,this.closeForm=u,this.showListing=u,this.closeListing=u,this.hideListing=u,this.setModal=u,this.showFullModal=u,this.showQueryResults=u,this.hideQueryResults=u,this.showPanel=u,this.hidePanel=u,this.reloadComponents=u,this.showUserMessage=u,this.closeUserMessage=u,this.showModalDialog=u,this.push_content=!1,this.setPushContent=function(){this.push_content=0<arguments.length&&void 0!==arguments[0]&&arguments[0]},this.getPushContent=function(){return this.push_content},this._closeUserMessageBeforeSetContent=!0,this.setComponent=function(e){i.default.registerComponent(e)},this.getComponent=function(e){return i.default.getComponent(e)},this.getComponents=function(){return i.default.getComponents()},this.goto=function(e){n.default.goto(e)},this.ready=function(){this.emit("ready"),this.isready=!0},this.guiResized=function(){this.emit("guiresized")},this.isReady=function(){var t=this;return new Promise(function(e){return t.isready?e():t.once("ready",e)})},this.getService=function(e){e=this.getComponent(e);return e&&e.getService()},this.showSpinner=function(){},this.hideSpinner=function(e){},this.notify=u,this.dialog=u,this.isMobile=u,s(this)}l(c,e("core/g3wobject")),r.default=new c},{"core/g3wobject":12,"core/utils/utils":68,"services/router":368,"store/components":375}],362:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("services/data"),i=(n=n)&&n.__esModule?n:{default:n};function a(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var n=e("core/utils/utils"),o=n.base;function s(){var t,r;o(this),this.mapControls={screenshot:{control:null},changeMap:{control:null}},this.init=function(){var r=this;return new Promise(function(e,t){r.mapService.once("ready",function(){r._map=r.mapService.getMap(),r._mapCrs=r.mapService.getCrs(),r.mapControls.screenshot.control=r.mapService.getMapControlByType({type:"screenshot"}),r.setReady(!0),e()})})},this.results=(t=a(regeneratorRuntime.mark(function e(t){var t=t.capture,r=void 0===t||t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r?i.default.setOutputPlaces(["iframe"]):i.default.resetDefaultOutput(),e.abrupt("return",[]);case 2:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)}),this.screenshot=(r=a(regeneratorRuntime.mark(function e(t){var r,n=this,t=t.capture,i=void 0===t||t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r="app:screenshot",i?this.mapControls.screenshot.control.overwriteOnClickEvent(a(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.mapService.createMapImage();case 3:t=e.sent,n.emit("response",{action:r,response:{result:!0,data:t}}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),n.emit("response",{action:r,response:{result:!1,data:e.t0}});case 10:case"end":return e.stop()}},e,n,[[0,7]])}))):this.mapControls.screenshot.control.resetOriginalOnClickEvent();case 2:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)}),this.getcenter=a(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.mapService.getCenter());case 1:case"end":return e.stop()}},e,this)})),this.zoomtocoordinates=a(regeneratorRuntime.mark(function e(){var t,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.coordinates,t=void 0===t?[]:t,r.highlight,t&&Array.isArray(t)&&2===t.length)return this.mapService.zoomTo(t),e.abrupt("return",t);e.next=6;break;case 6:return e.abrupt("return",Promise.reject(t));case 7:case"end":return e.stop()}},e,this)})),this.getextent=a(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.mapService.getMapExtent());case 1:case"end":return e.stop()}},e,this)})),this.zoomtoextent=a(regeneratorRuntime.mark(function e(){var t,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.extent,(t=void 0===t?[]:t)&&Array.isArray(t)&&4===t.length)return this.mapService.goToBBox(t),e.abrupt("return",t);e.next=6;break;case 6:return e.abrupt("return",Promise.reject(t));case 7:case"end":return e.stop()}},e,this)})),this.zoomtofeature=a(regeneratorRuntime.mark(function e(){var o=this,s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var r=a(regeneratorRuntime.mark(function e(t,r){var n,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.qgs_layer_id,n=s.feature,i=s.highlight,i=void 0!==i&&i,a=o.getQgsLayerId({qgs_layer_id:a}),e.next=4,o.findFeaturesWithGeometry({qgs_layer_id:a,feature:n,zoom:!0,highlight:i});case 4:a=e.sent,t(a.qgs_layer_id);case 6:case"end":return e.stop()}},e,o)}));return function(e,t){return r.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e,this)}))}(0,n.inherit)(s,e("core/iframe/services/baseservice")),r.default=new s},{"core/iframe/services/baseservice":15,"core/utils/utils":68,"services/data":358}],363:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("services/gui"),u=(n=n)&&n.__esModule?n:{default:n};function c(e,t){var r,n={};for(r in e)0<=t.indexOf(r)||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function i(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var n=e("core/iframe/services/plugins/service"),e=g3wsdk.core.utils,a=e.base;function o(){var t,r,o=this;a(this),this.pluginName="editing",this.subscribevents=[],this.isRunning=!1,this.responseObject={cb:null,qgs_layer_id:null,error:null},this.config={tools:{add:{disabled:[{id:"deletefeature"},{id:"copyfeatures"},{id:"editmultiattributes"},{id:"deletePart"},{id:"splitfeature"},{id:"mergefeatures"}]},update:{disabled:[{id:"addfeature"},{id:"copyfeatures"},{id:"deletefeature"},{id:"editmultiattributes"},{id:"deletePart"},{id:"splitfeature"},{id:"mergefeatures"}]},delete:{enabled:[{id:"deletefeature",options:{active:!0}}]}}},this.startAction=(t=i(regeneratorRuntime.mark(function e(t){var r=this,n=t.toolboxes,i=t.resolve,a=t.reject;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.responseObject.cb=a,this.dependencyApi.setSaveConfig({cb:{done:function(e){r.responseObject.cb=i,r.responseObject.qgs_layer_id=e.getId(),r.responseObject.error=null,r.dependencyApi.hidePanel()},error:function(e,t){r.responseObject.cb=a,r.responseObject.qgs_layer_id=e.getId(),r.responseObject.error=t}}}),this.dependencyApi.showPanel({toolboxes:n}),this.isRunning=!0;case 4:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)}),this.stopAction=i(regeneratorRuntime.mark(function e(){var t,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.qgs_layer_id,e.t0=t,e.t0)return e.next=5,this.stopEditing(t);e.next=5;break;case 5:case"end":return e.stop()}},e,this)})),this.subscribersHandlers={canUndo:function(e){var r=e.activeTool,e=e.disableToolboxes,n=void 0===e?[]:e;return function(t){!1===t&&(o.responseObject.qgs_layer_id=null,o.responseObject.error=null),r.setEnabled(!t),n.forEach(function(e){return e.setEditing(!t)})}},canRedo:function(){},cancelform:function(e){return function(){e()}},addfeature:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=e.properties,a=e.toolboxes;return function(t){Object.keys(i).forEach(function(e){return t.set(e,i[e])});var e,r=void 0,n=[];a.forEach(function(e){var t=e.getToolById("addfeature");t.isActive()?(t.setEnabled(!1),r=t):(e.setEditing(!1),n.push(e))}),o.subscribevents.find(function(e){return"canUndo"!==e.event})&&(e=o.addSubscribeEvents("canUndo",{activeTool:r,disableToolboxes:n}),o.addSubscribeEvents("cancelform",e))}},closeeditingpanel:function(e){var t=e.qgs_layer_id;return function(){o.responseObject.cb({qgs_layer_id:o.responseObject.qgs_layer_id,error:o.responseObject.error}),o.stopAction({qgs_layer_id:t})}}},this.addSubscribeEvents=function(e){var t=this.subscribersHandlers[e](1<arguments.length&&void 0!==arguments[1]?arguments[1]:{});return this.dependencyApi.subscribe(e,t),this.subscribevents.push({event:e,handler:t}),t},this.resetSubscribeEvents=function(){var r=this;this.subscribevents.forEach(function(e){var t=e.event,e=e.handler;r.dependencyApi.unsubscribe(t,e)})},this.add=function(){var r,s=this,l=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return new Promise((r=i(regeneratorRuntime.mark(function e(t,r){var n,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:s.isRunning?(r(),e.next=19):e.next=4;break;case 4:return i=l.qgs_layer_id,n=c(l,["qgs_layer_id"]),n=n.properties,i=s.getQgsLayerId({qgs_layer_id:i,noValue:s.dependencyApi.getEditableLayersId()}),e.next=9,s.startAction({toolboxes:i,resolve:t,reject:r});case 9:return a={tools:s.config.tools.add,startstopediting:!1,action:"add",selected:1===i.length},e.next=12,s.startEditing(i,a);case 12:a=(a=e.sent).filter(function(e){return"fulfilled"===e.status}).map(function(e){return e.value}),u.default.isSidebarVisible()||u.default.showSidebar(),(o=1===a.length&&a[0])&&o.setActiveTool(o.getToolById("addfeature")),s.addSubscribeEvents("addfeature",{properties:n,toolboxes:a}),s.addSubscribeEvents("closeeditingpanel",{qgs_layer_id:i});case 19:case"end":return e.stop()}},e,s)})),function(e,t){return r.apply(this,arguments)}))},this.update=i(regeneratorRuntime.mark(function e(){var o=this,s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var r=i(regeneratorRuntime.mark(function e(t,r){var n,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o.isRunning?(r(),e.next=22):e.next=4;break;case 4:return a=s.qgs_layer_id,n=c(s,["qgs_layer_id"]),n=n.feature,a=o.getQgsLayerId({qgs_layer_id:a,noValue:o.dependencyApi.getEditableLayersId()}),e.next=9,o.findFeaturesWithGeometry({qgs_layer_id:a,feature:n,zoom:!0,highlight:!0,selected:1===a.length});case 9:if(i=e.sent,i.found)return e.next=14,o.startAction({toolboxes:[i.qgs_layer_id],resolve:t,reject:r});e.next=21;break;case 14:return a={feature:n,tools:o.config.tools.update,startstopediting:!1,action:"update"},e.next=17,o.startEditing([i.qgs_layer_id],a);case 17:u.default.isSidebarVisible()||u.default.showSidebar(),o.addSubscribeEvents("closeeditingpanel",{qgs_layer_id:[i.qgs_layer_id]}),e.next=22;break;case 21:r();case 22:case"end":return e.stop()}},e,o)}));return function(e,t){return r.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e,this)})),this.delete=function(){},this.startEditing=i(regeneratorRuntime.mark(function e(){var t,r,n,i,a=this,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=s.action,t=void 0===t?"add":t,r=s.feature,n={},s.filter=n,e.t0=t,e.next="add"===e.t0?6:"update"===e.t0?8:10;break;case 6:return n.nofeatures=!0,e.abrupt("break",10);case 8:return n.field=r.field+"|eq|"+r.value,e.abrupt("break",10);case 10:return i=[],o.forEach(function(e){i.push(a.dependencyApi.startEditing(e,s))}),e.next=14,Promise.allSettled(i);case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}},e,this)})),this.stopEditing=(r=i(regeneratorRuntime.mark(function e(t){var r,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],t.forEach(function(e){r.push(n.dependencyApi.stopEditing(e))}),e.next=4,Promise.allSettled(r);case 4:this.clear();case 5:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)}),this.stop=function(){var r=this;return new Promise(function(e,t){r.dependencyApi.hidePanel(),u.default.hideSidebar(),r.once("clear",e)})},this.clear=function(){this.dependencyApi.resetDefault(),this.isRunning=!1,this.responseObject={cb:null,qgs_layer_id:null,error:null},this.resetSubscribeEvents(),this.emit("clear")}}(0,e.inherit)(o,n),r.default=new o},{"core/iframe/services/plugins/service":17,"services/gui":361}],364:[function(s,e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=s("services/gui"),l=(r=r)&&r.__esModule?r:{default:r};function n(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var r=s("core/utils/utils"),d=r.splitContextAndMethod,p=r.uniqueId;t.default=new function(){var t,r,c=this;this.pendingactions={},this.init=n(regeneratorRuntime.mark(function e(){var t,r,n,i,a=this,o=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).project;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.default.isReady();case 2:this.services=s("core/iframe/services/index"),this.eventResponseServiceHandler=function(e){var t=e.action,e=e.response;a.postMessage({id:null,action:t,response:e})},t=o.state.layers.map(function(e){return{id:e.id,name:e.name}}),r=Object.keys(this.services),n=0;case 7:if(n<r.length)return void 0===(i=this.services[r[n]]).getLayers()&&i.setLayers(t),e.next=12,i.init();e.next=16;break;case 12:i.on("response",this.eventResponseServiceHandler);case 13:n++,e.next=7;break;case 16:this.postMessage({id:null,action:"app:ready",response:{result:!0,data:{layers:t}}}),window.addEventListener?window.addEventListener("message",this.getMessage,!1):window.attachEvent("onmessage",this.getMessage);case 18:case"end":return e.stop()}},e,this)})),this.outputDataPlace=(t=n(regeneratorRuntime.mark(function e(t){var r,n,i,a,o,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.action,r=void 0===r?"app:results":r,e.next=3,t;case 3:i=e.sent,n=i.result,i=i.data,i=void 0===i?[]:i,a=new ol.format.GeoJSON,o=[];try{o=i.map(function(e){var t,r=e.layer,e=e.features;return t={},r=r.getId(),e={features:a.writeFeatures(e)},r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t})}catch(e){}this.postMessage({id:null,action:r,response:{result:n,data:o}});case 11:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)}),this.postMessage=function(){window.parent&&window.parent.postMessage(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},"*")},this.stopPendingActions=n(regeneratorRuntime.mark(function e(){var r,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],Object.keys(this.pendingactions).forEach(function(e){var t=n.pendingactions[e].context;r.push(n.services[t].stop()),delete n.pendingactions[e]}),e.abrupt("return",Promise.allSettled(r));case 3:case"end":return e.stop()}},e,this)})),this.getMessage=(r=n(regeneratorRuntime.mark(function e(t){var r,n,i,a,o,s,l,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.data)if(a=t.data,r=a.id,r=void 0===r?p():r,n=a.single,n=void 0===n||n,i=a.action,a=a.data,s=d(i),o=s.context,s=s.method,l=!1,u=void 0,e.prev=5,c.services[o].getReady()){if(e.t0=n,e.t0)return e.next=11,c.stopPendingActions();e.next=11}else e.next=16;else e.next=24;break;case 11:return c.pendingactions[r]={context:o},e.next=14,c.services[o][s](a);case 14:u=e.sent,l=!0;case 16:e.next=22;break;case 18:e.prev=18,e.t1=e.catch(5),l=!1,u=e.t1;case 22:c.postMessage({id:r,action:i,response:{result:l,data:u}}),delete c.pendingactions[r];case 24:case"end":return e.stop()}},e,c,[[5,18]])})),function(e){return r.apply(this,arguments)}),this.clear=function(){for(var e=Object.keys(this.services),t=0;t<e.length;t++)this.services[e[t]].off("response",this.eventResponseServiceHandler);this.stopPendingActions(),window.removeEventListener?window.removeEventListener("message",this.getMessage,!1):window.detachEvent("onmessage",this.getMessage)}}},{"core/iframe/services/index":16,"core/utils/utils":68,"services/gui":361}],365:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("core/utils/utils"),i=n.base;function a(){this.state={items:{left:[],right:[]}},this.addItem=function(e){this.state.items[1<arguments.length&&void 0!==arguments[1]?arguments[1]:"right"].push(e)},i(this)}(0,n.inherit)(a,e("core/g3wobject")),r.default=new a},{"core/g3wobject":12,"core/utils/utils":68}],366:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=i(e("store/catalog-layers")),c=i(e("services/data")),s=i(e("store/projects")),l=i(e("services/application")),d=i(e("services/gui"));function i(e){return e&&e.__esModule?e:{default:e}}function a(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var u=e("core/i18n/i18n.service").t,e=e("core/utils/utils"),p=e.uniqueId,f=e.createFilterFromString,o=e.XHR,h="QUERYBUILDERSEARCHES";function g(){this._cacheValues={},this._items=l.default.getLocalItem(h)||{}}e=g.prototype;e.getCurrentProjectItems=function(){var e=s.default.getCurrentProject().getId();return this._items[e]=this._items[e]||[],this._items[e]},e.getItems=function(e){var t=l.default.getLocalItem(h);return e=e||s.default.getCurrentProject().getId(),t&&t[e]||[]},e._getLayerById=function(e){return n.default.getLayerById(e)},e.getValues=a(regeneratorRuntime.mark(function e(){var t,r,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=n.layerId,a=n.field;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._cacheValues[i]=this._cacheValues[i]||{},void 0===(t=this._cacheValues[i][a]))return e.prev=3,r=this._getLayerById(i),r=r.getUrl("data"),e.next=8,o.get({url:r,params:{ordering:a,unique:a}});e.next=18;break;case 8:return(r=e.sent).result&&(this._cacheValues[i][a]=this._cacheValues[i][a]||r.data),e.abrupt("return",this._cacheValues[i][a]||[]);case 13:e.prev=13,e.t0=e.catch(3),reject();case 16:e.next=19;break;case 18:return e.abrupt("return",t);case 19:case"end":return e.stop()}},e,this,[[3,13]])})),e.run=function(){var r,o=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},s=e.layerId,l=e.filter,e=e.showResult,u=void 0===e||e;return new Promise((r=a(regeneratorRuntime.mark(function e(t,r){var n,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=o._getLayerById(s),n=i.getSearchEndPoint(),a=f({layer:i,search_endpoint:n,filter:l}),e.prev=3,e.next=6,c.default.getData("search:features",{inputs:{layer:i,filter:a,search_endpoint:n,feature_count:100},outputs:u});case 6:i=e.sent,a=i.data,t(a),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(3),d.default.showUserMessage({type:"alert",message:"sdk.querybuilder.error_run",autoclose:!0}),r(e.t0);case 15:case"end":return e.stop()}},e,o,[[3,11]])})),function(e,t){return r.apply(this,arguments)}))},e.test=a(regeneratorRuntime.mark(function e(){var t,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=r.layerId,i=r.filter;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.run({layerId:n,filter:i,showResult:!1});case 3:return t=e.sent,e.abrupt("return",t.length&&t[0].features.length);case 7:return e.prev=7,e.t0=e.catch(0),e.t0=u("sdk.querybuilder.error_test"),e.abrupt("return",Promise.reject(e.t0));case 11:case"end":return e.stop()}},e,this,[[0,7]])})),e.delete=function(){var a=this,o=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).id;return new Promise(function(n,i){d.default.dialog.confirm(u("sdk.querybuilder.delete"),function(e){var t,r;(e?(e=a.getItems().filter(function(e){return e.id!==o}),t=s.default.getCurrentProject().getId(),r=l.default.getLocalItem(h),e.length?r[t]=e:delete r[t],Object.keys(r).length?l.default.setLocalItem({id:h,data:r}):l.default.removeLocalItem(h),n):i)()})})},e.editLocalItem=function(r,n){r=r||s.default.getCurrentProject().getId();var i=l.default.getLocalItem(h);i[r].find(function(e,t){if(e.id===n.id)return i[r][t]=n,!0}),l.default.setLocalItem({id:h,data:i}),this._resetItems(r,i[r])},e._resetItems=function(t,e){var r=this;setTimeout(function(){e.forEach(function(e){return r._items[t].push(e)})},0),this._items[t].splice(0)},e.addLocalItem=function(e,t){t.id=p(),e=e||s.default.getCurrentProject().getId();var r,n,i,a,o=l.default.getLocalItem(h);void 0===o?(l.default.setLocalItem({id:h,data:(a=r=[t],(i=e)in(n={})?Object.defineProperty(n,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[i]=a,n)}),this._resetItems(e,r)):(o[e]=o[e]?[].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(o[e]),[t]):[t],l.default.setLocalItem({id:h,data:o}),this._resetItems(e,o[e]))},e.save=function(){var r=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,n=e.name,i=e.layerId,a=e.filter,o=e.projectId,s={layerId:i,filter:a,layerName:this._getLayerById(i).getName()};t?(s.name=n,s.id=t,this.editLocalItem(o,s),d.default.showUserMessage({type:"success",message:u("sdk.querybuilder.messages.changed"),autoclose:!0})):d.default.dialog.prompt(u("sdk.querybuilder.additem"),function(e){var t;e&&(t=d.default.getComponent("search").getService(),s.name=e,t.addQueryBuilderSearch(s),r.addLocalItem(o,s),d.default.showUserMessage({type:"success",message:u("sdk.querybuilder.messages.changed"),autoclose:!0}))})},e.all=function(){},e.sample=function(){},e.clear=function(){this._cacheValues={}},e.add=function(){},r.default=new g},{"core/i18n/i18n.service":13,"core/utils/utils":68,"services/application":351,"services/data":358,"services/gui":361,"store/catalog-layers":374,"store/projects":379}],367:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var u=n(e("store/catalog-layers")),d=n(e("store/projects")),c=n(e("services/data"));function n(e){return e&&e.__esModule?e:{default:e}}var i=e("core/utils/utils"),a=i.inherit,o=i.XHR,s=i.base,p=i.createSingleFieldParameter,i=e("core/utils/geo"),f=i.sanitizeFidFeature,h=i.getAlphanumericPropertiesFromFeature;function l(){s(this)}a(l,e("core/g3wobject"));var g,i=l.prototype;i.createUrl=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=d.default.getCurrentProject(),r=e.layer,r=void 0===r?{}:r,n=e.relation,n=void 0===n?{}:n,i=e.fid,a=e.type,a=void 0===a?"data":a,e=e.formatter,e=void 0===e?1:e,o=void 0,s=n.father,l=n.child,u=n.referencedLayer,c=n.referencingLayer,n=n.id,o=void 0!==s?r.id===s?l:s:r.id===u?c:u;return t.getLayerById(o).getUrl(a)+"?relationonetomany="+n+"|"+f(i)+"&formatter="+e},i.getRelations=function(){var e=this.createUrl(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{});return o.get({url:e})},i.getRelationsNM=(g=regeneratorRuntime.mark(function e(){var t,r,n,i,a,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},s=o.nmRelation,o=o.features,l=void 0===o?[]:o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=s.referencedLayer,s.referencingLayer,r=s.fieldRef,t=r.referencingField,r=r.referencedField,n=[],l.length)return i=l.map(function(e){return e.attributes[t]}),e.next=6,c.default.getData("search:features",{inputs:{layer:u.default.getLayerById(a),filter:""+p({field:r,value:i,logicop:"OR"}),formatter:1,search_endpoint:"api"},outputs:null});e.next=8;break;case 6:(a=e.sent).data&&a.data[0]&&Array.isArray(a.data[0].features)&&(n=a.data[0].features.map(function(r){var e=h(r.getProperties()).reduce(function(e,t){return e[t]=r.get(t),e},{});return{id:r.getId(),attributes:e,geometry:r.getGeometry()}}));case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}},e,this)}),function(){var s=g.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}),i.save=function(){var e=this.createUrl(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{});return o.fileDownload({url:e,httpMethod:"GET"})},r.default=new l},{"core/g3wobject":12,"core/utils/geo":64,"core/utils/utils":68,"services/data":358,"store/catalog-layers":374,"store/projects":379}],368:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});function n(){this._initialLocationQuery,this._routeQuery="",this.setters={setRouteQuery:function(e){this._routeQuery=e,crossroads.parse(e)}},a(this)}var i=e("core/utils/utils"),a=i.base,o=i.inherit,i=(i.Base64,e("core/g3wobject")),e=(crossroads.ignoreState=!0,crossroads.greedy=!0,o(n,i),n.prototype);e.init=function(){var e=window.location.search;this._setRouteQueryFromLocationQuery(e)},e.addRoute=function(e,t,r){return crossroads.addRoute(e,t,r)},e.removeRoute=function(e){return crossroads.removeRoute(e)},e.removeAllRoutes=function(){return crossroads.removeAllRoutes()},e.parse=function(e,t){return crossroads.parse(e,t)},e.goto=function(e){this._initialQuery||(this._initialLocationQuery=this._stripInitialQuery(location.search.substring(1))),e&&this.setRouteQuery(e)},e.makePermalink=function(e){this._initialQuery||(this._initialLocationQuery=this._stripInitialQuery(location.search.substring(1)));this._encodeRouteQuery(e);return"?"+this._initialLocationQuery+"&q="+this._encodeRouteQuery(e)},e.makeQueryString=function(e){},e.slicePath=function(e){return e.split("?")[0].split("/")},e.sliceFirst=function(e){var t=e.split("?"),r=t[1],t=t[0].split("/");return[t[0],e=[e=t.slice(1).join("/"),r].join("?")]},e.getQueryParams=function(e){e=e.replace("?","");var r={},t=[],t=""!=e&&-1==e.indexOf("&")?[e]:e.split("&");try{_.forEach(t,function(e){var e=e.split("="),t=e[0],e=e[1];r[t]=e})}catch(e){}return r},e.getQueryString=function(e){return e.split("?")[1]},e._getQueryPortion=function(e,t){var r;try{var n=e.split("&");_.forEach(n,function(e){e.split("=")[0]==t&&(r=e)})}catch(e){}return r},e._encodeRouteQuery=function(e){return e=(e=(e=e.replace("?","@")).replace("&","|")).replace("=","!")},e._decodeRouteQuery=function(e){return e=(e=(e=e.replace("@","?")).replace("|","&")).replace("!","=")},e._setRouteQueryFromLocationQuery=function(e){var e=this._getRouteQueryFromLocationQuery(e);e&&(e=this._decodeRouteQuery(e),this.setRouteQuery(e))},e._getRouteQueryFromLocationQuery=function(e){return this.getQueryParams(e).q},e._stripInitialQuery=function(e){var t,r=this._getQueryPortion(e,"q");return r&&(t=r.length,r=e.indexOf(r),queryPrefix=_.trimEnd(e.substring(0,r),"&"),querySuffix=e.substring(r+t),querySuffix=""!=queryPrefix?querySuffix:_.trimStart(querySuffix,"&"),e=queryPrefix+querySuffix),e},r.default=new n},{"core/g3wobject":12,"core/utils/utils":68}],369:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n=e("components/SidebarItem.vue"),n=(n=n)&&n.__esModule?n:{default:n};var i=e("core/utils/utils"),o=i.base,i=i.inherit,s=e("gui/utils/utils").barstack,e=e("core/g3wobject"),l=Vue.extend(n.default);function u(){this.stack=new s,this.setters={closeSidebarPanel:function(){},openCloseItem:function(e){}},this.state={components:[],gui:{title:""},disabled:!1},this.init=function(e){this.layout=e},this.addComponents=function(e){var t=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return e.forEach(function(e){return t.addComponent(e,r)}),!0},this.addComponent=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=t.position,n=t.before,i=void 0===n||n,n=t.info;if(isMobile.any&&!e.mobile)return!1;var t=new l({service:this,info:n,component:e}),a=(t.title=e.title||t.title,t.info=e.info||t.info,t.actions=e.actions||t.actions,t.open=e.state.open,t.icon=e.icon||t.icon,t.iconColor=e.iconColor,t.state=e.state||!0,t.collapsible="boolean"!=typeof e.collapsible||e.collapsible,t.isolate="boolean"==typeof e.isolate&&e.isolate,t.$mount().$el);this.state.components.push(e);var n="#g3w-sidebarcomponents"+($(".g3w-sidebarpanel").is(":visible")?":hidden":""),t=$(n).children().filter(function(){return"none"!==this.style.display}),o=t.length;return null==r||r<0||o<=r?$(n).append(a):t.each(function(e,t){(Number.isInteger(r)?r===e:t.id===r)&&$(a)["insert"+(i?"Before":"After")](t)}),e.mount("#g3w-sidebarcomponent-placeholder"),e.initService&&e.initService(),this.setComponentClickHandler(e),!0},this.setComponentClickHandler=function(t){t.click=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).open,e=void 0!==e&&e||!1;$(t.getInternalComponent().$el).siblings("a").click(),t.setOpen(e)}},this.getComponent=function(t){return this.state.components.find(function(e){return e.getId()===t})},this.getComponents=function(){return this.state.components},this.closeOpenComponents=function(){this.getComponents().forEach(function(e){return e.closeWhenViewportContentIsOpen()&&e.collapsible&&e.click({open:!1})})},this.reloadComponent=function(e){e=this.getComponent(e);e&&e.reload()},this.reloadComponents=function(){this.closePanel(),this.state.components.forEach(function(e){e.collapsible&&e.state.open&&e.click({open:!1}),e.reload()})},this.removeComponent=function(r){var n=this,i=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).position;this.state.components.forEach(function(e,t){if(r===e)return r.unmount(),n.state.components.splice(t,1),(void 0!==i&&Number.isInteger(i)?$("#g3w-sidebarcomponents").children(":visible")[i]:$("#g3w-sidebarcomponents").children("#"+r.id)).remove(),!1})},this.showPanel=function(r){var n=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(t,e){n.state.gui.title=r.title;n.stack.getCurrentContentData()&&$(n.stack.getCurrentContentData().content.internalPanel.$el).hide(),n.stack.push(r,a({parent:"#g3w-sidebarpanel-placeholder"},i)).then(function(e){return t(e)})})},this.closePanel=function(){var t=this;this.closeSidebarPanel(),this.stack.pop().then(function(e){t.stack.getCurrentContentData()&&($(t.stack.getCurrentContentData().content.internalPanel.$el).show(),t.state.gui.title=t.stack.getCurrentContentData().content.title)})},this.closeAllPanels=function(){this.state.gui.title=null,this.closeSidebarPanel(),this.stack.clear()},o(this)}i(u,e),r.default=new u},{"components/SidebarItem.vue":295,"core/g3wobject":12,"core/utils/utils":68,"gui/utils/utils":188}],370:[function(e,t,r){function h(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var g=e("core/utils/utils").XHR;r.default=new function(){var f=[];this.runTask=h(regeneratorRuntime.mark(function e(){var t,r,n,i,a,o,s,l,u,c,d=this,p=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(c=p.method,c=void 0===c?"GET":c,t=p.params,t=void 0===t?{}:t,r=p.url,n=p.taskUrl,l=p.interval,i=void 0===l?1e3:l,l=p.timeout,a=void 0===l?1/0:l,l=p.listener,o=void 0===l?function(){}:l,e.prev=1,"GET"===c)return e.next=5,g.get({url:r,params:t});e.next=8;break;case 5:e.t0=e.sent,e.next=11;break;case 8:return e.next=10,g.post({url:r,data:t.data||{},contentType:t.contentType||"application/json"});case 10:e.t0=e.sent;case 11:s=e.t0,l=s.result,u=s.task_id,l?(c=setInterval(h(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0<(a-=i))return t=void 0,e.prev=3,e.next=6,g.get({url:""+n+u});e.next=15;break;case 6:t=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),t=e.t0;case 12:o({task_id:u,timeout:!1,response:t}),e.next=17;break;case 15:o({timeout:!0}),d.stopTask({task_id:u});case 17:case"end":return e.stop()}},e,d,[[3,9]])})),i),f.push({task_id:u,intervalId:c}),o({task_id:u,response:s}),e.next=20):e.next=19;break;case 19:return e.abrupt("return",Promise.reject(s));case 20:e.next=25;break;case 22:return e.prev=22,e.t1=e.catch(1),e.abrupt("return",Promise.reject(e.t1));case 25:case"end":return e.stop()}},e,this,[[1,22]])})),this.stopTask=function(){var t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).task_id,e=f.find(function(e){return e.task_id===t});e&&clearInterval(e.intervalId)},this.clear=function(){var t=this;f.forEach(function(e){e=e.taskId;t.stopTask({taskId:e})}),f.splice(0)}}},{"core/utils/utils":68}],371:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},n=a(e("store/application-state")),i=e("app/constant"),s=a(e("services/gui"));function a(e){return e&&e.__esModule?e:{default:e}}function l(){this.state={primaryView:"map",secondaryPerc:0,resized:{start:!1,h:!1,v:!1},split:"h",map:{sizes:{width:0,height:0},aside:!1},content:{loading:!1,disabled:!1,sizes:{width:0,height:0},resize:{h:{perc:0},v:{perc:0}},aside:!0,showgoback:!0,stack:[],closable:!0,backonclose:!1,contentsdata:[]},usermessage:{id:null,show:!1,title:null,message:null,position:null,type:null,draggable:null,cloasable:null,autoclose:null,textMessage:!1,hooks:{header:null,body:null,footer:null}}},this._components={map:null,content:null},this._defaultMapComponent,this._contextualMapComponent,this._secondaryViewMinWidth=i.VIEWPORT.resize.content.min,this._secondaryViewMinHeight=i.VIEWPORT.resize.content.min,this._immediateComponentsLayout=!0,this.init=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.primaryview,r=e.split,r=void 0===r?"h":r,e=e.components;this.state.primaryView=void 0===t?"map":t,this.state.split=r,this._addComponents(e)},this.setResized=function(e){this.state.resized[e]=1<arguments.length&&void 0!==arguments[1]&&arguments[1]},this.showUserMessage=function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.title,n=t.subtitle,i=t.message,a=t.type,o=t.position,s=t.size,l=t.draggable,u=t.duration,c=t.textMessage,d=void 0!==c&&c,p=t.closable,f=t.autoclose,c=t.hooks,h=void 0===c?{}:c;return this.closeUserMessage(),setTimeout(function(){e.state.usermessage.id=g(),e.state.usermessage.show=!0,e.state.usermessage.message=i,e.state.usermessage.textMessage=d,e.state.usermessage.title=r,e.state.usermessage.subtitle=n,e.state.usermessage.position=o,e.state.usermessage.duration=u,e.state.usermessage.type=a,e.state.usermessage.show=!0,e.state.usermessage.size=s,e.state.usermessage.autoclose=f,e.state.usermessage.closable=p,e.state.usermessage.draggable=l,e.state.usermessage.hooks.header=h.header,e.state.usermessage.hooks.body=h.body,e.state.usermessage.hooks.footer=h.footer}),this.state.usermessage},this.closeUserMessage=function(){this.state.usermessage.id=null,this.state.usermessage.show=!1,this.state.usermessage.textMessage=!1,this.state.usermessage.message=""},this.getState=function(){return this.state},this.getMapState=function(){return this.state.map},this.getContentState=function(){return this.state.content},this.setLoadingContent=function(){this.state.content.loading=0<arguments.length&&void 0!==arguments[0]&&arguments[0]},this._addComponents=function(e){var n=this;Object.entries(e).forEach(function(e){var e=o(e,2),t=e[0],r=e[1];-1<Object.keys(n._components).indexOf(t)&&r.mount("#g3w-view-"+t,!0).then(function(){n._components[t]=r,"map"===t&&(n._defaultMapComponent=r)}).fail(function(e){})})},this.showMap=function(){this._toggleMapComponentVisibility(this._defaultMapComponent,!0),this._components.map=this._defaultMapComponent,this._showView("map")},this.showContextualMap=function(){var e,t=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._contextualMapComponent||(this._contextualMapComponent=this._defaultMapComponent),this._contextualMapComponent!=this._defaultMapComponent&&this._toggleMapComponentVisibility(this._defaultMapComponent,!1),this._contextualMapComponent.ismount()?(this._components.map=this._contextualMapComponent,this._toggleMapComponentVisibility(this._contextualMapComponent,!0)):(e=this._contextualMapComponent).mount("#g3w-view-map",!0).then(function(){return t._components.map=e}),this._showView("map",r)},this.recoverDefaultMap=function(){return this._components.map!==this._defaultMapComponent&&(this._components.map=this._defaultMapComponent,this._toggleMapComponentVisibility(this._contextualMapComponent,!1),this._toggleMapComponentVisibility(this._defaultMapComponent,!0)),this._components.map},this.setContextualMapComponent=function(e){e!==this._defaultMapComponent&&(this._contextualMapComponent&&this._contextualMapComponent.unmount(),this._contextualMapComponent=e)},this.resetContextualMapComponent=function(){this._contextualMapComponent&&this._contextualMapComponent.unmount(),this._contextualMapComponent=this._defaultMapComponent},this._toggleMapComponentVisibility=function(e,t){e.internalComponent.$el.style.display=t?"block":"none"},this.closeMap=function(){this.state.secondaryPerc="map"===this.state.primaryView?100:0,this.recoverDefaultMap(),this._layout()},this.showContent=function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=(t.perc=void 0!==t.perc?t.perc:this.getContentPercentageFromCurrentLayout(),t.push=t.push||!1,100===t.perc?"show-content-full":"show-content");this._prepareContentView(t),this._immediateComponentsLayout=!1,this._showView("content",t),this._components.content.setContent(t).then(function(){e._immediateComponentsLayout=!0,e._layoutComponents(r)})},this.hideContent=function(e){var t=this.getContentPercentageFromCurrentLayout(this.state.split);return this.state.secondaryVisible=!e,this._layout("hide-content"),t},this.resetToDefaultContentPercentage=function(){var e=this.getCurrentContentLayout();e["h"===this.state.split?"width":"height"]=e[("h"===this.state.split?"width":"height")+"_default"],e[("h"===this.state.split?"width":"height")+"_100"]=!1,this._layoutComponents()},this.toggleFullViewContent=function(){n.default.gui.layout[n.default.gui.layout.__current].rightpanel[("h"===this.state.split?"width":"height")+"_100"]=!n.default.gui.layout[n.default.gui.layout.__current].rightpanel[("h"===this.state.split?"width":"height")+"_100"],this._layoutComponents()},this.isFullViewContent=function(){return n.default.gui.layout[n.default.gui.layout.__current].rightpanel[("h"===this.state.split?"width":"height")+"_100"]},this.contentLength=function(){return this.state.content.contentsdata.length},this.popContent=function(){var e,t=this,r=$.Deferred();return this.state.content.contentsdata.length?(this.recoverDefaultMap(),e=this._components.content.getPreviousContentData(),this._prepareContentView(e.options),this._immediateComponentsLayout=!1,this._showView("content",e.options),this._components.content.popContent().then(function(){t.state.secondaryPerc=e.options.perc,t._immediateComponentsLayout=!0,t._layout("pop-content"),r.resolve(t._components.contentgetCurrentContentData)})):r.reject(),r.promise()},this.getCurrentContent=function(){return this.contentLength()?this.state.content.contentsdata[this.contentLength()-1]:null},this.getCurrentContentTitle=function(){var e=this.getCurrentContent();return e&&e.options.title},this.getCurrentContentId=function(){var e=this.getCurrentContent();return e&&e.options.id},this.changeCurrentContentOptions=function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=this.getCurrentContent();r&&(e=t.title,t=t.crumb,e&&(r.options.title=e),t)&&(r.options.crumb=t)},this.changeCurrentContentTitle=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=this.getCurrentContent();t&&(t.options.title=e)},this.isContentOpen=function(){return!!this.state.content.contentsdata.length},this.closeContent=function(){var e,t=this,r=$.Deferred();return this.isContentOpen()?(this._components.content.removeContent(),this.closeSecondaryView("close-content").then(function(){var e=t.recoverDefaultMap();r.resolve(e)})):(e=this.recoverDefaultMap(),r.resolve(e)),r.promise()},this.disableContent=function(e){this.state.content.disabled=e},this.removeContent=function(){if(!(this.state.content.backonclose&&1<this.state.content.contentsdata.length))return this.closeContent();this.popContent()},this.isPrimaryView=function(e){return this.state.primaryView==e},this.setPrimaryView=function(e){this.state.primaryView!==e&&(this.state.primaryView=e),this._layout()},this.showPrimaryView=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;e&&this.state.secondaryVisible&&100===this.state.secondaryPerc&&(this.state.secondaryPerc=100-e,this._layout())},this.showSecondaryView=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.state.split,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.state.perc;this.state.secondaryVisible=!0,this.state.split=e,this.state.secondaryPerc=t,this._layout()},this.closeSecondaryView=function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,r=$.Deferred(),n=this._components[this._otherView(this.state.primaryView)];return n.clearContents?n.clearContents().then(function(){e.state.secondaryVisible=!1,e.state.secondaryPerc=0,e._layout(t),Vue.nextTick(function(){return r.resolve()})}):(this.state.secondaryVisible=!1,this._layout(t),Vue.nextTick(function(){return r.resolve()})),r.promise()},this.getDefaultViewPerc=function(e){return this.isPrimaryView(e)?100:50},this._otherView=function(e){return"map"===e?"content":"map"},this._isSecondary=function(e){return this.state.primaryView!==e},this._setPrimaryView=function(e){this.state.primaryView!==e&&(this.state.primaryView=e)},this._prepareContentView=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.title,r=e.split,r=void 0===r?null:r,n=e.closable,n=void 0===n||n,i=e.backonclose,i=void 0===i||i,a=e.style,a=void 0===a?{}:a,o=e.showgoback,o=void 0===o||o,e=e.headertools,e=void 0===e?[]:e;this.state.content.title=t,this.state.content.split=r,this.state.content.closable=n,this.state.content.backonclose=i,this.state.content.contentsdata=this._components.content.contentsdata,this.state.content.style=a,this.state.content.headertools=e,this.state.content.showgoback=o},this._showView=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=t.perc,r=void 0===r?this.getDefaultViewPerc(e):r,n=t.split,n=void 0===n?"h":n,i=void 0,i=!this.isPrimaryView(e)||void 0!==t.aside&&t.aside,t=(this.state[e].aside=i,this.isPrimaryView(e)?100-r:r);if(!(0<t))return this.closeSecondaryView();this.showSecondaryView(n,t)},this._getReducedSizes=function(){var e,t=$(".content"),r=0,n=$(".sidebar-aside-toggle");return t&&this.state.secondaryVisible&&this.isFullViewContent()?n&&n.is(":visible")&&(e=n.outerWidth(),t.css("padding-left",e+5),r=e-5):(e=n.outerWidth(),t.css("padding-left",100===this.state.secondaryPerc?e+5:15)),{reducedWidth:r,reducedHeight:0}},this._layout=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=this._getReducedSizes();this._setViewSizes(t.reducedWidth,t.reducedHeight),this._immediateComponentsLayout&&this._layoutComponents(e)},this._setViewSizes=function(){var e=this.state.primaryView,t=this._otherView(e),r=this.getViewportSize(),n=r.width,r=r.height,i=void 0,a=void 0,o=void 0,s=void 0,l=(100===this.state.secondaryPerc||this.isFullViewContent()?100:this.getContentPercentageFromCurrentLayout(this.state.split))/100,a="h"===this.state.split?(i=n-(o=this.state.secondaryVisible?Math.max(n*l,this._secondaryViewMinWidth):0),s=r):(o=n,s=this.state.secondaryVisible?Math.max(r*l,this._secondaryViewMinHeight):0,i=this.state.secondaryVisible&&1==l?0:n,r-s);this.state[e].sizes.width=i,this.state[e].sizes.height=a,this.state[t].sizes.width=o,this.state[t].sizes.height=s},this.getViewportSize=function(){return{width:this._viewportWidth(),height:this._viewportHeight()}},this._viewportHeight=function(){var e=$(".navbar-header").innerHeight();return $(document).innerHeight()-e},this._viewportWidth=function(){var e=$(".main-sidebar"),t=e.length&&e.offset().left,e=(e.length&&e[0].getBoundingClientRect().width)+t;return $("#app")[0].getBoundingClientRect().width-e},this.resizeViewComponents=function(e){var t=arguments[2];this.setResized(e,!0),this.setContentPercentageFromCurrentLayout(e,t),this._layout("resize")},this.setContentPercentageFromCurrentLayout=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.state.split,t=arguments[1];this.getCurrentContentLayout()["h"===e?"width":"height"]=t},this.getContentPercentageFromCurrentLayout=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.state.split;return this.getCurrentContentLayout()["h"===e?"width":"height"]},this.getCurrentContentLayout=function(){return n.default.gui.layout[n.default.gui.layout.__current].rightpanel},this._layoutComponents=function(){var a=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;requestAnimationFrame(function(){var e=a._getReducedSizes(),n=e.reducedWidth||0,i=e.reducedHeight||0;a._setViewSizes(),Object.entries(a._components).forEach(function(e){var e=o(e,2),t=e[0],e=e[1],r=a.state[t].sizes.width-n,t=a.state[t].sizes.height-i;e.layout(r,t)}),t&&setTimeout(function(){a.emit(t),s.default.emit(t)})})},this._firstLayout=function(){var t=this,r=!1,n=!1;function i(){n=!0,e()}var e=function e(){!0===n?(r=!(n=!1),t._layout("resize"),requestAnimationFrame(e)):r=!1};s.default.on("ready",function(){t.SIDEBARWIDTH=s.default.getSize({element:"sidebar",what:"width"}),t._layout(),s.default.on("guiresized",i),$(window).resize(function(){!1===r&&i()}),$(".main-sidebar").on("webkitTransitionEnd transitionend msTransitionEnd oTransitionEnd",function(e){e.target===this&&($(this).trigger("trans-end"),i())})})},this._firstLayout(),c(this)}var u=e("core/utils/utils"),c=u.base,d=u.inherit,g=u.uniqueId;d(l,e("core/g3wobject")),r.default=new l},{"app/constant":4,"core/g3wobject":12,"core/utils/utils":68,"services/gui":361,"store/application-state":373}],372:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});r.default=new function(){this._workflows=[],this.push=function(e){return-1===this._workflows.indexOf(e)?this._workflows.push(e)-1:this._workflows.indexOf(e)},this.getParent=function(){var e=this._getCurrentIndex();return 0<e&&this._workflows[e-1]},this.getParents=function(){var e=this._getCurrentIndex();return 0<e&&this._workflows.slice(0,e)},this.pop=function(){return this._workflows.pop()},this.getLength=function(){return this._workflows.length},this._getCurrentIndex=function(){var t=this.getCurrent();return this._workflows.findIndex(function(e){return e===t})},this.getCurrent=function(){return this.getLast()},this.getLast=function(){var e=this._workflows.length;return e?this._workflows[e-1]:null},this.getFirst=function(){return this._workflows[0]},this.removeAt=function(e){this._workflows.splice(e,1)},this.getAt=function(e){return this._workflows[e]},this.insertAt=function(e,t){this._workflows[e]=t},this.clear=function(){for(;this._workflows.length;)this.pop().stop()}}},{}],373:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=Vue.observable({ready:!1,iframe:!1,online:!1,ismobile:!1,download:!1,upload:!1,baseLayerId:null,language:"en",lng:"en",changeProjectview:!1,plugins:[],user:null,map:{epsg:"",unit:"metric"},gui:{app:{disabled:!1},sidebar:{disabled:!1},layout:{__current:"app",app:{}}},keys:{vendorkeys:{google:void 0,bing:void 0}},tokens:{filtertoken:void 0}});r.STATE_METHODS={};r.default=n},{}],374:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("core/utils/utils"),i=n.base;function a(){i(this)}(0,n.inherit)(a,e("core/layers/layersstoresregistry")),r.default=new a},{"core/layers/layersstoresregistry":37,"core/utils/utils":68}],375:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("core/g3wobject"),e=e("core/utils/utils"),i=e.base;function a(){this.components={},this.registerComponent=function(e){var t=e.getId();this.components[t]||(this.components[t]=e,this.emit("componentregistered",e))},this.getComponent=function(e){return this.components[e]},this.getComponents=function(){return this.components},this.unregisterComponent=function(e){var t=this.components[e];return t&&("function"==typeof t.destroy&&t.destroy(),this.components[e]=null),t},i(this)}(0,e.inherit)(a,n),r.default=new a},{"core/g3wobject":12,"core/utils/utils":68}],376:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=n(e("services/application")),a=n(e("services/gui")),o=e("g3w-ol/constants");function n(e){return e&&e.__esModule?e:{default:e}}var s=e("core/utils/utils"),l=s.base;function u(){var n=this;this._controls={},this._offlineids=[],this.selectedLayer=null,this.externalLayers=[],i.default.on("complete",function(){var e=a.default.getService("catalog"),r={};e.onafter("addExternalLayer",function(e){var t=e.layer;"vector"===e.type&&(n.externalLayers.push(t),r[t.name]=[o.VM.$watch(function(){return t.selected},function(e){n.setSelectedLayer(!0===e?t:null)})],n.callControlsEventHandler({handler:"onAddExternalLayer",param:{layer:t,unWatches:r[t.name]}}))}),e.onafter("removeExternalLayer",function(e){var t=e.name;"vector"===e.type&&(n.externalLayers=n.externalLayers.filter(function(e){return t===e.name&&n.callControlsEventHandler({handler:"handleRemoveExternalLayer",param:e}),t===e.name&&e===n.selectedLayer&&n.setSelectedLayer(null),t!==e.name}),r[t].forEach(function(e){return e()}),delete r[t])})}),i.default.onbefore("offline",function(){n._offlineids.forEach(function(e){var t=n._controls[e.id];e.enable=t.getEnable(),t.setEnable(!1)})}),i.default.onbefore("online",function(){n._offlineids.forEach(function(e){n._controls[e.id].setEnable(e.enable)})}),this.setters={registerControl:function(e,t){this._registerControl(e,t)}},this.setSelectedLayer=function(e){this.selectedLayer=e},this.getSelectedLayer=function(){return this.selectedLayer},this.getExternalLayers=function(){return this.externalLayers},this.catalogSelectedLayer=function(e){this.setSelectedLayer(e.isSelected()?e:null),this.callControlsEventHandler({handler:"onSelectLayer",param:this.selectedLayer})},this.callControlsEventHandler=function(e){var t=e.handler,r=e.param;Object.values(this._controls).forEach(function(e){"function"==typeof e[t]&&e[t](r)})},this._registerControl=function(e,t){!1===(this._controls[e]=t).offline&&(this._offlineids.push({id:e,enable:t.getEnable()}),t.getEnable())&&t.setEnable(i.default.isOnline())},this.getControl=function(e){return this._controls[e]},this.getControls=function(){return this._controls},this.unregisterControl=function(t){var e=this.getControl(t);return!!e&&(a.default.getService("map").getMap().removeControl(e),delete this._controls[t],this._offlineids=this._offlineids.filter(function(e){return e!==t}),!0)},l(this)}(0,s.inherit)(u,e("core/g3wobject")),r.default=new u},{"core/g3wobject":12,"core/utils/utils":68,"g3w-ol/constants":75,"services/application":351,"services/gui":361}],377:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("core/utils/utils"),i=n.inherit,a=n.base;function o(){a(this)}i(o,e("core/layers/layersstoresregistry")),r.default=new o},{"core/layers/layersstoresregistry":37,"core/utils/utils":68}],378:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],i=!0,t=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!r||n.length!==r);i=!0);}catch(e){t=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(t)throw a}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},a=s(e("store/projects")),o=s(e("services/application"));function s(e){return e&&e.__esModule?e:{default:e}}function d(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,o){return function t(e,r){try{var n=s[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});a(i)}("next")})}}var l=e("core/utils/utils"),u=l.base,l=l.inherit,e=e("core/g3wobject"),c=["law"];function p(){var t=this;this.config=null,this._plugins={},this._configurationPlugins=[],this.pluginsConfigs={},this._loadedPluginUrls=[],this.setters={registerPlugin:function(e){this._plugins[e.name]||(this._plugins[e.name]=e)}},a.default.onafter("setCurrentProject",function(e){t.gidProject=e.getGid()}),u(this),this.init=function(){var r,i=this,a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return new Promise((r=d(regeneratorRuntime.mark(function e(t,r){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i.pluginsBaseUrl=a.pluginsBaseUrl,i.setPluginsConfig(a.pluginsConfigs),Object.keys(i.pluginsConfigs).forEach(function(e){return i._configurationPlugins.push(e)}),i.addLoadingPlugins(),i.otherPluginsConfig=a.otherPluginsConfig,i.setOtherPlugins(),i.setDependencyPluginConfig(),e.prev=7,e.next=10,i._loadPlugins();case 10:n=e.sent,t(n),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(7),r(e.t0);case 17:case"end":return e.stop()}},e,i,[[7,14]])})),function(e,t){return r.apply(this,arguments)}))},this.addLoadingPlugins=function(){Object.keys(this.pluginsConfigs).forEach(function(e){return o.default.loadingPlugin(e)})},this.removeLoadingPlugin=function(e,t){o.default.loadedPlugin(e,t)},this._loadPlugins=function(){var r=this,e=Object.entries(this.pluginsConfigs).map(function(e){var e=i(e,2),t=e[0],e=e[1];return r._setup(t,e)});return Promise.allSettled(e)},this.setDependencyPluginConfig=function(){var e,r=this;for(e in this.pluginsConfigs)!function(e){var t=r.pluginsConfigs[e].plugins;t&&Object.keys(t).forEach(function(e){r.pluginsConfigs[e]=n({},r.pluginsConfigs[e],t[e])})}(e)},this.setOtherPlugins=function(){var e=c[0];this.otherPluginsConfig&&this.otherPluginsConfig[e]&&this.otherPluginsConfig[e].length?(this.pluginsConfigs[e]=this.otherPluginsConfig[e],this.pluginsConfigs[e].gid=this.otherPluginsConfig.gid):delete this.pluginsConfigs[e]},this.reloadPlugins=function(l,u){var r,c=this;return new Promise((r=d(regeneratorRuntime.mark(function e(t,r){var i,a,n,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(o in i=$("script"),a=c.getPlugins(),n=function(n){a[n].unload(),delete c._plugins[n],i.each(function(e,r){c._loadedPluginUrls.forEach(function(e,t){if(r.getAttribute("src")===e&&-1!==e.indexOf(n))return r.parentNode.removeChild(r),c._loadedPluginUrls.splice(t,1),!1})})},a)n(o);return c._loadedPluginUrls=[],c.otherPluginsConfig=u.getState(),c.setPluginsConfig(l.group.plugins),c.addLoadingPlugins(),c.setOtherPlugins(),e.prev=9,e.next=12,c._loadPlugins();case 12:s=e.sent,t(s),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(9),r(e.t0);case 19:case"end":return e.stop()}},e,c,[[9,16]])})),function(e,t){return r.apply(this,arguments)}))},this.setPluginsConfig=function(){var t=this,r={};Object.entries(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).filter(function(e){return i(e,2)[1].gid===t.gidProject}).forEach(function(e){var e=i(e,2),t=e[0],e=e[1];return r[t]=e}),this.pluginsConfigs=r},this._loadScript=function(e){return $.getScript(e)},this._setup=function(p,f){var r,h=this;return new Promise((r=d(regeneratorRuntime.mark(function e(t,r){var n,i,a,o,s,l,u,c,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(_.isNull(f))e.next=38;else{for(c=f.jsscripts,c=void 0===c?[]:c,n=[],i=function(r){n.push(new Promise(function(e,t){h._loadScript(r).done(function(){return e()}).fail(function(){return t()})}))},o=!(a=!0),s=void 0,e.prev=7,l=c[Symbol.iterator]();!(a=(u=l.next()).done);a=!0)u=u.value,i(u);e.next=15}break;case 11:e.prev=11,e.t0=e.catch(7),o=!0,s=e.t0;case 15:e.prev=15,e.prev=16,!a&&l.return&&l.return();case 18:if(e.prev=18,o)throw s;e.next=21;break;case 21:return e.finish(18);case 22:return e.finish(15);case 23:return e.prev=23,e.next=26,Promise.all(n);case 26:c=""+h.pluginsBaseUrl+p,d=c+"/js/plugin.js?"+Date.now(),f.baseUrl=h.pluginsBaseUrl,h._loadScript(d).done(function(){h._loadedPluginUrls.push(d),t()}).fail(function(){h.removeLoadingPlugin(p,!1),r()}),e.next=36;break;case 32:e.prev=32,e.t1=e.catch(23),h.removeLoadingPlugin(p,!1),r();case 36:e.next=39;break;case 38:t();case 39:case"end":return e.stop()}},e,h,[[7,11,15,23],[16,,18,22],[23,32]])})),function(e,t){return r.apply(this,arguments)}))},this.getPluginConfig=function(e){return this.pluginsConfigs[e]},this.getPlugins=function(){return this._plugins},this.getPlugin=function(e){return this._plugins[e]},this.isPluginInConfiguration=function(e){return-1!==this._configurationPlugins.indexOf(e)},this.isTherePlugin=function(e){return this.pluginsConfigs[e]}}l(p,e),r.default=new p},{"core/g3wobject":12,"core/utils/utils":68,"services/application":351,"store/projects":379}],379:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=a(e("store/catalog-layers")),i=a(e("store/map-layers"));function a(e){return e&&e.__esModule?e:{default:e}}var o=e("core/utils/utils"),s=o.base,o=o.inherit,l=e("core/g3wobject"),u=e("core/project/project");function c(){this.config=null,this.initialized=!1,this.projectType=null,this.currentProjectGroup=null,this.overviewproject=void 0,this.setters={createProject:function(e){},setCurrentProject:function(e){this.state.currentProject!==e&&(n.default.removeLayersStores(),i.default.removeLayersStores()),this.state.currentProject=e,this.state.qgis_version=e.getQgisVersion(),this.setProjectType(e.state.type);e=e.getLayersStore();n.default.addLayersStore(e,0),i.default.addLayersStore(e,0)}},this.state={baseLayers:{},minScale:null,maxscale:null,currentProject:null,qgis_version:null},this._groupProjects=[],this._projectConfigs={},this.init=function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred();return this.initialized?r.resolve(this.getCurrentProject()):(this.config=e,this.currentProjectGroup=e.group,this.overviewproject=e.overviewproject,this.setupState(),this.getProject(e.initproject,{map_theme:new URLSearchParams(location.search).get("map_theme")}).then(function(e){t.setCurrentProject(e),t.initialized=!0,r.resolve(e)}).fail(function(e){return r.reject(e)})),r.promise()},this.clear=function(){this.config=null,this.initialized=!1,this.projectType=null,this.overviewproject=void 0,this.initialized=!1,this._groupProjects=[],this._projectConfigs={},this.state={baseLayers:{},minScale:null,maxscale:null,currentProject:null,qgis_version:null}},this.setProjectType=function(e){this.projectType=e},this.getConfig=function(){return this.config},this.getState=function(){return this.state},this.setupState=function(){this.state.baseLayers=this.config.baselayers,this.state.minScale=this.config.minscale,this.state.maxScale=this.config.maxscale,this.state.crs=this.config.crs,this.setProjects(this.config.projects)},this.getProjectType=function(){return this.projectType},this.getProjects=function(){return this._groupProjects},this.setProjects=function(e){var t=this;this.clearProjects(),e.forEach(function(e){t.state.qgis_version=e.qgis_version||t.state.qgis_version,e.baselayers=t.config.baselayers,e.minscale=t.config.minscale,e.maxscale=t.config.maxscale,e.crs=t.config.crs,e.vectorurl=t.config.vectorurl,e.rasterurl=t.config.rasterurl,e.overviewprojectgid=t.overviewproject?t.overviewproject.gid:null,t._groupProjects.push(e)})},this.clearProjects=function(){this._groupProjects=[]},this.getListableProjects=function(){var t=this.getCurrentProject().getId();return _.sortBy(this.getProjects().filter(function(e){return _.isNil(e.listable)?!(e.id===t||e.overviewprojectgid&&e.gid===e.overviewprojectgid)&&e:e.listable}),"title")},this.getCurrentProject=function(){return this.state.currentProject},this.getProject=function(t){var e,r=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{reload:!1},i=$.Deferred(),a=this._groupProjects.find(function(e){return e.gid===t});return a?(e=!n.reload&&this._projectConfigs[t])?i.resolve(new u(e)):this._getProjectFullConfig(a,{map_theme:n.map_theme}).then(function(e){e=_.merge(a,e);e.WMSUrl=r.config.getWmsUrl(e),e.relations=r._setProjectRelations(e),r._projectConfigs[e.gid]=e,r.createProject(e),i.resolve(new u(e))}).fail(function(e){return i.reject(e)}):i.reject("Project doesn't exist"),i.promise()},this._setProjectRelations=function(t){var r=this;return t.relations=(t.relations||[]).map(function(e){return e=r._updateRelation(t,e)}),t.relations},this._updateRelation=function(e,t){return"ONE"===t.type&&e.layers.find(function(e){if(e.id===t.referencingLayer)return t.name=e.name,t.origname=e.origname,!0}),t},this.getProjectConfigByGid=function(t){return this._groupProjects.find(function(e){return e.gid===t})},this.setProjectAliasUrl=function(t){var e=this.config.projects.find(function(e){return e.gid===t.gid});e&&(e.url=e&&""+(t.host||"")+t.url)},this.getProjectUrl=function(t){var r=this.config&&this.config.urls&&this.config.urls.baseurl,t=this.getProjectConfigByGid(t).url;try{return""+new URL(r)+t}catch(e){return""+location.origin+r+t}},this.getBaseUrl=function(){return this.config.urls.baseurl},this._getProjectFullConfig=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=$.Deferred();return $.get(this.config.getProjectConfigUrl(e)).done(function(r){var n;t.map_theme?(n=r.map_themes.find(function(e){return e.theme===t.map_theme}))&&$.get("/"+e.type+"/api/prjtheme/"+e.id+"/"+t.map_theme).done(function(e){var t=e.result,e=e.data;t&&(r.layerstree=e,n.layetstree=e,n.default=!0)}).always(function(){i.resolve(r)}):i.resolve(r)}).fail(function(e){return i.reject(e)}),i.promise()},this.getCurrentProjectGroup=function(){return this.currentProjectGroup},s(this)}o(c,l),r.default=new c},{"core/g3wobject":12,"core/project/project":61,"core/utils/utils":68,"store/catalog-layers":374,"store/map-layers":377}],380:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});r.default=new function(){this._sessions={},this.register=function(e){var t=e.getId();this._sessions[t]=e},this.unregister=function(e){delete this._sessions[e]},this.getSession=function(e){return this._sessions[e]},this.setSession=function(e,t){this._sessions[e]=t},this.getSessions=function(){return this._sessions},this.clear=function(){this._sessions={}}}},{}],381:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default="3.8.13"},{}]},{},[328]);
//# sourceMappingURL=app.min.js.map
