!function(){function e(t,r,n){function i(o,s){if(!r[o]){if(!t[o]){var l="function"==typeof require&&require;if(!s&&l)return l(o,!0);if(a)return a(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[o]={exports:{}};t[o][0].call(c.exports,function(e){var r=t[o][1][e];return i(r||e)},c,c.exports,e,t,r,n)}return r[o].exports}for(var a="function"==typeof require&&require,o=0;o<n.length;o++)i(n[o]);return i}return e}()({1:[function(e,t,r){},{}],2:[function(e,t,r){function n(){}var i=r.cache={};r.insert=function(e){if(i[e])return n;i[e]=!0;var t=document.createElement("style");return t.setAttribute("type","text/css"),"textContent"in t?t.textContent=e:t.styleSheet.cssText=e,document.getElementsByTagName("head")[0].appendChild(t),function(){document.getElementsByTagName("head")[0].removeChild(t),i[e]=!1}}},{}],3:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("./constant"),a=n(i),o=e("core/applicationstate"),s=n(o),l=e("components/InputG3W.vue"),u=n(l),c=e("components/InputG3WFormInputs.vue"),d=n(c),p=e("components/FormBody.vue"),f=n(p),h=e("components/FormFooter.vue"),v=n(h),g=e("components/C3XYLine.vue"),m=n(g),y=e("core/g3wobject"),_=e("core/utils/utils"),b=e("core/utils/geo"),w=e("core/applicationservice"),x=e("core/apiservice"),S=e("core/router"),C=e("core/i18n/i18n.service"),L=e("core/task/service"),k=e("core/data/routerservice"),M=e("core/iframe/routerservice"),T=e("core/errors/parser/servererrorparser"),E=e("core/editing/session"),I=e("core/editing/sessionsregistry"),P=e("core/editing/editor"),F=e("core/editing/changesmanager"),O=e("core/utils/geo"),R=e("core/utils/geo"),j=R.Geometry,A=e("core/project/projectsregistry"),N=e("core/project/project"),G=e("core/map/maplayersstoresregistry"),D=e("core/catalog/cataloglayersstoresregistry"),$=e("core/layers/layersstoresregistry"),V=e("core/layers/layersstore"),U=e("core/layers/layer"),q=e("core/layers/layerfactory"),B=e("core/layers/tablelayer"),z=e("core/layers/vectorlayer"),W=e("core/layers/imagelayer"),H=e("core/layers/map/wmslayer"),Y=e("core/layers/map/xyzlayer"),K=e("core/layers/map/maplayer"),Z=e("core/layers/features/feature"),Q=e("core/layers/features/featuresstore"),X=e("core/layers/features/olfeaturesstore"),J=e("core/layers/filter/filter"),ee=e("core/layers/filter/expression"),te=e("core/relations/relationsservice"),re=e("core/plugin/plugin"),ne=e("core/plugin/pluginsregistry"),ie=e("core/plugin/pluginservice"),ae=e("core/workflow/task"),oe=e("core/workflow/step"),se=e("core/workflow/flow"),le=e("core/workflow/workflow"),ue=e("core/workflow/workflowsstack"),ce=e("gui/gui"),de=e("gui/panel"),pe=e("gui/map/control/factory"),fe=e("gui/component/componentsfactory"),he=e("gui/fields/fieldsservice"),ve=e("gui/component/component"),ge=e("gui/metadata/vue/metadata"),me=e("gui/search/vue/search"),ye=e("gui/search/vue/panel/searchpanel"),_e=e("gui/print/vue/print"),be=e("gui/catalog/vue/catalog"),we=e("gui/map/vue/map"),xe=e("gui/tools/vue/tools"),Se=e("gui/queryresults/vue/queryresults"),Ce=e("gui/form/vue/form"),Le=e("gui/inputs/inputs"),ke=e("gui/charts/chartsfactory"),Me=e("gui/fields/fields"),Te=e("gui/vue/vue.mixins"),Ee=e("gui/search/vue/panel/searchservice"),Ie=e("g3w-ol/interactions/pickfeatureinteraction"),Pe=e("g3w-ol/interactions/pickcoordinatesinteraction"),Fe=e("g3w-ol/interactions/deletefeatureinteraction"),Oe=e("g3w-ol/interactions/areainteraction"),Re=e("g3w-ol/interactions/lengthinteraction"),je=e("core/utils/ol");t.exports={constant:a["default"],core:{G3WObject:y,utils:_,geoutils:b,ApplicationService:w,ApplicationState:s["default"],ApiService:x,Router:S,i18n:C,task:{TaskService:L},data:{DataRouterService:k},iframe:{IFrameRouterService:M},errors:{parsers:{Server:T}},editing:{Session:E,SessionsRegistry:I,Editor:P,ChangesManager:F},geometry:{Geom:O,Geometry:j},project:{ProjectsRegistry:A,Project:N},map:{MapLayersStoreRegistry:G},catalog:{CatalogLayersStoresRegistry:D},layer:{LayersStoreRegistry:$,LayersStore:V,Layer:U,LayerFactory:q,TableLayer:B,VectorLayer:z,ImageLayer:W,WmsLayer:H,XYZLayer:Y,MapLayer:K,geometry:{Geometry:j,geom:O},features:{Feature:Z,FeaturesStore:Q,OlFeaturesStore:X},filter:{Filter:J,Expression:ee}},relations:{RelationsService:te},interaction:{PickCoordinatesInteraction:Pe,PickFeatureInteraction:Ie},plugin:{Plugin:re,PluginsRegistry:ne,PluginService:ie},workflow:{Task:ae,Step:oe,Flow:se,Workflow:le,WorkflowsStack:ue}},gui:{GUI:ce,Panel:de,ControlFactory:pe,ComponentsFactory:fe,FieldsService:he,vue:{Component:ve,Panel:de,MetadataComponent:ge,SearchComponent:me,SearchPanel:ye,PrintComponent:_e,CatalogComponent:be,MapComponent:we,ToolsComponent:xe,QueryResultsComponent:Se,FormComponent:Ce,FormComponents:{Body:f["default"],Footer:v["default"]},Inputs:{G3wFormInputs:d["default"],G3WInput:u["default"],InputsComponents:Le},Charts:{ChartsFactory:ke,c3:{lineXY:m["default"]}},Fields:Me,Mixins:Te,services:{SearchPanel:Ee}}},ol:{interactions:{PickFeatureInteraction:Ie,PickCoordinatesInteraction:Pe,DeleteFeatureInteraction:Fe,measure:{AreaInteraction:Oe,LengthInteraction:Re}},controls:{},utils:je},test:{},version:a["default"].APP_VERSION}},{"./constant":5,"components/C3XYLine.vue":234,"components/FormBody.vue":253,"components/FormFooter.vue":254,"components/InputG3W.vue":277,"components/InputG3WFormInputs.vue":278,"core/apiservice":6,"core/applicationservice":7,"core/applicationstate":8,"core/catalog/cataloglayersstoresregistry":9,"core/data/routerservice":15,"core/editing/changesmanager":18,"core/editing/editor":19,"core/editing/session":21,"core/editing/sessionsregistry":22,"core/errors/parser/servererrorparser":23,"core/g3wobject":26,"core/i18n/i18n.service":27,"core/iframe/routerservice":28,"core/layers/features/feature":43,"core/layers/features/featuresstore":44,"core/layers/features/olfeaturesstore":45,"core/layers/filter/expression":46,"core/layers/filter/filter":47,"core/layers/imagelayer":51,"core/layers/layer":52,"core/layers/layerfactory":53,"core/layers/layersstore":54,"core/layers/layersstoresregistry":55,"core/layers/map/maplayer":61,"core/layers/map/wmslayer":63,"core/layers/map/xyzlayer":65,"core/layers/tablelayer":74,"core/layers/vectorlayer":75,"core/map/maplayersstoresregistry":76,"core/plugin/plugin":78,"core/plugin/pluginservice":79,"core/plugin/pluginsregistry":80,"core/project/project":82,"core/project/projectsregistry":83,"core/relations/relationsservice":86,"core/router":87,"core/task/service":88,"core/utils/geo":89,"core/utils/ol":90,"core/utils/utils":92,"core/workflow/flow":96,"core/workflow/step":98,"core/workflow/task":99,"core/workflow/workflow":100,"core/workflow/workflowsstack":101,"g3w-ol/interactions/areainteraction":125,"g3w-ol/interactions/deletefeatureinteraction":126,"g3w-ol/interactions/lengthinteraction":127,"g3w-ol/interactions/pickcoordinatesinteraction":129,"g3w-ol/interactions/pickfeatureinteraction":130,"gui/catalog/vue/catalog":137,"gui/charts/chartsfactory":139,"gui/component/component":140,"gui/component/componentsfactory":141,"gui/fields/fields":145,"gui/fields/fieldsservice":146,"gui/form/vue/form":149,"gui/gui":150,"gui/inputs/inputs":160,"gui/map/control/factory":184,"gui/map/vue/map":187,"gui/metadata/vue/metadata":191,"gui/panel":193,"gui/print/vue/print":196,"gui/queryresults/vue/queryresults":205,"gui/search/vue/panel/searchpanel":211,"gui/search/vue/panel/searchservice":212,"gui/search/vue/search":213,"gui/tools/vue/tools":222,"gui/vue/vue.mixins":227}],4:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0}),r.utils=r.server=r.client=r._i18n=r.tools=r.plugins=void 0;var i=e("../locales"),a=n(i),o="G3W Client",s=["en","it"],l=r.plugins={},u=r.tools={tools:[]},c=r._i18n={resources:a["default"]},d=r.client={debug:!0,local:!1},p=r.server={urls:{baseurl:"/",ows:"ows",api:"api",initconfig:"api/initconfig",config:"api/config"}},f=r.utils={merge:function(e){}};r["default"]={apptitle:o,client:d,server:p,plugins:l,supportedLng:s,tools:u,_i18n:c,utils:f}},{"../locales":362}],5:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0}),r.VIEWPORT=r.TOC_THEMES_INIT_STATUS=r.TOC_LAYERS_INIT_STATUS=r.TIMEOUT=r.QUERY_POINT_TOLERANCE=r.PRINT_SCALES=r.PRINT_RESOLUTIONS=r.PRINT_FORMATS=r.MAP_SETTINGS=r.LOCALSTORAGE_EXTERNALWMS_ITEM=r.LIST_OF_RELATIONS_TITLE=r.GEOMETRY_TYPES=r.GEOMETRY_FIELDS=r.G3W_FID=r.EPSG=r.DOWNLOAD_FORMATS=r.DEFAULT_EDITING_CAPABILITIES=r.APP_VERSION=void 0;var i=e("../version"),a=n(i),o=r.APP_VERSION=a["default"],s=r.DEFAULT_EDITING_CAPABILITIES=["add_feature","change_feature","change_attr_feature","delete_feature"],l=r.DOWNLOAD_FORMATS={download:{format:"shapefile",url:"shp"},download_gpkg:{format:"gpkg",url:"gpkg"},download_gpx:{format:"gpx",url:"gpx"},download_csv:{format:"csv",url:"csv"},download_xls:{format:"xls",url:"xls"},download_raster:{format:"geotiff",url:"geotiff"}},u=(r.EPSG=["EPSG:3003","EPSG:3004","EPSG:3045","EPSG:3857","EPSG:4326","EPSG:6708","EPSG:23032","EPSG:23033","EPSG:25833","EPSG:32632","EPSG:32633"],r.G3W_FID="g3w_fid"),c=r.GEOMETRY_FIELDS=["geometryProperty","boundedBy","geom","the_geom","geometry","bbox","GEOMETRY","geoemtria","geometria"],d=r.GEOMETRY_TYPES={POINT:"Point",POINTZ:"PointZ",POINTM:"PointM",POINTZM:"PointZM",POINT25D:"Point25D",MULTIPOINT:"MultiPoint",MULTIPOINTZ:"MultiPointZ",MULTIPOINTM:"MutliPointM",MULTIPOINTZM:"MultiPointZM",MULTIPOINT25D:"MultiPoint25D",LINESTRING:"LineString",LINESTRINGZ:"LineStringZ",LINESTRINGM:"LineStringM",LINESTRINGZM:"LineStringZM",LINESTRING25D:"LineString25D",LINE:"Line",LINEZ:"LineZ",LINEM:"LineM",LINEZM:"LineZM",LINE25D:"Line25D",MULTILINESTRING:"MultiLineString",MULTILINESTRINGZ:"MultiLineStringZ",MULTILINESTRINGM:"MultiLineStringM",MULTILINESTRINGZM:"MultiLineStringZM",MULTILINESTRING25D:"MultiLineString25D",MULTILINE:"MultiLine",MULTILINEZ:"MultiLineZ",MULTILINEM:"MultiLineM",MULTILINEZM:"MultiLineZM",MULTILINE25D:"MultiLine25D",POLYGON:"Polygon",POLYGONZ:"PolygonZ",POLYGONM:"PolygonM",POLYGONZM:"PolygonZM",POLYGON25D:"Polygon25D",MULTIPOLYGON:"MultiPolygon",MULTIPOLYGONZ:"MultiPolygonZ",MULTIPOLYGONM:"MultiPolygonM",MULTIPOLYGONZM:"MultiPolygonZM",MULTIPOLYGON25D:"MultiPolygon25D",GEOMETRYCOLLECTION:"GeometryCollection",GEOMETRYCOLLECTIONZ:"GeometryCollectionZ",GEOMETRYCOLLECTIONM:"GeometryCollectionM",GEOMETRYCOLLECTIONZM:"GeometryCollectionZM",GEOMETRYCOLLECTION25D:"GeometryCollection25D"},p=r.LIST_OF_RELATIONS_TITLE="__G3W_LIST_OF_RELATIONS_TITLE__",f=r.LOCALSTORAGE_EXTERNALWMS_ITEM="externalwms",h=r.MAP_SETTINGS={ZOOM:{maxScale:1e3},ANIMATION:{duration:2e3},LAYER_POSITIONS:{"default":"top",getPositions:function(){return["top","bottom"]}}},v=r.PRINT_FORMATS=[{value:"pdf",label:"PDF"},{value:"png",label:"PNG"}],g=r.PRINT_RESOLUTIONS=[150,300],m=r.PRINT_SCALES=[{value:100,label:"1:100"},{value:200,label:"1:200"},{value:500,label:"1:500"},{value:1e3,label:"1:1.000"},{value:2e3,label:"1:2.000"},{value:2500,label:"1:2.500"},{value:5e3,label:"1:5.000"},{value:1e4,label:"1:10.000"},{value:2e4,label:"1:20.000"},{value:25e3,label:"1:25.000"},{value:5e4,label:"1:50.000"},{value:1e5,label:"1:100.000"},{value:25e4,label:"1:250.000"},{value:5e5,label:"1:500.000"},{value:1e6,label:"1:1.000.000"},{value:25e5,label:"1:2.500.000"},{value:5e6,label:"1:5.000.000"},{value:1e7,label:"1:10.000.000"},{value:2e7,label:"1:20.000.000"},{value:5e7,label:"1:50.000.000"},{value:1e8,label:"1:100.000.000"},{value:25e7,label:"1:250.000.000"},{value:5e8,label:"1:500.000.000"}],y=r.QUERY_POINT_TOLERANCE={unit:"pixel",value:10},_=r.TIMEOUT=6e4,b=r.TOC_LAYERS_INIT_STATUS="not_collapsed",w=r.TOC_THEMES_INIT_STATUS="collapsed",x=r.VIEWPORT={resize:{map:{min:200},content:{min:200}}};r["default"]={APP_VERSION:o,DEFAULT_EDITING_CAPABILITIES:s,DOWNLOAD_FORMATS:l,G3W_FID:u,GEOMETRY_FIELDS:c,GEOMETRY_TYPES:d,LIST_OF_RELATIONS_TITLE:p,LOCALSTORAGE_EXTERNALWMS_ITEM:f,MAP_SETTINGS:h,PRINT_FORMATS:v,PRINT_RESOLUTIONS:g,PRINT_SCALES:m,QUERY_POINT_TOLERANCE:y,TIMEOUT:_,TOC_LAYERS_INIT_STATUS:b,TOC_THEMES_INIT_STATUS:w,VIEWPORT:x}},{"../version":409}],6:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("services/api"),a=n(i);t.exports=a["default"]},{"services/api":378}],7:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("services/application"),a=n(i);t.exports=a["default"]},{"services/application":379}],8:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("store/application-state");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(r,e,{enumerable:!0,get:function(){return i[e]}})}),Object.defineProperty(r,"default",{enumerable:!0,get:function(){return n(i)["default"]}})},{"store/application-state":401}],9:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("store/catalog-layers"),a=n(i);t.exports=a["default"]},{"store/catalog-layers":402}],10:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("services/clipboard"),a=n(i);t.exports=a["default"]},{"services/clipboard":380}],11:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("services/data-expression"),a=n(i);t.exports=a["default"]},{"services/data-expression":381}],12:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("services/data-ows"),a=n(i);t.exports=a["default"]},{"services/data-ows":382}],13:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("services/data-proxy"),a=n(i);t.exports=a["default"]},{"services/data-proxy":383}],14:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("services/data-query"),a=n(i);t.exports=a["default"]},{"services/data-query":384}],15:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("services/data"),a=n(i);t.exports=a["default"]},{"services/data":386}],16:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("services/data-search"),a=n(i);t.exports=a["default"]},{"services/data-search":385}],17:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function i(){var e=this;a.onbefore("setCurrentProject",function(t){return e.project=t}),this.project=a.getCurrentProject()}var a=e("core/project/projectsregistry"),o=i.prototype;o.handleRequest=function(e){},o.handleResponse=function(){var e=n(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),t.exports=i},{"core/project/projectsregistry":83}],18:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("services/editing"),a=n(i);t.exports=a["default"]},{"services/editing":387}],19:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.setters={save:function(){this._save()},addFeature:function(e){this._addFeature(e)},updateFeature:function(e){this._updateFeature(e)},deleteFeature:function(e){this._deleteFeature(e)},setFeatures:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this._setFeatures(e)},getFeatures:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._getFeatures(e)}},p(this),this._filter={bbox:null},this._allfeatures=!1,this._layer=e.layer,this._featuresstore=this._layer.getType()===g.LayerTypes.TABLE?new h:new v,this._started=!1,this._noteditablefileds=this._layer.getEditingNotEditableFields()||[]}var s=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=e("core/applicationstate"),u=n(l),c=e("core/utils/utils"),d=c.inherit,p=c.base,f=e("core/g3wobject"),h=e("core/layers/features/featuresstore"),v=e("core/layers/features/olfeaturesstore"),g=e("core/layers/layer"),m=e("./changesmanager");d(o,f);var y=o.prototype;y._canDoGetFeaturesRequest=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!0;if(this._layer.getType()===g.LayerTypes.VECTOR){var r=e.filter||{},n=r.bbox;n&&(this._filter.bbox?ol.extent.containsExtent(this._filter.bbox,n)?t=!1:this._filter.bbox=ol.extent.extend(this._filter.bbox,n):this._filter.bbox=n)}return t},y.getEditingSource=function(){return this._featuresstore},y.getSource=function(){this._layer.getSource()},y._applyChanges=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];m.execute(this._featuresstore,e,t)},y.setChanges=function(e,t){this._applyChanges(e,t)},y.getLayer=function(){return this._layer},y.setLayer=function(e){return this._layer=e,this._layer},y.removeNotEditablePropriertiesFromFeature=function(e){this._noteditablefileds.forEach(function(t){e.unset([t])})},y._cloneFeatures=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map(function(e){return e.clone()})},y._addFeaturesFromServer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e=this._cloneFeatures(e),this._featuresstore.addFeatures(e)},y._doGetFeaturesRequest=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=u["default"].online&&!this._allfeatures;return t&&this._canDoGetFeaturesRequest(e)},y._getFeatures=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred(),n=this._doGetFeaturesRequest(t);return n?this._layer.getFeatures(t).then(function(n){n.then(function(n){return e._addFeaturesFromServer(n),e._allfeatures=!t.filter,r.resolve(n)}).fail(function(e){return r.reject(e)})}).fail(function(e){r.reject(e)}):r.resolve(),r.promise()},y.revert=function(){var e=$.Deferred(),t=this._cloneFeatures(this._layer.readFeatures());return this._featuresstore.setFeatures(t),e.resolve(),e.promise()},y.rollback=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=$.Deferred();return this._applyChanges(e,!0),t.resolve(),t.promise()},y.applyChangesToNewRelationsAfterCommit=function(e){for(var t in e){var r=e[t],n=this.getLayerById(t),i=this.getEditingLayer(t).getEditingSource(),a=i.readFeatures();a.forEach(function(e){e.clearState()}),n.getSource().setFeatures(a),n.applyCommitResponse({response:r,result:!0}),i.setFeatures(n.getSource().readFeatures())}},y.setFieldValueToRelationField=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.relationId,n=t.ids,i=t.field,a=t.values,o=void 0===a?[]:a,s=e("./sessionsregistry"),l=s.getSession(r).getEditor().getEditingSource();n.forEach(function(e){var t=l.getFeatureById(e);if(t){var r=t.get(i);r==o[0]&&t.set(i,o[1])}})},y.applyCommitResponse=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(t&&t.result){var n=t.response,i=n["new"],a=n.new_lockids;i.forEach(function(t){var n=e._featuresstore.getFeatureById(t.clientid);n.setId(t.id),n.setProperties(t.properties),r.forEach(function(r){Object.entries(r).forEach(function(r){var i=s(r,2),a=i[0],o=i[1],l=n.get(o.fatherField);e.setFieldValueToRelationField({relationId:a,ids:o.ids,field:o.childField,values:[t.clientid,l]})})})});var o=this._featuresstore.readFeatures();o.forEach(function(e){return e.clearState()}),this._layer.setFeatures(o),this._layer.getSource().addLockIds(a)}},y.getLockIds=function(){return this._layer.getSource().getLockIds()},y.commit=function(e){var t=this,r=$.Deferred(),n=e.add.length?Object.keys(e.relations).map(function(r){var n=t._layer.getRelations().getRelationByFatherChildren(t._layer.getId(),r),o=e.relations[r].update.map(function(e){return e.id}),s=e.relations[r].add.map(function(e){return e.id});return i({},r,{ids:[].concat(a(s),a(o)),fatherField:n.getFatherField(),childField:n.getChildField()})}):[];return this._layer.commit(e).then(function(e){e.then(function(e){t.applyCommitResponse(e,n),r.resolve(e)}).fail(function(e){return r.reject(e)})}).fail(function(e){return r.reject(e)}),r.promise()},y.start=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred();return this.getFeatures(t).then(function(t){t.then(function(t){r.resolve(t),e._started=!0}).fail(function(e){return r.reject(e)})}).fail(function(e){return r.reject(e)}),r.promise()},y._addFeature=function(e){this._featuresstore.addFeature(e)},y._deleteFeature=function(e){this._featuresstore.deleteFeature(e)},y._updateFeature=function(e){this._featuresstore.updateFeature(e)},y._setFeatures=function(e){this._featuresstore.setFeatures(e)},y.readFeatures=function(){return this._layer.readFeatures()},y.readEditingFeatures=function(){return this._featuresstore.readFeatures()},y.stop=function(){var e=this,t=$.Deferred();return this._layer.unlock().then(function(r){e.clear(),t.resolve(r)}).fail(function(e){return t.reject(e)}),t.promise()},y._save=function(){this._layer.save()},y.isStarted=function(){return this._started},y.clear=function(){this._started=!1,this._filter.bbox=null,this._allfeatures=!1,this._featuresstore.clear(),this._layer.getFeaturesStore().clear(),this._layer.getType()===g.LayerTypes.VECTOR&&this._layer.resetEditingSource(this._featuresstore.getFeaturesCollection())},t.exports=o},{"./changesmanager":18,"./sessionsregistry":22,"core/applicationstate":8,"core/g3wobject":26,"core/layers/features/featuresstore":44,"core/layers/features/olfeaturesstore":45,"core/layers/layer":52,"core/utils/utils":92}],20:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.id=e.id,o(this),this._maxSteps=10,this._states=[],this.state={commit:!1,undo:!1,redo:!1},this._current=null}var a=e("core/utils/utils"),o=a.base,s=a.inherit,l=e("core/g3wobject");s(n,l);var u=n.prototype;u.add=function(e,t){var r=this,n=$.Deferred();return null===this._current?this._states=[{id:e,items:t}]:(this._states.length&&this._current<this.getLastState().id&&(this._states=this._states.filter(function(e){return e.id<=r._current})),this._states.push({id:e,items:t})),this._current=e,this._setState(),n.resolve(e),n.promise()},u.getRelationStates=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(t.clear,[]),n=0;n<this._states.length;n++){var i=this._states[n],a=i.items.filter(function(t){var r=Array.isArray(t)?t[0].layerId:t.layerId;return r===e});a.length&&r.push({id:i.id,items:a})}return r},u.insertState=function(e){for(var t=e.id,r=this._states.length,n=0;n<this._states.length;n++){var i=this._states[n];if(i.id>t){r=n;break}i.id===t&&(r=-1);break}r>-1&&(this._current<t&&(this._current=t),this._states.splice(r,0,e))},u.removeState=function(e){var t=void 0;for(i=0;i<this._states.length;i++){var r=this._states[i];if(r.id===e){t=i;break}}this._current===e&&(this._current=this._states.length>1?this._states[t-1].id:null),this._states.splice(t,1)},u.removeStates=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=0;t<e.length;t++){var r=e[t];this.removeState(r)}},u.insertStates=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=0;t<e.length;t++)this.insertState(e[t]);this.canCommit()},u._setState=function(){this.canUndo(),this.canCommit(),this.canRedo()},u._checkItems=function(e,t){var r=this,n={own:[],dependencies:{}};return e.forEach(function(e){Array.isArray(e)&&(e=e[t]),r.id===e.layerId?n.own.push(e):(n.dependencies[e.layerId]||(n.dependencies[e.layerId]={own:[],dependencies:{}}),n.dependencies[e.layerId].own.push(e))}),n},u.undo=function(){var e=this,t=void 0;return this._current===this.getFirstState().id?(this._current=null,t=this._states[0].items):this._states.find(function(r,n){if(r.id===e._current)return t=e._states[n].items,e._current=e._states[n-1].id,!0}),t=this._checkItems(t,0),this._setState(),t},u.redo=function(){var e=this,t=void 0;return this._current?this._states.find(function(r,n){if(e._current===r.id)return e._current=e._states[n+1].id,t=e._states[n+1].items,!0}):(t=this._states[0].items,this._current=this._states[0].id),t=this._checkItems(t,1),this._setState(),t},u.setItemsFeatureIds=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach(function(t){var r=t.id,n=t.clientid;e._states.forEach(function(e){var t=e.items;t.forEach(function(e){var t=e.feature.getId()===n&&e.feature;t&&t.setId(r)})})})},u.clear=function(e){var t=this;e?this._states.forEach(function(r,n){e.indexOf(r.id)!==-1&&(t._current&&t._current===r.id()&&t.undo(),t._states.splice(n,1))}):this._clearAll()},u._clearAll=function(){this._states=[],this._current=null,this.state.commit=!1,this.state.redo=!1,this.state.undo=!1},u.getState=function(e){return this._states.find(function(t){return t.id===e})},u.getFirstState=function(){return this._states.length?this._states[0]:null},u.getLastState=function(){var e=this._states.length;return e?this._states[e-1]:null},u.getCurrentState=function(){var e=this,t=null;return this._current&&this._states.length&&(t=this._states.find(function(t){return e._current===t.id})),t},u.getCurrentStateIndex=function(){var e=this,t=null;return this._current&&this._states.length&&this._states.forEach(function(r,n){if(e._current===r.id)return t=n,!1}),t},u.canCommit=function(){var e=this.commit(),t=!1;for(var r in e){var n=e[r];t=t||!!n.length}return this.state.commit=t,this.state.commit},u.canUndo=function(){var e=this._states.length-1-this.getCurrentStateIndex();return this.state.undo=!_.isNull(this._current)&&this._maxSteps>e,this.state.undo},u.canRedo=function(){return this.state.redo=this.getLastState()&&this.getLastState().id!=this._current||_.isNull(this._current)&&this._states.length>0,this.state.redo},u._getStatesToCommit=function(){var e=this;return this._states.filter(function(t){return t.id<=e._current})},u.commit=function(){var e={},t=this._getStatesToCommit();return t.forEach(function(t){t.items.forEach(function(t){var r=!0;if(Array.isArray(t)&&(t=t[1]),e[t.layerId]&&e[t.layerId].forEach(function(n,i){if(n.getUid()===t.feature.getUid()){if(t.feature.isNew()&&!n.isDeleted()&&t.feature.isUpdated()){var a=t.feature.clone();a.add(),e[t.layerId][i]=a}else t.feature.isNew()&&t.feature.isDeleted()?e[t.layerId].splice(i,1):(t.feature.isUpdated()||t.feature.isDeleted())&&(e[t.layerId][i]=t.feature);return r=!1,!1}}),r){var n=t.feature,i=t.layerId;!n.isNew()&&n.isAdded()||(e[i]||(e[i]=[]),e[i].push(n))}})}),e},t.exports=n},{"core/g3wobject":26,"core/utils/utils":92}],21:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.setters={start:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._start(e)},getFeatures:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._getFeatures(e)},stop:function(){this._stop()},saveChangesOnServer:function(e){}},o(this,e),this.state={id:e.id,started:!1,getfeatures:!1},this._editor=e.editor,this._history=new u({id:this.state.id}),this._temporarychanges=[],this.register()}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=e("core/utils/utils"),o=a.base,s=a.inherit,l=e("core/g3wobject"),u=e("./history"),c=e("core/layers/layer"),d=e("core/map/maplayersstoresregistry"),p=e("core/utils/geo").Geometry.is3DGeometry,f=e("./sessionsregistry");s(n,l);var h=n.prototype;h.getId=function(){return this.state.id},h.getLastStateId=function(){return this._history.getLastState().id},h.deleteState=function(e){this._history.removeState(e)},h.register=function(){f.register(this)},h.unregister=function(){f.unregister(this.getId())},h._start=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred();return this._editor.start(t).then(function(t){e.state.started=!0,r.resolve(t)}).fail(function(e){r.reject(e)}),r.promise()},h._getFeatures=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred();return this._allfeatures?r.resolve([]):(this._allfeatures=!t.filter,this._editor.getFeatures(t).then(function(t){t.then(function(t){e.state.getfeatures=!0,r.resolve(t)}).fail(function(e){return r.reject(e)})})),r.promise()},h.isStarted=function(){return this.state.started},h.getEditor=function(){return this._editor},h.setEditor=function(e){this._editor=e},h.save=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred();if(this._temporarychanges.length){var n=t.id||Date.now();this._history.add(n,this._temporarychanges).then(function(){e._temporarychanges=[],r.resolve(n)})}else r.resolve(null);return r.promise()},h.updateTemporaryChanges=function(e){this._temporarychanges.forEach(function(t){t.feature.setProperties(e.getProperties())})},h.pushAdd=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];r&&this._editor.removeNotEditablePropriertiesFromFeature(t);var n=t.clone();return this.push({layerId:e,feature:n.add()}),n},h.pushDelete=function(e,t){return this.push({layerId:e,feature:t["delete"]()}),t},h.pushUpdate=function(e,t,r){if(t.isNew()){var n=this._temporarychanges.findIndex(function(r){return r.layerId===e&&r.feature.getId()===t.getId()});if(n!==-1){var i=t.clone();return i.add(),void(this._temporarychanges[n].feature=i)}}this.push({layerId:e,feature:t.update()},{layerId:e,feature:r.update()})},h.removeChangesFromHistory=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this._history.removeStates(e)},h.moveRelationStatesOwnSession=function(){var e={},t=this.getCommitItems(),r=t.relations;for(var n in r){var i=this._history.getRelationStates(n),a=f.getSession(n);a._history.insertStates(i),e[n]=i.map(function(e){return e.id})}return e},h.push=function(e,t){var r=t?[t,e]:e;this._temporarychanges.push(r)},h.revert=function(){var e=this,t=$.Deferred();return this._editor.revert().then(function(){e._history.clear(),t.resolve()}),t.promise()},h._filterChanges=function(){var e=this.getId(),t={own:[],dependencies:{}};return this._temporarychanges.forEach(function(r){var n=Array.isArray(r)?r[0]:r;n.layerId===e?t.own.push(n):(t.dependencies[n.layerId]||(t.dependencies[n.layerId]=[]),t.dependencies[n.layerId].unshift(n))}),t},h.rollback=function(e){if(e)return this._editor.rollback(e);var t=$.Deferred(),r=this._filterChanges();return this._editor.rollback(r.own).then(function(){var e=r.dependencies;for(var n in e)f.getSession(n).rollback(e[n]);t.resolve(e)}),this._temporarychanges=[],t.promise()},h.rollbackDependecies=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach(function(t){var r=[];e._temporarychanges=e._temporarychanges.filter(function(e){return e.layerId!==t?(r.push(e),!0):void(r.length&&f.getSession(t).rollback(r))})})},h.undo=function(e){return e=e||this._history.undo(),this._editor.setChanges(e.own,!0),this._history.canCommit(),e.dependencies},h.redo=function(e){return e=e||this._history.redo(),
this._editor.setChanges(e.own,!0),this._history.canCommit(),e.dependencies},h._serializeCommit=function(e){var t=this.getId(),r=void 0,n=void 0,a={add:[],update:[],"delete":[],relations:{}};for(var o in e){var s=!1,l=e[o];if(o!==t){s=!0;var u=f.getSession(o),c=u?u.getEditor().getLockIds():[];a.relations[o]={lockids:c,add:[],update:[],"delete":[]},n=a.relations[o]}else n=a;l.forEach(function(e){r=e.getState();var t=new ol.format.GeoJSON;switch(r){case"delete":e.isNew()||n["delete"].push(e.getId());break;default:var a=t.writeFeatureObject(e),o=e.getProperties();for(var s in a.properties)a.properties[s]&&"object"===i(a.properties[s])&&a.properties[s].constructor===Object&&(a.properties[s]=a.properties[s].value),void 0===a.properties[s]&&o[s]&&(a.properties[s]=o[s]);var l=e.isNew()?"add":e.getState();n[l].push(a)}}),!s||n.add.length||n.update.length||n["delete"].length||delete a.relations[o]}return a},h.getCommitItems=function(){var e=this._history.commit();return this._serializeCommit(e)},h.set3DGeometryType=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.layerId,n=void 0===r?this.getId():r,i=t.commitItems,a=i.relations,o=d.getLayerById(n).getEditingLayer();if(o&&o.getType()===c.LayerTypes.VECTOR){var s=o.getGeometryType();p(s)&&["add","update"].forEach(function(e){i[e].forEach(function(e){return e.geometry.type=s})})}Object.keys(a).forEach(function(t){return e.set3DGeometryType({layerId:t,commitItems:a[t]})})},h.commit=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.ids,n=void 0===r?null:r,i=t.items,a=t.relations,o=void 0===a||a,s=$.Deferred(),l=void 0;return n?(l=this._history.commit(n),this._history.clear(n)):(i?l=i:(l=this._history.commit(),l=this._serializeCommit(l)),o||(l.relations={}),this._editor.commit(l).then(function(t){if(t&&t.result){var r=t.response,n=r.new_relations,i=void 0===n?{}:n;for(var a in i){var o=f.getSession(a);o.getEditor().applyCommitResponse({response:i[a],result:!0})}e._history.clear(),e.saveChangesOnServer(l),s.resolve(l,t)}else s.reject(t)}).fail(function(e){return s.reject(e)})),s.promise()},h._canStop=function(){return this.state.started||this.state.getfeatures},h._stop=function(){var e=this,t=$.Deferred();return this._canStop()?this._editor.stop().then(function(){e.clear(),t.resolve()}).fail(function(e){return t.reject(e)}):t.resolve(),t.promise()},h.clear=function(){this._allfeatures=!1,this.state.started=!1,this.state.getfeatures=!1,this.clearHistory(),this._editor.clear()},h.getHistory=function(){return this._history},h.clearHistory=function(){this._history.clear()},t.exports=n},{"./history":20,"./sessionsregistry":22,"core/g3wobject":26,"core/layers/layer":52,"core/map/maplayersstoresregistry":76,"core/utils/geo":89,"core/utils/utils":92}],22:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("store/sessions"),a=n(i);t.exports=a["default"]},{"store/sessions":408}],23:[function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=e("core/i18n/i18n.service"),o=a.t,s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._error=e.error},l=s.prototype;l.parse=function(){function e(t){var r=Object.entries(t),a=r.find(function(e){var t=i(e,2),r=t[0];t[1];return"fields"===r});if(a){var o=i(a,2),l=o[1];try{if("string"==typeof l){var u=r.find(function(e){var t=i(e,2),r=t[0];t[1];return"fields"!==r}),c=i(u,1),d=c[0];s="["+d+"] "+l}else s="",Object.entries(l).forEach(function(e){var t=i(e,2),r=t[0],n=t[1];s=""+s+r+" "+(Array.isArray(n)?n[0]:n)+" "})}catch(p){}return s.replace(/\:|\./g,"")}var f=i(r[0],2),h=f[1];if(!Array.isArray(h)&&"object"===("undefined"==typeof h?"undefined":n(h)))return e(h)}var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.type,a=void 0===r?"responseJSON":r,s="server_saver_error";return"responseJSON"===a?this._error&&this._error.responseJSON&&this._error.responseJSON.error.message?this._error.responseJSON.error.message:o("server_saver_error"):"String"===a?"string"==typeof this._error?this._error:e(this._error):o("server_saver_error")},t.exports=s},{"core/i18n/i18n.service":27}],24:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/data/routerservice"),a=e("core/utils/geo"),o=a.convertFeatureToGEOJSON;r["default"]={handleFormInput:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e,t,n,a,s,l,u,c,d,p,f=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},h=f.field,v=f.feature,g=f.qgs_layer_id;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=o(v),t=h.input.options,n=t.key,a=t.value,s=t.layer_id,l=void 0===s?g:s,u=t.filter_expression,c=t.loading,c.state="loading",d=[],r.prev=5,r.next=8,i.getData("expression:expression",{inputs:{layer_id:l,qgs_layer_id:g,form_data:e,formatter:0,expression:u.expression},outputs:!1});case 8:d=r.sent,r.next=13;break;case 11:r.prev=11,r.t0=r["catch"](5);case 13:switch(h.input.type){case"select_autocomplete":for(h.input.options.values=[],p=0;p<d.length;p++)h.input.options.values.push({key:d[p].properties[n],value:d[p].properties[a]});c.state="ready"}case 14:case"end":return r.stop()}},r,this,[[5,11]])}));return e}()}},{"core/data/routerservice":15,"core/utils/geo":89}],25:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/data/routerservice"),a=e("core/utils/geo"),o=a.getFormDataExpressionRequestFromFeature,s=a.convertFeatureToGEOJSON;r["default"]={getVisibility:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){var t,n,a,l=e.qgs_layer_id,u=e.expression,c=e.feature,d=void 0===c?{}:c,p=e.contenttype;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="query"===p?1:0,n="editing"===p?s(d):o(d),e.next=4,i.getData("expression:expression_eval",{inputs:{qgs_layer_id:l,form_data:n,expression:u,formatter:t},outputs:!1});case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}},r,this)}));return e}()}},{"core/data/routerservice":15,"core/utils/geo":89}],26:[function(e,t,r){var n=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=e("core/utils/utils"),a=i.inherit,o=i.noop,s=i.debounce,l=i.throttle,u=function(){this.setters&&this._setupListenersChain(this.setters),this.debounces&&this._setupDebounces(this.debounces),this.throttles&&this._setupThrottles(this.throttles)};a(u,EventEmitter);var c=u.prototype;c.onafter=function(e,t,r){return this._onsetter("after",e,t,!1,r)},c.onceafter=function(e,t,r){return this._onsetter("after",e,t,!1,r,!0)},c.onbefore=function(e,t,r){return this._onsetter("before",e,t,!1,r)},c.oncebefore=function(e,t,r){return this._onsetter("before",e,t,!1,r,!0)},c.onbeforeasync=function(e,t,r){return this._onsetter("before",e,t,!0,r)},c.un=function(e,t){Object.entries(this.settersListeners).forEach(function(r){var i=n(r,2),a=(i[0],i[1]);void 0===t?a[e].splice(0):a[e].forEach(function(r,n){r.key===t&&a[e].splice(n,1)})})},c._onsetter=function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=this.settersListeners[e],s=""+(Math.floor(1e6*Math.random())+Date.now()),l=o[t];return l.push({key:s,fnc:r,async:n,priority:i,once:a}),o[t]=_.sortBy(l,function(e){return e.priority}),s},c._setupListenersChain=function(e){var t=this;this.settersListeners={after:{},before:{}};var r=function(r){var n=e[r],i=o,a=o;_.isFunction(n)?i=n:(i=n.fnc,a=n.fallback||o),t.settersListeners.after[r]=[],t.settersListeners.before[r]=[],t[r]=function(){for(var e=this,t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];var s=$.Deferred(),l=null,u=0,c=function(){l=i.apply(e,n),s.resolve(l);var t=[],a=e.settersListeners.after[r];a.forEach(function(r){r.fnc.apply(e,n),r.once&&t.push(r.key)}),t.forEach(function(t){return e.un(r,t)})},d=function(){a.apply(e,n),s.reject()},p=this.settersListeners.before[r];u=0;var f=function h(t){var i=!0;if(_.isBoolean(t)&&(i=t),i===!1)d.apply(e,n);else if(u===p.length){var a=c();void 0!==a&&a!==!0||e.emitEvent("set:"+r,n)}else if(i){var o=p[u],s=u;if(p[u].async)n.push(h),u+=1,o.fnc.apply(e,n);else{var l=o.fnc.apply(e,n);u+=1,h(l)}o.once&&p.splice(s,1)}};return f(),s.promise()}};for(var n in e)r(n);return this.settersListeners},c._setupDebounces=function(e){for(var t in e){var r=e[t].delay,n=e[t].fnc;this[t]=s(n,r)}},c._setupThrottles=function(e){for(var t in e){var r=e[t].delay,n=e[t].fnc;this[t]=l(n,r)}},c.get=function(e){return!this[e]||this[e]instanceof Function?null:this[e]},c.set=function(e,t){this[e]=t},t.exports=u},{"core/utils/utils":92}],27:[function(e,t,r){function n(e){return e.appLanguages.forEach(function(e){i[e]={plugins:{}}}),i18next.use(i18nextXHRBackend).init({lng:e.lng,ns:"app",fallbackLng:"en",resources:e.resources}),new Promise(function(e,t){jqueryI18next.init(i18next,$,{tName:"t",i18nName:"i18n",handleName:"localize",selectorAttr:"data-i18n",targetAttr:"data-i18n-target",optionsAttr:"data-i18n-options",useOptionsAttr:!1,parseDefaultValueFromContent:!0}),c(i),e()})}var i={},a=function(){var t=e("core/applicationservice"),r=t.getConfig();return r.user.i18n||"en"},o=function(e){return i18next.t(e)},s=function(e){return i18next.t("plugins."+e)},l=function(e){return function(t){return i18next.t(e+"."+t)}},u=function(e){var t=e.name,r=e.config;for(var n in r){var a=i[n];a&&(a.plugins[t]=r[n])}c(i)},c=function(e){for(var t in e){var r=e[t];for(var n in r)i18next.addResource(t,"translation",n,r[n])}},d=function(e){i18next.changeLanguage(e)};t.exports={init:n,t:o,tPlugin:s,tPrefix:l,addI18n:c,addI18nPlugin:u,changeLanguage:d,getAppLanguage:a}},{"core/applicationservice":7}],28:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("services/iframe-plugin"),a=n(i);t.exports=a["default"]},{"services/iframe-plugin":392}],29:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("services/iframe-app"),a=n(i);t.exports=a["default"]},{"services/iframe-app":390}],30:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function i(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this),this.ready=!1,this.init=function(){}}var a=e("core/utils/utils"),o=a.base,s=a.inherit,l=a.createFilterFormField,u=e("core/project/projectsregistry"),c=e("core/data/routerservice"),d=e("gui/gui"),p=e("core/g3wobject");s(i,p);var f=i.prototype;f.mapService=d.getComponent("map").getService(),f.project=u.getCurrentProject(),f.layers=void 0,f.getQgsLayerId=function(e){var t=e.qgs_layer_id,r=e.noValue,n=void 0===r?this.layers.map(function(e){return e.id}):r;return t?Array.isArray(t)?t:[t]:n},f.searchFeature=function(){var e=n(regeneratorRuntime.mark(function t(e){var r,n,i,a,o,s,u=e.layer,d=e.feature;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.project.getSearchEndPoint(),n=d.field,i=d.value,e.next=4,c.getData("search:features",{inputs:{layer:u,search_endpoint:r,filter:l({layer:u,search_endpoint:r,field:n,value:i})},outputs:!1});case 4:return a=e.sent,o=a.data,s=void 0===o?[]:o,e.abrupt("return",s);case 8:case"end":return e.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),f.findFeaturesWithGeometry=n(regeneratorRuntime.mark(function h(){var e,t,r,n,i,a,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=o.qgs_layer_id,l=void 0===s?[]:s,u=o.feature,c=o.zoom,d=void 0!==c&&c,p=o.highlight,f=void 0!==p&&p;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:e={found:!1,features:[],qgs_layer_id:null},t=l.length,r=0;case 3:if(e.found||!(r<t)){o.next=20;break}if(n=this.project.getLayerById(l[r]),o.prev=5,o.t0=n,!o.t0){o.next=11;break}return o.next=10,this.searchFeature({layer:n,feature:u});case 10:o.t0=o.sent;case 11:i=o.t0,i.length?(a=i[0].features,e.found=a.length>0&&!!a.find(function(e){return e.getGeometry()}),e.found?(e.features=a,e.qgs_layer_id=l[r],d&&this.mapService.zoomToFeatures(a,{highlight:f})):r++):r++,o.next=18;break;case 15:o.prev=15,o.t1=o["catch"](5),r++;case 18:o.next=3;break;case 20:return!e.found&&this.mapService.zoomToProjectInitExtent(),o.abrupt("return",e);case 22:case"end":return o.stop()}},h,this,[[5,15]])})),f.setLayers=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];f.layers=e},f.getLayers=function(){return f.layers},f.setReady=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.ready=e},f.getReady=function(){return this.ready},f.stop=n(regeneratorRuntime.mark(function v(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},v,this)})),f.clear=function(){},t.exports=i},{"core/data/routerservice":15,"core/g3wobject":26,"core/project/projectsregistry":83,"core/utils/utils":92,"gui/gui":150}],31:[function(e,t,r){var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=e("./app/service"),a=e("./plugins/index");t.exports=n({app:i},a)},{"./app/service":29,"./plugins/index":33}],32:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("services/iframe-editing"),a=n(i);t.exports=a["default"]},{"services/iframe-editing":391}],33:[function(e,t,r){var n=e("./editing/service");t.exports={editing:n}},{"./editing/service":32}],34:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function i(){o(this),this.pluginName,this.dependencyApi={},this.init=n(regeneratorRuntime.mark(function e(){var t,r=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=i.layers,o=void 0===a?{}:a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.layers=o,l.isPluginInConfiguration(this.pluginName)&&(t=l.getPlugin(this.pluginName),t?(this.setDependencyApi(t.getApi()),this.setReady(!0)):l.onafter("registerPlugin",function(){var e=n(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.isReady();case 2:e.getName()===r.pluginName&&(r.setDependencyApi(e.getApi()),r.setReady(!0));case 3:case"end":return t.stop()}},t,r)}));return function(t){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}},e,this)})),this.clear=function(){}}var a=e("core/utils/utils"),o=a.base,s=a.inherit,l=e("core/plugin/pluginsregistry"),u=e("../baseservice");s(i,u);var c=i.prototype;c.setDependencyApi=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.dependencyApi=e},c.getDependecyApi=function(){return this.dependencyApi},t.exports=i},{"../baseservice":30,"core/plugin/pluginsregistry":80,"core/utils/utils":92}],35:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.config=e,a(this,e,t)}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("core/layers/baselayers/baselayer"),l=e("g3w-ol/layers/bases");o(n,s);var u=n.prototype;u._makeOlLayer=function(){var e=this.config,t=e.url,r=e.attributions,n=e.crs,i=this.getProjectionFromCrs(n),a=l.TMS.get({url:t,source_type:"arcgismapserver",projection:i,attributions:r});return a},t.exports=n},{"core/layers/baselayers/baselayer":36,"core/utils/utils":92,"g3w-ol/layers/bases":131}],36:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(a(this,e,t),this.isWMS()){var r={url:this.getWmsUrl(),id:this.state.id,tiled:this.state.tiled};this._mapLayer=new l(r),this._mapLayer.addLayer(this)}else this._mapLayer=this}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("g3w-ol/projection/projections"),l=e("../map/wmslayer"),u=e("core/layers/imagelayer");o(n,u);var c=n.prototype;c.getProjectionFromCrs=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.epsg=e.epsg?e.epsg:"EPSG:3857",s.get(e)},c._makeOlLayer=function(){},c._registerLoadingEvent=function(){var e=this;this._olLayer.getSource().on("imageloadstart",function(){e.emit("loadstart")}),this._olLayer.getSource().on("imageloadend",function(){e.emit("loadend")})},c.getSource=function(){return this.getOLLayer().getSource()},c.update=function(e,t){this._updateLayer(e,t)},c.getOLLayer=function(){var e=this._olLayer;return e||(e=this._olLayer=this._makeOlLayer(),this._registerLoadingEvent(),this._mapLayer.config.attributions&&this._olLayer.getSource().setAttributions(this._mapLayer.config.attributions),e.setVisible(this._mapLayer.state.visible)),e},c._updateLayer=function(e,t){this.isWMS()&&this._mapLayer.update(e,t)},c.setVisible=function(e){this.getOLLayer().setVisible(e)},c.getMapLayer=function(){return this._mapLayer},t.exports=n},{"../map/wmslayer":63,"core/layers/imagelayer":51,"core/utils/utils":92,"g3w-ol/projection/projections":135}],37:[function(e,t,r){var n={OSM:e("./osmlayer"),Bing:e("./binglayer"),TMS:e("./tmslayer"),ARCGISMAPSERVER:e("./arcgislayer"),WMTS:e("./wmtslayer"),WMS:e("./wmslayer")};t.exports=n},{"./arcgislayer":35,"./binglayer":38,"./osmlayer":39,"./tmslayer":40,"./wmslayer":41,"./wmtslayer":42}],38:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};l(this,e,t)}var a=e("core/applicationstate"),o=n(a),s=e("core/utils/utils"),l=s.base,u=s.inherit,c=e("core/layers/baselayers/baselayer"),d=e("g3w-ol/layers/bases");u(i,c);var p=i.prototype;p._makeOlLayer=function(){var e=void 0,t=o["default"].keys.vendorkeys.bing,r=this.config.source?this.config.source.subtype:null;switch(r){case"streets":e=d.BING.get({imagerySet:"Road",key:t});break;case"aerial":e=d.BING.get({imagerySet:"Aerial",key:t});break;case"aerialwithlabels":e=d.BING.get({imagerySet:"AerialWithLabels",key:t});break;default:e=d.BING.get({imagerySet:"Aerial",key:t})}return e},t.exports=i},{"core/applicationstate":8,"core/layers/baselayers/baselayer":36,"core/utils/utils":92,"g3w-ol/layers/bases":131}],39:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,e,t)}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("core/layers/baselayers/baselayer"),l=e("g3w-ol/layers/bases");a(n,s);var u=n.prototype;u._makeOlLayer=function(){var e=l.OSM.get({id:this.config.name,title:this.config.title,url:this.config.url});return e},t.exports=n},{"core/layers/baselayers/baselayer":36,"core/utils/utils":92,"g3w-ol/layers/bases":131}],40:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.config=e,a(this,e,t)}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("core/layers/baselayers/baselayer"),l=e("g3w-ol/layers/bases");o(n,s);var u=n.prototype;u._makeOlLayer=function(){var e=this.config,t=e.url,r=e.attributions,n=e.minZoom,i=e.maxZoom,a=e.crs,o=this.getProjectionFromCrs(a),s=l.TMS.get({url:t,minZoom:n,maxZoom:i,attributions:r,projection:o});return s},t.exports=n},{"core/layers/baselayers/baselayer":36,"core/utils/utils":92,"g3w-ol/layers/bases":131}],41:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.config=e,o(this,e,t)}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("core/layers/baselayers/baselayer"),l=e("g3w-ol/layers/bases");a(n,s);var u=n.prototype;u._makeOlLayer=function(){var e=this.config,t=e.url,r=e.layers,n=e.singleTile,i=e.attributions,a=e.crs,o=e.opacity,s=this.getProjectionFromCrs(a),u=l.WMS.get({url:t,layers:r,singleTile:n,attributions:i,projection:s,opacity:o});return u},t.exports=n},{"core/layers/baselayers/baselayer":36,"core/utils/utils":92,"g3w-ol/layers/bases":131}],42:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.config=e,a(this,e,t)}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("core/layers/baselayers/baselayer"),l=e("g3w-ol/layers/bases");o(n,s);var u=n.prototype;u._makeOlLayer=function(){var e=this.config,t=e.url,r=e.layer,n=e.attributions,i=e.matrixSet,a=e.format,o=e.style,s=e.requestEncoding,u=e.crs,c=this.getProjectionFromCrs(u),d=l.WMTS.get({url:t,layer:r,attributions:n,format:a,projection:c,requestEncoding:s,matrixSet:i,style:o});return d},t.exports=n},{"core/layers/baselayers/baselayer":36,"core/utils/utils":92,"g3w-ol/layers/bases":131}],43:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("../../../constant"),a=n(i),o=a["default"].GEOMETRY_FIELDS,s=e("core/utils/utils"),l=s.uniqueId,u=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ol.Feature.call(this),this._uid=l(),this._newPrefix="_new_",this._geometry=!1;var r=t.feature,n=t.properties;if(r){n&&Array.isArray(n)?n.forEach(function(t){return e.set(t,r.get(t))}):this.setProperties(r.getProperties()),this.setId(r.getId()),this.setGeometryName(r.getGeometryName());var i=r.getGeometry();this._geometry=!!i,i&&this.setGeometry(i);var a=this.getStyle();a&&this.setStyle(a)}this.state={"new":!1,state:null,visible:!0}};ol.inherits(u,ol.Feature);var c=u.prototype;c.constructor="Feature",c.getUid=function(){return this._uid},c._setUid=function(e){this._uid=e},c.isGeometry=function(){return this._geometry},c.cloneNew=function(){var e=this.clone(),t=l();return e._setUid(t),e.setTemporaryId(),e},c.clone=function(){var e=ol.Feature.prototype.clone.call(this);e.setId(this.getId()),this.isGeometry()&&e.setGeometry(e.getGeometry().clone());var t=new u({feature:e}),r=this.getUid();return t._setUid(r),t.setState(this.getState()),this.isNew()&&t.setNew(),t},c.setTemporaryId=function(){var e=""+this._newPrefix+l();this.setId(e),this.setNew()},c.setNew=function(){this.state["new"]=!0},c["delete"]=function(){return this.state.state="delete",this},c.update=function(){return this.state.state="update",this},c.add=function(){return this.state.state="add",this},c.isNew=function(){return this.state["new"]},c.isAdded=function(){return"add"===this.state.state},c.isUpdated=function(){return"update"===this.state.state},c.isDeleted=function(){return"delete"===this.state.state},c.setFullState=function(e){this.state=e},c.getFullState=function(){return this.state},c.setState=function(e){this.state.state=e},c.getState=function(){return this.state.state},c.getAlphanumericProperties=function(){var e=this.getProperties(),t={};for(var r in e)o.indexOf(r)===-1&&(t[r]=e[r]);return t},c.clearState=function(){this.state.state=null,this.state["new"]=!1},c.isVisible=function(){return this.state.visible},c.setVisible=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.state.visible=e},t.exports=u},{"../../../constant":5,"core/utils/utils":92}],44:[function(e,t,r){function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._features=e.features||[],this._provider=e.provider||null,this._loadedIds=[],this._lockIds=[],this.setters={addFeatures:function(e){var t=this;e.forEach(function(e){t._addFeature(e)})},addFeature:function(e){this._addFeature(e)},removeFeature:function(e){this._removeFeature(e)},updateFeature:function(e){this._updateFeature(e)},clear:function(){this._clearFeatures()},getFeatures:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._getFeatures(e)},commit:function(e,t){return this._commit(e,t)}},s(this)}var a=e("core/utils/utils"),o=a.inherit,s=a.base,l=e("core/g3wobject");o(i,l);var u=i.prototype;u.clone=function(){return _.cloneDeep(this)},u.setProvider=function(e){this._provider=e},u.getProvider=function(){return this._provider},u.unlock=function(){var e=$.Deferred();return this._provider.unlock().then(function(t){return e.resolve(t)}).fail(function(t){return e.reject(t)}),e.promise()},u._getFeatures=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred();return this._provider?this._provider.getFeatures(t).then(function(t){var n=e._filterFeaturesResponse(t);e.addFeatures(n),r.resolve(n)}).fail(function(e){return r.reject(e)}):r.resolve(this._readFeatures()),r.promise()},u._filterFeaturesResponse=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.features,n=void 0===r?[]:r,i=t.featurelocks,a=void 0===i?[]:i,o=n.filter(function(t){var r=t.getId(),n=e._loadedIds.indexOf(r)!==-1;return n||e._loadedIds.push(r),!n});return this._filterLockIds(a),o},u._filterLockIds=function(e){var t=this._lockIds.map(function(e){return e.featureid}),r=e.filter(function(e){return t.indexOf(e.featureid)===-1});this._lockIds=[].concat(n(this._lockIds),n(r))},u.addLoadedIds=function(e){this._loadedIds.push(e)},u.getLockIds=function(){return this._lockIds},u.addLockIds=function(e){var t=this;this._lockIds=_.union(this._lockIds,e),this._lockIds.forEach(function(e){return t._loadedIds.push(e.featureid)})},u._readFeatures=function(){return this._features},u._commit=function(e){var t=$.Deferred();return e&&this._provider?(e.lockids=this._lockIds,this._provider.commit(e).then(function(e){return t.resolve(e)}).fail(function(e){return t.reject(e)})):t.reject(),t.promise()},u.getFeatureById=function(e){return this._features.find(function(t){return t.getId()==e})},u.getFeatureByUid=function(e){return this._features.find(function(t){return t.getUid()===e})},u._addFeature=function(e){this._features.push(e)},u._updateFeature=function(e){var t=this;this._features.find(function(r,n){if(r.getUid()===e.getUid())return t._features[n]=e,!0})},u.setFeatures=function(e){this._features=e},u._removeFeature=function(e){this._features=this._features.filter(function(t){return e.getUid()!==t.getUid()})},u._clearFeatures=function(){this._features=null,this._features=[],this._lockIds=[],this._loadedIds=[]},u.getDataProvider=function(){return this._provider},u.readFeatures=function(){return this._features},t.exports=i},{"core/g3wobject":26,"core/utils/utils":92}],45:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this._features=e.features||new ol.Collection([])}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("./featuresstore");a(n,s);var l=n.prototype;l.getLength=function(){return this._features.getLength()},l.setFeatures=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach(function(t){return e._features.push(t)})},l.readFeatures=function(){return this._features.getArray()},l.getFeaturesCollection=function(){return this._features},l.getFeatureById=function(e){return this._features.getArray().find(function(t){return t.getId()==e})},l.getFeatureByUid=function(e){return this._features.getArray().find(function(t){return t.getUid()===e})},l._addFeature=function(e){this._features.push(e),this._features.dispatchEvent("change")},l._updateFeature=function(e){for(var t=-1,r=this._features.getArray(),n=0;r.length;n++){var i=r[n];if(i.getUid()===e.getUid()){t=n;break}}t>=0&&(this._features.removeAt(t),this._features.insertAt(t,e),this._features.dispatchEvent("change"))},l._removeFeature=function(e){for(var t=this._features.getArray(),r=0;r<t.length;r++){var n=t[r];if(e.getUid()===n.getUid()){this._features.removeAt(r);break}}this._features.dispatchEvent("change")},l._clearFeatures=function(){try{this._features.clear()}catch(e){}this._features=null,this._features=new ol.Collection([])},t.exports=n},{"./featuresstore":44,"core/utils/utils":92}],46:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._layerName=e.layerName;var t=e.filter;this._expression=t&&t||""}var i=e("./operators"),a=n.prototype;a.and=function(e,t){return this._expression=this._expression?this._expression+" AND ":this._expression,e&&t&&this.eq(e,t),this},a.or=function(){return field&&value&&(this._expression=this._expression?this._expression+" OR ":this._expression,this.eq(field,value)),this},a.eq=function(e,t){return this._expression=this._expression+this._build("eq",e,t),this},a.like=function(e,t){return this._expression=this._expression+this._build("LIKE",e,t),this},a.ilike=function(e,t){return this._expression=this._expression+this._build("ILIKE",e,t),this},a.not=function(e,t){return this._expression=this._expression+this._build("NOT",e,t),this},a.gt=function(e,t){return this._expression=this._expression+this._build("gt",e,t),this},a.gte=function(e,t){return this._expression=this._expression+this._build("gte",e,t),this},a.lt=function(e,t){return this._expression=this._expression+this._build("lt",e,t),this},a.lte=function(e,t){return this._expression=this._expression+this._build("lte",e,t),this},a.clear=function(){return this._expression="",this},a.get=function(){return this._layerName?this._layerName+": "+this._expression:this._expression},a._build=function(e,t,r){return['"'+t+'"',i.EXPRESSION_OPERATORS[e],""+r].join(" ")},a.createSingleExpressionElement=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.value,r=e.attribute,n=e.operator,a=e.logicop,o=void 0,s="LIKE"===n||"ILIKE"===n?"%":"",l=i.EXPRESSION_OPERATORS[n],u=a&&" "+a+" "||"";if("IN"===n){var c=Array.isArray(t)?t:[t],d="( "+c.map(function(e){return"'"+e+"'"}).join(",").replace(/,/g," , ")+" )";o='"'+r+'" '+l+" "+d+u}else if(null!==t&&void 0!==t&&!Number.isNaN(t)&&t.toString().trim()){var p="number"!=typeof t?t.split("'"):[];if(p.length>1){for(var f=[],h=0;h<p.length;h++){var v=p[h];if(v){var g="ILIKE",m=("%"+v+"%").trim(),y='"'+r+'" '+g+" '"+m+"'";f.push(y)}}o=""+f.join(" AND ")+u}else o='"'+r+'" '+l+" '"+s+t+s+"'"+u}return o;
},a.createExpressionFromFilterObject=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=[],n=void 0;for(var a in t){n=i.EXPRESSION_OPERATORS[a];var o=t[a];o.forEach(function(t){for(var n in t){var i=t[n];if(Array.isArray(i))e.createExpressionFromFilterObject(t);else{var a=t[n];for(var o in a){var s=a[o],l=e.createSingleExpressionElement({value:s,operator:n,attribute:o});r.push(l)}}}}),n=r.length>0&&r.join(" "+n+" ")}return n},a.createExpressionFromField=function(e){var t=e.layerName,r=e.field,n=e.value,i=e.operator,a=void 0===i?"eq":i,o=this.createSingleExpressionElement({attribute:r,value:n,operator:a});return this._expression=t+":"+o,this},a.createExpressionFromFilterArray=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r="",n=t.length?t.length-1:t.length;return t.forEach(function(t,i){var a=e.createSingleExpressionElement(t);r=""+r+(t.logicop&&i===n?a.substring(0,a.length-(t.logicop.length+1)):a)}),r||void 0},a.createExpressionFromFilter=function(e,t){var r=Array.isArray(e)?this.createExpressionFromFilterArray(e):this.createExpressionFromFilterObject(e);return r&&(this._expression=t+":"+r),this},t.exports=n},{"./operators":48}],47:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._filter=null,this._type=null,this.config=e}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=n.prototype;a.getConfig=function(){return this.config},a.setConfig=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config=e},a.mergeConfig=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config=i({},this.config,e)},a.getAll=function(){this._type=n.TYPES.all,this._filter=null},a.setExpression=function(e){this._type=n.TYPES.expression,this._filter=e},a.setGeometry=function(e){return this._type=n.TYPES.geometry,this._filter=e,this},a.setBBOX=function(e){return this._type=n.TYPES.bbox,this._filter=e,this},a.setFids=function(e){return this._type=n.TYPES.fids,this._filter=e,this},a.serialize=function(){return JSON.stringify(this)},a.get=function(){return this._filter},a.getType=function(){return this._type},a.clear=function(){this._filter=null},n.TYPES={bbox:"bbox",geometry:"geometry",expression:"expression",fids:"fids",all:"all"},t.exports=n},{}],48:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=r.OPERATORS={gte:">=",lte:"<=",NOT:"!=",eq:"=",gt:">",lt:"<",IN:"IN","NOT IN":"NOT IN",LIKE:"LIKE",ILIKE:"ILIKE",AND:"AND",OR:"OR"};r.EXPRESSION_OPERATORS=n({lte:"<=",ltgt:"!=",ilike:"ILIKE",like:"LIKE"},i)},{}],49:[function(e,t,r){function n(e,t){a(this,e,t),this.config.style=e.style,this.setup(e)}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("./vectorlayer"),l=e("./map/geojson");o(n,s);var u=n.prototype;u.getMapLayer=function(){if(this._mapLayer)return this._mapLayer;var e=this.get("source").url,t=this.getName(),r=this.getId(),n=this.get("style"),i=this.getProvider("data"),a={url:e,projection:this.getProjection().getCode(),id:r,name:t,style:n,provider:i};return this._mapLayer=new l(a),this._mapLayer},t.exports=n},{"./map/geojson":60,"./vectorlayer":75,"core/utils/utils":92}],50:[function(e,t,r){function n(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}}var i=e("g3w-ol/projection/projections"),a=e("core/utils/ol"),o=a.getScaleFromResolution,s=e("core/utils/utils"),l=s.sanitizeUrl,u=e("core/utils/geo"),c=u.createFeatureFromGeometry,d=e("gui/gui"),p={wms:["VERSION","REQUEST","BBOX","LAYERS","WIDTH","HEIGHT","DPI","FORMAT","CRS"]},f=n.prototype;f.setup=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.config){var r=t.project;this.config.map_crs=r.getProjection().getCode(),this.config.multilayerid=e.multilayer,this.olSelectionFeatures={},_.extend(this.state,{geolayer:"NoGeometry"!==e.geometrytype,legend:{url:null,loading:!1,error:!1,show:!0},external:e.source&&e.source.external||!1,bbox:e.bbox||null,visible:e.visible||!1,checked:e.visible||!1,epsg:e.crs.epsg,hidden:e.hidden||!1,scalebasedvisibility:e.scalebasedvisibility||!1,minscale:e.minscale,maxscale:e.maxscale,ows_method:e.ows_method,exclude_from_legend:"boolean"!=typeof e.exclude_from_legend||e.exclude_from_legend}),e.projection&&(this.config.projection=e.projection.getCode()===e.crs.epsg?e.projection:i.get(e.crs)),e.attributions&&(this.config.attributions=e.attributions),e.source&&e.source.url&&this._sanitizeSourceUrl()}},f.clearOlSelectionFeatures=function(){this.olSelectionFeatures=null},f.getOlSelectionFeature=function(e){return this.olSelectionFeatures[e]},f.updateOlSelectionFeature=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.geometry,n=this.getOlSelectionFeature(t);if(n){r=new ol.geom[r.type](r.coordinates);var i=n.feature;i.__layerId=this.getId();var a=d.getService("map");i.setGeometry(r),a.setSelectionFeatures("update",{feature:i})}},f.deleteOlSelectionFeature=function(e){var t=this.olSelectionFeatures[e];t&&(mapService.setSelectionFeatures("remove",{feature:t.feature}),delete this.olSelectionFeatures[e])},f.getOlSelectionFeatures=function(){return this.olSelectionFeatures},f.addOlSelectionFeature=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.geometry;return this.olSelectionFeatures[t]=this.olSelectionFeatures[t]||{feature:c({id:t,geometry:r}),added:!1},this.olSelectionFeatures[t]},f.showAllOlSelectionFeatures=function(){var e=d.getService("map");Object.values(this.olSelectionFeatures).forEach(function(t){!t.added&&e.setSelectionFeatures("add",{feature:t.feature}),t.added=!0})},f.setInversionOlSelectionFeatures=function(){var e=d.getComponent("map").getService();Object.values(this.olSelectionFeatures).forEach(function(t){e.setSelectionFeatures(t.added?"remove":"add",{feature:t.feature}),t.added=!t.added})},f.setOlSelectionFeatureByFid=function(e,t){var r=this.olSelectionFeatures[e]&&this.olSelectionFeatures[e].feature;return r&&this.setOlSelectionFeatures({id:e,feature:r},t)},f.setOlSelectionFeatures=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"add",r=d.getComponent("map").getService();if(e){var n=this.olSelectionFeatures[e.id]||this.addOlSelectionFeature(e);"add"===t?n.added||(n.feature.__layerId=this.getId(),r.setSelectionFeatures(t,{feature:n.feature}),n.added=!0):(r.setSelectionFeatures(t,{feature:n.feature}),n.added=!1)}else Object.values(this.olSelectionFeatures).forEach(function(e){e.added&&r.setSelectionFeatures("remove",{feature:e.feature}),e.added=!1});return!Object.values(this.olSelectionFeatures).find(function(e){return e.added})},f._sanitizeSourceUrl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"wms",t=l({url:this.config.source.url,reserverParameters:p[e]});this.config.source.url=t},f.isLayerCheckedAndAllParents=function(){var e=this.isChecked();if(e)for(var t=this.state.parentGroup;e&&t;)e=e&&t.checked,t=t.parentGroup;return e},f.setChecked=function(e){this.state.checked=e},f.isChecked=function(){return this.state.checked},f.setVisible=function(e){var t=this.state.visible;this.state.visible=e&&this.isChecked();var r=t!==this.state.visible;return r&&this.change(),this.state.visible},f.isVisible=function(){return this.state.visible},f.isDisabled=function(){return this.state.disabled},f.isPrintable=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.scale;return this.isLayerCheckedAndAllParents()&&(!this.state.scalebasedvisibility||t>=this.state.maxscale&&t<=this.state.minscale)},f.getStyles=function(){return this.config.source.external?this.config.source.styles:this.config.styles},f.getStyle=function(){return this.config.source.external?this.config.source.styles:this.config.styles?this.config.styles.find(function(e){return e.current}).name:""},f.setCurrentStyle=function(e){var t=!1;return this.config.styles.forEach(function(r){r.name===e&&(t=!r.current),r.current=r.name===e}),t},f.setDisabled=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"m";if(this.state.scalebasedvisibility){var r=o(e,t);this.state.disabled=!(r>=this.state.maxscale&&r<=this.state.minscale),this.state.disabled=0===this.state.minscale?!(r>=this.state.maxscale):this.state.disabled;for(var n=!0,i=this.state.parentGroup;i;)n=n&&i.checked,i=i.parentGroup;n&&this.setVisible(!this.state.disabled),this.isFilterable()&&this.setTocHighlightable(!this.state.disabled)}else this.state.disabled=!1},f.getMultiLayerId=function(){return this.config.multilayerid},f.getGeometryType=function(){return this.config.geometrytype},f.getOwsMethod=function(){return this.config.ows_method},f.setProjection=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config.projection=i.get(e)},f.getProjection=function(){return this.config.projection},f.getEpsg=function(){return this.config.crs.epsg},f.getCrs=function(){return this.config.projection&&this.config.projection.getCode()||null},f.getMapCrs=function(){return this.config.map_crs},f.isCached=function(){return this.config.cache_url&&""!==this.config.cache_url},f.getCacheUrl=function(){if(this.isCached())return this.config.cache_url},f.hasAxisInverted=function(){var e=this.getProjection(),t=e.getAxisOrientation?e.getAxisOrientation():"enu";return"ne"===t.substr(0,2)},f.getMapLayer=function(){},f.setMapProjection=function(e){this._mapProjection=e},f.getMapProjection=function(){return this._mapProjection},t.exports=n},{"core/utils/geo":89,"core/utils/ol":90,"core/utils/utils":92,"g3w-ol/projection/projections":135,"gui/gui":150}],51:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setters={change:function(){}},s(this,e,t),this.config.baselayer=e.baselayer||!1,this.type=c.LayerTypes.IMAGE,this.legendUrl=null,this.customParams={},this.setup(e,t)}var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("core/utils/utils"),s=o.base,l=o.inherit,u=o.mixin,c=e("core/layers/layer"),d=e("./vectorlayer"),p=e("./map/wmslayer"),f=e("./map/wmstlayer"),h=e("./map/arcgismapserverlayer"),v=e("./map/xyzlayer"),g=e("./legend/legendservice"),m=e("./geolayermixin");l(i,c),u(i,m);var y=i.prototype;y.getLayerForEditing=n(regeneratorRuntime.mark(function _(){var t,r,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=i.force,o=void 0!==a&&a,s=i.vectorurl,l=i.project_type;i.project;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!this.isEditable()&&!o){i.next=16;break}return t=t||e("core/project/projectsregistry").getCurrentProject(),r=new d(this.config,{vectorurl:s,project_type:l,project:t}),i.prev=3,i.next=6,r.layerForEditing;case 6:return n=i.sent,this.setEditingLayer(n),i.abrupt("return",n);case 11:return i.prev=11,i.t0=i["catch"](3),i.abrupt("return",Promise.reject(i.t0));case 14:i.next=17;break;case 16:return i.abrupt("return",null);case 17:case"end":return i.stop()}},_,this,[[3,11]])})),y.isBaseLayer=function(){return this.config.baselayer},y.isWMS=function(){return i.WMSServerTypes.indexOf(this.config.servertype)>-1},y.isLayerProjectionASMapProjection=function(){return this.config.crs.epsg===this.config.map_crs},y.getCrs=function(){return this.config.crs.epsg},y.isExternalWMS=function(){return!!(this.config.source&&this.config.source.external&&this.config.source.url)},y.isArcgisMapserver=function(){return this.isExternalWMS()&&this.config.source.type===c.SourceTypes.ARCGISMAPSERVER},y._getBaseLayerName=function(){return this.isWmsUseLayerIds()?this.getId():this.getName()},y.getWMSLayerName=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=void 0===t?"map":t,n="map"!==r||this.isExternalWMS()&&this.isLayerProjectionASMapProjection(),i=this._getBaseLayerName();return n&&this.config.source&&("legend"===r||this.config.source.external)&&(this.config.source.layers||this.config.source.layer)&&(i=this.config.source.layers||this.config.source.layer),i},y.getWFSLayerName=function(){return this.getQueryLayerName().replace(/[/\s]/g,"_")},y.useProxy=function(){return this.isExternalWMS()&&this.isLayerProjectionASMapProjection()&&this.getInfoFormats()},y.getWMSInfoLayerName=function(){return this.isExternalWMS()&&this.isLayerProjectionASMapProjection()&&this.getInfoFormats()?this.getSource().layers:this._getBaseLayerName()},y.getPrintLayerName=function(){return this.isWmsUseLayerIds()?this.getId():this.getName()},y.getStringBBox=function(){var e=this.config.bbox;return e.minx+","+e.miny+","+e.maxx+","+e.maxy},y.isWfsActive=function(){return Array.isArray(this.config.ows)&&void 0!==this.config.ows.find(function(e){return"WFS"===e})},y.getFullWmsUrl=function(){var t=e("core/project/projectsregistry"),r=t.getCurrentProject().getState().metadata.wms_url;return this.isExternalWMS()||!r?this.getWmsUrl():r},y.getCatalogWmsUrl=function(){var t=e("core/project/projectsregistry"),r=t.getCurrentProject().getMetadata().wms_url,n=this.isExternalWMS()||!r?this.getWmsUrl()+"?service=WMS&version=1.3.0&request=GetCapabilities":r;return n},y.getCatalogWfsUrl=function(){return this.getWfsUrl()+"?service=WFS&version=1.1.0&request=GetCapabilities"},y.getWmsUrl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=void 0===t?"map":t,n="map"!==r||this.isExternalWMS()&&this.isLayerProjectionASMapProjection(),i=n&&this.config.source&&("legend"===r||this.config.source.external)&&("wms"===this.config.source.type||"wmst"===this.config.source.type)&&this.config.source.url?this.config.source.url:this.config.wmsUrl;return i},y.getWfsUrl=function(){var t=e("core/project/projectsregistry");return t.getCurrentProject().getMetadata().wms_url||this.config.wmsUrl},y.getQueryUrl=function(){var e=s(this,"getQueryUrl");return this.getServerType()===c.ServerTypes.QGIS&&this.isExternalWMS()&&this.isLayerProjectionASMapProjection()&&(e=this.getInfoFormats()?this.getSource().url:e+"SOURCE="+this.config.source.type),e},y.getIconUrlFromLegend=function(){return this.getLegendUrl({layertitle:!1})},y.getLegendUrl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.legendUrl=g.get({layer:this,params:a({},e,this.customParams)}),this.legendUrl},y.setMapParamstoLegendUrl=function(e){var t=e.bbox,r=e.crs;this.customParams=a({},this.customParams,{bbox:t,crs:r})},y.getWfsCapabilities=function(){return this.config.wfscapabilities||1===this.config.capabilities},y.getMapLayer=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments[1],n=e("core/applicationservice"),i=n.isIframe()&&!this.isExternalWMS();t.iframe_internal=i;var o=void 0,s=this.isExternalWMS()?"GET":this.getOwsMethod();return this.isCached()?(t.extent=this.config.bbox?[this.config.bbox.minx,this.config.bbox.miny,this.config.bbox.maxx,this.config.bbox.maxy]:null,o=new v(t,s)):this.isExternalWMS()&&this.config.source&&this.config.source.type===c.SourceTypes.ARCGISMAPSERVER?(t=a({},t,this.config.source),o=new h(t,r)):(t.url=t.url||this.getWmsUrl(),o=this.isExternalWMS()&&this.config.source&&this.config.source.type===c.SourceTypes.WMST?new f(t,r,s):new p(t,r,s)),o},i.WMSServerTypes=[c.ServerTypes.QGIS,c.ServerTypes.Mapserver,c.ServerTypes.Geoserver,c.ServerTypes.OGC],t.exports=i},{"./geolayermixin":50,"./legend/legendservice":57,"./map/arcgismapserverlayer":59,"./map/wmslayer":63,"./map/wmstlayer":64,"./map/xyzlayer":65,"./vectorlayer":75,"core/applicationservice":7,"core/layers/layer":52,"core/project/projectsregistry":83,"core/utils/utils":92}],52:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e("core/project/projectsregistry");this.config=t,t.id=t.id||"Layer",t.title=t.title||t.name,t.download=!!t.download,t.geolayer=!1,t.baselayer=!!t.baselayer,t.fields=t.fields||{},t.urls=o({query:t.infourl&&""!==t.infourl?t.infourl:t.wmsUrl},t.urls||{});var i=r.project,a=void 0===i?n.getCurrentProject():i;this.config.search_endpoint=a.getSearchEndPoint();var s=a.getRelations();if(this._relations=this._createRelations(s),!this.isBaseLayer()){var l=a.getType(),u=a.getId(),c=l+"/"+u+"/"+t.id+"/",d=a.getVectorUrl(),p=a.getRasterUrl();this.config.urls.filtertoken=d+"filtertoken/"+c,this.config.urls.data=d+"data/"+c,this.config.urls.shp=d+"shp/"+c,this.config.urls.csv=d+"csv/"+c,this.config.urls.xls=d+"xls/"+c,this.config.urls.gpx=d+"gpx/"+c,this.config.urls.gpkg=d+"gpkg/"+c,this.config.urls.geotiff=p+"geotiff/"+c,this.config.urls.editing=d+"editing/"+c,this.config.urls.commit=d+"commit/"+c,this.config.urls.config=d+"config/"+c,this.config.urls.unlock=d+"unlock/"+c,this.config.urls.widget={unique:d+"widget/unique/data/"+c},this.config.searchParams={I:0,J:0}}var f=t.styles&&t.styles.find(function(e){return e.current}).name;this.state={id:t.id,title:t.title,selected:t.selected||!1,disabled:t.disabled||!1,metadata:t.metadata,metadata_querable:!this.isBaseLayer()&&this.isQueryable({onMap:!1}),openattributetable:!this.isBaseLayer()&&this.canShowTable(),removable:t.removable||!1,downloadable:this.isDownloadable(),source:t.source,styles:t.styles,defaultstyle:f,inediting:!1,infoformat:this.getInfoFormat(),infoformats:this.config.infoformats||[],projectLayer:!0,geolayer:!1,selection:{active:!1},filter:{active:!1},attributetable:{pageLength:null},visible:t.visible||!1,tochighlightable:!1},this.selectionFids=new Set,this._layersstore=t.layersstore||null;var v=this.config.servertype,g=this.config.source?this.config.source.type:null;v&&g&&(this.providers={query:w.build("query",v,g,{layer:this}),filter:w.build("filter",v,g,{layer:this}),filtertoken:w.build("filtertoken",v,g,{layer:this}),search:w.build("search",v,g,{layer:this}),data:w.build("data",v,g,{layer:this})}),this.proxyData={wms:null},h(this)}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=e("core/applicationstate"),l=n(s),u=e("./../../constant"),c=e("core/i18n/i18n.service"),d=c.t,p=e("core/utils/utils"),f=p.inherit,h=p.base,v=p.XHR,g=e("core/g3wobject"),m=e("core/utils/geo"),y=m.geometryFields,_=m.parseAttributes,b=e("core/relations/relations"),w=e("core/layers/providers/providersfactory");f(a,g);var x=a.prototype;x.getProxyData=function(e){return e?this.proxyData[e]:this.proxyData},x.setProxyData=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.proxyData[e]=t},x.clearProxyData=function(e){this.proxyData[e]=null},x.getDataProxyFromServer=i(regeneratorRuntime.mark(function S(){var t,r,n,i,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"wms",o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t=e("core/data/routerservice"),s.prev=1,s.next=4,t.getData("proxy:"+a,{inputs:o,outputs:!1});case 4:return r=s.sent,n=r.response,i=r.data,this.setProxyData(a,JSON.parse(i)),s.abrupt("return",n);case 11:return s.prev=11,s.t0=s["catch"](1),s.abrupt("return");case 14:case"end":return s.stop()}},S,this,[[1,11]])})),x.changeProxyDataAndReloadFromServer=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"wms",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(r).forEach(function(n){Object.keys(r[n]).forEach(function(i){var a=r[n][i];e.proxyData[t][n][i]=a})}),this.getDataProxyFromServer(t,this.proxyData[t])},x.isInEditing=function(){return this.state.inediting},x.setInEditing=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state.inediting=e},x.getSearchParams=function(){return this.config.searchParams},x.getSearchEndPoint=function(){return this.getType()!==a.LayerTypes.TABLE?this.config.search_endpoint:"api"},x._createRelations=function(e){var t=this.getId(),r=e.filter(function(e){return[e.referencedLayer,e.referencingLayer].indexOf(t)!==-1});return new b({relations:r})},x.getRelations=function(){return this._relations},x.getRelationById=function(e){return this._relations.getArray().find(function(t){return t.getId()===e})},x.getRelationAttributes=function(e){var t=this._relations.find(function(t){return t.name===e});return t?t.fields:[]},x.getRelationsAttributes=function(){var e={};return this.state.relations.forEach(function(t){return e[t.name]=t.fields}),e},x.isChild=function(){return!!this.getRelations()&&this._relations.isChild(this.getId())},x.isFather=function(){return!!this.getRelations()&&this._relations.isFather(this.getId())},x.getChildren=function(){return this.isFather()?this._relations.getChildren(this.getId()):[]},x.getFathers=function(){return this.isChild()?this._relations.getFathers(this.getId()):[]},x.hasChildren=function(){return!!this.hasRelations()&&this._relations.hasChildren(this.getId())},x.hasFathers=function(){return!!this.hasRelations()&&this._relations.hasFathers(this.getId())},x.hasRelations=function(){return!!this._relations},x.setAttributeTablePageLength=function(e){this.state.attributetable.pageLength=e},x.getAttributeTablePageLength=function(){return this.state.attributetable.pageLength},x.setFilter=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state.filter.active=e},x.getFilterActive=function(){return this.state.filter.active},x.toggleFilterToken=i(regeneratorRuntime.mark(function C(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.filter.active=!this.state.filter.active,e.next=3,this.activeFilterToken(this.state.filter.active);case 3:return e.abrupt("return",this.state.filter.active);case 4:case"end":return e.stop()}},C,this)})),x.activeFilterToken=function(){var e=i(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e;case 2:if(!t.sent){t.next=6;break}this.createFilterToken(),t.next=7;break;case 6:this.deleteFilterToken();case 7:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),x.deleteFilterToken=i(regeneratorRuntime.mark(function L(){var t;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t=e("core/applicationservice"),!this.providers.filtertoken){r.next=12;break}return r.prev=2,r.next=5,this.providers.filtertoken.deleteFilterToken();case 5:t.setFilterToken(null),this.emit("filtertokenchange",{layerId:this.getId()}),r.next=12;break;case 9:r.prev=9,r.t0=r["catch"](2);case 12:case"end":return r.stop()}},L,this,[[2,9]])})),x.createFilterToken=i(regeneratorRuntime.mark(function k(){var t,r,n;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(t=e("core/applicationservice"),!this.providers.filtertoken){i.next=22;break}if(r=null,i.prev=3,!(this.selectionFids.size>0)){i.next=17;break}if(!this.selectionFids.has(a.SELECTION_STATE.ALL)){i.next=10;break}return i.next=8,this.providers.filtertoken.deleteFilterToken();case 8:i.next=15;break;case 10:return n={},this.selectionFids.has(a.SELECTION_STATE.EXCLUDE)?n.fidsout=Array.from(this.selectionFids).filter(function(e){return e!==a.SELECTION_STATE.EXCLUDE}).join(","):n.fidsin=Array.from(this.selectionFids).join(","),i.next=14,this.providers.filtertoken.getFilterToken(n);case 14:r=i.sent;case 15:t.setFilterToken(r),this.emit("filtertokenchange",{layerId:this.getId()});case 17:i.next=22;break;case 19:i.prev=19,i.t0=i["catch"](3);case 22:case"end":return i.stop()}},k,this,[[3,19]])})),x.setSelectionFidsAll=function(){this.selectionFids.clear(),this.selectionFids.add(a.SELECTION_STATE.ALL),this.isGeoLayer()&&this.showAllOlSelectionFeatures(),this.setSelection(!0),this.state.filter.active&&this.createFilterToken()},x.getSelectionFids=function(){return this.selectionFids},x.invertSelectionFids=function(){this.selectionFids.has(a.SELECTION_STATE.EXCLUDE)?this.selectionFids["delete"](a.SELECTION_STATE.EXCLUDE):this.selectionFids.has(a.SELECTION_STATE.ALL)?this.selectionFids["delete"](a.SELECTION_STATE.ALL):this.selectionFids.size>0&&this.selectionFids.add(a.SELECTION_STATE.EXCLUDE),this.isGeoLayer()&&this.setInversionOlSelectionFeatures(),this.state.filter.active&&this.createFilterToken(),this.setSelection(this.selectionFids.size>0)},x.hasSelectionFid=function(e){return!!this.selectionFids.has(a.SELECTION_STATE.ALL)||(this.selectionFids.has(a.SELECTION_STATE.EXCLUDE)?!this.selectionFids.has(e):this.selectionFids.has(e))},x.includeSelectionFid=function(){var e=i(regeneratorRuntime.mark(function t(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.selectionFids.has(a.SELECTION_STATE.EXCLUDE)&&this.selectionFids.has(e)?(this.selectionFids["delete"](e),1===this.selectionFids.size&&this.setSelectionFidsAll()):(this.selectionFids.add(e),!this.isSelectionActive()&&this.setSelection(!0)),this.isGeoLayer()&&this.setOlSelectionFeatureByFid(e,"add"),t.t0=r&&this.state.filter.active,!t.t0){t.next=6;break}return t.next=6,this.createFilterToken();case 6:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),x.includeSelectionFids=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach(function(t){return e.includeSelectionFid(t)})},x.excludeSelectionFid=function(){var e=i(regeneratorRuntime.mark(function t(e){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((this.selectionFids.has(a.SELECTION_STATE.ALL)||0===this.selectionFids.size)&&(this.selectionFids.clear(),this.selectionFids.add(a.SELECTION_STATE.EXCLUDE)),this.selectionFids[this.selectionFids.has(a.SELECTION_STATE.EXCLUDE)?"add":"delete"](e),1===this.selectionFids.size&&this.selectionFids.has(a.SELECTION_STATE.EXCLUDE)&&this.setselectionFidsAll(),r=this.isGeoLayer()&&this.setOlSelectionFeatureByFid(e,"remove"),t.t0=this.state.filter.active,!t.t0){t.next=8;break}return t.next=8,this.createFilterToken();case 8:(0===this.selectionFids.size||r)&&(this.selectionFids.clear(),this.setSelection(!1));case 9:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),x.excludeSelectionFids=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach(function(t){return e.excludeSelectionFid(t)})},x.clearSelectionFids=function(){this.selectionFids.clear(),this.isGeoLayer()&&this.setOlSelectionFeatures(),this.setSelection(!1)},x.getWMSLayerName=function(){return this.isWmsUseLayerIds()?this.getId():this.getName()},x.isWmsUseLayerIds=function(){return this.config.wms_use_layer_ids},x.getFilterToken=function(){var t=e("core/applicationservice");return t.getFilterToken()},x.getDownloadFilefromDownloadDataType=function(e,t){var r=t.data,n=void 0===r?{}:r,i=t.options,a=void 0;switch(n.filtertoken=this.getFilterToken(),e){case"shapefile":a=this.getShp({data:n,options:i});break;case"xls":a=this.getXls({data:n,options:i});break;case"csv":a=this.getCsv({data:n,options:i});break;case"gpx":a=this.getGpx({data:n,options:i});break;case"gpkg":a=this.getGpkg({data:n,options:i});break;case"geotiff":this.getGeoTIFF({data:n,options:i})}return a},x.getGeoTIFF=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data,r=void 0===t?{}:t;r.filtertoken=this.getFilterToken();var n=this.getUrl("geotiff");return v.fileDownload({url:n,data:r,httpMethod:"POST"})},x.getXls=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data,r=void 0===t?{}:t;r.filtertoken=this.getFilterToken();var n=this.getUrl("xls");return v.fileDownload({url:n,data:r,httpMethod:"POST"})},x.getShp=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data,r=void 0===t?{}:t;r.filtertoken=this.getFilterToken();var n=this.getUrl("shp");return v.fileDownload({url:n,data:r,httpMethod:"POST"})},x.getGpx=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data,r=void 0===t?{}:t;r.filtertoken=this.getFilterToken();var n=this.getUrl("gpx");return v.fileDownload({url:n,data:r,httpMethod:"POST"})},x.getGpkg=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data,r=void 0===t?{}:t;r.filtertoken=this.getFilterToken();var n=this.getUrl("gpkg");return v.fileDownload({url:n,data:r,httpMethod:"POST"})},x.getCsv=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data,r=void 0===t?{}:t;r.filtertoken=this.getFilterToken();var n=this.getUrl("csv");return v.fileDownload({url:n,data:r,httpMethod:"POST"})},x.getSourceType=function(){return this.config.source?this.config.source.type:null},x.isGeoLayer=function(){return this.state.geolayer},x.getDataTable=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.page,n=void 0===r?null:r,i=t.page_size,a=void 0===i?null:i,s=t.ordering,u=void 0===s?null:s,c=t.search,d=void 0===c?null:c,p=t.field,f=t.suggest,h=void 0===f?null:f,v=t.formatter,g=void 0===v?0:v,m=t.in_bbox,y=t.custom_params,b=void 0===y?{}:y,w=$.Deferred(),x=void 0,S=o({},b,{field:p,page:n,page_size:a,ordering:u,search:d,formatter:g,suggest:h,in_bbox:m,filtertoken:l["default"].tokens.filtertoken});return this.getProvider("filter")||this.getProvider("data")?(x=this.getProvider("data"),x.getFeatures({editing:!1},S).done(function(t){var r=t.data,n=t.count,i=e.getTitle(),a=r.features&&r.features||[],o=a.length?a[0].properties:[];o=_(e.getAttributes(),o);var s={headers:o,features:a,title:i,count:n};w.resolve(s)}).fail(function(e){return w.reject(e)})):w.reject(),w.promise()},x.getFeatureByFids=i(regeneratorRuntime.mark(function M(){var e,t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.fids,a=void 0===i?[]:i,o=n.formatter,s=void 0===o?0:o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e=this.getUrl("data"),t=void 0,n.prev=2,n.next=5,v.get({url:e,params:{fids:a.toString(),formatter:s}});case 5:r=n.sent,t=r&&r.result&&r.vector&&r.vector.data&&r.vector.data.features,n.next=11;break;case 9:n.prev=9,n.t0=n["catch"](2);case 11:return n.abrupt("return",t);case 12:case"end":return n.stop()}},M,this,[[2,9]])})),x.searchFeatures=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.search_endpoint,a=void 0===n?this.config.search_endpoint:n;return new Promise(function(){var n=i(regeneratorRuntime.mark(function o(n,i){var s,l,u,c,d,p,f,h,v;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:o.t0=a,o.next="ows"===o.t0?3:"api"===o.t0?5:17;break;case 3:return e.search(t,r).then(function(e){e={data:e},n(e)}).fail(function(e){return i(e)}),o.abrupt("break",17);case 5:return s=t.raw,l=void 0!==s&&s,u=t.filter,c=t.suggest,d=void 0===c?{}:c,
p=t.unique,f=t.queryUrl,h=t.ordering,o.prev=6,o.next=9,e.getFilterData({queryUrl:f,raw:l,field:u,ordering:h,suggest:d,unique:p});case 9:v=o.sent,n(v),o.next=16;break;case 13:o.prev=13,o.t1=o["catch"](6),i(o.t1);case 16:return o.abrupt("break",17);case 17:case"end":return o.stop()}},o,e,[[6,13]])}));return function(e,t){return n.apply(this,arguments)}}())},x.getFilterData=i(regeneratorRuntime.mark(function T(){var e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.field,i=r.raw,a=void 0!==i&&i,o=r.suggest,s=void 0===o?{}:o,l=r.unique,u=r.formatter,c=void 0===u?1:u,d=r.queryUrl,p=r.ordering;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=this.getProvider("data"),r.next=3,e.getFilterData({queryUrl:d,field:n,raw:a,ordering:p,suggest:s,formatter:c,unique:l});case 3:return t=r.sent,r.abrupt("return",t);case 5:case"end":return r.stop()}},T,this)})),x.search=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.feature_count=e.feature_count||10,e=o({},e,this.config.searchParams,t);var r=$.Deferred(),n=this.getProvider("search");return n?n.query(e).done(function(e){return r.resolve(e)}).fail(function(e){return r.reject(e)}):r.reject(d("sdk.search.layer_not_searchable")),r.promise()},x.query=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=$.Deferred(),r=e.filter,n=this.getProvider(r?"filter":"query");return n?n.query(e).done(function(e){return t.resolve(e)}).fail(function(e){return t.reject(e)}):t.reject(d("sdk.search.layer_not_querable")),t.promise()},x.get=function(e){return this.config[e]?this.config[e]:this.state[e]},x.getFields=function(){return this.config.fields},x.getFieldByName=function(e){return this.getFields().find(function(t){return t.name===e})},x.getEditingFields=function(){return this.config.editing.fields},x.getTableFields=function(){return this.config.fields.filter(function(e){return e.show})},x.getTableHeaders=function(){return this.getTableFields().filter(function(e){return y.indexOf(e.name)===-1})},x.getProject=function(){return this.config.project},x.getConfig=function(){return this.config},x.getLayerEditingFormStructure=function(e){return this.config.editor_form_structure},x.getEditorFormStructure=function(){return this.getLayerEditingFormStructure()},x.getFieldsOutOfFormStructure=function(){return this.config.editor_form_structure?this.config.editor_form_structure.filter(function(e){return e.field_name}):[]},x.hasFormStructure=function(){return!!this.config.editor_form_structure},x.getCustomStyle=function(){return this.config.customstyle},x.getState=function(){return this.state},x.getSource=function(){return this.state.source},x.isDownloadable=function(){return this.isShpDownlodable()||this.isXlsDownlodable()||this.isGpxDownlodable()||this.isGpkgDownlodable()||this.isCsvDownlodable()},x.getDownloadableFormats=function(){var e=this;return Object.keys(u.DOWNLOAD_FORMATS).filter(function(t){return e.config[t]}).map(function(e){return u.DOWNLOAD_FORMATS[e].format})},x.getDownloadUrl=function(e){var t=Object.values(u.DOWNLOAD_FORMATS).find(function(t){return t.format===e});return t&&t.url},x.isGeoTIFFDownlodable=function(){return!this.isBaseLayer()&&this.config.download&&"gdal"===this.config.source.type},x.isShpDownlodable=function(){return!this.isBaseLayer()&&this.config.download&&"gdal"!==this.config.source.type},x.isXlsDownlodable=function(){return!this.isBaseLayer()&&this.config.download_xls},x.isGpxDownlodable=function(){return!this.isBaseLayer()&&this.config.download_gpx},x.isGpkgDownlodable=function(){return!this.isBaseLayer()&&this.config.download_gpkg},x.isCsvDownlodable=function(){return!this.isBaseLayer()&&this.config.download_csv},x.getEditingLayer=function(){return this._editingLayer},x.setEditingLayer=function(e){this._editingLayer=e},x.isHidden=function(){return this.state.hidden},x.setHidden=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.state.hidden=e},x.isModified=function(){return this.state.modified},x.getId=function(){return this.config.id},x.getMetadata=function(){return this.state.metadata},x.getTitle=function(){return this.config.title},x.getName=function(){return this.config.name},x.getOrigName=function(){return this.config.origname},x.getServerType=function(){return this.config.servertype&&""!==this.config.servertype?this.config.servertype:ServerTypes.QGIS},x.getType=function(){return this.type},x.isType=function(e){return this.getType()===e},x.setType=function(e){this.type=e},x.isSelected=function(){return this.state.selected},x.setSelected=function(e){this.state.selected=e},x.setSelection=i(regeneratorRuntime.mark(function E(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.state.selection.active=e,e){t.next=8;break}if(t.t0=this.state.filter.active,!t.t0){t.next=6;break}return t.next=6,this.deleteFilterToken();case 6:this.state.filter.active=e,this.emit("unselectionall",this.getId());case 8:case"end":return t.stop()}},E,this)})),x.isSelectionActive=function(){return this.state.selection.active},x.getSelection=function(){return this.state.selection},x.getFilter=function(){return this.state.filter},x.setDisabled=function(e){this.state.disabled=e},x.isDisabled=function(){return this.state.disabled},x.isVisible=function(){return this.state.visible},x.setVisible=function(e){this.state.visible=e},x.isQueryable=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{onMap:!1},t=e.onMap,r=!1,n=!!(this.config.capabilities&&this.config.capabilities&a.CAPABILITIES.QUERYABLE);return t?(n&&(r=this.isVisible()&&!this.isDisabled(),void 0!==this.config.infowhennotvisible&&this.config.infowhennotvisible===!0&&(r=!0)),r):n},x.getOws=function(){return this.config.ows},x.getTocHighlightable=function(){return this.state.tochighlightable},x.setTocHighlightable=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state.tochighlightable=e},x.isFilterable=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=!!(this.config.capabilities&&this.config.capabilities&a.CAPABILITIES.FILTERABLE);if(r&&t){var n=Object.keys(t).reduce(function(r,n){var i=e.get(n),a=t[n];return r&&Array.isArray(i)?i.indexOf(a)!==-1:a===i},!0);r=r&&n}return r},x.isQtimeseries=function(){return this.config.qtimeseries},x.isEditable=function(){return!!(this.config.capabilities&&this.config.capabilities&a.CAPABILITIES.EDITABLE)},x.isBaseLayer=function(){return this.config.baselayer},x.getUrl=function(e){return this.config.urls[e]},x.setUrl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=e.url;this.config.urls[t]=r},x.getUrls=function(){return this.config.urls},x.setEditingUrl=function(e){this.config.urls.editing=e||this.config.urls.editing},x.getQueryUrl=function(){return this.config.urls.query},x.setQueryUrl=function(e){this.config.urls.query=e},x.getQueryLayerName=function(){return this.config.infolayer&&""!==this.config.infolayer?this.config.infolayer:this.getName()},x.getQueryLayerOrigName=function(){return this.state.infolayer&&""!==this.config.infolayer?this.config.infolayer:this.config.origname},x.getInfoFormat=function(e){return this.config.qtimeseries===!0||"gdal"===this.getSourceType()?"application/json":this.config.infoformat&&""!==this.config.infoformat&&"wfs"!==e?this.config.infoformat:"application/vnd.ogc.gml"},x.getInfoFormats=function(){return this.state.infoformats},x.getInfoUrl=function(){return this.config.infourl},x.setInfoFormat=function(e){this.config.infoformat=e},x.getAttributes=function(){return this.config.fields},x.changeAttribute=function(e,t,r){var n=!0,i=!1,a=void 0;try{for(var o,s=this.config.fields[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=o.value;if(l.name===e){l.type=t,l.options=r;break}}}catch(u){i=!0,a=u}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}},x.getAttributeLabel=function(e){var t=this.getAttributes().find(function(t){return t.name===e});return t&&t.label},x.getProvider=function(e){return this.providers[e]},x.getProviders=function(){return this.providers},x.getLayersStore=function(){return this._layersstore},x.setLayersStore=function(e){this._layersstore=e},x.canShowTable=function(){if(this.config.not_show_attributes_table)return!1;if(this.getServerType()===a.ServerTypes.QGIS){if([a.SourceTypes.POSTGIS,a.SourceTypes.ORACLE,a.SourceTypes.WFS,a.SourceTypes.OGR,a.SourceTypes.MSSQL,a.SourceTypes.SPATIALITE].indexOf(this.config.source.type)>-1&&this.isQueryable())return!0}else if(this.getServerType()===a.ServerTypes.G3WSUITE){if("geojson"===this.get("source").type)return!0}else if(this.isFilterable())return!0;return!1},x.changeFieldType=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,r=e.type,n=e.options,i=void 0===n?{}:n,a=e.reset,o=void 0!==a&&a,s=this.getFields().find(function(e){return e.name===t});if(s)return o?(s.type=s._type,delete s._type,delete s[r+"options"],s.type):(s._type=s.type,s.type=r,s[r+"options"]=i,s._type)},x.changeConfigFieldType=function(e){var t=e.name,r=e.type,n=e.options,i=void 0===n?{}:n,a=e.reset,o=void 0!==a&&a;return this.changeFieldType({name:t,type:r,options:i,reset:o})},x.resetConfigField=function(e){var t=e.name;this.changeConfigFieldType({name:t,reset:!0})},x.clear=function(){},x.isVector=function(){return this.getType()===a.LayerTypes.VECTOR},x.isTable=function(){return this.getType()===a.LayerTypes.TABLE},a.LayerTypes={TABLE:"table",IMAGE:"image",VECTOR:"vector"},a.ServerTypes={OGC:"OGC",QGIS:"QGIS",Mapserver:"Mapserver",Geoserver:"Geoserver",ARCGISMAPSERVER:"ARCGISMAPSERVER",OSM:"OSM",BING:"Bing",LOCAL:"Local",TMS:"TMS",WMS:"WMS",WMTS:"WMTS",G3WSUITE:"G3WSUITE"},a.SourceTypes={VIRTUAL:"virtual",POSTGIS:"postgres",SPATIALITE:"spatialite",ORACLE:"oracle",MSSQL:"mssql",CSV:"delimitedtext",OGR:"ogr",GDAL:"gdal",WMS:"wms",WMST:"wmst",WFS:"wfs",WCS:"wcs","VECTOR-TILE":"vector-tile",VECTORTILE:"vectortile",ARCGISMAPSERVER:"arcgismapserver",GEOJSON:"geojson"},a.CAPABILITIES={QUERYABLE:1,FILTERABLE:2,EDITABLE:4},a.EDITOPS={INSERT:1,UPDATE:2,DELETE:4},a.SELECTION_STATE={ALL:"__ALL__",EXCLUDE:"__EXCLUDE__"},t.exports=a},{"./../../constant":5,"core/applicationservice":7,"core/applicationstate":8,"core/data/routerservice":15,"core/g3wobject":26,"core/i18n/i18n.service":27,"core/layers/providers/providersfactory":69,"core/project/projectsregistry":83,"core/relations/relations":85,"core/utils/geo":89,"core/utils/utils":92}],53:[function(e,t,r){function n(){this.build=function(e,t){var r=this.get(e);return r?new r(e,t):null},this.get=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=void 0,r=e.servertype;switch(r){case i.ServerTypes.QGIS:e.source&&(e.geometrytype?[i.SourceTypes.VIRTUAL,i.SourceTypes.POSTGIS,i.SourceTypes.MSSQL,i.SourceTypes.SPATIALITE,i.SourceTypes.WFS,i.SourceTypes.CSV,i.SourceTypes.ORACLE,i.SourceTypes.OGR].find(function(t){return t===e.source.type})&&(t=e.geometrytype&&"NoGeometry"===e.geometrytype?a:s):[i.SourceTypes.WMST,i.SourceTypes.WCS,i.SourceTypes.WMS,i.SourceTypes.GDAL,i.SourceTypes.VECTORTILE,i.SourceTypes["VECTOR-TILE"]].find(function(t){return t===e.source.type})&&(t=s));break;case i.ServerTypes.OGC:if(e.source){var n=e.source.type;switch(n){case i.SourceTypes.WMS:t=s;break;case i.SourceTypes.WFS:t=o}}break;case i.ServerTypes.LOCAL:t=o;break;case i.ServerTypes.OSM:case i.ServerTypes.BING:case i.ServerTypes.TMS:case i.ServerTypes.WMS:case i.ServerTypes.WMTS:case i.ServerTypes.ARCGISMAPSERVER:t=l[r];break;case i.ServerTypes.G3WSUITE:if(t=o,e.source)switch(e.source.type){case"geojson":t=u}}return t}}var i=e("./layer"),a=e("./tablelayer"),o=e("./vectorlayer"),s=e("./imagelayer"),l=e("./baselayers/baselayers"),u=e("./geojson");t.exports=new n},{"./baselayers/baselayers":37,"./geojson":49,"./imagelayer":51,"./layer":52,"./tablelayer":74,"./vectorlayer":75}],54:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config={id:e.id||Date.now(),projection:e.projection,extent:e.extent,initextent:e.initextent,wmsUrl:e.wmsUrl,catalog:!_.isBoolean(e.catalog)||e.catalog},this.state={layerstree:[],relations:null},this._isQueryable=!_.isBoolean(e.queryable)||e.queryable,this._layers=this.config.layers||{},this.setters={setLayerSelection:function(e){var t=e.layerId;e.selection,this.getLayerById(t)},setLayerSelected:function(e,t){this.getLayers().forEach(function(r){return r.state.selected=e===r.getId()&&t})},addLayers:function(e){var t=this;e.forEach(function(e){return t.addLayer(e)})},addLayer:function(e){this._addLayer(e)},removeLayer:function(e){this._removeLayer(e)}},o(this)}var i=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=e("core/utils/utils"),o=a.base,s=a.inherit,l=a.uniqueId,u=e("core/g3wobject");s(n,u);var c=n.prototype;c.isQueryable=function(){return this._isQueryable},c.setQueryable=function(e){this._isQueryable=!!e},c.showOnCatalog=function(){return this.config.catalog},c.setOptions=function(e){this.config=e},c.getId=function(){return this.config.id},c._addLayer=function(e){this._layers[e.getId()]=e},c._removeLayer=function(e){var t=e.getId();delete this._layers[t]},c.removeLayers=function(){var e=this;Object.entries(this._layers).forEach(function(t){var r=i(t,2),n=(r[0],r[1]);e.removeLayer(n)})},c.getLayersDict=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return this._layers;var r=e.PRINTABLE,n=e.QUERYABLE,i=e.FILTERABLE,a=e.EDITABLE,o=e.VISIBLE,s=e.SELECTED,l=e.CACHED,u=e.SELECTEDORALL,c=e.SERVERTYPE,d=e.BASELAYER,p=e.GEOLAYER,f=e.VECTORLAYER,h=e.HIDDEN,v=e.DISABLED,g=e.IDS;if(_.isUndefined(n)&&_.isUndefined(i)&&_.isUndefined(a)&&_.isUndefined(o)&&_.isUndefined(c)&&_.isUndefined(l)&&_.isUndefined(u)&&_.isUndefined(c)&&_.isUndefined(p)&&_.isUndefined(h)&&_.isUndefined(v)&&_.isUndefined(d)&&_.isUndefined(f)&&_.isUndefined(r)&&_.isUndefined(g))return this._layers;var m=[];for(var y in this._layers)m.push(this._layers[y]);if(g){var b=Array.isArray(g)?g:[g];m=m.filter(function(e){return b.indexOf(e.getId())!==-1})}if(u){var w=m;m=m.filter(function(e){return e.isSelected()}),m=m.length?m:w}else"boolean"==typeof s&&(m=m.filter(function(e){return s===e.isSelected()}));return"boolean"==typeof n&&(m=m.filter(function(e){return n===e.isQueryable()})),"boolean"==typeof i&&(m=m.filter(function(e){return i===e.isFilterable(t.filtrable||null)})),"boolean"==typeof a&&(m=m.filter(function(e){return a===e.isEditable()})),"boolean"==typeof o&&(m=m.filter(function(e){return o===e.isVisible()})),"boolean"==typeof l&&(m=m.filter(function(e){return l===e.isCached()})),"boolean"==typeof d&&(m=m.filter(function(e){return d===e.isBaseLayer()})),"boolean"==typeof p&&(m=m.filter(function(e){return p===e.state.geolayer})),"boolean"==typeof f&&(m=m.filter(function(e){return f===e.isType("vector")})),"boolean"==typeof h&&(m=m.filter(function(e){return h==e.isHidden()})),"boolean"==typeof v&&(m=m.filter(function(e){return v===e.isDisabled()})),"string"==typeof c&&""!==c&&(m=m.filter(function(e){return c===e.getServerType()})),r&&(m=m.filter(function(e){return e.state.geolayer&&e.isPrintable({scale:r.scale})})),m},c.getLayers=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.values(this.getLayersDict(e,t))},c.getBaseLayers=function(){return this.getLayersDict({BASELAYER:!0})},c.getLayerById=function(e){return this.getLayersDict()[e]},c.getLayerByName=function(e){return this._layers.find(function(t){return t.getName()===e})},c.getLayerAttributes=function(e){return this.getLayerById(e).getAttributes()},c.getLayerAttributeLabel=function(e,t){return this.getLayerById(e).getAttributeLabel(t)},c.getGeoLayers=function(){return this.getLayers({GEOLAYER:!0})},c._getAllSiblingsChildrenLayersId=function(e){var t=[],r=function n(e){e.nodes.forEach(function(e){e.id?t.push(e.id):n(e)})};return r(e),t},c._getAllParentLayersId=function(e,t){var r=[],n=function(e){e.nodes.forEach(function(e){e.id&&r.push(e.id)})};return n({nodes:e.nodes.filter(function(e){return e!==t})}),r},c.selectLayer=function(e,t){this.setLayerSelected(e,t)},c.getProjection=function(){return this.config.projection},c.getExtent=function(){return this.config.extent},c.getInitExtent=function(){return this.config.initextent},c.getWmsUrl=function(){return this.config.wmsUrl},c.setLayersTree=function(e,t){var r=this,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i={title:t||this.config.id,root:!0,parentGroup:null,expanded:n,disabled:!1,checked:!0,nodes:e},a=function o(e,t){e.forEach(function(n,i){void 0!==n.id&&(e[i]=r.getLayerById(n.id).getState()),n.nodes&&(n.nodes.forEach(function(e){return e.parentGroup=t}),o(n.nodes,n)),e[i].parentGroup=t})};e.length&&(a(e,i),this.state.layerstree.splice(0,0,i))},c.createLayersTree=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.full||!1,n=t.expanded,i=t.layerstree||null,a=this.getLayers({BASELAYER:!1}).map(function(e){return e.getId()}),o=[];if(i){if(r===!0)return this.state.layerstree;var s=function c(e,t){e.forEach(function(e){var r={};null!==e.id&&void 0!==e.id&&(a.find(function(t){return t===e.id})?r.id=e.id:r=null),null!==e.nodes&&void 0!==e.nodes&&(r.title=e.name,r.expanded=e.expanded,r.groupId=l(),r.nodes=[],r.checked=e.checked,r.mutually_exclusive=e["mutually-exclusive"],c(e.nodes,r.nodes)),r&&t.push(r)})};s(i,o)}else{var u=this.getGeoLayers();u.forEach(function(e){o.push({id:e.getId(),name:e.getName(),title:e.getTitle(),visible:e.isVisible()||!1})})}this.setLayersTree(o,e,n)},c.removeLayersTree=function(){this.state.layerstree.splice(0,this.state.layerstree.length)},c.getLayersTree=function(){return this.state.layerstree},t.exports=n},{"core/g3wobject":26,"core/utils/utils":92}],55:[function(e,t,r){function n(){this.stores={},this.storesArray=[],this.setters={addLayersStore:function(e,t){this._addLayersStore(e,t)},removeLayersStore:function(e){this._removeLayersStore(e)},removeLayersStores:function(){this._removeLayersStores()}},o(this)}var i=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=e("core/utils/utils"),o=a.base,s=a.inherit,l=e("core/g3wobject");s(n,l);var u=n.prototype;u.getLayerById=function(e){var t=void 0;for(var r in this.stores){var n=this.stores[r];if(t=n.getLayerById(e))break}return t},u.getLayers=function(e){var t=[];return Object.entries(this.stores).forEach(function(r){var n=i(r,2),a=(n[0],n[1]);t=t.concat(a.getLayers(e))}),t},u.getQuerableLayersStores=function(){return this.getLayersStores().filter(function(e){return e.isQueryable()})},u.getLayersStore=function(e){return this.stores[e]},u.getLayersStores=function(){var e=this,t=[];return this.storesArray.forEach(function(r){t.push(e.stores[r])}),t},u._addLayersStore=function(e,t){var r=e.getId();this.stores[r]=e,_.isNil(t)?this.storesArray.push(r):this.storesArray.splice(t,0,r)},u._removeLayersStore=function(e){if(e){var t=e.getId();this.storesArray=this.storesArray.filter(function(e){return e!=t}),delete this.stores[t]}},u._removeLayersStores=function(){this.storesArray=[],this.stores={}},t.exports=n},{"core/g3wobject":26,"core/utils/utils":92}],56:[function(e,t,r){function n(e){var t=e.layer,r=(e.params,t.getConfig().source),n=r.url,i=r.layer,a=n.replace("/rest/","/");return a+"/WMSServer?request=GetLegendGraphic&version=1.3.0&format=image/png&LAYER="+i}t.exports=n},{}],57:[function(e,t,r){var n={wms:e("./wmslegend"),argismapserver:e("./arcgismapserverlegend")},i={get:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,r=e.params,i=t.isArcgisMapserver()?"argismapserver":"wms";return n[i]({layer:t,params:r})}};t.exports=i},{"./arcgismapserverlegend":56,"./wmslegend":58}],58:[function(e,t,r){function n(e){var t=e.layer,r=e.params,n=r.width,i=r.height,a=r.color,o=void 0===a?"white":a,s=r.fontsize,l=void 0===s?10:s,u=r.transparent,c=void 0===u||u,d=r.boxspace,p=r.layerspace,f=r.layertitle,h=void 0===f||f,v=r.layertitlespace,g=r.symbolspace,m=r.iconlabelspace,y=r.symbolwidth,_=r.symbolheight,b=r.itemfontfamily,w=r.layerfontfamily,x=r.layerfontbold,S=r.itemfontbold,C=r.layerfontitalic,L=r.itemfontitalic,k=r.rulelabel,M=r.crs,T=r.bbox,E=r.sld_version,I=void 0===E?"1.1.0":E,P=t.getWMSLayerName({type:"legend"}),F=t.getWmsUrl({type:"legend"}),O=F.indexOf("?")>-1?"&":"?";return[""+F+O+"SERVICE=WMS&VERSION=1.3.0&REQUEST=GetLegendGraphic&SLD_VERSION="+I,""+(n?"&WIDTH="+n:""),""+(i?"&HEIGHT="+i:""),"&FORMAT=image/png","&TRANSPARENT="+c,"&ITEMFONTCOLOR="+o,"&LAYERFONTCOLOR="+o,"&LAYERTITLE="+h,"&ITEMFONTSIZE="+l,""+(M?"&CRS="+M:""),""+(T?"&BBOX="+T.join(","):""),""+(d?"&BOXSPACE="+d:""),""+(p?"&LAYERSPACE="+p:""),""+(v?"&LAYERTITLESPACE="+v:""),""+(g?"&SYMBOLSPACE="+g:""),""+(m?"&ICONLABELSPACE="+m:""),""+(y?"&SYMBOLWIDTH="+y:""),""+(_?"&SYMBOLHEIGHT="+_:""),""+(w?"&LAYERFONTFAMILY="+w:""),""+(b?"&ITEMFONTFAMILY="+b:""),""+(x?"&LAYERFONTBOLD="+x:""),""+(S?"&ITEMFONTBOLD="+S:""),""+(C?"&LAYERFONTITALIC="+C:""),""+(L?"&ITEMFONTITALIC="+L:""),""+(k?"&RULELABEL="+k:""),"&LAYER="+P].join("")}t.exports=n},{}],59:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,e,t)}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("./wmslayer"),l=e("g3w-ol/layers/rasters");a(n,s);var u=n.prototype;u._makeOlLayer=function(){var e=this,t={url:this.config.url,id:this.config.id,projection:this.config.projection,format:this.config.format},r=new l.TiledArgisMapServer(t);return r.getSource().on("imageloadstart",function(){e.emit("loadstart")}),r.getSource().on("imageloadend",function(){e.emit("loadend")}),r.getSource().on("imageloaderror",function(){e.emit("loaderror")}),r},t.exports=n},{"./wmslayer":63,"core/utils/utils":92,"g3w-ol/layers/rasters":132}],60:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.provider;this.setProvider(t),o(this,e),this.getFeatures({url:e.url,mapProjection:this.mapProjection})}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("./vectorlayer");a(n,s),t.exports=n},{"./vectorlayer":62,"core/utils/utils":92}],61:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config=e,this.id=e.id,this.iframe_internal=e.iframe_internal||!1,this.extent=e.extent,this.projection=e.projection,this.layer=null,this.layers=e.layers||[],this.allLayers=[],this.showSpinnerWhenLoading=!0,a(this)}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("core/g3wobject");o(n,s);var l=n.prototype;l.getId=function(){return this.id},l.getOLLayer=function(){},l.update=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._updateLayers(e,t)},l.checkLayerDisabled=function(e,t,r){return e.setDisabled(t,r),e.isDisabled()},l.checkLayersDisabled=function(e,t){var r=this;this.allLayers.forEach(function(n){return r.checkLayerDisabled(n,e,t)})},l.setupCustomMapParamsToLegendUrl=function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}},t.exports=n},{"core/g3wobject":26,"core/utils/utils":92}],62:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.mapService=c.getComponent("map").getService(),this.geometrytype=e.geometrytype||null,this.type=e.type||null,this.crs=e.crs||null,this.id=e.id,this.name=e.name||"",this.style=e.style,this.color=e.color,this.geometryType=e.geometryType,this.mapProjection=this.mapService.getProjection().getCode(),this.projection=e.projection||this.mapProjection,this.url=e.url,this.provider=e.provider,this._features=e.features||[],this._olLayer=e.olLayer||this.getOLLayer()}var i=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=e("core/utils/utils"),o=a.inherit,s=e("core/utils/geo"),l=s.createOlLayer,u=s.createLayerStyle,c=e("gui/gui"),d=e("core/g3wobject");o(n,d),t.exports=n;var p=n.prototype;p.setProvider=function(e){this._provider=e},p.getProvider=function(){return this._provider},p.resetSource=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=new ol.source.Vector({features:e});this.setSource(t)},p._makeOlLayer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.style,r=this._makeStyle(t);this._olLayer=new ol.layer.Vector({name:this.name,id:this.id,style:r,source:new ol.source.Vector({})})},p._makeStyle=function(e){var t=void 0,r={};return e&&(Object.entries(e).forEach(function(e){var t=i(e,2),n=t[0],a=t[1];switch(n){case"point":a.icon&&(r.image=new ol.style.Icon({src:a.icon.url,imageSize:a.icon.width}));break;case"line":r.stroke=new ol.style.Stroke({color:a.color,width:a.width});break;case"polygon":r.fill=new ol.style.Fill({color:a.color})}}),t=new ol.style.Style(r)),t},p.getFeatures=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred();return this.provider.getFeatures(t).then(function(t){e.addFeatures(t),r.resolve(t)}).fail(function(e){return r.reject(e)}),r.promise()},p.addFeatures=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.getSource().addFeatures(e)},p.addFeature=function(e){e&&this.getSource().addFeature(e)},p.getOLLayer=function(){if(this._olLayer)return this._olLayer;var e=this.id,t=this.geometryType,r=this.color,n=this.style?u(this.style):null;return this._olLayer=l({id:e,geometryType:t,color:r,style:n,features:this._features}),this._olLayer},p.setOLLayer=function(e){this._olLayer=e},p.getSource=function(){return!this._olLayer&&this.getOLLayer(),this._olLayer.getSource()},p.setSource=function(e){this._olLayer.setSource(e)},p.setStyle=function(e){this._olLayer.setStyle(e)},p.getFeatureById=function(e){return e?this._olLayer.getSource().getFeatureById(e):null},p.isVisible=function(){return this._olLayer.getVisible()},p.setVisible=function(e){this._olLayer.setVisible(e)},p.clear=function(){this.getSource().clear()},p.addToMap=function(e){e.addLayer(this._olLayer)}},{"core/g3wobject":26,"core/utils/geo":89,"core/utils/utils":92,"gui/gui":150}],63:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET";this.LAYERTYPE={LAYER:"layer",MULTILAYER:"multilayer"},this.extraParams=t,this._method=r,c(this,e)}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=e("core/applicationstate"),l=n(s),u=e("core/utils/utils"),c=u.base,d=u.inherit,p=e("./maplayer"),f=e("g3w-ol/layers/rasters");d(a,p);var h=a.prototype;h.getOLLayer=function(e){return this._olLayer||(this._olLayer=this._makeOlLayer(e)),this._olLayer},h.getSource=function(){return this.getOLLayer().getSource()},h.getInfoFormat=function(){return"application/vnd.ogc.gml"},h.getGetFeatureInfoUrl=function(e,t,r,n){return this.getOLLayer().getSource().getGetFeatureInfoUrl(e,t,r,n)},h.getLayerConfigs=function(){return this.layers},h.addLayer=function(e){this.allLayers.find(function(t){return e===t})||this.allLayers.push(e),this.layers.find(function(t){return e===t})||this.layers.push(e)},h.removeLayer=function(e){this.layers=this.layers.filter(function(t){return e!==t})},h.isVisible=function(){return this._getVisibleLayers().length>0},h.getQueryUrl=function(){var e=this.layers[0];return e.infourl&&""!==e.infourl?e.infourl:this.config.url},h.getQueryableLayers=function(){return this.layers.filter(function(e){return e.isQueryable()})},h._getVisibleLayers=function(){return this.layers.filter(function(e){return e.isVisible()})},h._makeOlLayer=function(e){var t=this,r={url:this.config.url,id:this.config.id,projection:this.config.projection,iframe_internal:this.iframe_internal,layers:this.layers};e&&(r.layers=this.layers.map(function(e){return e.getWMSLayerName()}));var n=this.layers[0];n&&n.getWmsUrl&&(r.url=n.getWmsUrl());var i=new f.WMSLayer(r,this.extraParams,this._method);return i.getSource().on("imageloadstart",function(){return t.emit("loadstart")}),i.getSource().on("imageloadend",function(){return t.emit("loadend")}),i.getSource().on("imageloaderror",function(){return t.emit("loaderror")}),i},h._updateLayers=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.force,n=void 0!==r&&r,a=i(t,["force"]);!n&&this.checkLayersDisabled(e.resolution,e.mapUnits);var s=this._getVisibleLayers(e)||[];if(s.length>0){var u=s.map(function(e){return e.getStyle()}).join(","),c=s[0].isArcgisMapserver()?"show:":"";a=o({},a,{filtertoken:l["default"].tokens.filtertoken,STYLES:u,LAYERS:""+c+s.map(function(e){return e.getWMSLayerName()}).join(",")}),this._olLayer.setVisible(!0),this._olLayer.getSource().updateParams(a)}else this._olLayer.setVisible(!1)},h.setupCustomMapParamsToLegendUrl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.layer?this.layer.setMapParamstoLegendUrl(e):this.layers.forEach(function(t){return t.setMapParamstoLegendUrl(e)})},t.exports=a},{"./maplayer":61,"core/applicationstate":8,"core/utils/utils":92,"g3w-ol/layers/rasters":132}],64:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET";this.LAYERTYPE={LAYER:"layer",MULTILAYER:"multilayer"},this.extraParams=t,this._method=r,s(this,e)}var a=e("core/applicationstate"),o=(n(a),e("core/utils/utils")),s=o.base,l=o.inherit,u=e("./wmslayer"),c=e("g3w-ol/layers/rasters");l(i,u);var d=i.prototype;d._makeOlLayer=function(e){var t=this,r={url:this.config.url,id:this.config.id,projection:this.config.projection,iframe_internal:this.iframe_internal,layers:this.layers};e&&(r.layers=this.layers.map(function(e){return e.getWMSLayerName()}));var n=this.layers[0];n&&n.getWmsUrl&&(r.url=n.getWmsUrl());var i=new c.TiledWMSLayer(r,this.extraParams,this._method);return i.getSource().on("tileloadstart",function(){return t.emit("loadstart")}),i.getSource().on("tileloadend",function(){return t.emit("loadend")}),i.getSource().on("tileloaderror",function(){return t.emit("loaderror")}),i},t.exports=i},{"./wmslayer":63,"core/applicationstate":8,"core/utils/utils":92,"g3w-ol/layers/rasters":132
}],65:[function(e,t,r){function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET";o(this,e),this._method=t}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("./maplayer"),l=e("g3w-ol/layers/rasters");a(n,s);var u=n.prototype;u.getOLLayer=function(){var e=this._olLayer;return e||(e=this._olLayer=this._makeOlLayer()),e},u.getSource=function(){return this.getOLLayer().getSource()},u.getLayerConfigs=function(){return this.layer},u.addLayer=function(e){this.layer=e,this.layers.push(e),this.allLayers.push(e)},u.update=function(e,t){this._updateLayer(e,t)},u.isVisible=function(){return layer.state.visible},u._makeOlLayer=function(){var e=this,t=this.projection?this.projection:this.layer.getProjection(),r={url:this.layer.getCacheUrl()+"/{z}/{x}/{y}.png",maxZoom:20,extent:this.config.extent,iframe_internal:this.iframe_internal};return r.projection=t,this._olLayer=new l.XYZLayer(r,this._method),this._olLayer.getSource().on("imageloadstart",function(){e.emit("loadstart")}),this._olLayer.getSource().on("imageloadend",function(){e.emit("loadend")}),this._olLayer.getSource().on("imageloaderror",function(){e.emit("loaderror")}),this._olLayer},u._updateLayer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.force,n=void 0!==r&&r;!n&&this.checkLayersDisabled(e.resolution,e.mapUnits),this._olLayer.setVisible(this.layer.isVisible())},t.exports=n},{"./maplayer":61,"core/utils/utils":92,"g3w-ol/layers/rasters":132}],66:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this._name="geojson",this.provider=e.provider}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("core/layers/providers/provider");a(n,s);var l=n.prototype;l.query=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},$.Deferred());return e.resolve([]),e.promise()},l.getFeatures=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=$.Deferred(),r=e.url||this.getLayer().get("source").url,n=e.data,i=e.projection||"EPSG:4326",a=e.mapProjection,o=function(e){var t=new ol.format.GeoJSON;return t.readFeatures(e,{featureProjection:a,dataProjection:i})};if(n){var s=o(n);t.resolve(s)}else $.get({url:r}).then(function(e){var r=o(e.results);t.resolve(r)}).fail(function(e){t.reject(e)});return t.promise()},l.getDataTable=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(t.page,$.Deferred());return this.getFeatures().then(function(){r.resolve(e._features)}).fail(function(e){r.reject(e)}),r.promise()},l.digestFeaturesForTable=function(){return{headers:[],features:[]}},t.exports=n},{"core/layers/providers/provider":68,"core/utils/utils":92}],67:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this._name="kml"}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("core/layers/providers/provider");a(n,s);var l=n.prototype;l.getData=function(){var e=$.Deferred();return e.promise()},t.exports=n},{"core/layers/providers/provider":68,"core/utils/utils":92}],68:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._isReady=!1,this._name="provider",this._layer=e.layer,this._hasFieldsStartWithNotPermittedKey,a(this)}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=i.getTimeoutPromise,l=e("core/g3wobject"),u=e("core/utils/geo"),c=u.handleQueryResponse,d=e("core/utils/parsers"),p=d.response;o(n,l);var f=n.prototype;f.getLayer=function(){return this._layer},f.setLayer=function(e){this._layer=e},f.getFeatures=function(){},f.query=function(){},f.setReady=function(e){this._isReady=e},f.isReady=function(){return this._isReady},f.error=function(){},f.isValid=function(){},f.getName=function(){return this._name},f.handleQueryResponseFromServer=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[this._layer],n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return c({response:e,projections:t,layers:r,wms:n})},f.getQueryResponseTimeoutKey=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.layers,r=void 0===t?[this._layer]:t,n=e.resolve,i=e.query;return s({resolve:n,data:{data:p.utils.getTimeoutData(r),query:i}})},t.exports=n},{"core/g3wobject":26,"core/utils/geo":89,"core/utils/parsers":91,"core/utils/utils":92}],69:[function(e,t,r){function n(){this.build=function(e,t,r,n){var i=this.get(e,t,r);return i?new i(n):null},this.get=function(e,t,r){return a[t][r][e]}}var i={geojson:e("./geojsonprovider"),kml:e("./kmlprovider"),xml:e("./xmlprovider"),qgis:e("./qgisprovider"),wms:e("./wmsprovider"),wfs:e("./wfsprovider")},a={QGIS:{virtual:{query:i.wms,filter:i.wfs,data:i.qgis,search:i.qgis,filtertoken:i.qgis},postgres:{query:i.wms,filter:i.wfs,data:i.qgis,search:i.qgis,filtertoken:i.qgis},oracle:{query:i.wms,filter:i.wfs,data:i.qgis,search:i.qgis,filtertoken:i.qgis},mssql:{query:i.wms,filter:i.wfs,data:i.qgis,search:i.qgis,filtertoken:i.qgis},spatialite:{query:i.wms,filter:i.wfs,data:i.qgis,search:i.qgis,filtertoken:i.qgis},ogr:{query:i.wms,filter:i.wfs,data:i.qgis,search:i.qgis,filtertoken:i.qgis},delimitedtext:{query:i.wms,filter:i.wfs,data:i.qgis,search:i.qgis,filtertoken:i.qgis},wmst:{query:i.wms,filter:i.wfs,data:null,search:null},wcs:{query:i.wms,filter:i.wfs,data:null,search:null},wms:{query:i.wms,filter:i.wfs,data:null,search:null},wfs:{query:i.wms,filter:i.wfs,data:i.qgis,search:i.qgis},gdal:{query:i.wms,filter:null,data:null,search:null},"vector-tile":{query:i.wms,filter:null,data:null,search:null},vectortile:{query:i.wms,filter:null,data:null,search:null},arcgismapserver:{query:i.wms,filter:null,data:null,search:null}},OGC:{wms:{query:i.wms,filter:null,data:null,search:null}},G3WSUITE:{geojson:{query:i.geojson,filter:null,data:i.geojson,search:null}}};t.exports=new n},{"./geojsonprovider":66,"./kmlprovider":67,"./qgisprovider":70,"./wfsprovider":71,"./wmsprovider":72,"./xmlprovider":73}],70:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};c(this),this._name="qgis",this._layer=e.layer||{},this._projections={map:null,layer:null},this._queryUrl=this._layer.getUrl("query"),this._filtertokenUrl=this._layer.getUrl("filtertoken"),this._layerName=this._layer.getName()||null,this._infoFormat=this._layer.getInfoFormat()||"application/vnd.ogc.gml"}var o=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=e("core/applicationstate"),l=n(s),u=e("core/utils/utils"),c=u.base,d=u.inherit,p=u.XHR,f=e("core/i18n/i18n.service"),h=f.t,v=e("core/layers/providers/provider"),g=e("core/utils/parsers"),m=g.response,y=e("core/relations/relationsservice"),b=e("core/layers/features/feature"),w=e("core/utils/parsers");d(a,v);var x=a.prototype;x.deleteFilterToken=i(regeneratorRuntime.mark(function S(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.get({url:this._filtertokenUrl,params:{mode:"delete"}});case 2:case"end":return e.stop()}},S,this)})),x.getFilterToken=i(regeneratorRuntime.mark(function C(){var e,t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,p.get({url:this._filtertokenUrl,params:n});case 3:return e=i.sent,t=e.data,r=void 0===t?{}:t,i.abrupt("return",r.filtertoken);case 9:return i.prev=9,i.t0=i["catch"](0),i.abrupt("return",Promise.reject(i.t0));case 12:case"end":return i.stop()}},C,this,[[0,9]])})),x.getFilterData=i(regeneratorRuntime.mark(function L(){var e,t,r,n,i,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=a.field,s=a.raw,u=void 0!==s&&s,c=a.suggest,d=void 0===c?{}:c,f=a.unique,h=a.formatter,v=void 0===h?1:h,g=a.queryUrl,y=a.ordering;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e=this._layer.getUrl("data"),t={field:o,suggest:d,ordering:y,formatter:v,unique:f,filtertoken:l["default"].tokens.filtertoken},a.prev=2,a.next=5,p.get({url:""+(g?g:e),params:t});case 5:return r=a.sent,n="table"!==this._layer.getType(),n&&this.setProjections(),i=u?r:r.result?f?r.data:{data:m.get("application/json")({layers:[this._layer],response:r.vector.data,projections:this._projections})}:Promise.reject(),a.abrupt("return",i);case 12:return a.prev=12,a.t0=a["catch"](2),a.abrupt("return",Promise.reject(a.t0));case 15:case"end":return a.stop()}},L,this,[[2,12]])})),x.setProjections=function(){this._projections.map=this._layer.getMapProjection()||this._projections.layer},x.query=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred(),n=t.feature_count||10,i=t.raw||!1,a=t.filter,o=void 0===a?null:a;o=o&&Array.isArray(o)?o:[o];var s="table"!==this._layer.getType();s&&this.setProjections();var u=s?this._projections.map.getCode():l["default"].map.epsg,c=t.queryUrl||this._queryUrl,d=t.I,f=t.J,h=t.layers,v=h?h.map(function(e){return e.getWMSLayerName()}).join(","):this._layer.getWMSLayerName();if(o){"geometry"!==o[0].getType()&&(this._projections.layer=null),o=o.map(function(e){return e.get()}).filter(function(e){return e});var g=c,m={SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetFeatureInfo",filtertoken:l["default"].tokens.filtertoken,LAYERS:v,QUERY_LAYERS:v,INFO_FORMAT:this._infoFormat,FEATURE_COUNT:n,CRS:u,I:d,J:f,FILTER:o&&o.length?o.join(";"):void 0,WITH_GEOMETRY:s};p.get({url:g,params:m}).then(function(t){var n=i?t:e.handleQueryResponseFromServer(t,e._projections,h);r.resolve(n)})["catch"](function(e){return r.reject(e)})}else r.reject();return r.promise()},x.getConfig=function(){var e=$.Deferred(),t=this._layer.getUrl("config");return t?($.get(t).then(function(t){return e.resolve(t)}).fail(function(t){return e.reject(t)}),e.promise()):void e.reject("not valid url")},x.getWidgetData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=e.fields,n=this._layer.getUrl("widget"),i=n[t];return $.get(i,{fields:r})},x.unlock=function(){var e=this._layer.getUrl("unlock"),t=$.Deferred();return $.post(e).then(function(e){return t.resolve(e)}).fail(function(e){return t.reject(e)}),t.promise()},x.commit=function(e){var t=$.Deferred(),r=this._layer.getUrl("commit"),n=JSON.stringify(e);return $.post({url:r,data:n,contentType:"application/json"}).then(function(e){return t.resolve(e)}).fail(function(e){return t.reject(e)}),t.promise()},x.getFeatures=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=$.Deferred();Object.entries(r).forEach(function(e){var t=o(e,2),n=t[0],i=t[1];null!==i&&void 0!==i||delete r[n]});var i=this._layer.getType(),a=void 0,s="application/json";if(t.editing){var u=void 0;if(a=this._layer.getUrl("editing"),!a)return void n.reject("Url not valid");var c=$.param(r);a+=c?"?"+c:"";var d=[],f=t.filter||null;if(f){if(f.bbox){var v=f.bbox;f={in_bbox:v[0]+","+v[1]+","+v[2]+","+v[3],filtertoken:l["default"].tokens.filtertoken};var g=JSON.stringify(f);u=p.post({url:a,data:g,contentType:s})}else if(f.fid){var m=f.fid;u=y.getRelations(m)}else if(f.field){var _=JSON.stringify(f);u=p.post({url:a,data:_,contentType:s})}else if(f.fids)u=p.get({url:a,params:f});else if(f.nofeatures){var x=JSON.stringify({field:(f.nofeatures_field||"id")+"|eq|__G3W__NO_FEATURES__"});u=p.post({url:a,data:x,contentType:s})}}else u=p.post({url:a,contentType:s});u.then(function(t){var r=t.vector,a=t.result,o=t.featurelocks;if(a){var s=r.data,l=r.geometrytype,u=w[i].get({type:"json"}),c="NoGeometry"!==l?{crs:e._layer.getCrs()}:{},p=o.map(function(e){return e.featureid});u(s,c).forEach(function(e){var t=""+e.getId();p.indexOf(t)>-1&&d.push(new b({feature:e}))}),n.resolve({features:d,featurelocks:o})}else n.reject({message:h("info.server_error")})})["catch"](function(e){return n.reject({message:h("info.server_error")})})}else{a=this._layer.getUrl("data");var S=$.param(r);a+=S?"?"+S:"",$.get({url:a,contentType:s}).then(function(e){var t=e.vector,r=t.data;n.resolve({data:r,count:t.count})}).fail(function(e){return n.reject(e)})}return n.promise()},x._loadLayerData=function(e,t){var r=this,n=arguments,i=$.Deferred();Obkect.entries(this._layers).forEach(function(e){var t=o(e,2),r=t[0],n=t[1];_.isNull(n.vector)&&noVectorlayerCodes.push(r)});var a=noVectorlayerCodes.map(function(e){return r._setupVectorLayer(e)});return this.emit("loadingvectorlayersstart"),$.when.apply(this,a).then(function(){var e=Array.prototype.slice.call(n);r.emit("loadingvectolayersdatastart"),r.loadAllVectorsData(e).then(function(){r._vectorLayersCodes=e,i.resolve(e),r.emit("loadingvectorlayersend"),r.setReady(!0)}).fail(function(){r._layers.forEach(function(e){return e.vector=null}),i.reject(),r.emit("errorloadingvectorlayersend"),r.setReady(!1)})}).fail(function(){r.setReady(!1),r.emit("errorloadingvectorlayersend"),i.reject()}),i.promise()},x.setVectorLayersCodes=function(e){this._vectorLayersCodes=e},x.getVectorLayersCodes=function(){return this._vectorLayersCodes},x.getLayers=function(){return this._layers},x.reloadVectorData=function(e){var t=this,r=$.Deferred(),n=this._mapService.state.bbox;return this._createVectorLayerFromConfig(e).then(function(e){t._getVectorLayerData(e,n).then(function(n){t.setVectorLayerData(e[t._editingApiField],n),e.setData(n.vector.data),r.resolve(e)})}),r.promise()},x.loadAllVectorsData=function(e){var t=this,r=$.Deferred(),n=this._layers,i=this._mapService.state.bbox,a=this._loadedExtent;if(a&&ol.extent.containsExtent(a,i))return resolvedValue();this._loadedExtent=a?ol.extent.extend(a,i):i,e&&(n=[],e.forEach(function(e){return n.push(t._layers[e])}));var o=n.map(function(e){return t._loadVectorData(e.vector,i)});return $.when.apply(this,o).then(function(){return r.resolve(e)}).fail(function(){return r.reject()}),r.promise()},x._setCustomUrlParameters=function(e){this._customUrlParameters=e},x._checkVectorGeometryTypeFromConfig=function(e){switch(e.geometrytype){case"Line":e.geometrytype="LineString";break;case"MultiLine":e.geometrytype="MultiLineString"}return e},x._createVectorLayerFromConfig=function(e){var t=this,r=this._layers[e],n=$.Deferred();return this._getVectorLayerConfig(r[this._editingApiField]).then(function(e){var i=e.vector;i=t._checkVectorGeometryTypeFromConfig(i);var a=r.crs||t._mapService.getProjection().getCode(),o=t._createVectorLayer({geometrytype:i.geometrytype,format:i.format,crs:t._mapService.getProjection().getCode(),crsLayer:a,id:r.id,name:r.name,editing:self._editingMode});o.setFields(i.fields),o.setCrs(a);var s=i.relations;s&&(o.lazyRelations=!0,o.setRelations(s)),r.style&&o.setStyle(r.style),n.resolve(o)}).fail(function(){return n.reject()}),n.promise()},x._setupVectorLayer=function(e){var t=this,r=$.Deferred();return this._createVectorLayerFromConfig(e).then(function(n){var i=t._layers[e];i.vector=n,r.resolve(e)}).fail(function(){return r.reject()}),r.promise()},x._loadVectorData=function(e,t){var r=this;return self._getVectorLayerData(e,t).then(function(t){if(r.setVectorLayerData(e[r._editingApiField],t),r._editingMode&&t.featurelocks&&r.setVectorFeaturesLock(e,t.featurelocks),e.setData(t.vector.data),r._)return t}).fail(function(){return!1})},x.getVectorLayerData=function(e){return this._vectorLayersData[e]},x.getVectorLayersData=function(){return this._vectorLayersData},x.setVectorLayerData=function(e,t){this._vectorLayersData[e]=t},x.setVectorFeaturesLock=function(e,t){var r=_.differenceBy(t,e.getFeatureLocks(),"featureid");r.forEach(function(t){e.addLockId(t)})},x.cleanVectorFeaturesLock=function(e){e.cleanFeatureLocks()},x.lockFeatures=function(e){var t=this,r=$.Deferred(),n=this._mapService.state.bbox,i=this._layers[e].vector;return $.get(this._baseUrl+e+"/?lock"+this._customUrlParameters+"&in_bbox="+n[0]+","+n[1]+","+n[2]+","+n[3]).done(function(e){t.setVectorFeaturesLock(i,e.featurelocks),r.resolve(e)}).fail(function(){return r.reject()}),r.promise()},x._getVectorLayerConfig=function(e){var t=$.Deferred();return $.get(this._baseUrl+e+"/?config"+this._customUrlParameters).done(function(e){return t.resolve(e)}).fail(function(){return t.reject()}),t.promise()},x._getVectorLayerData=function(e,t){var r=$.Deferred(),n="w"==this.getMode(),i=n?this._baseUrl+e[this._editingApiField]+"/?editing":this._baseUrl+e[this._editingApiField]+"/?";return $.get(i+this._customUrlParameters+"&in_bbox="+t[0]+","+t[1]+","+t[2]+","+t[3]).done(function(e){return r.resolve(e)}).fail(function(){return r.reject()}),r.promise()},x._createVectorLayer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new VectorLayer(e);return t},x.cleanUpLayers=function(){this._loadedExtent=null},t.exports=a},{"core/applicationstate":8,"core/i18n/i18n.service":27,"core/layers/features/feature":43,"core/layers/providers/provider":68,"core/relations/relationsservice":86,"core/utils/parsers":91,"core/utils/utils":92}],71:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this._name="wfs"}var i=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=e("core/utils/utils"),o=a.base,s=a.inherit,l=a.toRawType,u=e("core/layers/providers/provider"),c=e("core/layers/filter/filter");s(n,u);var d=n.prototype;d.getData=function(){var e=$.Deferred();return e.promise()},d.query=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.reproject,a=void 0!==n&&n,o=t.feature_count,s=void 0===o?10:o,u=t.filter;r.MAXFEATURES=s;var c=$.Deferred(),d=t.layers,p=void 0===d?[this._layer]:d,f={map:this._layer.getMapProjection(),layer:a?this._layer.getProjection():null},h=this.getQueryResponseTimeoutKey({layers:p,resolve:c.resolve,query:{}});return this._doRequest(u,r,p,a).then(function(t){var r=e.handleQueryResponseFromServer(t,f,p,wms=!1);r.forEach(function(e){var t=e.features,r=void 0===t?[]:t;r.forEach(function(e){Object.entries(e.getProperties()).forEach(function(t){var r=i(t,2),n=r[0],a=r[1];"Object"===l(a)&&a["xsi:nil"]&&e.set(n,"NULL")})})}),c.resolve({data:r})}).fail(function(e){return c.reject(e)}).always(function(){clearTimeout(h)}),c.promise()},d._post=function(e,t){e=e.match(/\/$/)?e:e+"/";var r=$.Deferred();return $.post(e,t).then(function(e){return r.resolve(e)}).fail(function(e){return r.reject(e)}),r.promise()},d._get=function(e,t){e=e.match(/\/$/)?e:e+"/";var r=$.Deferred(),n=$.param(t);return e=e+"?"+n,$.get(e).then(function(e){return r.resolve(e)}).fail(function(e){return r.reject(e)}),r.promise()},d._doRequest=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments[2],n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=$.Deferred();e=e||new c({});var a=r?r[0]:this._layer,o=a.getOwsMethod(),s=a.getQueryUrl(),l=a.getInfoFormat(),u=r?r.map(function(e){return e.getWFSLayerName()}).join(","):a.getWFSLayerName(),d=n?a.getProjection().getCode():this._layer.getMapProjection().getCode();if(t=Object.assign(t,{SERVICE:"WFS",VERSION:"1.1.0",REQUEST:"GetFeature",TYPENAME:u,OUTPUTFORMAT:l,SRSNAME:d}),e){var p=e.getType(),f=e.getConfig(),h=void 0,v=ol.format.filter;switch(e=e.get(),p){case"bbox":h=(new ol.format.WFS).writeGetFeature({featureTypes:[a],filter:v.bbox("the_geom",e)});break;case"geometry":var g=f.spatialMethod,m=void 0===g?"intersects":g;h=(new ol.format.WFS).writeGetFeature({featureTypes:[a],filter:v[m]("the_geom",e)});break;case"expression":h=(new ol.format.WFS).writeGetFeature({featureTypes:[a],filter:null});break;case"all":return request=this._post(s,t),request}t.FILTER=("("+h.children[0].innerHTML+")").repeat(r?r.length:1);var y="GET"===o&&"geometry"!==p?this._get(s,t):this._post(s,t);y.then(function(e){i.resolve(e)}).fail(function(e){200===e.status?i.resolve(e.responseText):i.reject(e)})}else i.reject();return i.promise()},t.exports=n},{"core/layers/filter/filter":47,"core/layers/providers/provider":68,"core/utils/utils":92}],72:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};c(this,e),this._name="wms",this._projections={map:null,layer:null}}var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("core/applicationstate"),s=n(o),l=e("constant"),u=e("core/utils/utils"),c=u.base,d=u.inherit,p=u.appendParams,f=u.XHR,h=(u.getTimeoutPromise,e("core/utils/ol")),v=e("core/layers/providers/provider"),g=[101,101],m=h.getDPI();d(i,v);var y=i.prototype;y._getRequestParameters=function(e){var t=e.layers,r=e.feature_count,n=e.coordinates,i=e.infoFormat,o=e.query_point_tolerance,u=void 0===o?l.QUERY_POINT_TOLERANCE:o,c=e.resolution,d=e.size,p=t?t.map(function(e){return e.getWMSInfoLayerName()}).join(","):this._layer.getWMSInfoLayerName(),f=h.getExtentForViewAndSize(n,c,0,d),v=Math.floor((n[0]-f[0])/c),g=Math.floor((f[3]-n[1])/c),y={},_=u.unit,b=u.value;if("map"===_){var w=ol.geom.Polygon.fromCircle(new ol.geom.Circle(n,b)),x=new ol.format.WKT;y={FILTER_GEOM:x.writeGeometry(w)}}else y={FI_POINT_TOLERANCE:b,FI_LINE_TOLERANCE:b,FI_POLYGON_TOLERANCE:b,G3W_TOLERANCE:b*c,I:v,J:g};var S=a({SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetFeatureInfo",CRS:this._projections.map.getCode(),LAYERS:p,QUERY_LAYERS:p,filtertoken:s["default"].tokens.filtertoken,INFO_FORMAT:i,FEATURE_COUNT:r,WITH_GEOMETRY:!0,DPI:m},y,{WIDTH:d[0],HEIGHT:d[1]});"STYLES"in S||(S.STYLES="");var C="ne"===this._projections.map.getAxisOrientation().substr(0,2)?[f[1],f[0],f[3],f[2]]:f;return S.BBOX=C.join(","),S},y.query=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred(),n=this._layer.getInfoFormat()||"application/vnd.ogc.gml",i=this._layer.getProjection();this._projections.map=this._layer.getMapProjection()||i;var a=t.layers,o=void 0===a?[this._layer]:a,s=t.feature_count,l=void 0===s?10:s,u=t.size,c=void 0===u?g:u,d=t.coordinates,p=void 0===d?[]:d,f=t.resolution,h=t.query_point_tolerance,v=o[0],m=v.getQueryUrl(),y=v.isExternalWMS()||!/^\/ows/.test(m)?"GET":v.getOwsMethod(),_=this._getRequestParameters({layers:o,feature_count:l,coordinates:p,infoFormat:n,query_point_tolerance:h,resolution:f,size:c}),b={coordinates:p,resolution:f},w=this.getQueryResponseTimeoutKey({layers:o,resolve:r.resolve,query:b});return v.useProxy()?v.getDataProxyFromServer("wms",{url:m,params:_,method:y,headers:{"Content-Type":n}}).then(function(t){var n=e.handleQueryResponseFromServer(t,e._projections,o);r.resolve({data:n,query:b})}):this[y]({url:m,layers:o,params:_}).then(function(t){var n=e.handleQueryResponseFromServer(t,e._projections,o);r.resolve({data:n,query:b})})["catch"](function(e){return r.reject(e)})["finally"](function(){return clearTimeout(w)}),r.promise()},y.GET=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.params,n=t.split("SOURCE");return n.length&&(t=n[0],n=n.length>1?"&SOURCE"+n[1]:""),t=p(t,r),t=""+t+(n&&n),f.get({url:t})},y.POST=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.params;return f.post({url:t,data:r})},t.exports=i},{constant:5,"core/applicationstate":8,"core/layers/providers/provider":68,"core/utils/ol":90,"core/utils/utils":92}],73:[function(e,t,r){function n(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this),this._name="xml"}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("core/layers/providers/provider");a(n,s);var l=n.prototype;l.getData=function(){var e=$.Deferred();return e.promise()},t.exports=n},{"core/layers/providers/provider":68,"core/utils/utils":92}],74:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function i(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e("core/project/projectsregistry");this.setters={clearFeatures:function(){this._clearFeatures()},addFeature:function(e){this._addFeature(e)},deleteFeature:function(e){this._deleteFeature(e)},updateFeature:function(e){this._updateFeature(e)},setFeatures:function(e){this._setFeatures(e)},getFeatures:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred();return this._featuresstore.getFeatures(t).then(function(t){t.then(function(t){return e.emit("getFeatures",t),r.resolve(t)}).fail(function(e){return r.reject(e)})}).fail(function(e){return r.reject(e)}),r.promise()},commit:function(e){var t=this,r=$.Deferred();return this._featuresstore.commit(e).then(function(n){n.then(function(n){n&&n.result&&t.syncSelectionFilterFeatures(e),r.resolve(n)}).fail(function(e){return r.reject(e)})}).fail(function(e){r.reject(e)}),r.promise()},setColor:function(e){this._setColor(e)}},this.type=c.LayerTypes.TABLE,this._color=null,n.project=n.project||i.getCurrentProject(),this.layerId=r.id,r.urls=r.urls||{},r.editing={fields:[]},s(this,r,n),this._editatbleLayer,this.isEditable()&&(this.layerForEditing=new Promise(function(e,r){t.getEditingConfig().then(function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.vector,i=r.constraints,o=void 0===i?{}:i,s=r.capabilities,l=void 0===s?a.DEFAULT_EDITING_CAPABILITIES:s;t.config.editing.fields=n.fields,t.config.editing.format=n.format,t.config.editing.constraints=o,t.config.editing.capabilities=l,t.config.editing.style=n.style,t.config.editing.form={perc:null},t._setOtherConfigParameters(n),n.style&&t.setColor(n.style.color),t._editor=new d({layer:t}),e(t),t.setReady(!0)}).fail(function(e){r(t),t.setReady(!1)})}),this.state=_.merge({editing:{started:!1,modified:!1,ready:!1}},this.state)),this._featuresstore=new p({provider:this.providers.data})}var a=e("constant"),o=e("core/utils/utils"),s=o.base,l=o.inherit,u=e("core/catalog/cataloglayersstoresregistry"),c=e("./layer"),d=e("core/editing/editor"),p=e("./features/featuresstore"),f=e("./features/feature");l(i,c);var h=i.prototype;h.syncSelectionFilterFeatures=function(e){try{var t=u.getLayerById(this.getId());t.isGeoLayer()&&e.update.forEach(function(e){var r=e.id,n=e.geometry;t.getOlSelectionFeature(r)&&t.updateOlSelectionFeature({id:r,geometry:n})}),e["delete"].forEach(function(e){t.hasSelectionFid(e)&&t.excludeSelectionFid(e)})}catch(r){}},h.setFormPercentage=function(e){this.config.editing.form.perc=e},h.getFormPercentage=function(){return this.config.editing.form.perc},h.clone=function(){return _.cloneDeep(this)},h.cloneFeatures=function(){return this._featuresstore.clone()},h.setVectorUrl=function(e){this.vectorUrl=e},h.setProjectType=function(e){this.projectType=e},h._setColor=function(e){this._color=e},h.getColor=function(){return this._color},h.readFeatures=function(){return this._featuresstore.readFeatures()},h.getLayerForEditing=n(regeneratorRuntime.mark(function v(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.vectorurl,n=t.project_type;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r&&this.setVectorUrl(r),n&&this.setProjectType(n),this.setEditingUrl(),e=this.clone(),t.prev=4,t.next=7,e.layerForEditing;case 7:return t.abrupt("return",t.sent);case 10:return t.prev=10,t.t0=t["catch"](4),t.abrupt("return",t.t0);case 13:case"end":return t.stop()}},v,this,[[4,10]])})),h.getEditingSource=function(){return this._editor.getEditingSource()},h.readEditingFeatures=function(){return this._editor.readEditingFeatures()},h.getEditingLayer=function(){return this},h.isEditingLayer=function(){return!!this.config.editing},h.getEditingStyle=function(){return this.config.editing.style},h.setEditingStyle=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config.editing.style=e},h.getEditingConstrains=function(){return this.config.editing.constraints},h.getEditingCapabilities=function(){return this.config.editing.capabilities},h.isFieldRequired=function(e){var t=!1;return this.getEditingFields().forEach(function(r){if(e===r.name)return t=!!r.validate.required,!1}),t},h.unlock=function(){var e=$.Deferred();return this._featuresstore.unlock().then(function(){return e.resolve()}).fail(function(t){return e.reject(t)}),e.promise()},h._setOtherConfigParameters=function(e){},h.getEditingFields=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.config.editing.fields.length?this.config.editing.fields:this.config.fields;return e&&(t=t.filter(function(e){return e.editable})),t},h.isPkField=function(e){var t=this.getEditingFields().find(function(t){return t.name===e});return t&&t.pk},h.isEditingFieldEditable=function(e){var t=this.getEditingFields().find(function(t){return t.name===e});return!!t&&t.editable},h.getEditingNotEditableFields=function(){return this.config.editing.fields.filter(function(e){return!e.editable}).map(function(e){return e.name})},h.getEditingMediaFields=function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.config.editing.fields.filter(function(e){return"media"===e.input.type}).map(function(e){return e.name})},h.getFieldsLabel=function(){var e=[];return this.getEditingFields().forEach(function(t){return e.push(t.label)}),e},h.getDataFormat=function(){return this.config.editing.format},h.getEditingFormat=function(){return this.config.editing.format},h.isReady=function(){return this.state.editing.ready},h.setReady=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state.editing.ready=e},h.getEditingConfig=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=$.Deferred(),r=this.getProvider("data");return r.getConfig(e).then(function(e){return t.resolve(e)}).fail(function(e){return t.reject(e)}),t.promise()},h.addEditingConfigFieldOption=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.field,r=e.key,n=e.value,i=t.input.options;return i[r]=n,i[r]},h.getWidgetData=function(e){var t=this.getProvider("data"),r=$.Deferred();return t.getWidgetData(e).then(function(e){return r.resolve(e)}).fail(function(e){return r.reject(e)}),r.promise()},h.getCommitUrl=function(){return this.config.urls.commit},h.setCommitUrl=function(e){this.config.urls.commit=e},h.getEditingUrl=function(){return this.config.urls.editing},h.getUnlockUrl=function(){return this.config.url.unlock},h.setUnlockUrl=function(e){this.config.urls.unlock=e},h.getWidgetUrl=function(){return this.config.urls.widget},h.setDataUrl=function(e){this.config.urls.data=e},h.getDataUrl=function(){return this.config.urls.data},h.getConfigUrl=function(){return this.config.urls.config},h.setConfigUrl=function(e){this.config.urls.index=e},h.getEditor=function(){
return this._editor},h.isStarted=function(){return this.getEditor().isStarted()},h.setEditor=function(e){this._editor=e},h.getFeaturesStore=function(){return this._featuresstore},h.setFeaturesStore=function(e){this._featuresstore=e},h.setSource=function(e){this.setFeaturesStore(e)},h.getSource=function(){return this._featuresstore},h.getEditingStyle=function(){return this.config.editing.style},h._setFeatures=function(e){this._featuresstore.setFeatures(e)},h.addFeatures=function(e){var t=this;e.forEach(function(e){return t.addFeature(e)})},h._addFeature=function(e){this._featuresstore.addFeature(e)},h._deleteFeature=function(e){return e.getId()},h._updateFeature=function(e){},h._clearFeatures=function(){this._featuresstore.clearFeatures()},h.addLockIds=function(e){this._featuresstore.addLockIds(e)},h.setFieldsWithValues=function(e,t){var r=function i(e){var t={};return e.forEach(function(e){"child"===e.type?t[e.name]=i(e.fields):"null"===e.value&&(e.value=null),t[e.name]=e.value}),t},n=r(t);return e.setProperties(n),n},h.getFieldsWithValues=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.exclude||[],i=JSON.parse(JSON.stringify(this.getEditingFields())),a=void 0;if(a=e instanceof f?e:e instanceof ol.Feature?new f({feature:e}):e&&this.getFeatureById(e)){var o=a.getProperties();i=i.filter(function(e){return n.indexOf(e.name)===-1}),i.forEach(function(e){if(e.value=o[e.name],"child"!==e.type&&e.input&&"select_autocomplete"===e.input.type&&!e.input.options.usecompleter){var r=t.getEditingFields().find(function(t){return t.name===e.name}),n=r.input.options;e.input.options.loading=n.loading,e.input.options.values=n.values}void 0===e.validate&&(e.validate={}),e.forceNull=!1,e.validate.valid=!0,e.validate._valid=!0,e.validate.unique=!0,e.validate.required=void 0!==e.validate.required&&e.validate.required,e.validate.mutually_valid=!0,e.validate.empty=!e.validate.required,e.validate.message=null})}return i},h.createNewFeature=function(){var e=new ol.Feature,t={};return this.getEditingFields().forEach(function(e){return t[e.name]=null}),e.setProperties(t),e=new f({feature:e}),e.setNew(),e},t.exports=i},{"./features/feature":43,"./features/featuresstore":44,"./layer":52,constant:5,"core/catalog/cataloglayersstoresregistry":9,"core/editing/editor":19,"core/project/projectsregistry":83,"core/utils/utils":92}],75:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];a(this,e,t),this._mapLayer=null,this.type=l.LayerTypes.VECTOR,this.setup(e,t),this.onafter("setColor",function(e){})}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=i.mixin,l=e("./layer"),u=e("./tablelayer"),c=e("./geolayermixin"),d=e("./map/vectorlayer");o(n,u),s(n,c);var p=n.prototype;p.getEditingLayer=function(){return this.getMapLayer().getOLLayer()},p.resetEditingSource=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.getMapLayer().resetSource(e)},p._setOtherConfigParameters=function(e){this.config.editing.geometrytype=e.geometrytype},p.getEditingGeometryType=function(){return this.config.editing.geometrytype},p.getMapLayer=function(){if(this._mapLayer)return this._mapLayer;var e=this.getId(),t=this.getGeometryType(),r=this.getColor(),n=this.isEditingLayer()?this.getEditingStyle():this.getCustomStyle(),i=this.getProvider("data");return this._mapLayer=new d({id:e,geometryType:t,color:r,style:n,provider:i,features:this._editor&&this._editor.getEditingSource().getFeaturesCollection()}),this._mapLayer},t.exports=n},{"./geolayermixin":50,"./layer":52,"./map/vectorlayer":62,"./tablelayer":74,"core/utils/utils":92}],76:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("store/map-layers"),a=n(i);t.exports=a["default"]},{"store/map-layers":405}],77:[function(e,t,r){var n=e("core/utils/parsers"),i=n.response;t.exports=i},{"core/utils/parsers":91}],78:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=e("core/utils/utils"),o=a.base,s=a.inherit,l=a.toRawType,u=e("core/applicationservice"),c=e("core/g3wobject"),d=e("gui/gui"),p=e("gui/component/componentsfactory"),f=e("core/project/projectsregistry"),h=e("core/plugin/pluginsregistry"),v=e("core/i18n/i18n.service"),g=v.addI18nPlugin,m=1e4,y=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.name,n=void 0===r?null:r,i=t.config,a=void 0===i?h.getPluginConfig(n):i,s=t.service,l=void 0===s?null:s,u=t.dependencies,c=void 0===u?[]:u,p=t.i18n,f=void 0===p?null:p,v=t.fontClasses,g=void 0===v?[]:v,y=t.api,_=void 0===y?{}:y;o(this),this.setName(n),this.setConfig(a),this.setLocale(f),this.setService(l),this.setDependencies(c),this.addFontClasses(g),this.setApi(_),this.setHookService(null),this._ready=!1,this.hookservices={search:d.getService("search"),tools:d.getService("tools")},this._timeout=setTimeout(function(){h.removeLoadingPlugin(e.name,e._ready),e.removeLayout()},m)};s(y,c);var _=y.prototype;_.setName=function(e){this.name=e},_.getName=function(){return this.name},_.setConfig=function(e){this.config="Object"===l(e)?e:null},_.getConfig=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.name;return this.config||h.getPluginConfig(e)},_.setLocale=function(e){e&&this.name&&g({name:this.name,config:e})},_.setService=function(e){this.service=e,e&&e.setPlugin(this)},_.getService=function(){return this.service},_.setDependencies=function(e){this.dependencies=e},_.setApi=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._api=e,e.getConfig=this._api.getConfig},_.getApi=function(){return this._api},_.setHookService=function(e){this._hook=e},_.getHookService=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"tools";return this.hookservices[e]},_.setLayout=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u.cloneLayout("app");u.setLayout(this.name,e)},_.setCurrentLayout=function(){u.setCurrentLayout(this.name)},_.removeLayout=function(){u.removeLayout(this.name)},_.setReady=function(e){var t=this;this._ready=e,this._ready&&this.setLayout(),this.emit("set-ready",e,this.name),setTimeout(function(){clearTimeout(t._timeout),h.removeLoadingPlugin(t.name,t._ready)},0)},_.isReady=function(){var e=this;return new Promise(function(t){e._ready?t(e._ready):e.once("set-ready",function(r){e._ready=r,t(e._ready)})})},_.isCurrentProjectCompatible=function(e){return e===f.getCurrentProject().getGid()},_.registerPlugin=function(e){var t=this.isCurrentProjectCompatible(e);return t?h.registerPlugin(this):(h.removeLoadingPlugin(this.name,!1),clearTimeout(this._timeout)),t},_.getDependencyPlugins=function(e){var t=this;return this.dependencies=e||this.dependencies,Promise.all(this.dependencies.map(function(e){return t.getDependencyPlugin(e)}))},_.getDependencyPluginsObject=function(){var e=n(regeneratorRuntime.mark(function t(e){var r,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={},t.next=3,this.getDependencyPlugins(e);case 3:return n=t.sent,this.dependencies.forEach(function(e,t){return r[e]=n[t]}),t.abrupt("return",r);case 6:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),_.getDependencyPlugin=function(e){return h.isTherePlugin(e)?new Promise(function(t){var r=h.getPlugin(e);r&&r.isReady().then(function(){return t(r.getApi())})||h.onafter("registerPlugin",function(r){r.name===e&&r.isReady().then(function(){t(r.getApi())})})}):Promise.reject({error:"no plugin"})},_.setHookLoading=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.hook,r=void 0===t?"tools":t,n=e.loading,i=void 0!==n&&n;this.getHookService(r).setLoading(i)},_.addToolGroup=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.hook,r=void 0===t?"tools":t,n=e.position,i=e.title;this.getHookService(r).addToolGroup(n,i)},_.removeToolGroup=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.hook,r=e.group;this.getHookService(t).removeToolGroup(r.title)},_.addTools=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.hook,n=void 0===r?"tools":r,i=t.action,a=t.html,o=t.offline,s=void 0===o||o,l=t.icon,u=t.name,c=t.type,d=t.options,p=void 0===d?{}:d,f=t.loading,h=void 0!==f&&f,v=t.disabled,g=void 0!==v&&v,m=t.state,y=void 0===m?{type:null,message:null}:m,_=arguments[1];if(i||c){this.setHookService(n);var b=(this.config.configs||[this.config]).map(function(t){return{icon:l,type:c,name:t.name||u,html:a,loading:h,disabled:g,options:p,offline:s,action:i&&i.bind(e,t),state:y}});return this.getHookService(n).addTools(b,_),b}return this.removeToolGroup({hook:n,group:_}),[]},_.setToolState=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.state,n=void 0===r?{type:null,message:null}:r;this.hookservices[this._hook].setToolState({id:t,state:n})},_.removeTools=function(){this.hookservices[this._hook].removeTools()},_.createSideBarComponent=function(e){var t,r,n,a,o,s,l,u,c,f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t={},id=t.id,title=t.title,r=t.open,open=void 0!==r&&r,n=t.collapsible,collapsible=void 0===n||n,a=t.mobile,mobile=void 0===a||a,o=t.isolate,isolate=void 0!==o&&o,s=t.closewhenshowviewportcontent,closewhenshowviewportcontent=void 0===s||s,l=t.iconConfig,iconConfig=void 0===l?{}:l,u=t.events,events=void 0===u?{}:u,c=t.sidebarOptions,sidebarOptions=void 0===c?{position:1}:c,t),h=i({},f,{iconColor:f.iconConfig.color,icon:d.getFontClass(f.iconConfig.icon)});delete h.iconConfig;var v=p.build({vueComponentObject:e},h);return d.addComponent(v,"sidebar",f.sidebarOptions),this.once("unload",function(){return d.removeComponent(id,"sidebar",f.sidebarOptions)}),v},_.unload=function(){this.service&&this.service.clearAllEvents(),this.emit("unload")},_.load=function(){},_.getProject=function(){return f.getCurrentProject()},_.addDependency=function(e){this.dependencies.push(e)},_.addFontClass=function(e){var t=e.name,r=e.className;Vue.prototype.g3wtemplate.addFontClass({name:t,className:r})},_.addFontClasses=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach(function(t){return e.addFontClass(t)})},t.exports=y},{"core/applicationservice":7,"core/g3wobject":26,"core/i18n/i18n.service":27,"core/plugin/pluginsregistry":80,"core/project/projectsregistry":83,"core/utils/utils":92,"gui/component/componentsfactory":141,"gui/gui":150}],79:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l(this,t),this.plugin,this._api={own:null,dependencies:{}},this._pluginEvents={},this._appEvents=[],this.currentLayout=c.getCurrentLayoutName(),this.vm=new Vue,this.unwatch=this.vm.$watch(function(){return o["default"].gui.layout.__current},function(t){return e.currentLayout=t!==e.getPlugin().getName()?t:e.currentLayout})}var a=e("core/applicationstate"),o=n(a),s=e("core/utils/utils"),l=s.base,u=s.inherit,c=e("core/applicationservice"),d=e("core/g3wobject");u(i,d);var p=i.prototype;p.init=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config=e},p.setCurrentLayout=function(){c.setCurrentLayout(this.getPlugin().getName())},p.resetCurrentLayout=function(){c.setCurrentLayout(this.currentLayout)},p.setPlugin=function(e){this.plugin=e},p.getPlugin=function(){return this.plugin},p.isIframe=function(){return c.isIframe()},p.getCurrentProject=function(){return c.getCurrentProject()},p.getGid=function(){var e=this.config.gid;return e&&e.split(":")[1]},p.getConfig=function(){return this.config},p.setConfig=function(e){this.config=e},p.setApi=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dependency,r=e.api;t?this._api.dependencies[t]=r:this._api.own=r},p.getApi=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dependency;return t&&this._api.dependencies[t]||this._api.own},p.initEvents=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];for(var t in e){var r=e[t];this._pluginEvents[r]={}}},p.registerWindowEvent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.evt,r=e.cb;c.registerWindowEvent({evt:t,cb:r})},p.unregisterWindowEvent=function(e){var t=e.evt,r=e.cb;c.unregisterWindowEvent({evt:t,cb:r})},p.subscribeEvent=function(e){var t=e.name,r=e.once,n=void 0!==r&&r,i=e.owner,a=e.listener;this._pluginEvents[t]=this._pluginEvents[t]?this._pluginEvents[t]:{},this._pluginEvents[t][i]=a,n?this.once(t,a):this.on(t,a)},p.triggerEvent=function(e){var t=e.name,r=e.params,n=void 0===r?{}:r;this.emit(t,n)},p.unsubscribeEvent=function(e){var t=e.name,r=e.owner,n=this._pluginEvents[t][r];this.removeEvent(t,n),delete this._pluginEvents[t][r]},p.unsubscribeAllEvents=function(){for(var e in this._pluginEvents)this.removeEvent(e),delete this._pluginEvents[e]},p.clearAllEvents=function(){this.unsubscribeAllEvents(),this.unwatch(),this.vm=null,this._pluginEvents=null},p.loadPlugin=function(){return!0},p.clear=function(){},t.exports=i},{"core/applicationservice":7,"core/applicationstate":8,"core/g3wobject":26,"core/utils/utils":92}],80:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("store/plugins"),a=n(i);t.exports=a["default"]},{"store/plugins":406}],81:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=this;arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._currentLayerStore=l.getCurrentProject().getLayersStore(),l.onbefore("setCurrentProject",function(t){return e._currentLayerStore=t.getLayersStore()}),c(this)}var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("core/applicationstate"),s=n(o),l=e("core/project/projectsregistry"),u=e("core/utils/utils"),c=u.base,d=u.inherit,p=u.convertObjectToUrlParams,f=e("core/g3wobject"),h={pdf:"application/pdf",jpg:"image/jpeg"},v={SERVICE:"WMS",VERSION:"1.3.0"},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.field,r=e.values,n=e.template,i=e.download,o=void 0!==i&&i,l=r.length>1,u=""+t+(l?" IN (":"=")+r.map(function(e){return"'"+e+"'"}).join()+(l?")":""),c=a({},v,{REQUEST:"GetPrintAtlas",EXP_FILTER:u,TEMPLATE:n,filtertoken:s["default"].tokens.filtertoken});return o&&(c.DOWNLOAD=1),c},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.rotation,n=t.dpi,i=t.format,o=t.crs,l=t.template,u=t.maps,c=void 0===u?[]:u,d=t.labels,p=void 0===d?[]:d,f=t.is_maps_preset_theme,h=e.map(function(e){return e.getPrintLayerName()}).join(),g=e.map(function(e){return e.getStyle()}).join(","),m=a({},v,{REQUEST:"GetPrint",TEMPLATE:l,DPI:n,STYLES:g,FORMAT:i,CRS:o,filtertoken:s["default"].tokens.filtertoken});return f||(m.LAYERS=h),c.forEach(function(e){var t=e.name,n=e.scale,i=e.extent,a=e.preset_theme;m[t+":SCALE"]=n,m[t+":EXTENT"]=i,m[t+":ROTATION"]=r,f&&void 0===a&&(m[t+":LAYERS"]=h)}),p.forEach(function(e){return m[e.id]=e.text}),m},y=function(e){var t=e.url,r=e.params,n=e.mime_type;return new Promise(function(e,i){t=t+"?"+p(r),e({url:t,layers:!0,mime_type:n})})},_=function(e){var t=e.url,r=e.params,n=e.mime_type;return new Promise(function(e,i){var a=new XMLHttpRequest;a.open("POST",t,!0),a.responseType="blob",a.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),a.onload=function(){if(200===a.status)try{window.URL=window.URL||window.webkitURL;var t=window.URL.createObjectURL(a.response);e({url:t,layers:!0,mime_type:n})}catch(r){i(r)}else 500===a.status&&i()},a.onerror=function(){i()},a.send(p(r))})};d(i,f);var b=i.prototype;b.POST=_,b.GET=y,b._getAtlasParamsFromOptions=g,b._getParamsFromOptions=m,b.getUrl=function(){return this._currentLayerStore.getWmsUrl()},b.printAtlas=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",r=this.getUrl(),n=this._getAtlasParamsFromOptions(e);return this[t]({url:r,params:n,mime_type:h.pdf})},b.print=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",r=this.getUrl(),n=this._currentLayerStore.getLayers({PRINTABLE:{scale:e.scale},SERVERTYPE:"QGIS"}).reverse();if(n.length){e.crs=this._currentLayerStore.getProjection().getCode();var i=this._getParamsFromOptions(n,e),a=h[i.FORMAT];return this[t]({url:r,params:i,mime_type:a})}return Promise.resolve({layers:!1})},t.exports=i},{"core/applicationstate":8,"core/g3wobject":26,"core/project/projectsregistry":83,"core/utils/utils":92}],82:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function i(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.catalog_tab=e.toc_tab_default||e._catalog_tab||"layers",e.ows_method=e.ows_method||"GET",e.toc_layers_init_status=e.toc_layers_init_status||o.TOC_LAYERS_INIT_STATUS,e.toc_themes_init_status=e.toc_themes_init_status||o.TOC_THEMES_INIT_STATUS,e.query_point_tolerance=e.query_point_tolerance||o.QUERY_POINT_TOLERANCE,this.state=e,this.urls={map_themes:"/"+this.getType()+"/api/prjtheme/"+this.getId()+"/",expression_eval:"/api/expression_eval/"+this.getId()+"/",vector_data:this.getVectorUrl()+"data/"+this.getType()+"/"+this.getId()+"/"},this._processLayers(),this.state.crs=p(this.state.crs),this._projection=g.get(this.state.crs),this._layersStore=this._buildLayersStore(),this.setters={setBaseLayer:function(e){var t=this;this.state.baselayers.forEach(function(r){t._layersStore.getLayerById(r.id).setVisible(r.id===e),r.visible=r.id===e})}},this.setSearchEndPoint(),l(this)}var o=e("../../constant"),s=e("core/utils//utils"),l=s.base,u=s.inherit,c=s.XHR,d=e("core/utils/geo"),p=d.crsToCrsObject,f=e("core/g3wobject"),h=e("core/layers/layerfactory"),v=e("core/layers/layersstore"),g=e("g3w-ol/projection/projections");u(a,f);var m=a.prototype;m.getSearchEndPoint=function(){return this.state.search_endpoint},m.setSearchEndPoint=function(){var e=this.state,t=e.search_endpoint,r=e.search,n=void 0===r?[]:r;n.forEach(function(e){return e.search_endpoint=t})},m.getAliasUrl=function(){return this.state.aliasUrl},m.getActiveCatalogTab=function(){return this.state.catalog_tab},m.setActiveCatalogTab=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"layers";this.state.catalog_tab=e},m.isWmsUseLayerIds=function(){return this.state.wms_use_layer_ids},m.getContextBaseLegend=function(){return this.state.context_base_legend},m.getQueryPointTolerance=function(){return this.state.query_point_tolerance},m.getQueryFeatureCount=function(){return this.state.feature_count||5},m.isQueryMultiLayers=function(e){return this.state.querymultilayers&&this.state.querymultilayers.indexOf(e)!==-1},m.getRelations=function(){return this.state.relations},m.getRelationById=function(e){return this.state.relations.find(function(t){return t.id===e})},m.getRelationsByLayerId=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layerId,r=e.type;return this.state.relations.filter(function(e){return e.referencedLayer===t&&(!r||e.type===r)})},m.getOwsMethod=function(){return this.state.ows_method},m._processLayers=function(){var t=this,r=function u(e){for(var r=function(r){var n=e[r],i=void 0;void 0!==n.id&&t.state.layers.forEach(function(a){if(i=a.name,n.id===a.id)return n.name=a.name,a.wmsUrl=t.getWmsUrl(),a.project=t,e[r]=Object.assign(a,n),!1}),Array.isArray(n.nodes)&&(n.title=n.name,u(n.nodes))},n=0;n<e.length;n++)r(n)};r(this.state.layerstree);for(var n=e("core/applicationservice"),i=n.getBaseLayerId(),a=0;a<this.state.baselayers.length;a++){var o=this.state.baselayers[a],s=null!==i?i:this.state.initbaselayer,l=s&&o.id===s||!!o.fixed;o.visible=l,o.baselayer=!0}},m._buildLayersStore=function(){var e=this,t=new v,r=this.state.overviewprojectgid?this.state.overviewprojectgid.gid:null;t.setOptions({id:this.state.gid,projection:this._projection,extent:this.state.extent,initextent:this.state.initextent,wmsUrl:this.state.WMSUrl,catalog:this.state.gid!==r});var n=this.getLayers();return n.forEach(function(r){r.crs=p(r.crs),r.projection=r.crs?g.get(r.crs):e._projection,r.ows_method=e.getOwsMethod(),r.wms_use_layer_ids=e.state.wms_use_layer_ids;var n=h.build(r,{project:e});n&&t.addLayer(n)}),t.createLayersTree(this.state.name,{layerstree:this.state.layerstree,expanded:"not_collapsed"===this.state.toc_layers_init_status}),t},m.getLayerById=function(e){return this._layersStore.getLayerById(e)},m.getLayers=function(){return[].concat(i(this.state.layers),i(this.state.baselayers))},m.getBaseLayers=function(){return this.state.baselayers},m.getConfigLayers=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.key;return t?this.state.layers.filter(function(e){return void 0!==e[t]}):this.state.layers},m.setLegendPosition=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"tab";this.state.legend_position=e},m.getLegendPosition=function(){return this.state.legend_position},m.getThumbnail=function(){return this.state.thumbnail},m.getMetadata=function(){return this.state.metadata||{}},m.getState=function(){return this.state},m.getPrint=function(){return this.state.print||[]},m.getSearches=function(){return this.state.search||[]},m.getVectorUrl=function(){return this.state.vectorurl},m.getRasterUrl=function(){return this.state.rasterurl},m.getId=function(){return this.state.id},m.getType=function(){return this.state.type},m.getGid=function(){return this.state.gid},m.getName=function(){return this.state.name},m.getOverviewProjectGid=function(){return this.state.overviewprojectgid?this.state.overviewprojectgid.gid:null},m.getCrs=function(){return this._projection.getCode()},m.getQgisVersion=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=["major","minor","patch"].indexOf(t);return r===-1?this.state.qgis_version:+this.state.qgis_version.split(".")[r]},m.getProjection=function(){return this._projection},m.getWmsUrl=function(){return this.state.WMSUrl},m.getInfoFormat=function(){return"application/vnd.ogc.gml"},m.getLayersStore=function(){return this._layersStore},m.setLayersTreePropertiesFromMapTheme=function(){var e=n(regeneratorRuntime.mark(function t(e){var r,n,i,a,o,s,l=this,u=e.map_theme,c=e.layerstree,d=void 0===c?this.state.layerstree:c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMapThemeFromThemeName(u);case 2:return r=e.sent,n=r.layerstree,i={layers:{}},a=[],o=[],s=function t(e,n,s){e.forEach(function(e,u){if(e.nodes)o.push({node:e,group:n[u]}),t(e.nodes,n[u].nodes,s&&e.checked);else if(e.style=r.styles[e.id],n[u].checked!==e.visible&&(i.layers[e.id]={visibility:!0,style:!1}),n[u].checked=e.visible,e.style){var c=new Promise(function(t,r){var n=function(e){void 0===i.layers[e.id]&&(i.layers[e.id]={visibility:!1,style:!1}),i.layers[e.id].style=l.getLayerById(e.id).setCurrentStyle(e.style),t()};l.getLayersStore()&&n(e)});a.push(c)}})},s(n,d),e.next=11,Promise.allSettled(a);case 11:return o.forEach(function(e){var t=e.group,r=e.node,n=r.checked,i=r.expanded;t.checked=n,t.expanded=i}),e.abrupt("return",i);case 13:case"end":return e.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),m.getMapThemeFromThemeName=function(){var e=n(regeneratorRuntime.mark(function t(e){var r,n,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.state.map_themes.find(function(t){return t.theme===e}),!r){t.next=8;break}if(n=r.layerstree,void 0!==n){t.next=8;break}return t.next=6,this.getMapThemeConfiguration(e);case 6:i=t.sent,r.layerstree=i;case 8:return t.abrupt("return",r);case 9:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),m.getMapThemeConfiguration=function(){var e=n(regeneratorRuntime.mark(function t(e){var r,n,i,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=void 0,n=""+this.urls.map_themes+e+"/",t.prev=2,t.next=5,c.get({url:n});case 5:i=t.sent,a=i.result,o=i.data,a&&(r=o),t.next=12;break;case 10:t.prev=10,t.t0=t["catch"](2);case 12:return t.abrupt("return",r);case 13:case"end":return t.stop()}},t,this,[[2,10]])}));return function(t){return e.apply(this,arguments)}}(),m.getUrl=function(e){return this.urls[e]},t.exports=a},{"../../constant":5,"core/applicationservice":7,"core/g3wobject":26,"core/layers/layerfactory":53,"core/layers/layersstore":54,"core/utils//utils":92,"core/utils/geo":89,"g3w-ol/projection/projections":135}],83:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("store/projects"),a=n(i);t.exports=a["default"]},{"store/projects":407}],84:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Date.now(),r=e.id||"id_"+t,n=e.name||"name_"+t,i=e.origname||"origname_"+t;this.state={id:r,name:n,origname:i,father:e.referencedLayer,child:e.referencingLayer,fatherField:e.fieldRef.referencedField,childField:e.fieldRef.referencingField,type:e.type,loading:!1},a(this)}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("core/g3wobject");o(n,s);var l=n.prototype;l.getId=function(){return this.state.id},l.setId=function(e){this.state.id=e},l.getName=function(){return this.state.name},l.setName=function(e){this.state.name=e},l.getTitle=function(){return this.state.title},l.setTitle=function(e){return this.state.title=e},l.getChild=function(){return this.state.child},l.getFather=function(){return this.state.father},l.getState=function(){return this.state},l.getType=function(){return this.state.type},l.getFields=function(){return{father:this.state.fatherField,child:this.state.childField}},l.getFatherField=function(){return this.state.fatherField},l.getChildField=function(){return this.state.childField},l.setLoading=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state.loading=e},l.isLoading=function(){return this.state.loading},t.exports=n},{"core/g3wobject":26,"core/utils/utils":92}],85:[function(e,t,r){function n(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.relations;this._relations={},this._length=r?r.length:0,this._relationsInfo={children:{},fathers:{},father_child:{}};var n=void 0;r.forEach(function(t){n=new u(t),e._relations[n.getId()]=n}),this._createRelationsInfo(),o(this)}var i=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=e("core/utils/utils"),o=a.base,s=a.inherit,l=e("core/g3wobject"),u=e("./relation");s(n,l);var c=n.prototype;c._createRelationsInfo=function(){var e=this,t=void 0,r=void 0;Object.entries(this._relations).forEach(function(n){var a=i(n,2),o=a[0],s=a[1];t=s.getFather(),r=s.getChild(),e._relationsInfo.father_child[t+r]=o,e._relationsInfo.fathers[t]||(e._relationsInfo.fathers[t]=[]),e._relationsInfo.children[r]||(e._relationsInfo.children[r]=[]),e._relationsInfo.fathers[t].push(r),e._relationsInfo.children[r].push(t)})},c._clearRelationsInfo=function(){this._relationsInfo={children:{},fathers:{},father_children:{}}},c._reloadRelationsInfo=function(){this._clearRelationsInfo(),this._createRelationsInfo()},c.getLength=function(){return this._length},c.getRelations=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=void 0===t?null:t;if(r){if(["ONE","MANY"].indexOf(r)!==-1){var n={};for(var i in this._relations){var a=this._relations[i];a.getType()===r&&(n[i]=a)}return n}return{}}return this._relations},c.getArray=function(){var e=[];return Object.entries(this._relations).forEach(function(t){var r=i(t,2),n=(r[0],r[1]);e.push(n)}),e},c.setRelations=function(e){this._relations=Array.isArray(e)?e:[]},c.getRelationById=function(e){return this._relations[e]},c.getRelationByFatherChildren=function(e,t){var r=this._relationsInfo.father_child[e+t];return this.getRelationById(r)},c.addRelation=function(e){e instanceof u&&(this._relations[e.getId()]=e,this._reloadRelationsInfo())},c.removeRelation=function(e){var t=void 0;e instanceof u&&(t=e.getId(),delete this._relations[t],this._reloadRelationsInfo())},c.hasChildren=function(e){var t=this.getChildren(e);return!!t&&!!t.length},c.hasFathers=function(e){var t=this.getFathers(e);return!!t&&!!t.length},c.getChildren=function(e){return this.isFather(e)?this._relationsInfo.fathers[e]:null},c.getFathers=function(e){return this.isChild(e)?this._relationsInfo.children[e]:null},c.isChild=function(e){return!!this._relationsInfo.children[e]},c.isFather=function(e){return!!this._relationsInfo.fathers[e]},t.exports=n},{"./relation":84,"core/g3wobject":26,"core/utils/utils":92}],86:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("services/relations"),a=n(i);t.exports=a["default"]},{"services/relations":395}],87:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("services/router"),a=n(i);t.exports=a["default"]},{"services/router":396}],88:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("services/tasks"),a=n(i);t.exports=a["default"]},{"services/tasks":398}],89:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=e("../../constant"),u=n(l),c=e("core/utils/utils"),d=c.toRawType,p=c.uniqueId,f=e("core/layers/map/wmslayer"),h=e("core/layers/filter/filter"),v=e("core/utils/parsers"),g=v.response,m=e("core/map/maplayersstoresregistry"),y=e("gui/gui"),b=u["default"].GEOMETRY_FIELDS,w=u["default"].QUERY_POINT_TOLERANCE,x=u["default"].G3W_FID,S=u["default"].GEOMETRY_TYPES,C={GeometryTypes:S,removeZValueToOLFeatureGeometry:function(){
var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.feature,r=e.geometryType,n=t.getGeometry();if(n){r=r||n.getType();var i=n.getCoordinates();switch(r){case S.POINT:3===i.length&&(i.splice(2),t.getGeometry().setCoordinates(i));break;case S.MULTIPOINT:case S.LINESTRING:case S.LINE:i.forEach(function(e){return e.splice(2)}),t.getGeometry().setCoordinates(i);break;case S.MULTILINESTRING:case S.MULTILINE:i.forEach(function(e){e.forEach(function(e){return e.splice(2)})}),t.getGeometry().setCoordinates(i);break;case S.POLYGON:i[0].forEach(function(e){return e.splice(2)}),t.getGeometry().setCoordinates(i);break;case S.MULTIPOLYGON:i.forEach(function(e){e[0].forEach(function(e){return e.splice(2)})}),t.getGeometry().setCoordinates(i)}}return t},addZValueToOLFeatureGeometry:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.feature,r=e.geometryType,n=t.getGeometry();r=r||n.getType();var i=n.getCoordinates();switch(r){case S.POINTZ:case S.POINTM:case S.POINTZM:case S.POINT25D:i.push(0),t.getGeometry().setCoordinates(i);break;case S.MULTIPOINTZ:case S.MULTIPOINTM:case S.MULTIPOINTZM:case S.MULTIPOINT25D:case S.LINESTRINGZ:case S.LINESTRINGM:case S.LINESTRINGZM:case S.LINESTRING25D:case S.LINEZ:case S.LINEM:case S.LINEZM:case S.LINE25D:i.forEach(function(e){return e.push(0)}),t.getGeometry().setCoordinates(i);break;case S.MULTILINESTRINGZ:case S.MULTILINESTRINGM:case S.MULTILINESTRINGZM:case S.MULTILINESTRING25D:case S.MULTILINEZ:case S.MULTILINEM:case S.MULTILINEZM:case S.MULTILINE25D:i.forEach(function(e){e.forEach(function(e){return e.push(0)})}),t.getGeometry().setCoordinates(i);break;case S.POLYGONZ:case S.POLYGONM:case S.POLYGONZM:case S.POLYGON25D:i[0].forEach(function(e){return e.push(0)}),t.getGeometry().setCoordinates(i);break;case S.MULTIPOLYGONZ:case S.MULTIPOLYGONM:case S.MULTIPOLYGOZM:case S.MULTIPOLYGON25D:i.forEach(function(e){e[0].forEach(function(e){return e.push(0)})}),t.getGeometry().setCoordinates(i)}return t},getOLGeometry:function(e){switch(e){case S.LINESTRINGZ:case S.LINESTRINGM:case S.LINESTRINGZM:case S.LINESTRING25D:case S.LINE:case S.LINEZ:case S.LINEM:case S.LINEZM:case S.LINE25D:e="LineString";break;case S.MULTILINESTRINGZ:case S.MULTILINESTRINGM:case S.MULTILINESTRINGZM:case S.MULTILINESTRING25D:case S.MULTILINE:case S.MULTILINEZ:case S.MULTILINEM:case S.MULTILINEZM:case S.MULTILINE25D:e="MultiLineString";break;case S.POINTZ:case S.POINTM:case S.POINTZM:case S.POINT25D:e="Point";break;case S.MULTIPOINTZ:case S.MULTIPOINTM:case S.MULTIPOINTZM:case S.MULTIPOINT25D:e="MultiPoint";break;case S.POLYGONZ:case S.POLYGONM:case S.POLYGONZM:case S.POLYGON25D:e="Polygon";break;case S.MULTIPOLYGONZ:case S.MULTIPOLYGONM:case S.MULTIPOLYGONZM:case S.MULTIPOLYGON25D:e="MultiPolygon"}return e},isMultiGeometry:function(e){return[S.MULTIPOINT,S.MULTIPOINTZ,S.MULTIPOINTZM,S.MULTIPOINTM,S.MULTIPOINT25D,S.MULTILINESTRING,S.MULTILINESTRINGZ,S.MULTILINESTRINGM,S.MULTILINESTRINGZM,S.MULTILINESTRING25D,S.MULTILINE,S.MULTILINEZ,S.MULTILINEM,S.MULTILINEZM,S.MULTILINE25D,S.MULTIPOLYGON,S.MULTIPOLYGONZ,S.MULTIPOLYGONM,S.MULTIPOLYGONZM,S.MULTIPOLYGON25D].indexOf(e)!==-1},getAllPointGeometryTypes:function(){return[S.POINT,S.POINTZ,S.POINTM,S.POINTZM,S.POINT25D,S.MULTIPOINT,S.MULTIPOINTZ,S.MULTIPOINTM,S.MULTIPOINTZM,S.MULTIPOINT25D]},isPointGeometryType:function(e){return C.getAllPointGeometryTypes().indexOf(e)!==-1},getAllLineGeometryTypes:function(){return[S.LINESTRING,S.LINESTRINGZ,S.LINESTRINGM,S.LINESTRINGZM,S.LINESTRING25D,S.MULTILINESTRING,S.MULTILINESTRINGZ,S.MULTILINESTRINGM,S.MULTILINESTRINGZM,S.MULTILINESTRING25D,S.LINE,S.LINEZ,S.LINEM,S.LINEZM,S.LINE25D,S.MULTILINE,S.MULTILINEZ,S.MULTILINEM,S.MULTILINEZM,S.MULTILINE25D]},isLineGeometryType:function(e){return C.getAllLineGeometryTypes().indexOf(e)!==-1},getAllPolygonGeometryTypes:function(){return[S.POLYGON,S.POLYGONZ,S.POLYGONM,S.POLYGONZM,S.POLYGON25D,S.MULTIPOLYGON,S.MULTIPOLYGONZ,S.MULTIPOLYGONM,S.MULTIPOLYGONZM,S.MULTIPOLYGON25D]},isPolygonGeometryType:function(e){return C.getAllPolygonGeometryTypes().indexOf(e)!==-1},is3DGeometry:function(e){return[S.POINTZ,S.POINTM,S.POINTZM,S.POINT25D,S.LINESTRINGZ,S.LINESTRINGM,S.LINESTRINGZM,S.LINESTRING25D,S.MULTILINESTRINGZ,S.MULTILINESTRINGM,S.MULTILINESTRINGZM,S.MULTILINESTRING25D,S.LINEZ,S.LINEM,S.LINEZM,S.LINE25D,S.MULTILINEZ,S.MULTILINEM,S.MULTILINEZM,S.MULTILINE25D,S.POLYGONZ,S.POLYGONM,S.POLYGONZM,S.POLYGON25D,S.MULTIPOLYGONZ,S.MULTIPOLYGONM,S.MULTIPOLYGONZM,S.MULTIPOLYGON25D].find(function(t){return t===e})}},L={geometryFields:b,coordinatesToGeometry:function(e,t){var r=void 0;switch(e){case S.POLYGON:case S.POLYGONZ:case S.POLYGONM:case S.POLYGONZM:case S.POLYGON25D:r=ol.geom.Polygon;break;case S.MULTIPOLYGON:case S.MULTIPOLYGONZ:case S.MULTIPOLYGONM:case S.MULTIPOLYGONZM:case S.MULTIPOLYGON25D:r=ol.geom.MultiPolygon;break;case S.LINESTRING:case S.LINESTRINGZ:case S.LINESTRINGM:case S.LINESTRINGZM:case S.LINESTRING25D:case S.LINE:case S.LINEZ:case S.LINEM:case S.LINEZM:case S.LINE25D:r=ol.geom.LineString;break;case S.MULTILINE:case S.MULTILINEZ:case S.MULTILINEM:case S.MULTILINEZM:case S.MULTILINE25D:case S.MULTILINESTRING:case S.MULTILINESTRINGZ:case S.MULTILINESTRINGM:case S.MULTILINESTRINGZM:case S.MULTILINESTRING25D:r=ol.geom.MultiLineString;break;case S.POINT:case S.POINTZ:case S.POINTM:case S.POINTZM:case S.POINT25D:r=ol.geom.Point;break;case S.MULTIPOINT:case S.MULTIPOINTZ:case S.MULTIPOINTM:case S.MULTIPOINTZM:case S.MULTIPOINT25D:r=ol.geom.MultiPoint;break;default:r=ol.geom.Point}var n=new r(t);return n},getDefaultLayerStyle:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.color;switch(e){case S.LINESTRINGZ:case S.LINESTRINGM:case S.LINESTRINGZM:case S.LINESTRING25D:case S.LINE:case S.LINEZ:case S.LINEM:case S.LINEZM:case S.LINE25D:e="LineString";break;case S.MULTILINESTRINGZ:case S.MULTILINESTRINGM:case S.MULTILINESTRINGZM:case S.MULTILINESTRING25D:case S.MULTILINE:case S.MULTILINEZ:case S.MULTILINEM:case S.MULTILINEZM:case S.MULTILINE25D:e="MultiLineString";break;case S.POINTZ:case S.POINTM:case S.POINTZM:case S.POINT25D:e="Point";break;case S.MULTIPOINTZ:case S.MULTIPOINTM:case S.MULTIPOINTZM:case S.MULTIPOINT25D:e="MultiPoint";break;case S.POLYGONZ:case S.POLYGONM:case S.POLYGONZM:case S.POLYGON25D:e="Polygon";break;case S.MULTIPOLYGONZ:case S.MULTIPOLYGONM:case S.MULTIPOLYGONZM:case S.MULTIPOLYGON25D:e="MultiPolygon"}var n={Point:new ol.style.Style({image:new ol.style.Circle({fill:new ol.style.Fill({color:r}),radius:5,stroke:new ol.style.Stroke({color:r,width:1})})}),LineString:new ol.style.Style({stroke:new ol.style.Stroke({color:r,width:3})}),Polygon:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255,255,255,0.5)"}),stroke:new ol.style.Stroke({color:r,width:3})}),MultiPoint:new ol.style.Style({image:new ol.style.Circle({fill:new ol.style.Fill({color:r}),radius:5,stroke:new ol.style.Stroke({color:r,width:1})})}),MultiLineString:new ol.style.Style({stroke:new ol.style.Stroke({color:r,width:3})}),MultiPolygon:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255,255,255,0.5)"}),stroke:new ol.style.Stroke({color:r,width:3})})};return n[e]},createLayerStyle:function(e){var t=void 0,r={};return e&&(Object.entries(e).forEach(function(e){var t=s(e,2),n=t[0],i=t[1];switch(n){case"point":i.icon&&(r.image=new ol.style.Icon({src:i.icon.url,imageSize:i.icon.width}));break;case"line":r.stroke=new ol.style.Stroke({color:i.color,width:i.width});break;case"polygon":r.fill=new ol.style.Fill({color:i.color})}}),t=new ol.style.Style(r)),t},createFeatureFromCoordinates:function(e){var t=void 0;if(Array.isArray(e)&&2===e.length){var r=new ol.geom.Point(e);t=new ol.Feature(r)}return t},createFeatureFromBBOX:function(e){var t=void 0;if(Array.isArray(e)&&4===e.length){var r=ol.geom.Polygon.fromExtent(e);t=new ol.Feature(r)}return t},createFeatureFromGeometry:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.geometry;if(r){var n=new ol.Feature(r);return t&&n.setId(t),n}},createOlLayer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.features,n=e.geometryType,i=e.color,a=e.style,o=e.source||new ol.source.Vector({features:r||new ol.Collection}),s=new ol.layer.Vector({id:t,source:o});if(!a)switch(n){case S.POINT:case S.POINTZ:case S.POINTM:case S.POINTZM:case S.POINT25D:case S.MULTIPOINT:case S.MULTIPOINTZ:case S.MULTIPOINTM:case S.MULTIPOINTZM:case S.MULTIPOINT25D:a=new ol.style.Style({image:new ol.style.Circle({radius:5,fill:new ol.style.Fill({color:i})})});break;case S.LINESTRING:case S.LINESTRINGZ:case S.LINESTRINGM:case S.LINESTRINGZM:case S.LINESTRING25D:case S.MULTILINESTRING:case S.MULTILINESTRINGZ:case S.MULTILINESTRINGM:case S.MULTILINESTRINGZM:case S.MULTILINESTRING25D:case S.LINE:case S.LINEZ:case S.LINEM:case S.LINEZM:case S.LINE25D:case S.MULTILINE:case S.MULTILINEZ:case S.MULTILINEM:case S.MULTILINEZM:case S.MULTILINE25D:a=new ol.style.Style({stroke:new ol.style.Stroke({width:3,color:i})});break;case S.POLYGON:case S.POLYGONZ:case S.POLYGONM:case S.POLYGONZM:case S.POLYGON25D:case S.MULTIPOLYGON:case S.MULTIPOLYGONZ:case S.MULTIPOLYGONM:case S.MULTIPOLYGONZM:case S.MULTIPOLYGON25D:a=new ol.style.Style({stroke:new ol.style.Stroke({color:"#000000",width:1}),fill:new ol.style.Fill({color:i})}),s.setOpacity(.6)}return s.setStyle(a),s},createWMSLayer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.name,n=e.projection,i=e.layers,a=void 0===i?[]:i,o=r||p();r=r||o;var s=new f({id:o,layers:a,projection:n,url:t}),l=s.getOLLayer();return l.set("id",o),l.set("name",r),{wmslayer:s,olLayer:l}},createVectorLayerFromGeometry:function(e){var t=new ol.Feature(e);return L.createVectorLayerFromFeatures(t)},createVectorLayerFromFeatures:function(e){return new ol.layer.Vector({source:new ol.source.Vector({features:Array.isArray(e)?e:[e]})})},createVectorLayerFromFile:function(){function e(){return t.apply(this,arguments)}var t=a(regeneratorRuntime.mark(function r(){var e,t,n,i,o,s,l,u,c,d,f,h,v,g,m=this,_=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},w=_.name,x=_.type,S=_.crs,C=_.mapCrs,L=_.data,k=_.style;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:e=void 0,t=void 0,n=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:S,n=void 0,i=e.readFeatures(t,{dataProjection:r,featureProjection:C||r});if(i.length){var a=new ol.source.Vector({features:i});n=new ol.layer.Vector({source:a,name:w,_fields:Object.keys(i[0].getProperties()).filter(function(e){return b.indexOf(e)<0}),id:p()}),k&&n.setStyle(k)}return n},r.t0=x,r.next="gpx"===r.t0?6:"gml"===r.t0?9:"geojson"===r.t0?12:"kml"===r.t0?15:"csv"===r.t0?18:"kmz"===r.t0?29:"zip"===r.t0?40:51;break;case 6:return e=new ol.format.GPX,t=n(e,L),r.abrupt("break",51);case 9:return e=new ol.format.WMSGetFeatureInfo,t=n(e,L),r.abrupt("break",51);case 12:return e=new ol.format.GeoJSON,t=n(e,L),r.abrupt("break",51);case 15:return e=new ol.format.KML({extractStyles:!1}),t=n(e,L,"EPSG:4326"),r.abrupt("break",51);case 18:if(i=L,o=i.headers,s=i.separator,l=i.values,u=i.x,c=i.y,d=[],f=[],l.forEach(function(e,t){var r={},n=e.split(s);if(n.length===o.length){var i=[];if(n.forEach(function(e,t){var n=o[t];n===u&&(i[0]=1*e),n===c&&(i[1]=1*e),r[n]=e}),void 0===i.find(function(e){return Number.isNaN(e)})){var a=new ol.geom.Point(i);S!==C&&a.transform(S,C);var p=new ol.Feature(a);p.setId(t),p.setProperties(r),d.push(p)}}else f.push({row:t+1,value:l[t]})}),d.length){r.next=24;break}return r.abrupt("return",Promise.reject());case 24:return f.length&&y.showUserMessage({type:"warning",message:"sdk.mapcontrols.addlayer.messages.csv.warning",hooks:{footer:{template:'<select v-select2="errorrows[0].value" class="skin-color" :search="false" style="width:100%">\n                    <option v-for="errorrow in errorrows" :key="errorrow.row" :value="errorrow.value">[{{ errorrow.row}}] {{errorrow.value}}</option>\n                </select>',data:function(){return{errorrows:f}}}},autoclose:!1}),h=new ol.source.Vector({features:d}),t=new ol.layer.Vector({source:h,name:w,_fields:o,id:p()}),k&&t.setStyle(k),r.abrupt("break",51);case 29:return v=new Promise(function(){var t=a(regeneratorRuntime.mark(function r(t,i){var a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a=new JSZip,r.next=3,L.arrayBuffer(L);case 3:o=r.sent,a.load(o),s=a.file(/.kml$/i)[0],s?(L=s.asText(),e=new ol.format.KML({extractStyles:!1}),t(n(e,L,"EPSG:4326"))):i();case 7:case"end":return r.stop()}},r,m)}));return function(e,r){return t.apply(this,arguments)}}()),r.prev=30,r.next=33,v;case 33:return r.abrupt("return",r.sent);case 36:return r.prev=36,r.t1=r["catch"](30),r.abrupt("return",Promise.reject());case 39:return r.abrupt("break",51);case 40:return g=new Promise(function(){var t=a(regeneratorRuntime.mark(function r(t,i){var a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,L.arrayBuffer(L);case 2:a=r.sent,shp(a).then(function(r){var i=JSON.stringify(r);e=new ol.format.GeoJSON({}),t(n(e,i,"EPSG:4326"))})["catch"](function(e){return i(e)});case 4:case"end":return r.stop()}},r,m)}));return function(e,r){return t.apply(this,arguments)}}()),r.prev=41,r.next=44,g;case 44:return r.abrupt("return",r.sent);case 47:return r.prev=47,r.t2=r["catch"](41),r.abrupt("return",Promise.reject());case 50:return r.abrupt("break",51);case 51:return r.abrupt("return",t);case 52:case"end":return r.stop()}},r,this,[[30,36],[41,47]])}));return e}(),createStyleFunctionToVectorLayer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=function(t,r){var n=e.color,i=e.field;n=n.rgba?"rgba("+n.rgba.r+","+n.rgba.g+","+n.rgba.b+","+n.rgba.a+")":n;var a=t.getGeometry().getType(),o=L.getDefaultLayerStyle(a,{color:n});return i&&o.setText(new ol.style.Text({text:""+t.get(i),font:"bold",scale:2,offsetY:15,fill:new ol.style.Fill({color:n}),stroke:new ol.style.Stroke({color:"#FFFFFF",width:2})})),o};return t._g3w_options=e,t},createSelectedStyle:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.geometryType,r=e.color,n=void 0===r?"rgb(255,255,0)":r,i=e.fill,a=void 0===i||i,o=null;if("LineString"===t||"MultiLineString"===t)o=new ol.style.Style({stroke:new ol.style.Stroke({color:n,width:4})});else if("Point"===t||"MultiPoint"===t)o=new ol.style.Style({image:new ol.style.Circle({radius:6,stroke:!a&&new ol.style.Stroke({color:n,width:4}),fill:a&&new ol.style.Fill({color:n})}),zIndex:1/0});else if("MultiPolygon"===t||"Polygon"===t){var s=ol.color.asArray(n);s.splice(3,1,.5),o=new ol.style.Style({stroke:new ol.style.Stroke({color:n,width:4}),fill:a&&new ol.style.Fill({color:ol.color.asString(s)})})}return o},getAlphanumericPropertiesFromFeature:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e=Array.isArray(e)?e:Object.keys(e),e.filter(function(e){return b.indexOf(e)===-1})},getFormDataExpressionRequestFromFeature:function(e){delete e.attributes.geometry;var t=new ol.Feature(e.geometry),r={};return L.getAlphanumericPropertiesFromFeature(e.attributes).forEach(function(t){t!==x&&(r[t]=e.attributes[t])}),t.setProperties(r),t.setId(e.attributes[x]),L.convertFeatureToGEOJSON(t)},convertFeatureToGEOJSON:function(e){var t=new ol.format.GeoJSON;return t.writeFeatureObject(e)},getQueryLayersPromisesByBBOX:function(e,t){var r=t.bbox,n=t.filterConfig,i=void 0===n?{}:n,a=t.feature_count,o=void 0===a?10:a,s=t.multilayers,l=void 0!==s&&s,u=void 0,c=ol.geom.Polygon.fromExtent(r),d=y.getComponent("map").getService().getMap(),p=d.getView().getProjection();if(l)u=L.getQueryLayersPromisesByGeometry(e,{geometry:c,feature_count:o,filterConfig:i,multilayers:l,projection:p});else{var f=$.Deferred(),v=p.getCode();u=f.promise();var g=[],m=[],_=e.length;e.forEach(function(t){var r=new h(i),n=t.getProjection().getCode();r.setGeometry(v!==n?c.clone().transform(v,n):c),t.query({filter:r,feature_count:o}).then(function(e){g.push(e)}).fail(function(e){return m.push(e)}).always(function(){_-=1,0===_&&(m.length===e.length?f.reject(m):f.resolve(g))})})}return u},getQueryLayersPromisesByGeometry:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.multilayers,n=void 0!==r&&r,i=t.geometry,a=t.filterConfig,o=void 0===a?{}:a,s=t.projection,l=t.feature_count,u=void 0===l?10:l,c=$.Deferred(),d=[],p=[],f=s.getCode(),v=new h(o);if(n)!function(){var t=i;e.length||c.resolve([]);var r=_.groupBy(e,function(e){return e.getMultiLayerId()+"_"+e.getProjection().getCode()}),n=Object.keys(r).length,a=n;for(var o in r){var s=r[o],l=s,h=r[o][0],g=h.getProvider("filter"),m=h.getProjection().getCode();f!==m&&(t=t.clone().transform(f,m)),v.setGeometry(t),g.query({filter:v,layers:l,feature_count:u}).then(function(e){return d.push(e)}).fail(function(e){return p.push(e)}).always(function(){a-=1,0===a&&(p.length===n?c.reject(p):c.resolve(d))})}}();else if(0===e.length)c.resolve([]);else{var g=e.length;e.forEach(function(t){var r=t.getProjection().getCode();v.setGeometry(f!==r?i.clone().transform(f,r):i),t.query({filter:v,filterConfig:o,feature_count:u}).then(function(e){return d.push(e)}).fail(function(e){return p.push(e)}).always(function(){g-=1,0===g&&(p.length===e.length?c.reject(p):c.resolve(d))})})}return c.promise()},getQueryLayersPromisesByCoordinates:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.coordinates,n=t.feature_count,i=void 0===n?10:n,a=t.query_point_tolerance,o=void 0===a?w:a,s=t.multilayers,l=void 0!==s&&s,u=t.reproject,c=void 0===u||u,d=$.Deferred();if(!e.length)return d.resolve(e);var p=y.getComponent("map").getService().getMap(),f=p.getSize(),h=[],v=[],g=p.getView().getProjection(),m=p.getView().getResolution();if(l)!function(){var t={};e.forEach(function(e){var r=e.getInfoFormat()+":"+e.getInfoUrl()+":"+e.getMultiLayerId();t[r]?t[r].push(e):t[r]=[e]});var n=Object.keys(t).length,a=n;for(var s in t){var l=t[s],u=l,p=t[s][0],y=p.getProvider("query");y.query({feature_count:i,coordinates:r,query_point_tolerance:o,mapProjection:g,reproject:c,resolution:m,size:f,layers:u}).then(function(e){return h.push(e)}).fail(function(e){return v.push(e)}).always(function(){a-=1,0===a&&(v.length===n?d.reject(v):d.resolve(h))})}}();else{var _=e.length,b=0;e.forEach(function(t){t.query({feature_count:i,coordinates:r,query_point_tolerance:o,mapProjection:g,size:f,resolution:m}).then(function(e){h.push(e)}).fail(function(e){b+=1,v.push(e)}).always(function(){_-=1,0===_&&(b<e.length?d.resolve(h):d.reject(v))})})}return d.promise()},transformBBOX:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.bbox,r=e.sourceCrs,n=e.destinationCrs,a=new ol.geom.Point([t[0],t[1]]),o=new ol.geom.Point([t[2],t[3]]);return a.transform(r,n),o.transform(r,n),[].concat(i(a.getCoordinates()),i(o.getCoordinates()))},parseQueryLayersPromiseResponses:function(e){var t={query:e[0]?e[0].query:null,data:[]};return e.forEach(function(e){e.data&&e.data.forEach(function(e){t.data.push(e)})}),t},getMapLayerById:function(e){return m.getLayerById(e)},getMapLayersByFilter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=o({GEOLAYER:!0},e);var r=[];return m.getQuerableLayersStores().forEach(function(n){r=n.getLayers(e,t)}),r||[]},areCoordinatesEqual:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e[0]===t[0]&&e[1]===t[1]},getFeaturesFromResponseVectorApi:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.type,n=void 0===r?"vector":r;if(!e.result)return null;var i=e.vector.data.features||[];switch(n){case"result":return L.covertVectorFeaturesToResultFeatures(i);case"vector":default:return i}},covertVectorFeaturesToResultFeatures:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map(function(e){var t=e.id,r=e.properties,n=e.geometry;return r[x]=t,{geometry:n,attributes:r,id:t}})},splitGeometryLine:function(e,t){var r=void 0!==t.getCoordinates()[0][2],n=!1,a=[],o=new jsts.io.WKTReader,s=new ol.format.WKT,l=new jsts.io.OL3Parser,u=o.read(s.writeGeometry(e)),c=s.writeGeometry(t);r&&(c=c.replace(" Z",""));for(var d=o.read(c),p=d.getCoordinates(),f=p.length,h=new jsts.geom.GeometryFactory,v=[],g=void 0,m=void 0,y=0;y<f-1;y++){m=p[y],g=p[y+1],r&&(m.z=t.getCoordinates()[y][2],g.z=t.getCoordinates()[y+1][2]);var _=h.createLineString([m,g]),b=_.intersection(u).getCoordinates();b.length?(n=!0,b.forEach(function(e){if(r&&(e.z=m.z),v.length){var t=l.write(h.createLineString(v.concat([m,e])));if(r){var n=t.getCoordinates();t.setCoordinates([[].concat(i(n[0]),[m.z]),[].concat(i(n[1]),[e.z])])}a.push(t),v=[]}else{var o=l.write(h.createLineString([m,e]));if(r){var s=o.getCoordinates();o.setCoordinates([[].concat(i(s[0]),[m.z]),[].concat(i(s[1]),[e.z])])}a.push(o)}m=e}),v=v.concat([m,g])):v=v.concat([m,g])}var w=l.write(h.createLineString(v));if(r){var x=[];v.forEach(function(e,t){var r=w.getCoordinates()[t];r.push(e.z),x.push(r)}),w.setCoordinates(x)}return a.push(w),n&&a||[]},splitFeatures:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.features,r=void 0===t?[]:t,n=e.splitfeature,i=[];return r.forEach(function(e){var t=L.splitFeature({feature:e,splitfeature:n});t.length>1&&i.push({uid:e.getUid(),geometries:t})}),i},splitFeature:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.feature,r=e.splitfeature,n={feature:t.getGeometry(),split:r.getGeometry()},i=n.split.getType(),a=n.feature.getType(),o=[],s=new jsts.io.OL3Parser;switch(i){case"LineString":if(a.indexOf("Polygon")!==-1){var l=a.indexOf("Multi")!==-1,u=l?n.feature.getPolygons():n.feature;if(Array.isArray(u))u.forEach(function(e){L.splitFeature({splitfeature:r,feature:new ol.Feature({geometry:e})}).forEach(function(e){e&&o.push(new ol.geom.MultiPolygon([e.getCoordinates()]))})});else{var c=void 0!==u.getCoordinates()[0][0][2],d=s.read(u),p=s.read(u.getLinearRing(0)),f=s.read(n.split),h=void 0;if(u.getLinearRingCount()>1){for(var v=void 0,g=1;g<u.getLinearRingCount();g++){var m=s.read(u.getLinearRing(g));v=void 0===v?m:v.union(m)}h=new jsts.operation.polygonize.Polygonizer,h.add(v);var y=void 0;h.getPolygons().toArray().forEach(function(e){y=void 0===y?e:y.union(e)}),h=y}c&&(u.getCoordinates()[0].forEach(function(e,t){p.getCoordinates()[t].z=e[2]}),f.getCoordinates().forEach(function(e){return e.z=0}));var _=p.union(f),b=new jsts.operation.polygonize.Polygonizer;b.add(_);var w=b.getPolygons().toArray();w.length>1&&w.forEach(function(e){if(h&&(e=e.difference(h)),d.intersects(e.getInteriorPoint())){var t=s.write(e),r=e.getCoordinates();if(c&&r.forEach(function(e,t){e.z=void 0===e.z?r[0===t?t+1:t-1].z:e.z}),c){var n=[];t.getCoordinates()[0].forEach(function(e,t){e.push(r[t].z),n.push(e)}),t.setCoordinates([n])}var i=t.getType();l?o.push(new ol.geom.MultiPolygon("Polygon"===i?[t.getCoordinates()]:t.getCoordinates())):"Polygon"===i?o.push(t):t.getCoordinates().forEach(function(e){o.push(new ol.geom.Polygon(e))})}})}}else if(a.indexOf("LineString")!==-1){var x=a.indexOf("Multi")!==-1,S=x?n.feature.getLineStrings():n.feature;if(!Array.isArray(S))return L.splitGeometryLine(n.split,n.feature);S.forEach(function(e){L.splitFeature({splitfeature:r,feature:new ol.Feature({geometry:e})}).forEach(function(e){e&&o.push(new ol.geom.MultiLineString([e.getCoordinates()]))})})}}return o},getPointFeaturesfromGeometryVertex:function(e){var t=[];switch(e.getType()){case S.MULTIPOLYGON:e.getCoordinates().forEach(function(e){e.forEach(function(e){e.pop(),e.forEach(function(e){var r=new ol.Feature(new ol.geom.Point(e));t.push(r)})})});break;case S.POLYGON:e.getCoordinates().forEach(function(e){e.pop(),e.forEach(function(e){var r=new ol.Feature(new ol.geom.Point(e));t.push(r)})});break;case S.MULTILINESTRING:e.getCoordinates().forEach(function(e){e.forEach(function(e){var r=new ol.Feature(new ol.geom.Point(e));t.push(r)})});break;case S.LINESTRING:e.getCoordinates().forEach(function(e){e.forEach(function(e){var r=new ol.Feature(new ol.geom.Point(e));t.push(r)})});break;case S.MULTIPOINT:e.getCoordinates().forEach(function(e){var r=new ol.Feature(new ol.geom.Point(e));t.push(r)});break;case S.POINT:var r=e.getCoordinates(),n=new ol.geom.Point(r);t.push(n)}return t},getVertexLength:function(e){var t=0;switch(e.getType()){case S.MULTIPOLYGON:e.getCoordinates().forEach(function(e){e.forEach(function(e){e.pop(),e.forEach(function(){return t+=1})})});break;case S.POLYGON:e.getCoordinates().forEach(function(e){e.pop(),e.forEach(function(){return t+=1})})}return t},isSameBaseGeometryType:function(e,t){return e=e.replace("Multi",""),t=t.replace("Multi",""),e===t},isSingleGeometry:function(e){return!C.isMultiGeometry(e.getType())},singleGeometriesToMultiGeometry:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e[0]&&e[0].getType();return t&&new ol.geom["Multi"+t](e.map(function(e){return e.getCoordinates()}))},multiGeometryToSingleGeometries:function(e){var t=e.getType(),r=[];switch(t){case S.MULTIPOLYGON:r=e.getPolygons();break;case S.MULTILINE:case S.MULTILINESTRING:r=e.getLineStrings();break;case S.MULTIPOINT:r=e.getPoints()}return r},convertSingleMultiGeometry:function(e,t){if(t){var r=C.isMultiGeometry(e),n=C.isMultiGeometry(t);if(r&&!n)return L.multiGeometryToSingleGeometries(e);if(!r&&n)return L.singleGeometriesToMultiGeometry(e)}return e},dissolve:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.features,r=void 0===t?[]:t,n=e.index,i=void 0===n?0:n,a=e.clone,o=void 0!==a&&a,s=new jsts.io.OL3Parser,l=r.length,u=void 0,c=void 0;switch(l){case 0:u=null;break;case 1:u=r[0];break;default:var d=u=o?r[i].clone():r[i],p=d.getGeometry(),f=p.getType();if("LineString"===f){for(var h=new jsts.operation.linemerge.LineMerger,v=0;v<l;v++){var g=r[v],m=s.read(g.getGeometry()).getCoordinates(),y=(new jsts.geom.GeometryFactory).createLineString(m);h.addLineString(y)}var _=h.getMergedLineStrings();c=1===_.size()?_.toArray()[0]:null}else{c=s.read(p);for(var b=0;b<l;b++)if(i!==b){var w=r[b];c=c.union(s.read(w.getGeometry()))}}if(c){var x=s.write(c),S=x.getType(),C=S===f?x.getCoordinates():f.indexOf("Multi")!==-1&&S===f.replace("Multi","")?[x.getCoordinates()]:null;C?d.getGeometry().setCoordinates(C):u=null}else u=null}return u},findSelfIntersects:function(e){var t=new jsts.io.OL3Parser,r=t.read(e),n=new jsts.operation.IsSimpleOp(r);if(n.isSimpleLinearGeometry(r))return!1;var i=new jsts.geomgraph.GeometryGraph(0,r),a=new jsts.operation.valid.ConsistentAreaTester(i),o=a.isNodeConsistentArea();return!o||void 0},normalizeEpsg:function(e){return"number"==typeof e?"EPSG:"+e:(e=e.replace(/[^\d\.\-]/g,""),""!==e?"EPSG:"+parseInt(e):void 0)},crsToCrsObject:function(e){return null===e||void 0===e?e:("Object"===d(e)&&e.epsg?e.epsg=L.normalizeEpsg(e.epsg):e={epsg:L.normalizeEpsg(e),proj4:"",axisinverted:!1,geographic:!1},e)},ConvertDMToDEG:function(e){var t=e.dms,r=e.type,n=void 0===r?"Array":r,i="Array"===n?t:t.split(/[^\d\w\.]+/),a=1*i[0],o=1*i[1],s=(Number(a)+Number(o)/60).toFixed(6);return 1*s},ConvertDEGToDM:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.deg,r=e.output,n=void 0===r?"Array":r,i=Math.abs(t),a=Math.floor(i),o=60*(i-a);switch(n){case"Array":return[a,o];case"Object":return{degrees:a,minutes:o};case"Text":default:return a+""+o+"'"}},ConvertDMSToDEG:function(e){var t=e.dms,r=e.type,n=void 0===r?"Array":r,i="Array"===n?t:t.split(/[^\d\w\.]+/),a=1*i[0],o=1*i[1],s=1*i[2],l=i[3],u=(Number(a)+Number(o)/60+Number(s)/3600).toFixed(6);return"S"!=l&&"W"!=l||(u*=-1),1*u},ConvertDEGToDMS:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.deg,r=e.lat,n=e.lon,i=e.output,a=void 0===i?"Array":i,o=Math.abs(t),s=Math.floor(o),l=60*(o-s),u=Math.floor(l),c=(60*(l-u)).toFixed(2),d=void 0;switch(r&&(d=t>=0?"N":"S"),n&&(d=t>=0?"E":"W"),a){case"Array":return[s,u,c,d];case"Object":return{degrees:s,minutes:u,seconds:c,direction:d};case"Text":default:return s+""+u+"'"+c+'"'+d}},getGeoTIFFfromServer:function(){function e(){return t.apply(this,arguments)}var t=a(regeneratorRuntime.mark(function r(){var e,t,n,i,a,o,s,l,u,c,d=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=d.url,t=d.params,n=t.image,i=t.csrfmiddlewaretoken,a=t.bbox,o=d.method,s=void 0===o?"POST":o,l=new FormData,l.append("image",n),l.append("csrfmiddlewaretoken",i),l.append("bbox",a),r.next=7,fetch(e,{method:s,body:l});case 7:return u=r.sent,r.next=10,u.blob();case 10:return c=r.sent,r.abrupt("return",c);case 12:case"end":return r.stop()}},r,this)}));return e}(),createOlFeatureFromApiResponseFeature:function(e){var t=e.properties,r=void 0===t?{}:t,n=e.geometry,i=e.id;r[x]=i;var a=new ol.Feature(n&&new ol.geom[n.type](n.coordinates));return a.setProperties(r),a.setId(i),a},sanitizeFidFeature:function(e){return"String"===d(e)&&Number.isNaN(1*e)&&(e=e.split("."),e=2===e.length?e[1]:e[0]),e},parseAttributes:function(e,t){var r=Object.keys(t).filter(function(e){return b.indexOf(e)===-1});if(e&&e.length){var n=Object.keys(t);return e.filter(function(e){return n.indexOf(e.name)>-1})}return r.map(function(e){return{name:e,label:e}})},handleQueryResponse:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.response,r=e.projections,n=e.layers,i=e.wms,a=void 0===i||i;n=n?n:[this._layer];var o=n[0],s=o.getInfoFormat();return t=g.get(s)({response:t,projections:r,layers:n,wms:a})},distance:function(e,t){return Math.sqrt(geom.squaredDistance(e,t))},squaredDistance:function(e,t){var r=e[0],n=e[1],i=t[0],a=t[1],o=i-r,s=a-n;return o*o+s*s},closestOnSegment:function(e,t){var r=e[0],n=e[1],i=t[0],a=t[1],o=i[0],s=i[1],l=a[0],u=a[1],c=l-o,d=u-s,p=0===c&&0===d?0:(c*(r-o)+d*(n-s))/(c*c+d*d||0),f=void 0,h=void 0;return p<=0?(f=o,h=s):p>=1?(f=l,h=u):(f=o+p*c,h=s+p*d),[f,h]},Geometry:C};t.exports=L},{"../../constant":5,"core/layers/filter/filter":47,"core/layers/map/wmslayer":63,"core/map/maplayersstoresregistry":76,"core/utils/parsers":91,"core/utils/utils":92,"gui/gui":150}],90:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("core/applicationstate"),s=n(o),l={m:39.37,degrees:4374754},u=96,c={merge:function(e,t){var r=a({},e,t);return r},getExtentForViewAndSize:function(e,t,r,n){var i=t*n[0]/2,a=t*n[1]/2,o=Math.cos(r),s=Math.sin(r),l=i*o,u=i*s,c=a*o,d=a*s,p=e[0],f=e[1],h=p-l+d,v=p-l-d,g=p+l-d,m=p+l+d,y=f-u-c,_=f-u+c,b=f+u+c,w=f+u-c;return[Math.min(h,v,g,m),Math.min(y,_,b,w),Math.max(h,v,g,m),Math.max(y,_,b,w)]},createPolygonLayerFromBBox:function(e){var t=new ol.Feature(new ol.geom.Polygon.fromExtent(e)),r=new ol.source.Vector({features:[t]}),n=new ol.layer.Vector({source:r});return n},reverseGeometry:function(e){var t=function n(e){e.find(function(t){if(!Array.isArray(t)){var r=i(e,2),a=r[0],o=r[1];return e[0]=o,e[1]=a,!0}n(t)})},r=e.getCoordinates();return t(r),e.setCoordinates(r),e},getScaleFromResolution:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"m";return Math.round(e*l[t]*u)},getResolutionFromScale:function(e){
var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"m",r=e>=1?1/e:e;return 1/(r*l[t]*u)},getDPI:function(){return u},getMetersFromDegrees:function(e){return e*ol.proj.Units.METERS_PER_UNIT.degrees},needUseSphereMethods:function(e){return"EPSG:3857"===e.getCode()||"degrees"===e.getUnits()},getLengthMessageText:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.unit,n=t.projection,i=t.geometry,a=e("core/utils/geo"),o=a.Geometry,s=i.getType(),l=this.needUseSphereMethods(n),u=l?ol.sphere.getLength(i,{projection:n.getCode()}):o.isMultiGeometry(s)?i.getLineStrings().reduce(function(e,t){return e+=t.getLength()},0):i.getLength(),c=void 0;switch(r){case"nautical":c=this.transformMeterLength(u,r)+" nm";break;case"metric":default:c=u>1e3?(Math.round(u/1e3*100)/100).toFixed(3)+" km":(Math.round(100*u)/100).toFixed(2)+" m"}return c},getAreaMessageText:function(e){var t=e.unit,r=e.geometry,n=e.projection,i=e.segments,a=void 0===i?[]:i,o=this.needUseSphereMethods(n),s=Math.round(o?ol.sphere.getArea(r,{projection:n.getCode()}):r.getArea()),l=void 0,u="",c=a.length;switch(c>2&&(u+=this.getLengthMessageText({unit:t,projection:n,geometry:new ol.geom.LineString(a)})+" <br>"),t){case"nautical":l=this.transformMeterArea(s,t)+" nmi";break;case"metric":default:l=s>1e6?(Math.round(s/1e6*100)/100).toFixed(6)+" km<sup>2</sup>":(Math.round(100*s)/100).toFixed(3)+" m<sup>2</sup>"}return u&&(l="Area: "+l+' <br><div style="width: 100%; padding: 3px; border-bottom: 2px solid #ffffff"></div> '+u),l},formatMeasure:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.geometry,n=t.projection,i=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e("core/utils/geo")),a=i.Geometry,o=i.multiGeometryToSingleGeometries,s=r.getType(),l=this.getCurrentMapUnit();if(a.isLineGeometryType(s))return this.getLengthMessageText({unit:l,projection:n,geometry:r});if(a.isPolygonGeometryType(s)){var u=void 0;return a.isMultiGeometry(s)?(u=[],o(r).forEach(function(e){e.getLinearRing().getCoordinates().forEach(function(e){return u.push(e)})})):u=r.getLinearRing().getCoordinates(),this.getAreaMessageText({unit:l,geometry:r,projection:n,segments:u})}},createMeasureTooltip:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.map,r=e.feature,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=document.createElement("div");i.className="mtooltip mtooltip-measure";var a=new ol.Overlay({element:i,offset:[0,-15],positioning:"bottom-center"});t.addOverlay(a);var o=r.getGeometry().on("change",function(e){var r=void 0,o=e.target;o instanceof ol.geom.Polygon?r=o.getInteriorPoint().getCoordinates():o instanceof ol.geom.MultiPolygon?r=o.getInteriorPoints().getCoordinates()[0]:o instanceof ol.geom.LineString?r=o.getLastCoordinate():o instanceof ol.geom.MultiLineString&&(r=o.getLastCoordinate());var s=c.formatMeasure({geometry:o,projection:t.getView().getProjection()},n);i.innerHTML=s,a.setPosition(r)});return{tooltip:a,unbyKey:o}},getCurrentMapUnit:function(){return s["default"].map.unit},transformMeterLength:function(e,t){switch(t){case"nautical":e=.0005399568*e}return e},transformMeterArea:function(e,t){switch(t){case"nautical":e=2.9155334959812285e-7*e}return e},removeMeasureTooltip:function(e){var t=e.map,r=e.tooltip,n=e.unbyKey;t.removeOverlay(r),ol.Observable.unByKey(n)},setMeasureTooltipStatic:function(e){var t=e.getElement();t.className="mtooltip mtooltip-static",e.setOffset([0,-7])}};t.exports=c},{"core/applicationstate":8,"core/utils/geo":89}],91:[function(e,t,r){function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=e("constant"),o=e("core/utils/utils"),s=o.toRawType,l=e("core/layers/features/feature"),u=e("core/i18n/i18n.service"),c=u.t,d=e("core/utils/ol"),p="GIS3W_ESCAPE_NUMERIC_FIELD_",f={getHandledResponsesFromResponse:function(e){var t=this,r=e.response,n=e.layers,a=e.projections,o=e.id,s=void 0!==o&&o,l=!1,u=new X2JS,c=u.xml_str2json(r);if(!c)return[{layer:n[0],features:[]}];var d=c.FeatureCollection,p=[];if(d.featureMember)for(var f=Array.isArray(d.featureMember)?d.featureMember:[d.featureMember],h=function(e){var r=n[e],o=s?r.getId():"layer"+e,u={features:null,__prefix:null};if(c.FeatureCollection.featureMember=f.filter(function(e){var t=e[o];if(t)return t.g3w_fid={__prefix:e.__prefix,__text:t._fid&&t._fid.split(".")[1]},!Array.isArray(t)||(u.features=t,u.__prefix=e.__prefix,!1)}),u.features){var d=u.__prefix,h=t.groupFeaturesByFields(u.features);Object.keys(h).length>1?(l=!0,t.handleWMSMultiLayersResponseFromQGISSERVER({groupFeatures:h,prefix:d,handledResponses:p,jsonresponse:c,layer:r,projections:a})):u.features.forEach(function(e){var t;c.FeatureCollection.featureMember.push((t={},i(t,o,e),i(t,"__prefix",d),t))})}if(!l){var v=t.parseLayerFeatureCollection({jsonresponse:c,layer:r,projections:a});v&&p.unshift(v[0])}},v=0;v<n.length;v++)h(v);return p},transformFeatures:function(e,t){if(e.length&&e[0].getGeometry()){var r=t.layer?t.layer:t.map,n="ne"===r.getAxisOrientation().substr(0,2);t.layer&&t.layer.getCode()!==t.map.getCode()&&e.forEach(function(e){var r=e.getGeometry();e.setGeometry(r.transform(t.layer.getCode(),t.map.getCode()))}),n&&(e=this.reverseFeaturesCoordinates(e))}return e},parseLayerFeatureCollection:function(t){var r=this,n=t.jsonresponse,i=t.layer,a=t.projections,o=e("core/utils/geo"),s=o.Geometry,l=s.is3DGeometry,u=s.removeZValueToOLFeatureGeometry,c=new X2JS,d=c.json2xml_str(n),f=new ol.format.WMSGetFeatureInfo,h=this.transformFeatures(f.readFeatures(d),a);if(i.isGeoLayer()){var v=i.getGeometryType();l(v)||h.forEach(function(e){return u({feature:e,geometryType:v})})}if(h.length&&this.hasFieldsStartWithNotPermittedKey){var g=Object.keys(h[0].getProperties()),m=g.filter(function(e){return e.indexOf(p)!==-1});h.forEach(function(e){m.forEach(function(t){var n=e.get(t),i=t.replace(p,"");e.set(r.hasFieldsStartWithNotPermittedKey[i],Array.isArray(n)?n[0]:n),e.unset(t)})})}return[{layer:i,features:h}]},reverseFeaturesCoordinates:function(e){return e.forEach(function(e){var t=e.getGeometry();e.setGeometry(d.reverseGeometry(t))}),e},handleXMLStringResponseBeforeConvertToJSON:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.response,i=t.layers,a=t.wms;if(r){"string"==typeof r||r instanceof String||(r=(new XMLSerializer).serializeToString(r));for(var o=0;o<i.length;o++){var s=i[o],l=a&&s.isWmsUseLayerIds()?s.getId():s.getName(),u=a?l.replace(/[/\s]/g,""):l.replace(/[/\s]/g,"_");u=u.replace(/(\'+)/,""),u=u.replace(/(\)+)/,""),u=u.replace(/(\(+)/,"");var c=new RegExp("qgs:"+u,"g");r=r.replace(c,"qgs:layer"+o)}var d=[].concat(n(r.matchAll(/qgs:(\d+)(\w+)/g)),n(r.matchAll(/qgs:(\w+):(\w+)/g)));d.forEach(function(t,n){if(n%2===0){e.hasFieldsStartWithNotPermittedKey||(e.hasFieldsStartWithNotPermittedKey={});var i=t[0].replace("qgs:","");e.hasFieldsStartWithNotPermittedKey[""+t[1]+t[2]]=i;var a=new RegExp(""+t[0],"g");r=r.replace(a,"qgs:"+p+t[1]+t[2])}});var f=new RegExp(""+String.fromCharCode(0),"g");return r=r.replace(f,"0")}},groupFeaturesByFields:function(e){return _.groupBy(e,function(e){return Object.keys(e)})},handleWMSMultiLayersResponseFromQGISSERVER:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.groupFeatures,n=t.prefix,a=t.handledResponses,o=t.jsonresponse,s=t.layer,l=t.projections;Object.keys(r).forEach(function(t,u){var c=r[t];c.forEach(function(t,r){var c;o.FeatureCollection.featureMember=(c={},i(c,"layer"+u+"_"+r,t),i(c,"__prefix",n),c);var d=e.parseLayerFeatureCollection({jsonresponse:o,layer:s,projections:l});if(d){var p=d[0];p.layer=s,a.unshift(p)}})})}},h={"application/json":function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.layers,n=void 0===r?[]:r,i=t.response,o=t.projections,s=t.wms,l=void 0===s||s,u=e("core/utils/geo"),c=u.sanitizeFidFeature,d=[],p=n.map(function(e){return d.push({layer:e,features:[]}),l?e.getWMSLayerName():e.getWFSLayerName()}),f=i,h=function(){var e=o.layer||o.map,t=new ol.format.GeoJSON({defaultDataProjection:e,geometryName:"geometry"});return t.readFeatures(f)},v=f&&h();return v.filter(function(e){var t=e.getId(),r=c(t),n=t==r?0:p.indexOf(currentLayerId);if(n!==-1){var i=d[n].layer.getFields().filter(function(e){return e.show}),o=e.getProperties();e.set(a.G3W_FID,r),i.forEach(function(t){void 0===o[t.name]&&void 0!==o[t.label]&&e.set(t.name,o[t.label])}),d[n].features.push(e)}}),d},"application/geojson":function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layers,r=(e.projections,e.response),n=[],i=m.vector.get({type:"geojson"});return r&&t.forEach(function(e){n.push({layer:e,features:i(r,{})})}),n},"text/html":function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layers,r=e.response,n=[];return t.forEach(function(e){n.push({layer:e,rawdata:r})}),n},"text/plain":function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layers,r=e.response,n=[];return t.forEach(function(e){n.push({layer:e,rawdata:r})}),n},"text/gml":function(e){var t=e.layers,r=e.response,n=m.vector.get({type:"gml"}),i=n({data:r,layer:t[0]});return t.map(function(e){return{layer:e,features:i}})},"application/vnd.ogc.gml":function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.response,r=e.projections,n=e.layers,i=e.wms,a=void 0===i||i;return f.getHandledResponsesFromResponse({response:f.handleXMLStringResponseBeforeConvertToJSON({layers:n,response:t,wms:a}),layers:n,projections:r})},not_supported_format:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layers,r=void 0===t?[]:t;return r.map(function(e){return{layer:e,rawdata:c("warning.not_supported_format")}})}},v=function(){this.get=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=void 0;switch(t){case"geojson":case"json":r=this._parseLayerGeoJSON;break;case"gml":r=this._parseLayermsGMLOutput;break;default:r=this._parseLayerGeoJSON}return r},this._parseLayermsGMLOutput=function(e){var t=e.data,r=e.layer;try{var n=void 0;if("--"!==t.substr(0,2))n=t;else{var i=new RegExp("<([^ ]*)FeatureCollection"),a=new RegExp("<([^ ]*)msGMLOutput"),o="\r\n--",s=t.split(new RegExp(o));s.forEach(function(e){var t=e.search(i)>-1||e.search(a)>-1;t&&(n=e.substr(e.indexOf("<?xml")))})}var l=r.getQueryLayerOrigName(),u=new ol.format.WMSGetFeatureInfo({layers:l});return u.readFeatures(n)}catch(c){return[]}},this._parseLayerGeoJSON=function(e,t){try{e="String"===s(e)?JSON.parse(e):e;var r=t.crs,n=t.mapCrs,i=new ol.format.GeoJSON({dataProjection:r,featureProjection:n||r,geometryName:"geometry"});return i.readFeatures(e)}catch(a){return[]}}},g=function(){this.get=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=void 0;switch(t){case"json":r=this._parserJSON.bind(this);break;default:r=this._parserJSON.bind(this)}return r},this._parserJSON=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.features,r=void 0===t?[]:t;return r.map(function(e){var t=e.id,r=e.properties,n=new l;return n.setProperties(r),n.setId(t),n})}},m={vector:new v,table:new g,response:{get:function(e){return h[e]||h.not_supported_format},utils:{getTimeoutData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map(function(e){return{layer:e,rawdata:"timeout"}})}}}};t.exports=m},{constant:5,"core/i18n/i18n.service":27,"core/layers/features/feature":43,"core/utils/geo":89,"core/utils/ol":90,"core/utils/utils":92}],92:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function i(e,t,r){return"undefined"==typeof r||0===+r?Math[e](t):(t=+t,r=+r,isNaN(t)||"number"!=typeof r||r%1!==0?NaN:(t=t.toString().split("e"),t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-r:-r))),t=t.toString().split("e"),+(t[0]+"e"+(t[1]?+t[1]+r:r))))}var a=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=e("../../constant"),s=e("../layers/filter/operators"),l=e("core/layers/filter/filter"),u=e("core/layers/filter/expression");Math.round10||(Math.round10=function(e,t){return i("round",e,t)}),Math.floor10||(Math.floor10=function(e,t){return i("floor",e,t)}),Math.ceil10||(Math.ceil10=function(e,t){return i("ceil",e,t)}),String.prototype.hashCode=function(){var e=0,t=void 0,r=void 0,n=void 0;if(0===this.length)return e;for(t=0,n=this.length;t<n;t++)r=this.charCodeAt(t),e=(e<<5)-e+r,e|=0;return e};var c={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t="",r=void 0,n=void 0,i=void 0,a=void 0,o=void 0,s=void 0,l=void 0,u=0;for(e=c._utf8_encode(e);u<e.length;)r=e.charCodeAt(u++),n=e.charCodeAt(u++),i=e.charCodeAt(u++),a=r>>2,o=(3&r)<<4|n>>4,s=(15&n)<<2|i>>6,l=63&i,isNaN(n)?s=l=64:isNaN(i)&&(l=64),t=t+this._keyStr.charAt(a)+this._keyStr.charAt(o)+this._keyStr.charAt(s)+this._keyStr.charAt(l);return t},decode:function(e){var t="",r=void 0,n=void 0,i=void 0,a=void 0,o=void 0,s=void 0,l=void 0,u=0;for(e=e.replace(/[^A-Za-z0-9+/=]/g,"");u<e.length;)a=this._keyStr.indexOf(e.charAt(u++)),o=this._keyStr.indexOf(e.charAt(u++)),s=this._keyStr.indexOf(e.charAt(u++)),l=this._keyStr.indexOf(e.charAt(u++)),r=a<<2|o>>4,n=(15&o)<<4|s>>2,i=(3&s)<<6|l,t+=String.fromCharCode(r),64!=s&&(t+=String.fromCharCode(n)),64!=l&&(t+=String.fromCharCode(i));return t=c._utf8_decode(t)},_utf8_encode:function(e){e=e.replace(/rn/g,"n");for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t},_utf8_decode:function(e){for(var t="",r=0,n=c1=c2=0;r<e.length;)n=e.charCodeAt(r),n<128?(t+=String.fromCharCode(n),r++):n>191&&n<224?(c2=e.charCodeAt(r+1),t+=String.fromCharCode((31&n)<<6|63&c2),r+=2):(c2=e.charCodeAt(r+1),c3=e.charCodeAt(r+2),t+=String.fromCharCode((15&n)<<12|(63&c2)<<6|63&c3),r+=3);return t}},d=0,p={getUniqueDomId:function(){return d+=1,d+"_"+Date.now()},uniqueId:function(){return p.getUniqueDomId()},basemixin:function(e,t){return p.merge(e.prototype,t)},mixin:function(e,t){var r=new t;p.merge(e,r),p.merge(e.prototype,t.prototype)},merge:function(e,t){var r=void 0;for(r in t)p.hasOwn(t,r)&&(e[r]=t[r])},hasOwn:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},inherit:function(e,t){function r(){}r.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new r,e.prototype.constructor=e},base:function(e,t,r){var n=arguments.callee.caller;if(n.superClass_)return n.superClass_.constructor.apply(e,Array.prototype.slice.call(arguments,1));for(var i=Array.prototype.slice.call(arguments,2),a=!1,o=e.constructor;o;o=o.superClass_&&o.superClass_.constructor)if(o.prototype[t]===n)a=!0;else if(a)return o.prototype[t].apply(e,i);if(e[t]===n)return e.constructor.prototype[t].apply(e,i);throw Error("base called from a method of one name to a method of a different name")},noop:function(){},truefnc:function(){return!0},falsefnc:function(){return!0},resolve:function(e){var t=$.Deferred();return t.resolve(e),t.promise()},reject:function(e){var t=$.Deferred();return t.reject(e),t.promise()},getValueFromG3WObjectEvent:function(){},getAjaxResponses:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.length,r=$.Deferred(),n=[],i=[];return e.forEach(function(e){e.then(function(e){n.push(e)}).fail(function(e){i.push(e)}).always(function(){t=t>0?t-1:t,0===t&&r.resolve({done:n,fail:i})})}),r.promise()},trimValue:function(e){return e.replace(/ /g,"")},isURL:function(e){return e&&e.match(/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g)},sanitizeUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.reserverParameters,n=void 0===r?[]:r,i=new URL(t);return n.forEach(function(e){for(var r=[e.toUpperCase(),e.toLowerCase()],n=0;n<2;n++){var a=r[n],o=i.searchParams.get(a);if(o){t=t.replace(a+"="+o,"");break}}}),t},convertObjectToUrlParams:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return $.param(e)},appendParams:function(e,t){var r=[];Object.keys(t).forEach(function(e){null!==t[e]&&void 0!==t[e]&&r.push(e+"="+encodeURIComponent(t[e]))});var n=r.join("&");return e=e.replace(/[?&]$/,""),e=e.indexOf("?")===-1?e+"?":e+"&",e+n},imageToDataURL:function(e){var t=e.src,r=e.type,n=void 0===r?"image/jpeg":r,i=e.callback,a=void 0===i?function(){}:i,o=new Image;o.onload=function(){var e=document.createElement("canvas"),t=e.getContext("2d");e.height=this.naturalHeight,e.width=this.naturalWidth,t.drawImage(this,0,0);var r=e.toDataURL(n);a(r)},o.src=t},capitalize_first_letter:function(e){return""+e[0].toUpperCase()+e.slice(1)},Base64:c,toRawType:function(e){var t=Object.prototype.toString;return t.call(e).slice(8,-1)},isEmptyObject:function(e){return"{}"===JSON.stringify(e)},throttle:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,r=void 0;return function(){var n=r;r=Date.now(),(void 0===n||r-n>t)&&e.apply(void 0,arguments)}},debounce:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,r=void 0;return function(){for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];clearTimeout(r),r=setTimeout(function(){e.apply(void 0,i)},t)}},getRandomColor:function(){return"#"+((1<<24)*Math.random()|0).toString(16)},copyUrl:function(e){var t=document.createElement("input");document.body.appendChild(t),t.value=e,t.select(),document.execCommand("copy"),document.body.removeChild(t)},downloadFile:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.filename,i=t.content,a=t.url,o=t.mime_type,s=void 0===o?"text/plain":o,l=function(e){var t=document.createElement("a");t.setAttribute("href",window.URL.createObjectURL(e)),t.setAttribute("download",r),t.dataset.downloadurl=[s,t.download,t.href].join(":"),t.click(),t=null};return new Promise(function(t,o){if(i){var u=new Blob([i],{type:s});l(u),t()}else a&&fetch(a).then(function(){var t=n(regeneratorRuntime.mark(function i(t){var n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(200!==t.status){e.next=6;break}return s=s||t.headers.get("content-type"),r=r||t.headers.get("content-disposition").split("filename=").length?t.headers.get("content-disposition").split("filename=")[1]:"g3w_download_file",e.abrupt("return",t.blob());case 6:if(400!==t.status&&500!==t.status){e.next=12;break}return e.next=9,t.json();case 9:return n=e.sent,a=n.message,e.abrupt("return",Promise.reject(a));case 12:case"end":return e.stop()}},i,e)}));return function(e){return t.apply(this,arguments)}}()).then(function(e){l(e),t()})["catch"](function(e){o(e)})})},downloadCSVLayerFeatures:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.layer,n=t.alias,i=void 0===n||n,a=e("core/utils/geo"),o=a.getAlphanumericPropertiesFromFeature,s=Object.keys(r.features[0].attributes),l=o(s),u=i?l.map(function(e){var t=r.attributes.find(function(t){return t.name===e});return t?t.label:e}):l,c=r.features.map(function(e){var t=e.attributes,r={};return l.forEach(function(e,n){var a=!i&&e||u[n];r[a]=t[e]}),r});p.downloadCSV({filename:r.id,items:c})},downloadCSV:function(){function e(e){for(var t="",r=0;r<e.length;r++){var n="";for(var i in e[r])""!==n&&(n+=";"),n+=e[r][i];t+=n+"\r\n"}return t}var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.filename,n=void 0===r?p.getUniqueDomId():r,i=t.items,a=void 0===i?[]:i,o=n+".csv",s=e(a),l=new Blob([s],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob)navigator.msSaveBlob(l,o);else{var u=document.createElement("a");if(void 0!==u.download){var c=URL.createObjectURL(l);u.setAttribute("href",c),u.setAttribute("download",o),u.style.visibility="hidden",u.click()}}},getTimeoutPromise:function(e){var t=e.timeout,r=void 0===t?o.TIMEOUT:t,n=e.resolve,i=e.data,a=setTimeout(function(){n(i)},r);return a},XHR:{get:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.params,n=void 0===r?{}:r;return new Promise(function(e,r){t?$.get(t,n).then(function(t){e(t)}).fail(function(e){return r(e)}):r("No url")})},post:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.data,n=e.formdata,i=void 0!==n&&n,a=e.contentType,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise(function(e,n){if(i){var s=new FormData;for(var l in r)s.append(l,r[l]);$.ajax({type:"POST",url:t,data:s,processData:!1,contentType:!1}).then(function(t,r,n){e(o?{data:t,status:r,request:n}:t)}).fail(function(e){n(e)})}else a?$.ajax({type:"POST",url:t,data:r,processData:!1,contentType:a||!1}).then(function(t,r,n){e(o?{data:t,status:r,request:n}:t)}).fail(function(e){n(e)}):$.post(t,r).then(function(t,r,n){e(o?{data:t,status:r,request:n}:t)}).fail(function(e){n(e)})})},htmlescape:function(e){return e=e.replace("&","&amp;"),e=e.replace("<","&lt;"),e=e.replace(">","&gt;"),e=e.replace('"',"&quot;")},fileDownload:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.data,n=e.httpMethod,i=void 0===n?"POST":n,a=void 0;return new Promise(function(e,n){var s=$.fileDownload(t,{httpMethod:i,data:r});a=setTimeout(function(){n("Timeout"),s.abort()},o.TIMEOUT),s.done(function(){return e()}).fail(function(){return n()}).always(function(){clearTimeout(a)})})}},createSingleFieldParameter:function(e){var t=e.field,r=e.value,n=e.operator,i=void 0===n?"eq":n,a=e.logicop,o=void 0===a?null:a,l=e.search_endpoint,u=void 0===l?"api":l;if("api"===u){if(o=o&&"|"+o,Array.isArray(r)){var c="",d=r.length;return r.forEach(function(e,r){c+=t+"|"+i+"|"+encodeURIComponent(e)+(r<d-1?o+",":"")}),c}return t+"|"+i.toLowerCase()+"|"+encodeURIComponent(r)+(o||"")}if(Array.isArray(r)){var p="",f=r.length;return r.forEach(function(e,r){p+='"'+t+'" '+s.EXPRESSION_OPERATORS[i]+" '"+encodeURIComponent(e)+"' "+(r<f-1?o+" ":"")}),p}return'"'+t+'" '+s.EXPRESSION_OPERATORS[i]+" '"+encodeURIComponent(r)+"'"},createFilterFromString:function(e){var t=e.layer,r=e.search_endpoint,n=void 0===r?"ows":r,i=e.filter,o=void 0===i?"":i,c=o;switch(n){case"ows":var d=t.getWMSLayerName(),p=new u({layerName:d,filter:c});o=new l,o.setExpression(p.get());break;case"api":Object.values(s.EXPRESSION_OPERATORS).forEach(function(e){var t=new RegExp("\\s+"+e+"\\s+","g");c=c.replace(t,""+e);var r=new RegExp("'"+e,"g");c=c.replace(r,""+e),r=new RegExp(e+"'","g"),c=c.replace(r,""+e)}),c=c.replace(/'$/g,""),o=c.replace(/"/g,""),Object.entries(s.EXPRESSION_OPERATORS).forEach(function(e){var t=a(e,2),r=t[0],n=t[1],i=new RegExp(n,"g"),s="AND"===n||"OR"===n?"|"+r+",":"|"+r+"|";o=o.replace(i,s)}),o=o.split("|").map(function(e,t){return(t+1)%3===0?encodeURIComponent(e):e}).join("|")}return o},createFilterFormInputs:function(e){var t=e.layer,r=e.search_endpoint,n=void 0===r?"ows":r,i=e.inputs,a=void 0===i?[]:i,o=Array.isArray(t),s=void 0,c=[];switch(n){case"ows":if(o)t.forEach(function(e){var t=new u,r=e.getWMSLayerName();t.createExpressionFromFilter(a,r),s=new l,s.setExpression(t.get()),c.push(s)});else{var d=new u,f=t.getWMSLayerName();d.createExpressionFromFilter(a,f),s=new l,s.setExpression(d.get())}break;case"api":var h=a.length-1,v=a.map(function(e,t){return p.createSingleFieldParameter({field:e.attribute,value:e.value,operator:e.operator,logicop:t<h?e.logicop:null})});s=v.length?v.join():void 0,o&&t.forEach(function(){return c.push(s)})}return o?c:s},createFilterFormField:function(e){var t=e.layer,r=e.search_endpoint,n=void 0===r?"ows":r,i=e.field,a=e.value,o=e.operator,s=void 0===o?"eq":o,c=void 0;switch(n){case"ows":var d=new u,f=t.getWMSLayerName();d.createExpressionFromField({layerName:f,field:i,value:a,operator:s}),c=new l,c.setExpression(d.get());break;case"api":c=p.createSingleFieldParameter({field:i,value:a,operator:s})}return c},splitContextAndMethod:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.split(":"),r=a(t,2),n=r[0],i=r[1];return{context:n,method:i}},colorHEXToRGB:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#FFFFFF",t=parseInt(e.substr(1,2),16),r=parseInt(e.substr(3,2),16),n=parseInt(e.substr(5,2),16);return[t,r,n]}};t.exports=p},{"../../constant":5,"../layers/filter/operators":48,"core/layers/filter/expression":46,"core/layers/filter/filter":47,"core/utils/geo":89}],93:[function(e,t,r){var n=e("core/utils/utils"),i=n.truefnc,a={validators:{"float":function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=e,this.validate=function(e){var t=Number(1*e);return!Number.isNaN(t)&&t<=2147483647}},integer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=e,this.validate=function(e){var t=1*e;return!_.isNaN(t)&&(Number.isSafeInteger(t)&&t<=2147483647)}},checkbox:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=e,this.validate=function(e){var t=this.options.values||[];return t.indexOf(e)!==-1}},datetimepicker:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=e,this.validate=function(e,t){var r=t.fielddatetimeformat;return moment(e,r,!0).isValid()}},text:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=e,this.validate=i},string:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=e,this.validate=i},radio:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=e,this.validate=i},"default":function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=e,this.validate=i},range:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.min,r=e.max;this.validate=function(e){return e=1*e,e>=t&&e<=r}}},get:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.validators[e]||this.validators["default"];return new r(t)}};t.exports=a},{"core/utils/utils":92}],94:[function(e,t,r){var n=e("core/utils/validators"),i=n.validators;t.exports=i.range},{"core/utils/validators":93}],95:[function(e,t,r){var n=e("core/utils/validators");t.exports=n},{"core/utils/validators":93}],96:[function(e,t,r){function n(){var e=[],t=void 0,r=0,n=null,i=void 0,o=void 0;this.queques={end:new l,micro:new l},this.start=function(r){return i=$.Deferred(),o=r,t=r.getInputs(),n=r.getContext(),e=r.getSteps(),e&&e.length&&this.runStep(e[0],t,n),i.promise()},this.runStep=function(e,t){var r=this;o.setMessages({help:e.state.help});var i=this.queques.micro.getLength();e.run(t,n,this.queques).then(function(e){i&&r.queques.micro.run(),r.onDone(e)}).fail(function(e){return r.onError(e)})},this.onDone=function(t){return r++,r===e.length?(r=0,void i.resolve(t)):void this.runStep(e[r],t)},this.onError=function(e){r=0,this.clearQueques(),i.reject(e)},this.stop=function(){var t=$.Deferred();return e[r].isRunning()?e[r].stop():null,this.clearQueques(),r>0?(r=0,t.reject()):t.resolve(),t.promise()},a(this)}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("core/g3wobject"),l=e("./queque");o(n,s);var u=n.prototype;u.clearQueques=function(){this.queques.micro.clear(),this.queques.end.clear()},t.exports=n},{"./queque":97,"core/g3wobject":26,"core/utils/utils":92}],97:[function(e,t,r){function n(){this.tasks=[]}var i=n.prototype;i.addTask=function(e){this.tasks.push(e)},i.run=function(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.tasks.length;){var t=e?this.tasks.pop():this.tasks.shift();t()}},i.flush=function(){return this.tasks.splice(0)},i.getLength=function(){return this.tasks.length},i.clear=function(){this.run(),this.tasks=[]},t.exports=n},{}],98:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this);var t=e.inputs,r=void 0===t?null:t,n=e.context,i=void 0===n?null:n,o=e.task,s=void 0===o?null:o,l=e.outputs,u=void 0===l?null:l,c=e.escKeyPressEventHandler;this._inputs=r,this._context=i,this._task=s,this._outputs=u,this.state={id:e.id||null,name:e.name||null,help:e.help||null,running:!1,error:null,message:e.message||null},c&&this.registerEscKeyEvent(c)}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("core/g3wobject");o(n,s);var l=n.prototype;l.escKeyUpHandler=function(e){var t=e.data,r=t.task,n=t.callback;"Escape"===e.key&&n({task:r})},l.unbindEscKeyUp=function(){$(document).unbind("keyup",this.escKeyUpHandler)},l.bindEscKeyUp=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};$(document).on("keyup",{callback:e,task:this.getTask()},this.escKeyUpHandler)},l.registerEscKeyEvent=function(e){var t=this;this.on("run",function(){return t.bindEscKeyUp(e)}),this.on("stop",function(){return t.unbindEscKeyUp()})},l.run=function(e,t,r){var n=this;this.emit("run",{inputs:e,context:t});var i=$.Deferred();if(this._task)try{this.state.running=!0,this._task.setInputs(e),this._task.setContext(t),this._task.run(e,t,r).then(function(e){n.stop(),i.resolve(e)}).fail(function(e){n.stop(),i.reject(e)})}catch(a){this.state.error=a,this.state.error="Problem ..",this.stop(),i.reject(a)}return i.promise()},l.stop=function(){this._task.stop(this._inputs,this._context),this.state.running=!1,this.emit("stop"),this._task.setInputs(null),this._task.setContext(null)},l.revert=function(){this._task&&this._task.revert&&this._task.revert()},l.panic=function(){this._task&&this._task.panic&&this._task.panic()},l.getId=function(){return this.state.id},l.getName=function(){return this.state.name},l.getHelp=function(){return this.state.help},l.getError=function(){return this.state.error},l.getMessage=function(){return this.state.message},l.isRunning=function(){return this.state.running},l.setInputs=function(e){this._inputs=e},l.getInputs=function(){return this._inputs},l.setTask=function(e){this._task=e},l.getTask=function(){return this._task},l.setOutputs=function(e){this._outputs=e},l.getOutputs=function(){return this._outputs},n.MESSAGES={help:null},t.exports=n},{"core/g3wobject":26,"core/utils/utils":92}],99:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.state={usermessagesteps:{}}}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("core/g3wobject");o(n,s);var l=n.prototype;l.setInputs=function(e){this.inputs=e},l.getInputs=function(){return this.inputs},l.setContext=function(e){return this.context=e},l.getContext=function(){return this.context},l.revert=function(){},l.panic=function(){},l.stop=function(){},l.run=function(){},l.setRoot=function(e){this.state.root=e},l.getUserMessageSteps=function(){return this.state.usermessagesteps},l.setUserMessageSteps=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state.usermessagesteps=e},l.setUserMessageStepDone=function(e){e&&(this.state.usermessagesteps[e].done=!0)},t.exports=n},{"core/g3wobject":26,"core/utils/utils":92}],100:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.inputs,r=void 0===t?null:t,n=e.context,a=void 0===n?null:n,s=e.flow,l=void 0===s?new c:s,u=e.steps,d=void 0===u?[]:u,p=e.runOnce,h=void 0!==p&&p;
o(this),this._promise=null,this._inputs=r,this._context=a,this._flow=l,this._steps=d,this._child=null,this._stackIndex=null,this.runOnce=h,this._messages=f,this._userMessageSteps=this._steps.reduce(function(e,t){var r=t.getTask().getUserMessageSteps();return r&&i({},e,r)||e},{})}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=e("core/utils/utils"),o=a.base,s=a.inherit,l=a.resolve,u=e("core/g3wobject"),c=e("./flow"),d=e("./workflowsstack"),p=e("./step"),f=p.MESSAGES,h=e("gui/workflow/createUserMessageStepsFactory"),v=e("gui/gui");s(n,u);var g=n.prototype;g.getContextService=function(){var e=this.getContext();return e.service},g.setContextService=function(e){var t=this.getContext();t.service=e},g.getStackIndex=function(){return this._stackIndex},g.addChild=function(e){this._child?this._child.addChild(e):this._child=e},g.removeChild=function(){if(this._child){var e=this._child.getStackIndex();d.removeAt(e)}this._child=null},g._setInputs=function(e){this._inputs=e},g.getInputs=function(){return this._inputs},g.setContext=function(e){this._context=e},g.getContext=function(){return this._context},g.getFlow=function(){return this._flow},g.setFlow=function(e){this._flow=e},g.addStep=function(e){this._steps.push(e)},g.setSteps=function(e){this._steps=e},g.getSteps=function(){return this._steps},g.getStep=function(e){return this._steps[e]},g.setMessages=function(e){Object.assign(this._messages,e)},g.getMessages=function(){return this._messages},g.clearMessages=function(){this._messages.help=null,this._isThereUserMessaggeSteps()&&this.clearUserMessagesSteps()},g.getLastStep=function(){var e=this._steps.length;return e?this._steps[e]:null},g.getRunningStep=function(){return this._steps.find(function(e){return e.isRunning()})},g._stopChild=function(){return this._child?this._child.stop():l()},g._isThereUserMessaggeSteps=function(){return Object.keys(this._userMessageSteps).length},g.reject=function(){this._promise&&this._promise.reject()},g.resolve=function(){this._promise&&this._promise.resolve()},g.start=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred();this._promise=r,this._inputs=t.inputs,this._context=t.context||{};var n=this._context.isChild||!1;d.getLength()&&d.getCurrent()!==this&&!n&&d.getCurrent().addChild(this),this._stackIndex=d.push(this),this._flow=t.flow||this._flow,this._steps=t.steps||this._steps;var i=this._isThereUserMessaggeSteps();if(i){var a=h({steps:this._userMessageSteps});v.showUserMessage({title:"sdk.workflow.steps.title",type:"tool",position:"left",size:"small",closable:!1,hooks:{body:a}})}return this._flow.start(this).then(function(t){i&&setTimeout(function(){e.clearUserMessagesSteps(),r.resolve(t)},500)||r.resolve(t)}).fail(function(t){i&&e.clearUserMessagesSteps(),r.reject(t)}).always(function(){e.runOnce&&e.stop()}),this.emit("start"),r.promise()},g.stop=function(){var e=this;this._promise=null;var t=$.Deferred();return this._stopChild().always(function(){e.removeChild(),d.removeAt(e.getStackIndex()),e._flow.stop().then(function(){return t.resolve()}).fail(function(e){return t.reject(e)}).always(function(){return e.clearMessages()})}),this.emit("stop"),t.promise()},g.clearUserMessagesSteps=function(){this._resetUserMessaggeStepsDone(),v.closeUserMessage()},g._resetUserMessaggeStepsDone=function(){var e=this;Object.keys(this._userMessageSteps).forEach(function(t){var r=e._userMessageSteps[t];r.done=!1,r.buttonnext&&(r.buttonnext.disabled=!0)})},t.exports=n},{"./flow":96,"./step":98,"./workflowsstack":101,"core/g3wobject":26,"core/utils/utils":92,"gui/gui":150,"gui/workflow/createUserMessageStepsFactory":231}],101:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("services/workflows"),a=n(i);t.exports=a["default"]},{"services/workflows":400}],102:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});r.SPATIALMETHODS=["intersects","within"],r.VM=new Vue},{}],103:[function(e,t,r){function n(){var e={name:"addlayer",tipLabel:"sdk.mapcontrols.addlayer.tooltip",label:""};i.call(this,e),this._layerstore=null}var i=e("./control");ol.inherits(n,i);var a=n.prototype;a.setMap=function(e){var t=this;i.prototype.setMap.call(this,e),$(this.element).on("click",function(){return t.dispatchEvent("addlayer")})},a.layout=function(e){i.prototype.layout.call(this,e)},a.getLayersSore=function(){return this._layerstore},a.setLayersStore=function(e){this._layerstore=e},t.exports=n},{"./control":105}],104:[function(e,t,r){var n=e("core/utils/ol"),i=e("../interactions/areainteraction"),a=e("./measurecontrol"),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={tipLabel:"sdk.mapcontrols.measures.area.tooltip",label:"",clickmap:!0,interactionClass:i};e=n.merge(e,t),a.call(this,e)};ol.inherits(o,a),t.exports=o},{"../interactions/areainteraction":125,"./measurecontrol":111,"core/utils/ol":90}],105:[function(e,t,r){function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var i=e("./utils"),a=i.layout,o=function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,r=void 0===t?"":t,i=e.visible,a=void 0===i||i,o=e.enabled,s=void 0!==o&&o;if(this._enabled=s,this.offline=void 0===e.offline||e.offline,this.name=r.split(" ").join("-").toLowerCase(),this.id=this.name+"_"+Math.floor(1e6*Math.random()),this.eventKeys={},this.positionCode=e.position||"tl",this.priority=e.priority||0,!e.element){var u="ol-"+this.name.split(" ").join("-").toLowerCase(),c=e.customClass,d=e.tipLabel||this.name,p=e.label||"",f=Vue.extend({functional:!0,render:function(e){var t;return e("div",{"class":(t={},n(t,u,!!u),n(t,"ol-unselectable",!0),n(t,"ol-control",!0),t)},[e("button",{attrs:{type:"button"},directives:[{name:"t-tooltip",value:d}]},[p,e("i",{"class":n({},c,!!c)})])])}}),h=(new f).$mount().$el;e.element=h}var v=e.buttonClickHandler||l.prototype._handleClick.bind(this);$(e.element).on("click",v),ol.control.Control.call(this,e),this.setVisible(a),this._postRender()};ol.inherits(o,ol.control.Control);var s=o.prototype;s.isClickMap=function(){return this.clickmap},s.isToggled=function(){return this._toggled},s.setEventKey=function(e){var t=e.eventType,r=e.eventKey;this.eventKeys[t]={eventKey:r,originalHandler:r.linstener}},s.resetOriginalHandlerEvent=function(e){var t=this.eventKeys[e].eventKey;t&&ol.Observable.unByKey(t),this.eventKeys[e].eventKey=this.on(e,this.eventKeys[e].originalHandler)},s.overwriteEventHandler=function(e){var t=e.eventType,r=e.handler,n=this.eventKeys[t].eventKey;n&&ol.Observable.unByKey(n),this.eventKeys[t].eventKey=this.on(t,r)},s.getPosition=function(e){e=e||this.positionCode;var t={};return t.top=e.indexOf("t")>-1,t.left=e.indexOf("l")>-1,t.bottom=e.indexOf("b")>-1,t.right=e.indexOf("r")>-1,t},s._handleClick=function(e){var t=this;e.preventDefault();var r=this.getMap(),n=null,i=r.getControls();this._toggled&&i.forEach(function(e){e.id&&e.toggle&&e.id!==t.id&&(e.toggle(!1),"reset"===e.name&&(n=e))}),!this._toggled&&n&&n.toggle(!0),this.dispatchEvent("controlclick")},s.shiftPosition=function(e){$(this.element).css(hWhere,e+"px")},s.layout=function(e){if(e){var t=this.getPosition(),r=$(this.element);a({map:e,position:t,element:r})}},s.changelayout=function(e){},s.setMap=function(e){e&&(this.layout(e),ol.control.Control.prototype.setMap.call(this,e))},s.showControl=function(){$(this.element).show()},s.hideControl=function(){var e=$(this.element).position().left,t=$(this.element).outerWidth(),r=e,n=$(this.element).siblings(".ol-control-tl");n.each(function(){$(this).position().left>e&&(r=$(this).position().left,t>$(this).outerWidth()&&(e+=t-$(this).outerWidth()),$(this).css("left",e+"px"),e=r,t=$(this).outerWidth())}),$(this.element).hide()},s.setEnable=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=$(this.element).find("button").first();e?r.removeClass("g3w-ol-disabled"):(r.addClass("g3w-ol-disabled"),this._interaction&&this._interaction.setActive(!1)),this.toggle&&this.toggle(t),this._enabled=e},s.getEnable=function(){return this._enabled},s.setVisible=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._visible=e,$(this.element)[e?"show":"hide"]()},s.isVisible=function(){return this._visible},s._postRender=function(){},t.exports=o},{"./utils":122}],106:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options={provider:"osm",placeholder:e.placeholder||"Citt, indirizzo ... ",noresults:e.noresults||"Nessun risultato ",notresponseserver:e.notresponseserver||"Il server non risponde",lang:d["default"].lng||"it-IT",limit:e.limit||5,keepOpen:!0,preventDefault:!1,autoComplete:!1,autoCompleteMinLength:4,debug:!1,viewbox:e.bbox,bounded:1,classMobile:e.isMobile?"nominatim-mobile":"",mapCrs:e.mapCrs,fontIcon:g.getFontClass("search")};var t=this.options,r=t.placeholder,n=t.fontIcon,o=t.mapCrs,s=t.viewbox;this.providers=[new b({mapCrs:o,viewbox:s}),new _({mapCrs:o,viewbox:s})],this.layer=new ol.layer.Vector({source:new ol.source.Vector,style:new ol.style.Style({text:new ol.style.Text({text:"",font:'900 3em "Font Awesome 5 Free"',stroke:new ol.style.Stroke({color:"red",width:3}),fill:new ol.style.Fill({color:"rgba(255, 0,0, 0.7)"})})})}),this.projection;var l=m.namespace+" "+m.inputText.container+" "+this.options.classMobile,u=this,c=Vue.extend({functional:!0,render:function(e){return e("div",{"class":a({},l,!0)},[e("div",{"class":a({},m.inputText.control,!0)},[e("input",{attrs:{type:"text",id:m.inputQueryId,autocomplete:"off"},"class":a({},m.inputText.input,!0),directives:[{name:"t-placeholder",value:r}]}),e("button",{attrs:{type:"button",id:"search_nominatim"},"class":{btn:!0},on:{click:function(){var e=$("input."+m.inputText.input).val();u.query(e)}}},[e("i",{attrs:{"aria-hidden":!0},style:{color:"#ffffff"},"class":a({},n,!0)})]),e("button",{attrs:{type:"button",id:m.inputResetId},"class":a({},m.inputText.reset+"  "+m.hidden,!0)})]),e("ul",{"class":a({},m.inputText.result,!0)})])}});this.container=(new c).$mount().$el,this.lastQuery="",this.registeredListeners={mapClick:!1},this.showMarker=function(e){this.hideMarker(),e=ol.proj.transform(e,"EPSG:4326",this.getMap().getView().getProjection());var t=new ol.geom.Point(e),r=new ol.Feature(t);this.layer.getSource().addFeature(r),this.getMap().addLayer(this.layer),g.getService("map").zoomToGeometry(t)},this.hideMarker=function(){this.layer.getSource().clear(),this.getMap().removeLayer(this.layer)},this.createControl=function(){var e=this,t=void 0,r=void 0;this.control=y.find("."+m.inputText.control,this.container),this.input=y.find("."+m.inputText.input,this.container),this.reset=y.find("."+m.inputText.reset,this.container),this.result=y.find("."+m.inputText.result,this.container);var n=function(t){var r=t.target.value.trim(),n=t.key?"Enter"===t.key:t.which?13===t.which:!!t.keyCode&&13===t.keyCode;n&&(t.preventDefault(),e.query(r))},i=function(){e.input.focus(),e.input.value="",e.lastQuery="",y.addClass(e.reset,m.hidden),e.clearResults()},a=function(n){var i=n.target.value.trim();i.length?y.removeClass(e.reset,m.hidden):y.addClass(e.reset,m.hidden),e.options.autoComplete&&i!==r&&(r=i,t&&clearTimeout(t),t=setTimeout(function(){return i.length>=e.options.autoCompleteMinLength&&e.query(i)},200))};this.input.addEventListener("keyup",n,!1),this.input.addEventListener("input",a,!1),this.reset.addEventListener("click",i,!1)},this.query=function(e){var t=this;return this.hideMarker(),new Promise(function(){var r=i(regeneratorRuntime.mark(function n(r,i){var a,o,s,l,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(a=function(e){return"Number"===h(e)&&!Number.isNaN(e)},o=null,e&&2===e.split(",").length&&(o=e.split(","),o=a(1*o[0])&&a(1*o[1])?o.map(function(e){return 1*e}):null),!o){r.next=7;break}t.showMarker(coordinates),r.next=17;break;case 7:if(t.lastQuery!==e||!t.result.firstChild){r.next=9;break}return r.abrupt("return");case 9:return s=[],l=t.providers.filter(function(e){return e.active}),l.forEach(function(r){var n=r.getParameters({query:e,lang:t.options.lang,countrycodes:t.options.countrycodes,limit:t.options.limit}),i=n.url,a=n.params;t.lastQuery=e,t.clearResults(),y.addClass(t.reset,m.spin),s.push(v.get({url:i,params:a}))}),r.next=14,Promise.allSettled(s);case 14:u=r.sent,u.forEach(function(e,r){var n=e.status,i=e.value;if("fulfilled"===n){var a=l[r].handleResponse(i),o=a.header,s=a.results;l[r].active&&t.createList({header:o,results:s})}}),y.removeClass(t.reset,m.spin);case 17:case"end":return r.stop()}},n,t)}));return function(e,t){return r.apply(this,arguments)}}())},this.createList=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.header,n=t.results,i=void 0===n?{}:n,a=this.result;if(a.appendChild(this.createHeaderProviderResults(r)),i.length)i.forEach(function(t){var r=e.addressTemplate(t.address),n=['<a href="#">',r,"</a>"].join(""),i=y.createElement("li",n);i.addEventListener("click",function(n){n.preventDefault(),e.chosen(t,r,t.address,t.original)},!1),a.appendChild(i)});else{var o=this.options.noresults,s=Vue.extend({functional:!0,render:function(e){return e("li",{"class":{"nominatim-noresult":!0},directives:[{name:"t",value:o}]})}}),l=(new s).$mount().$el;a.appendChild(l)}},this.chosen=function(e,t,r,n){var i=[parseFloat(e.lon),parseFloat(e.lat)];this.options.keepOpen===!1&&this.clearResults(!0),this.showMarker(i)},this.createHeaderProviderResults=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t='\n      <div style="display: flex; justify-content: space-between; padding: 5px">\n        <span  style="color: #FFFFFF; font-weight: bold">'+e.title+"</span>\n      </div>",r=y.createElement("li",t);return r.classList.add("skin-background-color"),r},this.addressTemplate=function(e){var t=[];return e.name&&t.push(['<div class="',m.road,'">{name}</div>'].join("")),(e.road||e.building||e.house_number)&&t.push(['<div class="',m.road,'">{building} {road} {house_number}</div>'].join("")),(e.city||e.town||e.village)&&t.push(['<div class="',m.city,'">{postcode} {city} {town} {village}</div>'].join("")),(e.state||e.country)&&t.push(['<div class="',m.country,'">{state} {country}</div>'].join("")),y.template(t.join("<br>"),e)},this.expand=function(){var e=this;y.removeClass(this.input,m.spin),y.addClass(this.control,m.glass.expanded),setTimeout(function(){return e.input.focus()},100)},this.collapse=function(){this.input.value="",this.input.blur(),y.addClass(this.reset,m.hidden),this.clearResults()},this.clearResults=function(){y.removeAllChildren(this.result),this.hideMarker()},this.getSource=function(){return this.layer.getSource()},this.addLayer=function(){var e=this,t=this.getMap(),r=t.getLayers().find(function(t){return t===e.layer});!r&&t.addLayer(this.layer)},this.createControl(),p.call(this,{element:this.container,name:"nominatim",offline:!1})}var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=e("core/applicationstate"),d=n(c),p=e("./control"),f=e("core/utils/utils"),h=f.toRawType,v=f.XHR,g=e("gui/gui"),m={namespace:"ol-geocoder",spin:"gcd-pseudo-rotate",hidden:"gcd-hidden",inputQueryId:"gcd-input-query",inputResetId:"gcd-input-reset",country:"gcd-country",city:"gcd-city",road:"gcd-road",olControl:"ol-control",inputText:{container:"gcd-txt-container",control:"gcd-txt-control",input:"gcd-txt-input",reset:"gcd-txt-reset",result:"gcd-txt-result"}},y={isNumeric:function(e){return/^\d+$/.test(e)},classRegex:function(e){return new RegExp("(^|\\s+) "+e+" (\\s+|$)")},addClass:function(e,t,r){var n=this;if(Array.isArray(e))return void e.forEach(function(e){return n.addClass(e,t)});for(var i=Array.isArray(t)?t:t.split(/\s+/),a=i.length;a--;)this.hasClass(e,i[a])||this._addClass(e,i[a],r)},_addClass:function(e,t,r){var n=this;e.classList?e.classList.add(t):e.className=(e.className+" "+t).trim(),r&&this.isNumeric(r)&&setTimeout(function(){return n._removeClass(e,t)},r)},removeClass:function(e,t,r){var n=this;if(Array.isArray(e))return void e.forEach(function(e){return n.removeClass(e,t,r)});for(var i=Array.isArray(t)?t:t.split(/\s+/),a=i.length;a--;)this.hasClass(e,i[a])&&this._removeClass(e,i[a],r)},_removeClass:function(e,t,r){var n=this;e.classList?e.classList.remove(t):e.className=e.className.replace(this.classRegex(t)," ").trim(),r&&this.isNumeric(r)&&setTimeout(function(){return n._addClass(e,t)},r)},hasClass:function(e,t){return e.classList?e.classList.contains(t):this.classRegex(t).test(e.className)},toggleClass:function(e,t){var r=this;return Array.isArray(e)?void e.forEach(function(e){return r.toggleClass(e,t)}):void(e.classList?e.classList.toggle(t):this.hasClass(e,t)?this._removeClass(e,t):this._addClass(e,t))},find:function(e,t,r){void 0===t&&(t=window.document);var n=/^(#?[\w-]+|\.[\w-.]+)$/,i=/\./g,a=Array.prototype.slice,o=[];if(n.test(e))switch(e[0]){case"#":o=[this.$(e.substr(1))];break;case".":o=a.call(t.getElementsByClassName(e.substr(1).replace(i," ")));break;default:o=a.call(t.getElementsByTagName(e))}else o=a.call(t.querySelectorAll(e));return r?o:o[0]},$:function(e){return e="#"===e[0]?e.substr(1,e.length):e,document.getElementById(e)},isElement:function(e){return"HTMLElement"in window?!!e&&e instanceof HTMLElement:!!e&&"object"===("undefined"==typeof e?"undefined":u(e))&&1===e.nodeType&&!!e.nodeName},getAllChildren:function(e,t){return[].slice.call(e.getElementsByTagName(t))},isEmpty:function(e){return!e||0===e.length},emptyArray:function(e){for(;e.length;)e.pop()},anyMatchInArray:function(e,t){return e.some(function(e){return t.indexOf(e)>=0})},everyMatchInArrayy:function(e,t){return t.every(function(t){return e.indexOf(t)>=0})},anyItemHasValue:function(e,t){var r=this;void 0===t&&(t=!1);var n=Object.keys(e);return n.forEach(function(n){r.isEmpty(e[n])||(t=!0)}),t},removeAllChildren:function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},removeAll:function(e){for(var t=void 0;t=e[0];)t.parentNode.removeChild(t)},getChildren:function(e,t){return[].filter.call(e.childNodes,function(e){return t?1===e.nodeType&&e.tagName.toLowerCase()===t:1===e.nodeType})},template:function(e,t){var r=this;return e.replace(/\{ *([\w_-]+) *\}/g,function(e,n){var i=void 0===t[n]?"":t[n];return r.htmlEscape(i)})},htmlEscape:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},createElement:function(e,t){var r=void 0;if(Array.isArray(e)){if(r=document.createElement(e[0]),e[1].id&&(r.id=e[1].id),e[1].classname&&(r.className=e[1].classname),e[1].attr){var n=e[1].attr;if(Array.isArray(n))for(var i=-1;++i<n.length;)r.setAttribute(n[i].name,n[i].value);else r.setAttribute(n.name,n.value)}}else r=document.createElement(e);r.innerHTML=t;for(var a=document.createDocumentFragment();r.childNodes[0];)a.appendChild(r.childNodes[0]);return r.appendChild(a),r}},_=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this.id="Nominatim (OSM)",this.active=!0;var r=ol.proj.transformExtent(t.viewbox,t.mapCrs,"EPSG:4326");this.settings={url:"https://nominatim.openstreetmap.org/search/",params:{q:"",format:"json",addressdetails:1,limit:10},extent:r,viewbox:r.join(",")}}return l(e,[{key:"getParameters",value:function(e){var t=this.settings,r=t.url,n=t.viewbox,i=t.params.limit;return{url:r,params:{q:e.query,format:"json",addressdetails:1,limit:e.limit||i,viewbox:n,bounded:1}}}},{key:"handleResponse",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=t.filter(function(t){return ol.extent.containsXY(e.settings.extent,t.lon,t.lat)}).map(function(e){return{lon:e.lon,lat:e.lat,address:{name:e.address.neighbourhood||"",road:e.address.road||"",postcode:e.address.postcode,city:e.address.city||e.address.town,state:e.address.state,country:e.address.country},original:{formatted:e.display_name,details:e.address}}});return{results:r,header:{title:this.id}}}}]),e}(),b=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this.id="Google",this.active=void 0!==d["default"].keys.vendorkeys.google;var r=ol.proj.transformExtent(t.viewbox,t.mapCrs,"EPSG:4326");this.settings={url:"https://maps.googleapis.com/maps/api/geocode/json",extent:r,viewbox:r[1]+","+r[0]+"|"+r[3]+","+r[2]}}return l(e,[{key:"getParameters",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.lang,r=this.settings,n=r.url,i=r.viewbox,a={address:e.query,key:d["default"].keys.vendorkeys.google,bounds:i,language:t};return{url:n,params:a}}},{key:"handleResponse",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=[];return"OK"===t.status?r=t.results.filter(function(t){return ol.extent.containsXY(e.settings.extent,t.geometry.location.lng,t.geometry.location.lat)}).map(function(e){var t=void 0,r=void 0,n=void 0,i=void 0,a=void 0;return e.address_components.forEach(function(e){var r=e.types,i=(e.short_name,e.long_name);r.find(function(e){return"route"===e})?t=i:r.find(function(e){return"locality"===e})?n=i:r.find(function(e){return"country"===e})&&(a=i)}),{lon:e.geometry.location.lng,lat:e.geometry.location.lat,address:{name:t,road:r,postcode:"",city:n,state:i,country:a},original:{formatted:e.display_name,details:e.address}}}):"REQUEST_DENIED"===t.status&&(this.active=!1),{results:r,header:{title:this.id}}}}]),e}();ol.inherits(s,p),t.exports=s},{"./control":105,"core/applicationstate":8,"core/utils/utils":92,"gui/gui":150}],107:[function(e,t,r){function n(){var e={visible:!1,offline:!1,name:"geolocation",tipLabel:"sdk.mapcontrols.geolocation.tooltip",label:""};this._layer=new ol.layer.Vector({source:new ol.source.Vector,style:new ol.style.Style({text:new ol.style.Text({text:"",font:'900 3em "Font Awesome 5 Free"',fill:new ol.style.Fill({color:"red"})})})}),i.call(this,e)}var i=e("./interactioncontrol");ol.inherits(n,i);var a=n.prototype;a._showMarker=function(e){var t=e.map,r=e.coordinates,n=e.show,i=void 0===n||n;if(this._layer)if(this._layer.getSource().clear(),i){t.getView().setCenter(r);var a=new ol.Feature({geometry:new ol.geom.Point(r)});this._layer.getSource().addFeature(a),t.addLayer(this._layer)}else t.removeLayer(this._layer)},a.getMap=function(){return i.prototype.getMap.call(this)},a.setMap=function(e){var t=this,r=void 0;i.prototype.setMap.call(this,e);var n=new ol.Geolocation({projection:e.getView().getProjection(),tracking:!0,trackingOptions:{enableHighAccuracy:!0}});n.on("change:position",function(){var r=n.getPosition();r?(t.isVisible()||(t.setVisible(!0),$(t.element).removeClass("g3w-ol-disabled"),n.dispatchEvent("authorized")),t._showMarker({map:e,coordinates:r,show:t.isToggled()})):t.hideControl()}),n.once("error",function(e){t.hideControl(),t._layer=null,1!==e.code&&t.dispatchEvent("error"),ol.Observable.unByKey(r),r=null}),n.once("authorized",function(){r=t.on("toggled",function(){var r=n.getPosition();t._showMarker({map:e,coordinates:r,show:t.isToggled()})})})},t.exports=n},{"./interactioncontrol":109}],108:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.name="maptoimagegeo",e.tipLabel="Geo Screenshot",e.label="",i.call(this,e)}var i=e("./screenshotcontrol");ol.inherits(n,i),t.exports=n},{"./screenshotcontrol":120}],109:[function(e,t,r){var n=e("../constants"),i=e("core/i18n/i18n.service"),a=i.t,o=e("./control"),s=e("gui/gui"),l=function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.visible,r=void 0===t||t,n=e.enabled,i=void 0===n||n,a=e.toggled,s=void 0!==a&&a,l=e.clickmap,u=void 0!==l&&l,d=e.interactionClass,p=void 0===d?null:d,f=e.autountoggle,h=void 0!==f&&f,v=e.geometryTypes,g=void 0===v?[]:v,m=e.onSelectlayer,y=e.onhover,_=void 0!==y&&y,b=e.help,w=void 0===b?null:b,x=e.toggledTool,S=e.interactionClassOptions,C=void 0===S?{}:S,L=e.spatialMethod;this._visible=r,this._toggled=s,this.clickmap=u,this._interactionClass=p,this._interaction=null,this._autountoggle=h,this._geometryTypes=g,this.onSelectLayer=m,this._onhover=_,this._help=w,this._helpButton,this._toolButton,this.spatialMethod=L,this.toggledTool,this._interactionClassOptions=C,e.buttonClickHandler=c.prototype._handleClick.bind(this),o.call(this,e),this._help&&this._createModalHelp(),x&&this.createControlTool(x),this.setEnable(i),s&&this.toggle(s)};ol.inherits(l,o);var u=l.prototype;u.isClickMap=function(){return this.clickmap},u.enable=function(){$(this.element).removeClass("g3w-disabled")},u.disable=function(){$(this.element).addClass("g3w-disabled")},u.createControlTool=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.type,i=t.component,a=t.how,o=void 0===a?"toggled":a;switch(r){case"spatialMethod":var l=this.getSpatialMethod();this.toggledTool={data:function(){return this.methods=n.SPATIALMETHODS,{method:l}},template:'\n          <div style="width: 100%; padding: 5px;">\n            <select ref="select" style="width: 100%"  :search="false" v-select2="\'method\'">\n              <option v-for="method in methods">{{method}}</option>\n            </select>\n          </div>',watch:{method:function(t){return e.setSpatialMethod(t)}},created:function(){s.setCloseUserMessageBeforeSetContent(!1)},beforeDestroy:function(){s.setCloseUserMessageBeforeSetContent(!0)}};break;case"custom":this.toggledTool=i}switch(o){case"hover":this._createToolOnHoverButton()}},u._createToolOnHoverButton=function(){var e=this;this._onhover&&(this._toolButton=$('<span style="display:none" class="tool_mapcontrol_button"><i class="'+s.getFontClass("tool")+'"></i></span>'),$(this.element).prepend(this._toolButton),this._toolButton.on("click",function(t){t.stopPropagation(),e.showToggledTool(!0)}),$(this.element).hover(function(){return e._toggled&&e._toolButton.show()}),$(this.element).mouseleave(function(){return e._toolButton.hide()}))},u.showToggledTool=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e?s.showUserMessage({title:"",type:"tool",size:"small",closable:!!this._toolButton,hooks:{body:this.toggledTool}}):s.closeUserMessage()},u._showModalHelp=function(){s.showModalDialog({title:a(this._help.title),message:a(this._help.message)})},u._createModalHelp=function(){var e=this;this._onhover&&(this._helpButton=$('<span style="display:none" class="info_mapcontrol_button">i</span>'),$(this.element).prepend(this._helpButton),this._helpButton.on("click",function(t){t.stopPropagation(),e._showModalHelp()}),$(this.element).hover(function(){return e._helpButton.show()}),$(this.element).mouseleave(function(){return e._helpButton.hide()}))},u.getGeometryTypes=function(){return this._geometryTypes},u.getInteraction=function(){return this._interaction},u.isToggled=function(){return this._toggled},u.getControlBottom=function(){return $(this.element).find("button").first()},u.addClassToControlBottom=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.getControlBottom();t.addClass(e)},u.removeClassToControlBottom=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.getControlBottom();t.removeClass(e)},u.toggle=function(e){e=void 0!==e?e:!this._toggled,this._toggled=e,e?(this._interaction&&this._interaction.setActive(!0),this.addClassToControlBottom("g3w-ol-toggled"),this._toolButton&&this._toolButton.show()):(this._help&&this._helpButton.hide(),this._interaction&&this._interaction.setActive(!1),this.removeClassToControlBottom("g3w-ol-toggled"),this._toolButton&&this._toolButton.hide(),this.toggledTool&&this.showToggledTool(!1)),void 0===this._toolButton&&this.toggledTool&&this.showToggledTool(this._toggled),this.dispatchEvent("toggled",e)},u.getGeometryTypes=function(){return this._geometryTypes},u.setGeometryTypes=function(e){this._geometryTypes=e},u.setMap=function(e){var t=this;o.prototype.setMap.call(this,e),!this._interaction&&this._interactionClass&&(this._interaction=new this._interactionClass(this._interactionClassOptions),e.addInteraction(this._interaction),this._interaction.setActive(!1)),this._toggled&&setTimeout(function(){t.toggle(!0)})},u._handleClick=function(e){this._enabled&&(this.toggle(),o.prototype._handleClick.call(this,e))},u.getIteraction=function(){return this._interaction},u.setSpatialMethod=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"intersects";this.spatialMethod=e},u.getSpatialMethod=function(){return this.spatialMethod},u.setLayers=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.layers=e},u.change=function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]},t.exports=l},{"../constants":102,"./control":105,"core/i18n/i18n.service":27,"gui/gui":150}],110:[function(e,t,r){var n=e("core/utils/ol"),i=e("../interactions/lengthinteraction"),a=e("./measurecontrol"),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={tipLabel:"sdk.mapcontrols.measures.length.tooltip",label:"",clickmap:!0,interactionClass:i};e=n.merge(e,t),a.call(this,e)};ol.inherits(o,a),t.exports=o},{"../interactions/lengthinteraction":127,"./measurecontrol":111,"core/utils/ol":90}],111:[function(e,t,r){var n=e("./interactioncontrol"),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._map=null,n.call(this,e)};ol.inherits(i,n);var a=i.prototype;a.setMap=function(e){n.prototype.setMap.call(this,e)},a.toggle=function(e){n.prototype.toggle.call(this,e),!this.isToggled()&&this.getIteraction()&&this.getIteraction().clear()},t.exports=i},{"./interactioncontrol":109}],112:[function(e,t,r){var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.target=e.target||"mouse-position-control",ol.control.MousePosition.call(this,e)};ol.inherits(n,ol.control.MousePosition),t.exports=n;var i=n.prototype;i.offline=!0,i.setEnable=function(e){e?$(this.element):$(this.element)},i.setMap=function(e){e&&($(this.element).removeClass("ol-control"),ol.control.MousePosition.prototype.setMap.call(this,e))}},{}],113:[function(e,t,r){var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};switch(this._control=null,this.positionCode=e.position||"tl",e.type){case"zoom":this._control=new ol.control.Zoom(e);break;case"zoomtoextent":this._control=new ol.control.ZoomToExtent(e);break;case"scaleline":this._control=new ol.control.ScaleLine(e);break;case"overview":this._control=new ol.control.OverviewMap(e)}$(this._control.element).addClass("ol-control-"+this.positionCode),ol.control.Control.call(this,{element:this._control.element})};ol.inherits(n,ol.control.Control),t.exports=n;var i=n.prototype;i.offline=!0,i.getOlControl=function(){return this._control},i.getPosition=function(e){e=e||this.positionCode;var t={};return t.top=e.indexOf("t")>-1,t.left=e.indexOf("l")>-1,t},i.layout=function(e){if(e){var t=this.getPosition(),r=e.getViewport(),n=$(r).find(".ol-control-"+this.positionCode);
if(n.length){previusControl=n.last();var i=t.left?previusControl.position().left:previusControl.position().right,a=t.left?"left":"right",o=previusControl[0].offsetWidth,s=$(this.element).position()[a]+i+o+2;$(this.element).css(a,s+"px")}}},i.changelayout=function(){},i.showHide=function(){$(this.element).toggle()},i.setMap=function(e){this.layout(e),this._control.setMap(e)}},{}],114:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._originalonlick=null,this._onclick=e.onclick,a.call(this,e)}var a=e("./control");ol.inherits(i,a);var o=i.prototype;o.overwriteOnClickEvent=function(e){this._originalonlick=this._originalonlick||this._onclick,this._onclick=e},o.resetOriginalOnClickEvent=function(){this._onclick=this._originalonlick||this._onclick,this._originalonlick=null},o.setMap=function(e){var t=this;a.prototype.setMap.call(this,e);var r=$(this.element),i=r.children("button"),o=!1;r.on("click",n(regeneratorRuntime.mark(function s(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=9;break}if(o=!0,i.addClass("g3w-ol-disabled"),e.t0=t._onclick,!e.t0){e.next=7;break}return e.next=7,t._onclick();case 7:i.removeClass("g3w-ol-disabled"),o=!1;case 9:case"end":return e.stop()}},s,t)})))},t.exports=i},{"./control":105}],115:[function(e,t,r){var n=e("../constants"),i=e("core/utils/ol"),a=i.merge,o=e("./interactioncontrol"),s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e,r=t.spatialMethod,i=void 0===r?n.SPATIALMETHODS[0]:r;this._startCoordinate=null,this.layers=e.layers||[];var s=this.checkVisible(this.layers);e.visible=s,e.enabled=s&&this.checkEnabled(this.layers),this.unwatches=[],this.listenLayersVisibleChange();var l={offline:!1,name:"querybbox",tipLabel:"sdk.mapcontrols.querybybbox.tooltip",label:e.label||"",clickmap:!0,interactionClass:ol.interaction.DragBox,onSelectlayer:function(e){var t=this.layers,r=e.isSelected();if(r){var n=t.find(function(t){return t===e}),i=!(!n||!n.isVisible());this.setEnable(i,!1)}else{var a=this.checkEnabled(t);this.setEnable(a)}},onhover:!0,toggledTool:{type:"spatialMethod",how:"toggled"},spatialMethod:i};e=a(e,l),o.call(this,e)};ol.inherits(s,o);var l=s.prototype;l.listenLayersVisibleChange=function(){var e=this;this.unwatches.forEach(function(e){return e()}),this.unwatches.splice(0),this.layers.forEach(function(t){var r=t.state;e.unwatches.push(n.VM.$watch(function(){return r.visible},function(t){if(r.selected&&!t)e.setEnable(!1);else{var n=e.checkEnabled(e.layers);n!==e.getEnable()&&e.setEnable(n,n&&e.isToggled())}}))})},l.change=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.layers=e;var t=this.checkVisible(e);this.setVisible(t);var r=this.checkEnabled(e);this.setEnable(r),this.listenLayersVisibleChange(this.layers)},l.checkVisible=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.length>0},l.checkEnabled=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.length>0&&e.reduce(function(e,t){return e||t.isVisible()},!1)},l.setMap=function(e){var t=this;o.prototype.setMap.call(this,e),this._interaction.on("boxstart",function(e){return t._startCoordinate=e.coordinate}),this._interaction.on("boxend",function(e){var r=t._startCoordinate,n=e.coordinate,i=ol.extent.boundingExtent([r,n]);t.dispatchEvent({type:"bboxend",extent:i}),t._startCoordinate=null,t._autountoggle&&t.toggle()})},t.exports=s},{"../constants":102,"./interactioncontrol":109,"core/utils/ol":90}],116:[function(e,t,r){var n=e("../constants"),i=e("core/utils/ol"),a=i.merge,o=e("./interactioncontrol"),s=e("../interactions/pickcoordinatesinteraction"),l=e("core/utils/geo").Geometry.getAllPolygonGeometryTypes,u=l(),c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e,r=t.spatialMethod,i=void 0===r?n.SPATIALMETHODS[0]:r;this.layers=e.layers||[],this.unwatches=[],this.listenPolygonLayersChange(),e.visible=this.checkVisibile(this.layers);var l={offline:!1,name:"querybypolygon",tipLabel:"sdk.mapcontrols.querybypolygon.tooltip",label:e.label||"",onSelectlayer:function(e){var t=e.isSelected(),r=e.getGeometryType(),n=e.isQueryable();t&&this.getGeometryTypes().indexOf(r)!==-1?this.setEnable(n?e.isVisible():n):this.setEnable(!1,!1)},clickmap:!0,interactionClass:s,spatialMethod:i,toggledTool:{type:"spatialMethod",how:"toggled"},onhover:!0};e=a(e,l),e.geometryTypes=u,o.call(this,e),this.setEnable(!1)};ol.inherits(c,o);var d=c.prototype;d.listenPolygonLayersChange=function(){var e=this;this.unwatches.forEach(function(e){return e()}),this.unwatches.splice(0);var t=this.layers.filter(function(e){return u.indexOf(e.getGeometryType())!==-1});t.forEach(function(t){var r=t.state;e.unwatches.push(n.VM.$watch(function(){return r.visible},function(t){e.setEnable(t&&r.selected)}))})},d.change=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.layers=e;var t=this.checkVisibile(e);this.setVisible(t),this.setEnable(!1),this.listenPolygonLayersChange()},d.checkVisibile=function(e){var t=void 0;if(e.length&&1!==e.length){var r=e.filter(function(e){return e.isFilterable()}),n=e.filter(function(e){return u.indexOf(e.getGeometryType())!==-1}),i=r.length,a=n.length;t=1===a&&1===i?r[0]!==n[0]:a>0&&i>0}else t=!1;return t},d.setMap=function(e){var t=this;o.prototype.setMap.call(this,e),this._interaction.on("picked",function(e){t.dispatchEvent({type:"picked",coordinates:e.coordinate}),t._autountoggle&&t.toggle()}),this.setEnable(!1)},t.exports=c},{"../constants":102,"../interactions/pickcoordinatesinteraction":129,"./interactioncontrol":109,"core/utils/geo":89,"core/utils/ol":90}],117:[function(e,t,r){var n=e("core/utils/ol"),i=e("./interactioncontrol"),a=e("../interactions/pickcoordinatesinteraction"),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={offline:!1,name:"querylayer",tipLabel:"sdk.mapcontrols.query.tooltip",label:e.label||"",clickmap:!0,interactionClass:a};e=n.merge(e,t),i.call(this,e)};ol.inherits(o,i);var s=o.prototype;s.setMap=function(e){var t=this,r=void 0,n=function(e){t.dispatchEvent({type:"picked",coordinates:e.coordinate}),t._autountoggle&&t.toggle(!0)};e?r=this.on("toggled",function(t){var r=t.target.isToggled();r&&e.on("singleclick",n)||e.un("singleclick",n)}):ol.Observable.unByKey(r),i.prototype.setMap.call(this,e)},t.exports=o},{"../interactions/pickcoordinatesinteraction":129,"./interactioncontrol":109,"core/utils/ol":90}],118:[function(e,t,r){var n=e("core/utils/ol"),i=e("./interactioncontrol"),a=function(e){this._toggled=!0,this._startCoordinate=null;var t={name:"reset",tipLabel:"Pan",label:""};e=n.merge(e,t),i.call(this,e)};ol.inherits(a,i),t.exports=a;var o=a.prototype;o._postRender=function(){this.toggle(!0)}},{"./interactioncontrol":109,"core/utils/ol":90}],119:[function(e,t,r){var n=e("core/i18n/i18n.service").t,i=e("core/utils/ol"),a=i.getResolutionFromScale,o=i.getScaleFromResolution,s=[1e6,5e6,25e4,1e5,5e4,25e3,1e4,5e3,2500,2e3,1e3],l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.isMobile=e.isMobile||!1,e.target="scale-control",ol.control.Control.call(this,e)};ol.inherits(l,ol.control.Control),t.exports=l;var u=l.prototype;u.offline=!0,u.changelayout=function(e){this.position,$(this.element)},u.layout=function(e){function t(){c.find("option").each(function(e,t){return i.scales.indexOf(1*t.value)===-1&&$(t).remove()})}function r(e){if(c.find("option[value='"+e.id+"']").length)c.val(e.id).trigger("change");else{t();var r=new Option(e.text,e.id,(!0),(!0));c.append(r).trigger("change")}}var i=this,s=!1,l=!1,u=$(this.element),c=u.children("select").select2({tags:!0,dropdownParent:$(e.getTargetElement()),width:"120px",height:"20px",language:{noResults:function(e){return n("sdk.mapcontrols.scale.no_valid_scale")}},minimumResultsForSearch:this.isMobile?-1:0,createTag:function(e){var r=null,n=void 0;return e.term.indexOf("1:")!==-1?n=e.term.split("1:")[1]:Number.isInteger(Number(e.term))&&Number(e.term)>0&&(n=Number(e.term),1*n<=i.scales[0]&&(r={id:n,text:"1:"+e.term,"new":!0},t())),r}});e.on("change:size",function(){return c.select2("close")}),e.on("moveend",function(){if(s){var e=this.getView(),t=e.getResolution(),n=e.getProjection().getUnits(),i=parseInt(o(t,n)),a={id:i,text:"1:"+i,"new":!0};r(a),s=!1}else l=!1});var d=function(){e.getView().on("change:resolution",function(){return s=!l})};d(),e.on("change:view",function(){return d()}),c.on("select2:select",function(n){l=!0;var i=n.params.data;i["new"]&&(t(),r(i));var o=e.getView().getProjection().getUnits(),s=1*i.id,u=a(s,o);e.getView().setResolution(u)})},u._setScales=function(e){var t=e.getView().getProjection().getUnits(),r=e.getView().getResolution(),n=parseInt(o(r,t));this.scales=s.filter(function(e){return e<n}),this.scales.unshift(n),this._createControl()},u._createControl=function(){var e=document.createElement("div"),t=document.createElement("select"),r=document.createElement("optgroup");if(r.label="",this.scales.forEach(function(e,t){var n=document.createElement("option");n.value=e,n.text="1:"+e,n.selected=0===t,r.appendChild(n)}),t.appendChild(r),!this.isMobile){var n=document.createElement("optgroup");n.label="Custom",t.appendChild(n)}e.appendChild(t),this.element=e,$(this.element).css("height","20px")},u.setMap=function(e){e&&(this._setScales(e),this.layout(e),ol.control.Control.prototype.setMap.call(this,e))}},{"core/i18n/i18n.service":27,"core/utils/ol":90}],120:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.layers=e.layers||[];var t=this.checkVisible(this.layers);e.visible=t,e.name=e.name||"maptoimage",e.tipLabel=e.tipLabel||"Screenshot",e.label=e.label||"",e.toggled=!1,i.call(this,e)}var i=e("./onclickcontrol");ol.inherits(n,i);var a=n.prototype;a.change=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.checkVisible(e);this.setVisible(t)},a.checkVisible=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.find(function(e){return!!e.isExternalWMS&&e.isExternalWMS()});return!t},t.exports=n},{"./onclickcontrol":114}],121:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("core/applicationstate"),a=n(i),o=e("core/utils/ol"),s=e("./interactioncontrol"),l=e("../interactions/pickcoordinatesinteraction"),u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={offline:!1,visible:!!a["default"].keys.vendorkeys.google,name:"streetview",tipLabel:"StreetView",clickmap:!0,label:"",interactionClass:l};this._sv=null,this._panorama=null,this._map=null,this._projection=null,this._lastposition=null,this._streetViewFeature=new ol.Feature;var r=new ol.source.Vector({features:[]});this._layer=new ol.layer.Vector({source:r,style:function(e){var t=e.getGeometry().getCoordinates();this._lastposition=this._lastposition?this._lastposition:t;var r=t[0]-this._lastposition[0],n=t[1]-this._lastposition[1],i=-Math.atan2(n,r),a=[new ol.style.Style({text:new ol.style.Text({text:"",font:"bold 18px icomoon",fill:new ol.style.Fill({color:"#ffffff"})})}),new ol.style.Style({image:new ol.style.Icon({src:"/static/client/images/streetviewarrow.png",rotation:i})})];return this._lastposition=t,a}}),e=o.merge(e,t),s.call(this,e)};ol.inherits(u,s);var c=u.prototype;c.getLayer=function(){return this._layer},c.setProjection=function(e){this._projection=e},c.setPosition=function(e){var t=this,r=void 0;this._sv||(this._sv=new google.maps.StreetViewService),this._sv.getPanorama({location:e},function(e){t._panorama=new google.maps.StreetViewPanorama(document.getElementById("streetview"),{imageDateControl:!0}),t._panorama.addListener("position_changed",function(){if(t.isToggled()){var e=ol.proj.transform([this.getPosition().lng(),this.getPosition().lat()],"EPSG:4326",t._projection.getCode());t._layer.getSource().getFeatures()[0].setGeometry(new ol.geom.Point(e)),r=t._map.getPixelFromCoordinate(e),(r[0]+15>t._map.getSize()[0]||r[1]+15>t._map.getSize()[1]||r[0]<15||r[1]<15)&&t._map.getView().setCenter(e)}}),e&&e.location&&(t._panorama.setPov({pitch:0,heading:0}),t._panorama.setPosition(e.location.latLng))})},c.setMap=function(e){var t=this;this._map=e,s.prototype.setMap.call(this,e),this._interaction.on("picked",function(e){t.dispatchEvent({type:"picked",coordinates:e.coordinate}),t._autountoggle&&t.toggle()})},c.clearMarker=function(){this._streetViewFeature.setGeometry(null)},c.clear=function(){this._layer.getSource().clear(),this._streetViewFeature.setGeometry(null),this.clearMarker(),this._panorama=null,this.dispatchEvent("disabled")},c.toggle=function(e){s.prototype.toggle.call(this,e),this.isToggled()?this._layer.getSource().addFeatures([this._streetViewFeature]):this.clear()},t.exports=u},{"../interactions/pickcoordinatesinteraction":129,"./interactioncontrol":109,"core/applicationstate":8,"core/utils/ol":90}],122:[function(e,t,r){var n=e("gui/gui"),i=35;t.exports={layout:function(e){e.map,e.position,e.element},changeLayoutBottomControl:function(e){var t=e.map,r=e.position,n=e.element,a=e.isMobile,o=void 0!==a&&a,s=t.getViewport(),l=(r.top?"t":"b")+(r.left?"l":"r"),u=$(s).find(".ol-control-"+l+":visible");if(u.length){var c=void 0;if(u.each(function(e,t){return t!=n[0]&&void(c=$(t))}),c&&"br"===l)if(o){var d=c.width(),p=d<10?130:d+20;n.css("right",p+"px"),n.css("bottom","15px")}else{var f=c.position().top,h=n.position().top;if(f-h!=i){var v=f-i;n.css("top",v+"px")}}}},createControlUserMessageTool:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{hooks:{body:{template:'<div>\n                <div >\n                  <input type="radio" name="radio" id="g3w-map_theme-0" class="magic-radio" value="view1">\n                  <label  for="g3w-map_theme-0" style="display: flex; justify-content: space-between;">\n                    <span>Intersect</span>\n                  </label>\n                </div>\n                <div>\n                  <input  type="radio" name="radio" id="_cotains" class="magic-radio" value="view2">\n                  <label  for="g3w-map_theme-1" style="display: flex; justify-content: space-between;">\n                    <span>view2</span>\n                  </label>\n                </div>\n              </div>'}},title:"Scelgli il tipo di operazione"};n.showUserMessage({type:"tool",message:e.message,size:e.size||"small",title:e.title||"",hooks:e.hooks})}}},{"gui/gui":150}],123:[function(e,t,r){var n=e("./interactioncontrol"),i=function(e){this._startCoordinate=null;var t={name:"zoombox",tipLabel:"Zoom to box",label:"",interactionClass:ol.interaction.DragBox};e=Object.assign({},e,t),n.call(this,e)};ol.inherits(i,n),t.exports=i;var a=i.prototype;a.setMap=function(e){var t=this;n.prototype.setMap.call(this,e),this._interaction.on("boxstart",function(e){return t._startCoordinate=e.coordinate}),this._interaction.on("boxend",function(e){var r=t._startCoordinate,n=e.coordinate,i=ol.extent.boundingExtent([r,n]);t.dispatchEvent({type:"zoomend",extent:i}),t._startCoordinate=null,t._autountoggle&&t.toggle()})}},{"./interactioncontrol":109}],124:[function(e,t,r){var n=e("core/utils/ol"),i=e("./map/maphelpers"),a=n.merge({},i);t.exports={helpers:a}},{"./map/maphelpers":133,"core/utils/ol":90}],125:[function(e,t,r){var n=e("./measureinteraction"),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.geometryType="Polygon",n.call(this,e)};ol.inherits(i,n),t.exports=i},{"./measureinteraction":128}],126:[function(e,t,r){var n=function(e,t,r,n){this.type=e,this.features=r,this.coordinate=n},i=function a(e){ol.interaction.Pointer.call(this,{handleDownEvent:a.handleDownEvent_,handleMoveEvent:a.handleMoveEvent_,handleUpEvent:a.handleUpEvent_,handleEvent:a.handleEvent_}),this.previousCursor_=void 0,this.startCursor_=void 0,this.lastCoordinate_=null,this.features_=void 0!==e.features?e.features:null,this.layer_=void 0!==e.layer?e.layer:null,this.map_=null};ol.inherits(i,ol.interaction.Pointer),i.handleEvent_=function(e){return"keydown"!=e.type?ol.interaction.Pointer.handleEvent.call(this,e):this.features_.getArray().length&&46==e.originalEvent.keyCode?(this.dispatchEvent(new n("deleteend",this.layer_,this.features_,event.coordinate)),!0):void 0},i.handleDownEvent_=function(e){return this.lastFeature_=this.featuresAtPixel_(e.pixel,e.map),!!this.lastFeature_&&(i.handleMoveEvent_.call(this,e),this.dispatchEvent(new n("deleteend",this.layer_,this.features_,e.coordinate)),!0)},i.handleMoveEvent_=function(e){var t=this;this.map_=e.map;var r=this.map_.getTargetElement();void 0===this.startCursor_&&(this.startCursor_=r.style.cursor);var n=this.map_.forEachFeatureAtPixel(e.pixel,function(e,r){return e=r==t.layer_?e:null});n?(this.previousCursor_=r.style.cursor,r.style.cursor="pointer"):(r.style.cursor=void 0!==this.previousCursor_?this.previousCursor_:"",this.previousCursor_=void 0)},i.prototype.featuresAtPixel_=function(e,t){var r=null,n=t.forEachFeatureAtPixel(e,function(e){return e});return this.features_&&_.includes(this.features_.getArray(),n)&&(r=n),r},i.prototype.clear=function(){var e=void 0;this.map_&&(e=this.map_.getTargetElement(),e.style.cursor=this.startCursor_)},t.exports=i},{}],127:[function(e,t,r){var n=e("./measureinteraction"),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.geometryType="LineString",n.call(this,e)};ol.inherits(i,n),t.exports=i},{"./measureinteraction":128}],128:[function(e,t,r){var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=e("core/i18n/i18n.service"),a=i.t,o=e("core/utils/ol"),s=o.createMeasureTooltip,l=o.setMeasureTooltipStatic,u=o.removeMeasureTooltip,c=o.needUseSphereMethods,d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._helpTooltip,this._measureTooltipElement,this._measureTooltip,this._featureGeometryChangelistener,this._poinOnMapMoveListener,this.testTooltip,this._helpMsg=e.help,this._projection=e.projection,this.feature=e.feature;var t=e.drawColor||"rgba(0, 0, 0, 0.5)",r=(c(this._projection),new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ol.style.Stroke({color:t,lineDash:[10,10],width:3}),image:new ol.style.Circle({radius:5,stroke:new ol.style.Stroke({color:"rgba(0, 0, 0, 0.7)"}),fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"})})})),n=e.geometryType||"LineString",i=new ol.source.Vector;this._helpTooltipElement,this._map=null,this._feature=null,this._layer=new ol.layer.Vector({source:i,style:function(){var e=[new ol.style.Style({stroke:new ol.style.Stroke({lineDash:[10,10],width:3}),fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"})})];return e}}),ol.interaction.Draw.call(this,{source:i,type:n,style:r}),this.set("beforeRemove",this.clear),this.set("layer",this._layer),this.on("drawstart",this._drawStart),this.on("drawend",this._drawEnd)};ol.inherits(d,ol.interaction.Draw);var p=d.prototype;p.setDrawMessage=function(e){this._helpMsg=e},p.clear=function(){this._layer.getSource().clear(),this._clearMessagesAndListeners(),this._map&&(u(n({map:this._map},this.measureTooltip)),this.measureTooltip=null,this._map.removeLayer(this._layer))},p._clearMessagesAndListeners=function(){this._feature=null,this._map&&(this._measureTooltipElement=null,this._helpTooltipElement.innerHTML="",this._helpTooltipElement.classList.add("hidden"),ol.Observable.unByKey(this._featureGeometryChangelistener),ol.Observable.unByKey(this._poinOnMapMoveListener),$(document).off("keydown",this._keyDownEventHandler))},p._removeLastPoint=function(e){var t=this._feature.getGeometry();46===e.keyCode&&(t instanceof ol.geom.Polygon&&t.getCoordinates()[0].length>2?this.removeLastPoint():t instanceof ol.geom.LineString&&t.getCoordinates().length>1&&this.removeLastPoint())},p._drawStart=function(e){var t=this;this._map=this.getMap(),this._map.removeLayer(this._layer),this._feature=e.feature,this.feature&&this._feature.setGeometry(this.feature.getGeometry()),this._keyDownEventHandler=this._removeLastPoint.bind(this),$(document).on("keydown",this._keyDownEventHandler),this._layer.getSource().clear(),this._poinOnMapMoveListener=this._map.on("pointermove",function(e){if(!e.dragging&&t._feature&&t._helpMsg){var r=a(t._helpMsg);t._helpTooltipElement.innerHTML=r,t._helpTooltip.setPosition(e.coordinate),t._helpTooltipElement.classList.remove("hidden")}}),this._createHelpTooltip(),this._createMeasureTooltip()},p._drawEnd=function(){var e=this.measureTooltip.tooltip;l(e),this._clearMessagesAndListeners(),this._map.addLayer(this._layer)},p._createHelpTooltip=function(){this._helpTooltipElement&&this._helpTooltipElement.parentNode.removeChild(this._helpTooltipElement),this._helpTooltip&&this._map.removeOverlay(this._helpTooltip),this._helpTooltipElement=document.createElement("div"),this._helpTooltipElement.className="mtooltip hidden",this._helpTooltip=new ol.Overlay({element:this._helpTooltipElement,offset:[15,0],positioning:"center-left"}),this._map.addOverlay(this._helpTooltip)},p._createMeasureTooltip=function(){this.measureTooltip&&u(n({},this.measureTooltip,{map:this._map})),this.measureTooltip=s({map:this._map,feature:this._feature})},t.exports=d},{"core/i18n/i18n.service":27,"core/utils/ol":90}],129:[function(e,t,r){var n={PICKED:"picked"},i=function(e,t){this.type=e,this.coordinate=t},a=function o(e){this.previousCursor_=null,this._centerMap=null,ol.interaction.Pointer.call(this,{handleDownEvent:o.handleDownEvent_,handleUpEvent:o.handleUpEvent_,handleMoveEvent:o.handleMoveEvent_})};ol.inherits(a,ol.interaction.Pointer),a.handleDownEvent_=function(e){var t=this;return this._centerMap=e.map.getView().getCenter(),setTimeout(function(){t._centerMap===e.map.getView().getCenter()&&a.handleUpEvent_.call(t,e)},300),!1},a.handleUpEvent_=function(e){return this.dispatchEvent(new i(n.PICKED,e.coordinate)),!1},a.handleMoveEvent_=function(e){var t=e.map.getTargetElement();return t.style.cursor="pointer",!0},a.prototype.shouldStopEvent=function(){return!1},a.prototype.setActive=function(e){var t=this.getMap();if(t){var r=t.getTargetElement();r.style.cursor=""}ol.interaction.Pointer.prototype.setActive.call(this,e)},a.prototype.setMap=function(e){if(!e){var t=this.getMap().getTargetElement();t.style.cursor=""}ol.interaction.Pointer.prototype.setMap.call(this,e)},t.exports=a},{}],130:[function(e,t,r){var n={PICKED:"picked"},i=function(e,t,r,n){this.type=e,this.feature=n,this.coordinate=t,this.layer=r},a=function o(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ol.interaction.Pointer.call(this,{handleDownEvent:o.handleDownEvent_,handleUpEvent:o.handleUpEvent_,handleMoveEvent:o.handleMoveEvent_});var r=t.features;this.features_=Array.isArray(r)&&r.length&&r||null,this.layers_=t.layers||null,this.pickedFeature_=null,this.pickedLayer_=null,this.layerFilter_=function(t){var r=_.includes(e.layers_,t);return e.pickedLayer_=r&&t,r}};ol.inherits(a,ol.interaction.Pointer),a.handleDownEvent_=function(e){return this.pickedFeature_=this.featuresAtPixel_(e.pixel,e.map),this.pickedFeature_},a.handleUpEvent_=function(e){return this.pickedFeature_&&this.dispatchEvent(new i(n.PICKED,e.coordinate,this.pickedLayer_,this.pickedFeature_)),!0},a.handleMoveEvent_=function(e){var t=e.map.getTargetElement(),r=this.featuresAtPixel_(e.pixel,e.map);t.style.cursor=r?"pointer":""},a.prototype.featuresAtPixel_=function(e,t){var r=this,n=null,i=t.forEachFeatureAtPixel(e,function(e){return r.features_?r.features_.indexOf(e)>-1?e:null:e},{layerFilter:this.layerFilter_,hitTolerance:isMobile&&isMobile.any?10:0});return i&&(n=i),n},a.prototype.shouldStopEvent=function(){return!1},a.prototype.setMap=function(e){if(!e){var t=this.getMap().getTargetElement();t.style.cursor=""}ol.interaction.Pointer.prototype.setMap.call(this,e)},t.exports=a},{}],131:[function(e,t,r){var n=e("./rasters"),i={};i.OSM={},i.OSM.get=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.title,r=e.id,n=e.url;return new ol.layer.Tile({source:new ol.source.OSM({url:n}),id:r||"osm",title:t||"OSM",basemap:!0})},i.TMS={get:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.visible,r=void 0!==t&&t,i=e.url,a=void 0===i?null:i,o=e.source_type,s=void 0===o?"xyz":o,l=e.minZoom,u=e.maxZoom,c=e.projection,d=e.attributions,p=void 0;switch(s){case"xyz":p=n.XYZLayer({url:a,visible:r,minZoom:l,maxZoom:u,attributions:d,projection:c});break;case"arcgismapserver":p=TiledArgisMapServer({url:a,visible:r,projection:c,attributions:d})}return p}},i.WMS={get:function(e){var t=e.url,r=e.projection,i=e.attributions,a=e.layers,o=e.singleTile,s=void 0!==o&&o,l=e.opacity,u=void 0===l?1:l;return n.WMSLayer({url:t,projection:r,attributions:i,layers:a,tiled:s,opacity:u})}},i.WMTS={get:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.layer,n=(e.visible,e.attributions),i=e.matrixSet,a=e.projection,o=e.requestEncoding,s=e.style,l=void 0===s?"default":s,u=e.format,c=void 0===u?"image/png":u,d=e.opacity,p=void 0===d?.7:d,f=a.getExtent(),h=new Array(14),v=ol.extent.getWidth(f)/256,g=new Array(14),m=0;m<14;++m)h[m]=v/Math.pow(2,m),g[m]=m;return new ol.layer.Tile({opacity:p,source:new ol.source.WMTS({url:t,projection:a,layer:r,matrixSet:i,requestEncoding:o,format:c,attributions:n,tileGrid:new ol.tilegrid.WMTS({origin:ol.extent.getTopLeft(f),resolutions:h,matrixIds:g}),style:l})})}},i.BING={},i.BING.get=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.imagerySet||"Aerial";return new ol.layer.Tile({name:t,visible:!1,preload:1/0,source:new ol.source.BingMaps({imagerySet:t,key:e.key}),basemap:!0})},t.exports=i},{"./rasters":132}],132:[function(e,t,r){var n=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i={},a=e("core/utils/ol").getDPI(),o=function(e){var t=e.method,r=void 0===t?"GET":t,i=e.type,a=void 0===i?"image":i,o=e.sourceOptions,s=void 0===o?{}:o;window.URL=window.URL||window.webkitURL,s[a+"LoadFunction"]=function(e,t){var i=new XMLHttpRequest,a=t.split("?"),o=n(a,2),s=o[0],l=o[1];i.open(r,"POST"===r&&s||t),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),i.responseType="blob",i.onload=function(){var t=this.response;void 0!==t?e.getImage().src=window.URL.createObjectURL(t):e.setState(ol.TileState.ERROR)},i.onerror=function(){image.setState(ol.TileState.ERROR)},i.send("POST"===r&&l)}};i.TiledWMSLayer=function(e,t){var r={layerObj:e,extraParams:t||{},tiled:!0};return i._WMSLayer(r)},i.WMSLayer=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET",n={layerObj:e,extraParams:t,method:r};return i._WMSLayer(n)},i.WMTSLayer=function(e,t){ol.source.WMTS.optionsFromCapabilities;return new ol.layer.Tile({opacity:1,source:new ol.source.WMTS(options)})},i.ImageArgisMapServer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new ol.layer.Image({source:new ol.source.ImageArcGISRest({ratio:e.ratio,params:{FORMAT:e.format},url:e.url})})},i.TiledArgisMapServer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.visible,n=void 0===r||r,i=e.extent,a=e.projection,o=e.attributions,s=new ol.source.TileArcGISRest({url:t,projection:a,attributions:o});return new ol.layer.Tile({extent:i,visible:n,source:s})},i._WMSLayer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layerObj,r=e.method,n=void 0===r?"GET":r,i=e.extraParams,s=e.tiled,l=void 0!==s&&s,u=t.iframe_internal,c=void 0!==u&&u,d=t.layers,p=void 0===d?"":d,f=t.version,h=void 0===f?"1.3.0":f,v=t.sld_version,g=void 0===v?"1.1.0":v,m=t.id,y=t.name,_=t.opacity,b=void 0===_?1:_,w=t.visible,x=t.extent,S=t.maxResolution,C=t.projection?t.projection.getCode():null,L={LAYERS:p,VERSION:h,TRANSPARENT:!0,SLD_VERSION:g,DPI:a};L=Object.assign({},L,i);var k={url:t.url,params:L,ratio:1,projection:C};(c||"POST"===n)&&o({method:n,type:"image",sourceOptions:k});var M={id:m,name:y,opacity:b,visible:w,extent:x,maxResolution:S},T=void 0,E=void 0;l?(E=new ol.source.TileWMS(k),T=ol.layer.Tile):(E=new ol.source.ImageWMS(k),T=ol.layer.Image),M.source=E;var I=new T(M);return I},i.XYZLayer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",r=e.iframe_internal||!1,n=e.url,i=e.projection,a=e.maxZoom,s=e.minZoom,l=e.visible,u=void 0===l||l;if(n){var c={url:n,maxZoom:a,minZoom:s,projection:i};if(r&&o({method:t,type:"tile",sourceOptions:c}),"degrees"===i.getUnits()){var d=i.getExtent(),p=ol.tilegrid.createXYZ({extent:d,maxZoom:a}).getResolutions();p.splice(0,1),c.tileGrid=new ol.tilegrid.TileGrid({extent:d,resolutions:p})}var f=new ol.source.XYZ(c);return new ol.layer.Tile({visible:u,projection:i,source:f})}},t.exports=i},{"core/utils/ol":90}],133:[function(e,t,r){var n=e("../layers/bases"),i=e("../projection/projections"),a={createViewer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new o(e)}},o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=ol.control.defaults({attribution:!1,zoom:!1}),r=ol.interaction.defaults().extend([new ol.interaction.DragRotate]);r.removeAt(1);var n=e.view instanceof ol.View?e.view:new ol.View(e.view),a={controls:t,interactions:r,ol3Logo:!1,view:n,keyboardEventTarget:document};e.id&&(a.target=e.id),i.setApplicationProjections();var o=new ol.Map(a);this.map=o};o.prototype.destroy=function(){this.map&&(this.map.dispose(),this.map=null)},o.prototype.getView=function(){return this.map.getView()},o.prototype.updateMap=function(e){},o.prototype.updateView=function(){},o.prototype.getMap=function(){return this.map},o.prototype.setTarget=function(e){this.map.setTarget(e)},o.prototype.zoomTo=function(e,t){var r=this.map.getView();r.setCenter(e),r.setZoom(t)},o.prototype.goTo=function(e,t){t=t||{};var r=t.animate||!0,n=t.zoom||!1,i=this.map.getView(),a=void 0,o=300,s=void 0;r?(a={duration:o,center:e},s=n?{duration:o,zoom:n}:{duration:o,resolution:i.getResolution()},i.animate(a,s)):(i.setCenter(e),n&&i.setZoom(n))},o.prototype.goToRes=function(e,t){t=t||{};var r=t.animate||!0,n=this.map.getView(),i=t.resolution||n.getResolution(),a=void 0,o=void 0;r?(a={duration:200,center:e},o={duration:200,resolution:i},n.animate(a,o)):(n.setCenter(e),n.setResolution(i))},o.prototype.fit=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.map.getView(),n=t.animate||!0,i=void 0,a=void 0,o=200;n&&(i=r.animate({duration:o,center:r.getCenter()}),a=r.animate({duration:o,resolution:r.getResolution()})),t.animate&&delete t.animate,t.constrainResolution=void 0===t.constrainResolution&&!0||t.constrainResolution,t.size=this.map.getSize(),r.fit(e,t)},o.prototype.getZoom=function(){var e=this.map.getView();return e.getZoom()},o.prototype.getResolution=function(){var e=this.map.getView();return e.getResolution()},o.prototype.getCenter=function(){var e=this.map.getView();return e.getCenter()},o.prototype.getBBOX=function(){return this.map.getView().calculateExtent(this.map.getSize())},o.prototype.getLayerByName=function(e){for(var t=this.map.getLayers(),r=t.getLength(),n=0;n<r;n++)if(e===t.item(n).get("name"))return t.item(n);
return null},o.prototype.removeLayerByName=function(e){var t=this.getLayerByName(e);t&&(this.map.removeLayer(t),t=void 0)},o.prototype.getActiveLayers=function(){var e=[];return this.map.getLayers().forEach(function(t){var r=t.getProperties();r.basemap!==!0&&r.visible&&e.push(t)}),e},o.prototype.removeLayers=function(){this.map.getLayers().clear()},o.prototype.getLayersNoBase=function(){var e=[];return this.map.getLayers().forEach(function(t){var r=t.getProperties();1!=r.basemap&&e.push(t)}),e},o.prototype.addBaseLayer=function(e){var t=void 0;t=e?n[e]:n.BING.Aerial,this.map.addLayer(t)},o.prototype.changeBaseLayer=function(e){var t=this.getLayerByName(layername),r=this.map.getLayers();r.insertAt(0,t)},t.exports=a},{"../layers/bases":131,"../projection/projections":135}],134:[function(e,t,r){var n=[0,0,8388608,8388608],i=ol.proj.get("EPSG:3857").getExtent(),a=[-180,-90,180,90],o={"EPSG:3876":[18835101.07,4367049.45,22702879.51,9383109.87],"EPSG:32733":i},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e.crs)return null;var t=e.crs,r=t.epsg,i=t.proj4,s=t.geographic,l=void 0!==s&&s,u=t.axisinverted,c=void 0!==u&&u;i&&proj4.defs(r,i),this._axisOrientation=c?"neu":"enu";var d=l;ol.proj.Projection.call(this,{code:r,extent:e.extent?e.extent:d?a:o[r]||n,axisOrientation:this._axisOrientation,units:d?"degrees":"m"})};ol.inherits(s,ol.proj.Projection);var l=s.prototype;l.getAxisOrientation=function(){return this._axisOrientation},l.isInvertedAxisOrientation=function(){return"neu"===this._axisOrientation},l.getOlProjection=function(){},t.exports=s},{}],135:[function(e,t,r){var n=e("./projection"),i=["EPSG:4326","EPSG:3857"],a={get:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],r=i.indexOf(e.epsg)!==-1?ol.proj.get(e.epsg):null;if(r)return r;var a=new n({crs:e,extent:t});return ol.proj.addProjection(a),i.push(e.epsg),a},setApplicationProjections:function(){this.get({epsg:"EPSG:3003",proj4:"+proj=tmerc +lat_0=0 +lon_0=9 +k=0.9996 +x_0=1500000 +y_0=0 +ellps=intl +towgs84=-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68 +units=m +no_defs",axisinverted:!1,geographic:!1}),this.get({epsg:"EPSG:3004",proj4:"+proj=tmerc +lat_0=0 +lon_0=15 +k=0.9996 +x_0=2520000 +y_0=0 +ellps=intl +towgs84=-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68 +units=m +no_defs",axisinverted:!1,geographic:!1}),this.get({epsg:"EPSG:3045",proj4:"+proj=utm +zone=33 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",axisinverted:!0,geographic:!1}),this.get({epsg:"EPSG:6708",proj4:"+proj=utm +zone=33 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",axisinverted:!0,geographic:!1}),this.get({epsg:"EPSG:32632",proj4:"+proj=utm +zone=32 +datum=WGS84 +units=m +no_defs",axisinverted:!1,geographic:!1}),this.get({epsg:"EPSG:32633",proj4:"+proj=utm +zone=33 +ellps=WGS84 +datum=WGS84 +units=m +no_defs",axisinverted:!1,geographic:!1}),this.get({epsg:"EPSG:32634",proj4:"+proj=utm +zone=34 +datum=WGS84 +units=m +no_defs",axisinverted:!1,geographic:!1}),this.get({epsg:"EPSG:25833",proj4:"+proj=utm +zone=33 +ellps=GRS80 +units=m +no_defs",axisinverted:!1,geographic:!1}),this.get({epsg:"EPSG:23032",proj4:"+proj=utm +zone=32 +ellps=intl +units=m +no_defs",axisinverted:!1,geographic:!1}),this.get({epsg:"EPSG:23033",proj4:"+proj=utm +zone=33 +ellps=intl +units=m +no_defs",axisinverted:!1,geographic:!1}),ol.proj.proj4.register(proj4)}};t.exports=a},{"./projection":134}],136:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function i(){var e=this;this.state={prstate:c.state,highlightlayers:!1,external:{wms:[],vector:[]},layerstrees:[],layersgroups:[]},this.setters={},o(this);var t=d.getLayersStores();t.forEach(function(t){return e.addLayersStoreToLayersTrees(t)}),d.onafter("addLayersStore",function(t){e.addLayersStoreToLayersTrees(t)}),d.onafter("removeLayersStore",function(t){e.state.layerstrees.find(function(r,n){if(r.storeid===t.getId())return e.state.layerstrees.splice(n,1),!0})}),d.onafter("removeLayersStores",function(){e.state.layerstrees.forEach(function(t,r){e.state.layerstrees.splice(r,1)})})}var a=e("core/utils/utils"),o=a.base,s=a.inherit,l=e("core/applicationservice"),u=e("core/g3wobject"),c=e("core/project/projectsregistry"),d=e("core/catalog/cataloglayersstoresregistry");s(i,u);var p=i.prototype;p.createLayersGroup=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.title,r=void 0===t?"Layers Group":t,n=e.layers,i=void 0===n?[]:n,a=[];return i.forEach(function(e){return a.push(e)}),{title:r,nodes:a}},p.getMajorQgisVersion=function(){return c.getCurrentProject().getQgisVersion({type:"major"})},p.addLayersGroup=function(e){this.state.layersgroups.push(e)},p.addExternalLayer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,r=e.type,n=void 0===r?"vector":r;t.removable=!0,this.state.external[n].push(t)},p.removeExternalLayer=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.name,n=t.type,i=void 0===n?"vector":n;this.state.external[i].find(function(t,n){if(t.name===r)return e.state.external[i].splice(n,1),!0})},p.addLayersStoreToLayersTrees=function(e){this.state.layerstrees.push({tree:e.getLayersTree(),storeid:e.getId()})},p.changeMapTheme=function(){var e=n(regeneratorRuntime.mark(function t(e){var r,n,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return l.changeProjectView(!0),r=this.state.prstate.currentProject,n=this.state.layerstrees[0],n.checked=!0,i=n.tree[0].nodes,t.next=7,r.setLayersTreePropertiesFromMapTheme({map_theme:e,layerstree:i,rootNode:n});case 7:return a=t.sent,l.changeProjectView(!1),t.abrupt("return",a);case 10:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),t.exports=i},{"core/applicationservice":7,"core/catalog/cataloglayersstoresregistry":9,"core/g3wobject":26,"core/project/projectsregistry":83,"core/utils/utils":92}],137:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function i(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.resizable=!0,m(this,t);var r=t.config.legend;this.title="catalog",this.mapComponentId=t.mapcomponentid;var n=t.service||new w;this.setService(n),this.setInternalComponent(new x({service:n,legend:r})),this.internalComponent.state=this.getService().state;var i=function(t){var r=t.getService();e.state.visible=!r.state.hidden,r.onafter("setHidden",function(t){e.state.visible=!r.state.hidden,e.state.expanded=!0})};if(this.mapComponentId){var a=b.getComponent(this.mapComponentId);!a&&_.on("componentregistered",function(t){return t.getId()===e.mapComponentId&&i(t)})||i(a)}}var a=e("components/Catalog.vue"),o=n(a),s=e("components/CatalogLayersGroup.vue"),l=n(s),u=e("components/CatalogTristateTree.vue"),c=n(u),d=e("components/CatalogLayersLegend.vue"),p=n(d),f=e("components/CatalogLayersLegendItems.vue"),h=n(f),v=e("core/utils/utils"),g=v.inherit,m=v.base,y=e("gui/component/component"),_=e("gui/component/componentsregistry"),b=e("gui/gui"),w=e("../catalogservice"),x=Vue.extend(o);Vue.component("g3w-catalog",o),Vue.component("layers-group",l),Vue.component("tristate-tree",c),Vue.component("layerslegend",p),Vue.component("layerslegend-items",h),g(i,y),t.exports=i},{"../catalogservice":136,"components/Catalog.vue":235,"components/CatalogLayersGroup.vue":239,"components/CatalogLayersLegend.vue":240,"components/CatalogLayersLegendItems.vue":241,"components/CatalogTristateTree.vue":242,"core/utils/utils":92,"gui/component/component":140,"gui/component/componentsregistry":142,"gui/gui":150}],138:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=new Vue;r["default"]=n},{}],139:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=e("components/C3XYLine.vue"),o=n(a),s={CHARTS:{c3:{lineXY:o["default"]}},build:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=e.hooks,n=void 0===r?{}:r,a=t.split(":"),o=i(a,2),s=o[0],l=void 0===s?"c3":s,u=o[1],c=void 0===u?"lineXY":u,d=this.CHARTS[l][c];return Object.assign(n,d)}};t.exports=s},{"components/C3XYLine.vue":234}],140:[function(e,t,r){var n=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=e("core/utils/utils"),a=i.base,o=i.inherit,s=i.merge,l=i.noop,u=i.capitalize_first_letter,c=i.resolve,d=e("core/g3wobject"),p=["methods","computed","data","components"],f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._firstLayout=!0,this.internalComponent=null,this._components=[];var t=e.id,r=void 0===t?1e3*Math.random():t,n=e.title,i=void 0===n?"":n,o=e.visible,l=void 0===o||o,u=e.open,c=void 0!==u&&u,d=e.resizable,p=void 0!==d&&d,f=e.info,h=void 0===f?null:f,v=e.loading,g=void 0!==v&&v,m=e.disabled,y=void 0!==m&&m,_=e.closewhenshowviewportcontent,b=void 0===_||_;this.id=r,this.title=i,this.state={visible:l,open:c,resizable:p,info:h,loading:g,disabled:y,closewhenshowviewportcontent:b,sizes:{width:0,height:0}},this.setters={setOpen:function(e){this.state.open=e,this._setOpen(e)},setVisible:function(e){this.state.visible=e,this._setVisible(e)},setLoading:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state.loading=e},setDisabled:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state.disabled=e},reload:function(){this._reload()}},s(this,e),a(this),this.events=e.events,this.events&&this.handleEventsComponent()};o(f,d);var h=f.prototype;h.init=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.vueComponent=this.createVueComponent(e.vueComponentObject),this._components=e.components||[];var t=e.service||l,r=e.template,n=e.propsData;this.setService(t),this._service.init?this._service.init(e):null,r&&this.setInternalComponentTemplate(r),this.setInternalComponent=function(){var e=Vue.extend(this.vueComponent);this.internalComponent=new e({service:this._service,template:r,propsData:n}),this.internalComponent.state=this.getService().state},this.setInternalComponent()},h.getId=function(){return this.id},h.setId=function(e){this.id=e},h.getOpen=function(){return this.state.open},h.closeWhenViewportContentIsOpen=function(){return this.getOpen()&&this.state.closewhenshowviewportcontent},h.getVisible=function(){return this.state.visible},h.getTitle=function(){return this.state.title},h.setTitle=function(e){this.state.title=e},h.getService=function(){return this._service},h.setService=function(e){this._service=e},h.handleEventsComponent=function(){var e=this.events,t=e.open;e.visible;if(t){var r=t.when,n=void 0===r?"after":r,i=t.cb,a=void 0===i?function(){}:i;t.guiEvents;this["on"+n]("setOpen",function(e){return a(e)})}},h.insertComponentAt=function(e,t){this._components.splice(e,0,t)},h.removeCompomentAt=function(e){this._components.splice(e,1)},h.addComponent=function(e){this._components.push(e)},h.popComponent=function(){return this._components.pop()},h.removeComponent=function(e){var t=this;this._components.forEach(function(r,n){if(r===e)return t.splice(n,1),!1})},h.setComponents=function(e){this._components=Array.isArray(e)?e:[]},h.exendComponents=function(e){_.merge(this._components,e)},h.getInternalComponent=function(){return this.internalComponent},h.setInternalComponent=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!e&&this.internalComponentClass?this.internalComponent=new this.internalComponentClass:this.internalComponent=e;var n=r.events,i=void 0===n?[]:n;i.forEach(function(e){var r=e.name,n=e.handler;t.internalComponent.$on(r,function(e){return n&&n(e)||t["set"+u(r)](e)})})},h.createVueComponent=function(e){return _.cloneDeep(e)},h.addInternalComponentData=function(e){_.merge(this.internalComponent,e)},h.overwriteServiceMethod=function(e,t){this._service[e]=t},h.overwriteServiceMethods=function(e){var t=this;Object.entries(e).forEach(function(e){var r=n(e,2),i=r[0],a=r[1];return t.overwriteServiceMethod(i,a)})},h.extendService=function(e){this._service&&s(this._service,e)},h.extendInternalComponent=function(e){var t=this;this.vueComponent?Object.entries(e).forEach(function(e){var r=n(e,2),i=r[0],a=r[1];if(p.indexOf(i)>-1)switch(i){case"methods":t.extendInternalComponentMethods(a);break;case"components":t.extendInternalComponentComponents(a);break;default:s(t.vueComponent[i],a)}}):this.vueComponent=e},h.extendInternalComponentComponents=function(e){e&&s(this.vueComponent.components,e)},h.extendComponents=function(e){this.extendInternalComponentComponents(e)},h.addComponent=function(e){e&&(this.vueComponent.components[e.key]=e.value)},h.extendInternalComponentMethods=function(e){e&&(Object.entries(e).forEach.forEach(function(t){var r=n(t,2),i=r[0],a=r[1];return!(a instanceof Function)&&delete e[i]}),s(this.vueComponent.methods,e))},h.extendInternalComponentComputed=function(e){e&&(Object.entries(e).forEach(function(t){var r=n(t,2),i=r[0],a=r[1];return!(a instanceof Function)&&delete e[i]}),s(this.vueComponent.computed,e))},h.setInternalComponentTemplate=function(e){e&&(this.vueComponent.template=e)},h.getInternalTemplate=function(){return this.vueComponent.template},h.destroy=function(){},h.click=function(){},h.show=function(){},h._setOpen=function(e){},h._setVisible=function(){},h._reload=function(){},h.mount=function(e,t){var r=this,n=$.Deferred();if(this.internalComponent||this.setInternalComponent(),t){var i=this.internalComponent.$mount();$(e).append(i.$el)}else this.internalComponent.$mount(e);return this.internalComponent.$nextTick(function(){$(e).localize(),r.emit("ready"),n.resolve(!0)}),this.emit("mount"),n.promise()},h.unmount=function(){return this.internalComponent?(this.state.resizable&&this.internalComponent.$off("resize-component",this.internalComponent.layout),this.state.open=!1,this.internalComponent.$destroy(!0),$(this.internalComponent.$el).remove(),this.internalComponent=null,this.emit("unmount"),c()):c()},h.ismount=function(){return this.internalComponent&&this.internalComponent.$el},h.layout=function(e,t){var r=this;this.state.resizable&&this._firstLayout&&(this.internalComponent.$on("resize-component",this.internalComponent.layout),this._firstLayout=!1),this.internalComponent.$nextTick(function(){r.internalComponent.$emit("resize-component",{width:e,height:t})}),this.emit("layout")},t.exports=f},{"core/g3wobject":26,"core/utils/utils":92}],141:[function(e,t,r){var n=e("gui/gui"),i=e("./component"),a={build:function(e){var t=e.vueComponentObject,r=e.service,n=e.propsData,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=new i(a);return o.init({vueComponentObject:t,service:r,propsData:n}),o},buildSidebar:function(e){var t=e.vueComponentObject,r=(e.service,e.propsData,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),i=r.id,a=r.title,o=r.open,s=void 0!==o&&o,l=r.collapsible,u=void 0===l||l,c=r.isolate,d=void 0!==c&&c,p=r.mobile,f=void 0===p||p,h=r.iconConfig,v=void 0===h?{}:h,g=r.events,m=void 0===g?{}:g,y=r.sidebarOptions,_=void 0===y?{position:1}:y,b=this.build({vueComponentObject:t},{id:i,title:a,open:s,collapsible:u,isolate:d,iconColor:v.color&&v.color,icon:v.icon&&n.getFontClass(v.icon),mobile:f,events:m});return n.addComponent(b,"sidebar",_),b}};t.exports=a},{"./component":140,"gui/gui":150}],142:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("store/components"),a=n(i);t.exports=a["default"]},{"store/components":403}],143:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.viewport=void 0;var n=e("app/constant");r.viewport=n.VIEWPORT,r["default"]={viewport:n.VIEWPORT}},{"app/constant":5}],144:[function(e,t,r){var n=e("core/i18n/i18n.service"),i=n.t;t.exports={matcher:function(e,t){var r=e.term?e.term.toLowerCase():e.term;if(""===$.trim(r))return t;if("undefined"==typeof t.text)return null;if(t.text.toLowerCase().indexOf(r)>-1){var n=$.extend({},t,!0);return n}return null},language:{noResults:function(){return i("sdk.search.no_results")},errorLoading:function(){return i("sdk.search.error_loading")},searching:function(){return i("sdk.search.searching")},inputTooShort:function(e){var t=e.minimum-e.input.length;return i("sdk.search.autocomplete.inputshort.pre")+" "+t+" "+i("sdk.search.autocomplete.inputshort.post")}}}},{"core/i18n/i18n.service":27}],145:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("components/FieldText.vue"),a=n(i),o=e("components/FieldLink.vue"),s=n(o),l=e("components/FieldImage.vue"),u=n(l),c=e("components/FieldGeo.vue"),d=n(c),p=e("components/FieldMedia.vue"),f=n(p),h=e("components/FieldVue.vue"),v=n(h),g={simple_field:a["default"],text_field:a["default"],link_field:s["default"],image_field:u["default"],geo_field:d["default"],photo_field:u["default"],media_field:f["default"],vue_field:v["default"]};t.exports=g},{"components/FieldGeo.vue":245,"components/FieldImage.vue":246,"components/FieldLink.vue":247,"components/FieldMedia.vue":248,"components/FieldText.vue":249,"components/FieldVue.vue":250}],146:[function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("./fields"),a=e("core/utils/utils"),o=a.toRawType,s=e("core/catalog/cataloglayersstoresregistry"),l=/^(https?:\/\/[^\s]+)/g,u=/[^\s]+.(png|jpg|jpeg|gif)$/g,c={SIMPLE:"simple",GEO:"geo",LINK:"link",PHOTO:"photo",PHOTOLINK:"photolink",IMAGE:"image",POINTLINK:"pointlink",ROUTE:"route",VUE:"vue"};t.exports={getType:function(e){var t=e.type;if("vue"!==t){var r=e.value,i=!r||"Object"!==o(r)||r.coordinates||r.vue?r:r.value;i?i&&"object"==("undefined"==typeof i?"undefined":n(i))?i.coordinates?t=c.GEO:i.vue&&(t=c.VUE):t=i&&Array.isArray(i)?i.length&&i[0].photo?c.PHOTO:c.SIMPLE:i.toString().toLowerCase().match(u)?c.PHOTO:i.toString().match(l)?c.LINK:c.SIMPLE:t=c.SIMPLE}return t+"_field"},isSimple:function(e){return this.getType(e)===c.SIMPLE+"_field"},isLink:function(e){return this.getType(e)===c.LINK+"_field"},isImage:function(e){return this.getType(e)===c.IMAGE+"_field"},isPhoto:function(e){return this.getType(e)===c.PHOTO+"_field"},isVue:function(e){return this.getType(e)===c.VUE+"_field"},add:function(e){var t=e.type,r=e.field;i[t]=r},remove:function(e){delete i[e]},changeConfigFieldType:function(e){var t=e.layerId,r=e.field,n=void 0===r?{}:r,i=s.getLayerById(t);i.changeConfigFieldType(n)},resetConfigFieldType:function(e){var t=e.layerId,r=e.field,n=void 0===r?{}:r,i=s.getLayerById(t);i.resetConfigField(n)}}},{"./fields":145,"core/catalog/cataloglayersstoresregistry":9,"core/utils/utils":92}],147:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("services/floatbar"),a=n(i),o=e("components/Floatbar.vue"),s=n(o);t.exports={FloatbarService:a["default"],FloatbarComponent:s["default"]}},{"components/Floatbar.vue":251,"services/floatbar":388}],148:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=this;this.state=null,this.eventBus=new Vue,this.layer,this.setters={setInitForm:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setInitForm(e)},setFormStructure:function(e){this.state.formstructure=e},setFormFields:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.state.fields=e,this.handleFieldsWithExpression(e)},setupFields:function(){this._setupFields()},setFormData:function(e){this.setFormFields(e)},setField:function(e){},setState:function(e){this._setState(e)},addActionsForForm:function(e){},postRender:function(e){}},u(this),this.init=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setInitForm(e)},this._setInitForm=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.fields,r=e.feature,n=e.layer,i=e.title,a=void 0===i?"Form":i,o=e.formId,s=e.name,l=e.buttons,u=void 0===l?{}:l,c=e.context_inputs,d=(e.isnew,e.footer),p=void 0===d?{}:d;if(this.layer=n,this.feature=r,this.title=a,this.formId=o,this.name=s,this.buttons=u,this.context_inputs=c,this.state={layerid:n.getId(),loading:!1,components:[],disabledcomponents:[],component:null,headers:[],currentheaderid:null,fields:null,buttons:this.buttons,disabled:!1,valid:!0,tovalidate:{},feature:r,componentstovalidate:{},footer:p,ready:!1},this.expression_fields_dependencies={},this.setFormFields(t),this.layer&&e.formStructure){var f=this.layer.getLayerEditingFormStructure(t);this.setFormStructure(f)}},this.eventBus.$on("set-loading-form",function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e.state.loading=t})}var a=e("core/expression/inputservice"),o=n(a),s=e("core/utils/utils"),l=s.inherit,u=s.base,c=e("core/g3wobject");l(i,c);var d=i.prototype;d.setReady=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state.ready=e},d.handleFieldsWithExpression=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach(function(t){var r=t.input.options,n=void 0===r?{}:r;if(n.filter_expression){var i=n.filter_expression.referencing_fields,a=void 0===i?[]:i;a.forEach(function(r){r&&(void 0===e.expression_fields_dependencies[r]&&(e.expression_fields_dependencies[r]=[]),e.expression_fields_dependencies[r].push(t.name))})}}),Object.keys(this.expression_fields_dependencies).forEach(function(t){var r=e.state.fields.find(function(e){return e.name===t});r&&e.evaluateExpression(r)})},d.setCurrentFormPercentage=function(e){this.layer.setFormPercentage(e)},d.setLoading=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state.loading=e},d.setValidComponent=function(e){var t=e.id,r=e.valid;this.state.componentstovalidate[t]=r,this.isValid()},d.getValidComponent=function(e){return this.state.componentstovalidate[e]},d.changeInput=function(e){this.evaluateExpression(e),this.isValid(e)},d.evaluateExpression=function(e){var t=this,r=this.expression_fields_dependencies[e.name];if(r){var n=this.feature.clone();n.set(e.name,e.value),r.forEach(function(e){var r=t.state.fields.find(function(t){return t.name===e}),i=t.layer.getId();o["default"].handleFormInput({qgs_layer_id:i,field:r,feature:n})})}},d.isValid=function(e){var t=this;if(e)if(e.validate.mutually){if(!e.validate.required)if(e.validate.empty){e.value=null,e.validate.mutually_valid=!0,e.validate.valid=!0,e.validate._valid=!0;for(var r=[],n=e.validate.mutually.length;n--;){var i=e.validate.mutually[n];!this.state.tovalidate[i].validate.empty&&r.push(i)}r.length<2&&r.forEach(function(e){t.state.tovalidate[e].validate.mutually_valid=!0,t.state.tovalidate[e].validate.valid=!0,setTimeout(function(){t.state.tovalidate[e].validate.valid=t.state.tovalidate[e].validate._valid,t.state.valid=t.state.valid&&t.state.tovalidate[e].validate.valid})})}else e.validate._valid=e.validate.valid,e.validate.mutually_valid=e.validate.mutually.reduce(function(e,r){return e&&t.state.tovalidate[r].validate.empty},!0),e.validate.valid=e.validate.mutually_valid&&e.validate.valid}else if(!e.validate.empty&&(e.validate.min_field||e.validate.max_field)){var a=e.validate.min_field||e.validate.max_field;e.validate.valid=e.validate.min_field?this.state.tovalidate[e.validate.min_field].validate.empty||1*e.value>1*this.state.tovalidate[e.validate.min_field].value:this.state.tovalidate[e.validate.max_field].validate.empty||1*e.value<1*this.state.tovalidate[e.validate.max_field].value,e.validate.valid&&(this.state.tovalidate[a].validate.valid=!0)}this.state.valid=Object.values(this.state.tovalidate).reduce(function(e,t){return e&&t.validate.valid},!0)&&Object.values(this.state.componentstovalidate).reduce(function(e,t){return e&&t},!0)},d.addComponents=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=!0,r=!1,n=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;this.addComponent(o)}}catch(s){r=!0,n=s}finally{try{!t&&a["return"]&&a["return"]()}finally{if(r)throw n}}},d.addComponent=function(e){var t=e.id,r=e.title,n=e.name,i=e.icon,a=e.valid,o=e.header,s=void 0===o||o;void 0!==a&&(this.state.componentstovalidate[t]=a,this.state.valid=this.state.valid&&a,this.eventBus.$emit("add-component-validate",{id:t,valid:a})),s&&(this.state.headers.push({title:r,name:n,id:t,icon:i}),this.state.currentheaderid=this.state.currentheaderid||t),this.state.components.push(e)},d.replaceComponent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.component,n=this.state.components.findIndex(function(e){return e.id===t});this.state.components.splice(n,1,r)},d.disableComponent=function(e){var t=e.id,r=e.disabled;r?this.state.disabledcomponents.push(t):this.state.disabledcomponents=this.state.disabledcomponents.filter(function(e){return disabledId!==t})},d.setCurrentComponentById=function(e){if(this.state.disabledcomponents.indexOf(e)===-1)return this.setIdHeader(e),this.state.component=this.state.components.find(function(t){return t.id===e}).component,this.state.component},d.setRootComponent=function(){this.state.component=this.state.components.find(function(e){return e.root}).component},d.getRootComponent=function(){return this.state.components.find(function(e){return e.root}).component},d.isRootComponent=function(e){return this.getRootComponent()==e},d.getComponentById=function(e){return this.state.components.find(function(t){return t.id===e})},d.setComponent=function(e){this.state.component=e},d.addedComponentTo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"body";this.state.addedcomponentto[e]=!0},d.addToValidate=function(e){this.state.tovalidate[e.name]=e,this.state.ready&&this.isValid(e)},d.removeToValidate=function(e){delete this.state.tovalidate[e.name],this.isValid()},d.getState=function(){return this.state},d._setState=function(e){this.state=e},d.getFields=function(){return this.state.fields},d._getField=function(e){return this.state.fields.find(function(t){return t.name===e})},d.getEventBus=function(){return this.eventBus},d.setIdHeader=function(e){this.state.currentheaderid=e},d.getContext=function(){return this.context_inputs.context},d.getSession=function(){return this.getContext().session},d.getInputs=function(){return this.context_inputs.inputs},d.handleRelation=function(e){e.relationId,e.feature},d.clearAll=function(){this.eventBus.$off("addtovalidate"),this.eventBus.$off("set-main-component"),this.eventBus.$off("set-loading-form"),this.eventBus.$off("component-validation"),this.eventBus.$off("disable-component")},t.exports=i},{"core/expression/inputservice":24,"core/g3wobject":26,"core/utils/utils":92}],149:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=void 0===t?"form":t,n=e.name,i=e.title;d(this,e),e.service=e.service?new e.service:new v,e.vueComponentObject=e.vueComponentObject||s;var a=e.components||[{id:r,title:i,name:n,root:!0,component:u["default"]}];e.perc=null!==e.layer.getFormPercentage()?e.layer.getFormPercentage():e.perc,this.init(e),this.getService().addComponents(a),this.getService().setComponent(a[0].component),this.addBodyFormComponent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.component,r=e.where,n=void 0===r?"after":r;this.getInternalComponent().body.components[n].push(t)},this.addBodyFormComponents=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.components,n=void 0===r?[]:r,i=t.where,a=void 0===i?"after":i;n.forEach(function(t){return e.addBodyFormComponent({component:t,where:a})})},this.addFormComponents=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.getService().addComponents(e)},this.addFormComponent=function(e){e&&this.getService().addComponent(e)},this.addDependecyComponents=function(e){this.getService().addDependecyComponents(e)},this.addComponentBeforeBody=function(e){},this.addComponentAfterBody=function(e){},this.addComponentBeforeFooter=function(){},this.addComponentAfterFooter=function(e){},this.mount=function(e,t){return d(this,"mount",e,t).then(function(){f.setModal(!0)})},this.layout=function(){this.internalComponent.reloadLayout()}}var o=e("components/Form.vue"),s=i(o),l=e("components/FormBody.vue"),u=n(l),c=e("core/utils/utils"),d=c.base,p=c.inherit,f=e("gui/gui"),h=e("gui/component/component"),v=e("../formservice");p(a,h),t.exports=a},{"../formservice":148,"components/Form.vue":252,"components/FormBody.vue":253,"core/utils/utils":92,"gui/component/component":140,"gui/gui":150}],150:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("services/gui"),a=n(i);t.exports=a["default"]},{"services/gui":389}],151:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("components/InputBase.vue"),a=n(i),o=e("gui/vue/vue.mixins"),s=o.baseInputMixin;t.exports={BaseInput:a["default"],BaseInputMixin:s}},{"components/InputBase.vue":272,"gui/vue/vue.mixins":227}],152:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.state.input.options.values.find(function(e){return e.checked===!1});e.validatorOptions={values:e.state.input.options.values.map(function(e){return e})},null!==e.state.value||e.state.forceNull||(e.state.value=t.value),o(this,e)}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("gui/inputs/service");a(n,s);var l=n.prototype;l.convertCheckedToValue=function(e){e=null!==e&&void 0!==e&&e;var t=this.state.input.options.values.find(function(t){return t.checked===e});return this.state.value=t.value,this.state.value},l.convertValueToChecked=function(){var e=this.state.value;if(null===e||void 0===e)return!1;var t=this.state.input.options.values.find(function(t){return t.value==e});return void 0===t&&(t=this.state.input.options.values.find(function(e){return e.checked===!1}),this.state.value=t.value),t.checked},t.exports=n},{"core/utils/utils":92,"gui/inputs/service":175}],153:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputCheckbox.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputCheckbox.vue":273}],154:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputColor.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputColor.vue":274}],155:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.validatorOptions={},
o(this,e)}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("core/applicationservice"),l=e("gui/inputs/service");a(n,l);var u=n.prototype;u.getLocale=function(){var e=s.getConfig();return e.user.i18n?e.user.i18n:"en"},u.convertQGISDateTimeFormatToMoment=function(e){e=e.replace("yyyy","YYYY");var t=e.match(/d/g);return t&&t.length<3&&(e=e.replace("d".repeat(t.length),"D".repeat(t.length))),e},u.setValidatorOptions=function(e){this.validatorOptions=e},t.exports=n},{"core/applicationservice":7,"core/utils/utils":92,"gui/inputs/service":175}],156:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputDateTimePicker.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputDateTimePicker.vue":275}],157:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e)}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("gui/inputs/service");o(n,s),t.exports=n},{"core/utils/utils":92,"gui/inputs/service":175}],158:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputFloat.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputFloat.vue":276}],159:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("core/applicationstate"),a=n(i),o=e("./services"),s=e("./baseinput/baseinput"),l=s.BaseInput,u=s.BaseInputMixin,c={props:["state"],mixins:[u],components:{baseinput:l},watch:{notvalid:function(e){e&&this.service.setErrorMessage(this.state)}},created:function(){var e=this;this.service=new o[this.state.input.type]({state:this.state}),this.$watch(function(){return a["default"].lng},function(){return e.service.setErrorMessage(e.state)}),this.state.editable&&this.state.validate.required&&this.service.validate(),this.$emit("addinput",this.state)},destroyed:function(){this.$emit("removeinput",this.state)}};t.exports=c},{"./baseinput/baseinput":151,"./services":176,"core/applicationstate":8}],160:[function(e,t,r){var n={text_input:e("./text/vue/text"),textarea_input:e("./textarea/vue/textarea"),integer_input:e("./integer/vue/integer"),string_input:e("./text/vue/text"),float_input:e("./float/vue/float"),radio_input:e("./radio/vue/radio"),check_input:e("./checkbox/vue/checkbox"),range_input:e("./range/vue/range"),datetimepicker_input:e("./datetimepicker/vue/datetimepicker"),unique_input:e("./unique/vue/unique"),select_input:e("./select/vue/select"),media_input:e("./media/vue/media"),select_autocomplete_input:e("./select/vue/select"),picklayer_input:e("./picklayer/vue/picklayer"),color_input:e("./color/vue/color"),slider_input:e("./sliderrange/vue/sliderrange"),lonlat_input:e("./lonlat/vue/lonlat")};t.exports=n},{"./checkbox/vue/checkbox":153,"./color/vue/color":154,"./datetimepicker/vue/datetimepicker":156,"./float/vue/float":158,"./integer/vue/integer":162,"./lonlat/vue/lonlat":164,"./media/vue/media":166,"./picklayer/vue/picklayer":168,"./radio/vue/radio":170,"./range/vue/range":172,"./select/vue/select":174,"./sliderrange/vue/sliderrange":178,"./text/vue/text":179,"./textarea/vue/textarea":180,"./unique/vue/unique":182}],161:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e)}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("gui/inputs/service");o(n,s),t.exports=n},{"core/utils/utils":92,"gui/inputs/service":175}],162:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputInteger.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputInteger.vue":279}],163:[function(e,t,r){function n(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,t),this.coordinatebutton,this.mapService=u.getComponent("map").getService(),this.mapEpsg=this.mapService.getCrs(),this.mapControlToggleEventHandler=function(t){t.target.isToggled()&&t.target.isClickMap()&&e.coordinatebutton.active&&e.toggleGetCoordinate()},this.map=u.getComponent("map").getService().getMap(),this.outputEpsg=this.state.epsg||this.mapEpsg,this.eventMapKey}var i=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=e("core/utils/utils"),o=a.base,s=a.inherit,l=e("gui/inputs/service"),u=e("gui/gui");s(n,l);var c=n.prototype;c.setCoordinateButtonReactiveObject=function(e){this.coordinatebutton=e},c.validate=function(){this.state.values.lon<-180?this.state.values.lon=-180:this.state.values.lon>180&&(this.state.values.lon=180),this.state.values.lat<-90?this.state.values.lon=-90:this.state.values.lat>90&&(this.state.values.lon=90),this.state.validate.valid=!Number.isNaN(1*this.state.values.lon)},c.toggleGetCoordinate=function(){this.coordinatebutton.active=!this.coordinatebutton.active,this.coordinatebutton.active?this.startToGetCoordinates():this.stopToGetCoordinates()},c.startToGetCoordinates=function(){var e=this;this.mapService.deactiveMapControls(),this.mapService.on("mapcontrol:toggled",this.mapControlToggleEventHandler),this.eventMapKey=this.map.on("click",function(t){t.originalEvent.stopPropagation(),t.preventDefault();var r=e.mapEpsg!==e.outputEpsg?ol.proj.transform(t.coordinate,e.mapEpsg,e.outputEpsg):t.coordinate;e.state.value=[r];var n=i(r,2),a=n[0],o=n[1];e.state.values.lon=a,e.state.values.lat=o})},c.stopToGetCoordinates=function(){ol.Observable.unByKey(this.eventMapKey),this.mapService.off("mapcontrol:toggled",this.mapControlToggleEventHandler)},c.clear=function(){this.stopToGetCoordinates()},t.exports=n},{"core/utils/utils":92,"gui/gui":150,"gui/inputs/service":175}],164:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputLonLat.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputLonLat.vue":280}],165:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e)}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("gui/inputs/service");a(n,s),t.exports=n},{"core/utils/utils":92,"gui/inputs/service":175}],166:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputMedia.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputMedia.vue":281}],167:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pick_type=e.pick_type||"wms",this.ispicked=!1,this.fields=e.fields||[e.value],this.layerId=e.layer_id,this.mapService=u.getService("map"),this.interaction="map"===this.pick_type?new i({layers:[this.mapService.getLayerById(this.layerId)]}):new a}var i=e("g3w-ol/interactions/pickfeatureinteraction"),a=e("g3w-ol/interactions/pickcoordinatesinteraction"),o=e("core/map/maplayersstoresregistry"),s=e("core/utils/geo"),l=s.getQueryLayersPromisesByCoordinates,u=e("gui/gui"),c=n.prototype;c.isPicked=function(){return this.ispicked},c.escKeyUpHandler=function(e){var t=e.keyCode,r=e.data.owner;27===t&&r.unpick()},c.unbindEscKeyUp=function(){$(document).unbind("keyup",this.escKeyUpHandler)},c.bindEscKeyUp=function(){$(document).on("keyup",{owner:this},this.escKeyUpHandler)},c.pick=function(){var e=this;return new Promise(function(t,r){e.bindEscKeyUp();var n={};e.ispicked=!0;var i=function(i){if(i){var a=i.getProperties();e.fields.forEach(function(e){n[e]=a[e]}),t(n)}else r();e.ispicked=!1,e.unpick()};u.setModal(!1),e.mapService.addInteraction(e.interaction),e.interaction.once("picked",function(t){if("map"===e.pick_type){var r=t.feature;i(r)}else if("wms"===e.pick_type){var n=o.getLayerById(e.layerId);n&&l([n],{map:e.mapService.getMap(),feature_count:1,coordinates:t.coordinate}).then(function(e){var t=e[0].data,r=void 0===t?[]:t,n=r.length&&r[0].features[0]||null;i(n)})}})})},c.unpick=function(){this.mapService.removeInteraction(this.interaction),u.setModal(!0),this.unbindEscKeyUp(),this.ispicked=!1},c.clear=function(){this.isPicked()&&this.unpick(),this.mapService=this.interaction=this.field=null},t.exports=n},{"core/map/maplayersstoresregistry":76,"core/utils/geo":89,"g3w-ol/interactions/pickcoordinatesinteraction":129,"g3w-ol/interactions/pickfeatureinteraction":130,"gui/gui":150}],168:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputPickLayer.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputPickLayer.vue":282}],169:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e)}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("gui/inputs/service");a(n,s),t.exports=n},{"core/utils/utils":92,"gui/inputs/service":175}],170:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputRadio.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputRadio.vue":283}],171:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.state.input.options.values[0],r=t.min,n=t.max;e.state.info="[MIN: "+r+" - MAX: "+n+"]",o(this,e);var i=new l({min:1*r,max:1*n});this.setValidator(i)}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("gui/inputs/service"),l=e("core/validators/inputs/range");a(n,s);var u=s.prototype;u.isValueInRange=function(e,t,r){return e<=r&&e>=t},t.exports=n},{"core/utils/utils":92,"core/validators/inputs/range":94,"gui/inputs/service":175}],172:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputRange.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputRange.vue":284}],173:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s(this,e),this.layer=null}var i=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=e("core/utils/utils"),o=a.inherit,s=a.base,l=e("core/catalog/cataloglayersstoresregistry"),u=e("gui/inputs/service");o(n,u);var c=n.prototype;c._getLayerById=function(e){return l.getLayerById(e)},c.addValue=function(e){this.state.input.options.values.push(e)},c.getKeyByValue=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.search,n=this.state.input.options,a=n.value,o=n.key;this.getData({key:a,value:o,search:r}).then(function(t){var r=i(t,1),n=r[0],a=n.$value,o=n.text;e.addValue({key:a,value:o})})["catch"](function(e){})},c.getData=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.layer_id,n=void 0===r?this.state.input.options.layer_id:r,i=t.key,a=void 0===i?this.state.input.options.key:i,o=t.value,s=void 0===o?this.state.input.options.value:o,l=t.search,u=(a+"|"+l).trim();return new Promise(function(t,r){e._layer||(e._layer=e._getLayerById(n)),e._layer.getDataTable({suggest:u,ordering:a}).then(function(e){for(var r=[],n=e.features,i=0;i<n.length;i++)r.push({text:n[i].properties[a],id:i,$value:n[i].properties[s]});t(r)}).fail(function(e){return r(e)})})},t.exports=n},{"core/catalog/cataloglayersstoresregistry":9,"core/utils/utils":92,"gui/inputs/service":175}],174:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputSelect.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputSelect.vue":285}],175:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state=e.state||{},this.has_default_value=!1,this.setValue(this.state.value),this.setEmpty(this.state.value);var t=this.state.type,r=e.validatorOptions||this.state.input.options||{};this._validator=i.get(t,r),this.setErrorMessage(e.state)}var i=e("core/validators/inputs/validators"),a=e("core/i18n/i18n.service"),o=a.t,s=n.prototype;s.getState=function(){return this.state},s.getValue=function(){return this.state.value},s.setValue=function(e){null!==e&&void 0!==e||(Array.isArray(this.state.input.options)?this.state.input.options[0]["default"]?this.state.value=this.state.input.options[0]["default"]:Array.isArray(this.state.input.options.values)&&this.state.input.options.values.length&&(this.state.value=this.state.input.options.values[0]&&this.state.input.options.values[0].value||this.state.input.options.values[0]):(this.state.value=this.state.input.options["default"],this.has_default_value=!0))},s.addValueToValues=function(e){this.state.input.options.values.unshift(e)},s._getValidatorType=function(){return this.state.type},s.setState=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state=_.isObject(e)?e:{}},s.getValidator=function(){return this._validator},s.setValidator=function(e){this._validator=e},s.setEmpty=function(){this.state.validate.empty=!(Array.isArray(this.state.value)&&this.state.value.length||!_.isEmpty(_.trim(this.state.value)))},s.validate=function(){return this.state.validate.empty?(this.state.validate.empty=!0,this.state.value=null,this.state.validate.unique=!0,this.state.validate.valid=!this.state.validate.required&&this._validator.validate(this.state.value)):("integer"!==this.state.input.type&&"float"!==this.state.input.type||(+this.state.value<0?(this.state.value=null,this.state.validate.empty=!0,this.state.validate.valid=!this.state.validate.required):this.state.validate.valid=this._validator.validate(this.state.value)),this.state.validate.exclude_values&&this.state.validate.exclude_values.length?this.state.validate.exclude_values.indexOf(this.state.value)!==-1?(this.state.validate.valid=!1,this.state.validate.unique=!1):this.state.validate.unique=!0:this.state.validate.valid=this._validator.validate(this.state.value)),this.state.validate.valid},s.setErrorMessage=function(e){var t=void 0;e.validate.mutually&&!e.validate.mutually_valid?this.state.validate.message=o("sdk.form.inputs.input_validation_mutually_exclusive")+" ( "+e.validate.mutually.join(",")+" )":e.validate.max_field?this.state.validate.message=o("sdk.form.inputs.input_validation_max_field")+" ("+e.validate.max_field+")":e.validate.min_field?this.state.validate.message=o("sdk.form.inputs.input_validation_min_field")+" ("+e.validate.min_field+")":!e.validate.unique&&e.validate.exclude_values?this.state.validate.message=""+o("sdk.form.inputs.input_validation_exclude_values"):e.validate.required?(t=o("sdk.form.inputs.input_validation_error")+" ( "+o("sdk.form.inputs."+e.type)+" )",this.state.info&&(t=t+"\n                 <div>\n                  <b>"+this.state.info+"</b>\n                 </div>         \n      "),this.state.validate.message=this.state.info||t):this.state.validate.message=this.state.info},t.exports=n},{"core/i18n/i18n.service":27,"core/validators/inputs/validators":95}],176:[function(e,t,r){var n={text:e("./service"),textarea:e("./service"),integer:e("./integer/service"),string:e("./service"),"float":e("./float/service"),radio:e("./radio/service"),check:e("./checkbox/service"),range:e("./range/service"),datetimepicker:e("./datetimepicker/service"),unique:e("./unique/service"),select:e("./select/service"),media:e("./media/service"),select_autocomplete:e("./select/service"),picklayer:e("./service"),color:e("./service"),slider:e("./sliderrange/service"),lonlat:e("./lonlat/service")};t.exports=n},{"./checkbox/service":152,"./datetimepicker/service":155,"./float/service":157,"./integer/service":161,"./lonlat/service":163,"./media/service":165,"./radio/service":169,"./range/service":171,"./select/service":173,"./service":175,"./sliderrange/service":177,"./unique/service":181}],177:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.state;e.state.info="[MIN: "+t.input.options.min+" - MAX: "+t.input.options.max+"]",a(this,e);var r=l.get("range",{min:1*t.input.options.min,max:1*t.input.options.max});this.setValidator(r),this.validate=function(){this.state.value=1*this.state.value,this.state.validate.valid=this.state.value>=this.state.input.options.min||this.state.value<=this.state.input.options.max}}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("gui/inputs/service"),l=e("core/validators/inputs/validators");o(n,s);var u=n.prototype;u.changeInfoMessage=function(){this.state.info="[MIN: "+this.state.input.options.min+" - MAX: "+this.state.input.options.max+"]"},t.exports=n},{"core/utils/utils":92,"core/validators/inputs/validators":95,"gui/inputs/service":175}],178:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputSliderRange.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputSliderRange.vue":286}],179:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputText.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputText.vue":287}],180:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputTextArea.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputTextArea.vue":288}],181:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e)}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("gui/inputs/service");a(n,s),t.exports=n},{"core/utils/utils":92,"gui/inputs/service":175}],182:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/InputUnique.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/InputUnique.vue":289}],183:[function(e,t,r){var n=e("gui/vue/vue.mixins"),i=n.widgetMixins;t.exports=i},{"gui/vue/vue.mixins":227}],184:[function(e,t,r){var n=e("g3w-ol/controls/resetcontrol"),i=e("g3w-ol/controls/querycontrol"),a=e("g3w-ol/controls/zoomboxcontrol"),o=e("g3w-ol/controls/querybboxcontrol"),s=e("g3w-ol/controls/querybypolygoncontrol"),l=e("g3w-ol/controls/geolocationcontrol"),u=e("g3w-ol/controls/streetviewcontrol"),c=e("g3w-ol/controls/addlayers"),d=e("g3w-ol/controls/lengthcontrol"),p=e("g3w-ol/controls/areacontrol"),f=e("g3w-ol/controls/olcontrol"),h=e("g3w-ol/controls/geocodingcontrol"),v=e("g3w-ol/controls/mousepositioncontrol"),g=e("g3w-ol/controls/scalecontrol"),m=e("g3w-ol/controls/onclickcontrol"),y=e("g3w-ol/controls/screenshotcontrol"),_=e("g3w-ol/controls/geoscreenshotcontrol"),b={create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=b.CONTROLS[e.type];if(t)return new t(e)}};b.CONTROLS={reset:n,zoombox:a,zoomtoextent:f,query:i,querybbox:o,querybypolygon:s,geolocation:l,streetview:u,zoom:f,scaleline:f,overview:f,nominatim:h,geocoding:h,addlayers:c,length:d,area:p,mouseposition:v,scale:g,onclick:m,screenshot:y,geoscreenshot:_},t.exports=b},{"g3w-ol/controls/addlayers":103,"g3w-ol/controls/areacontrol":104,"g3w-ol/controls/geocodingcontrol":106,"g3w-ol/controls/geolocationcontrol":107,"g3w-ol/controls/geoscreenshotcontrol":108,"g3w-ol/controls/lengthcontrol":110,"g3w-ol/controls/mousepositioncontrol":112,"g3w-ol/controls/olcontrol":113,"g3w-ol/controls/onclickcontrol":114,"g3w-ol/controls/querybboxcontrol":115,"g3w-ol/controls/querybypolygoncontrol":116,"g3w-ol/controls/querycontrol":117,"g3w-ol/controls/resetcontrol":118,"g3w-ol/controls/scalecontrol":119,"g3w-ol/controls/screenshotcontrol":120,"g3w-ol/controls/streetviewcontrol":121,"g3w-ol/controls/zoomboxcontrol":123}],185:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("store/map-controls"),a=n(i);t.exports=a["default"]},{"store/map-controls":404}],186:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function o(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.state={mapUnits:"m",bbox:[],hidemaps:[],resolution:null,center:null,loading:!1,hidden:!0,scale:0,mapcontrolsalignement:"rv",mapcontrolDOM:null,mapcontrolready:!1,mapcontrolSizes:{height:47,width:47,minWidth:47,minHeight:47},mapControl:{grid:[],length:0,currentIndex:0,update:!0,disabled:!1},map_info:{info:null,style:null},mapunits:["metric"]},this.id="MapService",this.viewer=null,this.target=t.target||null,this.layersCount=0,this.maps_container=t.maps_container||null,this._layersStoresEventKeys={},this._keyEvents={ol:[],g3wobject:[],eventemitter:[]},this.project=null,this._mapControls=[],this._changeMapMapControls=[],this._mapLayers=[],this._externalMapLayers=[],this._externalLayers=[],this._externalInteractions=[],this.mapBaseLayers={},this.defaultsLayers={_style:{highlightLayer:{color:void 0},selectionLayer:{color:"red"}},highlightLayer:new ol.layer.Vector({source:new ol.source.Vector,style:function i(t){var r=[],n=t.getGeometry().getType(),i=k({geometryType:n,color:e.defaultsLayers._style.highlightLayer.color,fill:!1});return r.push(i),r}}),selectionLayer:new ol.layer.Vector({source:new ol.source.Vector,style:function a(t){var r=[],n=t.getGeometry().getType(),a=k({geometryType:n,color:e.defaultsLayers._style.selectionLayer.color,fill:!1});return r.push(a),r}})},this.layersExtraParams={},this._greyListenerKey=null,this._drawShadow={type:"coordinate",outer:[],inner:[],scale:null,rotation:null},this.config=t.config||P.getConfig(),this._howManyAreLoading=0,this._layersLoadingError=!1,this._incrementLoaders=function(){0===e._howManyAreLoading&&(e.emit("loadstart"),I.showSpinner({container:$("#map-spinner"),id:"maploadspinner",style:"transparent"})),e._howManyAreLoading+=1},this._decrementLoaders=function(){e._howManyAreLoading-=1,0===e._howManyAreLoading&&(e.emit("loadend"),I.hideSpinner("maploadspinner"))},this._mapLayerLoadError=function(){e._layersLoadingError||(I.notify.warning("sdk.errors.layers.load"),e._layersLoadingError=!0),e._decrementLoaders()},t.project)this.project=t.project;else{this.project=F.getCurrentProject();var r=F.onafter("setCurrentProject",function(t){e.removeLayers(),e._removeListeners();var r=e.project.getId()===t.getId();e.project=t;var n=function(){e._resetView(),e._setupAllLayers(),e._checkMapControls(),e.setUpMapOlEvents(),e.setupCustomMapParamsToLegendUrl()};P.isIframe()&&n(),r?n():e.getMap().once("change:size",n)});this._keyEvents.g3wobject.push({who:F,setter:"setCurrentProject",key:r})}this._setupListeners(),this._marker=null,this._bboxLayer=new ol.layer.Vector({source:new ol.source.Vector({})}),this.debounces={setupCustomMapParamsToLegendUrl:{fnc:function(){e._setupCustomMapParamsToLegendUrl.apply(e,arguments)},delay:1e3}},this.setters={setupControls:function(){return this._setupControls()},addHideMap:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(e.ratio,e.layers,e.mainview,e.switchable),r=void 0!==t&&t,n="hidemap_"+Date.now(),i={id:n,map:null,switchable:r};return this.state.hidemaps.push(i),i},updateMapView:function(e,t,r){this.state.bbox=e,this.state.resolution=t,this.state.center=r,this.updateMapLayers()},setHidden:function(e){this.state.hidden=e},setupViewer:function(e,t){0!==e&&0!==t&&(this.viewer&&(this.viewer.destroy(),this.viewer=null),this._setupViewer(e,t),this.state.bbox=this.viewer.getBBOX(),this.state.resolution=this.viewer.getResolution(),this.state.center=this.viewer.getCenter(),this._setupAllLayers(),this.setUpMapOlEvents(),this.emit("viewerset"))},controlClick:function(e){arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}},loadExternalLayer:function(e){},unloadExternalLayer:function(e){}},this._onCatalogSelectLayer=function(e){if(e)for(var t=0;t<this._mapControls.length;t++){var r=this._mapControls[t];r.control.onSelectLayer&&r.control.onSelectLayer(e)}},this.on("cataloglayerselected",this._onCatalogSelectLayer),this._keyEvents.eventemitter.push({event:"cataloglayerselected",listener:this._onCatalogSelectLayer});var n=function(t,r){r&&e.getMapLayers().forEach(function(r){return r.update(e.state,t)})};this.on("extraParamsSet",n),this._keyEvents.eventemitter.push({event:"extraParamsSet",listener:n}),this.once("viewerset",function(){O.getLayersStores().forEach(function(t){e._setUpEventsKeysToLayersStore(t)}),O.onafter("addLayersStore",function(t){e._setUpEventsKeysToLayersStore(t)}),O.onafter("removeLayersStore",function(t){e._removeEventsKeysToLayersStore(t)})}),v(this)}var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=e("../../constant"),c=e("../wms/vue/wms"),d=(n(c),e("core/i18n/i18n.service")),p=d.t,f=e("core/utils/utils"),h=f.inherit,v=f.base,g=f.copyUrl,m=f.uniqueId,y=(f.debounce,f.throttle),b=f.toRawType,w=f.createFilterFromString,x=e("core/g3wobject"),S=e("core/utils/geo"),C=S.createVectorLayerFromFile,L=S.createWMSLayer,k=S.createSelectedStyle,M=S.getMapLayersByFilter,T=S.getGeoTIFFfromServer,E=e("core/data/routerservice"),I=e("gui/gui"),P=e("core/applicationservice"),F=e("core/project/projectsregistry"),O=e("core/map/maplayersstoresregistry"),R=e("core/layers/providers/wfsprovider"),j=e("g3w-ol/g3w.ol").helpers,A=e("core/utils/ol"),N=A.getScaleFromResolution,G=A.getResolutionFromScale,D=e("gui/map/control/factory"),V=e("gui/streetview/streetviewservice"),U=e("gui/map/control/registry"),q=e("core/layers/vectorlayer");h(o,x);var B=o.prototype;B.setUpMapOlEvents=function(){var e=this,t=this.project.getContextBaseLegend();this._keyEvents.ol.forEach(function(e){return ol.Observable.unByKey(e)});var r=this.viewer.map.getView().on("change:resolution",function(r){e._updateMapView(),t&&e.setupCustomMapParamsToLegendUrl()});if(this._keyEvents.ol.push(r),t){var n=this.viewer.map.on("moveend",function(t){return e.setupCustomMapParamsToLegendUrl()});this._keyEvents.ol.push(n)}else this.setupCustomMapParamsToLegendUrl(!1)},B.clear=function(){var e=this;Object.keys(this._keyEvents).forEach(function(t){switch(t){case"ol":e._keyEvents[t].forEach(function(e){return ol.Observable.unByKey(e)});break;case"g3wobject":e._keyEvents[t].forEach(function(e){var t=e.who,r=e.setter,n=e.key;t.un(r,n)});break;case"eventemitter":e._keyEvents[t].forEach(function(t){var r=t.event,n=t.listener;e.removeListener(r,n)})}}),this._keyEvents=null,O.getLayersStores().forEach(function(t){e._removeEventsKeysToLayersStore(t)})},B.showMapSpinner=function(){I.showSpinner({container:$("#map-spinner"),id:"maploadspinner",style:"transparent"})},B.hideMapSpinner=function(){I.hideSpinner("maploadspinner")},B.getScaleFromExtent=function(e){var t=this.getMap().getView().getResolutionForExtent(e,this.getMap().getSize()),r=N(t,this.getMapUnits());return r},B._addHideMap=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.ratio,r=e.layers,n=void 0===r?[]:r,i=e.mainview,a=void 0!==i&&i,o=this.state.hidemaps[this.state.hidemaps.length-1],s=this.getMap().getView(),u={projection:s.getProjection(),center:s.getCenter(),resolution:this.getResolution()},c=j.createViewer({id:o.id,view:a?s:u});if(o.map=c.getMap(),t){var d=o.map.getSize(),p=l(d,2),f=p[0];p[1];o.map.setSize([f,f*t])}for(var h=0;h<n.length;h++){var v=n[h];o.map.addLayer(v)}return o.map},B.removeHideMap=function(e){for(var t=void 0,r=0;r<this.state.hidemaps.length;r++)if(e===this.state.hidemaps[r].id){t=r;break}void 0!==t&&this.state.hidemaps.splice(t,1)},B._showHideMapElement=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.map,r=e.show,n=void 0!==r&&r;n?$(t.getTargetElement()).addClass("show"):$(t.getTargetElement()).removeClass("show")},B.createMapImage=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.map;t.background;return new Promise(function(t,n){try{var i=e.getMapCanvas(r);navigator.msSaveBlob?t(i.msToBlob()):i.toBlob(function(e){return t(e)})}catch(a){n(a)}})},B.getApplicationAttribution=function(){var e=this.config.group,t=e.header_terms_of_use_link,r=e.header_terms_of_use_text;return!!r&&(t?'<a href="'+t+'">'+r+"</a>":'<span class="skin-color" style="font-weight: bold">'+r+"</span>")},B.slaveOf=function(e,t){t=t||!1},B.setLayersExtraParams=function(e,t){this.layersExtraParams=_.assign(this.layersExtraParams,e),this.emit("extraParamsSet",e,t)},B.getProject=function(){return this.project},B.getMap=function(){try{return this.viewer.map}catch(e){}},B.getMapCanvas=function(e){var t=e?e.getViewport():$("#"+this.maps_container+" .g3w-map").last().children(".ol-viewport")[0];return $(t).children("canvas")[0]},B.getProjection=function(){return this.project.getProjection()},B.isMapHidden=function(){return this.state.hidden},B.isAxisOrientationInverted=function(){return"neu"===this.getProjection().getAxisOrientation()},B.getCrs=function(){return this.getProjection().getCode()},B.getViewerElement=function(){return this.viewer.map.getTargetElement()},B.getViewport=function(){return this.viewer.map.getViewport()},B.getResolution=function(){return this.viewer.map.getView().getResolution()},B.getEpsg=function(){return this.viewer.map.getView().getProjection().getCode()},B.getGetFeatureInfoUrlForLayer=function(e,t,r,n,i){var a=this.getMapLayerForLayer(e);return a.getGetFeatureInfoUrl(t,r,n,i)},B.showMarker=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this._marker.setPosition(e),setTimeout(function(){return t._marker.setPosition()},r)},B.getLayerByName=function(e){return this.getMap().getLayers().getArray().find(function(t){return t.get("name")===e})},B.getLayerById=function(e){return this.getMap().getLayers().getArray().find(function(t){return t.get("id")===e})},B.getVectorLayerFeaturesFromCoordinates=function(e,t){var r=void 0,n=[],i=this.getMap(),a=this.getLayerById(e);if(Array.isArray(t)){if(2===t.length){var o=i.getPixelFromCoordinate(t);i.forEachFeatureAtPixel(o,function(e){return n.push(e)},{layerFilter:function(e){
return e===a}})}else if(4===t.length)switch(r=ol.geom.Polygon.fromExtent(t),a.constructor){case q:n=a.getIntersectedFeatures(r);break;case ol.layer.Vector:a.getSource().getFeatures().forEach(function(e){r.intersectsExtent(e.getGeometry().getExtent())&&n.push(e)})}}else if(t instanceof ol.geom.Polygon||t instanceof ol.geom.MultiPolygon)switch(r=t,a.constructor){case q:n=a.getIntersectedFeatures(r);break;case ol.layer.Vector:a.getSource().getFeatures().forEach(function(e){r.intersectsExtent(e.getGeometry().getExtent())&&n.push(e)})}return n},B.getQueryLayerByCoordinates=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,r=e.coordinates,n=this.getProjection(),i=this.getResolution();return new Promise(function(e,a){t.query({coordinates:r,mapProjection:n,resolution:i}).then(function(t){return e(t)}).fail(function(e){return a(e)})})},B.getQueryLayerPromiseByCoordinates=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.layer,n=t.coordinates;return new Promise(function(t,i){var a=e.getProjection(),o=e.getResolution();r.query({coordinates:n,mapProjection:a,resolution:o}).then(function(e){t(e)}).fail(function(e){i(e)})})},B.activeMapControl=function(e){var t=this._mapControls.find(function(t){return t.type===e}),r=t.control;r.isToggled()?null:r.toggle()},B.createMapControl=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.id,n=t.add,i=void 0===n||n,a=t.toggled,o=void 0!==a&&a,l=t.visible,u=t.options,c=void 0===u?{}:u;r=r||e;var d=D.create(s({type:e,toggled:o},c));return l=void 0===l?!d.isVisible||d.isVisible():l,d&&this.addControl(r,e,d,i,l),d},B.addScaleLineUnits=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach(function(t){return e.state.mapunits.push(t)})},B.changeScaleLineUnit=function(e){var t=this.getMapControlByType({type:"scaleline"});t&&t.getOlControl().setUnits(e)},B.showAddLayerModal=function(){this.emit("addexternallayer")},B._checkMapControls=function(){this._changeMapMapControls.forEach(function(e){var t=e.control,r=e.getLayers,n=r();t.change(n)})},B._setupControls=function(){var e=this,t=M({BASELAYER:!0});if(this.getMapLayers().forEach(function(t){return t.getSource().setAttributions(e.getApplicationAttribution())}),this.getApplicationAttribution()||t.length){var r=new ol.control.Attribution({collapsible:!1,target:"map_footer_left"});this.getMap().addControl(r)}if(this.config&&this.config.mapcontrols){var n=this.config.mapcontrols,o=this.project.getQueryFeatureCount(),s=this.project.getQueryPointTolerance(),l=this.getMap();return n.forEach(function(t){var r=void 0,n="String"===b(t)?t:t.name;switch(n){case"reset":isMobile.any||(r=D.create({type:n})),e.addControl(n,r,!1);break;case"zoom":r=e.createMapControl(n,{options:{zoomInLabel:"",zoomOutLabel:""}});break;case"zoombox":isMobile.any||(r=e.createMapControl(n,{}),r.on("zoomend",function(t){e.viewer.fit(t.extent)}));break;case"zoomtoextent":r=e.createMapControl(n,{options:{label:"",extent:e.project.state.initextent}});break;case"mouseposition":if(!isMobile.any){var u="m"===e.getProjection().getUnits()?["X","Y"]:["Lng","Lat"],c=e.getCrs();if(r=e.createMapControl(n,{add:!1,options:{coordinateFormat:function(e){return ol.coordinate.format(e,""+u[0]+": {x}, "+u[1]+": {y} ["+c+"]",4)},undefinedHTML:!1,projection:e.getCrs()}}),"EPSG:4326"!==e.getEpsg()){var d=e.getEpsg(),f=["Lng","Lat"],h=e.getCrs();r=e.createMapControl(n,{add:!1,options:{target:"mouse-position-control-epsg-4326",coordinateFormat:function(e){return e=ol.proj.transform(e,d,"EPSG:4326"),ol.coordinate.format(e,""+f[0]+": {x}, "+f[1]+": {y} ["+h+"]",4)},undefinedHTML:!1,projection:e.getCrs()}})}}break;case"screenshot":case"geoscreenshot":if(!isMobile.any){r=e.createMapControl(n,{options:{layers:O.getLayers(),onclick:function(){function t(){return r.apply(this,arguments)}var r=a(regeneratorRuntime.mark(function i(){var t,r,a,o,s,l;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=P.setDownload(!0),i.prev=1,i.next=4,e.createMapImage();case 4:if(r=i.sent,"screenshot"!==n){i.next=9;break}saveAs(r,"map_"+Date.now()+".png"),i.next=22;break;case 9:return a="/"+e.project.getType()+"/api/asgeotiff/"+e.project.getId()+"/",o=e.getMapBBOX().toString(),s=e.getCookie("csrftoken"),i.prev=12,i.next=15,T({url:a,params:{image:r,csrfmiddlewaretoken:s,bbox:o},method:"POST"});case 15:l=i.sent,saveAs(l,"map_"+Date.now()+".tif"),i.next=22;break;case 19:i.prev=19,i.t0=i["catch"](12);case 22:i.next=27;break;case 24:i.prev=24,i.t1=i["catch"](1),I.showUserMessage({type:"alert",message:p("mapcontrols.screenshot.error"),autoclose:!0});case 27:return P.setDownload(!1,t),i.abrupt("return",!0);case 29:case"end":return i.stop()}},i,e,[[1,24],[12,19]])}));return t}()}});var v={control:r,getLayers:function(){return e.getMapLayers()}};e._changeMapMapControls.push(v)}break;case"scale":r=e.createMapControl(n,{add:!1,options:{coordinateFormat:ol.coordinate.createStringXY(4),projection:e.getCrs(),isMobile:isMobile.any}});break;case"query":r=e.createMapControl(n,{add:!0,toggled:!0});var g=y(function(){var t=a(regeneratorRuntime.mark(function r(t){var i,a,l,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=t.coordinates,I.closeOpenSideBarComponent(),r.prev=2,r.next=5,E.getData("query:coordinates",{inputs:{coordinates:i,feature_count:o,query_point_tolerance:s,multilayers:e.project.isQueryMultiLayers(n)}});case 5:a=r.sent,l=a.data,u=void 0===l?[]:l,u.length&&e.showMarker(i),r.next=13;break;case 11:r.prev=11,r.t0=r["catch"](2);case 13:case"end":return r.stop()}},r,e,[[2,11]])}));return function(e){return t.apply(this,arguments)}}()),m=r.on("picked",g);r.setEventKey({eventType:"picked",eventKey:m});break;case"querybypolygon":if(!isMobile.any){var _={filtrable:{ows:"WFS"}},w=function(){var t=M({QUERYABLE:!0,SELECTEDORALL:!0}),r=e.filterableLayersAvailable({FILTERABLE:!0,SELECTEDORALL:!0},_);return r.length?[].concat(i(new Set([].concat(i(r),i(t))))):[]},x="intersects";if(r=e.createMapControl(n,{options:{spatialMethod:x,layers:w(),help:{title:"sdk.mapcontrols.querybypolygon.help.title",message:"sdk.mapcontrols.querybypolygon.help.message"}}})){var S={control:r,getLayers:w};e._changeMapMapControls.push(S);var C=y(function(){var t=a(regeneratorRuntime.mark(function i(t){var a,s,u,c,d,p,f,h,v;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return I.closeOpenSideBarComponent(),a=t.coordinates,i.prev=2,i.next=5,E.getData("query:coordinates",{inputs:{feature_count:o,coordinates:a},outputs:{show:function g(e){var t=e.data,r=void 0===t?[]:t,n=e.query,g=0===r.length;return n.coordinates=g?n.coordinates:null,g}}});case 5:if(s=i.sent,u=s.data,c=void 0===u?[]:u,!c.length||!c[0].features.length){i.next=17;break}return d=c[0].features[0],p=[c[0].layer],i.next=13,E.getData("query:polygon",{inputs:{excludeLayers:p,feature:d,filterConfig:{spatialMethod:r.getSpatialMethod()},multilayers:e.project.isQueryMultiLayers(n)},outputs:{show:function(e){var t=e.error,r=void 0!==t&&t;return!r}}});case 13:f=i.sent,h=f.data,v=void 0===h?[]:h,v.length&&l.getView().setCenter(a);case 17:i.next=22;break;case 19:i.prev=19,i.t0=i["catch"](2);case 22:case"end":return i.stop()}},i,e,[[2,19]])}));return function(e){return t.apply(this,arguments)}}()),L=r.on("picked",C);r.setEventKey({eventType:"picked",eventKey:L})}}break;case"querybbox":if(!isMobile.any){var k={filtrable:{ows:"WFS"}},R=function(){var t=e.filterableLayersAvailable(k)||[];return t.forEach(function(e){return e.setTocHighlightable(!0)}),t},j=R(),A="intersects";if(r=e.createMapControl(n,{options:{spatialMethod:A,layers:j,help:{title:"sdk.mapcontrols.querybybbox.help.title",message:"sdk.mapcontrols.querybybbox.help.message"}}})){var N={control:r,getLayers:R};e._changeMapMapControls.push(N);var G={SELECTEDORALL:!0,FILTERABLE:!0,VISIBLE:!0},U=y(function(){var t=a(regeneratorRuntime.mark(function i(t){var a,s,l,u,c;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return I.closeOpenSideBarComponent(),a=t.extent,i.prev=2,i.next=5,E.getData("query:bbox",{inputs:{bbox:a,feature_count:o,layersFilterObject:G,filterConfig:{spatialMethod:r.getSpatialMethod()},condition:k,multilayers:e.project.isQueryMultiLayers(n)}});case 5:s=i.sent,l=s.data,u=void 0===l?[]:l,u.length&&(c=ol.extent.getCenter(a),e.getMap().getView().setCenter(c)),i.next=14;break;case 11:i.prev=11,i.t0=i["catch"](2);case 14:case"end":return i.stop()}},i,e,[[2,11]])}));return function(e){return t.apply(this,arguments)}}()),q=r.on("bboxend",U);r.setEventKey({eventType:"bboxend",eventKey:q})}}break;case"streetview":var B=!1,z=new V;r=e.createMapControl(n,{}),z.init().then(function(){r.setProjection(e.getProjection()),e.viewer.map.addLayer(r.getLayer());var t={lat:null,lng:null},n=function(){r.clearMarker(),B=!1};z.onafter("postRender",function(e){return r.setPosition(e)}),r&&(e._setMapControlVisible({control:r,visible:!0}),r.on("picked",y(function(r){I.off("closecontent",n),B=!0;var i=r.coordinates,a=ol.proj.transform(i,e.getProjection().getCode(),"EPSG:4326");t.lat=a[1],t.lng=a[0],z.showStreetView(t),I.on("closecontent",n)})),r.on("disabled",function(){B&&I.closeContent(),I.off("closecontent",n)}))})["catch"](function(){return e.removeControl(n)});break;case"scaleline":r=e.createMapControl(n,{add:!1,options:{position:"br"}});break;case"overview":if(!isMobile.any){if(!e.config.overviewproject)return;var W=e.config.overviewproject.gid;W&&F.getProject(W).then(function(t){var i=e.getOverviewMapLayers(t),a=e._calculateViewOptions({width:200,height:150,project:t}),o=new ol.View(a),s=e.getMap().getView();o.on("change:center",function(){var e=this.getCenter(),t=s.constrainCenter(e);t[0]!==e[0]||t[1]!==e[1]&&o.setCenter(t)}),r=e.createMapControl(n,{add:!1,options:{position:"bl",className:"ol-overviewmap ol-custom-overviewmap",collapseLabel:$('<span class="'+I.getFontClass("arrow-left")+'"></span>')[0],label:$('<span class="'+I.getFontClass("arrow-right")+'"></span>')[0],collapsed:!1,layers:i,view:o}})})}break;case"geocoding":case"nominatim":var H=e.project.state,Y=H.extent,K=H.crs.epsg;r=e.createMapControl(n,{add:!1,options:{isMobile:isMobile.any,bbox:Y,mapCrs:K,placeholder:"mapcontrols.nominatim.placeholder",noresults:"mapcontrols.nominatim.noresults",notresponseserver:"mapcontrols.nominatim.notresponseserver"}});break;case"geolocation":r=e.createMapControl(n),r.on("click",y(function(t){return e.showMarker(t.coordinates)})),r.on("error",function(e){I.showUserMessage({type:"warning",message:"mapcontrols.geolocations.error",autoclose:!0})});break;case"addlayers":isMobile.any||(r=e.createMapControl(n,{}),r.on("addlayer",function(){return e.emit("addexternallayer")}));break;case"length":isMobile.any||(r=e.createMapControl(n,{options:{tipLabel:"sdk.mapcontrols.measures.length.tooltip",interactionClassOptions:{projection:e.getProjection(),help:"sdk.mapcontrols.measures.length.help"}}}));break;case"area":isMobile.any||(r=e.createMapControl(n,{options:{tipLabel:"sdk.mapcontrols.measures.area.tooltip",interactionClassOptions:{projection:e.getProjection(),help:"sdk.mapcontrols.measures.area.help"}}}))}}),this.getMapControls()}},B.setZIndexLayer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,r=e.zindex,n=void 0===r?map.getLayers().getLength():r;t&&t.setZIndex(n)},B.getLayerZindex=function(e){return e&&e.getZIndex()},B.getCenter=function(){var e=this.getMap();return e.getView().getCenter()},B.zoomToFid=a(regeneratorRuntime.mark(function W(){var e,t,r,n,i,a,o,s,u,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"|";return regeneratorRuntime.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(e=c.split(d),t=l(e,2),r=t[0],n=t[1],void 0===r||void 0===n){p.next=10;break}return i=this.project.getLayerById(r),p.next=5,E.getData("search:fids",{inputs:{layer:i,fids:[n]},outputs:{show:{loading:!1,condition:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data,r=void 0===t?[]:t;return r[0]&&r[0].features.length>0}}}});case 5:a=p.sent,o=a.data,s=void 0===o?[]:o,u=s[0]&&s[0].features[0],u&&this.zoomToFeatures([u]);case 10:case"end":return p.stop()}},W,this)})),B.handleZoomToFeaturesUrlParameter=a(regeneratorRuntime.mark(function H(){var e,t,r,n,i,a,o,s,u,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},d=c.zoom_to_features,p=void 0===d?"":d,f=c.search_endpoint,h=void 0===f?"api":f;return regeneratorRuntime.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(c.prev=0,e=p.split(":"),t=l(e,2),r=t[0],n=t[1],!r||!n){c.next=12;break}if(i=this.project.getLayers().find(function(e){return e.id===r||e.name===r||e.origname===r}),!i){c.next=12;break}return a=this.project.getLayerById(i.id),o=w({layer:a,search_endpoint:h,filter:n}),c.next=9,E.getData("search:features",{inputs:{layer:a,filter:o,search_endpoint:h},outputs:{show:{loading:!1}}});case 9:s=c.sent,u=s.data,u&&u[0]&&u[0].features&&this.zoomToFeatures(u[0].features);case 12:c.next=17;break;case 14:c.prev=14,c.t0=c["catch"](0);case 17:case"end":return c.stop()}},H,this,[[0,14]])})),B.getMapExtent=function(){var e=this.getMap();return e.getView().calculateExtent(e.getSize())},B.addMapExtentUrlParameterToUrl=function(e){e=new URL(e);var t=this.getMapExtent().toString();return e.searchParams.set("map_extent",t),e.toString()},B.getMapExtentUrl=function(){var e=new URL(location.href),t=this.getMapExtent().toString();return e.searchParams.set("map_extent",t),e.toString()},B.createCopyMapExtentUrl=function(){var e=this.getMapExtentUrl();g(e)},B._setMapControlsGrid=function(e){var t=this.state.mapControl.grid;if(e<2){var r=t[t.length-1];return void t.push({rows:2*r.rows,columns:2})}if(2===e)if(t.length){var n=t[t.length-1];t.push({rows:n.columns,columns:n.rows})}else t.push({rows:1,columns:2});else if(3===e){var i=t[t.length-1];t.push({rows:2*i.rows,columns:e})}else{t.push({rows:t.length+1+(Number.isInteger(e)?0:1),columns:Number.isInteger(e)?e:parseInt(e)+1});var a=Number.isInteger(e)?e:parseInt(e);this._setMapControlsGrid(a/2)}},B._setMapControlsInsideContainerLenght=function(){var e=this;this.state.mapControl.length=1,this._mapControls.forEach(function(t){var r=e.getMap();e.state.mapControl.length+=t.mapcontrol?"zoom"===t.id?2:1:0,t.control.changelayout?t.control.changelayout(r):null}),this.state.mapControl.length+=this.state.mapControl.length%2,this.state.mapControl.grid=[],this._setMapControlsGrid(this.state.mapControl.length)},B.filterableLayersAvailable=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=M({FILTERABLE:!0,SELECTEDORALL:!0},e);return t.filter(function(e){return e.getProvider("filter")instanceof R})},B.setMapControlsAlignement=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"rv";this.state.mapcontrolsalignement=e},B.getMapControlsAlignement=function(){return this.state.mapcontrolsalignement},B.isMapControlsVerticalAlignement=function(){return this.state.mapcontrolsalignement.indexOf("v")!==-1},B.setMapControlsVerticalAlignement=function(){this.state.mapcontrolsalignement=this.state.mapcontrolsalignement[0]+"v"},B.setMapControlsHorizontalAlignement=function(){this.state.mapcontrolsalignement=this.state.mapcontrolsalignement[0]+"h"},B.flipControlsHorizontally=function(){this.state.mapcontrolsalignement="r"===this.state.mapcontrolsalignement[0]?"l"+this.state.mapcontrolsalignement[1]:"r"+this.state.mapcontrolsalignement[1]},B.flipMapControlsVertically=function(){this.state.mapcontrolsalignment="v"===this.state.mapcontrolsalignement[1]?this.state.mapcontrolsalignement[0]+"h":this.state.mapcontrolsalignement[0]+"v"},B.setMapControlsContainer=function(e){this.state.mapcontrolDOM=e},B._updateMapControlsLayout=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.width,n=t.height;if(0==r||0==n?this.state.mapcontrolDOM.css("z-index",0):this.state.mapcontrolDOM.css("z-index",100),this.state.mapcontrolready&&this.state.mapControl.update){var i={changed:!1,space:!1};if(this._mapControls.forEach(function(t){var r=e.getMap();t.control.changelayout?t.control.changelayout(r):null}),this.isMapControlsVerticalAlignement()){var a=function o(){var t=e.state.mapControl.grid[e.state.mapControl.currentIndex].columns*e.state.mapcontrolSizes.minWidth,r=$(".ol-control-b"+e.getMapControlsAlignement()[0]),a=r.length?$(r[r.length-1]).position().top:n,s=a>0?a-t:n-t;if(s<10)e.state.mapControl.currentIndex=e.state.mapControl.currentIndex===e.state.mapControl.grid.length-1?e.state.mapControl.currentIndex:e.state.mapControl.currentIndex+1,i.changed=!0;else{var l=e.state.mapControl.currentIndex>0?e.state.mapControl.grid[e.state.mapControl.currentIndex-1].columns*e.state.mapcontrolSizes.minWidth-t:t;s>l&&(i.changed=!0,i.space=!0,e.state.mapControl.currentIndex=0===e.state.mapControl.currentIndex?e.state.mapControl.currentIndex:e.state.mapControl.currentIndex-1)}if(i.changed){var u=e.state.mapControl.grid[e.state.mapControl.currentIndex].columns*e.state.mapcontrolSizes.minWidth,c=e.state.mapControl.grid[e.state.mapControl.currentIndex].rows*e.state.mapcontrolSizes.minWidth;e.state.mapcontrolDOM.css("height",u+"px"),e.state.mapcontrolDOM.css("width",c+"px"),i.changed=!1,i.space&&setTimeout(function(){return o()})}};a()}else isMobile.any&&this.setMapControlsAlignement("rv")}},B._setMapControlVisible=function(e){var t=e.control,r=e.visible,n=void 0===r||r;t&&t.setVisible(n)},B._addControlToMapControls=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.element;t||(e.element.style.display="none"),$(".g3w-map-controls").append(r)},B.getMapControlByType=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=this._mapControls.find(function(e){return t===e.type});return r&&r.control},B.addControl=function(e,t,r){var n=this,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.state.mapcontrolready=!1,this.viewer.map.addControl(r),r.on("toggled",function(e){return n.emit("mapcontrol:toggled",e)}),this._mapControls.push({id:e,type:t,control:r,visible:a,mapcontrol:i&&a}),r.on("controlclick",function(e){var t=e.target,r={clickmap:t.isClickMap&&t.isClickMap()||!1};r.clickmap&&n._externalInteractions.forEach(function(e){return e.setActive(!1)}),n.controlClick(t,r)});var o=$(r.element).find("button");if(o.tooltip({placement:"bottom",trigger:I.isMobile()?"click":"hover"}),I.isMobile()&&o.on("shown.bs.tooltip",function(){var e=this;setTimeout(function(){return $(e).tooltip("hide")},600)}),i)this._addControlToMapControls(r,a);else{var s=$("#"+this.getMap().getTarget());this._updateMapControlsLayout({width:s.width(),height:s.height()})}U.registerControl(t,r),this._setMapControlsInsideContainerLenght(),this.state.mapcontrolready=!0},B.showControl=function(e){this.showControls([e])},B.hideControl=function(e){this.hideControls([e])},B.showControls=function(e){this.toggleControls(!0,e)},B.hideControls=function(e){this.toggleControls(!1,e)},B.showAllControls=function(){this.toggleControls(!0)},B.hideAllControls=function(){this.toggleControls(!1)},B.toggleControls=function(e,t){this._removeControls(),this._mapControls.forEach(function(r){t?t.indexOf(r.type)>-1&&(r.visible=e):r.visible=e}),this._layoutControls()},B._layoutControls=function(){var e=this;this._mapControls.forEach(function(t){t.visible&&e.viewer.map.addControl(t.control)})},B.getMapControls=function(){return this._mapControls},B.removeControlById=function(e){var t=this;this._mapControls.find(function(r,n){if(e===r.id){t._mapControls.splice(n,1);var i=r.control;return t.viewer.map.removeControl(i),i.hideControl&&i.hideControl(),!0}})},B.removeControl=function(e){var t=this;this._mapControls.find(function(r,n){if(e===r.type){t._mapControls.splice(n,1);var i=r.control;return t.viewer.map.removeControl(i),i.hideControl&&i.hideControl(),!0}})},B._removeControls=function(){var e=this;this._mapControls.forEach(function(t){return e.viewer.map.removeControl(t.control)})},B._unToggleControls=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.close,r=void 0===t||t;this._mapControls.forEach(function(e){e.control.isToggled&&e.control.isToggled()&&(e.control.toggle(!1),r&&I.closeContent())})},B.deactiveMapControls=function(){this._unToggleControls({close:!1})},B.disableClickMapControls=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._mapControls.forEach(function(t){var r=t.control,n=!!r.isClickMap&&r.isClickMap();n&&(r.isToggled()&&r.toggle(),r[e?"disable":"enable"]())})},B.addMapLayers=function(e){var t=this;e.reverse().forEach(function(e){return t.addMapLayer(e)})},B._setupCustomMapParamsToLegendUrl=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(e){var t=this.getMap(),r=t&&t.getSize().filter(function(e){return e>0})||null,n=r&&2===r.length?t.getView().calculateExtent(r):this.project.state.initextent;n="neu"===t.getView().getProjection().getAxisOrientation()?[n[1],n[0],n[3],n[2]]:n;var i=this.getEpsg();this.getMapLayers().forEach(function(e){e.setupCustomMapParamsToLegendUrl&&e.setupCustomMapParamsToLegendUrl({crs:i,bbox:n})})}this.emit("change-map-legend-params")},B.addMapLayer=function(e){this._mapLayers.push(e),this.addLayerToMap(e)},B.getMapLayerByLayerId=function(e){return this.getMapLayers().find(function(t){return t.getLayerConfigs().find(function(t){return t.getId()===e})})},B.getMapLayers=function(){return this._mapLayers},B.getBaseLayers=function(){return this.mapBaseLayers},B.getMapLayerForLayer=function(e){var t="layer_"+e.getMultiLayerId(),r=this.getMapLayers(),n=r.find(function(e){return e.getId()===t});return n},B.getProjectLayer=function(e){return O.getLayerById(e)},B._setSettings=function(){var e=u.MAP_SETTINGS.ZOOM,t=this.getScaleFromExtent(this.project.state.initextent);e.maxScale=e.maxScale>t?t:e.maxScale},B._resetView=function(){var e=this.viewer.map.getSize(),t=l(e,2),r=t[0],n=t[1],i=this.project.state.extent,a=ol.extent.getWidth(i)/r,o=ol.extent.getHeight(i)/n,s=Math.max(a,o)>this.viewer.map.getView().getMaxResolution()?Math.max(a,o):this.viewer.map.getView().getMaxResolution(),u=new ol.View({extent:i,projection:this.viewer.map.getView().getProjection(),center:this.viewer.map.getView().getCenter(),resolution:this.viewer.map.getView().getResolution(),maxResolution:s});this._setSettings(),this.viewer.map.setView(u)},B._calculateViewOptions=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.project,n=t.width,i=t.height,a=new URLSearchParams(location.search),o=a.get("map_extent"),s=a.get("zoom_to_fid"),l=a.get("ztf"),u=a.get("lat")&&a.get("lon")&&{lat:1*a.get("lat"),lon:1*a.get("lon")},c=a.get("x")&&a.get("y")&&{x:1*a.get("x"),y:1*a.get("y")};s?this.zoomToFid(s):l?this.handleZoomToFeaturesUrlParameter({zoom_to_features:l}):!u||Number.isNaN(u.lat)||Number.isNaN(u.lon)?!c||Number.isNaN(c.x)||Number.isNaN(c.y)||setTimeout(function(){var t=new ol.geom.Point([c.x,c.y]);e.zoomToGeometry(t)}):setTimeout(function(){var t=new ol.geom.Point(ol.proj.transform([u.lon,u.lat],"EPSG:4326",e.getEpsg()));t.getExtent()&&e.zoomToGeometry(t)});var d=o?o.split(",").map(function(e){return 1*e}):r.state.initextent,p=this.getProjection(),f=r.state.extent,h=ol.extent.getWidth(f)/n,v=ol.extent.getHeight(f)/i,g=Math.max(h,v),m=ol.extent.getWidth(d)/n,y=ol.extent.getHeight(d)/i,_=Math.max(m,y),b=ol.extent.getCenter(d);return{projection:p,center:b,extent:f,maxResolution:g,resolution:_}},B._setupViewer=function(e,t){var r=this;this.viewer=j.createViewer({id:this.target,view:this._calculateViewOptions({width:e,height:t,project:this.project})}),this._setSettings(),this.state.size=this.viewer.map.getSize(),this.state.mapUnits=this.viewer.map.getView().getProjection().getUnits(),this.config.background_color&&$("#"+this.target).css("background-color",this.config.background_color),$(this.viewer.map.getViewport()).prepend('<div id="map-spinner" style="position:absolute; top: 50%; right: 50%"></div>'),this.viewer.map.getInteractions().forEach(function(e){return r._watchInteraction(e)}),this.viewer.map.getInteractions().on("add",function(e){return r._watchInteraction(e.element)}),this.viewer.map.getInteractions().on("remove",function(e){}),this._marker=new ol.Overlay({position:null,positioning:"center-center",element:document.getElementById("marker"),stopEvent:!1}),this.viewer.map.addOverlay(this._marker),this.viewer.map.getLayers().on("add",function(e){var t=e.element,n=t.get("basemap"),i=t.get("position"),a=n&&0;i&&"bottom"===i&&(a=1),r.setLayerZIndex({layer:t,zindex:a})}),this.viewer.map.getLayers().on("remove",function(e){var t=e.element,n=t.getZIndex();n===r.layersCount&&(r.layersCount-=1)})},B.getMapUnits=function(){return this.state.mapUnits},B._removeListeners=function(){this._setBaseLayerListenerKey&&this.project.un("setBaseLayer",this._setBaseLayerListenerKey)},B._removeEventsKeysToLayersStore=function(e){var t=e.getId();this._layersStoresEventKeys[t]&&(this._layersStoresEventKeys[t].forEach(function(t){Object.entries(t).forEach(function(t){var r=l(t,2),n=r[0],i=r[1];return e.un(n,i)})}),delete this._layersStoresEventKeys[t])},B._setUpEventsKeysToLayersStore=function(e){var t=this,r=e.getId();this._layersStoresEventKeys[r]=[];var n=e.onafter("addLayer",function(e){if("vector"===e.getType()){var r=e.getMapLayer();t.addLayerToMap(r)}});this._layersStoresEventKeys[r].push({addLayer:n});var i=e.onafter("removeLayer",function(e){if("vector"===e.getType()){var r=e.getOLLayer();t.viewer.map.removeLayer(r)}});this._layersStoresEventKeys[r].push({removeLayer:i})},B._setupListeners=function(){var e=this;this._setBaseLayerListenerKey=this.project.onafter("setBaseLayer",function(){e.updateMapLayers()})},B._setupAllLayers=function(){this._setupBaseLayers(),this._setupMapLayers(),this._setupVectorLayers(),this._setUpDefaultLayers()},B._setupBaseLayers=function(){var e=this,t=M({BASELAYER:!0});if(t.length){t.forEach(function(t){var r=t.getMapLayer();e.registerMapLayerListeners(r),e.mapBaseLayers[t.getId()]=r});var r=Object.values(this.mapBaseLayers).reverse();r.forEach(function(t){t.update(e.state,e.layersExtraParams),e.addLayerToMap(t)})}},B._setupMapLayers=function(){var e=this,t=M({BASELAYER:!1,VECTORLAYER:!1});this._setMapProjectionToLayers(t);var r={},n=_.groupBy(t,function(e){var t=e.getMultiLayerId();return e.isQtimeseries()?(r[t]=void 0===r[t]?0:r[t]+1,t=t+"_"+r[t]):t=void 0===r[t]?t:t+"_"+(r[t]+1),t});r=null;var i=[];return Object.entries(n).forEach(function(t){var r=l(t,2),n=r[0],a=r[1],o="layer_"+n,s=void 0,u=a[0]||[];1===a.length?(s=u.getMapLayer({id:o,projection:e.getProjection()},{}),s.addLayer(u),i.push(s)):(s=u.getMapLayer({id:o,projection:e.getProjection()},e.layersExtraParams),a.reverse().forEach(function(e){return s.addLayer(e)}),i.push(s)),e.registerMapLayerListeners(s)}),this.addMapLayers(i),this.updateMapLayers(),i},B._setupVectorLayers=function(){var e=this,t=M({VECTORLAYER:!0});this._setMapProjectionToLayers(t),t.forEach(function(t){var r=t.getMapLayer();e.addLayerToMap(r)})},B._setUpDefaultLayers=function(){this.getMap().addLayer(this.defaultsLayers.highlightLayer),this.getMap().addLayer(this.defaultsLayers.selectionLayer)},B.removeDefaultLayers=function(){this.defaultsLayers.highlightLayer.getSource().clear(),this.defaultsLayers.selectionLayer.getSource().clear(),this.getMap().removeLayer(this.defaultsLayers.highlightLayer),this.getMap().removeLayer(this.defaultsLayers.selectionLayer)},B.setDefaultLayerStyle=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e&&this.defaultsLayers[e]&&(this.defaultsLayers._style[e]=t)},B.resetDefaultLayerStyle=function(e){arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e&&this.defaultsLayers[e]&&(this.defaultsLayers._style[e]={color:"highlightLayer"===e?void 0:"red"})},B.removeLayers=function(){this._removeBaseLayers(),this._removeMapLayers(),this.removeExternalLayers(),this.removeDefaultLayers()},B.removeAllLayers=function(){this.viewer.removeLayers()},B.setLayerZIndex=function(e){var t=e.layer,r=e.zindex,n=void 0===r?this.layersCount+=1:r;t.setZIndex(n)},B.addLayerToMap=function(e){var t=e.getOLLayer();t&&this.getMap().addLayer(t)},B._setMapProjectionToLayers=function(e){var t=this;e.forEach(function(e){return e.setMapProjection(t.getProjection())})},B.createMapLayer=function(e){e.setMapProjection(this.getProjection());var t="layer_"+e.getMultiLayerId(),r=e.getMapLayer({id:t,projection:this.getProjection()},this.layersExtraParams);return r.addLayer(e),r},B.getOverviewMapLayers=function(t){var r=e("core/layers/map/wmslayer"),n=t.getLayersStore().getLayers({GEOLAYER:!0,BASELAYER:!1}),i=_.groupBy(n,function(e){return e.getMultiLayerId()}),a=[];return Object.entries(i).forEach(function(e){var n=l(e,2),i=n[0],o=n[1],s="overview_layer_"+i,u=o[0].state.tiled,c={url:t.getWmsUrl(),id:s,tiled:u},d=new r(c);o.reverse().forEach(function(e){return d.addLayer(e)}),a.push(d.getOLLayer(!0))}),a.reverse()},B.updateMapLayer=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{force:!1},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.showSpinner,i=void 0===n||n;return t.force&&(t.g3w_time=Date.now()),i!==e.showSpinnerWhenLoading&&(e.showSpinnerWhenLoading=i,this[i?"registerMapLayerLoadingEvents":"unregisterMapLayerLoadingEvents"](e)),e.update(this.state,t),e},B.updateMapLayers=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.getMapLayers().forEach(function(r){return e.updateMapLayer(r,t)});var r=this.getBaseLayers();Object.values(r).forEach(function(t){return t.update(e.state,e.layersExtraParams)})},B.registerMapLayerListeners=function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.registerMapLayerLoadingEvents(e),r&&e.layers&&Array.isArray(e.layers)&&e.layers.forEach(function(r){r.onbefore("change",function(){return t.updateMapLayer(e,{force:!0})}),r.on("filtertokenchange",function(){return t.updateMapLayer(e,{force:!0})})})},B.registerMapLayerLoadingEvents=function(e){e.on("loadstart",this._incrementLoaders),e.on("loadend",this._decrementLoaders),e.on("loaderror",this._mapLayerLoadError)},B.unregisterMapLayerLoadingEvents=function(e){e.off("loadstart",this._incrementLoaders),e.off("loadend",this._decrementLoaders),e.off("loaderror",this._mapLayerLoadError)},B.unregisterMapLayerListeners=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.unregisterMapLayerLoadingEvents(e),t&&e.layers&&Array.isArray(e.layers)&&e.layers.forEach(function(e){e.un("change"),e.removeEvent("filtertokenchange")})},B.setTarget=function(e){this.target=e},B.getCurrentToggledMapControl=function(){var e=this._mapControls.find(function(e){var t=e.control;return t&&t.isToggled&&t.isToggled()});return e&&e.control},B.addInteraction=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{active:!0,close:!0},r=t.active,n=void 0===r||r,i=this.getCurrentToggledMapControl(),a=i&&i.isToggled&&i.isToggled()||!1,o=!i||!i.isClickMap||i.isClickMap();return o&&n&&this._unToggleControls(t),this.getMap().addInteraction(e),e.setActive(n),this._externalInteractions.push(e),{control:i,toggled:a}},B.removeInteraction=function(e){e&&e.setActive(!1),this.viewer.map.removeInteraction(e),this._externalInteractions=this._externalInteractions.filter(function(t){return e!==t})},B._watchInteraction=function(e){var t=this;e.on("change:active",function(e){e.target instanceof ol.interaction.Pointer&&e.target.getActive()&&t.emit("mapcontrol:active",e.target)})},B.showMapInfo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.info,r=e.style;this.state.map_info.info=t,this.state.map_info.style=r||this.state.map_info.style},B.hideMapInfo=function(){this.state.map_info.info=null,this.state.map_info.style=null;
},B.zoomTo=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;this.viewer.zoomTo(e,t)},B.goTo=function(e,t){var r={zoom:t||6};this.viewer.goTo(e,r)},B.goToRes=function(e,t){this.viewer.goToRes(e,{resolution:t})},B.getGeometryAndExtentFromFeatures=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=void 0,r=void 0,n=void 0,a=void 0,o=[],s=0;s<e.length;s++){var l=e[s],u=l.getGeometry?l.getGeometry():l.geometry;if(u){if(u instanceof ol.geom.Geometry){var c=[].concat(i(u.getExtent()));t=t?ol.extent.extend(t,c):c,r=r?r:u.getType(),a=u.getCoordinates(),r.includes("Multi")?o=[].concat(i(o),i(a)):o.push(a)}else{var d=l.bbox;t=t?ol.extent.extend(t,d):d,r=u.type,a=u.coordinates}r.includes("Multi")?o=[].concat(i(o),i(a)):o.push(a)}}try{var p=r.includes("Multi")?r:"Multi"+r;n=new ol.geom[p](o),void 0===t&&(t=n.getExtent())}catch(f){}return{extent:t,geometry:n}},B.highlightFeatures=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.getGeometryAndExtentFromFeatures(e),n=r.geometry;t.zoom=!1,this.highlightGeometry(n,t)},B.zoomToGeometry=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{highlight:!1},r=e&&e.getExtent(),n=t.highlight;n&&r&&(t.highLightGeometry=e),r&&this.zoomToExtent(r,t)},B.zoomToFeatures=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{highlight:!1},r=this.getGeometryAndExtentFromFeatures(e),n=r.geometry,i=r.extent,a=t.highlight;return a&&i&&(t.highLightGeometry=n),i&&this.zoomToExtent(i,t)||Promise.resolve()},B.zoomToExtent=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=ol.extent.getCenter(e),n=this.getResolutionForZoomToExtent(e);return this.goToRes(r,n),t.highLightGeometry&&this.highlightGeometry(t.highLightGeometry,{zoom:!1,duration:t.duration})||Promise.resolve()},B.zoomToProjectInitExtent=function(){this.zoomToExtent(this.project.state.initextent)},B.compareExtentWithProjectMaxExtent=function(e){var t=this.project.state.extent,r=ol.extent.containsExtent(t,e);return r?e:t},B.getResolutionForZoomToExtent=function(e){var t=void 0,r=u.MAP_SETTINGS.ZOOM,n=this.getMap(),i=this.project.state.extent,a=n.getView().getResolutionForExtent(i,n.getSize()),o=ol.extent.containsExtent(i,e),s=G(r.maxScale,this.getMapUnits());if(o){var l=n.getView().getResolution(),c=n.getView().getResolutionForExtent(e,n.getSize());t=c>s?c:s,t=l<t&&l>c?l:t}else t=a;return t},B.goToBBox=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getEpsg();e=t===this.getEpsg()?e:ol.proj.transformExtent(e,t,this.getEpsg()),this.viewer.fit(this.compareExtentWithProjectMaxExtent(e))},B.goToWGS84=function(e,t){e=ol.proj.transform(e,"EPSG:4326",this.project.state.crs.epsg),this.goTo(e,t)},B.extentToWGS84=function(e){return ol.proj.transformExtent(e,this.project.state.crs.epsg,"EPSG:4326")},B.getResolutionForMeters=function(e){var t=this.viewer.map.getViewport();return e/Math.max(t.clientWidth,t.clientHeight)};var z=!1;B.setSelectionFeatures=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"add",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.feature,n=t.color;n&&this.setDefaultLayerStyle("selectionLayer",{color:n});var i=this.defaultsLayers.selectionLayer.getSource();switch(e){case"add":i.addFeature(r);break;case"remove":i.removeFeature(r);break;case"update":var a=r.getId(),o=i.getFeatureById(a);o.setGeometry(r.getGeometry());break;case"clear":i.clear()}},B.clearSelectionFeatures=function(){this.defaultsLayers.selectionLayer.getSource().clear()},B.seSelectionLayerVisible=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.defaultsLayers.selectionLayer.setVisible(e)},B.highlightGeometry=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(n,i){var a=r.color;t.clearHighlightGeometry(),t.setDefaultLayerStyle("highlightLayer",{color:a});var o="boolean"!=typeof r.zoom||r.zoom,s=r.hide;s&&(s="function"==typeof s?s:null);var l=r.style,c=function(e){var t=[],r=e.getGeometry().getType(),n=k({geometryType:r,color:a,fill:!1});return t.push(n),t},d=u.MAP_SETTINGS.ANIMATION,p="boolean"!=typeof r.highlight||r.highlight,f=r.duration||d.duration,h=void 0;if(e instanceof ol.geom.Geometry)h=e;else{var v=new ol.format.GeoJSON;h=v.readGeometry(e)}if(o){var g=h.getExtent();t.zoomToExtent(g)}if(p){var m=new ol.Feature({geometry:h}),y=t.defaultsLayers.highlightLayer;if(l&&y.setStyle(l),y.getSource().addFeature(m),s){var _=function(){y.getSource().clear(),l&&y.setStyle(c),n()};s(_)}else f&&f!==1/0&&(z=!0,setTimeout(function(){y.getSource().clear(),l&&y.setStyle(c),z=!1,n()},f))}else n()})},B.clearHighlightGeometry=function(){!z&&this.defaultsLayers.highlightLayer.getSource().clear(),this.resetDefaultLayerStyle("highlightLayer")},B.refreshMap=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{force:!0};this.updateMapLayers(e)},B.layout=function(e){var t=e.width,r=e.height,n=t<=0||r<=0;this.viewer?n||(this.getMap().updateSize(),this.state.hidemaps.forEach(function(e){return e.map.updateSize()}),this._updateMapView()):(this.setupViewer(t,r),this.viewer&&(this.setupControls(),this.emit("ready"))),this.setHidden(n),this._mapControls.length&&this._updateMapControlsLayout({width:t,height:r})},B._removeBaseLayers=function(){var e=this;Object.keys(this.mapBaseLayers).forEach(function(t){e.viewer.map.removeLayer(e.mapBaseLayers[t].getOLLayer())})},B._removeMapLayers=function(){var e=this;this.getMapLayers().forEach(function(t){e.unregisterMapLayerListeners(t),e.viewer.map.removeLayer(t.getOLLayer())}),this._mapLayers=[]},B.getMapBBOX=function(){return this.viewer.getBBOX()},B._updateMapView=function(){var e=this.viewer.getBBOX(),t=this.viewer.getResolution(),r=this.viewer.getCenter(),n=this.getMap().getSize();this.updateMapView(e,t,r,n)},B.getMapSize=function(){var e=this.viewer.map;return e.getSize()},B.setInnerGreyCoverScale=function(e){this._drawShadow.scale=e},B._resetDrawShadowInner=function(){this._drawShadow={type:"coordinate",outer:[],inner:[],scale:null,rotation:null}},B.setInnerGreyCoverBBox=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.viewer.map,r=e.type||"coordinate",n=e.inner||null,i=e.rotation,a=e.scale,o=void 0,s=void 0;if(n){switch(r){case"coordinate":o=t.getPixelFromCoordinate([n[0],n[1]]),s=t.getPixelFromCoordinate([n[2],n[3]]);break;case"pixel":o=[n[0],n[1]],s=[n[2],n[3]]}var l=o[1]*ol.has.DEVICE_PIXEL_RATIO,u=o[0]*ol.has.DEVICE_PIXEL_RATIO,c=s[1]*ol.has.DEVICE_PIXEL_RATIO,d=s[0]*ol.has.DEVICE_PIXEL_RATIO;this._drawShadow.inner[0]=u,this._drawShadow.inner[1]=l,this._drawShadow.inner[2]=d,this._drawShadow.inner[3]=c}_.isNil(a)?this._drawShadow.scale=this._drawShadow.scale||1:this._drawShadow.scale=a,_.isNil(i)?this._drawShadow.rotation=this._drawShadow.rotation||0:this._drawShadow.rotation=i,this._drawShadow.outer&&t.render()},B.startDrawGreyCover=function(e){var t=this,r=this.viewer.map,n=void 0,i=void 0,a=void 0,o=void 0,s=void 0,l=void 0;this.stopDrawGreyCover();var u=function(r){var u=r.context,c=t.getMap().getSize(),d=c[1]*ol.has.DEVICE_PIXEL_RATIO,p=c[0]*ol.has.DEVICE_PIXEL_RATIO;if(t._drawShadow.outer=[0,0,p,d],u.restore(),u.beginPath(),u.moveTo(0,0),u.lineTo(p,0),u.lineTo(p,d),u.lineTo(0,d),u.lineTo(0,0),u.closePath(),t._drawShadow.inner.length&&(u.save(),n=t._drawShadow.inner[0],a=t._drawShadow.inner[3],i=t._drawShadow.inner[2],o=t._drawShadow.inner[1],s=t._drawShadow.rotation,l=t._drawShadow.scale,u.translate((i+n)/2,(o+a)/2),u.rotate(s*Math.PI/180),u.moveTo(-((i-n)/2),(o-a)/2),u.lineTo((i-n)/2,(o-a)/2),u.lineTo((i-n)/2,-((o-a)/2)),u.lineTo(-((i-n)/2),-((o-a)/2)),u.lineTo(-((i-n)/2),(o-a)/2),u.closePath()),u.fillStyle="rgba(0, 5, 25, 0.40)",u.fill(),e){u.font="bold 25px Arial",u.fillStyle="#ffffff",u.textAlign="center";for(var f=e.split("\n"),h=0;h<f.length;h++)u.fillText(f[h],p/2,d/2+30*h)}u.restore()};this._greyListenerKey=r.on("postcompose",u)},B.stopDrawGreyCover=function(){var e=this.getMap();this._greyListenerKey&&(ol.Observable.unByKey(this._greyListenerKey),this._greyListenerKey=null,this._drawShadow.inner.length&&this._resetDrawShadowInner()),e.render()},B.removeExternalLayers=function(){var e=this;this._externalLayers.forEach(function(t){var r=t.get("name");e.removeExternalLayer(r)}),this._externalLayers=[]},B.changeLayerVisibility=function(e){var t=e.id,r=e.visible,n=this.getLayerById(t);n&&n.setVisible(r),this.emit("change-layer-visibility",{id:t,visible:r})},B.changeLayerOpacity=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.opacity,n=void 0===r?1:r,i=this.getLayerById(t);i&&i.setOpacity(n),this.emit("change-layer-opacity",{id:t,opacity:n})},B.changeLayerMapPosition=function(e){var t=e.id,r=e.position,n=void 0===r?u.MAP_SETTINGS.LAYER_POSITIONS["default"]:r,i=this.getLayerById(t);switch(n){case"top":i.setZIndex(this.layersCount);break;case"bottom":i.setZIndex(1)}this.emit("change-layer-position-map",{id:t,position:n})},B.removeExternalLayer=function(e){var t=this,r=this.getLayerByName(e),n=I.getService("catalog"),i=I.getService("queryresults");i.unregisterVectorLayer(r),this.viewer.map.removeLayer(r);var a=r._type||"vector";n.removeExternalLayer({name:e,type:a}),"wms"==a&&(this._externalMapLayers=this._externalMapLayers.filter(function(e){return e.getId()===r.id&&t.unregisterMapLayerListeners(e,r.projectLayer),e.getId()!==r.id})),this._externalLayers=this._externalLayers.filter(function(e){return e.get("id")!==r.get("id")}),this.unloadExternalLayer(r),this.emit("remove-external-layer",e)},B.addExternalWMSLayer=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.url,n=t.layers,i=t.name,a=t.epsg,o=void 0===a?this.getEpsg():a,s=t.position,l=void 0===s?u.MAP_SETTINGS.LAYER_POSITIONS["default"]:s,c=t.opacity,d=t.visible,p=void 0===d||d,f=ol.proj.get(o);return new Promise(function(t,a){var o=L({name:i,url:r,layers:n,projection:f}),s=o.wmslayer,u=o.olLayer;s.once("loadend",function(){t(s)}),s.once("loaderror",function(e){a(e)}),e.addExternalLayer(u,{position:l,opacity:c,visible:p}),e.addExternalMapLayer(s,!1)})},B.getExternalLayers=function(){return this._externalLayers},B.addExternalMapLayer=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._externalMapLayers.push(e),this.registerMapLayerListeners(e,t)},B.addExternalLayer=function(){var e=a(regeneratorRuntime.mark(function t(e){var r,n,i,a,o,s,l,c,d,p,f,h,v,g,y,_,b,w,x,S,L,k=this,M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=void 0,n=void 0,i=void 0,a=void 0,o=void 0,s=void 0,l=void 0,c=M.position,d=void 0===c?u.MAP_SETTINGS.LAYER_POSITIONS["default"]:c,p=M.opacity,f=void 0===p?1:p,h=M.visible,v=void 0===h||h,g=this.viewer.map,y=I.getService("catalog"),_=I.getService("queryresults"),e instanceof ol.layer.Vector){b=e.get("id"),void 0===b&&(b=m(),e.set("id",b)),r=e,w=void 0;try{x=e.getStyle(),w=x._g3w_options?x._g3w_options.color:"blue"}catch(T){w="blue"}n=r.get("name")||r.get("id"),s="vector",e={id:b,name:n,projectLayer:!1,title:n,removable:!0,external:!0,crs:M.crs,type:M.type,_type:s,download:M.download||!1,visible:v,checked:!0,position:d,opacity:f,color:w}}else e instanceof ol.layer.Image?(s="wms",n=e.get("name"),e.id=e.get("id"),e.removable=!0,e.projectLayer=!1,e.name=n,e.title=n,e._type=s,e.opacity=f,e.position=d,e.external=!0,e.checked=v):(n=e.name,s=e.type,l=e.crs,i=e.data,a=e.color);if(S=this.getLayerByName(n),L=function(t,r){var n=void 0;if(t){if("vector"===r){var i=t.getSource().getFeatures();i.length&&(e.geometryType=i[0].getGeometry().getType()),n=t.getSource().getExtent(),e.bbox={minx:n[0],miny:n[1],maxx:n[2],maxy:n[3]}}return t.set("position",d),t.setOpacity(f),t.setVisible(v),g.addLayer(t),k._externalLayers.push(t),_.registerVectorLayer(t),y.addExternalLayer({layer:e,type:r}),n&&g.getView().fit(n),k.loadExternalLayer(t),Promise.resolve(t)}return Promise.reject()},S){t.next=23;break}t.t0=s,t.next="vector"===t.t0?12:"wms"===t.t0?14:16;break;case 12:return t.abrupt("return",L(r,s));case 14:return t.abrupt("return",L(e,s));case 16:return t.next=18,C({name:n,type:s,crs:l,mapCrs:mapCrs,data:i,style:o});case 18:return r=t.sent,t.abrupt("return",L(r));case 20:L(r),t.next=24;break;case 23:I.notify.warning("layer_is_added",!1);case 24:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),B.setExternalLayerStyle=function(e,t){e=e.rgba,e="rgba("+e.r+","+e.g+","+e.b+","+e.a+")";var r={Point:new ol.style.Style({image:new ol.style.Circle({fill:new ol.style.Fill({color:e}),radius:5,stroke:new ol.style.Stroke({color:e,width:1})})}),LineString:new ol.style.Style({stroke:new ol.style.Stroke({color:e,width:3})}),Polygon:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255,255,255,0.5)"}),stroke:new ol.style.Stroke({color:e,width:3})}),MultiPoint:new ol.style.Style({image:new ol.style.Circle({fill:new ol.style.Fill({color:e}),radius:5,stroke:new ol.style.Stroke({color:e,width:1})})}),MultiLineString:new ol.style.Style({stroke:new ol.style.Stroke({color:e,width:3})}),MultiPolygon:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255,255,255,0.5)"}),stroke:new ol.style.Stroke({color:e,width:3})})},n=function(e,t){var n=e.getStyleFunction();return n?n.call(e,t):r[e.getGeometry().getType()]};return n},t.exports=o},{"../../constant":5,"../wms/vue/wms":230,"core/applicationservice":7,"core/data/routerservice":15,"core/g3wobject":26,"core/i18n/i18n.service":27,"core/layers/map/wmslayer":63,"core/layers/providers/wfsprovider":71,"core/layers/vectorlayer":75,"core/map/maplayersstoresregistry":76,"core/project/projectsregistry":83,"core/utils/geo":89,"core/utils/ol":90,"core/utils/utils":92,"g3w-ol/g3w.ol":124,"gui/gui":150,"gui/map/control/factory":184,"gui/map/control/registry":185,"gui/streetview/streetviewservice":216}],187:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l(this,e),this.id="map-component",this.title="Map Component";var t=e.target||"map",r=e.maps_container||"g3w-maps";e.target=t,e.maps_container=r;var n=new p(e);this.setService(n),u(this,e),this.internalComponent=new f({service:n,target:t,maps_container:r}),n.getCookie=this.internalComponent.$cookie.get}var a=e("components/Map.vue"),o=n(a),s=e("core/utils/utils"),l=s.base,u=s.merge,c=s.inherit,d=e("gui/component/component"),p=e("gui/map/mapservice"),f=Vue.extend(o);Vue.component("g3w-map",o),c(i,d);var h=i.prototype;h.layout=function(e,t){$("#"+this.target).height(t),$("#"+this.target).width(e),this._service.layout({width:e,height:t})},t.exports=i},{"components/Map.vue":290,"core/utils/utils":92,"gui/component/component":140,"gui/map/mapservice":186}],188:[function(e,t,r){function n(){this.content=null,this.show=!1,this.state={name:"",groups:{}},this._buildProjectGroupMetadata()}var i=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=e("core/utils/utils"),o=a.inherit,s=e("gui/gui"),l=e("core/g3wobject"),u=e("core/project/projectsregistry"),c=e("./vue/components/project/project"),d={general:["title","name","description","abstract","keywords","fees","accessconstraints","contactinformation","wms_url"],spatial:["crs","extent"],layers:["layers"]};o(n,l);var p=n.prototype;p._buildProjectGroupMetadata=function(){var e=u.getCurrentProject().getState();this.state.name=e.title;var t={};Object.entries(d).forEach(function(r){var n=i(r,2),a=n[0],o=n[1];t[a]={},o.forEach(function(r){var n=e.metadata&&e.metadata[r]?e.metadata[r]:e[r];n&&(t[a][r]={label:["sdk","metadata","groups",a,"fields",r].join("."),value:n})})}),this.state.groups=t},p.getProjectMetadata=function(){return this.state},p.getLayersMetadata=function(){return this.state.groups.layers},p.getLayerMetadata=function(e){var t=this.state.groups.layers.filter(function(t){return t.id===e});return t[0]},p.showMetadata=function(e){this.show=e,this.show?(this.content=new c({state:this.getProjectMetadata(),service:this}),s.setContent({content:this.content,title:"sdk.metadata.title",perc:100}),this.show=!0):s.closeContent()},p.reload=function(){this.emit("reload"),this._buildProjectGroupMetadata()},t.exports=n},{"./vue/components/project/project":190,"core/g3wobject":26,"core/project/projectsregistry":83,"core/utils/utils":92,"gui/gui":150}],189:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("gui/vue/vue.mixins"),i=n.metadataMixin;r["default"]=i},{"gui/vue/vue.mixins":227}],190:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.state,r=void 0===t?{}:t,n=e.service;u(this);var i=Vue.extend(o["default"]);this.setService(n),this.internalComponent=new i({state:r}),this.layout=function(){}}var a=e("components/MetadataProject.vue"),o=n(a),s=e("core/utils/utils"),l=s.inherit,u=s.base,c=e("gui/component/component");l(i,c),t.exports=i},{"components/MetadataProject.vue":297,"core/utils/utils":92,"gui/component/component":140}],191:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/Metadata.vue"),a=n(i),o=e("core/utils/utils"),s=o.inherit,l=o.base,u=e("gui/component/component"),c=e("gui/gui"),d=e("gui/metadata/metadataservice"),p=Vue.extend(a),f=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l(this,t),this.title="sdk.metadata.title";var r=t.service||new d(t);this.setService(r),this._service.on("reload",function(){e.setOpen(!1)}),this.setInternalComponent=function(){return this.internalComponent=new p({service:r}),this.internalComponent.state=r.state,this.internalComponent},this._setOpen=function(e){this._service.showMetadata(e)},c.on("closecontent",function(){e.state.open=!1})};s(f,u),t.exports=f},{"components/Metadata.vue":295,"core/utils/utils":92,"gui/component/component":140,"gui/gui":150,"gui/metadata/metadataservice":188}],192:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("services/navbaritems"),a=n(i),o=e("components/NavbaritemsLeft.vue"),s=n(o),l=e("components/NavbaritemsRight.vue"),u=n(l);t.exports={NavbarItemsService:a["default"],components:{left:s["default"],right:u["default"]}}},{"components/NavbaritemsLeft.vue":301,"components/NavbaritemsRight.vue":302,"services/navbaritems":393}],193:[function(e,t,r){var n=e("core/utils/utils"),i=n.inherit,a=n.resolve,o=e("gui/gui"),s=e("core/g3wobject"),l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.id=e.id||null,this.title=e.title||"",this.internalPanel=e.panel||null,this.service=e.service};i(l,s);var u=l.prototype;u.getId=function(){return this.id},u.getTitle=function(){return this.title},u.getService=function(){return this.service},u.setService=function(e){this.service=e},u.getInternalPanel=function(){return this.internalPanel},u.setInternalPanel=function(e){this.internalPanel=e},u.show=function(){o.showPanel(this)},u.close=function(){o.closePanel()},u.mount=function(e){var t=this.internalPanel,r=t.$mount();return $(e).append(r.$el),r.$nextTick(function(){$(e).localize(),t.onShow&&t.onShow()}),a(!0)},u.unmount=function(){var e=this.internalPanel,t=$.Deferred();return e.$destroy(!0),$(e.$el).remove(),e.onClose&&e.onClose(),this.internalComponent=null,t.resolve(),t.promise()},u.onResize=function(e,t){},t.exports=l},{"core/g3wobject":26,"core/utils/utils":92,"gui/gui":150}],194:[function(e,t,r){var n=e("app/constant");t.exports={scale:n.PRINT_SCALES,dpis:n.PRINT_RESOLUTIONS,formats:n.PRINT_FORMATS}},{"app/constant":5}],195:[function(e,t,r){function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function i(){s(this),this.printService=new g,this._initialized=!1,this.state={loading:!1},this._moveMapKeyEvent=null,this._page=null,this._mapService=null,this._map=null,this._mapUnits,this._scalesResolutions={},this.init=function(){this._project=v.getCurrentProject(),this.state.print=this._project.getPrint()||[],this.state.visible=this.state.print.length>0,this.state.isShow=!1,this.state.url=null,this.state.output={url:null,method:this._project.getOwsMethod(),layers:!0,format:null,loading:!1,type:null},this.state.printextent={minx:[0,0],miny:[0,0],maxx:[0,0],maxy:[0,0]},this.state.visible&&this.setInitState()}}var a=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=e("core/utils/utils"),s=o.base,l=o.inherit,u=o.downloadFile,c=e("core/applicationservice"),d=e("core/i18n/i18n.service"),p=d.t,f=e("gui/gui"),h=e("core/g3wobject"),v=e("core/project/projectsregistry"),g=e("core/print/printservice"),m=e("core/utils/ol"),y=m.getScaleFromResolution,b=m.getResolutionFromScale,w=m.getMetersFromDegrees,x=e("./printconfig"),S=e("./vue/printpage"),C=x.scale,L=x.dpis,k=x.formats;l(i,h);var M=i.prototype;M.setInitState=function(){this.state.template=this.state.print[0].name,this.state.atlas=this.state.print[0].atlas,this.state.atlasValues=[],this.state.rotation=0,this.state.inner=[0,0,0,0],this.state.center=null,this.state.size=null,this.state.scale=C,this.state.scala=null,this.state.dpis=L,this.state.dpi=L[0],this.state.formats=k,this.state.output.format=k[0].value,this.state.maps=this.state.print[0].maps,this.state.labels=this.state.print[0].labels},M.changeTemplate=function(){var e=this;if(this.state.template){var t=this.state.atlas,r=this.state.print.find(function(t){return t.name===e.state.template}),n=r.atlas,i=r.maps,a=r.labels;this.state.maps=i,this.state.atlas=n,this.state.labels=a,this.state.atlasValues=[],this.state.atlas?this._clearPrint():t?this.showPrintArea(!0):this._setPrintArea()}},M.changeScale=function(){this.state.scala&&this._setPrintArea()},M.changeRotation=function(){this._mapService.setInnerGreyCoverBBox({rotation:this.state.rotation})},M._getPrintExtent=function(){var e=[].concat(n(this.state.printextent.lowerleft),n(this.state.printextent.upperright)),t=e[0],r=e[1],i=e[2],a=e[3],o=this._mapService.isAxisOrientationInverted()?[r,t,a,i]:[t,r,i,a];return o.join()},M.getOverviewExtent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.xmin,r=e.xmax,n=e.ymin,i=e.ymax,a=this._mapService.isAxisOrientationInverted()?[n,t,i,r]:[t,n,r,i];return a.join()},M._getOptionsPrint=function(){var e=this,t=!1,r=this.state.maps.map(function(r){return t=t||void 0!==r.preset_theme,{name:r.name,preset_theme:r.preset_theme,scale:r.overview?r.scale:e.state.scala,extent:r.overview?e.getOverviewExtent(r.extent):e._getPrintExtent()}}),n={rotation:this.state.rotation,dpi:this.state.dpi,template:this.state.template,maps:r,scale:this.state.scala,format:this.state.output.format,labels:this.state.labels,is_maps_preset_theme:t};return n},M.setPrintAreaAfterCloseContent=function(){this._map.once("postrender",this._setPrintArea.bind(this)),this.stopLoading()},M.print=function(){var e=this;return new Promise(function(t,r){if(f.disableSideBar(!0),e.state.atlas){var n=c.setDownload(!0);e.state.loading=!0,e.printService.printAtlas({template:e.state.template,field:e.state.atlas.field_name||"$id",values:e.state.atlasValues,download:!0}).then(function(i){var a=i.url;u({url:a,filename:e.state.template,mime_type:"application/pdf"}).then(function(){t()})["catch"](function(t){e.showError(t),r()})["finally"](function(){e.state.loading=!1,c.setDownload(!1,n),f.disableSideBar(!1)})})}else{e.state.output.url=null,e.state.output.layers=!0,e._page=new S({service:e}),f.setContent({content:e._page,title:"print",perc:100});var i=e._getOptionsPrint();e.printService.print(i,method=e.state.output.method).then(function(r){e.state.output.url=r.url,e.state.output.layers=r.layers,e.state.output.mime_type=r.mime_type,t()})["catch"](function(t){e.showError(),r(t)})["finally"](function(){!e.state.output.layers&&f.disableSideBar(!1)})}})},M.startLoading=function(){this.state.output.loading=!0},M.stopLoading=function(){this.state.output.loading=!1},M.showError=function(e){f.notify.error(e||p("info.server_error")),f.closeContent()},M._calculateInternalPrintExtent=function(){var e=this._map.getView().getResolution(),t=parseFloat(this.state.scala),r=this.state.maps.find(function(e){return!e.overview}),n=r.h,i=r.w,a="m"===this._mapService.getMapUnits()?e:w(e),o=i/1e3*t/a*ol.has.DEVICE_PIXEL_RATIO,s=n/1e3*t/a*ol.has.DEVICE_PIXEL_RATIO,l=[this.state.size[0]*ol.has.DEVICE_PIXEL_RATIO/2,this.state.size[1]*ol.has.DEVICE_PIXEL_RATIO/2],u=l[0]-o/2,c=l[1]-s/2,d=l[0]+o/2,p=l[1]+s/2;this.state.printextent.lowerleft=this._map.getCoordinateFromPixel([u,p])?this._map.getCoordinateFromPixel([u,p]):this.state.printextent.lowerleft,this.state.printextent.upperright=this._map.getCoordinateFromPixel([d,c])?this._map.getCoordinateFromPixel([d,c]):this.state.printextent.upperright,this.state.inner=[u,p,d,c]},M._setPrintArea=function(){this.state.size=this._map.getSize();var e=this._map.getView().getResolution();this.state.currentScala=y(e,this._mapUnits),this.state.center=this._map.getView().getCenter(),this._calculateInternalPrintExtent(),this._mapService.setInnerGreyCoverBBox({type:"pixel",inner:this.state.inner,rotation:this.state.rotation})},M._clearPrint=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];ol.Observable.unByKey(this._moveMapKeyEvent),this._moveMapKeyEvent=null,this._mapService.stopDrawGreyCover()},M._setAllScalesBasedOnMaxResolution=function(e){var t=this,r=e,n=y(r,this._mapUnits),i=_.orderBy(this.state.scale,["value"],["desc"]),a=[],o=!1,s=function(e){a.push(e),r=b(e.value,t._mapUnits),t._scalesResolutions[e.value]=r,r/=2};i.forEach(function(e,t){if(n>e.value){if(!o){var r=i[t-1];s(r),o=!0}s(e)}}),this.state.scale=a},M._setInitialScalaSelect=function(){this.state.scala=this.state.scale[0].value,$("#scala").val(this.state.scala)},M._setCurrentScala=function(e){var t=this;Object.entries(this._scalesResolutions).find(function(r){var n=a(r,2),i=n[0],o=n[1];if(e<=o)return t.state.scala=i,!0})},M._setMoveendMapEvent=function(){this._moveMapKeyEvent=this._map.on("moveend",this._setPrintArea.bind(this))},M._showPrintArea=function(){void 0===this.state.atlas&&(this._setPrintArea(),this._mapService.startDrawGreyCover())},M._initPrintConfig=function(){if(!this._initialized){var e=this._map.getView().getMaxResolution();this._setAllScalesBasedOnMaxResolution(e),this._initialized=!0}var t=this._map.getView().getResolution();this._setCurrentScala(t)},M.showPrintArea=function(e){var t=this;this.state.isShow=e,f.closeContent().then(function(r){setTimeout(function(){t._mapService=r.getService(),t._mapUnits=t._mapService.getMapUnits(),t._mapService.getMap().once("postrender",function(r){t._map=r.map,e?(t._setMoveendMapEvent(),t._initPrintConfig(),t._showPrintArea()):t._clearPrint()}),t._mapService.getMap().renderSync()})})},M.reload=function(){var e=this;this._project=v.getCurrentProject(),this._mapService=f.getComponent("map").getService(),this._map=this._mapService.viewer.map,this.state.print=this._project.state.print||[],this.state.visible=this.state.print.length>0,this.state.visible?(this.state.template=this.state.print[0].name,!this._initialized&&this.init(),this._initPrintConfig(),this._mapService.on("changeviewaftercurrentproject",function(){var t=e._map.getView().getMaxResolution();e.state.scale=C,e._setAllScalesBasedOnMaxResolution(t)})):this._clearPrint()},t.exports=i},{"./printconfig":194,"./vue/printpage":197,"core/applicationservice":7,"core/g3wobject":26,"core/i18n/i18n.service":27,"core/print/printservice":81,"core/project/projectsregistry":83,"core/utils/ol":90,"core/utils/utils":92,"gui/gui":150}],196:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u(this,e),this.title="print",this.vueComponent=o,this.internalComponent=null;var t=e.service||new d;this.setService(t),this._service.init(),this.setInternalComponent=function(){var e=Vue.extend(this.vueComponent);return this.internalComponent=new e({service:t}),this.state.visible=t.state.visible,this.internalComponent.state=t.state,this.internalComponent},this._reload=function(){var e=this.getService();e.reload(),this.state.visible=e.state.visible},this._setOpen=function(e){this._service.showPrintArea(e)}}var a=e("components/Print.vue"),o=n(a),s=e("core/utils/utils"),l=s.inherit,u=s.base,c=e("gui/component/component"),d=e("gui/print/printservice");l(i,c),t.exports=i},{"components/Print.vue":306,"core/utils/utils":92,"gui/component/component":140,"gui/print/printservice":195}],197:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/PrintPage.vue"),a=n(i),o=e("core/utils/utils"),s=o.inherit,l=o.base,u=e("gui/component/component"),c=Vue.extend(a),d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l(this);var t=e.service;this.setService(t);var r=new c({service:t});this.setInternalComponent(r),this.internalComponent.state=t.state.output,this.unmount=function(){return this.getService().setPrintAreaAfterCloseContent(),l(this,"unmount")}};s(d,u),t.exports=d},{"components/PrintPage.vue":308,"core/utils/utils":92,"gui/component/component":140}],198:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l(this,e),this.title=e.title||"menu",this.state.visible=!0,this.state.menuitems=e.menuitems;var t=e.host;c(this,e),this.internalComponent=new p({service:this,host:t}),this.internalComponent.state=this.state}var a=e("components/ProjectsMenu.vue"),o=n(a),s=e("core/utils/utils"),l=s.base,u=s.inherit,c=s.merge,d=e("gui/component/component"),p=Vue.extend(o);u(i,d);var f=i.prototype;f.trigger=function(e){},t.exports=i},{"components/ProjectsMenu.vue":310,"core/utils/utils":92,"gui/component/component":140}],199:[function(e,t,r){function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.id="projectsmenu",a(this,t),this.state.menuitems=[];var r=t.host,n=e("core/applicationservice"),i=t.projects||s.getListableProjects();this.state.menuitems=i.map(function(e){return{title:e.title,description:e.description,thumbnail:e.thumbnail,gid:e.gid,cbk:t.cbk||function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.gid;return n.changeProject({gid:t,host:r})}}})}var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("core/project/projectsregistry"),l=e("./menu");o(n,l),t.exports=n},{"./menu":198,"core/applicationservice":7,"core/project/projectsregistry":83,"core/utils/utils":92}],200:[function(e,t,r){var n=e("./vue/querybuilder"),i=e("./vue/panel/querybuilderpanel"),a={type:null,show:function(){
var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=void 0===t?"sidebar":t,a=e.options,o=void 0;if(this.type=null===this.type?r:this.type,"modal"===this.type){o=new n({options:a});var s=o.$mount().$el;GUI.showModalDialog({title:"Query Builder",message:s,className:"modal-background-dark "})}else{var l=new i({options:a});o=l.getInternalPanel(),l.show()}return o}};t.exports=a},{"./vue/panel/querybuilderpanel":202,"./vue/querybuilder":203}],201:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("services/querybuilder"),a=n(i);t.exports=a["default"]},{"services/querybuilder":394}],202:[function(e,t,r){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.title="Query Builder",o(this,e);var t=new l(e);this.setInternalPanel(t)}var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("gui/panel"),l=e("gui/querybuilder/vue/querybuilder");a(n,s),t.exports=n},{"core/utils/utils":92,"gui/panel":193,"gui/querybuilder/vue/querybuilder":203}],203:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/QueryBuilder.vue"),a=n(i),o=Vue.extend(a);t.exports=o},{"components/QueryBuilder.vue":311}],204:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function s(){var e=this;this.printService=new G,this._currentLayerIds=[],O.onafter("setCurrentProject",function(t){e._project=t,e._setRelations(t),e._setAtlasActions(t),e.state.download_data=!1,e.plotLayerIds=[]}),this.unlistenerlayeractionevents=[],this._actions={zoomto:s.zoomToElement,highlightgeometry:this.highlightGeometry.bind(this),clearHighlightGeometry:this.clearHighlightGeometry.bind(this)},this._relations=[],this._atlas=[],this.plotLayerIds=[];var t=this._project=O.getCurrentProject();this._projectLayerIds=this._project.getConfigLayers().map(function(e){return e.id}),this.state={zoomToResult:!0,components:[],layers:[],changed:!1,query:null,type:"ows",layersactions:{},actiontools:{},currentactiontools:{},currentactionfeaturelayer:{},layeractiontool:{},layersFeaturesBoxes:{},layerscustomcomponents:{}},this.init=function(){this.clearState()};var r="blue",n=new ol.style.Stroke({color:r,width:3}),i=new ol.style.Fill({color:r});this.resultsQueryLayer=new ol.layer.Vector({style:new ol.style.Style({stroke:n,image:new ol.style.Circle({fill:i,radius:6})}),source:new ol.source.Vector}),this._vectorLayers=[],this._addFeaturesLayerResultInteraction={id:null,interaction:null,mapcontrol:null,toggleeventhandler:null},this.setters={setQueryResponse:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{add:!1},r=t.add;r||(this.clearState(),this.state.query=e.query,this.state.type=e.type);var n=e.data,i=this._digestFeaturesForLayers(n);this.setLayersData(i,t)},setLayersData:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{add:!1},n=r.add;n||(this._currentLayerIds=e.map(function(e){return e.id}),this._orderResponseByProjectLayers(e)),e.forEach(function(e){n?t.addRemoveFeaturesToLayerResult(e):t.state.layers.push(e)}),this.setActionsForLayers(e,{add:n}),this.state.changed=!0},addComponent:function(e){this._addComponent(e)},addActionsForLayers:function(e,t){},postRender:function(e){},closeComponent:function(){},changeLayerResult:function(e){this._changeLayerResult(e)},activeMapInteraction:function(){},editFeature:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.layerId,e.featureId},openCloseFeatureResult:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.open,e.layer,e.feature,e.container}},m(this),this.addLayersPlotIds=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.plotLayerIds=e},this.getPlotIds=function(){return this.plotLayerIds},this.findPlotId=function(e){return this.plotLayerIds.find(function(t){return t==e})},this._setRelations(t),this._setAtlasActions(t),this._addVectorLayersDataToQueryResponse(),this._asyncFnc={todo:b,zoomToLayerFeaturesExtent:{async:!1},goToGeometry:{async:!1}},j.onbefore("setContent",function(t){var r=t.perc;e.mapService=e.mapService||v.getApplicationService("map"),100===r&&j.isMobile()&&(e._asyncFnc.zoomToLayerFeaturesExtent.async=!0,e._asyncFnc.goToGeometry.async=!0)})}var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=e("constant"),d=e("components/QueryResultsActionDownloadFormats.vue"),p=n(d),f=e("components/QueryResultsActionQueryPolygonCSVAttributes.vue"),h=n(f),v=e("core/applicationservice"),g=e("core/utils/utils"),m=g.base,y=g.inherit,b=g.noop,w=g.downloadFile,x=g.throttle,S=g.getUniqueDomId,C=g.copyUrl,L=e("core/data/routerservice"),k=e("core/utils/geo"),M=k.getAlphanumericPropertiesFromFeature,T=k.createFeatureFromGeometry,E=k.createFeatureFromBBOX,I=k.createFeatureFromCoordinates,P=e("core/i18n/i18n.service"),F=P.t,O=e("core/project/projectsregistry"),R=e("core/layers/layer"),j=e("gui/gui"),A=e("core/g3wobject"),N=e("core/layers/vectorlayer"),G=e("core/print/printservice"),D=e("core/catalog/cataloglayersstoresregistry"),V=e("gui/relations/vue/relationspage"),U=e("g3w-ol/interactions/pickcoordinatesinteraction"),q=new Vue;y(s,A);var B=s.prototype;B.registerCustomComponent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=void 0===t?S():t,n=e.layerId,i=e.component,a=e.type,o=void 0===a?"feature":a,s=e.position,l=void 0===s?"after":s;return void 0===this.state.layerscustomcomponents[n]&&(this.state.layerscustomcomponents[n]={layer:{before:[],after:[]},feature:{before:[],after:[]}}),this.state.layerscustomcomponents[n][o][l].push({id:r,component:i}),r},B.unRegisterCustomComponent=function(e){var t=this,r=e.id,n=e.layerId,i=e.type,a=e.position;a?this.state.layerscustomcomponents[n][i][a]=this.state.layerscustomcomponents[n][i][a].filter(function(e){var t=e.id;return t!==r}):Object.keys(this.state.layerscustomcomponents[n][i]).forEach(function(e){t.state.layerscustomcomponents[n][i][e]=t.state.layerscustomcomponents[n][i][e].filter(function(e){var t=e.id;return t!==r})})},B.addFeatureLayerToResult=function(e,t){this.state.layersFeaturesBoxes[this.getBoxId(e,t)].collapsed=!0},B.removeFeatureLayerFromResult=function(e,t){var r=e.id,n=e.external;this.addRemoveFeaturesToLayerResult({id:r,external:n,features:[t]})},B.downloadApplicationWrapper=function(){var e=o(regeneratorRuntime.mark(function t(e){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=v.setDownload(!0),j.setLoadingContent(!0),t.prev=2,t.next=5,e(n);case 5:t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](2),j.showUserMessage({type:"alert",message:t.t0||"server_error",textMessage:!!t.t0});case 10:v.setDownload(!1,r),j.setLoadingContent(!1);case 12:case"end":return t.stop()}},t,this,[[2,7]])}));return function(t){return e.apply(this,arguments)}}(),B.addRemoveFeaturesToLayerResult=function(e){var t=this,r=e.features,n=void 0===r?[]:r,i=this.state.layers.find(function(t){return t.id===e.id});if(i&&n.length){var o=i.external,s=[],l=n.map(function(e){return o?e.id:e.attributes[c.G3W_FID]});if(i.features=i.features.filter(function(r){var i=l.indexOf(o?r.id:r.attributes[c.G3W_FID]),a=i===-1;if(a)t.state.layersFeaturesBoxes[t.getBoxId(e,r)].collapsed=!0;else{s.push(i);var u=n[i];t.state.layersFeaturesBoxes[t.getBoxId(e,r)].collapsed=!0,setTimeout(function(){return delete t.state.layersFeaturesBoxes[t.getBoxId(e,u)]})}return a}),n=n.filter(function(e,t){return s.indexOf(t)===-1}),n.length){var u=[].concat(a(i.features),a(n));i.features=u}1===i.features.length&&this.state.layersFeaturesBoxes[this.getBoxId(i,i.features[0])]&&setTimeout(function(){return t.state.layersFeaturesBoxes[t.getBoxId(i,i.features[0])].collapsed=!1}),this.checkIfLayerHasNoFeatures(i)}1===this.state.layers.length&&this.highlightFeaturesPermanently(this.state.layers[0]),this.changeLayerResult(i)},B._changeLayerResult=function(e){var t=this.state.layersactions[e.id];t.forEach(function(t){return t.change&&t.change(e)}),this.resetCurrentActionToolsLayer(e)},B.checkIfLayerHasNoFeatures=function(e){var t=this;0===e.features.length&&setTimeout(function(){t.state.layers=t.state.layers.filter(function(t){return t.id!==e.id}),t.clearHighlightGeometry(e),t.removeAddFeaturesLayerResultInteraction({toggle:!0})})},B.getBoxId=function(e,t,r){return null!==r&&void 0!==r?e.id+"_"+t.id+"_"+r:e.id+"_"+t.id},B.setActionsForLayers=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{add:!1},n=r.add;n||(this.unlistenerlayeractionevents=[],e.forEach(function(e){t.state.layeractiontool[e.id]=Vue.observable({component:null,config:null});var r={},n={};e.features.forEach(function(e,t){r[t]=null,n[t]=null}),t.state.currentactiontools[e.id]=Vue.observable(r),t.state.currentactionfeaturelayer[e.id]=Vue.observable(n);var i=e.external||!!e.source&&"wms"===e.source.type;if(t.state.layersactions[e.id]||(t.state.layersactions[e.id]=[]),e.hasgeometry&&t.state.layersactions[e.id].push({id:"gotogeometry",download:!1,mouseover:!0,"class":j.getFontClass("marker"),hint:"sdk.mapcontrols.query.actions.zoom_to_feature.hint",cbk:x(t.goToGeometry.bind(t))}),t._relations){var a=t._relations[e.id]&&t._relations[e.id].filter(function(e){return"MANY"===e.type});if(a&&a.length){var o=[];a.forEach(function(e){var r=t.plotLayerIds.find(function(t){return t===e.referencingLayer});r&&o.push(r)}),t.state.layersactions[e.id].push({id:"show-query-relations",download:!1,"class":j.getFontClass("relation"),hint:"sdk.mapcontrols.query.actions.relations.hint",cbk:t.showQueryRelations,relations:a,chartRelationIds:o});var s=t.createActionState({layer:e});o.length&&t.state.layersactions[e.id].push({id:"show-plots-relations",download:!1,opened:!0,"class":j.getFontClass("chart"),state:s,hint:"sdk.mapcontrols.query.actions.relations_charts.hint",cbk:x(t.showRelationsChart.bind(t,o))})}}t.getAtlasByLayerId(e.id).length&&t.state.layersactions[e.id].push({id:"printatlas",download:!0,"class":j.getFontClass("print"),hint:"sdk.tooltips.atlas",cbk:t.printAtlas.bind(t)});var l=t.createActionState({layer:e});if(1===e.downloads.length){var d=u(e.downloads,1),f=d[0],h=t.downloadFeatures.bind(t,f);e[f]=Vue.observable({active:!1}),t.state.layersactions[e.id].push({id:"download_"+f+"_feature",download:!0,state:l,"class":j.getFontClass("download"),hint:"sdk.tooltips.download_"+f,cbk:function(e,r,n,i){n.state.toggled[i]=!n.state.toggled[i],n.state.toggled[i]?h(e,r,n,i):t.setCurrentActionLayerFeatureTool({index:i,action:n,layer:e})}})}else if(e.downloads.length>1){var v=p["default"].name,g=[];e.downloads.forEach(function(e){g.push({id:"download_"+e+"_feature",download:!0,format:e,"class":j.getFontClass(e),hint:"sdk.tooltips.download_"+e,cbk:function(r,n,i,a){t.downloadFeatures(e,r,n,i,a);var o=t.state.layersactions[r.id].find(function(e){return"downloads"===e.id});"polygon"!==t.state.query.type&&o.cbk(r,n,o,a)}})}),t.state.actiontools[v]=t.state.actiontools[v]||{},t.state.actiontools[v][e.id]={downloads:g},t.state.layersactions[e.id].push({id:"downloads",download:!0,"class":j.getFontClass("download"),state:l,toggleable:!0,hint:"Downloads",change:function(e){var t=this,r=e.features;r.forEach(function(e,r){void 0===t.state.toggled[r]?q.$set(t.state.toggled,r,!1):t.state.toggled[r]=!1})},cbk:function(e,r,n,i){n.state.toggled[i]=!n.state.toggled[i],t.setCurrentActionLayerFeatureTool({layer:e,index:i,action:n,component:n.state.toggled[i]?p["default"]:null})}})}if(!i&&t.state.layersactions[e.id].push({id:"removefeaturefromresult",download:!1,mouseover:!0,"class":j.getFontClass("minus-square"),style:{color:"red"},hint:"sdk.mapcontrols.query.actions.remove_feature_from_results.hint",cbk:t.removeFeatureLayerFromResult.bind(t)}),void 0!==e.selection.active){var m=t.createActionState({layer:e});t.state.layersactions[e.id].push({id:"selection",download:!1,"class":j.getFontClass("success"),hint:"sdk.mapcontrols.query.actions.add_selection.hint",state:m,init:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.feature,i=r.index,a=r.action;void 0!==e.selection.active&&t.checkFeatureSelection({layerId:e.id,index:i,feature:n,action:a})},cbk:x(t.addToSelection.bind(t))}),t.listenClearSelection(e,"selection")}!i&&e.hasgeometry&&t.state.layersactions[e.id].push({id:"link_zoom_to_fid",download:!1,"class":j.getFontClass("link"),hint:"sdk.mapcontrols.query.actions.copy_zoom_to_fid_url.hint",hint_change:{hint:"sdk.mapcontrols.query.actions.copy_zoom_to_fid_url.hint_change",duration:1e3},cbk:t.copyZoomToFidUrl.bind(t)}),e.editable&&!e.inediting&&t.state.layersactions[e.id].push({id:"editing","class":j.getFontClass("pencil"),hint:"Editing",cbk:function(e,r){var n=e.id,i=r.attributes[c.G3W_FID];r.geometry&&t.mapService.zoomToGeometry(r.geometry),setTimeout(function(){t.editFeature({layerId:n,featureId:i})},300)}})}),this.addActionsForLayers(this.state.layersactions,this.state.layers))},B.createActionState=function(e){var t=e.layer,r=e.dynamicProperties,n=void 0===r?["toggled"]:r,i=n.reduce(function(e,t){return e[t]={},e},{});return t.features.map(function(e,t){Object.keys(i).forEach(function(e){i[e][t]=null})}),Vue.observable(i)},B.getActionLayerById=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,r=e.id;return this.state.layersactions[t.id].find(function(e){return e.id===r})},B.setCurrentActionLayerFeatureTool=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,r=e.action,n=e.index,i=e.component,a=void 0===i?null:i;a?(this.state.currentactiontools[t.id][n]&&r.id!==this.state.currentactionfeaturelayer[t.id][n].id&&this.state.currentactionfeaturelayer[t.id][n].toggleable&&(this.state.currentactionfeaturelayer[t.id][n].state.toggled[n]=!1),this.state.currentactionfeaturelayer[t.id][n]=r):this.state.currentactionfeaturelayer[t.id][n]=null,this.state.currentactiontools[t.id][n]=a},B.addCurrentActionToolsLayer=function(e){var t=e.id,r=e.layer,n=e.config,i=void 0===n?{}:n;this.state.actiontools[t]={},this.state.actiontools[t][r.id]=i},B.resetCurrentActionToolsLayer=function(e){var t=this;e.features.forEach(function(r,n){t.state.currentactiontools[e.id]&&(void 0===t.state.currentactiontools[e.id][n]?Vue.set(t.state.currentactiontools[e.id],n,null):t.state.currentactiontools[e.id][n]=null,t.state.currentactionfeaturelayer[e.id][n]=null)})},B.setLayerActionTool=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,r=e.component,n=void 0===r?null:r,i=e.config,a=void 0===i?null:i;this.state.layeractiontool[t.id].component=n,this.state.layeractiontool[t.id].config=a},B.copyZoomToFidUrl=function(e,t,r){var n=t.attributes[c.G3W_FID],i=new URL(location.href),a=e.id+"|"+n;i.searchParams.set("zoom_to_fid",a),C(i.toString()),r.hint_changed=!0},B.clear=function(){this.runAsyncTodo(),this.unlistenerEventsActions(),this.mapService.clearHighlightGeometry(),this.resultsQueryLayer.getSource().clear(),this.removeAddFeaturesLayerResultInteraction({toggle:!0}),this.mapService.getMap().removeLayer(this.resultsQueryLayer),this._asyncFnc=null,this._asyncFnc={todo:b,zoomToLayerFeaturesExtent:{async:!1},goToGeometry:{async:!1}},this.clearState(),this.closeComponent()},B.getCurrentLayersIds=function(){return this._currentLayerIds},B.runAsyncTodo=function(){this._asyncFnc.todo()},B._orderResponseByProjectLayers=function(e){var t=this;e.sort(function(e,r){var n=t._projectLayerIds.indexOf(e.id),i=t._projectLayerIds.indexOf(r.id);return n>i?1:-1})},B.setZoomToResults=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.state.zoomToResult=e},B.highlightFeaturesPermanently=function(e){var t=e.features;this.mapService.highlightFeatures(t,{duration:1/0})},B.isOneLayerResult=function(){return 1===this.state.layers.length},B.removeAddFeaturesLayerResultInteraction=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.toggle,r=void 0!==t&&t;this._addFeaturesLayerResultInteraction.interaction&&this.mapService.removeInteraction(this._addFeaturesLayerResultInteraction.interaction),this._addFeaturesLayerResultInteraction.interaction=null,this._addFeaturesLayerResultInteraction.id=null,r&&this._addFeaturesLayerResultInteraction.mapcontrol&&this._addFeaturesLayerResultInteraction.mapcontrol.toggle(!0),this._addFeaturesLayerResultInteraction.mapcontrol=null,this._addFeaturesLayerResultInteraction.toggleeventhandler&&this.mapService.off("mapcontrol:toggled",this._addFeaturesLayerResultInteraction.toggleeventhandler),this._addFeaturesLayerResultInteraction.toggleeventhandler=null},B.addLayerFeaturesToResultsAction=function(e){var t=this;if(null!==this._addFeaturesLayerResultInteraction.id&&this._addFeaturesLayerResultInteraction.id!==e.id){var r=this.state.layers.find(function(e){return e.id===t._addFeaturesLayerResultInteraction.id});r&&(r.addfeaturesresults.active=!1),this._addFeaturesLayerResultInteraction.interaction&&this.mapService.removeInteraction(this._addFeaturesLayerResultInteraction.interaction)}if(this._addFeaturesLayerResultInteraction.id=e.id,e.addfeaturesresults.active=!e.addfeaturesresults.active,e.addfeaturesresults.active){this.activeMapInteraction();var n=e.external;this._addFeaturesLayerResultInteraction.mapcontrol||(this._addFeaturesLayerResultInteraction.mapcontrol=this.mapService.getCurrentToggledMapControl()),this._addFeaturesLayerResultInteraction.interaction=new U,this.mapService.addInteraction(this._addFeaturesLayerResultInteraction.interaction,{close:!1}),this._addFeaturesLayerResultInteraction.interaction.on("picked",function(){var r=o(regeneratorRuntime.mark(function i(r){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(a=r.coordinate,n){i.next=6;break}return i.next=4,L.getData("query:coordinates",{inputs:{coordinates:a,query_point_tolerance:t._project.getQueryPointTolerance(),layerIds:[e.id],multilayers:!1},outputs:{show:{add:!0}}});case 4:i.next=9;break;case 6:o=t._vectorLayers.find(function(t){return e.id===t.get("id")}),s=t.getVectorLayerFeaturesFromQueryRequest(o,{coordinates:a}),t.setQueryResponse({data:[s],query:{coordinates:a}},{add:!0});case 9:case"end":return i.stop()}},i,t)}));return function(e){return r.apply(this,arguments)}}());var i=function(t){t.target.isToggled()&&t.target.isClickMap()&&(e.addfeaturesresults.active=!1)};this._addFeaturesLayerResultInteraction.toggleeventhandler=i,this.mapService.once("mapcontrol:toggled",i)}else this.removeAddFeaturesLayerResultInteraction({toggle:!0})},B.deactiveQueryInteractions=function(){this.state.layers.forEach(function(e){e.addfeaturesresults&&(e.addfeaturesresults.active=!1)}),this.removeAddFeaturesLayerResultInteraction()},B.zoomToLayerFeaturesExtent=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.features;t.highlight=!this.isOneLayerResult(),this._asyncFnc.zoomToLayerFeaturesExtent.async?this._asyncFnc.todo=this.mapService.zoomToFeatures.bind(this.mapService,r,t):this.mapService.zoomToFeatures(r,t)},B.clearState=function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state.layers.splice(0),this.state.query={},this.state.querytitle="",this.state.changed=!1,Object.values(this.state.layersactions).forEach(function(e){return e.forEach(function(e){return e.clear&&e.clear()})}),this.state.layersactions={},this.state.actiontools={},this.state.layeractiontool={},this.state.currentactiontools={},this.state.layersFeaturesBoxes={},this.removeAddFeaturesLayerResultInteraction()},B.getState=function(){return this.state},B.setState=function(e){this.state=e},B._setRelations=function(e){var t=e.getRelations();this._relations=t?_.groupBy(t,"referencedLayer"):[]},B.getAtlasByLayerId=function(e){return this._atlas.filter(function(t){return t.atlas.qgs_layer_id===e})},B._setAtlasActions=function(e){this._atlas=e.getPrint().filter(function(e){return e.atlas})||[]},B.setTitle=function(e){this.state.querytitle=e||""},B.reset=function(){this.clearState()},B._digestFeaturesForLayers=function(e){var t=this,r=0;e=e||[];var n=[],a=void 0,o=void 0,s=void 0,u=void 0,c=function(e){var c,d=void 0,f=void 0,h=void 0,v=!1,g=!1,m=!1,y=!1,_=e.layer,b=[],w=[],x=void 0,S={},C={};if(_ instanceof R){m=_.isEditable(),y=_.isInEditing(),h=_.getSource(),w=_.getInfoFormats(),x=_.getInfoFormat(),[R.SourceTypes.WMS,R.SourceTypes.WCS,R.SourceTypes.WMST].indexOf(_.getSourceType())===-1&&(S=_.state.filter,C=_.state.selection,v=!0),b=_.getDownloadableFormats();try{f=_.getSourceType()}catch(L){}if(a="ows"===t.state.type?_.getAttributes().map(function(e){var t=l({},e);return t.name=t.name.replace(/ /g,"_"),t}):_.getAttributes(),o=[],s=_.getTitle(),u=_.getId(),_.hasFormStructure()){var k=_.getLayerEditingFormStructure();if(t._relations&&t._relations.length){var M=function $(e){if(e.nodes){var t=!0,r=!1,n=void 0;try{for(var i,a=e.nodes[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;$(o)}}catch(s){r=!0,n=s}finally{try{!t&&a["return"]&&a["return"]()}finally{if(r)throw n}}}else e.name?e.relation=!0:null},T=!0,E=!1,I=void 0;try{for(var P,F=k[Symbol.iterator]();!(T=(P=F.next()).done);T=!0){var O=P.value;M(O)}}catch(L){E=!0,I=L}finally{try{!T&&F["return"]&&F["return"]()}finally{if(E)throw I}}}var j=_.getFields().filter(function(e){return e.show});d={structure:k,fields:j}}}else if(_ instanceof ol.layer.Vector)a=_.getProperties(),o=[],s=_.get("name"),u=_.get("id"),g=!0;else if("string"==typeof _||_ instanceof String){f=R.LayerTypes.VECTOR;var A=e.features[0];a=A?A.getProperties():[],o=[];var N=_.split("_");s=N.length>4?N.slice(0,N.length-4).join(" "):_,u=_,g=!0}var G=(c={title:s,id:u,infoformat:x,infoformats:w,attributes:[],features:[],hasgeometry:!1,atlas:t.getAtlasByLayerId(u),source:h,downloads:b,show:!0,filter:S,addfeaturesresults:{active:!1}},i(c,p["default"].name,{active:!1}),i(c,"external",g),i(c,"editable",m),i(c,"inediting",y),i(c,"selection",C),i(c,"expandable",!0),i(c,"hasImageField",!1),i(c,"relationsattributes",o),i(c,"formStructure",d),i(c,"error",""),i(c,"rawdata",null),i(c,"loading",!1),c);if(e.rawdata)G.rawdata=e.rawdata,n.push(G);else if(e.features&&e.features.length){var D=_ instanceof R?a.filter(function(e){try{return"_"===e.name[0]||Number.isInteger(1*e.name[0])}catch(t){return!1}}).map(function(e){return{alias:e.name.replace(/_/,""),name:e.name}}):[];D.length&&e.features.forEach(function(e){return t._setSpecialAttributesFeatureProperty(D,e)}),G.attributes=t._parseAttributes(a,e.features[0],f),G.attributes.forEach(function(e){if(d){var t=_.getFields().find(function(t){return t.name===e.name});!t&&d.fields.push(e)}"image"===e.type&&(G.hasImageField=!0)}),e.features.forEach(function(e){var n=t.getFeaturePropertiesAndGeometry(e),i=n.id,a=n.geometry,o=n.properties;a&&(G.hasgeometry=!0);var s={id:i,attributes:o,geometry:a,show:!0};G.features.push(s),r+=1}),n.push(G)}else e.error&&(G.error=e.error)};return e.forEach(function(e){Array.isArray(e)?e.forEach(function(e){return c(e)}):c(e)}),n},B._setSpecialAttributesFeatureProperty=function(e,t){var r=t.getProperties(),n=Object.keys(r);e.length&&e.forEach(function(e){n.find(function(r){if(r===e.alias)return t.set(e.name,t.get(r)),!0})})},B.getFeaturePropertiesAndGeometry=function(e){if(e instanceof ol.Feature)return{properties:e.getProperties(),geometry:e.getGeometry(),id:e.getId()};var t=e.properties,r=e.geometry,n=e.id;return{properties:t,geometry:r,id:n}},B._parseAttributes=function(e,t,r){var n=this.getFeaturePropertiesAndGeometry(t),i=n.properties,a=Object.keys(i);if(a=M(a),e&&e.length){var o=e.filter(function(e){return a.indexOf(e.name)>-1});return o}var s=R.SourceTypes,l=s.GDAL,u=s.WMS,d=s.WCS,p=s.WMST,f=[l,u,d,p];return a.map(function(e){return{name:e,label:e,show:e!==c.G3W_FID&&(void 0===r||f.indexOf(r)!==-1)}})},B.trigger=function(){var e=o(regeneratorRuntime.mark(function t(e,r,n,i,a){var o,s,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o=this._actions[e],o&&o(r,n,i),!r){t.next=10;break}if(s=this.state.layersactions[r.id],!s){t.next=10;break}if(l=s.find(function(t){return t.id===e}),t.t0=l,!t.t0){t.next=10;break}return t.next=10,this.triggerLayerAction(l,r,n,i,a);case 10:case"end":return t.stop()}},t,this)}));return function(t,r,n,i,a){return e.apply(this,arguments)}}(),B.triggerLayerAction=function(){var e=o(regeneratorRuntime.mark(function t(e,r,n,i,a){var o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.cbk,!t.t0){t.next=4;break}return t.next=4,e.cbk(r,n,e,i,a);case 4:e.route&&(o=void 0,s=e.route,o=s.replace(/{(\w*)}/g,function(e,t){return n.attributes.hasOwnProperty(t)?n.attributes[t]:""}),o&&""!==o&&j["goto"](o));case 5:case"end":return t.stop()}},t,this)}));return function(t,r,n,i,a){return e.apply(this,arguments)}}(),B.registerVectorLayer=function(e){this._vectorLayers.indexOf(e)===-1&&this._vectorLayers.push(e)},B.unregisterVectorLayer=function(e){var t=this;this._vectorLayers=this._vectorLayers.filter(function(r){return t.state.layers=t.state.layers&&t.state.layers.filter(function(t){return t.id!==e.get("id")}),r!==e})},B.getVectorLayerFeaturesFromQueryRequest=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=!1,n=t.coordinates,i=t.bbox,a=t.geometry,o=[];switch(e.constructor){case N:r=e.isVisible();break;case ol.layer.Vector:r=e.getVisible()}if(!r)return!0;if(n&&Array.isArray(n)){var s=this.mapService.viewer.map.getPixelFromCoordinate(n);this.mapService.viewer.map.forEachFeatureAtPixel(s,function(e,t){o.push(e)},{layerFilter:function(t){return t===e}})}else if(i&&Array.isArray(i)){var l=ol.geom.Polygon.fromExtent(i);switch(e.constructor){case N:o=e.getIntersectedFeatures(l);break;case ol.layer.Vector:e.getSource().getFeatures().forEach(function(e){l.intersectsExtent(e.getGeometry().getExtent())&&o.push(e)})}}else if(a instanceof ol.geom.Polygon||a instanceof ol.geom.MultiPolygon)switch(e.constructor){case N:o=e.getIntersectedFeatures(a);break;case ol.layer.Vector:e.getSource().getFeatures().forEach(function(e){a.intersectsExtent(e.getGeometry().getExtent())&&o.push(e)})}return{features:o,layer:e}},B._addVectorLayersDataToQueryResponse=function(){var e=this;this.onbefore("setQueryResponse",function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.query,i=void 0===n?{}:n,a=r.add,o=void 0!==a&&a;!o&&e._vectorLayers.forEach(function(r){var n=e.getVectorLayerFeaturesFromQueryRequest(r,i);t.data||(t.data=[]),t.data.push(n)})})},B._addComponent=function(e){this.state.components.push(e)},B._printSingleAtlas=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.atlas,r=void 0===t?{}:t,n=e.features,i=void 0===n?[]:n,a=r.name,o=r.atlas.field_name;o=o||"$id";var s=i.map(function(e){return e.attributes["$id"===o?c.G3W_FID:o]}),l=v.setDownload(!0);return this.printService.printAtlas({field:o,values:s,template:a,download:!0}).then(function(e){var t=e.url;w({url:t,filename:a,mime_type:"application/pdf"})["catch"](function(e){j.showUserMessage({type:"alert",error:e})})["finally"](function(){v.setDownload(!1,l),j.setLoadingContent(!1)})})},B.showChart=function(e,t,r){this.emit("show-chart",e,t,r)},B.hideChart=function(e){this.emit("hide-chart",e)},B.showRelationsChart=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],r=arguments[2],n=arguments[3],i=arguments[4],a=arguments[5];if(n.state.toggled[i]=!n.state.toggled[i],n.state.toggled[i]){var o=this._relations[t.id],s={relations:o,fid:r.attributes[c.G3W_FID],height:400};this.emit("show-chart",e,a,s)}else this.hideChart(a)},B.printAtlas=function(e,t){var r=this,n=e.id,i=e.features,a="g3w_atlas_index";i=t?[t]:i;var o=this.getAtlasByLayerId(n);if(o.length>1){var s="";o.forEach(function(e,t){var r=S();s+='<input id="'+r+'" '+a+'="'+t+'" class="magic-radio" type="radio" name="template" value="'+e.name+'"/>\n                 <label for="'+r+'">'+e.name+"</label>\n                 <br>"}),j.showModalDialog({title:"Seleziona Template",message:s,buttons:{success:{label:"OK",className:"skin-button",callback:function(){var e=$('input[name="template"]:checked').attr(a);if(null!==e||void 0!==e){var t=o[e];r._printSingleAtlas({atlas:t,features:i})}}}}})}else this._printSingleAtlas({atlas:o[0],features:i})},B.showLayerDownloadFormats=function(e){var t=p["default"].name;e[t].active=!e[t].active,this.setLayerActionTool({layer:e,component:e[t].active?p["default"]:null,config:e[t].active?this.state.actiontools[t][e.id]:null})},B.downloadFeatures=function(){var e=o(regeneratorRuntime.mark(function t(e,r){var n,i,a,s,l,u,d,f,g,m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],y=this,_=arguments[3],b=arguments[4];return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=r.id,i=this.state.query,a=void 0===i?{}:i,m=m?Array.isArray(m)?m:[m]:m,s={fids:m.map(function(e){return e.attributes[c.G3W_FID]}).join(",")},l=function(){var t=o(regeneratorRuntime.mark(function n(){var t,i,a,o=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return m.length>1&&(r[p["default"].name].active=o,y.setLayerActionTool({layer:r})),t=D.getLayerById(r.id),i=v.setDownload(!0),j.setLoadingContent(!0),n.prev=4,n.next=7,t.getDownloadFilefromDownloadDataType(e,{data:s});case 7:if(n.t0=n.sent,n.t0){n.next=10;break}Promise.resolve();case 10:n.next=15;break;case 12:n.prev=12,n.t1=n["catch"](4),j.notify.error(n.t1||F("info.server_error"));case 15:v.setDownload(!1,i),j.setLoadingContent(!1),a=y.state.layersactions[r.id].find(function(e){return"downloads"===e.id}),m.length>1?void 0===a?(r[e].active=!1,y.setLayerActionTool({layer:r})):r[p["default"].name].active=!1:(void 0===a?_.state.toggled[b]=!1:a.state.toggled[b]=!1,y.setCurrentActionLayerFeatureTool({index:b,action:_,layer:r}));case 19:case"end":return n.stop()}},n,y,[[4,12]])}));return function(){return t.apply(this,arguments)}}(),"polygon"===a.type?(u=this.state.layersactions[r.id].find(function(e){return"downloads"===e.id}),d=a.fid,f=a.layer,g={choices:[{id:S(),type:"feature",label:"sdk.mapcontrols.querybypolygon.download.choiches.feature.label"},{id:S(),type:"polygon",label:"sdk.mapcontrols.querybypolygon.download.choiches.feature_polygon.label"}],download:function(e){"polygon"===e?(s.sbp_qgs_layer_id=f.getId(),s.sbp_fid=d):(delete s.sbp_fid,delete s.sbp_qgs_layer_id),l(!0)}},1===m.length?(void 0===u&&(_.state.toggled[b]=!0),this.state.actiontools[h["default"].name]=this.state.actiontools[n]||{},this.state.actiontools[h["default"].name][n]=g,this.setCurrentActionLayerFeatureTool({layer:r,index:b,action:_,component:h["default"]})):void 0===u?(r[e].active=!r[e].active,r[e].active?this.setLayerActionTool({layer:r,component:h["default"],config:g}):this.setLayerActionTool({layer:r
})):this.setLayerActionTool({layer:r,component:h["default"],config:g})):l();case 6:case"end":return t.stop()}},t,this)}));return function(t,r){return e.apply(this,arguments)}}(),B.downloadGpx=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.id,n=arguments[1],i=n?n.attributes[c.G3W_FID]:null,a=D.getLayerById(r);a.getGpx({fid:i})["catch"](function(e){j.notify.error(F("info.server_error"))})["finally"](function(){e.layerMenu.loading.shp=!1,e._hideMenu()})},B.downloadXls=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.id,n=arguments[1],i=n?n.attributes[c.G3W_FID]:null,a=D.getLayerById(r);a.getXls({fid:i})["catch"](function(e){j.notify.error(F("info.server_error"))})["finally"](function(){e.layerMenu.loading.shp=!1,e._hideMenu()})},B.listenClearSelection=function(e,t){var r=this,n=D.getLayerById(e.id),i=function(){var n=r.state.layersactions[e.id].find(function(e){return e.id===t});e.features.forEach(function(e,t){return n.state.toggled[t]=!1})};n.on("unselectionall",i),this.unlistenerlayeractionevents.push({layer:n,event:"unselectionall",handler:i})},B.unlistenerEventsActions=function(){this.unlistenerlayeractionevents.forEach(function(e){return e.layer.off(e.event,e.handler)}),this.unlistenerlayeractionevents=[]},B.addRemoveFilter=function(e){var t=D.getLayerById(e.id);t.toggleFilterToken()},B.selectionFeaturesLayer=function(e){var t=this,r=e.id,n=this.state.layersactions[r].find(function(e){return"selection"===e.id}),i=Object.values(n.state.toggled).reduce(function(e,t){return e&&t},!0),a=D.getLayerById(r);e.features.forEach(function(e,r){n.state.toggled[r]=!i,t._addRemoveSelectionFeature(a,e,r,i?"remove":"add")})},B._addRemoveSelectionFeature=function(){var e=o(regeneratorRuntime.mark(function t(e,r,n,i){var a,o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=r?r.attributes[c.G3W_FID]:null,o=e.getFilterActive()||e.hasSelectionFid(a),o||r&&r.geometry&&!e.getOlSelectionFeature(a)&&e.addOlSelectionFeature({id:a,geometry:r.geometry}),void 0!==i){t.next=7;break}e[o?"excludeSelectionFid":"includeSelectionFid"](a),t.next=15;break;case 7:if(o||"add"!==i){t.next=12;break}return t.next=10,e.includeSelectionFid(a);case 10:t.next=15;break;case 12:if(!o||"remove"!==i){t.next=15;break}return t.next=15,e.excludeSelectionFid(a);case 15:e.getFilterActive()&&(s=this.state.layers.find(function(t){return t.id===e.getId()}),e.getSelectionFids().size>0&&s&&s.features.splice(n,1),this.mapService.clearHighlightGeometry(),1===this.state.layers.length&&!this.state.layers[0].features.length&&this.state.layers.splice(0));case 16:case"end":return t.stop()}},t,this)}));return function(t,r,n,i){return e.apply(this,arguments)}}(),B.checkFeatureSelection=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layerId,r=e.feature,n=e.index,i=e.action,a=D.getLayerById(t);if(r){var o=r?r.attributes[c.G3W_FID]:null;i.state.toggled[n]=a.getFilterActive()||a.hasSelectionFid(o)}},B.addToSelection=function(e,t,r,n){r.state.toggled[n]=!r.state.toggled[n];var i=D.getLayerById(e.id);this._addRemoveSelectionFeature(i,t,n)},B.removeQueryResultLayerFromMap=function(){this.resultsQueryLayer.getSource().clear(),this.mapService.getMap().removeLayer(this.resultsQueryLayer)},B.addQueryResultsLayerToMap=function(e){var t=this,r=e.feature,n=e.timeout,i=void 0===n?1500:n;this.removeQueryResultLayerFromMap(),this.resultsQueryLayer.getSource().addFeature(r),this.mapService.getMap().addLayer(this.resultsQueryLayer);try{var a=ol.extent.getCenter(r.getGeometry().getExtent());this.mapService.getMap().getView().setCenter(a)}catch(o){}i&&setTimeout(function(){t.removeQueryResultLayerFromMap()},i)},B.showCoordinates=function(e){var t=I(e);this.addQueryResultsLayerToMap({feature:t})},B.showBBOX=function(e){var t=E(e);this.addQueryResultsLayerToMap({feature:t})},B.showGeometry=function(e){var t=T({geometry:e});this.addQueryResultsLayerToMap({feature:t})},B.goToGeometry=function(e,t){var r=this;if(t.geometry){var n={mapServiceMethod:this.isOneLayerResult()?"zoomToFeatures":"highlightGeometry",firstParam:this.isOneLayerResult()?[t]:t.geometry,options:this.isOneLayerResult()?{}:{layerId:e.id,duration:1500}};this._asyncFnc.goToGeometry.async?this._asyncFnc.todo=this.mapService[n.mapServiceMethod].bind(this.mapService,n.firstParam,n.options):setTimeout(function(){return r.mapService[n.mapServiceMethod](n.firstParam,n.options)})}},B.saveLayerResult=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,r=e.type,n=void 0===r?"csv":r;this.downloadFeatures(n,t,t.features)},B.highlightGeometry=function(e,t){t.geometry&&this.mapService.highlightGeometry(t.geometry,{layerId:e.id,zoom:!1,duration:1/0})},B.clearHighlightGeometry=function(e){this.mapService.clearHighlightGeometry(),this.isOneLayerResult()&&this.highlightFeaturesPermanently(e)},B.showRelation=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.relation,r=e.layerId,n=e.feature,i=t.name,a=t.nmRelationId,o=[],s=this._project.getRelationById(i),l=this._project.getRelationById(a);this.findPlotId(s.referencingLayer)&&o.push(s.referencingLayer),j.pushContent({content:new V({currentview:"relations",relations:[s],chartRelationIds:o,nmRelation:l,feature:n,layer:{id:r}}),title:s.name,closable:!1})},B.showQueryRelations=function(e,t,r){j.pushContent({content:new V({relations:r.relations,chartRelationIds:r.chartRelationIds,feature:t,layer:e}),backonclose:!0,title:c.LIST_OF_RELATIONS_TITLE,closable:!1})},t.exports=s},{"components/QueryResultsActionDownloadFormats.vue":315,"components/QueryResultsActionQueryPolygonCSVAttributes.vue":317,constant:5,"core/applicationservice":7,"core/catalog/cataloglayersstoresregistry":9,"core/data/routerservice":15,"core/g3wobject":26,"core/i18n/i18n.service":27,"core/layers/layer":52,"core/layers/vectorlayer":75,"core/print/printservice":81,"core/project/projectsregistry":83,"core/utils/geo":89,"core/utils/utils":92,"g3w-ol/interactions/pickcoordinatesinteraction":129,"gui/gui":150,"gui/relations/vue/relationspage":208}],205:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u(this,t),this.id="queryresults",this.title="Query Results",this._service=new p,this.setInternalComponent=function(){this.internalComponent=new f({queryResultsService:this._service}),this.internalComponent.querytitle=this._service.state.querytitle},this.getElement=function(){if(this.internalComponent)return this.internalComponent.$el},this._service.onafter("setLayersData",i(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return!e.internalComponent&&e.setInternalComponent(),t.next=3,e.internalComponent.$nextTick();case 3:case"end":return t.stop()}},r,e)}))),this.layout=function(e,t){},this.unmount=function(){return this.getService().closeComponent(),u(this,"unmount")}}var o=e("components/QueryResults.vue"),s=n(o),l=e("core/utils/utils"),u=l.base,c=l.inherit,d=e("gui/component/component"),p=e("gui/queryresults/queryresultsservice"),f=Vue.extend(s);c(a,d),t.exports=a},{"components/QueryResults.vue":313,"core/utils/utils":92,"gui/component/component":140,"gui/queryresults/queryresultsservice":204}],206:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function i(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state={},this._options={},l(this)}var a=e("constant"),o=e("core/utils/utils"),s=o.inherit,l=o.base,u=e("core/g3wobject"),c=e("gui/gui"),d=e("core/applicationservice"),p=e("core/relations/relationsservice");s(i,u);var f=i.prototype;f.getRelations=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._options=e,p.getRelations(e)},f.getRelationsNM=function(){var e=n(regeneratorRuntime.mark(function t(e){var r=e.nmRelation,n=e.features;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.getRelationsNM({nmRelation:r,features:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),f.saveRelations=function(){var e=n(regeneratorRuntime.mark(function t(e){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this._options.type=e,r=d.setDownload(!0),t.prev=2,t.next=5,p.save(this._options);case 5:t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](2),c.showUserMessage({type:"alert",message:t.t0||"info.server_error",closable:!0});case 10:d.setDownload(!1,r);case 11:case"end":return t.stop()}},t,this,[[2,7]])}));return function(t){return e.apply(this,arguments)}}(),f.buildRelationTable=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],r=d.getCurrentProject().getLayerById(t),n=r.getTableHeaders(),i=null,o=[],s=[],l=void 0;if(e.length){var u=Object.keys(e[0].attributes);i=n.filter(function(e){return u.indexOf(e.name)!==-1}),o=e.map(function(e){return s.push(e.attributes[a.G3W_FID]),i.map(function(t){return e.attributes[t.name]})}),l=i,i=i.map(function(e){return e.label})}return{columns:i,rows:o,rows_fid:s,features:e,fields:l,formStructure:r.getLayerEditingFormStructure(),rowFormStructure:null,layerId:r.getId()}},t.exports=i},{constant:5,"core/applicationservice":7,"core/g3wobject":26,"core/relations/relationsservice":86,"core/utils/utils":92,"gui/gui":150}],207:[function(e,t,r){t.exports=new Vue},{}],208:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/RelationsPage.vue"),a=n(i),o=e("core/utils/utils"),s=o.base,l=o.inherit,u=e("gui/component/component"),c=e("../relationsservice"),d=Vue.extend(a),p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s(this,e);var t=e.service||new c,r=e.layer,n=e.relation,i=void 0===n?null:n,a=e.relations,o=void 0===a?[]:a,l=e.feature,u=void 0===l?null:l,p=e.table,f=void 0===p?null:p,h=e.chartRelationIds,v=void 0===h?[]:h,g=e.nmRelation,m=e.currentview||"relations";this.setService(t);var y=new d({previousview:m,service:t,relations:o,relation:i,nmRelation:g,chartRelationIds:v,feature:u,currentview:m,layer:r,table:f});this.setInternalComponent(y),y.state=t.state,this.layout=function(){y.reloadLayout()}};l(p,u),t.exports=p},{"../relationsservice":206,"components/RelationsPage.vue":323,"core/utils/utils":92,"gui/component/component":140}],209:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=r.ALLVALUE="__G3W_ALL__",i=r.RETURN_TYPES=["data","search"];r["default"]={ALLVALUE:n,RETURN_TYPES:i}},{}],210:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){l(this);var e=c.getCurrentProject().state;this.title=e.search_title||"search",this.init=function(t){this.state.searches=t||e.search},this.state={searches:[],searchtools:[],querybuildersearches:o["default"].getCurrentProjectItems()}}var a=e("gui/querybuilder/service"),o=n(a),s=e("core/utils/utils"),l=s.base,u=s.inherit,c=e("core/project/projectsregistry"),d=e("core/g3wobject"),p=e("gui/search/vue/panel/searchpanel");u(i,d);var f=i.prototype;f.removeItem=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,r=e.index;switch(t){case"querybuilder":this.state.querybuildersearches.splice(r,1)}},f.getTitle=function(){return this.title},f.showPanel=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new p(e);return t.show(),t},f.cleanSearchPanels=function(){this.state.panels={}},f.stop=function(){var e=$.Deferred();return e.resolve(),e.promise()},f.addTool=function(e){this.state.searchtools.push(e)},f.addTools=function(e){var t=!0,r=!1,n=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;this.addTool(o)}}catch(s){r=!0,n=s}finally{try{!t&&a["return"]&&a["return"]()}finally{if(r)throw n}}},f.addQueryBuilderSearch=function(e){this.state.querybuildersearches.push(e)},f.removeTool=function(e){},f.removeTools=function(){this.state.searchtools.splice(0)},f.reload=function(){this.state.searches=c.getCurrentProject().state.search,this.state.querybuildersearches=o["default"].getCurrentProjectItems()},t.exports=i},{"core/g3wobject":26,"core/project/projectsregistry":83,"core/utils/utils":92,"gui/querybuilder/service":201,"gui/search/vue/panel/searchpanel":211}],211:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.service||new p(e);this.setService(t),this.id=c();var r=e.component||f,n=new r({service:t});this.setInternalPanel(n),this.unmount=function(){return l(this,"unmount").then(function(){t.clear()})}}var a=e("components/SearchPanel.vue"),o=n(a),s=e("core/utils/utils"),l=s.base,u=s.inherit,c=s.uniqueId,d=e("gui/panel"),p=e("./searchservice"),f=Vue.extend(o);u(i,d),t.exports=i},{"./searchservice":212,"components/SearchPanel.vue":325,"core/utils/utils":92,"gui/panel":193}],212:[function(e,t,r){function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.debounces={run:{fnc:function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];if(_.isMobile()){var i=e.mapService.getMap().getSize(),a=l(i,2),o=a[0],s=a[1];0===o||0===s?(_.hideSidebar(),setTimeout(function(){e._run.apply(e,r)},600)):e._run.apply(e,r)}else e._run.apply(e,r)}}},d(this),this.state={title:null,forminputs:[],loading:{},searching:!1},this.config=t;var r=this.config,n=r.type,i=r.options,o=void 0===i?{}:i,s=o.querylayerid||o.layerid||null,u=o.otherquerylayerids||[],c=o.filter||[];this.inputdependance={},this.inputdependencies={},this.cachedependencies={},this.project=x.getCurrentProject(),this.mapService=_.getService("map"),this.searchLayer=null,this.filter=null,this.inputs=[],this.state.title=t.name,this.search_endpoint=t.search_endpoint,this.url=o.queryurl,this.filter=o.filter,this.type=n||"search",this["return"]=o["return"]||"data",this.show="data"===this["return"]&&"search"===this.type,this.searchLayer=w.getLayerById(s),this.searchLayers=[s].concat(a(u)).map(function(e){return w.getLayerById(e)}),this.createInputsFormFromFilter({filter:c})}var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=e("../../constants"),c=e("core/utils/utils"),d=c.base,p=c.inherit,f=c.toRawType,h=c.getUniqueDomId,v=c.createFilterFormInputs,g=c.createSingleFieldParameter,m=c.isEmptyObject,y=e("core/data/routerservice"),_=e("gui/gui"),b=e("core/g3wobject"),w=e("core/catalog/cataloglayersstoresregistry"),x=e("core/project/projectsregistry"),S=[null,void 0,u.ALLVALUE];p(o,b);var C=o.prototype;C.createInputsFormFromFilter=i(regeneratorRuntime.mark(function L(){var e,t,r,n=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=i.filter,l=void 0===o?[]:o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:for(e=l.length-1,t=function(t){var r=l[t],i={label:r.label,attribute:r.attribute,type:r.input.type||"textfield",options:s({},r.input.options),value:null,operator:r.op,logicop:t===e?null:r.logicop,id:r.id||h(),loading:!1,widget:null},o=i.options,c=o.dependance,d=o.dependance_strict;if("selectfield"===i.type||"autocompletefield"===i.type){i.loading="autocompletefield"!==i.type;var p=new Promise(function(e,t){void 0===i.options.values?i.options.values=[]:c?d?(i.loading=!1,e()):n.getValuesFromField(i).then(function(e){e=n.valuesToKeysValues(e),i.options.values=e})["catch"](function(){return i.options.values=[]})["finally"](function(){i.loading=!1,e()}):n.getValuesFromField(i).then(function(e){e=n.valuesToKeysValues(e),i.options.values=e})["catch"](function(){return i.options.values=[]})["finally"](function(){e(),i.loading=!1})});c&&(n.inputdependance[i.attribute]=c,n.state.loading[c]=!1,i.options.disabled=d,n.setInputDependencies({master:c,slave:i}),i.options.values.length?(i.widget="valuemap",i.options._values=[].concat(a(i.options.values))):i.options.layer_id&&(i.widget="valuerelation")),p.then(function(){"autocompletefield"!==i.type&&(i.options.values.length?i.options.values[0].value!==u.ALLVALUE&&i.options.values.unshift({value:u.ALLVALUE}):i.options.values.push({value:u.ALLVALUE}),i.value=u.ALLVALUE)})}n.state.forminputs.push(i)},r=0;r<=e;r++)t(r);case 3:case"end":return i.stop()}},L,this)})),C.getReturnType=function(){return this["return"]},C.setReturnType=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"data";this["return"]=e,this.show="data"===this["return"]},C.createFieldsDependenciesAutocompleteParameter=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.fields,r=void 0===t?[]:t,n=e.field,i=e.value,a=this.getCurrentFieldDependance(n);if(void 0!==i){var o=g({field:n,value:i,operator:this.getFilterInputFromField(n).op});r.push(o)}if(a){var s=l(Object.entries(a)[0],2),u=s[0],c=s[1],d=this.getFilterInputFromField(u).op.toLowerCase();return r.unshift(u+"|"+d+"|"+encodeURI(c)),this.createFieldsDependenciesAutocompleteParameter({fields:r,field:u})}return r.length&&r.join()||void 0},C.getValuesFromField=function(){var e=i(regeneratorRuntime.mark(function t(e){var r,n,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.options.layer_id){t.next=9;break}return t.next=3,this.getUniqueValuesFromField({field:e,unique:e.options.key});case 3:return r=t.sent,n=w.getLayerById(e.options.layer_id),i=v({layer:n,search_endpoint:this.getSearchEndPoint(),inputs:r.map(function(t){return{attribute:e.options.value,logicop:"OR",operator:"eq",value:t}})}),t.abrupt("return",this.getValueRelationValues(e,i));case 9:if(!e.options.values.length){t.next=13;break}return t.abrupt("return",this.getValueMapValues(e));case 13:return t.abrupt("return",this.getUniqueValuesFromField({field:e,unique:e.attribute}));case 14:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),C.getValueRelationValues=function(){var e=i(regeneratorRuntime.mark(function t(e,r){var n,i,a,o,s,l,u,c,d,p;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.options,i=n.layer_id,a=n.key,o=n.value,s=w.getLayerById(i),t.prev=2,t.next=5,y.getData("search:features",{inputs:{layer:s,search_endpoint:this.getSearchEndPoint(),filter:r,ordering:a},outputs:!1});case 5:return l=t.sent,u=l.data,c=void 0===u?[]:u,d=c&&c[0]&&c[0].features||[],p=[],d.forEach(function(e){p.push({key:e.get(a),value:e.get(o)})}),t.abrupt("return",p);case 14:return t.prev=14,t.t0=t["catch"](2),t.abrupt("return",[]);case 17:case"end":return t.stop()}},t,this,[[2,14]])}));return function(t,r){return e.apply(this,arguments)}}(),C.getValueMapValues=function(){var e=i(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.options.values.filter(function(e){return e!==u.ALLVALUE}));case 1:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),C.getUniqueValuesFromField=function(){var e=i(regeneratorRuntime.mark(function t(e){var r,n=e.field,i=e.value,a=e.unique;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],e.prev=1,e.next=4,this.searchLayer.getFilterData({suggest:void 0!==i?n+"|"+i:void 0,unique:a,ordering:n.attribute});case 4:r=e.sent,e.next=9;break;case 7:e.prev=7,e.t0=e["catch"](1);case 9:return e.abrupt("return",r);case 10:case"end":return e.stop()}},t,this,[[1,7]])}));return function(t){return e.apply(this,arguments)}}(),C.autocompleteRequest=i(regeneratorRuntime.mark(function k(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.field,n=t.value;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=[],t.prev=1,t.next=4,this.searchLayer.getFilterData({suggest:r+"|"+n,unique:r});case 4:e=t.sent,t.next=9;break;case 7:t.prev=7,t.t0=t["catch"](1);case 9:return t.abrupt("return",e.map(function(e){return{id:e,text:e}}));case 10:case"end":return t.stop()}},k,this,[[1,7]])})),C.doSearch=i(regeneratorRuntime.mark(function M(){var t,r,n,i,a,o,s,l,u,c,d,p,f,h,g,b,w,x=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},S=x.filter,C=x.search_endpoint,L=void 0===C?this.getSearchEndPoint():C,k=x.queryUrl,T=void 0===k?this.url:k,E=x.feature_count,I=void 0===E?1e4:E,P=x.show,F=void 0===P?this.show:P;return regeneratorRuntime.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return S=S||this.createFilter(),t=void 0,this.state.searching=!0,x.prev=3,x.next=6,y.getData("search:features",{inputs:{layer:this.searchLayers,search_endpoint:L,filter:S,queryUrl:T,formatter:1,feature_count:I,raw:"search"===this["return"]},outputs:F&&{title:this.state.title}});case 6:if(t=x.sent,!F){x.next=11;break}this.project.state.autozoom_query&&t&&1===t.data.length&&this.mapService.zoomToFeatures(t.data[0].features),x.next=38;break;case 11:if("search_1n"!==this.type){x.next=31;break}if(r=this.config.options.search_1n_relationid,n=t.data[0]||{},i=n.features,a=void 0===i?[]:i,!a.length){x.next=28;break}if(o=this.project.getRelationById(r),s=[],!o){x.next=26;break}return l=o.referencedLayer,u=o.fieldRef,c=u.referencedField,d=u.referencingField,p=new Set,a.forEach(function(e){var t=e.getProperties()[d];p.has(t)||(p.add(t),s.push({attribute:c,logicop:"OR",operator:"eq",value:t}))}),f=this.project.getLayerById(l),h=v({layer:f,search_endpoint:L,inputs:s}),x.next=25,y.getData("search:features",{inputs:{layer:f,search_endpoint:L,filter:h,formatter:1,feature_count:I},outputs:{title:this.state.title}});case 25:t=x.sent;case 26:x.next=29;break;case 28:y.showEmptyOutputs();case 29:x.next=38;break;case 31:x.t0=this["return"],x.next="search"===x.t0?34:38;break;case 34:return _.closeContent(),t=t.data[0].data,m(t)?(g=Promise.resolve({}),y.showCustomOutputDataPromise(g)):(b=e("gui/search/vue/panel/searchpanel"),w=new b(t),w.show()),x.abrupt("break",38);case 38:x.next=42;break;case 40:x.prev=40,x.t1=x["catch"](3);case 42:return this.state.searching=!1,x.abrupt("return",t);case 44:case"end":return x.stop()}},M,this,[[3,40]])})),C.filterValidFormInputs=function(){return this.state.forminputs.filter(function(e){return S.indexOf(e.value)===-1&&""!==e.value.toString().trim()})},C.getSearchEndPoint=function(){return this.search_endpoint||this.searchLayer.getSearchEndPoint()},C.createFilter=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getSearchEndPoint(),t=this.filterValidFormInputs();return v({layer:this.searchLayers,inputs:t,search_endpoint:e})},C._run=function(){this.doSearch()},C.changeInput=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.value,n=this.state.forminputs.find(function(e){return t==e.id});n.value=r},C.createQueryFilterFromConfig=function(e){function t(e){for(var t in e){var n=e[t];if(Array.isArray(n)){r(t,n);break}}var i=e.attribute,a=e.op,o={};return o[a]={},o[a][i]=null,o}function r(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n={};return n[e]=[],r.forEach(function(r){n[e].push(t(r))}),n}var n=e.filter,i=void 0;for(var a in n){var o=n[a];i=r(a,o)}return i},C.getFilterInputFromField=function(e){return this.filter.find(function(t){return t.attribute===e})},C._getExpressionOperatorFromInput=function(e){var t=this.getFilterInputFromField(e);return t?t.op:null},C._getCascadeDependanciesFilter=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=this.getFilterInputFromField(e),n=r.input.options.dependance;return n&&(t.unshift(n),this._getCascadeDependanciesFilter(n,t)),t},C.getCurrentFieldDependance=function(e){var t=this.inputdependance[e];return t&&this.cachedependencies[t]&&this.cachedependencies[t]._currentValue!==u.ALLVALUE&&n({},t,this.cachedependencies[t]._currentValue)||null},C.getDependanceCurrentValue=function(e){var t=this.inputdependance[e];return t?this.cachedependencies[t]._currentValue:this.state.forminputs.find(function(t){return t.attribute===e}).value},C.fillDependencyInputs=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.field,n=t.subscribers,o=void 0===n?[]:n,s=t.value,l=void 0===s?u.ALLVALUE:s,c=void 0===this.inputdependance[r],d=l===u.ALLVALUE||null===l||void 0===l||""===l.toString().trim();return new Promise(function(t,n){o.forEach(function(e){"autocompletefield"===e.type?e.options.values.splice(0):(void 0===e.options._allvalues&&(e.options._allvalues=[].concat(a(e.options.values))),d?(e.options.values.splice(0),setTimeout(function(){e.options.values=[].concat(a(e.options._allvalues))})):e.options.values.splice(1)),e.value="selectfield"!==e.type?u.ALLVALUE:null}),e.cachedependencies[r]=e.cachedependencies[r]||{},e.cachedependencies[r]._currentValue=l;var s=o.filter(function(e){return"autocompletefield"!==e.type});if(l&&l!==u.ALLVALUE){var p=void 0,f=void 0;if(c){var h=e.cachedependencies[r]&&e.cachedependencies[r][l];p=void 0!==h,f=p&&h}else{var v=e.getDependanceCurrentValue(r),m=e.cachedependencies[r]&&e.cachedependencies[r][v]&&e.cachedependencies[r][v][l];p=void 0!==m,f=p&&m}if(p)for(var y=0;y<o.length;y++){var _=o[y],b=f[_.attribute];if(b&&b.length)for(var w=0;w<b.length;w++)_.options.values.push(b[w]);_.options.disabled=!1,t()}else{if(e.state.loading[r]=!0,c)e.cachedependencies[r][l]=e.cachedependencies[r][l]||{};else{var x=e.getDependanceCurrentValue(r);e.cachedependencies[r][x]=e.cachedependencies[r][x]||{},e.cachedependencies[r][x][l]=e.cachedependencies[r][x][l]||{}}if(s.length){var S=e.createFieldsDependenciesAutocompleteParameter({field:r,value:l});e.searchLayer.getFilterData({field:S}).then(function(){var t=i(regeneratorRuntime.mark(function n(t){var i,o,u;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:i=t.data[0].features||[],o=regeneratorRuntime.mark(function d(t){var n,o,u,p,f,h,v,m,y;return regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(n=s[t],o=n.attribute,u=n.widget,p=new Set,"valuemap"!==u){d.next=11;break}f=[].concat(a(n.options._values)),i.forEach(function(e){var t=e.get(o);t&&p.add(t)}),h=[].concat(a(p)),f=f.filter(function(e){var t=e.key;return h.indexOf(t)!==-1}),f.forEach(function(e){return n.options.values.push(e)}),d.next=29;break;case 11:if("valuerelation"!==u){d.next=27;break}if(i.forEach(function(e){var t=e.get(o);t&&p.add(t)}),!(p.size>0)){d.next=25;break}return v=g({field:n.options.key,value:[].concat(a(p))}),d.prev=15,d.next=18,e.getValueRelationValues(n,v);case 18:m=d.sent,m.forEach(function(e){return n.options.values.push(e)}),d.next=25;break;case 22:d.prev=22,d.t0=d["catch"](15);case 25:d.next=29;break;case 27:i.forEach(function(e){var t=e.get(o);t&&p.add(t)}),e.valuesToKeysValues([].concat(a(p)).sort()).forEach(function(e){return n.options.values.push(e)});case 29:c?e.cachedependencies[r][l][n.attribute]=n.options.values.slice(1):(y=e.getDependanceCurrentValue(r),e.cachedependencies[r][y][l][n.attribute]=n.options.values.slice(1)),n.options.disabled=!1;case 31:case"end":return d.stop()}},d,e,[[15,22]])}),u=0;case 3:if(!(u<s.length)){n.next=8;break}return n.delegateYield(o(u),"t0",5);case 5:u++,n.next=3;break;case 8:case"end":return n.stop()}},n,e)}));return function(e){return t.apply(this,arguments)}}())["catch"](function(e){return n(e)})["finally"](function(){e.state.loading[r]=!1,t()})}else e.state.loading[r]=!1,t()}}else s.forEach(function(e){return e.options.disabled=e.options.dependance_strict}),t()})},C.getDependencies=function(e){return this.inputdependencies[e]||[]},C.setInputDependencies=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.master,r=e.slave;this.inputdependencies[t]=void 0!==this.inputdependencies[t]?this.inputdependencies[t]:[],this.inputdependencies[t].push(r)},C.valuesToKeysValues=function(e){if(e.length){var t=f(e[0]);e="Object"!==t?e.map(function(e){return{key:e,value:e}}):e}return e},C.createQueryFilterObject=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.ogcService,r=void 0===t?"wms":t,n=e.filter,i=void 0===n?{}:n,a=this.getInfoFromLayer(r);return Object.assign(a,{ogcService:r,filter:i}),a},C.getInfoFromLayer=function(e){var t="wfs"===e?this.searchLayer.getProject().getWmsUrl():this.searchLayer.getQueryUrl();return{url:t,layers:[],infoFormat:this.searchLayer.getInfoFormat(e),crs:this.searchLayer.getCrs(),serverType:this.searchLayer.getServerType()}},C.setSearchLayer=function(e){this.searchLayer=e},C.getSearchLayer=function(){return this.searchLayer},C.clear=function(){this.state=null},t.exports=o},{"../../constants":209,"core/catalog/cataloglayersstoresregistry":9,"core/data/routerservice":15,"core/g3wobject":26,"core/project/projectsregistry":83,"core/utils/utils":92,"gui/gui":150,"gui/search/vue/panel/searchpanel":211}],213:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u(this,e),this.id="search",this._service=e.service||new d,this._service.init(),this.title=this._service.getTitle(),this.internalComponent=new p({service:this._service}),this.internalComponent.state=this._service.state,this.state.visible=!0,this._reload=function(){this._service.reload()},this.unmount=function(){return this._searches_searchtools.$destroy(),u(this,"unmount")}}var a=e("components/Search.vue"),o=n(a),s=e("core/utils/utils"),l=s.inherit,u=s.base,c=e("gui/component/component"),d=e("gui/search/service"),p=Vue.extend(o);l(i,c),t.exports=i},{"components/Search.vue":324,"core/utils/utils":92,"gui/component/component":140,"gui/search/service":210}],214:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=new Vue},{}],215:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("components/Sidebar.vue"),a=n(i),o=e("services/sidebar"),s=n(o);t.exports={SidebarService:s["default"],SidebarComponent:a["default"]}},{"components/Sidebar.vue":328,"services/sidebar":397
}],216:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){this._position=null,this.setters={postRender:function(e){}},this.init=function(){var e=o["default"].keys.vendorkeys.google;return e?new Promise(function(t){$script("https://maps.googleapis.com/maps/api/js?key="+e,function(){t()})}):Promise.reject()},l(this)}var a=e("core/applicationstate"),o=n(a),s=e("core/utils/utils"),l=s.base,u=s.inherit,c=e("core/g3wobject"),d=e("gui/gui"),p=e("gui/streetview/vue/streetview");u(i,c);var f=i.prototype;f.getPosition=function(){return this._position},f.showStreetView=function(e){this._position=e,d.setContent({content:new p({service:this}),title:"StreetView"})},t.exports=i},{"core/applicationstate":8,"core/g3wobject":26,"core/utils/utils":92,"gui/gui":150,"gui/streetview/vue/streetview":217}],217:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}var i=e("components/StreetView.vue"),a=n(i),o=e("core/utils/utils"),s=o.base,l=o.inherit,u=e("gui/component/component"),c=Vue.extend(a),d=function(e){s(this),e=e||{};var t=e.service;this.setService(t);var r=new c({service:t});this.setInternalComponent(r),this.unmount=function(){return s(this,"unmount")}};l(d,u),t.exports=d},{"components/StreetView.vue":331,"core/utils/utils":92,"gui/component/component":140}],218:[function(e,t,r){function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}var a=e("core/utils/utils"),o=a.inherit,s=a.noop,l=e("core/data/routerservice"),u=e("core/g3wobject"),c=e("core/catalog/cataloglayersstoresregistry"),d=e("gui/gui"),p=e("core/i18n/i18n.service"),f=p.t,h=e("core/utils/geo"),v=h.coordinatesToGeometry,g=e("core/layers/layer"),m=g.SELECTION_STATE,y=[10,25,50],_=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.currentPage=0,this.layer=t.layer,this.formatter=t.formatter;var r=this.getHeaders();this.allfeaturesnumber,this.nopaginationsfilter=[],this.selectedfeaturesfid=this.layer.getSelectionFids(),this.geolayer=this.layer.isGeoLayer(),this.relationsGeometry=[],!this.geolayer&&this.layer.getRelations().getArray().forEach(function(t){var r=c.getLayerById(t.getChild());r.isGeoLayer()&&e.relationsGeometry.push({layer:r,child_field:t.getChildField(),field:t.getFatherField(),features:{}})}),this.projection=this.geolayer?this.layer.getProjection():null,this.mapService=d.getService("map"),this.getAll=!1,this.paginationfilter=!1,this.mapBBoxEventHandlerKey={key:null,cb:null},this.clearAllSelection=function(){e.state.features.forEach(function(e){return e.selected=!1}),e.state.tools.show=!1,e.state.selectAll=!1},this.state={pageLengths:y,pageLength:this.layer.getAttributeTablePageLength()||y[0],features:[],title:this.layer.getTitle(),headers:r,geometry:!0,loading:!1,allfeatures:0,pagination:!this.getAll,selectAll:!1,nofilteredrow:!1,tools:{geolayer:{show:this.geolayer,active:!1,in_bbox:void 0},show:!1,filter:this.layer.state.filter}},this._async={state:!1,fnc:s},d.onbefore("setContent",function(t){e._async.state=100===t.perc}),this.layer.on("unselectionall",this.clearAllSelection),this.filterChangeHandler=i(regeneratorRuntime.mark(function n(){var t,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=i.type;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e.allfeaturesnumber=void 0,t=[],r="in_bbox"===a||!e.selectedfeaturesfid.has(m.ALL),e.state.pagination){n.next=12;break}if(!r){n.next=10;break}return n.next=7,e.reloadData();case 7:n.t0=n.sent,n.next=11;break;case 10:n.t0=[];case 11:t=n.t0;case 12:r&&e.emit("redraw",t);case 13:case"end":return n.stop()}},n,e)})),this.layer.on("filtertokenchange",this.filterChangeHandler)};o(_,u);var b=_.prototype;b.toggleFilterToken=i(regeneratorRuntime.mark(function w(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.layer.toggleFilterToken();case 2:case"end":return e.stop()}},w,this)})),b.getHeaders=function(){return[null].concat(n(this.layer.getTableHeaders()))},b.setDataForDataTable=function(){var e=this,t=[];return this.state.features.forEach(function(r){var n=r.attributes?r.attributes:r.properties,i=[null];e.state.headers.forEach(function(e){if(e){var t=n[e.name];e.value=t,i.push(t)}}),t.push(i)}),t},b.addRemoveSelectedFeature=function(e){if(e.selected=!e.selected,this.state.selectAll)this.state.selectAll=!1,this.layer.excludeSelectionFid(e.id,this.state.pagination);else if(this.selectedfeaturesfid.has(m.EXCLUDE)){this.layer[e.selected?"includeSelectionFid":"excludeSelectionFid"](e.id);var t=this.selectedfeaturesfid.size;1===t?(!this.state.tools.filter.active&&this.layer.setSelectionFidsAll(),this.state.selectAll=!0):t-1===this.state.features.length&&this.layer.clearSelectionFids()}else{this.layer[e.selected?"includeSelectionFid":"excludeSelectionFid"](e.id);var r=this.selectedfeaturesfid.size;r===this.allfeaturesnumber&&(this.state.selectAll=!0,!this.state.tools.filter.active&&this.layer.setSelectionFidsAll())}this.state.tools.show=this.selectedfeaturesfid.size>0,this.state.pagination||this.nopaginationsfilter.length&&(this.state.selectAll=this.state.features.filter(function(e){return e.selected}).length===this.nopaginationsfilter.length)},b.getAllFeatures=function(e){var t=this;return d.setLoadingContent(!0),new Promise(function(r,n){t.layer.getDataTable(e||{}).then(function(n){var i=n.features;if(t.geolayer&&i){if(!e){var a=t.state.features.map(function(e){return e.id});i.forEach(function(e){a.indexOf(e.id)===-1&&e.geometry&&t.layer.addOlSelectionFeature({id:e.id,geometry:t._returnGeometry(e)})}),t.getAll=!0}r(i)}}).fail(function(){return n()}).always(function(){return d.setLoadingContent(!1)})})},b.switchSelection=i(regeneratorRuntime.mark(function x(){var e,t,r,n=this;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(this.state.pagination){i.next=4;break}this.nopaginationsfilter.length?(e=!1,t=[],this.state.features.forEach(function(r,i){n.nopaginationsfilter.indexOf(i)!==-1&&t.push(r),r.selected=!r.selected,n.layer[r.selected?"includeSelectionFid":"excludeSelectionFid"](r.id),e=e||r.selected}),this.state.tools.show=e,this.checkSelectAll(t)):(this.state.features.forEach(function(e){e.selected=!e.selected}),this.layer.invertSelectionFids(),this.checkSelectAll(),this.state.tools.show=this.selectedfeaturesfid.size>0),i.next=13;break;case 4:if(r=!1,this.state.features.forEach(function(e){e.selected=!e.selected,r=e.selected}),i.t0=!this.getAll,!i.t0){i.next=10;break}return i.next=10,this.getAllFeatures();case 10:this.state.selectAll=this.paginationfilter?r:this.state.selectAll,this.layer.invertSelectionFids(),this.state.tools.show=this.selectedfeaturesfid.size>0;case 13:case"end":return i.stop()}},x,this)})),b.clearLayerSelection=function(){this.layer.clearSelectionFids()},b.selectAllFeatures=i(regeneratorRuntime.mark(function S(){var e,t,r,n,i,a,o,s=this;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(this.state.selectAll=!this.state.selectAll,this.state.pagination){l.next=5;break}this.nopaginationsfilter.length?(e=!1,this.state.features.forEach(function(t,r){s.nopaginationsfilter.indexOf(r)!==-1&&(t.selected=s.state.selectAll,s.layer[t.selected?"includeSelectionFid":"excludeSelectionFid"](t.id),e=e||t.selected)}),this.state.tools.show=e):(this.state.tools.show=this.state.selectAll,this.layer[this.state.selectAll?"setSelectionFidsAll":"clearSelectionFids"](),this.state.features.forEach(function(e){return e.selected=s.state.selectAll})),l.next=25;break;case 5:if(!this.paginationfilter){l.next=18;break}if(!(this.state.featurescount>=this.state.allfeatures)){l.next=10;break}this.state.features.forEach(function(e){e.selected=s.state.selectAll,s.layer[e.selected?"includeSelectionFid":"excludeSelectionFid"](e.id)}),l.next=15;break;case 10:return t=this.paginationParams,r=t.search,n=t.ordering,i=t.formatter,a=t.in_bbox,l.next=13,this.getAllFeatures({search:r,ordering:n,formatter:i,in_bbox:a});case 13:o=l.sent,o.forEach(function(e){!s.getAll&&s.geolayer&&e.geometry&&s.layer.addOlSelectionFeature({id:e.id,geometry:s._returnGeometry(e)}),s.layer[s.state.selectAll?"includeSelectionFid":"excludeSelectionFid"](e.id)});case 15:this.state.features.forEach(function(e){return e.selected=s.state.selectAll}),l.next=24;break;case 18:if(this.state.features.forEach(function(e){return e.selected=s.state.selectAll}),l.t0=!this.getAll,!l.t0){l.next=23;break}return l.next=23,this.getAllFeatures();case 23:this.layer[this.state.selectAll?"setSelectionFidsAll":"clearSelectionFids"]();case 24:this.state.tools.show=this.state.selectAll||this.selectedfeaturesfid.size>0;case 25:case"end":return l.stop()}},S,this)})),b.setFilteredFeature=function(e){var t=this;this.nopaginationsfilter=e,this.checkSelectAll(e.length===this.allfeaturesnumber||0===e.length?void 0:this.nopaginationsfilter.map(function(e){return t.state.features[e]}))},b.setAttributeTablePageLength=function(e){this.layer.setAttributeTablePageLength(e)},b.getData=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.start,n=void 0===r?0:r,i=t.order,a=void 0===i?[]:i,o=t.length,s=void 0===o?this.state.pageLength:o,l=t.columns,u=void 0===l?[]:l,c=t.search,p=void 0===c?{value:null}:c,h=t.firstCall,v=void 0!==h&&h;return d.setLoadingContent(!0),this.setAttributeTablePageLength(s),new Promise(function(t,r){if(e.state.headers.length){var i=p.value&&p.value.length>0?p.value:null;e.state.features.splice(0),a.length||a.push({column:1,dir:"asc"});var o="asc"===a[0].dir?e.state.headers[a[0].column].name:"-"+e.state.headers[a[0].column].name;e.currentPage=0===n||e.state.pagination&&e.state.tools.filter.active?1:n/s+1;var l=e.state.tools.geolayer.in_bbox,c=e.state.pagination?u.filter(function(e){return e.search&&e.search.value}).map(function(e){return e.name+"|ilike|"+e.search.value+"|and"}).join(","):void 0;e.paginationParams={field:c||void 0,page:e.currentPage,page_size:s,search:i,in_bbox:l,formatter:e.formatter,ordering:o};var h=e.state.pagination?e.layer.getDataTable(e.paginationParams):e.layer.getDataTable({ordering:o,in_bbox:l,formatter:e.formatter});h.then(function(r){var n=r.features,i=void 0===n?[]:n;e.state.allfeatures=r.count||e.state.features.length,e.state.featurescount=i.length,e.allfeaturesnumber=void 0===e.allfeaturesnumber?r.count:e.allfeaturesnumber,e.paginationfilter=r.count!==e.allfeaturesnumber,e.state.pagination=v?e.state.tools.filter.active||i.length<e.allfeaturesnumber:e.state.pagination,e.addFeatures(i),t({data:e.setDataForDataTable(),recordsFiltered:r.count,recordsTotal:r.count})}).fail(function(e){d.notify.error(f("info.server_error")),r(e)}).always(function(){d.setLoadingContent(!1)})}else t({data:[],recordsTotal:0,recordsFiltered:0})})},b.setInBBoxParam=function(){this.state.tools.geolayer.in_bbox=this.state.tools.geolayer.active?this.mapService.getMapBBOX().join(","):void 0},b.resetMapBBoxEventHandlerKey=function(){ol.Observable.unByKey(this.mapBBoxEventHandlerKey.key),this.mapBBoxEventHandlerKey.key=null,this.mapBBoxEventHandlerKey.cb=null},b.getDataFromBBOX=i(regeneratorRuntime.mark(function C(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.state.tools.geolayer.active=!this.state.tools.geolayer.active,this.state.tools.geolayer.active?(this.mapBBoxEventHandlerKey.cb=this.state.pagination?function(){e.setInBBoxParam(),e.emit("ajax-reload")}:i(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.setInBBoxParam(),e.filterChangeHandler({type:"in_bbox"});case 2:case"end":return t.stop()}},r,e)})),this.mapBBoxEventHandlerKey.key=this.mapService.getMap().on("moveend",this.mapBBoxEventHandlerKey.cb),this.mapBBoxEventHandlerKey.cb()):(this.mapBBoxEventHandlerKey.cb&&this.mapBBoxEventHandlerKey.cb(),this.resetMapBBoxEventHandlerKey());case 2:case"end":return t.stop()}},C,this)})),b.addFeature=function(e){var t={id:e.id,selected:this.state.tools.filter.active||this.layer.hasSelectionFid(e.id),attributes:e.attributes?e.attributes:e.properties};this.geolayer&&e.geometry&&(this.layer.getOlSelectionFeature(t.id)||this.layer.addOlSelectionFeature({id:t.id,geometry:this._returnGeometry(e)}),t.geometry=e.geometry),this.state.features.push(t)},b.checkSelectAll=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.features;this.state.selectAll=this.selectedfeaturesfid.has(m.ALL)||e.length&&e.reduce(function(e,t){return e&&t.selected},!0)},b.addFeatures=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach(function(t){return e.addFeature(t)}),this.state.tools.show=this.layer.getFilterActive()||this.selectedfeaturesfid.size>0,this.checkSelectAll()},b.reloadData=i(regeneratorRuntime.mark(function L(){var e,t,r,n,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return this.state.features.splice(0),this.state.pagination=i,a.next=4,this.getData();case 4:return e=a.sent,t=e.data,r=void 0===t?[]:t,n=e.reloadData,a.abrupt("return",r);case 7:case"end":return a.stop()}},L,this)})),b._setLayout=function(){},b._returnGeometry=function(e){var t=void 0;return e.attributes?t=e.geometry:e.geometry&&(t=v(e.geometry.type,e.geometry.coordinates)),t},b.zoomAndHighLightFeature=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.geometry;r&&(this._async.state?this._async.fnc=this.mapService.highlightGeometry.bind(mapService,r,{zoom:t}):this.mapService.highlightGeometry(r,{zoom:t}))},b.zoomAndHighLightGeometryRelationFeatures=function(){var e=i(regeneratorRuntime.mark(function t(e){var r,n,i,a,o=this,s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.relationsGeometry.length){t.next=10;break}return r=[],n=[],i=[],this.relationsGeometry.forEach(function(t){var r=t.layer,a=t.child_field,o=t.field,u=t.features,c=e.attributes[o];if(i.push(c),void 0===u[c]){var d=void 0;d=s?l.getData("search:features",{inputs:{layer:r,filter:a+"|eq|"+c,formatter:1,search_endpoint:"api"},outputs:!1}):Promise.reject(),n.push(d)}else n.push(Promise.resolve({data:[{features:u[c]}]}))}),t.next=7,Promise.allSettled(n);case 7:a=t.sent,a.forEach(function(e,t){var n=e.status,a=e.value;if("fulfilled"===n){var s=a.data[0]?a.data[0].features:[];s.forEach(function(e){return r.push(e)}),void 0===o.relationsGeometry[t].features[i[t]]&&(o.relationsGeometry[t].features[i[t]]=s)}}),s?this.mapService.zoomToFeatures(r,{highlight:!0}):this.mapService.highlightFeatures(r);case 10:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),b.clear=function(){var e=this;this.layer.off("unselectionall",this.clearAllSelection),this.layer.off("filtertokenchange",this.filterChangeHandler),this.resetMapBBoxEventHandlerKey(),this.allfeaturesnumber=null,this.mapService=null,this._async.state&&setTimeout(function(){e._async.fnc(),e._async.state=!1,e._async.fnc=s})},t.exports=_},{"core/catalog/cataloglayersstoresregistry":9,"core/data/routerservice":15,"core/g3wobject":26,"core/i18n/i18n.service":27,"core/layers/layer":52,"core/utils/geo":89,"core/utils/utils":92,"gui/gui":150}],219:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("components/Table.vue"),a=n(i),o=e("core/i18n/i18n.service"),s=o.t,l=e("core/utils/utils"),u=l.base,c=l.inherit,d=e("gui/gui"),p=e("gui/component/component"),f=e("../tableservice"),h=Vue.extend(a["default"]),v=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u(this),this.id="openattributetable";var r=t.layer,n=t.formatter,i=t.service||new f({layer:r,formatter:n});this.setService(i);var a=new h({service:i});this.setInternalComponent(a),a.state=i.state,i.on("redraw",function(){e.layout()}),this.unmount=function(){return u(this,"unmount")},this.layout=function(){a.reloadLayout()}};c(v,p);var g=v.prototype;g.show=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=this.getService();d.closeOpenSideBarComponent(),r.getData({firstCall:!0}).then(function(){d.showContent({content:e,perc:50,split:d.isMobile()?"h":"v",push:!1,title:t.title})})["catch"](function(e){return d.notify.error(s("info.server_error"))})["finally"](function(){return e.emit("show")})},g.unmount=function(){var e=this;return u(this,"unmount").then(function(){e._service.clear()})},t.exports=v},{"../tableservice":218,"components/Table.vue":332,"core/i18n/i18n.service":27,"core/utils/utils":92,"gui/component/component":140,"gui/gui":150}],220:[function(e,t,r){t.exports='<div class="error-initial-page skin-background-color">\n  <template v-if="isMobile()">\n    <h3 class="oops">Oops!</h3>\n    <h5 class="cause">{{messages.error}}</h5>\n    <h6 class="at-moment">{{ messages.at_moment }}</h6>\n    <h4 class="f5">{{ messages.f5}}</h4>\n  </template>\n  <template v-else>\n    <h1 class="oops">Oops!</h1>\n    <h1 class="cause">{{messages.error}}</h1>\n    <h3 class="at-moment">{{ messages.at_moment }}</h3>\n    <h2 class="f5">{{ messages.f5}}</h2>\n  </template>\n\n</div>\n'},{}],221:[function(e,t,r){function n(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config=null,this.state=i({},t,{toolsGroups:[],visible:!1,loading:!1}),this.setters={addTool:function(e,t){return e.state=e.state?e.state:{type:null,message:null},this._addTool(e,t)},addTools:function(e,t){return this._addTools(e,t)},addToolGroup:function(e,t){return this._addToolGroup(e,t)},removeToolGroup:function(e){return this._removeToolGroup(e)},removeTools:function(){return this._removeTools()}},o(this);var r=l.getCurrentProject(),n=r.getState(),a=n.tools,s=void 0===a?{}:a,u=function(t){var r=t.toUpperCase();e.addToolGroup(0,r);var n=s[t].map(function(e){return{name:e.name,action:ToolsService.ACTIONS[t].bind(null,e)}});e.addTools(n,{position:0,title:r})};for(var c in s)u(c)}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=e("core/utils/utils"),o=a.base,s=a.inherit,l=e("core/project/projectsregistry"),u=e("core/g3wobject");s(n,u);var c=n.prototype;c.reload=function(){this.removeTools()},c._addTool=function(e,t){var r=t.position,i=t.title,a=this._addToolGroup(r,i);void 0===e.action&&e.type&&(e.action=n.ACTIONS[e.type]?n.ACTIONS[e.type].bind(null,e.options):function(){}),a.tools.push(e)},c._addTools=function(e,t){var r=this;e.forEach(function(e){return r.addTool(e,t)})},c.setLoading=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state.loading=e},c._removeTool=function(e){this.state.toolsGroups=this.state.toolsGroups.splice(e,1)},c._removeTools=function(){this.state.toolsGroups.splice(0)},c.updateToolsGroup=function(e,t){Vue.set(this.state.toolsGroups,e,t)},c.getState=function(){return this.state},c._removeToolGroup=function(e){this.state.toolsGroups=this.state.toolsGroups.filter(function(t){return t.name!==e})},c._addToolGroup=function(e,t){var r=this.state.toolsGroups.find(function(e){return e.name===t});return r||(r={name:t,tools:[]},this.state.toolsGroups.splice(e,0,r)),r},c.setToolState=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.state,n=void 0===r?{type:null,message:null}:r;this.state.toolsGroups.find(function(e){var r=e.tools.find(function(e){return e.name===t});if(r)return r.state.type=n.type,r.state.message=n.message,!0})},n.ACTIONS={},t.exports=n},{"core/g3wobject":26,"core/project/projectsregistry":83,"core/utils/utils":92}],222:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l(this,e),this._service=new p(e),this.title="tools";var t=new f({toolsService:this._service});t.state=this._service.state,this.setInternalComponent(t,{events:[{name:"visible"}]}),this._setOpen=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.internalComponent.state.open=e,e&&c.closeContent()}}var a=e("components/Tools.vue"),o=n(a),s=e("core/utils/utils"),l=s.base,u=s.inherit,c=e("gui/gui"),d=e("gui/component/component"),p=e("gui/tools/service"),f=Vue.extend(o);u(i,d),t.exports=i},{"components/Tools.vue":337,"core/utils/utils":92,"gui/component/component":140,"gui/gui":150,"gui/tools/service":221}],223:[function(e,t,r){function n(){this._parent=null,this.state={contentsdata:[]}}var i=e("core/utils/utils"),a=i.resolve,o=i.inherit,s=e("core/g3wobject"),l=e("gui/component/component"),u=e("gui/panel");o(n,s);var c=n.prototype;c.push=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._parent=t.parent,this._mount(e,t)},c.pop=function(){var e=this,t=$.Deferred();if(this.state.contentsdata.length){var r=this.state.contentsdata.slice(-1)[0].content;this._unmount(r).then(function(){var r=e.state.contentsdata.pop();t.resolve(r)})}else t.resolve();return t.promise()},c.clear=function(){var e=this,t=$.Deferred();if(this.state.contentsdata.length){var r=[];this.state.contentsdata.forEach(function(t){r.push(e._unmount(t.content))}),$.when(r).then(function(){e.state.contentsdata.splice(0,e.state.contentsdata.length),t.resolve()})}else t.resolve();return t.promise()},c.getContentData=function(){return this.state.contentsdata},c.getCurrentContentData=function(){return this.state.contentsdata[this.state.contentsdata.length-1]},c.getPreviousContentData=function(){return this.state.contentsdata[this.state.contentsdata.length-2]},c._mount=function(e,t){if(e instanceof jQuery)return this._setJqueryContent(e);if(_.isString(e)){var r=$(e);return r.length||(r=$("<div>"+e+"</div>")),this._setJqueryContent(r)}return e.mount&&"function"==typeof e.mount?(this._checkDuplicateVueContent(e),this._setVueContent(e,t)):this._setDOMContent(e)},c._setJqueryContent=function(e,t){return $(this._parent).append(e),this.state.contentsdata.push({content:e,options:t}),a()},c._setDOMContent=function(e,t){return this._parent.appendChild(e),this.state.contentsdata.push({content:e,options:t}),a()},c._setVueContent=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=$.Deferred(),i=r.append||!1;return e.mount(this._parent,i).then(function(){$(t._parent).localize(),t.state.contentsdata.push({content:e,options:r}),n.resolve(e)}),n.promise()},c._checkDuplicateVueContent=function(e){var t=this,r=null,n=e.getId();if(this.state.contentsdata.forEach(function(e,t){e.content.getId&&e.content.getId()==n&&(r=t)}),!_.isNull(r)){var i=this.state.contentsdata[r];i.content.unmount().then(function(){return t.state.contentsdata.splice(r,1)})}},c._unmount=function(e){var t=$.Deferred();return e instanceof l||e instanceof u?e.unmount().then(function(){return t.resolve()}):($(this._parent).empty(),t.resolve()),t.promise()},c.forEach=function(e){this.state.contentsdata.forEach(function(t){return e(t.content)})},c.getLength=function(){return this.state.contentsdata.length},t.exports=n},{"core/g3wobject":26,"core/utils/utils":92,"gui/component/component":140,"gui/panel":193}],224:[function(e,t,r){t.exports={barstack:e("./barstack")}},{"./barstack":223}],225:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l(this,e),this.stack=new d,this.setService(this),this.title="contents",this.contentsdata=this.stack.state.contentsdata,this.state.visible=!0;var t=new f({service:this});this.setInternalComponent(t),this.internalComponent.state=this.state}var a=e("components/ViewportContentsViewer.vue"),o=n(a),s=e("core/utils/utils"),l=s.base,u=s.inherit,c=e("gui/utils/utils"),d=c.barstack,p=e("gui/component/component"),f=Vue.extend(o);u(i,p);var h=i.prototype;h.setContent=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred(),n=t.push||!1,i=t.content;return n?this.addContent(i,t).then(function(){return r.resolve(t)}):this.clearContents().then(function(){e.addContent(i,t).then(function(){return r.resolve(t)})}),this.setOpen(!0),r.promise()},h.addContent=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=$.Deferred();r.parent=this.internalComponent.$el,r.append=!0;var i=this.stack.push(e,r);return i.then(function(){t.contentsdata=t.stack.state.contentsdata,t.updateContentVisibility(),n.resolve()}),n.promise()},h.removeContent=function(){return this.setOpen(!1),this.clearContents()},h.popContent=function(){var e=this;return this.stack.pop().then(function(){e.contentsdata=e.stack.state.contentsdata,e.updateContentVisibility()})},h.getComponentByClass=function(e){var t=void 0,r=this.stack.getContentData();return r.forEach(function(r){if(r.content instanceof e)return t=r.content,!1}),t},h.getComponentById=function(e){var t=void 0,r=this.stack.getContentData();return r.forEach(function(r){if(r.content.id==e)return t=r.content,!1}),t},h.getContentData=function(){return this.stack.getContentData()},h.getCurrentContentData=function(){return this.stack.getCurrentContentData()},h.getPreviousContentData=function(){return this.stack.getPreviousContentData()},h.updateContentVisibility=function(){var e=$(this.internalComponent.$el).children();e.hide(),e.last().show()},h.clearContents=function(){var e=this;return this.stack.clear().then(function(){return e.contentsdata=e.stack.state.contentsdata})},h.layout=function(e,t){var r=this,n=$(this.internalComponent.$el);Vue.nextTick(function(){var t=r.stack.state.contentsdata,i=n.parent().height()-n.siblings(".close-panel-block").outerHeight(!0)-10;n.height(i),n.children().first().height(i),t.forEach(function(t){"function"==typeof t.content.layout&&t.content.layout(e+.5,i)})})},t.exports=i},{"components/ViewportContentsViewer.vue":340,"core/utils/utils":92,"gui/component/component":140,"gui/utils/utils":224}],226:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("services/viewport"),a=n(i),o=e("components/Viewport.vue"),s=n(o);t.exports={ViewportService:a["default"],ViewportComponent:s["default"]}},{"components/Viewport.vue":339,"services/viewport":399}],227:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}var i=e("mixins"),a=n(i);t.exports=a["default"]},{mixins:371}],228:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.wmsurls,n=void 0===r?[]:r;this.projectId=d.getCurrentProject().getId(),this.panel,this.state={adminwmsurls:n,localwmsurls:[]},this.loadClientWmsUrls().then(function(t){return e.state.localwmsurls=t}),d.onafter("setCurrentProject",function(){var t=i(regeneratorRuntime.mark(function r(t){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e.projectId=t.getId(),e.state.adminwmsurls=t.wmsurls||[],r.next=4,e.loadClientWmsUrls();case 4:e.state.localwmsurls=r.sent;case 5:case"end":return r.stop()}},r,e)}));return function(e){return t.apply(this,arguments)}}())}Object.defineProperty(r,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=e("./vue/panel/wmslayerspanel"),l=n(s),u=e("../../constant"),c=e("core/applicationservice"),d=e("core/project/projectsregistry"),p=e("core/utils/utils"),f=p.uniqueId,h=e("core/data/routerservice"),v=e("gui/gui"),g=a.prototype;g.loadClientWmsUrls=i(regeneratorRuntime.mark(function m(){var e,t=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=this.getLocalWMSData(),void 0===e&&(e={urls:[],wms:{}},this.updateLocalWMSData(e)),r.next=4,v.isReady();case 4:return setTimeout(function(){var r=v.getService("map");r.on("remove-external-layer",function(e){return t.deleteWms(e)}),r.on("change-layer-position-map",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.id,n=e.position;return t.changeLayerData(r,{key:"position",value:n})}),r.on("change-layer-opacity",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.id,n=e.opacity;return t.changeLayerData(r,{key:"opacity",value:n})}),r.on("change-layer-visibility",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.id,n=e.visible;return t.changeLayerData(r,{key:"visible",value:n})}),Object.keys(e.wms).forEach(function(r){e.wms[r].forEach(function(e){t.loadWMSLayerToMap(o({url:r},e))})})}),r.abrupt("return",e.urls);case 6:case"end":return r.stop()}},m,this)})),g.changeLayerData=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.getLocalWMSData();Object.keys(r.wms).find(function(n){var i=r.wms[n],a=i.findIndex(function(t){return t.name==e});if(a!==-1)return i[a][t.key]=t.value,!0}),this.updateLocalWMSData(r)},g.getRequestStatusObject=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.error,r=void 0!==t&&t,n=e.added,i=void 0!==n&&n;return{error:r,added:i}},g.addNewWmsUrl=function(){var e=i(regeneratorRuntime.mark(function t(e){var r,n,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.state.localwmsurls.find(function(t){return t==e}),n=this.getRequestStatusObject({added:!!r}),r){t.next=13;break}return t.prev=3,t.next=6,this.getWMSLayers(e);case 6:i=t.sent,i.result?(a=this.getLocalWMSData(),this.state.localwmsurls.push(e),a.urls=this.state.localwmsurls,this.updateLocalWMSData(a),i.wmsurl=e,this.showWmsLayersPanel(i)):n.error=!0,t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](3),n.error=!0;case 13:return t.abrupt("return",n);case 14:case"end":return t.stop()}},t,this,[[3,10]])}));return function(t){return e.apply(this,arguments)}}(),g.deleteWms=function(e){var t=this.getLocalWMSData();Object.keys(t.wms).find(function(r){var n=t.wms[r],i=n.findIndex(function(t){return t.name==e});if(i!==-1)return n.splice(i,1),0==n.length&&delete t.wms[r],!0}),this.updateLocalWMSData(t)},g.checkIfWMSAlreadyAdded=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.layers,n=void 0===r?[]:r,i=!1,a=this.getLocalWMSData();return a.wms[t]&&(i=!!a.wms[t].find(function(e){var t=e.layers,r=n.length;if(t.length===r)return n.reduce(function(e,r){return e+t.indexOf(r)!==-1?1:0},0)===r})),i},g.deleteWmsUrl=function(e){this.state.localwmsurls=this.state.localwmsurls.filter(function(t){return t!==e});var t=this.getLocalWMSData();t.urls=this.state.localwmsurls,this.updateLocalWMSData(t)},g.loadWMSDataAndShowWmsLayersPanel=function(){var e=i(regeneratorRuntime.mark(function t(e){var r,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.getRequestStatusObject(),t.prev=1,t.next=4,this.getWMSLayers(e);case 4:n=t.sent,r.error=!n.result,n.result&&(n.wmsurl=e,this.showWmsLayersPanel(n)),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](1),
r.error=!0;case 12:return t.abrupt("return",r);case 13:case"end":return t.stop()}},t,this,[[1,9]])}));return function(t){return e.apply(this,arguments)}}(),g.showWmsLayersPanel=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.panel=new l["default"]({service:this,config:e}),this.panel.show(),this.panel},g.getWMSLayers=function(){var e=i(regeneratorRuntime.mark(function t(e){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={result:!1,layers:[],info_formats:[],"abstract":null,map_formats:[],title:null},t.prev=1,t.next=4,h.getData("ows:wmsCapabilities",{inputs:{url:e},outputs:!1});case 4:r=t.sent,t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](1);case 10:if(!r.result){t.next=12;break}return t.abrupt("return",r);case 12:return t.abrupt("return",r);case 13:case"end":return t.stop()}},t,this,[[1,7]])}));return function(t){return e.apply(this,arguments)}}(),g.loadWMSLayerToMap=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,r=e.name,n=e.epsg,i=e.position,a=e.opacity,o=e.visible,s=void 0===o||o,l=e.layers,u=void 0===l?[]:l,c=v.getService("map");return c.addExternalWMSLayer({url:t,name:r,layers:u,epsg:n,position:i,visible:s,opacity:a})},g.addWMSlayer=i(regeneratorRuntime.mark(function y(){var e,t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.url,a=n.name,o=void 0===a?"wms_"+f():a,s=n.epsg,l=n.position,u=n.layers,c=void 0===u?[]:u,d=n.opacity,p=void 0===d?1:d,h=n.visible,g=void 0===h||h;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e=this.getLocalWMSData(),t={url:i,name:o,layers:c,epsg:s,position:l,visible:g,opacity:p},void 0===e.wms[i]?e.wms[i]=[t]:e.wms[i].push(t),this.updateLocalWMSData(e),n.prev=4,n.next=7,this.loadWMSLayerToMap(t);case 7:n.next=15;break;case 9:n.prev=9,n.t0=n["catch"](4),r=v.getService("map"),r.removeExternalLayer(o),this.deleteWms(o),setTimeout(function(){v.showUserMessage({type:"warning",message:"sidebar.wms.layer_add_error"})});case 15:this.panel.close();case 16:case"end":return n.stop()}},y,this,[[4,9]])})),g.getLocalWMSData=function(){return c.getLocalItem(u.LOCALSTORAGE_EXTERNALWMS_ITEM)&&c.getLocalItem(u.LOCALSTORAGE_EXTERNALWMS_ITEM)[this.projectId]},g.updateLocalWMSData=function(e){var t=c.getLocalItem(u.LOCALSTORAGE_EXTERNALWMS_ITEM)||{};t[this.projectId]=e,c.setLocalItem({id:u.LOCALSTORAGE_EXTERNALWMS_ITEM,data:t})},g.clear=function(){this.panel=null},r["default"]=a},{"../../constant":5,"./vue/panel/wmslayerspanel":229,"core/applicationservice":7,"core/data/routerservice":15,"core/project/projectsregistry":83,"core/utils/utils":92,"gui/gui":150}],229:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.service,r=e.config;this.setService(t),this.id=c(),this.title="sidebar.wms.panel.title";var n=p,i=new n({service:t,config:r});this.setInternalPanel(i),this.unmount=function(){return l(this,"unmount").then(function(){t.clear()})}}Object.defineProperty(r,"__esModule",{value:!0});var a=e("components/WMSLayersPanel.vue"),o=n(a),s=e("core/utils/utils"),l=s.base,u=s.inherit,c=s.uniqueId,d=e("gui/panel"),p=Vue.extend(o);u(i,d),r["default"]=i},{"components/WMSLayersPanel.vue":342,"core/utils/utils":92,"gui/panel":193}],230:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};d(this,e),this._service=new u["default"](e),this.title="WMS";var t=new v({service:this._service});t.state=this._service.state,this.setInternalComponent(t),this._setOpen=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.internalComponent.state.open=e,e&&f.closeContent()}}var o=e("components/WMS.vue"),s=i(o),l=e("../service"),u=n(l),c=e("core/utils/utils"),d=c.base,p=c.inherit,f=e("gui/gui"),h=e("gui/component/component"),v=Vue.extend(s);p(a,h),t.exports=a},{"../service":228,"components/WMS.vue":341,"core/utils/utils":92,"gui/component/component":140,"gui/gui":150}],231:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=e("core/applicationstate"),o=n(a),s=e("gui/gui");t.exports=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.steps,r=void 0===t?{}:t;return{data:function(){return{steps:r,currentStep:0}},watch:{steps:{handler:function(e){var t=this;Object.values(e).find(function(e,r){if(!e.done)return t.currentStep=r,!0})},deep:!1}},render:function(e){var t=this;return e("ul",{style:{alignSelf:"flex-start",listStyle:"none",padding:(o["default"].ismobile?5:10)+"px !important",marginBottom:0}},Object.values(this.steps).map(function(r,n){var a,o={current:!r.done&&n===t.currentStep,done:r.done,todo:!r.done&&n!==t.currentStep};return e("li",{style:{fontWeight:(r.done||!r.done&&n===t.currentStep)&&"bold"||null,marginBottom:"5px",color:r.done&&"green",display:r.buttonnext&&"inline-flex"}},[e("i",{style:{marginRight:"5px",fontWeight:r.done&&"bold"},"class":(a={},i(a,s.getFontClass("arrow-right"),o.current),i(a,s.getFontClass("empty-circle"),o.todo),i(a,s.getFontClass("success"),o.done),a)}),e("span",{directives:[{name:r.directive,value:r.description}],style:{display:r.buttonnext?"inline-flex":"inline",flexDirection:r.buttonnext&&"row-reverse"}}),void 0!==r.dynamic&&e("span",{style:{alignSelf:"center",padding:"3px"}},r.dynamic),r.buttonnext&&e("button",{on:{click:function(){r.done=!0,r.buttonnext.done()}},directives:[{name:"t",value:"sdk.workflow.next"}],style:{fontWeight:"bold"},"class":{btn:!0,"btn-success":!0,"g3w-disabled":r.buttonnext.disabled}})])}))}}}},{"core/applicationstate":8,"gui/gui":150}],232:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();e("regenerator-runtime");var s=e("components/App.vue"),l=n(s),u=e("components/GlobalImage.vue"),c=n(u),d=e("components/GlobalGallery.vue"),p=n(d),f=e("components/GlobalGeo.vue"),h=n(f),v=e("components/GlobalSkeleton.vue"),g=n(v),m=e("components/GlobalBarLoader.js"),y=n(m),b=e("components/GlobalProgressBar.js"),w=n(b),x=e("components/GlobalHelpDiv.vue"),S=n(x),C=e("components/GlobalResize.vue"),L=n(C),k=e("components/GlobalLayerPositions.vue"),M=n(k),T=e("components/GlobalDateTime.vue"),E=n(T),I=e("components/GlobalRange.vue"),P=n(I),F=e("components/GlobalResizeIcon.vue"),O=n(F),R=e("components/GlobalTabs.vue"),j=n(R),A=e("components/GlobalDivider.vue"),N=n(A),G=e("directives/v-disabled"),D=n(G),V=e("directives/v-checked"),U=n(V),q=e("directives/v-selected-first"),B=n(q),z=e("directives/v-select2"),W=n(z),H=e("directives/v-t-tooltip"),Y=n(H),K=e("directives/v-t-html"),Z=n(K),Q=e("directives/v-t-placeholder"),X=n(Q),J=e("directives/v-t-title"),ee=n(J),te=e("directives/v-t"),re=n(te),ne=e("directives/v-t-plugin"),ie=n(ne),ae=e("directives/v-plugins"),oe=n(ae),se=e("directives/v-online"),le=n(se),ue=e("directives/v-download"),ce=n(ue),de=e("core/applicationstate"),pe=n(de),fe=e("core/applicationservice"),he=e("core/utils/utils"),ve=he.base,ge=he.inherit,me=he.toRawType,ye=e("core/i18n/i18n.service"),_e=ye.t,be=ye.tPlugin,we=e("core/g3wobject"),xe=e("gui/projectsmenu/projectsmenu"),Se=e("gui/component/componentsregistry"),Ce=e("gui/gui");window.g3wsdk=e("api"),Vue.component(c["default"].name,c["default"]),Vue.component(p["default"].name,p["default"]),Vue.component(h["default"].name,h["default"]),Vue.component(y["default"].name,y["default"]),Vue.component(w["default"].name,w["default"]),Vue.component(g["default"].name,g["default"]),Vue.component(S["default"].name,S["default"]),Vue.component(L["default"].name,L["default"]),Vue.component(M["default"].name,M["default"]),Vue.component(E["default"].name,E["default"]),Vue.component(P["default"].name,P["default"]),Vue.component(O["default"].name,O["default"]),Vue.component(j["default"].name,j["default"]),Vue.component(N["default"].name,N["default"]),Vue.filter("t",function(e){return _e(e)}),Vue.filter("tPlugin",function(e){return null!==e?be(e):""}),Vue.directive("disabled",D["default"]),Vue.directive("checked",U["default"]),Vue.directive("selected-first",B["default"]),Vue.directive("select2",W["default"]),Vue.directive("t-tooltip",Y["default"]),Vue.directive("t-html",Z["default"]),Vue.directive("t-placeholder",X["default"]),Vue.directive("t-title",ee["default"]),Vue.directive("t",re["default"]),Vue.directive("t-plugin",ie["default"]),Vue.directive("plugins",oe["default"]),Vue.directive("online",le["default"]),Vue.directive("download",ce["default"]),Vue.use({install:function(e){e.prototype.g3wtemplate={font:{"change-map":"fas fa-map-signs",map:"far fa-map",file:"fas fa-file-code",marker:"fas fa-map-marker-alt",relation:"fas fa-sitemap",tools:"fas fa-cogs",tool:"fas fa-cog",search:"fas fa-search",print:"fas fa-print",info:"fas fa-info-circle","info-circle":"fas fa-info-circle",globe:"fas fa-globe",mail:"fas fa-envelope",mobile:"fas fa-mobile",fax:"fas fa-fax",user:"fas fa-user",bars:"fas fa-bars",uncheck:"far fa-square",check:"far fa-check-square",filluncheck:"fas fa-square",table:"fas fa-table",trash:"fas fa-trash","trash-o":"far fa-trash-alt",pencil:"fas fa-pencil-alt","ellips-h":"fas fa-ellipsis-h","ellips-v":"fas fa-ellipsis-v","arrow-up":"fas fa-chevron-up","arrow-down":"fas fa-chevron-down","arrow-left":"fas fa-chevron-left","arrow-right":"fas fa-chevron-right","resize-h":"fas fa-arrows-alt-h","resize-v":"fas fa-arrows-alt-v","resize-default":"fas fa-compress","caret-up":"fas fa-caret-up","caret-down":"fas fa-caret-down","caret-left":"fas fa-caret-left","caret-right":"fas fa-caret-right","empty-circle":"far fa-circle","cloud-upload":"fas fa-cloud-upload-alt",spinner:"fas fa-spinner",minus:"fas fa-minus","minus-square":"far fa-minus-square",plus:"fas fa-plus","plus-circle":"fas fa-plus-circle","plus-square":"far fa-plus-square",grid:"fas fa-th",home:"fas fa-home",folder:"fas fa-folder","sign-out":"fas fa-sign-out-alt",close:"fas fa-times",time:"far fa-clock",calendar:"fas fa-calendar-alt",list:"fas fa-list-alt",link:"fas fa-link",unlink:"fas fa-unlink",eye:"far fa-eye","eye-close":"far fa-eye-slash",save:"far fa-save",pdf:"fas fa-file-pdf",image:"far fa-image",video:"far fa-file-video",unknow:"far fa-question-circle",zip:"far fa-file-archive",text:"far fa-file-alt",excel:"far fa-file-excel",xls:"far fa-file-excel",gpx:"fas fa-location-arrow",gpkg:"fas fa-box-open",shapefile:"fas fa-file-archive",csv:"fas fa-file-csv",geotiff:"fas fa-th",ppt:"far fa-file-powerpoint",circle:"fas fa-circle",calculator:"fas fa-calculator",picture:"far fa-image",keyboard:"far fa-keyboard","file-download":"fas fa-file-download",copy:"far fa-copy",draw:"fas fa-draw-polygon",chart:"fas fa-chart-bar","chart-line":"fas fa-chart-line","chart-area":"fas fa-chart-area","chart-pie":"fas fa-chart-pie",run:"fas fa-play",warning:"fas fa-exclamation-circle",alert:"fas fa-exclamation-triangle",crosshairs:"fas fa-crosshairs",success:"far fa-check-circle",back:"fas fa-chevron-circle-left","file-upload":"fas fa-file-upload",wifi:"fas fa-wifi",mouse:"fas fa-mouse","copy-paste":"far fa-copy","vector-square":"fas fa-vector-square",download:"fas fa-download",credits:"fas fa-euro-sign",filter:"fas fa-filter",plugin:"fas fa-plug",invert:"fas fa-exchange-alt",clear:"fas fa-broom",palette:"fas fa-palette",layers:"fas fa-layer-group","sign-in":"fas fa-sign-in-alt",language:"fas fa-language",target:"fas fa-bullseye",pin:"fas fa-map-pin",square:"far fa-square",move:"fas fa-arrows-alt",moon:"fas fa-moon",sun:"fas fa-sun",refresh:"fas fa-sync-alt",pause:"fas fa-pause","step-backward":"fas fa-step-backward","fast-backward":"fas fa-fast-backward","step-forward":"fas fa-step-forward","fast-forward":"fas fa-fast-forward",crop:"fas fa-crop-alt"},get:function(){},getInfo:function(){return{font:this.font}},addFontClass:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,r=e.className,n=void 0===this.font[t];return n&&(this.font[t]=r),n},getInfoString:function(){},getFontClass:function(e){return"undefined"!=typeof this.font[e]?this.font[e]:""}},e.mixin({methods:{isMobile:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){return isMobile.any})}})}},{}),Vue.mixin({inheritAttrs:!1});var Le=e("gui/sidebar/sidebar"),ke=e("gui/floatbar/floatbar"),Me=e("gui/viewport/viewport"),Te=e("gui/navbar/navbaritems"),Ee=$.LayoutManager;Ee.loading(!0);var Ie=function Pe(t){var r=t.ApplicationService,n=r.getConfig().layout||{};this._isMobile=isMobile.any,this._isIframe=n.iframe,this.sizes={sidebar:{width:0}},this.waitingoutputdataplace=null,this.init=function(){this._createApp()},this._createTemplateConfig=function(){var t=Vue.prototype.g3wtemplate,i=r.getConfig().apptitle||"G3W Suite",a=e("gui/viewport/contentsviewer"),o=e("gui/catalog/vue/catalog"),s=e("gui/search/vue/search"),l=e("gui/querybuilder/querybuilderuifactory"),u=e("gui/print/vue/print"),c=e("gui/metadata/vue/metadata"),d=e("gui/tools/vue/tools"),p=e("gui/wms/vue/wms"),f=e("gui/map/vue/map"),h=e("gui/queryresults/vue/queryresults");return{title:i,placeholders:{navbar:{components:[]},sidebar:{components:[new c({id:"metadata",open:!1,collapsible:!1,icon:t.getFontClass("file"),mobile:!0}),new u({id:"print",open:!1,collapsible:!0,icon:t.getFontClass("print"),mobile:!1}),new s({id:"search",open:!1,collapsible:!0,icon:t.getFontClass("search"),actions:[{id:"querybuilder","class":t.getFontClass("calculator")+" sidebar-button sidebar-button-icon",tooltip:"Query Builder",fnc:function(){Ce.closeContent(),Pe.Services.sidebar.closeOpenComponents(),l.show({type:"sidebar"})},style:{color:"#8DC3E3",padding:"6px",fontSize:"1.2em",borderRadius:"3px",marginRight:"5px"}}],mobile:!0}),new d({id:"tools",open:!1,collapsible:!0,icon:t.getFontClass("tools"),mobile:!0}),new p({id:"wms",open:!1,collapsible:!0,icon:t.getFontClass("layers"),mobile:!0}),new o({id:"catalog",open:!1,collapsible:!1,isolate:!0,icon:t.getFontClass("map"),mobile:!0,config:{legend:{config:n.legend}}})]},floatbar:{components:[]}},othercomponents:[new h({id:"queryresults"})],viewport:{components:{map:new f({id:"map"}),content:new a({id:"contents"})}}}},this._createApp=function(){this._setDataTableLanguage();var e=this;return(isMobile.any||this._isIframe)&&$("body").addClass("sidebar-collapse"),new Vue({el:"#app",created:function(){e._setupInterface(),e._setupLayout(),e._setUpServices(),e.templateConfig=e._createTemplateConfig(),this.$watch(function(){return pe["default"].lng},function(){e._setDataTableLanguage()})},mounted:function(){function t(){return r.apply(this,arguments)}var r=i(regeneratorRuntime.mark(function n(){var t;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.$nextTick();case 2:return e._buildTemplate(),e._setUpTemplateDependencies(this),$(document).localize(),e._setViewport(e.templateConfig.viewport),t=$(".navbar").css("background-color"),Ce.skinColor=t&&"#"+t.substr(4,t.indexOf(")")-4).split(",").map(function(e){return parseInt(e).toString(16)}).join(""),r.next=10,this.$nextTick();case 10:e.emit("ready"),e.sizes.sidebar.width=$("#g3w-sidebar").width(),Ce.ready();case 13:case"end":return r.stop()}},n,this)}));return t}()})},this._setupLayout=function(){isMobile.any||$("<style type='text/css'> .ol-control-tl {top: 7px;left:43px;}</style>").appendTo("head"),Vue.component("sidebar",Le.SidebarComponent),Vue.component("navbarleftitems",Te.components.left),Vue.component("navbarrightitems",Te.components.right),Vue.component("viewport",Me.ViewportComponent),Vue.component("floatbar",ke.FloatbarComponent),Vue.component("app",l["default"])},this._setDataTableLanguage=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t={language:{sSearch:"",searchPlaceholder:_e("dosearch"),sLengthMenu:_e("dataTable.lengthMenu"),paginate:{previous:_e("dataTable.previous"),next:_e("dataTable.next")},info:_e("dataTable.info"),zeroRecords:_e("dataTable.nodatafilterd"),infoFiltered:""}};$.extend($.fn.dataTableExt.oStdClasses,{sFilterInput:"form-control search"}),e?e.dataTable({oLanguage:t}):$.extend(!0,$.fn.dataTable.defaults,t)},this._addRoutes=function(){var e=r.getRouterService(),t=Ce.getComponent("map").getService();e.addRoute("map/zoomto/{coordinate}/:zoom:",function(e,r){e=_.map(e.split(","),function(e){return Number(e)}),r=r?Number(r):null,e.length&&t.on("ready",function(){this.zoomTo(e,r)})})},this._setUpServices=function(){Object.keys(Pe.Services).forEach(function(e){var t=Pe.Services[e];r.registerService(e,t)}),Object.values(Ce.getComponents()).forEach(function(e){r.registerService(e.id,e.getService())}),Pe.Services.viewport.on("resize",function(){return Ce.emit("resize")})},this._buildTemplate=function(){var e=this;ke.FloatbarService.init(Ee);var t=this.templateConfig.placeholders;Object.entries(t).forEach(function(t){var r=o(t,2),n=r[0],i=r[1];e._addComponents(i.components,n)}),this._addOtherComponents()},this._addOtherComponents=function(){this.templateConfig.othercomponents&&this._addComponents(this.templateConfig.othercomponents)},this._setViewport=function(e){e&&(Pe.Services.viewport.init(e),this._addComponents(e.components))},this._addComponent=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._addComponents([e],t,r),!0},this._addComponents=function(e,t,n){var i=!0;if(t&&Pe.PLACEHOLDERS.indexOf(t)>-1){var a=Pe.Services[t];a&&(i=a.addComponents(e,n))}Object.entries(e).forEach(function(e){var t=o(e,2),n=(t[0],t[1]);i&&(Se.registerComponent(n),r.registerService(n.id,n.getService()))})},this._removeComponent=function(e,t,r){var n=Se.unregisterComponent(e);t&&Pe.Services[t]&&Pe.Services[t].removeComponent(n,r)},this._showModalOverlay=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments[1],r=Ce.getService("map");e?r.startDrawGreyCover(t):r.stopDrawGreyCover()},this._isSidebarVisible=function(){return!$("body").hasClass("sidebar-collapse")},this._showSidebar=function(){$("body").addClass("sidebar-open"),$("body").removeClass("sidebar-collapse")},this._hideSidebar=function(){$("body").removeClass("sidebar-open"),$("body").addClass("sidebar-collapse")},this._setUpTemplateDependencies=function(e){Ce.isMobile=function(){return isMobile.any},Ce.getTemplateInfo=function(){return e.g3wtemplate.getInfo()},Ce.getTemplateInfo=function(){return e.g3wtemplate.getInfo()},Ce.getFontClass=function(t){return e.g3wtemplate.getFontClass(t)}},Ce.errorToMessage=function(e){var t="server_error";switch(me(e)){case"Error":t="CLIENT - "+e.message;break;case"Object":if(e.responseJSON){if(e=e.responseJSON,e.result===!1){var r=e.error,n=r.code,i=void 0===n?"":n,a=r.data,o=void 0===a?"":a,s=r.message,l=void 0===s?"":s;t=i.toUpperCase()+" "+o+" "+l}}else e.responseText&&(t=e.responseText);break;case"Array":t=e.map(function(e){return Ce.errorToMessage(e)}).join(" ");break;case"String":default:t=e}return t},this._setupInterface=function(){var t=this;Ce.layout=Ee,Ce.getSize=function(e){var r=e.element,n=e.what;if(r&&n)return t.sizes[r][n]},Ce.addComponent=this._addComponent.bind(this),Ce.removeComponent=this._removeComponent.bind(this),Ce.getResourcesUrl=function(){return r.getConfig().resourcesurl},Ce.showList=ke.FloatbarService.showPanel.bind(ke.FloatbarService),Ce.closeList=ke.FloatbarService.closePanel.bind(ke.FloatbarService),Ce.hideList=ke.FloatbarService.hidePanel.bind(ke.FloatbarService),Ce.showTable=function(){},Ce.closeTable=function(){},Ce.outputDataPlace=function(){var e=i(regeneratorRuntime.mark(function t(e){var r,n,o,s,l,u,c,d,p,f,h,v,g=this,m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r={condition:!0,add:!1,loading:!0},n=m.title,o=void 0===n?"":n,s=m.show,l=void 0===s?r:s,u=m.before,c=m.after,d="Object"!==me(l)?{condition:l,add:!1,loading:!0}:a({},r,l),p=d.condition,f=d.add,h=d.loading,t.t0=this.waitingoutputdataplace,!t.t0){t.next=8;break}return t.next=8,this.waitingoutputdataplace.stop();case 8:v=f?Ce.getService("queryresults"):h&&this.showContentFactory("query")(o),this.waitingoutputdataplace=function(){var t=!1;return i(regeneratorRuntime.mark(function r(){var n,i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e;case 3:if(n=r.sent,r.t0=u,!r.t0){r.next=8;break}return r.next=8,u(n);case 8:n.usermessage&&Ce.showUserMessage({type:n.usermessage.type,message:n.usermessage.message,autoclose:n.usermessage.autoclose}),t||(i="Function"===me(p)?p(n):"Boolean"!==me(p)||p,i?(v?v:g.showContentFactory("query")(o)).setQueryResponse(n,{add:f}):Ce.closeContent(),c&&c(n)),r.next=17;break;case 12:r.prev=12,r.t1=r["catch"](0),a=g.errorToMessage(r.t1),g.showUserMessage({type:"alert",message:a,textMessage:!0}),g.closeContent();case 17:return r.prev=17,t||(g.waitingoutputdataplace=null),r.finish(17);case 20:case"end":return r.stop()}},r,g,[[0,12,17,20]])}))(),{stop:function(){function e(){return r.apply(this,arguments)}var r=i(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=!0;case 1:case"end":return e.stop()}},n,g)}));return e}()}}();case 10:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),Ce.showContentFactory=function(e){var t=void 0;switch(e){case"query":t=Ce.showQueryResults;break;case"form":t=Ce.showForm}return t},Ce.showForm=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.perc,n=t.split,i=void 0===n?"h":n,a=t.push,o=t.showgoback,s=e("gui/form/vue/form"),l=t.formComponent?new t.formComponent(t):new s(t),u=l.getService();return Ce.setContent({perc:r,content:l,split:i,push:!!a,showgoback:!!o,closable:!1}),u},Ce.closeForm=function(){this.emit("closeform",!1),Me.ViewportService.removeContent(),Ce.setModal(!1)},Ce.disableElement=function(e){var t=e.element,r=e.disable;r&&$(t).addClass("g3w-disabled")||$(t).removeClass("g3w-disabled")},Ce.disableContent=function(e){Me.ViewportService.disableContent(e)},Ce.disablePanel=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Ce.disableElement({element:"#g3w-sidebarpanel-placeholder",disable:e})},Ce.hideContent=function(e,t){return Me.ViewportService.hideContent(e,t)},Ce.closeContent=function(){return this.emit("closecontent",!1),Me.ViewportService.closeContent()},Ce.closeOpenSideBarComponent=function(){Pe.Services.sidebar.closeOpenComponents()},Ce.showQueryResults=function(e,t){var r=Ce.getComponent("queryresults"),n=r.getService();return n.reset(),t&&n.setQueryResponse(t),Ce.showContextualContent({content:r,title:"info.title",post_title:e}),n},Ce.addNavbarItem=function(e){Te.NavbarItemsService.addItem(e)},Ce.removeNavBarItem=function(){},Ce.showPanel=Le.SidebarService.showPanel.bind(Le.SidebarService),Ce.closePanel=Le.SidebarService.closePanel.bind(Le.SidebarService),Ce.disableApplication=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];r.disableApplication(e)},Ce.showUserMessage=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Me.ViewportService.showUserMessage(e)},Ce.closeUserMessage=function(){Me.ViewportService.closeUserMessage()},Ce.notify={warning:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Ce.showUserMessage({type:"warning",message:e,autoclose:t})},error:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Ce.showUserMessage({type:"alert",message:e,autoclose:t})},info:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Ce.showUserMessage({type:"info",message:e,autoclose:t})},success:function(e){Ce.showUserMessage({type:"success",message:e,autoclose:!0})}},Ce.dialog=bootbox,Ce.showModalDialog=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Ce.dialog.dialog(e)},Ce.showSpinner=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.container||"body",r=e.id||"loadspinner",n=e.where||"prepend",i=e.style||"",a=e.transparent?"background-color: transparent":"",o=e.center?"margin: auto":"";$("#"+r).length||$(t)[n].call($(t),'<div id="'+r+'" class="spinner-wrapper '+i+'" style="'+a+'"><div class="spinner '+i+'" style="'+o+'"></div></div>')},Ce.hideSpinner=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"loadspinner";$("#"+e).remove()},Ce.showFloatbar=function(){ke.FloatbarService.open()},Ce.hideFloatbar=function(){ke.FloatbarService.close()},Ce.showSidebar=this._showSidebar.bind(this),Ce.hideSidebar=this._hideSidebar.bind(this),Ce.isSidebarVisible=this._isSidebarVisible.bind(this),Ce.reloadComponents=function(){Pe.Services.sidebar.reloadComponents()},Ce.setModal=this._showModalOverlay.bind(this),Ce.showFullModal=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.element,r=void 0===t?"#full-screen-modal":t,n=e.show,i=void 0===n||n;i?$(r).modal("show"):$(r).modal("hide")},Ce.disableSideBar=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];pe["default"].gui.sidebar.disabled=e},Ce.setPrimaryView=function(e){Me.ViewportService.setPrimaryView(e)},Ce.showMap=function(){Me.ViewportService.showMap()},Ce.showContextualMap=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30,t=arguments[1];Me.ViewportService.showContextualMap({perc:e,split:t})},Ce.setContextualMapComponent=function(e){Me.ViewportService.setContextualMapComponent(e)},Ce.resetContextualMapComponent=function(){Me.ViewportService.resetContextualMapComponent()},Ce.showContent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Ce.setLoadingContent(!1),e.perc=t._isMobile?100:e.perc,Ce.setContent(e),!0},Ce.showContextualContent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.perc=t._isMobile?100:e.perc,Ce.setContent(e),!0},Ce.pushContent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.perc=t._isMobile?100:e.perc,e.push=!0,Ce.setContent(e)},Ce.pushContextualContent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.perc=t._isMobile?100:e.perc,Ce.pushContent(e)},Ce.popContent=function(){Me.ViewportService.popContent()},Ce.getContentLength=function(){return Me.ViewportService.contentLength()},Ce.getCurrentContentTitle=function(){return Me.ViewportService.getCurrentContentTitle()},Ce.changeCurrentContentTitle=function(e){Me.ViewportService.changeCurrentContentTitle(e)},Ce.getCurrentContent=function(){return Me.ViewportService.getCurrentContent()},Ce.toggleFullViewContent=function(){Me.ViewportService.toggleFullViewContent()},Ce.resetToDefaultContentPercentage=function(){Me.ViewportService.resetToDefaultContentPercentage()},Ce.getProjectMenuDOM=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.projects,r=e.host,n=e.cbk,i={projects:t&&Array.isArray(t)&&t,cbk:n,host:r},a=new xe(i).getInternalComponent();return a.$mount().$el},Ce.setCloseUserMessageBeforeSetContent=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._closeUserMessageBeforeSetContent=e},Ce._setContent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t._closeUserMessageBeforeSetContent&&Ce.closeUserMessage(),e.content=e.content||null,e.title=e.title||"",e.push=!!_.isBoolean(e.push)&&e.push,e.perc=t._isMobile?100:e.perc,e.split=e.split||"h",e.backonclose=!!_.isBoolean(e.backonclose)&&e.backonclose,e.showtitle=!_.isBoolean(e.showtitle)||e.showtitle,Me.ViewportService.showContent(e)},Ce.hideClientMenu=function(){r.getConfig().user=null},Ce.hideChangeMaps=function(){r.getConfig().projects=[]},Ce.getTemplateClasses=function(){return BootstrapVersionClasses},Ce.getTemplateClass=function(e){var t=e.element,r=e.type;return BootstrapVersionClasses[t][r]},Ce.setLoadingContent=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Pe.Services.viewport.setLoadingContent(e),e&&new Promise(function(e){setTimeout(e,200)})},Ce.openProjectsMenu=function(){var e=Ce.getComponent("contents");e.getComponentById("projectsmenu")?Ce.closeContent():(this.isMobile()&&(Ce.hideSidebar(),$("#main-navbar.navbar-collapse").removeClass("in")),Pe.Services.sidebar.closeOpenComponents(),Ce.setContent({content:new xe,title:"",perc:100}))}},ve(this)};ge(Ie,we),Ie.PLACEHOLDERS=["navbar","sidebar","viewport","floatbar"],Ie.Services={navbar:null,sidebar:Le.SidebarService,viewport:Me.ViewportService,floatbar:Le.FloatbarService},Ie.fail=function(t){var r=t.language,n=void 0===r?"en":r,i=t.error;Ee.loading(!1);var o={it:{error:i||"Errore di connessione",at_moment:"Al momento non  possibile caricare la mappa",f5:"Premi Ctrl+F5"},en:{error:i||"Connection error",at_moment:"At the moment is not possible show map",f5:"Press Ctrl+F5"}},s=Vue.compile(e("gui/templates/500.html"));new Vue(a({el:"#app"},s,{data:{messages:o[n]}}))},fe.init().then(function(){var e=new Ie({ApplicationService:fe});e.on("ready",function(){return fe.postBootstrap()}),e.init()})["catch"](function(e){var t=e.error,r=void 0===t?null:t,n=e.language;r&&(r.responseJSON&&r.responseJSON.error.data?r=r.responseJSON.error.data:r.statusText&&(r=r.statusText)),Ie.fail({language:n,error:r})})},{api:3,"components/App.vue":233,"components/GlobalBarLoader.js":256,"components/GlobalDateTime.vue":257,"components/GlobalDivider.vue":258,"components/GlobalGallery.vue":259,"components/GlobalGeo.vue":260,"components/GlobalHelpDiv.vue":261,"components/GlobalImage.vue":262,"components/GlobalLayerPositions.vue":263,"components/GlobalProgressBar.js":264,"components/GlobalRange.vue":265,"components/GlobalResize.vue":266,"components/GlobalResizeIcon.vue":267,"components/GlobalSkeleton.vue":268,"components/GlobalTabs.vue":269,"core/applicationservice":7,"core/applicationstate":8,"core/g3wobject":26,"core/i18n/i18n.service":27,"core/utils/utils":92,"directives/v-checked":345,"directives/v-disabled":346,"directives/v-download":347,"directives/v-online":348,"directives/v-plugins":349,"directives/v-select2":350,"directives/v-selected-first":351,"directives/v-t":357,"directives/v-t-html":352,"directives/v-t-placeholder":353,"directives/v-t-plugin":354,"directives/v-t-title":355,"directives/v-t-tooltip":356,"gui/catalog/vue/catalog":137,"gui/component/componentsregistry":142,"gui/floatbar/floatbar":147,"gui/form/vue/form":149,"gui/gui":150,"gui/map/vue/map":187,"gui/metadata/vue/metadata":191,"gui/navbar/navbaritems":192,"gui/print/vue/print":196,"gui/projectsmenu/projectsmenu":199,"gui/querybuilder/querybuilderuifactory":200,"gui/queryresults/vue/queryresults":205,"gui/search/vue/search":213,"gui/sidebar/sidebar":215,"gui/templates/500.html":220,
"gui/tools/vue/tools":222,"gui/viewport/contentsviewer":225,"gui/viewport/viewport":226,"gui/wms/vue/wms":230,"regenerator-runtime":"regenerator-runtime"}],233:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("vue-cookie-law"),a=t(i),o=e("components/HeaderItem.vue"),s=t(o),l=e("core/applicationservice"),u=e("core/project/projectsregistry"),c=e("core/utils/utils"),d=c.uniqueId,p=e("core/i18n/i18n.service"),f=p.t,h=e("gui/gui"),v=e("gui/vue/vue.mixins"),g=v.resizeMixin;if("undefined"==typeof jQuery)throw new Error("LayoutManager requires jQuery");$.LayoutManager=$.LayoutManager||{options:{navbarMenuSlimscroll:!0,navbarMenuSlimscrollWidth:"0px",navbarMenuHeight:"200px",animationSpeed:"fast",sidebarToggleSelector:"[data-toggle='offcanvas']",sidebarPushMenu:!0,sidebarSlimScroll:!1,sidebarExpandOnHover:!1,enableBoxRefresh:!0,enableFastclick:!0,enableControlSidebar:!0,controlSidebarOptions:{toggleBtnSelector:"[data-toggle='control-sidebar']",selector:".control-sidebar",slide:!0},enableBoxWidget:!0,boxWidgetOptions:{boxWidgetIcons:{collapse:"fa-minus",open:"fa-plus",remove:"fa-times"},boxWidgetSelectors:{remove:'[data-widget="remove"]',collapse:'[data-widget="collapse"]'}},directChat:{enable:!0,contactToggleSelector:'[data-widget="chat-pane-toggle"]'},colors:{lightBlue:"#3c8dbc",red:"#f56954",green:"#00a65a",aqua:"#00c0ef",yellow:"#f39c12",blue:"#0073b7",navy:"#001F3F",teal:"#39CCCC",olive:"#3D9970",lime:"#01FF70",orange:"#FF851B",fuchsia:"#F012BE",purple:"#8E24AA",maroon:"#D81B60",black:"#222222",gray:"#d2d6de"},screenSizes:{xs:480,sm:768,md:992,lg:1200}},_init:function(){"use strict";return $.LayoutManager.layout={activate:function(){var e=this;e.fix(),e.fixSidebar(),$(window,".wrapper").resize(function(){e.fix(),e.fixSidebar()})},fix:function(){var e=$(".main-header").outerHeight()+$(".main-footer").outerHeight(),t=$(window).height(),r=$(".sidebar").height();if($("body").hasClass("fixed"))$(".content-wrapper, .right-side").css("min-height",t-$(".main-footer").outerHeight()),$(".content-wrapper, .right-side").css("height",t-$(".main-footer").outerHeight());else{var n=void 0;t>=r?($(".content-wrapper, .right-side").css("min-height",t-e),n=t-e):($(".content-wrapper, .right-side").css("min-height",r),n=r);var i=$($.LayoutManager.options.controlSidebarOptions.selector);"undefined"!=typeof i&&i.height()>n&&$(".content-wrapper, .right-side").css("min-height",i.height())}},fixSidebar:function(){return $("body").hasClass("fixed")?("undefined"==typeof $.fn.slimScroll&&window.console&&window.console.error("Error: the fixed layout requires the slimscroll plugin!"),void($.LayoutManager.options.sidebarSlimScroll&&!isMobile.any?"undefined"!=typeof $.fn.slimScroll&&($("#g3w-sidebar").slimScroll({destroy:!0}).height("auto"),$("#g3w-sidebar").slimScroll({touchScrollStep:50,height:$(window).height()-$(".navbar-header").height()-10+"px",color:"rgba(255,255,255,0.7)",size:"3px"})):($(".sidebar").css({height:$(window).height()-$(".navbar-header").height()+"px"}),$(".sidebar").css("overflow-y","auto")))):void("undefined"!=typeof $.fn.slimScroll&&$(".sidebar").slimScroll({destroy:!0}).height("auto"))}},$.LayoutManager.pushMenu={activate:function(e){var t=$.LayoutManager.options.screenSizes;$(e).on("click",function(e){e.preventDefault(),$(window).width()>t.sm-1?$("body").hasClass("sidebar-collapse")?$("body").removeClass("sidebar-collapse").trigger("expanded.pushMenu"):$("body").addClass("sidebar-collapse").trigger("collapsed.pushMenu"):$("body").hasClass("sidebar-open")?$("body").removeClass("sidebar-open").removeClass("sidebar-collapse").trigger("collapsed.pushMenu"):$("body").addClass("sidebar-open").trigger("expanded.pushMenu")}),($.LayoutManager.options.sidebarExpandOnHover||$("body").hasClass("fixed")&&$("body").hasClass("sidebar-mini"))&&this.expandOnHover()},expandOnHover:function(){var e=this,t=$.LayoutManager.options.screenSizes.sm-1;$(".main-sidebar").hover(function(){$("body").hasClass("sidebar-mini")&&$("body").hasClass("sidebar-collapse")&&$(window).width()>t&&e.expand()},function(){$("body").hasClass("sidebar-mini")&&$("body").hasClass("sidebar-expanded-on-hover")&&$(window).width()>t&&e.collapse()})},expand:function(){$("body").removeClass("sidebar-collapse").addClass("sidebar-expanded-on-hover")},collapse:function(){$("body").hasClass("sidebar-expanded-on-hover")&&$("body").removeClass("sidebar-expanded-on-hover").addClass("sidebar-collapse")}},$.LayoutManager.tree=function(e){var t=this,r=$.LayoutManager.options.animationSpeed;$(document).on("click",e+" li a",function(e){var n=$(this),i=n.next();if(i.is(".treeview-menu")&&i.is(":visible"))i.slideUp(r,function(){i.parent("li.treeview").removeClass("active"),i.removeClass("menu-open")});else if(i.is(".treeview-menu")&&!i.is(":visible")){var a,o=n.parents("ul").first(),s=n.parent("li"),l=s.siblings(),u=(o.height()-o.find("li.header").outerHeight(),s.outerHeight());l.not(".header").each(function(e,t){u+=$(t).find("a").outerHeight()});var c=o.find("ul.treeview-menu:visible").slideUp(r);c.removeClass("menu-open"),i.slideDown(r,function(){i.addClass("menu-open"),a=o.find("li.treeview.active"),a.removeClass("active"),s.addClass("active"),t.layout.fix()})}i.is(".treeview-menu")&&e.preventDefault()})},$.LayoutManager.floatBar=$.LayoutManager.controlSidebar={activate:function(){var e=this,t=$.LayoutManager.options.controlSidebarOptions,r=$(t.selector),n=$(t.toggleBtnSelector);n.on("click",function(n){n.preventDefault(),r.hasClass("control-sidebar-open")||$("body").hasClass("control-sidebar-open")?e.close(r,t.slide):e.open(r,t.slide)});var i=$(".control-sidebar-bg");e._fix(i),$("body").hasClass("fixed")?e._fixForFixed(r):$(".content-wrapper, .right-side").height()<r.height()&&e._fixForContent(r)},open:function(e,t){t?e.addClass("control-sidebar-open"):$("body").addClass("control-sidebar-open")},close:function(e,t){t?e.removeClass("control-sidebar-open"):$("body").removeClass("control-sidebar-open")},_fix:function(e){var t=this;$("body").hasClass("layout-boxed")?(e.css("position","absolute"),e.height($(".wrapper").height()),$(window).resize(function(){t._fix(e)})):e.css({position:"fixed",height:"auto"})},_fixForFixed:function(e){e.css({position:"fixed","max-height":"100%","padding-bottom":"50px"})},_fixForContent:function(e){$(".content-wrapper, .right-side").css("min-height",e.height())}},$.LayoutManager.boxWidget={selectors:$.LayoutManager.options.boxWidgetOptions.boxWidgetSelectors,icons:$.LayoutManager.options.boxWidgetOptions.boxWidgetIcons,animationSpeed:$.LayoutManager.options.animationSpeed,activate:function(e){var t=this;e||(e=document),$(e).on("click",t.selectors.collapse,function(e){e.preventDefault(),t.collapse($(this))}),$(e).on("click",t.selectors.remove,function(e){e.preventDefault(),t.remove($(this))})},collapse:function(e){var t=this,r=e.parents(".box").first(),n=r.find("> .box-body, > .box-footer, > form  >.box-body, > form > .box-footer");r.hasClass("collapsed-box")?(e.find(".btn-collapser").removeClass(t.icons.open).addClass(t.icons.collapse),n.slideDown(t.animationSpeed,function(){r.removeClass("collapsed-box")})):(e.find(".btn-collapser").removeClass(t.icons.collapse).addClass(t.icons.open),n.slideUp(t.animationSpeed,function(){r.addClass("collapsed-box")}))},remove:function(e){var t=e.parents(".box").first();t.slideUp(this.animationSpeed)}},$.LayoutManager},addRefreshButton:function(){"use strict";return $.fn.boxRefresh=function(e){function t(e){e.append(i),n.onLoadStart.call(e)}function r(e){e.find(i).remove(),n.onLoadDone.call(e)}var n=$.extend({trigger:".refresh-btn",source:"",onLoadStart:function(e){return e},onLoadDone:function(e){return e}},e),i=$('<div class="overlay"><div class="fa fa-refresh fa-spin"></div></div>');return this.each(function(){if(""===n.source)return void(window.console&&window.console.log("Please specify a source first - boxRefresh()"));var e=$(this),i=e.find(n.trigger).first();i.on("click",function(i){i.preventDefault(),t(e),e.find(".box-body").load(n.source,function(){r(e)})})})},$.LayoutManager},activateBox:function(){"use strict";return $.fn.activateBox=function(){$.LayoutManager.boxWidget.activate(this)},$.LayoutManager},listCustomPlugin:function(){"use strict";return $.fn.todolist=function(e){var t=$.extend({onCheck:function(e){return e},onUncheck:function(e){return e}},e);return this.each(function(){"undefined"!=typeof $.fn.iCheck?($("input",this).on("ifChecked",function(){var e=$(this).parents("li").first();e.toggleClass("done"),t.onCheck.call(e)}),$("input",this).on("ifUnchecked",function(){var e=$(this).parents("li").first();e.toggleClass("done"),t.onUncheck.call(e)})):$("input",this).on("change",function(){var e=$(this).parents("li").first();e.toggleClass("done"),$("input",e).is(":checked")?t.onCheck.call(e):t.onUncheck.call(e)})})},$.LayoutManager},setup:function(){"use strict";$("body").removeClass("hold-transition"),"undefined"!=typeof LayoutManagerOptions&&$.extend(!0,$.LayoutManager.options,LayoutManagerOptions);var e=$.LayoutManager.options;return $.LayoutManager._init(),$.LayoutManager.layout.activate(),$.LayoutManager.tree(".sidebar"),e.enableControlSidebar&&$.LayoutManager.controlSidebar.activate(),e.navbarMenuSlimscroll&&"undefined"!=typeof $.fn.slimscroll&&$(".navbar .menu").slimscroll({height:e.navbarMenuHeight,alwaysVisible:!1,size:e.navbarMenuSlimscrollWidth}).css("width","100%"),e.sidebarPushMenu&&$.LayoutManager.pushMenu.activate(e.sidebarToggleSelector),e.enableBoxWidget&&$.LayoutManager.boxWidget.activate(),e.enableFastclick&&"undefined"!=typeof FastClick&&FastClick.attach(document.body),e.directChat.enable&&$(document).on("click",e.directChat.contactToggleSelector,function(){var e=$(this).parents(".direct-chat").first();e.toggleClass("direct-chat-contacts-open")}),$('.btn-group[data-toggle="btn-toggle"]').each(function(){var e=$(this);$(this).find(".btn").on("click",function(t){e.find(".btn.active").removeClass("active"),$(this).addClass("active"),t.preventDefault()})}),$.LayoutManager.addRefreshButton().activateBox().listCustomPlugin()},loading:function(e){$("#initerror").remove(),e=!_.isBoolean(e)||e,e?$("body").append('\n          <div id="startingspinner">\n          <div class="double-bounce1"></div>\n          <div class="double-bounce2"></div>\n          </div>'):$("#startingspinner").remove()}};var m=$.LayoutManager;r["default"]={mixins:[g],data:function(){return{customcredits:!1,appState:l.getState(),current_custom_modal_content:null,language:null,cookie_law_buttonText:f("cookie_law.buttonText")}},components:{HeaderItem:s["default"],CookieLaw:a["default"]},computed:{app:function(){return this.appState.gui.app},languages:function y(){var y=Array.isArray(this.appconfig.i18n)&&this.appconfig.i18n||[];return y.length>1&&y},currentProject:function(){return u.getCurrentProject()},appconfig:function(){return l.getConfig()},isIframe:function(){return!!this.appconfig.group.layout.iframe},urls:function(){return this.appconfig.urls},staticurl:function(){return this.urls.staticurl},powered_by:function(){return this.appconfig.group.powered_by},clienturl:function(){return this.urls.clienturl},g3w_suite_logo:function(){return this.clienturl+"images/g3wsuite_logo.png"},credits_logo:function(){return this.clienturl+"images/logo_gis3w_156_85.png"},logo_url:function(){var e=this.currentProject.getThumbnail();return e?e:""+this.appconfig.mediaurl+this.appconfig.logo_img},logo_link:function b(){var b=this.getLogoLink();return b?b:"#"},logo_link_target:function(){var e=this.getLogoLink();return e?"_blank":""},project_title:function(){return this.currentProject.getState().name},user:function(){return this.appconfig.user&&this.appconfig.user.username?this.appconfig.user:null},login_url:function(){return this.appconfig.user.login_url},numberOfProjectsInGroup:function(){return this.appconfig.projects.length},frontendurl:function(){return this.urls.frontendurl},main_title:function w(){var w=this.appconfig.main_map_title,e=this.appconfig.group.name||this.appconfig.group.slug;return w?w+" - "+e:e}},methods:{templateResultLanguages:function(e){if(!e.id)return e.text;var t=this.staticurl+"img/flags",r=$('<div style="font-weight: bold; display:flex; align-items: center; justify-content: space-around">\n            <img src="'+t+"/"+e.element.value.toLowerCase()+'.png" />\n            <span style="margin-left: 5px;">'+e.text+"</span> \n          </span>");return r},resize:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isIframe){t.next=5;break}return t.next=3,this.$nextTick();case 3:e=this.$refs.navbar_toggle.offsetWidth>0?this.$refs.navbar.offsetWidth-this.$refs.navbar_toggle.offsetWidth:this.$refs.mainnavbar.offsetWidth-this.$refs["app-navbar-nav"].offsetWidth,this.$refs.main_title_project_title.style.maxWidth=e-this.logoWidth-15+"px";case 5:case"end":return t.stop()}},r,this)}));return e}(),showCustomModalContent:function(e){var t=this.custom_modals.find(function(t){return t.id===e}),r=t.content;this.current_custom_modal_content=r},closePanel:function(){sidebarService.closePanel()},getLogoLink:function(){return this.appconfig.logo_link?this.appconfig.logo_link:null},openProjectsMenu:function(){h.openProjectsMenu()}},watch:{language:function(e,t){t&&(l.changeLanguage(e),this.cookie_law_buttonText=f("cookie_law.buttonText"))}},beforeCreate:function(){this.delayType="debounce",this.delayTime=0},created:function(){var e=this;this.language=this.appconfig._i18n.lng,this.custom_modals=[],this.custom_header_items_position={0:[],1:[],2:[],3:[],4:[]},this.customlinks=Array.isArray(this.appconfig.header_custom_links)?this.appconfig.header_custom_links.filter(function(t){if(null!==t){var r=t.id=d();"modal"===t.type&&e.custom_modals.push({id:r,content:t.content});var n=1*(t.position||0);return n=n>4?4:n<0||Number.isNaN(n)?0:n,e.custom_header_items_position[n].push(t),!0}return!1}):[],!!this.appconfig.credits&&$.get(this.appconfig.credits).then(function(t){return e.customcredits="None"!==t&&t})},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e,t,n,i,a,o,s=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return o=function(){$("#g3w-modal-overlay").css("height",$(window).height())},a=function(){$(i).css("max-height",$(window).innerHeight()),$(".g3w-sidebarpanel").css("height",$(window).height()-$("#main-navbar").height())},this.logoWidth=0,r.next=5,this.$nextTick();case 5:for(e=this.isIframe?[]:this.$refs.mainnavbar.getElementsByTagName("ul"),t=e.length,this.rightNavbarWidth=15,n=0;n<t;n++)this.rightNavbarWidth+=e.item(n).offsetWidth;return this.language=this.appconfig.user.i18n,r.next=12,this.$nextTick();case 12:!this.isIframe&&this.$refs.img_logo.addEventListener("load",function(){s.logoWidth=s.$refs.img_logo.offsetWidth+15,s.resize()},{once:!0}),m.loading(!1),m.setup(),m.pushMenu.expandOnHover(),m.controlSidebar._fix($(".control-sidebar-bg")),m.controlSidebar._fix($(".control-sidebar")),i=m.options.controlSidebarOptions.selector,a(),$(window).resize(function(){a(),o()});case 21:case"end":return r.stop()}},r,this)}));return e}()}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.app.disabled,expression:"app.disabled"}],staticClass:"wrapper"},[r("cookie-law",{attrs:{theme:"dark-lime",buttonText:e.cookie_law_buttonText}},[r("div",{directives:[{name:"t",rawName:"v-t",value:"cookie_law.message",expression:"'cookie_law.message'"}],attrs:{slot:"message"},slot:"message"})]),e._v(" "),e.isIframe?e._e():r("header",{staticClass:"main-header"},[r("nav",{ref:"navbar",staticClass:"navbar navbar-inverse navbar-fixed-top",attrs:{role:"navigation"}},[r("div",{staticClass:"container-fluid"},[r("div",{staticClass:"navbar-header"},[r("button",{ref:"navbar_toggle",staticClass:"navbar-toggle",attrs:{type:"button","data-toggle":"collapse","data-target":"#main-navbar"}},[r("i",{"class":e.g3wtemplate.getFontClass("ellips-v"),staticStyle:{"font-size":"1.3em"}})]),e._v(" "),e.isMobile()?r("a",{staticClass:"sidebar-toggle",attrs:{href:"#","data-toggle":"offcanvas",role:"button"}},[r("i",{"class":e.g3wtemplate.getFontClass("bars"),staticStyle:{"font-size":"1.3em"}})]):e._e(),e._v(" "),r("div",{staticClass:"logo-wrapper","class":{mobile:e.isMobile()}},[e.logo_url?r("a",{staticClass:"project_logo_link",attrs:{href:e.logo_link,target:e.logo_link_target}},[r("img",{ref:"img_logo",staticClass:"img-responsive",staticStyle:{"max-width":"250px"},attrs:{src:e.logo_url}})]):e._e(),e._v(" "),r("div",{ref:"main_title_project_title",staticClass:"project_title_content"},[r("div",{staticClass:"main_title"},[e._v(e._s(e.main_title))]),e._v(" "),r("div",{staticClass:"sub_title"},[e._v(e._s(e.project_title))])])])]),e._v(" "),r("div",{ref:"mainnavbar",staticClass:"collapse navbar-collapse",staticStyle:{"text-align":"center",overflow:"hidden"},attrs:{id:"main-navbar"}},[r("navbarleftitems"),e._v(" "),r("navbarrightitems"),e._v(" "),r("ul",{ref:"app-navbar-nav",staticClass:"nav navbar-nav navbar-right app-navbar-nav"},[e.user?e._e():r("li",{staticClass:"dropdown user user-menu"},[r("a",{attrs:{href:e.login_url}},[r("i",{"class":e.g3wtemplate.getFontClass("sign-in"),attrs:{"aria-hidden":"true"}}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sign_in",expression:"'sign_in'"}]})])]),e._v(" "),e._l(e.custom_header_items_position[0],function(t){return r("header-item",{key:t.id,attrs:{state:t},on:{"show-custom-modal-content":e.showCustomModalContent}})}),e._v(" "),e.numberOfProjectsInGroup>1?r("li",{staticClass:"dropdown user",attrs:{id:"changemaps"}},[r("a",{staticClass:"dropdown-toggle",attrs:{href:"#","data-toggle":"dropdown"},on:{click:e.openProjectsMenu}},[r("i",{"class":e.g3wtemplate.getFontClass("change-map"),attrs:{"aria-hidden":"true"}}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"changemap",expression:"'changemap'"}]})])]):e._e(),e._v(" "),e._l(e.custom_header_items_position[1],function(t){return r("header-item",{key:t.id,attrs:{state:t},on:{"show-custom-modal-content":e.showCustomModalContent}})}),e._v(" "),e.user?r("li",{staticClass:"dropdown user user-menu"},[r("a",{staticClass:"dropdown-toggle",attrs:{href:"#","data-toggle":"dropdown"}},[r("i",{"class":e.g3wtemplate.getFontClass("user")}),e._v(" "),r("span",{staticClass:"hidden-xs"},[e._v(e._s(e.user.username))])]),e._v(" "),r("ul",{staticClass:"dropdown-menu"},[r("li",{staticClass:"user-header"},[r("p",[e._v("\n                    "+e._s(e.user.first_name)+" "+e._s(e.user.last_name)+"\n                  ")])]),e._v(" "),r("li",{staticClass:"user-footer"},[e.user.admin_url?r("div",{staticClass:"pull-left"},[r("a",{staticClass:"btn btn-default btn-flat skin-color bold",attrs:{href:e.user.admin_url}},[r("i",{"class":e.g3wtemplate.getFontClass("folder")}),e._v(" Admin")])]):e._e(),e._v(" "),r("div",{staticClass:"pull-right"},[r("a",{directives:[{name:"t",rawName:"v-t",value:"logout",expression:"'logout'"}],staticClass:"btn btn-default btn-flat skin-color bold",attrs:{href:e.user.logout_url}},[r("i",{"class":e.g3wtemplate.getFontClass("sign-out"),staticStyle:{"margin-right":"2px"}})])])])])]):e._e(),e._v(" "),e._l(e.custom_header_items_position[2],function(t){return r("header-item",{key:t.id,attrs:{state:t},on:{"show-custom-modal-content":e.showCustomModalContent}})}),e._v(" "),r("li",{staticClass:"dropdown user user-menu"},[r("a",{staticClass:"dropdown-toggle",attrs:{href:"#","data-toggle":"modal","data-target":"#credits"}},[r("i",{"class":e.g3wtemplate.getFontClass("credits"),attrs:{"aria-hidden":"true"}}),e._v(" "),r("span",[e._v("Credits")])])]),e._v(" "),e._l(e.custom_header_items_position[3],function(t){return r("header-item",{key:t.id,attrs:{state:t},on:{"show-custom-modal-content":e.showCustomModalContent}})}),e._v(" "),e.languages?r("li",{staticClass:"g3w-languages"},[r("select",{directives:[{name:"select2",rawName:"v-select2",value:"language",expression:"'language'"},{name:"model",rawName:"v-model",value:e.language,expression:"language"}],staticClass:"form-control",staticStyle:{cursor:"pointer",width:"130px"},attrs:{templateSelection:e.templateResultLanguages,templateResult:e.templateResultLanguages},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.language=t.target.multiple?r:r[0]}}},e._l(e.languages,function(t){return r("option",{key:t[0],domProps:{value:t[0],selected:t[0]===e.language&&"selected"}},[e._v("\n                  "+e._s(t[1])+"\n                ")])}),0)]):e._e(),e._v(" "),e.frontendurl?r("li",{staticClass:"dropdown"},[r("a",{attrs:{href:e.frontendurl}},[r("span",[r("i",{"class":e.g3wtemplate.getFontClass("home")}),e._v(" Home")])])]):e._e(),e._v(" "),e._l(e.custom_header_items_position[4],function(t){return r("header-item",{key:t.id,attrs:{state:t},on:{"show-custom-modal-content":e.showCustomModalContent}})})],2)],1)])])]),e._v(" "),r("sidebar"),e._v(" "),r("div",{staticClass:"content-wrapper",style:{paddingTop:e.isIframe?0:null}},[r("viewport",{attrs:{appState:e.appState}})],1),e._v(" "),r("floatbar"),e._v(" "),r("div",{staticClass:"control-sidebar-bg"}),e._v(" "),r("div",{staticClass:"modal fade modal-fullscreen force-fullscreen",attrs:{id:"full-screen-modal",tabindex:"-1",role:"dialog","data-backdrop":"static","data-keyboard":"false","aria-labelledby":"full-screen-modal","aria-hidden":"true"}}),e._v(" "),r("div",{staticClass:"modal fade",attrs:{id:"credits"}},[r("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[r("div",{staticClass:"modal-content"},[r("div",{staticClass:"modal-header"},[e._m(0),e._v(" "),r("div",{staticStyle:{display:"flex","flex-direction":"column","justify-content":"space-around","justify-items":"center","align-items":"center"}},[e.customcredits?r("div",{staticClass:"customcredits",domProps:{innerHTML:e._s(e.customcredits)}}):e._e(),e._v(" "),e.powered_by?r("div",[r("div",{staticClass:"g3w-credits-block"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"credits.g3wSuiteFramework",expression:"'credits.g3wSuiteFramework'"}],staticClass:"credit-title-logo",staticStyle:{"background-color":"#95ad36",padding:"5px","border-radius":"3px",color:"#ffffff"}}),e._v(" "),r("a",{attrs:{target:"_blank",href:"https://g3wsuite.it/"}},[r("img",{staticClass:"g3w-suite-logo",attrs:{src:e.g3w_suite_logo,alt:""}})]),e._v(" "),r("div",{directives:[{name:"t",rawName:"v-t",value:"credits.g3wSuiteDescription",expression:"'credits.g3wSuiteDescription'"}],staticStyle:{"margin-top":"10px"}})]),e._v(" "),r("div",{directives:[{name:"t",rawName:"v-t:pre",value:"credits.productOf",expression:"'credits.productOf'",arg:"pre"}],staticClass:"credit-title-logo g3w-credits-block",staticStyle:{"font-size":"1em",display:"flex","justify-content":"center"}},[r("a",{staticStyle:{"text-align":"center!important"},attrs:{href:"http://www.gis3w.it",target:"_blank"}},[r("img",{staticClass:"img-responsive center-block",staticStyle:{"margin-left":"5px"},attrs:{width:"60",src:e.credits_logo,alt:""}})])]),e._v(" "),r("address",{staticStyle:{"line-height":"1.3","text-align":"center","margin-top":"5px",display:"flex","justify-content":"center"},attrs:{id:"address-credits"}},[r("span",{staticStyle:{padding:"2px"}},[r("span",{"class":e.g3wtemplate.getFontClass("marker"),staticStyle:{color:"#95ad36","font-weight":"bold"},attrs:{"aria-hidden":"true"}}),e._v(" Montecatini Terme - Italy\n                ")]),e._v(" "),r("span",{staticStyle:{padding:"2px"}},[r("span",{"class":e.g3wtemplate.getFontClass("mobile"),staticStyle:{color:"#95ad36"},attrs:{"aria-hidden":"true"}}),e._v("  +39 393 8534336\n                ")]),e._v(" "),r("span",{staticStyle:{padding:"2px"}},[r("span",{"class":e.g3wtemplate.getFontClass("mail"),staticStyle:{color:"#95ad36"},attrs:{"aria-hidden":"true"}}),e._v(" "),r("a",{staticStyle:{color:"#000000"},attrs:{href:"mailto:info@gis3w.it"}},[e._v(" info@gis3w.it")])])])]):e._e()])])])])]),e._v(" "),r("div",{staticClass:"modal fade",attrs:{id:"custom_modal"}},[r("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[r("div",{staticClass:"modal-content",domProps:{innerHTML:e._s(e.current_custom_modal_content)}})])])],1)},n.staticRenderFns=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("button",{staticClass:"close",staticStyle:{color:"#ffffff","font-weight":"bold",opacity:"1",position:"absolute",right:"25px",top:"20px"},attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[r("span",{attrs:{"aria-hidden":"true"}},[e._v("")])])}]},{"components/HeaderItem.vue":271,"core/applicationservice":7,"core/i18n/i18n.service":27,"core/project/projectsregistry":83,"core/utils/utils":92,"gui/gui":150,"gui/vue/vue.mixins":227,"vue-cookie-law":"vue-cookie-law"}],234:[function(e,t,r){!function(){function t(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=e("core/utils/utils"),o=a.getUniqueDomId,s=e("gui/gui");r["default"]={props:{showdata:{type:Boolean,"default":!0}},data:function(){return{id:"graphline"+o(),selectitems:[],data:[],components:[],config:{data:{columns:[["x"],["y"]]}},size:{width:0,height:0}}},methods:{addComponent:function(e){this.components.push(e)},addComponents:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach(function(t){return e.addComponent(t)})},setConfig:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.config=e},setDataOffset:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.getData(),n=0;n<r.length;n++){var i=r[n];i.value+=e}t&&this.resize()},getSelectedItems:function(){return this.selectitems},selectItem:function(e){this.chart.select(["y"],[e])},unselectItem:function(e){this.chart.unselect(["y"],[e])},selectItems:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.chart.select([y],e)},unselectItems:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.chart.unselect(["y"],e)},unselectAll:function(){this.chart.unselect()},selectAll:function(){this.chart.select()},getData:function(){return this.data},resize:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.width,n=e.height;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.chart.resize({width:t,height:n||$("#"+this.id).height()-4});case 3:case"end":return e.stop()}},r,this)}));return e}(),_setAllowedSpace:function(){this.components&&this.components.length&&(this.size.height=document.querySelector(".g3wform_content").offsetHeight-this.$el.offsetHeight-document.querySelector(".g3wform_header").offsetHeight-50)},_setMaxMin:function(e){var r=e.value,n=e.max,i=e.min;if(i=r?+r:+i,n=r?+r:+n,i<this.chart.axis.min().y)this.chart.axis.min(i);else if(n>this.chart.axis.max().y)this.chart.axis.max(n);else{var a=this.data.map(function(e){return+e.value});this.chart.axis.max(Math.max.apply(Math,t(a))),this.chart.axis.min(Math.min.apply(Math,t(a)))}this.resize()},changeItems:function(e){if(1===e.length)this._setMaxMin(e[0].value);else{var r=Math.max.apply(Math,t(e.map(function(e){return+e.value}))),n=Math.min.apply(Math,t(e.map(function(e){return+e.value})));this._setMaxMin({max:r,min:n})}this.resize()},changeItem:function(e){var t=e.item,r=e.render,n=void 0===r||r,i=t.value;this._setMaxMin({value:i}),n&&this.resize()}},mounted:function(){var e=this;this.$nextTick(function(){s.on("resize",e.resize);var r=e;e.config.data.onselected=function(e){var n=[].concat(t(r.selectitems),[e]);r.selectitems=n},e.config.data.onunselected=function(e){r.selectitems=r.selectitems.filter(function(t){return t.index!==e.index})},e.chart=c3.generate(i({bindto:"#"+e.id},e.config));var n=e.chart.data()[0]?e.chart.data()[0].values:[];n.forEach(function(t){e.data.push(t)}),e._setAllowedSpace(),e.$emit("chart-ready",e.chart)})},beforeDestroy:function(){this.data=this.selectitems=null,this.chart.destroy(),this.chart=null,s.off("resize",this.resize)}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"chart_wrapper",staticStyle:{height:"100%",width:"100%"}},[r("div",{staticStyle:{height:"100%","min-height":"200px","background-color":"#ffffff"},attrs:{id:e.id}}),e._v(" "),e._l(e.components,function(t){return r("div",[r("span",{staticClass:"divider"}),e._v(" "),r(t,{tag:"component",attrs:{data:e.data,selectitems:e.selectitems,size:e.size},on:{"change-item":e.changeItem,"change-items":e.changeItems,"select-item":e.selectItem,"select-all":e.selectAll,"unselect-all":e.unselectAll,"unselect-item":e.unselectItem}})],1)})],2)},n.staticRenderFns=[]},{"core/utils/utils":92,"gui/gui":150}],235:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("app/constant"),a=e("gui/catalog/vue/catalogeventhub"),o=t(a),s=e("components/CatalogChangeMapThemes.vue"),l=t(s),u=e("components/CatalogLayerContextMenu.vue"),c=t(u),d=e("core/applicationservice"),p=e("gui/gui"),f=e("gui/map/control/registry"),h=e("core/catalog/cataloglayersstoresregistry"),v="layers";r["default"]={data:function(){var e=this.$options.legend;return e.place=d.getCurrentProject().getLegendPosition()||"tab",{state:null,legend:e,showlegend:!1,currentBaseLayer:null,activeTab:null,loading:!1}},components:{changemapthemes:l["default"],cataloglayercontextmenu:c["default"]},computed:{showTocTools:function(){var e=this.project.state.map_themes,t=void 0===e?[]:e,r=t.length>1;return r},project:function(){return this.state.prstate.currentProject},title:function(){return this.project.state.name},baselayers:function(){return this.project.state.baselayers},hasBaseLayers:function(){return this.project.state.baselayers.length>0},hasLayers:function(){var e=0;return this.state.layerstrees.forEach(function(t){return e+=t.tree.length}),this.state.external.vector.length>0||e>0||this.state.layersgroups.length>0}},methods:{changeMapTheme:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){var t,n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return p.closeContent(),r.next=3,this.$options.service.changeMapTheme(e);case 3:t=r.sent,n=Object.keys(t.layers).filter(function(e){
if(t.layers[e].style){if(!t.layers[e].visible){var r=h.getLayerById(e);r.change()}return!0}}),"tab"===this.legend.place?o["default"].$emit("layer-change-style"):n.forEach(function(e){o["default"].$emit("layer-change-style",{layerId:e})});case 6:case"end":return r.stop()}},r,this)}));return e}(),delegationClickEventTab:function(e){this.activeTab=e.target.attributes["aria-controls"]?e.target.attributes["aria-controls"].value:this.activeTab},showLegend:function(e){this.showlegend=e},setBaseLayer:function(e){this.currentBaseLayer=e,this.project.setBaseLayer(e),d.setBaseLayerId(e)},getSrcBaseLayerImage:function(e){var t=e&&e.servertype||e,r=void 0,n=!1;switch(t){case"OSM":r="osm.png";break;case"Bing":var i=e.source.subtype;r="bing"+i+".png";break;case"TMS":case"WMTS":if(e.icon){n=!0,r=e.icon;break}default:r="nobaselayer.png"}return n?r:p.getResourcesUrl()+"images/"+r}},watch:{"state.external.wms":function(e,t){t&&0===e.length&&(this.activeTab=this.project.state.catalog_tab||v)},"state.prstate.currentProject":{handler:function(){function e(e,r){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e,t){var n,i=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state.catalog_tab||v,this.loading="baselayers"===n,t.next=4,this.$nextTick();case 4:setTimeout(function(){i.loading=!1,i.activeTab=n},"baselayers"===n?500:0);case 5:case"end":return t.stop()}},r,this)}));return e}(),immediate:!1}},created:function(){var e=this;this.layerpositions=i.MAP_SETTINGS.LAYER_POSITIONS.getPositions(),o["default"].$on("unselectionlayer",function(e,t){var r=h.getLayersStore(e).getLayerById(t.id);r.clearSelectionFids()}),o["default"].$on("activefiltertokenlayer",function(){var t=n(regeneratorRuntime.mark(function r(t,n){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=h.getLayersStore(t).getLayerById(n.id),e.next=3,i.toggleFilterToken();case 3:n.filter.active=e.sent;case 4:case"end":return e.stop()}},r,e)}));return function(e,r){return t.apply(this,arguments)}}()),o["default"].$on("treenodevisible",function(e){var t=p.getService("map");t.emit("cataloglayervisible",e)}),o["default"].$on("treenodeselected",function(e,t){var r=p.getService("map"),n=h.getLayersStore(e).getLayerById(t.id);h.getLayersStore(e).selectLayer(t.id,!n.isSelected()),r.emit("cataloglayerselected",n)}),f.onafter("registerControl",function(t,r){"querybbox"===t&&r.getInteraction().on("propertychange",function(t){"active"===t.key&&(e.state.highlightlayers=!t.oldValue)})})},beforeMount:function(){this.currentBaseLayer=this.project.state.initbaselayer}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"tabbable-panel catalog",attrs:{id:"catalog"},on:{contextmenu:function(e){e.preventDefault(),e.stopPropagation()}}},[r("div",{staticClass:"tabbable-line"},[r("ul",{staticClass:"nav nav-tabs catalalog-nav-tabs",attrs:{role:"tablist"},on:{"!click":function(t){return e.delegationClickEventTab(t)}}},[e.hasLayers?r("li",{"class":{active:"layers"===e.activeTab&&"hasLayers"},attrs:{role:"presentation"}},[r("a",{directives:[{name:"t",rawName:"v-t",value:"data",expression:"'data'"}],attrs:{href:"#layers","aria-controls":"layers",role:"tab","data-toggle":"tab","data-i18n":"tree"}})]):e._e(),e._v(" "),e.state.external.wms.length?r("li",{"class":{active:"externalwms"===e.activeTab},attrs:{role:"presentation"}},[r("a",{directives:[{name:"t",rawName:"v-t",value:"externalwms",expression:"'externalwms'"}],attrs:{href:"#externalwms","aria-controls":"externalwms",role:"tab","data-toggle":"tab","data-i18n":"externalwms"}})]):e._e(),e._v(" "),e.hasBaseLayers?r("li",{"class":{active:"baselayers"===e.activeTab},attrs:{role:"presentation"}},[r("a",{directives:[{name:"t",rawName:"v-t",value:"baselayers",expression:"'baselayers'"}],attrs:{href:"#baselayers","aria-controls":"baselayers",role:"tab","data-toggle":"tab","data-i18n":"baselayers"}})]):e._e(),e._v(" "),"tab"===e.legend.place&&e.showlegend?r("li",{"class":{active:"legend"===e.activeTab},attrs:{role:"presentation"}},[r("a",{directives:[{name:"t",rawName:"v-t",value:"legend",expression:"'legend'"}],attrs:{href:"#legend","aria-controls":"legend",role:"tab","data-toggle":"tab","data-i18n":"legend"}})]):e._e()]),e._v(" "),r("div",{staticClass:"tab-content catalog-tab-content"},[r("bar-loader",{attrs:{loading:e.loading}}),e._v(" "),r("div",{staticClass:"tab-pane","class":{active:"layers"===e.activeTab&&"hasLayers"},attrs:{role:"tabpanel",id:"layers"}},[r("helpdiv",{attrs:{message:"catalog_items.helptext"}}),e._v(" "),e.showTocTools?r("div",{staticStyle:{margin:"2px"},attrs:{id:"g3w-catalog-toc-layers-toolbar"}},[r("changemapthemes",{key:e.project.state.gid,attrs:{map_themes:e.project.state.map_themes},on:{"change-map-theme":e.changeMapTheme}})],1):e._e(),e._v(" "),e._l(e.state.layerstrees,function(t){return r("ul",{key:t.storeid,staticClass:"tree-root root project-root"},e._l(t.tree,function(n){return r("tristate-tree",{key:n.id,staticClass:"item",attrs:{highlightlayers:e.state.highlightlayers,layerstree:n,parentFolder:!1,root:!0,legendplace:e.legend.place,parent_mutually_exclusive:!1,storeid:t.storeid}})}),1)}),e._v(" "),e.state.external.vector.length?r("ul",{staticClass:"g3w-external_layers-group"},e._l(e.state.external.vector,function(t){return r("tristate-tree",{key:t.id,staticClass:"item",attrs:{externallayers:e.state.external.vector,layerstree:t}})}),1):e._e(),e._v(" "),e._l(e.state.layersgroups,function(e){return r("ul",[r("layers-group",{attrs:{layersgroup:e}})],1)})],2),e._v(" "),e.state.external.wms.length?r("div",{staticClass:"tab-pane","class":{active:"externalwms"===e.activeTab},attrs:{role:"tabpanel",id:"externalwms"}},[r("ul",{staticClass:"g3w-external_wms_layers-group"},e._l(e.state.external.wms,function(t){return r("tristate-tree",{key:t.id,staticClass:"item",attrs:{externallayers:e.state.external.wms,layerstree:t}})}),1)]):e._e(),e._v(" "),e.hasBaseLayers?r("div",{staticClass:"tab-pane baselayers","class":{active:"baselayers"===e.activeTab||!e.hasLayers},attrs:{role:"tabpanel",id:"baselayers"}},[r("ul",{"class":{mobile:e.isMobile()},style:{gridTemplateColumns:"repeat(auto-fill, minmax("+(e.baselayers.length>4?80:120)+"px, 1fr))"},attrs:{id:"baselayers-content"}},[e._l(e.baselayers,function(t){return t.fixed?e._e():r("li",{key:t.title},[r("img",{staticClass:"img-responsive img-thumbnail baselayer",style:{opacity:e.currentBaseLayer===t.id?1:.5},attrs:{src:e.getSrcBaseLayerImage(t)},on:{click:function(r){return r.stopPropagation(),e.setBaseLayer(t.id)}}}),e._v(" "),r("div",{staticClass:"baseselayer-text text-center"},[e._v(e._s(t.title))])])}),e._v(" "),r("li",{on:{click:function(t){return t.stopPropagation(),e.setBaseLayer(null)}}},[r("img",{staticClass:"img-responsive img-thumbnail baselayer",style:{opacity:null===e.currentBaseLayer?1:.5},attrs:{src:e.getSrcBaseLayerImage(null)}}),e._v(" "),r("div",{directives:[{name:"t",rawName:"v-t",value:"nobaselayer",expression:"'nobaselayer'"}],staticClass:"baseselayer-text text-center"})])],2)]):e._e(),e._v(" "),e._l(e.state.layerstrees,function(t){return"tab"===e.legend.place?r("layerslegend",{key:t.id,attrs:{legend:e.legend,active:"legend"===e.activeTab,layerstree:t},on:{showlegend:e.showLegend}}):e._e()})],2)]),e._v(" "),r("cataloglayercontextmenu")],1)},n.staticRenderFns=[]},{"app/constant":5,"components/CatalogChangeMapThemes.vue":236,"components/CatalogLayerContextMenu.vue":237,"core/applicationservice":7,"core/catalog/cataloglayersstoresregistry":9,"gui/catalog/vue/catalogeventhub":138,"gui/gui":150,"gui/map/control/registry":185}],236:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("core/project/projectsregistry");r["default"]={name:"changemapthemes",data:function(){var e="collapsed"===t.getCurrentProject().state.toc_themes_init_status,r=this.map_themes.find(function(e){return e["default"]});return{current_map_theme:r?r.theme:null,collapsed:e}},props:{map_themes:{type:Array,"default":[]}},watch:{current_map_theme:{immediate:!1,handler:function(e){this.$emit("change-map-theme",e),$(this.$refs["g3w-map-theme-ancor"]).click()}}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ul",{staticClass:"sidebar-menu"},[r("li",{staticClass:"treeview sidebaritem skin-border-color",staticStyle:{"margin-bottom":"5px","border-bottom":"2px solid"},attrs:{id:"g3w-catalog-toc-views"}},[r("a",{ref:"g3w-map-theme-ancor",staticStyle:{display:"flex","align-items":"center",padding:"5px 5px 5px 2px"},attrs:{href:"#"}},[r("i",{"class":e.g3wtemplate.getFontClass("caret-down"),staticStyle:{padding:"3px"}}),e._v(" "),r("i",{"class":e.g3wtemplate.getFontClass("eye"),staticStyle:{padding:"0 0 0 4px"}}),e._v(" "),r("span",{directives:[{name:"show",rawName:"v-show",value:e.current_map_theme,expression:"current_map_theme "}],staticClass:"treeview-label new_line_too_long_text",staticStyle:{overflow:"hidden","white-space":"normal","text-overflow":"ellipsis"}},[r("span",{directives:[{name:"t",rawName:"v-t:pre",value:"sdk.catalog.current_map_theme_prefix",expression:"'sdk.catalog.current_map_theme_prefix'",arg:"pre"}],staticStyle:{color:"#cccccc !important"}},[e._v(":")]),e._v(" "),r("span",{staticClass:"skin-color",staticStyle:{"font-size":"1.1em"}},[e._v(e._s(e.current_map_theme))])]),e._v(" "),r("span",{directives:[{name:"show",rawName:"v-show",value:!e.current_map_theme,expression:"!current_map_theme"}],staticClass:"treeview-label",staticStyle:{color:"#cccccc !important","font-weight":"bold"}},[r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.choose_map_theme",expression:"'sdk.catalog.choose_map_theme'"}]})])]),e._v(" "),r("ul",{staticClass:"treeview-menu","class":{"menu-open":!e.collapsed},style:{display:e.collapsed?"none":"block"},attrs:{id:"g3w-catalog-views"}},[r("li",{staticStyle:{padding:"5px 5px 5px 17px"}},e._l(e.map_themes,function(t,n){return r("div",{key:t.theme},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.current_map_theme,expression:"current_map_theme"}],staticClass:"magic-radio",attrs:{type:"radio",name:"radio",id:"g3w-map_theme-"+n},domProps:{value:t.theme,checked:t["default"],checked:e._q(e.current_map_theme,t.theme)},on:{change:function(r){e.current_map_theme=t.theme}}}),e._v(" "),r("label",{staticStyle:{display:"flex","justify-content":"space-between"},attrs:{"for":"g3w-map_theme-"+n}},[r("span",{staticClass:"new_line_too_long_text"},[e._v(e._s(t.theme))])])])}),0)])])])},n.staticRenderFns=[],n._scopeId="data-v-3524e512"},{"core/project/projectsregistry":83}],237:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("gui/catalog/vue/catalogeventhub"),a=t(i),o=e("core/applicationservice"),s=e("core/catalog/cataloglayersstoresregistry"),l=e("gui/gui"),u=e("core/i18n/i18n.service"),c=u.t,d=e("shp-write"),p=e("gui/table/vue/table"),f=VueColor.Chrome,h={top:50,left:15};r["default"]={name:"Cataloglayermenu",data:function(){return{layerMenu:{show:!1,top:0,left:0,tooltip:!1,name:"",layer:null,loading:{data_table:!1,shp:!1,csv:!1,gpx:!1,gpkg:!1,xls:!1},colorMenu:{show:!1,top:0,left:0,color:null},stylesMenu:{show:!1,top:0,left:0,style:null,"default":null},metadatainfoMenu:{show:!1,top:0,left:0}}}},components:{"chrome-picker":f},directives:{"click-outside-layer-menu":{bind:function(e,t,r){this.event=function(n){!(e===n.target||e.contains(n.target))&&r.context[t.expression](n)},document.body.addEventListener("click",this.event)},unbind:function(e){document.body.removeEventListener("click",this.event)}}},methods:{_hideMenu:function(){this.layerMenu.show=!1,this.layerMenu.styles=!1,this.layerMenu.loading.data_table=!1,this.layerMenu.loading.shp=!1,this.layerMenu.loading.csv=!1,this.layerMenu.loading.gpx=!1,this.layerMenu.loading.gpkg=!1,this.layerMenu.loading.xls=!1,this.layerMenu.loading.geotiff=!1},closeLayerMenu:function(){this._hideMenu(),this.showColorMenu(!1),this.layerMenu.stylesMenu.show=!1},onbeforeDestroyChangeColor:function(){this.$refs.color_picker.$off()},onChangeColor:function(e){var t=l.getService("map");this.layerMenu.layer.color=e;var r=t.getLayerByName(this.layerMenu.name),n=r.getStyle();n._g3w_options.color=e,r.setStyle(n)},canShowWmsUrl:function(e){var t=s.getLayerById(e);return!!t&&!(t.isType("table")||!t.getFullWmsUrl())},canShowWfsUrl:function(e){var t=s.getLayerById(e);return t&&!t.isType("table")&&t.isWfsActive()},canDownloadXls:function(e){var t=s.getLayerById(e);return!!t&&t.isXlsDownlodable()},canDownloadGpx:function(e){var t=s.getLayerById(e);return!!t&&t.isGpxDownlodable()},canDownloadGpkg:function(e){var t=s.getLayerById(e);return!!t&&t.isGpkgDownlodable()},canDownloadCsv:function(e){var t=s.getLayerById(e);return!!t&&t.isCsvDownlodable()},canDownloadGeoTIFF:function(e){var t=s.getLayerById(e);return!!t&&t.isGeoTIFFDownlodable()},canDownloadShp:function(e){var t=s.getLayerById(e);return!!t&&t.isShpDownlodable()},getWmsUrl:function(e){var t=s.getLayerById(e);return t.getCatalogWmsUrl()},getWfsUrl:function(e){var t=s.getLayerById(e);return t.getCatalogWfsUrl()},copyUrl:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.evt,n=t.layerId,i=t.type,a=this["get"+i+"Url"](n),o=document.createElement("a");o.href=a;var s=document.createElement("input");s.value=o.href,document.body.appendChild(s),s.select(),document.execCommand("copy"),$(r.target).attr("data-original-title",c("sdk.catalog.menu.wms.copied")).tooltip("show"),$(r.target).attr("title",this.copywmsurltooltip).tooltip("fixTitle"),document.body.removeChild(s),o=null,setTimeout(function(){return e._hideMenu()},600)},downloadGeoTIFF:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=o.setDownload(!0);this.layerMenu.loading.geotiff=!0;var i=s.getLayerById(e);i.getGeoTIFF({data:r?{map_extent:l.getService("map").getMapExtent().toString()}:void 0})["catch"](function(e){return l.notify.error(c("info.server_error"))})["finally"](function(){t.layerMenu.loading.geotiff=!1,o.setDownload(!1,n),t._hideMenu()})},downloadShp:function(e){var t=this,r=o.setDownload(!0);this.layerMenu.loading.shp=!0;var n=s.getLayerById(e);n.getShp()["catch"](function(e){return l.notify.error(c("info.server_error"))})["finally"](function(){t.layerMenu.loading.shp=!1,o.setDownload(!1,r),t._hideMenu()})},downloadCsv:function(e){var t=this,r=o.setDownload(!0);this.layerMenu.loading.csv=!0;var n=s.getLayerById(e);n.getCsv()["catch"](function(e){return l.notify.error(c("info.server_error"))})["finally"](function(){t.layerMenu.loading.csv=!1,o.setDownload(!1,r),t._hideMenu()})},downloadXls:function(e){var t=this,r=o.setDownload(!0);this.layerMenu.loading.xls=!0;var n=s.getLayerById(e);n.getXls()["catch"](function(e){return l.notify.error(c("info.server_error"))})["finally"](function(){t.layerMenu.loading.xls=!1,o.setDownload(!1,r),t._hideMenu()})},downloadGpx:function(e){var t=this,r=o.setDownload(!0);this.layerMenu.loading.gpx=!0;var n=s.getLayerById(e);n.getGpx()["catch"](function(e){return l.notify.error(c("info.server_error"))})["finally"](function(){t.layerMenu.loading.gpx=!1,o.setDownload(!1,r),t._hideMenu()})},downloadGpkg:function(e){var t=this,r=o.setDownload(!0);this.layerMenu.loading.gpkg=!0;var n=s.getLayerById(e);n.getGpkg()["catch"](function(e){return l.notify.error(c("info.server_error"))})["finally"](function(){t.layerMenu.loading.gpkg=!1,o.setDownload(!1,r),t._hideMenu()})},changeLayerMapPosition:function(e){var t=e.position,r=e.layer,n=l.getService("map"),i=r.position!==t;r.position=t,n.changeLayerMapPosition({id:r.id,position:t}),i&&this._hideMenu()},setWMSOpacity:function(e){var t=e.id,r=void 0===t?this.layerMenu.layer.id:t,n=e.value;this.layerMenu.layer.opacity=n;var i=l.getService("map");i.changeLayerOpacity({id:r,opacity:n})},zoomToLayer:function(){var e=[this.layerMenu.layer.bbox.minx,this.layerMenu.layer.bbox.miny,this.layerMenu.layer.bbox.maxx,this.layerMenu.layer.bbox.maxy],t=l.getService("map");t.goToBBox(e,this.layerMenu.layer.epsg),this._hideMenu()},canZoom:function v(e){var v=!1;if(e.bbox){var t=[e.bbox.minx,e.bbox.miny,e.bbox.maxx,e.bbox.maxy];v=t.find(function(e){return e>0})}return v},getGeometryType:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=void 0;if(t){var n=this.state.external.vector.find(function(t){return t.id===e});n&&(r=n.geometryType)}else{var i=s.getLayerById(e);r=i.config.geometrytype}return r=r&&"NoGeometry"!==r?r:""},downloadExternalShapefile:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){var t,n,i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t="EPSG:4326",this.layerMenu.loading.shp=!0,n=l.getService("map"),i=n.getLayerByName(e.name),a=new ol.format.GeoJSON,o=i.getSource().getFeatures(),e.crs!==t&&(o=o.map(function(r){var n=r.clone();return n.getGeometry().transform(e.crs,t),n})),s=a.writeFeaturesObject(o,{featureProjection:t}),u=e.name.split("."+e.type)[0],d.download(s,{folder:u,types:{point:u,mulipoint:u,polygon:u,multipolygon:u,line:u,polyline:u,multiline:u}}),r.next=12,this.$nextTick();case 12:this.layerMenu.loading.shp=!1,this._hideMenu();case 14:case"end":return r.stop()}},r,this)}));return e}(),showAttributeTable:function(e){var t=this;this.layerMenu.loading.data_table=!1,l.closeContent();var r=s.getLayerById(e);this.layerMenu.loading.data_table=!0;var n=new p({layer:r,formatter:1});n.on("show",function(){t.isMobile()&&l.hideSidebar(),t.layerMenu.loading.data_table=!1,t._hideMenu()}),n.show({title:r.getName()})},startEditing:function(){var e=this,t=void 0,r=s.getLayersStores();r.forEach(function(r){if(t=r.getLayerById(e.layerMenu.layer.id))return t.getLayerForEditing(),!1})},setCurrentLayerStyle:function(e){var t=this,r=!1;if(this.layerMenu.layer.styles.forEach(function(n,i){i===e?(t.layerMenu.stylesMenu.style=n.name,r=!n.current,n.current=!0):n.current=!1}),r){var n=this.layerMenu.layer.id,i=s.getLayerById(this.layerMenu.layer.id);i&&(a["default"].$emit("layer-change-style",{layerId:n}),i.change())}this.closeLayerMenu()},showStylesMenu:function(){function e(e,r){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e,t){var n,i,a,o,s,l;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!e){r.next=15;break}return n=$(t.target),this.layerMenu.stylesMenu.top=n.offset().top,this.layerMenu.stylesMenu.left=n.offset().left+n.width()+(n.outerWidth()-n.width())/2+h.left,i=$("#layer-menu"),a=$(t.target),o=a.children("ul"),s=o.height(),l=i.height(),this.layerMenu.stylesMenu.maxHeight=s>=l?l:null,this.layerMenu.stylesMenu.overflowY=s>=l?"scroll":null,this.layerMenu.stylesMenu.top=(s>=l?i:a).offset().top,this.layerMenu.stylesMenu.left=this.isMobile()?0:a.offset().left+a.width()+(a.outerWidth()-a.width())/2+h.left,r.next=15,this.$nextTick();case 15:this.layerMenu.stylesMenu.show=e;case 16:case"end":return r.stop()}},r,this)}));return e}(),showMetadataInfo:function(){function e(e,r){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e,t){var n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!e){r.next=6;break}return n=$(t.target),this.layerMenu.metadatainfoMenu.top=n.offset().top,this.layerMenu.metadatainfoMenu.left=n.offset().left+n.width()+(n.outerWidth()-n.width())/2+h.left,r.next=6,this.$nextTick();case 6:this.layerMenu.metadatainfoMenu.show=e;case 7:case"end":return r.stop()}},r,this)}));return e}(),showColorMenu:function(e,t){if(e){var r=$(t.target);this.layerMenu.colorMenu.top=r.offset().top,this.layerMenu.colorMenu.left=r.offset().left+r.width()+(r.outerWidth()-r.width())/2-h.left}this.layerMenu.colorMenu.show=e}},created:function(){var e=this;a["default"].$on("showmenulayer",function(){var t=n(regeneratorRuntime.mark(function r(t,n){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e._hideMenu(),r.next=3,e.$nextTick();case 3:return e.layerMenu.left=n.x,e.layerMenu.name=t.name,e.layerMenu.layer=t,e.layerMenu.show=!0,e.layerMenu.colorMenu.color=t.color,r.next=10,e.$nextTick();case 10:e.layerMenu.top=$(n.target).offset().top-$(e.$refs["layer-menu"]).height()+$(n.target).height()/2,$('.catalog-menu-wms[data-toggle="tooltip"]').tooltip();case 12:case"end":return r.stop()}},r,e)}));return function(e,r){return t.apply(this,arguments)}}())}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.layerMenu.show?r("ul",{directives:[{name:"click-outside-layer-menu",rawName:"v-click-outside-layer-menu",value:e.closeLayerMenu,expression:"closeLayerMenu"}],ref:"layer-menu",style:{top:e.layerMenu.top+"px",left:e.layerMenu.left+"px"},attrs:{id:"layer-menu",tabindex:"-1"}},[r("li",{staticClass:"title"},[r("div",[e._v(e._s(e.layerMenu.layer.title))]),e._v(" "),r("div",{staticStyle:{"font-weight":"normal","font-size":"0.8em"}},[e._v(e._s(e.getGeometryType(e.layerMenu.layer.id,e.layerMenu.layer.external)))])]),e._v(" "),e.layerMenu.layer.projectLayer?e._e():r("li",[r("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"}},[r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.layerposition",expression:"'sdk.catalog.menu.layerposition'"}],staticClass:"item-text",staticStyle:{"margin-right":"30px"}}),e._v(" "),r("layerspositions",{staticStyle:{display:"flex","flex-direction":"column","justify-content":"space-between"},attrs:{position:e.layerMenu.layer.position},on:{"layer-position-change":function(t){return e.changeLayerMapPosition({position:t,layer:e.layerMenu.layer})}}})],1)]),e._v(" "),e.layerMenu.layer.metadata&&e.layerMenu.layer.metadata["abstract"]?r("li",{on:{mouseleave:function(t){return t.target!==t.currentTarget?null:e.showMetadataInfo(!1)},mouseover:function(t){return t.target!==t.currentTarget?null:e.showMetadataInfo(!0,t)}}},[r("span",{staticClass:"menu-icon","class":e.g3wtemplate.getFontClass("info")}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"Metadata",expression:"'Metadata'"}],staticClass:"item-text"}),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.layerMenu.metadatainfoMenu.show,expression:"layerMenu.metadatainfoMenu.show"}],staticStyle:{position:"fixed","background-color":"#FFFFFF",color:"#000000","padding-left":"0","border-radius":"0 3px 3px 0"},style:{top:e.layerMenu.metadatainfoMenu.top+"px",left:e.layerMenu.metadatainfoMenu.left+1+"px"}},[r("div",{staticClass:"layer-menu-metadata-info",staticStyle:{padding:"5px"},domProps:{innerHTML:e._s(e.layerMenu.layer.metadata["abstract"])}})])]):e._e(),e._v(" "),e.layerMenu.layer.geolayer&&e.layerMenu.layer.styles&&e.layerMenu.layer.styles.length>1?r("li",{staticClass:"menu-icon",on:{mouseleave:function(t){return t.target!==t.currentTarget?null:e.showStylesMenu(!1,t)},mouseover:function(t){return t.target!==t.currentTarget?null:e.showStylesMenu(!0,t)}}},[r("span",{staticClass:"menu-icon","class":e.g3wtemplate.getFontClass("palette")}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"catalog_items.contextmenu.styles",expression:"'catalog_items.contextmenu.styles'"}],staticClass:"item-text"}),e._v(" "),r("span",{staticClass:"menu-icon","class":e.g3wtemplate.getFontClass("arrow-right"),staticStyle:{position:"absolute",right:"0","margin-top":"3px"}}),e._v(" "),r("ul",{directives:[{name:"show",rawName:"v-show",value:e.layerMenu.stylesMenu.show,expression:"layerMenu.stylesMenu.show"}],staticStyle:{position:"fixed","padding-left":"0","background-color":"#FFFFFF",color:"#000000"},style:{top:e.layerMenu.stylesMenu.top+"px",left:e.layerMenu.stylesMenu.left+"px",maxHeight:e.layerMenu.stylesMenu.maxHeight+"px",overflowY:e.layerMenu.stylesMenu.overflowY}},e._l(e.layerMenu.layer.styles,function(t,n){return r("li",{key:t.name,on:{click:function(t){return t.stopPropagation(),e.setCurrentLayerStyle(n)}}},[t.current?r("span",{"class":e.g3wtemplate.getFontClass("circle"),staticStyle:{"font-size":"0.8em"}}):e._e(),e._v(" "),r("span",[e._v(e._s(t.name)+"\n          "),t.name===e.layerMenu.layer.defaultstyle&&e.layerMenu.layer.styles.length>1?r("span",[e._v("("),r("span",{directives:[{name:"t",rawName:"v-t",value:"default",expression:"'default'"}]}),e._v(")")]):e._e()])])}),0)]):e._e(),e._v(" "),e.canZoom(e.layerMenu.layer)?r("li",{on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.zoomToLayer(t)}}},[r("span",{staticClass:"menu-icon","class":e.g3wtemplate.getFontClass("search")}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"catalog_items.contextmenu.zoomtolayer",expression:"'catalog_items.contextmenu.zoomtolayer'"}],staticClass:"item-text"})]):e._e(),e._v(" "),e.layerMenu.layer.openattributetable?r("li",{on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.showAttributeTable(e.layerMenu.layer.id)}}},[r("bar-loader",{attrs:{loading:e.layerMenu.loading.data_table}}),e._v(" "),r("span",{staticClass:"menu-icon","class":e.g3wtemplate.getFontClass("list")}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"catalog_items.contextmenu.open_attribute_table",expression:"'catalog_items.contextmenu.open_attribute_table'"}],staticClass:"item-text"})],1):e._e(),e._v(" "),e.layerMenu.layer.projectLayer||"wms"===e.layerMenu.layer._type?e._e():r("li",{on:{click:function(e){e.preventDefault(),e.stopPropagation()},mouseleave:function(t){return t.target!==t.currentTarget?null:e.showColorMenu(!1,t)},mouseover:function(t){return t.target!==t.currentTarget?null:e.showColorMenu(!0,t)}}},[r("span",{directives:[{name:"t",rawName:"v-t",value:"catalog_items.contextmenu.vector_color_menu",expression:"'catalog_items.contextmenu.vector_color_menu'"}],staticClass:"item-text"}),e._v(" "),r("span",{staticClass:"menu-icon","class":e.g3wtemplate.getFontClass("arrow-right"),staticStyle:{position:"absolute",right:"0","margin-top":"3px"}}),e._v(" "),e.layerMenu.colorMenu.show?r("ul",{staticStyle:{position:"fixed"},style:{top:e.layerMenu.colorMenu.top+"px",left:e.layerMenu.colorMenu.left+"px"}},[r("li",{staticStyle:{padding:"0"}},[r("chrome-picker",{ref:"color_picker",staticStyle:{width:"100%"},on:{click:function(e){e.preventDefault(),e.stopPropagation()},"hook:beforeDestroy":e.onbeforeDestroyChangeColor,"change-color":e.onChangeColor},model:{value:e.layerMenu.colorMenu.color,callback:function(t){e.$set(e.layerMenu.colorMenu,"color",t)},expression:"layerMenu.colorMenu.color"}})],1)]):e._e()]),e._v(" "),e.layerMenu.layer.projectLayer||"wms"===e.layerMenu.layer._type?e._e():r("li",{directives:[{name:"download",rawName:"v-download"}],on:{click:function(e){e.preventDefault(),e.stopPropagation()}}},[r("div",{on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.downloadExternalShapefile(e.layerMenu.layer)}}},[r("bar-loader",{attrs:{loading:e.layerMenu.loading.shp}}),e._v(" "),r("span",{staticClass:"menu-icon","class":e.g3wtemplate.getFontClass("shapefile")}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.shp",expression:"'sdk.catalog.menu.download.shp'"}],staticClass:"item-text"})],1)]),e._v(" "),e.layerMenu.layer.projectLayer||"wms"!==e.layerMenu.layer._type?e._e():r("li",{on:{click:function(e){e.preventDefault(),e.stopPropagation()}}},[r("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.setwmsopacity",expression:"'sdk.catalog.menu.setwmsopacity'"}],staticClass:"item-text"}),e._v(" "),r("span",{staticStyle:{"font-weight":"bold","margin-left":"5px"}},[e._v(e._s(e.layerMenu.layer.opacity))])]),e._v(" "),r("range",{attrs:{value:e.layerMenu.layer.opacity,min:0,max:1,step:.1,sync:!0},on:{changed:e._hideMenu,"change-range":e.setWMSOpacity}})],1),e._v(" "),e.canDownloadGeoTIFF(e.layerMenu.layer.id)?r("li",{directives:[{name:"download",rawName:"v-download"}]},[r("div",{on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.downloadGeoTIFF(e.layerMenu.layer.id)}}},[r("bar-loader",{attrs:{loading:e.layerMenu.loading.geotiff}}),e._v(" "),r("span",{staticClass:"menu-icon","class":e.g3wtemplate.getFontClass("geotiff")}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.geotiff",expression:"'sdk.catalog.menu.download.geotiff'"}],staticClass:"item-text"})],1)]):e._e(),e._v(" "),e.canDownloadGeoTIFF(e.layerMenu.layer.id)?r("li",{directives:[{name:"download",rawName:"v-download"}]},[r("div",{staticStyle:{position:"relative"},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.downloadGeoTIFF(e.layerMenu.layer.id,!0)}}},[r("bar-loader",{attrs:{loading:e.layerMenu.loading.geotiff}}),e._v(" "),r("span",{staticClass:"menu-icon","class":e.g3wtemplate.getFontClass("geotiff"),staticStyle:{color:"#777"}}),e._v(" "),r("span",{staticClass:"menu-icon","class":e.g3wtemplate.getFontClass("crop"),staticStyle:{position:"absolute",left:"-7px",bottom:"8px","font-size":"1.2em"}}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.geotiff_map_extent",expression:"'sdk.catalog.menu.download.geotiff_map_extent'"}],staticClass:"item-text"})],1)]):e._e(),e._v(" "),e.canDownloadShp(e.layerMenu.layer.id)?r("li",{directives:[{name:"download",rawName:"v-download"}]},[r("div",{on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.downloadShp(e.layerMenu.layer.id)}}},[r("bar-loader",{attrs:{loading:e.layerMenu.loading.shp}}),e._v(" "),r("span",{staticClass:"menu-icon","class":e.g3wtemplate.getFontClass("shapefile")}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.shp",expression:"'sdk.catalog.menu.download.shp'"}],staticClass:"item-text"})],1)]):e._e(),e._v(" "),e.canDownloadGpx(e.layerMenu.layer.id)?r("li",[r("div",{directives:[{name:"download",rawName:"v-download"}],on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.downloadGpx(e.layerMenu.layer.id)}}},[r("bar-loader",{attrs:{loading:e.layerMenu.loading.gpx}}),e._v(" "),r("span",{staticClass:"menu-icon","class":e.g3wtemplate.getFontClass("gpx")}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.gpx",expression:"'sdk.catalog.menu.download.gpx'"}],staticClass:"item-text"})],1)]):e._e(),e._v(" "),e.canDownloadGpkg(e.layerMenu.layer.id)?r("li",[r("div",{directives:[{name:"download",rawName:"v-download"}],on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.downloadGpkg(e.layerMenu.layer.id)}}},[r("bar-loader",{attrs:{loading:e.layerMenu.loading.gpkg}}),e._v(" "),r("span",{staticClass:"menu-icon","class":e.g3wtemplate.getFontClass("gpkg")}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.gpkg",expression:"'sdk.catalog.menu.download.gpkg'"}],staticClass:"item-text"})],1)]):e._e(),e._v(" "),e.canDownloadCsv(e.layerMenu.layer.id)?r("li",[r("div",{directives:[{name:"download",rawName:"v-download"}],on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.downloadCsv(e.layerMenu.layer.id)}}},[r("bar-loader",{attrs:{loading:e.layerMenu.loading.csv}}),e._v(" "),r("span",{staticClass:"menu-icon","class":e.g3wtemplate.getFontClass("csv")}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",
value:"sdk.catalog.menu.download.csv",expression:"'sdk.catalog.menu.download.csv'"}],staticClass:"item-text"})],1)]):e._e(),e._v(" "),e.canDownloadXls(e.layerMenu.layer.id)?r("li",{directives:[{name:"download",rawName:"v-download"}]},[r("div",{on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.downloadXls(e.layerMenu.layer.id)}}},[r("bar-loader",{attrs:{loading:e.layerMenu.loading.xls}}),e._v(" "),r("span",{staticClass:"menu-icon","class":e.g3wtemplate.getFontClass("xls")}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.catalog.menu.download.xls",expression:"'sdk.catalog.menu.download.xls'"}],staticClass:"item-text"})],1)]):e._e(),e._v(" "),e.canShowWmsUrl(e.layerMenu.layer.id)?r("li",[r("div",{staticStyle:{display:"flex","max-width":"300px","align-items":"center"},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.copyUrl({evt:t,layerId:e.layerMenu.layer.id,type:"Wms"})}}},[r("span",{staticClass:"menu-icon","class":e.g3wtemplate.getFontClass("map")}),e._v(" "),r("div",{staticStyle:{display:"inline-flex","justify-content":"space-between",width:"100%","align-items":"baseline"}},[r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.catalog.menu.wms.copy",expression:"'sdk.catalog.menu.wms.copy'"}],staticClass:"item-text catalog-menu-wms skin-tooltip-top",attrs:{"data-toggle":"tooltip"}},[e._v("WMS URL")]),e._v(" "),r("span",{staticClass:"bold catalog-menu-wms wms-url-tooltip skin-tooltip-top","class":e.g3wtemplate.getFontClass("eye"),attrs:{"data-placement":"top","data-toggle":"tooltip",title:e.getWmsUrl(e.layerMenu.layer.id)}})])])]):e._e(),e._v(" "),e.canShowWfsUrl(e.layerMenu.layer.id)?r("li",[r("div",{staticStyle:{display:"flex","max-width":"300px","align-items":"center"},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.copyUrl({evt:t,layerId:e.layerMenu.layer.id,type:"Wfs"})}}},[r("span",{staticClass:"menu-icon","class":e.g3wtemplate.getFontClass("map")}),e._v(" "),r("div",{staticStyle:{display:"inline-flex","justify-content":"space-between",width:"100%","align-items":"baseline"}},[r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.catalog.menu.wms.copy",expression:"'sdk.catalog.menu.wms.copy'"}],staticClass:"item-text catalog-menu-wms skin-tooltip-top",attrs:{"data-toggle":"tooltip"}},[e._v("WFS URL")]),e._v(" "),r("span",{staticClass:"bold catalog-menu-wms wms-url-tooltip skin-tooltip-top","class":e.g3wtemplate.getFontClass("eye"),attrs:{"data-placement":"top","data-toggle":"tooltip",title:e.getWfsUrl(e.layerMenu.layer.id)}})])])]):e._e()]):e._e()},n.staticRenderFns=[]},{"core/applicationservice":7,"core/catalog/cataloglayersstoresregistry":9,"core/i18n/i18n.service":27,"gui/catalog/vue/catalogeventhub":138,"gui/gui":150,"gui/table/vue/table":219,"shp-write":"shp-write"}],238:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=e("gui/catalog/vue/catalogeventhub"),o=t(a),s=e("core/applicationservice"),l=e("core/catalog/cataloglayersstoresregistry"),u=e("gui/gui");r["default"]={name:"layerlegend",props:{layer:{type:Object}},data:function(){return{}},computed:{legend:function(){return this.layer.legend},show:function(){return this.layer.visible&&this.legend.show}},methods:{setError:function(){this.legend.error=!0,this.legend.loading=!1},urlLoaded:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.legend.loading=!1;case 1:case"end":return e.stop()}},r,this)}));return e}(),handlerChangeLegend:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layerId;t===this.layer.id&&this.getLegendSrc(this.layer)},getLegendUrl:function(e){var t=void 0,r=l.getLayersStores().find(function(t){return t.getLayerById(e.id)});return t=r&&r.getLayerById(e.id).getLegendUrl(this.legendParams)},getLegendSrc:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){var t,n,a,o,l,u,c,d,p,f,h,v,g,m,y;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t={GET:{},POST:{}},n=this,r.next=4,this.$nextTick();case 4:a=Array.isArray(e.styles)&&e.styles.find(function(e){return e.current}),o=e.source&&e.source.url||e.external?t.GET:t[e.ows_method],l=""+this.getLegendUrl(e),e.source&&e.source.url?o[l]=[]:(u=l.split("LAYER="),c=i(u,2),d=c[0],p=c[1],o[d]||(o[d]=[]),o[d].unshift({layerName:p,style:a&&a.name}));for(f in t)if(h=t[f],"GET"===f)for(v in h)g=h[v].length?v+"&LAYER="+h[v].map(function(e){return e.layerName}).join(",")+"&STYLES="+h[v].map(function(e){return e.style}).join(",")+(s.getFilterToken()?"&filtertoken="+s.getFilterToken():""):v,this.legend.url!==g&&(this.legend.url=g,this.legend.loading=!0);else{m=function(e){var t=new XMLHttpRequest,r=e.split("?"),a=i(r,2),o=a[0],l=a[1];l=l.split("&");var u=[];l.forEach(function(e){var t=e.split("="),r=i(t,2),n=r[0],a=r[1];u.push(n+"="+encodeURIComponent(a))}),l=u.join("&"),l=l+"&LAYERS="+encodeURIComponent(h[e].map(function(e){return e.layerName}).join(",")),l+="&STYLES="+encodeURIComponent(h[e].map(function(e){return e.style}).join(",")),l+=""+(s.getFilterToken()?"&filtertoken="+s.getFilterToken():""),t.open("POST",o),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),t.responseType="blob",n.legend.loading=!0,t.onload=function(){var e=this.response;void 0!==e&&(n.legend.url=window.URL.createObjectURL(e)),n.legend.loading=!1},t.onerror=function(){n.legend.loading=!1},t.send(l)};for(y in h)m(y)}case 9:case"end":return r.stop()}},r,this)}));return e}()},created:function(){this.legendParams=s.getConfig().layout?s.getConfig().layout.legend:{},this.mapReady=!1,o["default"].$on("layer-change-style",this.handlerChangeLegend)},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e,t=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.$nextTick();case 2:e=u.getService("map"),e.on("change-map-legend-params",function(){t.mapReady=!0,t.getLegendSrc(t.layer)}),this.show&&this.getLegendSrc(this.layer);case 5:case"end":return r.stop()}},r,this)}));return e}(),beforeDestroy:function(){o["default"].$off("layer-change-style",this.handlerChangeLegend)}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticClass:"layer-legend"},[r("bar-loader",{attrs:{loading:e.legend.loading}}),e._v(" "),r("figure",[r("img",{directives:[{name:"show",rawName:"v-show",value:!e.legend.error,expression:"!legend.error"}],attrs:{src:e.legend.url},on:{error:function(t){return e.setError()},load:function(t){return e.urlLoaded()}}}),e._v(" "),r("span",{staticClass:"divider"})])],1)},n.staticRenderFns=[],n._scopeId="data-v-de40554c"},{"core/applicationservice":7,"core/catalog/cataloglayersstoresregistry":9,"gui/catalog/vue/catalogeventhub":138,"gui/gui":150}],239:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={props:{layersgroup:{type:Object}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{border:"1px solid #ffffff33",margin:"5px"}},[r("h4",{staticStyle:{margin:"5px","font-weight":"bold"}},[e._v(e._s(e.layersgroup.title))]),e._v(" "),e._l(e.layersgroup.nodes,function(e){return r("tristate-tree",{staticClass:"item",attrs:{layerstree:e}})})],2)},n.staticRenderFns=[]},{}],240:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={props:["layerstree","legend","active"],data:function(){return{}},computed:{visiblelayers:function(){var e=[],t=this.layerstree.tree,r=function n(t){var r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var l=o.value;!_.isNil(l.id)&&l.visible&&l.geolayer&&!l.exclude_from_legend&&e.push(l),_.isNil(l.nodes)||n(l.nodes)}}catch(u){i=!0,a=u}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw a}}};return r(t),e}},watch:{layerstree:{handler:function(e,t){},deep:!0},visiblelayers:function(e){var t=!!e.length;this.$emit("showlegend",t)}},created:function(){var e=!!this.visiblelayers.length;this.$emit("showlegend",e)}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"tab-pane","class":{active:e.active},attrs:{role:"tabpanel",id:"legend"}},[r("layerslegend-items",{attrs:{active:e.active,legend:e.legend,layers:e.visiblelayers}})],1)},n.staticRenderFns=[]},{}],241:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function i(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=e("gui/catalog/vue/catalogeventhub"),s=t(o),l=e("core/applicationservice"),u=e("gui/gui"),c=e("core/catalog/cataloglayersstoresregistry");r["default"]={props:{layers:{"default":[]},legend:{type:Object},active:{"default":!0}},data:function(){return{legendurls:[]}},watch:{layers:{handler:function(e){var t=this;setTimeout(function(){t.mapReady&&t.getLegendSrc(e)})},immediate:!1},active:function(e){e&&this.waitinglegendsurls.length&&(this.legendurls=[].concat(i(this.waitinglegendsurls)),this.waitinglegendsurls=[])}},methods:{setError:function(e){e.error=!0,e.loading=!1},urlLoaded:function(e){e.loading=!1},getLegendUrl:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=void 0,n=c.getLayersStores();return n.forEach(function(n){if(n.getLayerById(e.id))return r=n.getLayerById(e.id).getLegendUrl(t),!1}),r},getLegendSrc:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){var t,n,i,o,s,u,c,d,p,f,h,v,g,m,y,_,b,w,x;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t={GET:{},POST:{}},n=this,this.legendurls=[],this.waitinglegendsurls=[],r.next=6,this.$nextTick();case 6:for(i=e.filter(function(e){return e.geolayer}),o=0;o<i.length;o++)s=i[o],u=Array.isArray(s.styles)&&s.styles.find(function(e){return e.current}),c=s.source&&s.source.url||s.external?t.GET:t[s.ows_method],d=""+this.getLegendUrl(s,this.legend.config),s.source&&s.source.url?c[d]=[]:(p=d.split("LAYER="),f=a(p,2),h=f[0],v=f[1],c[h]||(c[h]=[]),c[h].unshift({layerName:v,style:u&&u.name}));for(g in t)if(m=t[g],"GET"===g)for(y in m)_=m[y].length?y+"&LAYER="+encodeURIComponent(m[y].map(function(e){return e.layerName}).join(","))+"&STYLES="+encodeURIComponent(m[y].map(function(e){return e.style}).join(","))+(l.getFilterToken()?"&filtertoken="+l.getFilterToken():""):y,b={loading:!0,url:_,error:!1},this.active?this.legendurls.push(b):this.waitinglegendsurls.push(b);else{w=function(e){var t=new XMLHttpRequest,r=e.split("?"),i=a(r,2),o=i[0],s=i[1];s=s.split("&");var u=[];s.forEach(function(e){var t=e.split("="),r=a(t,2),n=r[0],i=r[1];u.push(n+"="+encodeURIComponent(i))}),s=u.join("&"),s=s+"&LAYERS="+encodeURIComponent(m[e].map(function(e){return e.layerName}).join(",")),s+="&STYLES="+encodeURIComponent(m[e].map(function(e){return e.style}).join(",")),s+=""+(l.getFilterToken()?"&filtertoken="+l.getFilterToken():""),t.open("POST",o),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),t.responseType="blob";var c={loading:!0,url:null,error:!1};n.active?n.legendurls.push(c):n.waitinglegendsurls.push(c),t.onload=function(){var e=this.response;void 0!==e&&(c.url=window.URL.createObjectURL(e)),c.loading=!1},t.onerror=function(){c.loading=!1},t.send(s)};for(x in m)w(x)}case 9:case"end":return r.stop()}},r,this)}));return e}()},created:function(){var e=this;this.mapReady=!1,this.waitinglegendsurls=[],s["default"].$on("layer-change-style",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.layerId,n=[];if(r){var i=e.layers.find(function(e){return r==e.id});i&&n.push(i)}else n=e.layers;n.length&&e.getLegendSrc(n)})},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e,t=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.$nextTick();case 2:e=u.getService("map"),e.on("change-map-legend-params",function(){t.mapReady=!0,t.getLegendSrc(t.layers)});case 4:case"end":return r.stop()}},r,this)}));return e}()}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"legend-item"},e._l(e.legendurls,function(t){return r("figure",{key:t.url},[r("bar-loader",{attrs:{loading:t.loading}}),e._v(" "),r("img",{directives:[{name:"show",rawName:"v-show",value:!t.loading&&!t.error,expression:"!legendurl.loading && !legendurl.error"}],attrs:{src:t.url},on:{error:function(r){return e.setError(t)},load:function(r){return e.urlLoaded(t)}}}),e._v(" "),r("span",{staticClass:"divider"})],1)}),0)},n.staticRenderFns=[]},{"core/applicationservice":7,"core/catalog/cataloglayersstoresregistry":9,"gui/catalog/vue/catalogeventhub":138,"gui/gui":150}],242:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("components/CatalogLayerLegend.vue"),a=t(i),o=e("gui/catalog/vue/catalogeventhub"),s=t(o),l=e("core/utils/utils"),u=l.downloadFile,c=e("gui/gui"),d=e("core/catalog/cataloglayersstoresregistry");r["default"]={props:["layerstree","storeid","legend","legendplace","highlightlayers","parent_mutually_exclusive","parentFolder","externallayers","root","parent"],components:{layerlegend:a["default"]},data:function(){return{expanded:this.layerstree.expanded,isGroupChecked:!0,controltoggled:!1,n_childs:null,filtered:!1}},computed:{isGroup:function(){return!!this.layerstree.nodes},legendlayerposition:function(){return!this.layerstree.exclude_from_legend&&"toc"===this.legendplace&&this.layerstree.visible&&this.layerstree.legend?"toc":"tab"},showscalevisibilityclass:function(){return!this.isGroup&&this.layerstree.scalebasedvisibility},showScaleVisibilityToolip:function(){return this.showscalevisibilityclass&&this.layerstree.disabled&&this.layerstree.checked},isTable:function(){return!this.isGroup&&!this.layerstree.geolayer&&!this.layerstree.external},isHidden:function(){return this.layerstree.hidden&&this.layerstree.hidden===!0},selected:function(){this.layerstree.selected=(!this.layerstree.disabled||!this.layerstree.selected)&&this.layerstree.selected},isHighLight:function(){var e=this.layerstree.id;return this.highlightlayers&&!this.isGroup&&d.getLayerById(e).getTocHighlightable()&&this.layerstree.visible},isInGrey:function(){return!this.isGroup&&!this.isTable&&!this.layerstree.external&&(!this.layerstree.visible||this.layerstree.disabled)}},watch:{"layerstree.disabled":function(e){},"layerstree.checked":function(e,t){this.isGroup?this.handleGroupChecked(this.layerstree):this.handleLayerChecked(this.layerstree)}},methods:{init:function(){var e=this;this.isGroup&&!this.layerstree.checked&&this.handleGroupChecked(this.layerstree),this.isGroup&&!this.root&&this.layerstree.nodes.forEach(function(t){e.parent_mutually_exclusive&&!e.layerstree.mutually_exclusive&&t.id&&(t.uncheckable=!0)})},handleGroupChecked:function(e){var t=e.checked,r=e.parentGroup,n=e.nodes,i=function o(e){var t=e.nodes,r=e.visible;t.forEach(function(e){if(void 0!==e.id){if(e.parentGroup.checked&&e.checked){var t=d.getLayerById(e.id);t.setVisible(r)}}else o({nodes:e.nodes,visible:r&&e.checked})})};if(t){var a=!r||r.checked;for(r&&r.mutually_exclusive?r.nodes.forEach(function(t){t.checked=t.groupId===e.groupId,t.checked&&i({nodes:t.nodes,visible:a})}):i({nodes:n,visible:a});r;)r.checked=r.root||r.checked,r=r.parentGroup}else n.forEach(function(e){if(void 0!==e.id){if(e.checked){var t=d.getLayerById(e.id);t.setVisible(!1)}}else i({nodes:e.nodes,visible:!1})})},handleLayerChecked:function(e){var t=e.checked,r=e.id,n=e.disabled,i=e.projectLayer,a=void 0!==i&&i,o=e.parentGroup;if(a){var l=d.getLayerById(r);if(t){var u=l.setVisible(!n);for(u&&"toc"===this.legendplace&&setTimeout(function(){return s["default"].$emit("layer-change-style",{layerId:r})}),o.mutually_exclusive&&o.nodes.forEach(function(e){return e.checked=e.id===r});o;)o.checked=!0,o=o.parentGroup}else l.setVisible(!1);s["default"].$emit("treenodevisible",l)}else{var p=c.getService("map");p.changeLayerVisibility({id:r,visible:t})}},toggleFilterLayer:function(){s["default"].$emit("activefiltertokenlayer",this.storeid,this.layerstree)},clearSelection:function(){s["default"].$emit("unselectionlayer",this.storeid,this.layerstree)},toggle:function(){this.layerstree.checked=!this.layerstree.checked},expandCollapse:function(){this.layerstree.expanded=!this.layerstree.expanded},select:function(){this.isGroup||this.layerstree.external||this.isTable||s["default"].$emit("treenodeselected",this.storeid,this.layerstree)},triClass:function(){return this.layerstree.checked?this.g3wtemplate.getFontClass("check"):this.g3wtemplate.getFontClass("uncheck")},downloadExternalLayer:function(e){e.file?u(e.file):e.url},removeExternalLayer:function(e,t){var r=c.getService("map");r.removeExternalLayer(e,wms)},showLayerMenu:function(e,t){!this.isGroup&&(this.layerstree.openattributetable||this.layerstree.downloadable||this.layerstree.geolayer||this.layerstree.external)&&s["default"].$emit("showmenulayer",e,t)}},created:function(){this.init()},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:$("span.scalevisibility").tooltip();case 3:case"end":return e.stop()}},r,this)}));return e}()}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",{staticClass:"tree-item","class":{selected:(!e.isGroup||!e.isTable)&&e.layerstree.selected,itemmarginbottom:!e.isGroup,disabled:e.isInGrey,group:e.isGroup},on:{contextmenu:function(t){return t.preventDefault(),t.stopPropagation(),e.showLayerMenu(e.layerstree,t)},click:function(t){return t.preventDefault(),e.select(t)}}},[e.isGroup?r("span",{staticClass:"root collapse-expande-collapse-icon","class":[{bold:e.isGroup},e.layerstree.expanded?e.g3wtemplate.getFontClass("caret-down"):e.g3wtemplate.getFontClass("caret-right")],staticStyle:{"padding-right":"2px"},on:{click:e.expandCollapse}}):e._e(),e._v(" "),e.isGroup?r("span",{"class":[e.triClass()],staticStyle:{color:"#ffffff"},on:{click:function(t){return t.stopPropagation(),e.toggle()}}}):e.isTable?r("span",{directives:[{name:"show",rawName:"v-show",value:!e.layerstree.hidden,expression:"!layerstree.hidden"}],"class":[e.parentFolder?"child":"root",e.g3wtemplate.getFontClass("table")],style:{paddingLeft:e.layerstree.exclude_from_legend||"toc"!==e.legendplace?"22px":"18px"}}):[e.layerstree.external&&e.layerstree.removable?r("span",{"class":e.g3wtemplate.getFontClass("trash"),staticStyle:{color:"red"},on:{click:function(t){return e.removeExternalLayer(e.layerstree.name,e.layerstree._type)}}}):e._e(),e._v(" "),e.layerstree.external&&e.layerstree.download?r("span",{"class":e.g3wtemplate.getFontClass("download"),staticStyle:{color:"#ffffff","margin-left":"5px"},on:{click:function(t){return e.downloadExternalLayer(e.layerstree.download)}}}):e._e(),e._v(" "),r("span",{directives:[{name:"show",rawName:"v-show",value:!e.layerstree.hidden,expression:"!layerstree.hidden"}],staticClass:"checkbox-layer","class":e.parentFolder?"child":"root"},["toc"===this.legendlayerposition?r("span",{staticClass:"collapse-expande-collapse-icon","class":e.g3wtemplate.getFontClass(e.layerstree.legend.show?"caret-down":"caret-right"),on:{click:function(t){return t.target!==t.currentTarget?null:(t.stopPropagation(),function(){return e.layerstree.legend.show=!e.layerstree.legend.show}(t))}}}):e._e(),e._v(" "),r("span",{"class":[e.g3wtemplate.getFontClass(e.layerstree.checked?"check":"uncheck"),{"toc-added-external-layer":!e.layerstree.legend&&e.layerstree.external}],style:{paddingLeft:"toc"===this.legendlayerposition?"5px":!e.layerstree.legend&&e.layerstree.external?"0":"toc"===e.legendplace?"18px":"23px"},on:{click:function(t){return t.stopPropagation(),e.toggle()}}})])],e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:!e.layerstree.hidden||e.isGroup,expression:"!layerstree.hidden || isGroup"}],staticClass:"tree-node-title","class":{disabled:!e.layerstree.external&&(e.layerstree.disabled||e.layerstree.id&&!e.layerstree.visible),bold:e.isGroup}},[r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip.text",value:e.showScaleVisibilityToolip?"minscale:"+e.layerstree.minscale+" - maxscale:"+e.layerstree.maxscale:"",expression:"showScaleVisibilityToolip ? `minscale:${layerstree.minscale} - maxscale:${layerstree.maxscale}` : ''",modifiers:{text:!0}}],staticClass:"skin-tooltip-top new_line_too_long_text","class":{highlightlayer:e.isHighLight,scalevisibility:e.showscalevisibilityclass},attrs:{"data-placement":"top","current-tooltip":e.showScaleVisibilityToolip?"minscale:"+e.layerstree.minscale+" - maxscale: "+e.layerstree.maxscale:""}},[e._v("\n        "+e._s(e.layerstree.title)+"\n      ")]),e._v(" "),e.isGroup||e.layerstree.external?e._e():r("div",[e.layerstree.selection.active?r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"layer_selection_filter.tools.clear",expression:"'layer_selection_filter.tools.clear'",modifiers:{create:!0}}],staticClass:"action-button skin-tooltip-left selection-filter-icon","class":e.g3wtemplate.getFontClass("success"),attrs:{"data-placement":"left","data-toggle":"tooltip"},on:{click:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"caputure",void 0,t.key,void 0)?null:(t.preventDefault(),t.stopPropagation(),e.clearSelection(t))}}}):e._e(),e._v(" "),e.layerstree.selection.active||e.layerstree.filter.active?r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"layer_selection_filter.tools.filter",expression:"'layer_selection_filter.tools.filter'",modifiers:{create:!0}}],staticClass:"action-button skin-tooltip-left selection-filter-icon","class":[e.g3wtemplate.getFontClass("filter"),e.layerstree.filter.active?"active":""],attrs:{"data-placement":"left","data-toggle":"tooltip"},on:{click:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"caputure",void 0,t.key,void 0)?null:(t.preventDefault(),t.stopPropagation(),e.toggleFilterLayer(t))}}}):e._e()])]),e._v(" "),"toc"===this.legendlayerposition?r("layerlegend",{attrs:{layer:e.layerstree}}):e._e(),e._v(" "),e.isGroup?r("ul",{directives:[{name:"show",rawName:"v-show",value:e.layerstree.expanded,expression:"layerstree.expanded"}],staticClass:"tree-content-items root","class":["g3w-lendplace-"+e.legendplace]},e._l(e.layerstree.nodes,function(t){return r("span",{key:t.id||t.groupId},[r("tristate-tree",{attrs:{root:!1,legendConfig:e.legend,legendplace:e.legendplace,highlightlayers:e.highlightlayers,parentFolder:e.isGroup,layerstree:t,storeid:e.storeid,parent:e.layerstree,parent_mutually_exclusive:!!e.layerstree.mutually_exclusive}})],1)}),0):e._e()],2)},n.staticRenderFns=[]},{"components/CatalogLayerLegend.vue":238,"core/catalog/cataloglayersstoresregistry":9,"core/utils/utils":92,"gui/catalog/vue/catalogeventhub":138,"gui/gui":150}],243:[function(e,t,r){e("vueify/lib/insert-css").insert(".field[data-v-3e1ec915]{background-color:transparent!important;padding-top:3px;padding-bottom:3px;display:flex;align-items:center}.value[data-v-3e1ec915]{position:relative}.field div[data-v-3e1ec915]{padding-left:3px;padding-right:3px}.field_value[data-v-3e1ec915]{padding-left:0!important}");!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"field",props:["state"]}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"field",style:{fontSize:e.isMobile()&&"0.8em"}},[e.state.label?r("div",{staticClass:"col-sm-6  field_label"},[e._t("label",[e._v(e._s(e.state.label))])],2):e._e(),e._v(" "),r("div",{staticClass:"field_value","class":[e.state.label?"col-sm-6":null]},[e._t("field",[r("span",{staticStyle:{"word-wrap":"break-word"},domProps:{innerHTML:e._s(e.state.value)}})])],2)])},n.staticRenderFns=[],n._scopeId="data-v-3e1ec915"},{"vueify/lib/insert-css":2}],244:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},n=e("gui/fields/fieldsservice"),i=e("gui/fields/fields");r["default"]={name:"g3w-field",props:{state:{required:!0},feature:{type:Object}},components:t({},i),created:function(){this.type=n.getType(this.state)}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r(e.type,{tag:"component",attrs:{feature:e.feature,state:e.state}})},n.staticRenderFns=[],n._scopeId="data-v-92197af4"},{"gui/fields/fields":145,"gui/fields/fieldsservice":146}],245:[function(e,t,r){e("vueify/lib/insert-css").insert(".show-hide-geo[data-v-0d97c5ac]{color:#3c8dbc;cursor:pointer;font-size:1.2em}");!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("gui/vue/vue.mixins"),n=t.geoMixin;r["default"]={name:"g3w-geospatial",props:{data:{}},mixins:[n],data:function(){return{layerId:"table_layer_"+Date.now(),visible:!1,id:"geo_table_"+Date.now()}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"geo-content"},[r("span",{staticClass:"show-hide-geo","class":[e.visible?e.g3wtemplate.font["eye-close"]:e.g3wtemplate.font.eye],on:{click:function(t){return t.stopPropagation(),e.showLayer()}}})])},n.staticRenderFns=[],n._scopeId="data-v-0d97c5ac"},{"gui/vue/vue.mixins":227,"vueify/lib/insert-css":2}],246:[function(e,t,r){e("vueify/lib/insert-css").insert(".img-responsive[data-v-2c267414]{cursor:pointer}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("components/Field.vue"),i=t(n),a=e("core/utils/utils"),o=a.toRawType;r["default"]={name:"image",props:["state"],data:function(){return{galleryId:"gallery_"+Date.now(),active:null,value:void 0!==this.state.value.mime_type?this.state.value.value:this.state.value}},components:{Field:i["default"]},computed:{values:function(){return Array.isArray(this.value)?this.value:[this.value]}},methods:{getSrc:function(e){return"Object"===o(e)?e.photo:e},showGallery:function(e){this.active=e,"Object"===o(this.value)&&(this.value.active=!0),$("#"+this.galleryId).modal("show")},getGalleryImages:function(){var e=this;return this.values.map(function(t){return{src:e.getSrc(t)}})}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("field",{attrs:{state:e.state}},[r("div",{staticStyle:{"text-align":"left"},attrs:{slot:"field"},slot:"field"},[e._l(e.values,function(t,n){return r("img",{staticClass:"img-responsive",staticStyle:{"max-height":"50px"},attrs:{src:e.getSrc(t)},on:{click:function(t){return e.showGallery(n)}}})}),e._v(" "),r("g3w-images-gallery",{attrs:{id:e.galleryId,active:e.active,images:e.getGalleryImages()}})],2)])},n.staticRenderFns=[],n._scopeId="data-v-2c267414"},{"components/Field.vue":243,"core/utils/utils":92,"vueify/lib/insert-css":2}],247:[function(e,t,r){e("vueify/lib/insert-css").insert(".field_link[data-v-fc346ca2]{max-width:100%}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("components/Field.vue"),a=t(i);r["default"]={name:"link",props:["state"],data:function(){return{value:null}},components:{Field:a["default"]},methods:{openLink:function(e){window.open(e,"_blank")}},created:function(){this.value=this.state.value&&"object"===n(this.state.value)?this.state.value.value:this.state.value}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("field",{attrs:{state:e.state}},[r("button",{directives:[{name:"t",rawName:"v-t",value:"info.link_button",expression:"'info.link_button'"}],staticClass:"btn skin-button field_link",attrs:{slot:"field"},on:{click:function(t){return e.openLink(e.value)}},slot:"field"})])},n.staticRenderFns=[],n._scopeId="data-v-fc346ca2"},{"components/Field.vue":243,"vueify/lib/insert-css":2}],248:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("gui/vue/vue.mixins"),n=t.mediaMixin;r["default"]={name:"g3w-media",mixins:[n],props:["state"],computed:{type:function(){return this.getMediaType(this.state.mime_type).type},value:function(){return this.state.value}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;
n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.value?r("div",{staticClass:"preview"},[r("a",{attrs:{href:e.value,target:"_blank"}},[r("div",{staticClass:"previewtype","class":e.type},[r("i",{staticClass:"fa-2x","class":e.g3wtemplate.font[e.type]})])]),e._v(" "),r("div",{staticClass:"filename"},[e._v(e._s(e.filename))]),e._v(" "),e._t("default")],2):e._e()},n.staticRenderFns=[],n._scopeId="data-v-c44dc002"},{"gui/vue/vue.mixins":227}],249:[function(e,t,r){e("vueify/lib/insert-css").insert(".field_text_table[data-v-0234e53c]{background-color:transparent!important}.field_text_table .field_label[data-v-0234e53c]{font-weight:700}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("components/Field.vue"),i=t(n);r["default"]={name:"text",props:["state"],components:{Field:i["default"]},created:function(){}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("field",{attrs:{state:e.state}})},n.staticRenderFns=[],n._scopeId="data-v-0234e53c"},{"components/Field.vue":243,"vueify/lib/insert-css":2}],250:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("components/Field.vue"),i=t(n);r["default"]={name:"vuefield",props:{feature:{type:Object},state:{type:Object,"default":{value:null,vueoptions:{component:{}}}}},components:{Field:i["default"]}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("field",{attrs:{state:e.state}},[r("div",{attrs:{slot:"field"},slot:"field"},[r(e.state.vueoptions.component,{tag:"component",attrs:{feature:e.feature,value:e.state.value}})],1)])},n.staticRenderFns=[],n._scopeId="data-v-41d5dd61"},{"components/Field.vue":243}],251:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("services/floatbar"),i=t(n);r["default"]={name:"Floatbar",data:function(){return{stack:i["default"].stack.state}},computed:{panelsinstack:function(){return this.stack.contentsdata.length>0},panelname:function(){var e=void 0;return this.stack.contentsdata.length&&(e=this.stack.contentsdata.slice(-1)[0].content.getTitle()),e},closable:function(){return i["default"].closable}},watch:{"stack.contentsdata":function(){var e=$("#g3w-floatbarpanel-placeholder").children();e.forEach(function(t,r){r==e.length-1?$(t).show():$(t).hide()})}},methods:{closePanel:function(){i["default"].closePanel()}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("aside",{staticClass:"control-sidebar control-sidebar-light"},[r("a",{directives:[{name:"show",rawName:"v-show",value:e.panelsinstack,expression:"panelsinstack"}],staticClass:"floatbar-aside-toggle",attrs:{href:"#","data-toggle":"control-sidebar",role:"button"}},[r("span",{staticClass:"sr-only"},[e._v("Expand")])]),e._v(" "),r("div",{staticStyle:{position:"absolute"},attrs:{id:"floatbar-spinner"}}),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.panelsinstack,expression:"panelsinstack"}],staticClass:"g3w-sidebarpanel"},[e.closable?r("div",{staticClass:"row"},[r("div",{staticClass:"col-xs-12 col-sm-12 col-md-12"},[r("button",{staticClass:"pull-right close-panel-button","class":e.g3wtemplate.getFontClass("close"),on:{click:e.closePanel}})])]):e._e(),e._v(" "),e.panelname?r("div",[r("h4",{staticClass:"g3w-floatbarpanel-name"},[e._v(e._s(e.panelname))])]):e._e(),e._v(" "),r("div",{staticClass:"g3w-floatbarpanel-placeholder",attrs:{id:"g3w-floatbarpanel-placeholder"}})])])},n.staticRenderFns=[],n._scopeId="data-v-03e575ec"},{"services/floatbar":388}],252:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("components/FormHeader.vue"),a=t(i),o=e("components/FormFooter.vue"),s=t(o);r["default"]={data:function(){return{state:{},switchcomponent:!1,body:{components:{before:[],after:[]}}}},components:{g3wformheader:a["default"],G3wFormFooter:s["default"]},transitions:{addremovetransition:"showhide"},methods:{isRootComponent:function(e){return this.$options.service.isRootComponent(e)},backToRoot:function(){this.$options.service.setRootComponent()},handleRelation:function(e){this.$options.service.handleRelation(e)},disableComponent:function(e){var t=e.id,r=e.disabled,n=void 0!==r&&r;this.$options.service.disableComponent({id:t,disabled:n})},resizeForm:function(e){this.$options.service.setCurrentFormPercentage(e)},switchComponent:function(e){this.switchcomponent=!0,this.$options.service.setCurrentComponentById(e)},changeInput:function(e){return this.$options.service.changeInput(e)},addToValidate:function(e){this.$options.service.addToValidate(e)},removeToValidate:function(e){this.$options.service.removeToValidate(e)},reloadLayout:function(){var e=$(this.$el).height();if(e){var t=$(this.$refs.g3w_form_footer.$el),r=$(this.$refs.g3wform_body),n=t.height()?t.height()+50:50,i=e-($(this.$refs.g3wformheader.$el).height()+n);r.height(i)}}},updated:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$nextTick();case 2:this.switchcomponent&&setTimeout(function(){return e.switchcomponent=!1},0);case 3:case"end":return t.stop()}},r,this)}));return e}(),created:function(){var e=this;this.$options.service.getEventBus().$on("set-main-component",function(){e.switchComponent(0)}),this.$options.service.getEventBus().$on("component-validation",function(t){var r=t.id,n=t.valid;e.$options.service.setValidComponent({id:r,valid:n})}),this.$options.service.getEventBus().$on("addtovalidate",this.addToValidate),this.$options.service.getEventBus().$on("disable-component",this.disableComponent)},mounted:function(){this.$options.service.isValid(),this.$options.service.setReady(!0)},beforeDestroy:function(){this.$options.service.clearAll()}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"g3wform_content",staticStyle:{position:"relative"}},[r("bar-loader",{attrs:{loading:e.state.loading}}),e._v(" "),r("g3wformheader",{ref:"g3wformheader",attrs:{currentid:e.state.currentheaderid,headers:e.state.headers},on:{"resize-form":e.resizeForm,clickheader:e.switchComponent}}),e._v(" "),r("div",{ref:"g3wform_body",staticClass:"g3wform_body"},[e._l(e.body.components.before,function(t){return r(t,{tag:"component",attrs:{fields:e.state.fields}})}),e._v(" "),r("keep-alive",[r(e.state.component,{tag:"component",attrs:{handleRelation:e.handleRelation,state:e.state},on:{"hook:activated":e.reloadLayout,addtovalidate:e.addToValidate,removetovalidate:e.removeToValidate,changeinput:e.changeInput}})],1),e._v(" "),e._l(e.body.components.after,function(t){return r(t,{tag:"component",attrs:{fields:e.state.fields}})})],2),e._v(" "),r("g3w-form-footer",{ref:"g3w_form_footer",attrs:{isRootComponent:e.isRootComponent,backToRoot:e.backToRoot,state:e.state}})],1)},n.staticRenderFns=[]},{"components/FormFooter.vue":254,"components/FormHeader.vue":255}],253:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("components/InputG3WFormInputs.vue"),i=t(n);r["default"]=Vue.extend({props:["state","handleRelation"],data:function(){return{show:!0}},components:{G3wFormInputs:i["default"]},methods:{addToValidate:function(e){this.$emit("addtovalidate",e)},removeToValidate:function(e){this.$emit("removetovalidate",e)},changeInput:function(e){this.$emit("changeinput",e)}},computed:{hasFormStructure:function(){return!!this.state.formstructure}}})}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("form",{staticClass:"form-horizontal g3w-form"},[r("div",{staticClass:"box-primary"},[r("div",{staticClass:"box-body"},[e.hasFormStructure?[r("tabs",{attrs:{layerid:e.state.layerid,feature:e.state.feature,handleRelation:e.handleRelation,contenttype:"editing",addToValidate:e.addToValidate,changeInput:e.changeInput,removeToValidate:e.removeToValidate,tabs:e.state.formstructure,fields:e.state.fields}})]:[r("g3w-form-inputs",{attrs:{state:e.state,addToValidate:e.addToValidate,removeToValidate:e.removeToValidate,changeInput:e.changeInput},on:{changeinput:e.changeInput,addinput:e.addToValidate,removeinput:e.removeToValidate}})]],2)])])])},n.staticRenderFns=[]},{"components/InputG3WFormInputs.vue":278}],254:[function(e,t,r){!function(){function e(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=Vue.extend({props:{state:{type:Object},backToRoot:{type:Function,"default":function(){}},isRootComponent:{type:Function}},data:function(){return{id:"footer",active:!0,show:!0}},methods:{exec:function(e){e instanceof Function?e(this.state.fields):function(){return this.state.fields}()},btnEnabled:function(e){var t=e.enabled,r=void 0===t||t,n=e.type;return r&&("save"!==n||"save"===n&&this.isValid())},isValid:function(){return this.state.valid},_enterEventHandler:function(e){if(13===e.which){e.preventDefault();var t=$(this.$el);t.is(":visible")&&this.isValid()&&this.active&&t.find("button").click()}}},watch:{"state.component":function(e){this.show=this.isRootComponent(e)}},activated:function(){this.active=!0},deactivated:function(){this.active=!1},mounted:function(){function t(){return r.apply(this,arguments)}var r=e(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:document.addEventListener("keydown",this._enterEventHandler);case 3:case"end":return e.stop()}},n,this)}));return t}(),beforeDestroy:function(){document.removeEventListener("keydown",this._enterEventHandler)}})}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"form-group g3wform_footer"},[e.show?[e._t("default",[r("div",{staticStyle:{margin:"3px","font-weight":"bold"}},[e._v("\n        * "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.form.footer.required_fields",expression:"'sdk.form.footer.required_fields'"}]}),e._v(" "),e.state.footer.message?r("div",{style:[e.state.footer.style]},[e._v(e._s(e.state.footer.message))]):e._e()]),e._v(" "),e._l(e.state.buttons,function(t){return r("button",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.btnEnabled(t),expression:"!btnEnabled(button)"},{name:"t",rawName:"v-t",value:t.title,expression:"button.title"}],staticClass:"btn ","class":[t["class"]],on:{click:function(r){return r.stopPropagation(),r.preventDefault(),e.exec(t.cbk)}}})})])]:[r("button",{directives:[{name:"t",rawName:"v-t",value:"back",expression:"'back'"}],staticClass:"btn skin-button",on:{click:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"prevet",void 0,t.key,void 0)?null:(t.stopPropagation(),e.backToRoot(t))}}})]],2)},n.staticRenderFns=[]},{}],255:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=Vue.extend({props:{headers:{type:Array,"default":[]},currentid:{type:"String"}},methods:{click:function(e){this.currentid!==e&&this.$emit("clickheader",e)},resizeForm:function(e){this.$emit("resize-form",e)}}})}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"g3wform_header box-header with-border"},e._l(e.headers,function(t){return r("span",{key:t.id,staticClass:"title","class":[{item_selected:e.currentid===t.id&&e.headers.length>1},[e.headers.length>1?"tabs":"one"]],staticStyle:{display:"flex"},style:{fontSize:e.isMobile()&&"1em !important"},on:{click:function(r){return e.click(t.id)}}},[t.icon?r("span",{staticStyle:{"margin-right":"5px"}},[r("i",{"class":t.icon})]):e._e(),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t:pre",value:t.title,expression:"header.title",arg:"pre"}]},[e._v(e._s(t.name))])])}),0)},n.staticRenderFns=[]},{}],256:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"bar-loader",props:["loading","color"],render:function(e){if(this.loading)return e("div",{style:{backgroundColor:this.color||"#FFFFFF",border:0},"class":{"bar-loader":!0}})}}},{}],257:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/applicationstate"),a=t(i),o=e("core/utils/utils"),s=o.getUniqueDomId;r["default"]={name:"datetime",props:{type:{type:String,"default":"date"},format:{type:String,"default":"YYYY-MM-DD"},minDate:{"default":!1},maxDate:{"default":!1},enabledDates:{"default":!1},value:{},label:{"default":"Date"}},data:function(){return{datetimevalue:this.value}},methods:{play:function(){},pause:function(){},stop:function(){},back:function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:1},forward:function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:1},changeInput:function(e){},change:function(e){var t=moment(e).format(this.format);this.$emit("change",t)}},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$nextTick();case 2:this.datetimeinputelement=$(this.$refs.iddatetimepicker),this.datetimeinputelement.datetimepicker({minDate:this.minDate,maxDate:this.maxDate,defaultDate:this.datetimevalue,useCurrent:!1,allowInputToggle:!0,enabledDates:this.enabledDates,showClose:!0,format:this.format,locale:a["default"].lng,toolbarPlacement:"top",widgetPositioning:{horizontal:"right"}}),this.datetimeinputelement.on("dp.change",function(t){var r=t.date;e.change(r)}),this.datetimeinputelement.on("dp.hide",function(e){}),a["default"].ismobile&&setTimeout(function(){return datetimeinputelement.blur()});case 7:case"end":return t.stop()}},r,this)}));return e}(),watch:{value:function(e){this.datetimevalue=e,this.datetimeinputelement.data("DateTimePicker").date(e)},minDate:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.datetimeinputelement.data("DateTimePicker").minDate(e);case 1:case"end":return t.stop()}},r,this)}));return e}(),maxDate:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.datetimeinputelement.data("DateTimePicker").maxDate(e);case 1:case"end":return t.stop()}},r,this)}));return e}(),enabledDates:function(e){this.datetimeinputelement.data("DateTimePicker").enabledDates(e)}},created:function(){this.id=s()}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{ref:"datimecontainer"},[r("label",{directives:[{name:"t",rawName:"v-t",value:e.label,expression:"label"}],staticStyle:{display:"block"},attrs:{"for":e.id}}),e._v(" "),r("div",{staticClass:"form-group"},[r("div",{ref:"iddatetimepicker",staticClass:"input-group date"},[r("input",{ref:"idinputdatetimepiker",staticClass:"form-control",attrs:{id:e.id,type:"text"},on:{change:e.changeInput}}),e._v(" "),r("span",{staticClass:"input-group-addon caret"},[r("span",{staticClass:"datetimeinput","class":["time"===e.type?e.g3wtemplate.getFontClass("time"):e.g3wtemplate.getFontClass("calendar")]})])])])])},n.staticRenderFns=[],n._scopeId="data-v-63ff8e5a"},{"core/applicationstate":8,"core/utils/utils":92}],258:[function(e,t,r){e("vueify/lib/insert-css").insert(".divider[data-v-2417f111]{display:block;position:relative;padding:0;margin-bottom:5px;height:0;width:100%;max-height:0;font-size:1px;line-height:0;clear:both;border:none;border-bottom:2px solid #eee}");!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"divider"}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("span",{staticClass:"divider"})},n.staticRenderFns=[],n._scopeId="data-v-2417f111"},{"vueify/lib/insert-css":2}],259:[function(e,t,r){e("vueify/lib/insert-css").insert('.modal-content[data-v-0e2cde6c]{background:hsla(0,0%,100%,.6);border-radius:3px}.modal-dialog[data-v-0e2cde6c]{display:inline-block;text-align:left;vertical-align:middle}.modal[data-v-0e2cde6c]{text-align:center;padding:0!important}.modal[data-v-0e2cde6c]:before{content:"";display:inline-block;height:100%;vertical-align:middle;margin-right:-4px}.carousel .carousel-control span[data-v-0e2cde6c]{color:#3c8dbc}');!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("core/project/projectsregistry");r["default"]={name:"g3w-images-gallery",props:{images:{type:Array,"default":[]},id:{type:String,"default":"gallery"},active:{type:Number}},data:function(){return{carouselId:"carousel_"+Date.now()}},methods:{isActive:function(e){return e===active},isRelativePath:function(e){return _.startsWith(e,"/")||_.startsWith(e,"http")?e:t.getConfig().mediaurl+e}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"modal fade modal-fullscreen force-fullscreen",attrs:{id:e.id,tabindex:"-1",role:"dialog","aria-labelledby":"","aria-hidden":"true"}},[r("div",{staticClass:"modal-dialog"},[r("div",{staticClass:"modal-content"},[r("div",{staticClass:"modal-body"},[r("div",{staticClass:"carousel slide",attrs:{id:e.carouselId,"data-interval":"false"}},[r("div",{staticClass:"carousel-inner"},e._l(e.images,function(t,n){return r("div",{staticClass:"item","class":e.active==n?"active":""},[r("img",{staticStyle:{margin:"auto"},attrs:{src:e.isRelativePath(t.src)}})])}),0),e._v(" "),e.images.length>1?r("a",{staticClass:"left carousel-control",attrs:{href:"#"+e.carouselId,role:"button","data-slide":"prev"}},[r("span",{"class":e.g3wtemplate.getFontClass("arrow-left")})]):e._e(),e._v(" "),e.images.length>1?r("a",{staticClass:"right carousel-control",attrs:{href:"#"+e.carouselId,role:"button","data-slide":"next"}},[r("span",{"class":e.g3wtemplate.getFontClass("arrow-left")})]):e._e()])])])])])},n.staticRenderFns=[],n._scopeId="data-v-0e2cde6c"},{"core/project/projectsregistry":83,"vueify/lib/insert-css":2}],260:[function(e,t,r){e("vueify/lib/insert-css").insert(".show-hide-geo[data-v-11a0fd6e]{color:#3c8dbc;cursor:pointer;font-size:1.2em}");!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("gui/vue/vue.mixins"),n=t.geoMixin;r["default"]={name:"g3w-geospatial",props:{data:{}},mixins:[n],data:function(){return{layerId:"table_layer_"+Date.now(),visible:!1,id:"geo_table_"+Date.now()}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"geo-content"},[r("span",{staticClass:"show-hide-geo","class":[e.visible?e.g3wtemplate.getFontClass("eye-close"):e.g3wtemplate.getFontClass("eye")],on:{click:function(t){return t.stopPropagation(),e.showLayer()}}})])},n.staticRenderFns=[],n._scopeId="data-v-11a0fd6e"},{"gui/vue/vue.mixins":227,"vueify/lib/insert-css":2}],261:[function(e,t,r){e("vueify/lib/insert-css").insert(".help_div_container[data-v-1d453408]{color:#fff;text-align:justify;position:relative;border-radius:3px;margin:5px 2px;white-space:pre-line;background-color:#384246!important}.help_icon[data-v-1d453408]{text-align:center;font-size:.7em;margin-top:-4px;margin-left:-4px;background-color:#222d32;font-weight:700;color:#fff;position:absolute;top:0;left:0;width:15px;height:15px;box-shadow:0 3px 5px rgba(0,0,0,.5);border:1px solid #fff;border-radius:50%}.g3w-help-message-content[data-v-1d453408]{max-height:200px;padding:10px;overflow-y:auto}");!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"helpdiv",props:{message:{type:String,required:!0},type:{type:String,"default":"info"}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"help_div_container"},[r("span",{staticClass:"help_icon"},[e._v("i")]),e._v(" "),r("div",{directives:[{name:"t",rawName:"v-t",value:e.message,expression:"message"}],staticClass:"g3w-help-message-content"})])},n.staticRenderFns=[],n._scopeId="data-v-1d453408"},{"vueify/lib/insert-css":2}],262:[function(e,t,r){e("vueify/lib/insert-css").insert(".img-responsive[data-v-66f7e35a]{cursor:pointer}.g3w-image[data-v-66f7e35a]{padding-left:0!important;min-width:100px;max-width:100%;cursor:pointer}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("components/GlobalGallery.vue"),a=t(i);r["default"]={name:"g3w-image",props:{value:{}},data:function(){return{galleryId:"gallery_"+Date.now(),active:null}},components:{"g3w-images-gallery":a["default"]},computed:{values:function(){return Array.isArray(this.value)?this.value:[this.value]}},methods:{getSrc:function(e){return"object"===("undefined"==typeof e?"undefined":n(e))?e.photo:e},showGallery:function(e){this.active=e,"object"===n(this.value)&&(this.value.active=!0),$("#"+this.galleryId).modal("show")},getGalleryImages:function(){var e=this,t=[];return this.values.forEach(function(r){t.push({src:e.getSrc(r)})}),t}},created:function(){}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container-fluid"},[r("div",{staticClass:"row"},e._l(e.values,function(t,n){return r("div",{staticClass:"g3w-image col-md-6 col-sm-12"},[r("img",{staticClass:"img-thumbnail",attrs:{src:e.getSrc(t)},on:{click:function(t){return e.showGallery(n)}}})])}),0),e._v(" "),r("g3w-images-gallery",{attrs:{id:e.galleryId,active:e.active,images:e.getGalleryImages()}})],1)},n.staticRenderFns=[],n._scopeId="data-v-66f7e35a"},{"components/GlobalGallery.vue":259,"vueify/lib/insert-css":2}],263:[function(e,t,r){e("vueify/lib/insert-css").insert(".g3w-layer-positions[data-v-4b2d4451]{display:flex;flex-direction:column;margin:5px 0}.g3w-layer-positions-info-message[data-v-4b2d4451]{margin-bottom:3px}.g3w-layer-positions-checkboxes[data-v-4b2d4451]{display:flex;justify-content:space-between}");!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("app/constant"),n=e("core/utils/utils"),i=n.getUniqueDomId;r["default"]={name:"layerspositions",props:{position:{type:String,"default":t.MAP_SETTINGS.LAYER_POSITIONS["default"]}},data:function(){return{layerpositions:t.MAP_SETTINGS.LAYER_POSITIONS.getPositions()}},methods:{change:function(){this.$emit("layer-position-change",this.position)}},created:function(){var e=this;this.ids={layerpositions:i()},this.layerpositions.forEach(function(t){return e.ids[t]=i()}),this.change()}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"g3w-layer-positions",attrs:{id:e.ids.layerpositions}},[r("div",{staticClass:"g3w-layer-positions-info-message"},[r("helpdiv",{attrs:{message:"layer_position.message"}})],1),e._v(" "),r("div",{staticClass:"g3w-layer-positions-checkboxes"},e._l(e.layerpositions,function(t){return r("div",{key:t},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.position,expression:"position"}],staticClass:"form-control magic-radio",attrs:{type:"radio",id:e.ids[t]},domProps:{value:t,checked:e.position===t,checked:e._q(e.position,t)},on:{change:[function(r){e.position=t},e.change]}}),e._v(" "),r("label",{directives:[{name:"t",rawName:"v-t",value:"layer_position."+t,expression:"`layer_position.${layerposition}`"}],attrs:{"for":e.ids[t]}})])}),0)])},n.staticRenderFns=[],n._scopeId="data-v-4b2d4451"},{"app/constant":5,"core/utils/utils":92,"vueify/lib/insert-css":2}],264:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"progressbar",props:["progress"],render:function(e){if(null!==this.progress&&void 0!==this.progress)return e("div",{style:{margin:"5px 0 5px 0",width:"100%",backgroundColor:"#FFFFFF",border:0,borderRadius:"3px"}},[e("div",{style:{width:(this.progress<10?10:this.progress)+"%",display:"flex",justifyContent:"center",fontWeight:"bold"},"class":{"skin-background-color":!0}},[e("span",this.progress+"%")])])}}},{}],265:[function(e,t,r){!function(){function t(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("core/utils/utils"),i=n.debounce;r["default"]={name:"range",props:{id:{required:!0},label:{type:"String","default":""},min:{type:Number,"default":0},max:{type:Number,"default":10},step:{type:Number,"default":1},labelValue:{},value:{"default":0},sync:{type:Boolean,"default":!1}},data:function(){return{}},methods:{changeBackGround:function(e){this.$refs["range-input"].style.backgroundSize=(e?100*(e-this.min)/(this.max-this.min):0)+"% 100%"},setValue:function(e){this.changedValue(e)},change:function(e){var t=1*e.target.value;this.changedValue(t)},emitChangeValue:function(e){this.value=e,this.$emit("change-range",{id:this.id,value:e})}},watch:{value:function(e){this.changeBackGround(e),this.sync&&this.emitChangeValue(e)}},created:function(){var e=this;this.changedValue=this.sync?function(){return e.$emit("changed")}:i(function(t){e.emitChangeValue(t)})},mounted:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.changeBackGround(this.value);case 3:case"end":return e.stop()}},n,this)}));return e}(),beforeDestroy:function(){}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{display:"flex","flex-direction":"column"}},[r("label",{directives:[{name:"t",rawName:"v-t",value:e.label,expression:"label"}],staticStyle:{display:"block"},attrs:{"for":e.id}}),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],ref:"range-input",attrs:{id:e.id,type:"range",min:e.min,max:e.max,step:e.step},domProps:{value:e.value},on:{change:e.change,__r:function(t){e.value=t.target.value}}})])},n.staticRenderFns=[],n._scopeId="data-v-57e24596"},{"core/utils/utils":92}],266:[function(e,t,r){!function(){function t(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=e("gui/gui");r["default"]={name:"g3w-resize",props:{show:{type:Boolean,required:!0,"default":!0},orientation:{type:String,required:!0,"default":"h"},where:{type:"string","default":"document"},moveFnc:{type:Function,"default":function(e){}},style:{type:Object,"default":{}}},methods:{wrapMoveFnc:function(e){this.domElementMoveListen.addEventListener("mouseup",this.stop,{once:!0}),this.moveFnc(e)},start:function(){this.domElementMoveListen.addEventListener("mousemove",this.wrapMoveFnc)},stop:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.domElementMoveListen.removeEventListener("mousemove",this.wrapMoveFnc),e.next=3,this.$nextTick();case 3:i.emit("resize");case 4:case"end":return e.stop()}},n,this)}));return e}()},watch:{orientation:{handler:function(e){this.style.cursor="v"===e?"ns-resize":"col-resize"},immediate:!0}},mounted:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.domElementMoveListen,this.style=n({minWidth:"5px",backgroundColor:"#dddddd",cursor:"col-resize"},this.style),e.t0=this.where,e.next="content"===e.t0?5:("document"===e.t0,7);break;case 5:return this.domElementMoveListen=document.getElementById("g3w-view-content"),e.abrupt("break",8);case 7:this.domElementMoveListen=document;case 8:case"end":return e.stop()}},i,this)}));return e}(),destroyed:function(){this.domElementMoveListen=null}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],style:e.style,attrs:{id:e.$attrs.id},on:{mousedown:function(t){return t.stopPropagation(),e.start(t)}}})},n.staticRenderFns=[],n._scopeId="data-v-d2660d28"},{"gui/gui":150}],267:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("gui/gui");r["default"]={name:"resize-icon",props:{type:{type:String,"default":"h"}},computed:function(){},methods:{toggleFull:function(){t.toggleFullViewContent(),t.emit("resize")},resetToDefault:function(){
t.resetToDefaultContentPercentage(),t.emit("resize")}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("i",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:bottom.create",value:"enlange_reduce",expression:"'enlange_reduce'",arg:"bottom",modifiers:{create:!0}}],staticClass:"action-button skin-color-dark","class":e.g3wtemplate.getFontClass("resize-"+e.type),staticStyle:{cursor:"pointer","margin-right":"3px"},on:{click:e.toggleFull}}),e._v(" "),r("i",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"reset_default",expression:"'reset_default'",arg:"left",modifiers:{create:!0}}],staticClass:"action-button skin-color-dark","class":e.g3wtemplate.getFontClass("resize-default"),staticStyle:{cursor:"pointer"},on:{click:e.resetToDefault}})])},n.staticRenderFns=[]},{"gui/gui":150}],268:[function(e,t,r){e("vueify/lib/insert-css").insert(".br[data-v-00ab4ef6]{border-radius:8px}.card[data-v-00ab4ef6]{width:80%;padding:10px 20px;margin:50px auto}.item[data-v-00ab4ef6]{height:15px;background:#ccc;margin-top:15px}.item-light[data-v-00ab4ef6]{background:#ddd}.text80[data-v-00ab4ef6]{width:80%}.chart-wrapper[data-v-00ab4ef6]{height:50px;display:flex;align-items:baseline;margin-bottom:20px}.chart-item[data-v-00ab4ef6]{height:100%;width:15px;background:#ccc;margin-right:10px}.chart-item-80[data-v-00ab4ef6]{height:80%}");!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"skeleton",mounted:function(){this.$nextTick(function(){})}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement;e._self._c||t;return e._m(0)},n.staticRenderFns=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"card br"},[r("div",{staticClass:"chart-wrapper"},[r("div",{staticClass:"chart-item br"}),e._v(" "),r("div",{staticClass:"chart-item chart-item-80 item-light br"}),e._v(" "),r("div",{staticClass:"chart-item br"}),e._v(" "),r("div",{staticClass:"chart-item br chart-item-80"})]),e._v(" "),r("div",{staticClass:"item br text80"}),e._v(" "),r("div",{staticClass:"item item-light br"}),e._v(" "),r("div",{staticClass:"item br"}),e._v(" "),r("div",{staticClass:"item item-light br text80"})])}],n._scopeId="data-v-00ab4ef6"},{"vueify/lib/insert-css":2}],269:[function(e,t,r){e("vueify/lib/insert-css").insert(".formquerytabs[data-v-4f13a336]{overflow:hidden!important;display:flex;flex-wrap:wrap}.formquerytabs>li[data-v-4f13a336]{flex:1;display:flex}.formquerytabs>li>a[data-v-4f13a336]{font-weight:700;flex:1}.tab-content[data-v-4f13a336]{//margin-top:10px}.nav-tabs>li>a.mobile[data-v-4f13a336]{padding:5px 10px}.tab_a[data-v-4f13a336]{padding:5px;margin-right:0!important;//border:1px solid #eee;border-bottom:0;margin-bottom:3px;border-radius:3px 3px 0 0}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var a,o=e("core/expression/tabservice"),s=t(o),l=e("components/GlobalTabsNode.vue"),u=t(l),c=e("gui/gui"),d=e("core/utils/utils"),p=d.getUniqueDomId;r["default"]=(a={name:"tabs",props:{group:{type:Boolean,"default":!1},contenttype:{"default":"query"},layerid:{required:!0},tabs:{required:!0},feature:{required:!0},fields:{required:!0},addToValidate:Function,removeToValidate:Function,changeInput:Function,showRelationByField:{type:Boolean,"default":!0},handleRelation:{type:Function,"default":function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.relation,r=e.layerId,n=e.feature;return c.getService("queryresults").showRelation({relation:t,layerId:r,feature:n})}}},components:{Node:u["default"]},data:function(){return{ids:[]}},computed:{required_fields:function(){return"editing"===this.contenttype&&this.fields.filter(function(e){return e.validate.required}).map(function(e){return e.name})},show:function(){return this.tabs.reduce(function(e,t){return e||void 0===t.visible||!!t.visible},!1)}},methods:{setVisibility:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function r(e){var t;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,s["default"].getVisibility({qgs_layer_id:this.layerid,expression:e.visibility_expression.expression,feature:this.feature,contenttype:this.contenttype});case 2:t=r.sent,e.visible=t;case 4:case"end":return r.stop()}},r,this)}));return e}(),setEditingRequireTab:function(e){var t=this,r=!1;return r=void 0===e.nodes?this.required_fields.indexOf(e.field_name)!==-1:!!e.nodes.find(function(e){return t.setEditingRequireTab(e)})},getField:function(e){return this.fields.find(function(t){return t.name===e})}}},n(a,"components",{Node:u["default"]}),n(a,"created",function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function r(){var e,t,n,a,o,s,l,u,c=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:for(this.unwatch=[],e=function(e){e.visibility_expression&&(void 0===e.visible&&c.$set(e,"visible",0),c.setVisibility(e)),"editing"===c.contenttype&&(void 0===e.required&&(e.required=c.setEditingRequireTab(e)),e.visibility_expression&&e.visibility_expression.referenced_columns.forEach(function(t){var r=c.fields.find(function(e){return e.name===t});c.unwatch.push(c.$watch(function(){return r.value},function(){var t=i(regeneratorRuntime.mark(function n(t){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:c.feature.set(r.name,t),c.setVisibility(e);case 2:case"end":return n.stop()}},n,c)}));return function(e){return t.apply(this,arguments)}}()))})),c.ids.push("tab_"+p())},t=!0,n=!1,a=void 0,r.prev=5,o=this.tabs[Symbol.iterator]();!(t=(s=o.next()).done);t=!0)l=s.value,e(l);r.next=13;break;case 9:r.prev=9,r.t0=r["catch"](5),n=!0,a=r.t0;case 13:r.prev=13,r.prev=14,!t&&o["return"]&&o["return"]();case 16:if(r.prev=16,!n){r.next=19;break}throw a;case 19:return r.finish(16);case 20:return r.finish(13);case 21:this.root_tabs=[],this.group?this.root_tabs=[this.tabs]:(u=[],this.tabs.forEach(function(e){e.nodes?u.push(e):(u.length&&(c.root_tabs.push([].concat(u)),u.splice(0)),c.root_tabs.push({nodes:[e]}))}),u.length&&this.root_tabs.push(u));case 23:case"end":return r.stop()}},r,this,[[5,9,13,21],[14,,16,20]])}));return e}()),n(a,"beforeDestroy",function(){this.unwatch.forEach(function(e){return e()}),this.unwatch=null}),a)}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.show?r("div",{staticClass:"tabs-wrapper"},[e._l(e.root_tabs,function(t){return[Array.isArray(t)?[r("ul",{staticClass:"formquerytabs nav nav-tabs"},[e._l(t,function(t,n){return[void 0===t.visible||t.visible?r("li",{"class":{active:0===n}},[r("a",{staticClass:"tab_a","class":{mobile:e.isMobile(),"group-title":e.group},style:{fontSize:e.isMobile()?"1.0em":(e.group?"1.1":"1.2")+"em"},attrs:{"data-toggle":"tab",href:"#"+e.ids[n]}},[e._v("\n              "+e._s(t.name)+" "),"editing"===e.contenttype&&t.required?r("span",{staticStyle:{"padding-left":"3px","font-size":"1.1em"}},[e._v("*")]):e._e()])]):e._e()]})],2),e._v(" "),r("div",{staticClass:"tab-content","class":{editing:"editing"===e.contenttype}},[e._l(t,function(t,n){return[void 0===t.visible||t.visible?r("div",{staticClass:"tab-pane fade","class":{"in active":0===n},attrs:{id:e.ids[n]}},[r("node",{attrs:{showRelationByField:e.showRelationByField,handleRelation:e.handleRelation,feature:e.feature,layerid:e.layerid,contenttype:e.contenttype,addToValidate:e.addToValidate,removeToValidate:e.removeToValidate,changeInput:e.changeInput,fields:e.fields,showTitle:!1,node:t}})],1):e._e()]})],2)]:r("node",{attrs:{showRelationByField:e.showRelationByField,handleRelation:e.handleRelation,feature:e.feature,layerid:e.layerid,contenttype:e.contenttype,addToValidate:e.addToValidate,removeToValidate:e.removeToValidate,changeInput:e.changeInput,fields:e.fields,showTitle:!1,node:t}})]})],2):e._e()},n.staticRenderFns=[],n._scopeId="data-v-4f13a336"},{"components/GlobalTabsNode.vue":270,"core/expression/tabservice":25,"core/utils/utils":92,"gui/gui":150,"vueify/lib/insert-css":2}],270:[function(e,t,r){e("vueify/lib/insert-css").insert(".tab-node[data-v-131d3550]{min-width:0;overflow:hidden}.title[data-v-131d3550]{font-weight:700;width:100%;color:#fff;padding:3px;margin-top:5px;margin-bottom:5px;border-radius:2px}.node-row[data-v-131d3550]{margin-bottom:5px;column-gap:2px;margin-top:5px;display:grid;grid-auto-columns:minmax(0,1fr);grid-auto-flow:column}.row.mobile[data-v-131d3550]{margin-bottom:0!important}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=e("components/InputG3W.vue"),a=t(i),o=e("gui/fields/fields"),s=e("core/project/projectsregistry");e("gui/gui");r["default"]={name:"node",props:["contenttype","node","fields","showTitle","addToValidate","removeToValidate","changeInput","layerid","feature","showRelationByField","handleRelation"],components:n({G3wInput:a["default"]},o),data:function(){return{context:this.contenttype,editing_required:!1}},computed:{filterNodes:function l(){var e=this,l=this.node.nodes&&this.node.nodes.filter(function(t){return"group"===e.getNodeType(t)||(!t.nodes&&t.name&&"group"!=e.getNodeType(t)?(t.relation=!0,!0):!!e.fields.find(function(e){var r=t.field_name?t.field_name.replace(/ /g,"_"):t.field_name;return e.name===r||t.relation}))});return l||[]},nodesLength:function(){return this.filterNodes.length},rows:function(){var e=1;if(0===this.nodesLength)e=0;else if(this.columnNumber<=this.nodesLength){var t=this.nodesLength%this.columnNumber;e=Math.floor(this.nodesLength/this.columnNumber)+t}return e},columnNumber:function(){var e=parseInt(this.node.columncount)?parseInt(this.node.columncount):1;return e>this.nodesLength?this.nodesLength:e},showGroupTile:function(){return this.showTitle&&this.node.showlabel&&this.node.groupbox}},methods:{loadingRelation:function(e){var t=s.getCurrentProject().getLayerById(this.layerid),r=t.getRelationById(e.name);return r.state},isRelationDisabled:function(e){return void 0===this.getRelationName(e.name)||"editing"===this.contenttype&&this.isRelationChildLayerNotEditable(e)},getRelationName:function(e){var t=s.getCurrentProject().getRelationById(e);return t&&t.name},isRelationChildLayerNotEditable:function(e){var t=(e.nmRelationId,e.name),r=s.getCurrentProject(),n=r.getRelationById(t),i=n.referencingLayer,a=r.getLayerById(i);return!a.isEditable()},getNodes:function(e){var t=(e-1)*this.columnNumber;return this.filterNodes.slice(t,this.columnNumber+t)},getNode:function(e,t){return this.getNodes(e)[t-1]},getField:function(e){if(e.relation)return e;var t=this.fields.find(function(t){var r=e.field_name?e.field_name.replace(/ /g,"_"):e.field_name;return t.name===r});return t},getNodeType:function(e){var t=e.groupbox||e.nodes?"group":e.relation?"relation":"field";return"field"!==t||void 0!==e.alias&&""!==e.alias||(e.alias=e.field_name),t},getComponent:function(e){return e.relation?void 0:e.query?e.input.type:"g3w-input"}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"tab-node group"},[e.showGroupTile?r("h5",{staticClass:"title group-title","class":{mobile:e.isMobile()},style:{fontSize:e.isMobile()?"1em":"1.1em"}},[e._v(e._s(e.node.name))]):e._e(),e._v(" "),e._l(e.rows,function(t){return r("div",{staticClass:"node-row","class":{mobile:e.isMobile()}},[e._l(e.columnNumber,function(n){return[e.getNode(t,n)?["field"===e.getNodeType(e.getNode(t,n))?r(e.getComponent(e.getField(e.getNode(t,n))),{tag:"component",staticStyle:{padding:"5px 3px 5px 3px"},attrs:{state:e.getField(e.getNode(t,n)),changeInput:e.changeInput,addToValidate:e.addToValidate,removeToValidate:e.removeToValidate,feature:e.feature},on:{changeinput:e.changeInput,addinput:e.addToValidate,removeinput:e.removeToValidate}}):["group"===e.getNodeType(e.getNode(t,n))?r("tabs",e._b({staticClass:"sub-group",staticStyle:{width:"100% !important"},attrs:{group:!0,tabs:[e.getNode(t,n)]}},"tabs",e.$props,!1)):[e.showRelationByField?r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.isRelationDisabled(e.getNode(t,n))||e.loadingRelation(e.getNode(t,n)).loading,expression:"isRelationDisabled(getNode(row, column)) || loadingRelation(getNode(row, column)).loading"}],style:{cursor:e.showRelationByField&&"pointer"},on:{click:function(r){e.handleRelation({relation:e.getNode(t,n),feature:e.feature,layerId:e.layerid})}}},[r("bar-loader",{attrs:{loading:e.loadingRelation(e.getNode(t,n)).loading}}),e._v(" "),r("div",{staticClass:"query_relation_field"},[r("i",{"class":e.g3wtemplate.font[""+("query"===e.context?"relation":"pencil")]})]),e._v(" "),r("span",[r("span",{staticClass:"query_relation_field_message"},[r("span"),e._v(" "),r("span",{staticStyle:{"text-transform":"uppercase"}},[e._v(" "+e._s(e.getRelationName(e.getNode(t,n).name)))])])])],1):e._e()]]]:e._e()]})],2)})],2)},n.staticRenderFns=[],n._scopeId="data-v-131d3550"},{"components/InputG3W.vue":277,"core/project/projectsregistry":83,"gui/fields/fields":145,"gui/gui":150,"vueify/lib/insert-css":2}],271:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={props:["state"],methods:{showCustomModal:function(e){this.$emit("show-custom-modal-content",e)}},created:function(){this.state.type=this.state.type||"link"}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",{staticClass:"customheaderlink dropdown user user-menu",attrs:{title:e.state.title}},["link"===e.state.type?r("a",{staticClass:"dropdown-toggle","class":{imagelink:!!e.state.img},attrs:{href:e.state.url,target:e.state.target}},[e.state.img?r("img",{staticStyle:{"max-height":"20px"},attrs:{src:e.state.img}}):r("span",[e.state.i18n?r("span",{directives:[{name:"t",rawName:"v-t",value:e.state.title,expression:"state.title"}]}):r("span",[e._v(e._s(e.state.title))])])]):"modal"===e.state.type?r("a",{staticClass:"dropdown-toggle",staticStyle:{cursor:"pointer"},attrs:{"data-toggle":"modal","data-target":"#custom_modal"},on:{click:function(t){return e.showCustomModal(e.state.id)}}},[r("span",[e._v(e._s(e.state.title))])]):e._e()])},n.staticRenderFns=[]},{}],272:[function(e,t,r){e("vueify/lib/insert-css").insert(".control-label[data-v-06ccc3d6]{text-align:left!important;margin-bottom:10px}");!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},n=e("gui/vue/vue.mixins"),i=n.baseInputMixin;r["default"]=t({name:"InputBase",props:["state"]},i)}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"form-group"},[e._t("label",[r("label",{staticClass:"col-sm-12 control-label",attrs:{"for":e.state.name}},[e._v(e._s(e.state.label)+"\n      "),e.state.validate&&e.state.validate.required?r("span",[e._v("*")]):e._e(),e._v(" "),e.showhelpicon?r("i",{staticClass:"skin-color","class":e.g3wtemplate.font.info,staticStyle:{"margin-left":"3px",cursor:"pointer"},on:{click:e.showHideHelp}}):e._e(),e._v(" "),e._t("label-action")],2)]),e._v(" "),r("div",{staticClass:"col-sm-12"},[e._t("loading"),e._v(" "),e._t("body"),e._v(" "),e._t("message",[e.notvalid?r("p",{staticClass:"error-input-message",staticStyle:{margin:"0"},domProps:{innerHTML:e._s(e.state.validate.message)}}):e.state.info?r("p",{staticStyle:{margin:"0"},domProps:{innerHTML:e._s(e.state.info)}}):e._e()]),e._v(" "),e.state.help&&this.state.help.visible?r("div",{staticClass:"g3w_input_help skin-background-color extralighten",domProps:{innerHTML:e._s(e.state.help.message)}}):e._e()],2)],2)},n.staticRenderFns=[],n._scopeId="data-v-06ccc3d6"},{"gui/vue/vue.mixins":227,"vueify/lib/insert-css":2}],273:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("gui/inputs/input"),n=e("gui/inputs/widgetmixins"),i=e("core/utils/utils"),a=i.getUniqueDomId;r["default"]={mixins:[t,n],data:function(){return{value:null,label:null,id:a()}},methods:{setLabel:function(){this.label=this.service.convertCheckedToValue(this.value)},setValue:function(){this.value=this.service.convertValueToChecked()},changeCheckBox:function(){this.setLabel(),this.widgetChanged()},stateValueChanged:function(){this.setValue(),this.setLabel()}},created:function(){this.value=this.state.forceNull?this.value:this.service.convertValueToChecked()},mounted:function(){this.state.forceNull||(this.setLabel(),this.change())}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baseinput",{attrs:{state:e.state}},[r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"}],staticStyle:{height:"20px","margin-top":"8px"},attrs:{slot:"body"},slot:"body"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],staticClass:"magic-checkbox","class":{"input-error-validation":e.notvalid},staticStyle:{width:"100%"},attrs:{type:"checkbox",id:e.id},domProps:{checked:Array.isArray(e.value)?e._i(e.value,null)>-1:e.value},on:{change:[function(t){var r=e.value,n=t.target,i=!!n.checked;if(Array.isArray(r)){var a=null,o=e._i(r,a);n.checked?o<0&&(e.value=r.concat([a])):o>-1&&(e.value=r.slice(0,o).concat(r.slice(o+1)))}else e.value=i},e.changeCheckBox]}}),e._v(" "),r("label",{attrs:{"for":e.id}},[e._v(e._s(e.label))])])])},n.staticRenderFns=[]},{"core/utils/utils":92,"gui/inputs/input":159,"gui/inputs/widgetmixins":183}],274:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("gui/inputs/input");r["default"]={mixins:[t]}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baseinput",{attrs:{state:e.state}},[r("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.value,expression:"state.value"}],staticClass:"form-control","class":{"input-error-validation":e.notvalid},staticStyle:{cursor:"pointer"},attrs:{slot:"body",placeholder:e.state["default"],type:"color",field:e.state.name,id:e.state.name},domProps:{value:e.state.value},on:{change:e.change,input:function(t){t.target.composing||e.$set(e.state,"value",t.target.value)}},slot:"body"})])},n.staticRenderFns=[]},{"gui/inputs/input":159}],275:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/applicationstate"),a=t(i),o=e("gui/inputs/input"),s=e("core/utils/utils"),l=s.getUniqueDomId,u=e("gui/vue/vue.mixins"),c=u.resizeMixin,d=u.widgetMixins;r["default"]={mixins:[o,d,c],data:function(){var e=l();return{widget_container:{top:0,left:0},iddatetimepicker:"datetimepicker_"+e,idinputdatetimepiker:"inputdatetimepicker_"+e,changed:!1}},methods:{resize:function(){var e=$("#"+this.iddatetimepicker);e&&e.data("DateTimePicker")&&e.data("DateTimePicker").hide()},timeOnly:function(){return!this.state.input.options.formats[0].date},stateValueChanged:function(e){var t=this.service.convertQGISDateTimeFormatToMoment(this.state.input.options.formats[0].displayformat),r=moment(e).format(t);$("#"+this.iddatetimepicker).val(r)}},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e,t,i,o,s,l=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.$nextTick();case 2:e=this.state.input.options.formats[0].fieldformat.replace("yyyy","YYYY").replace("dd","DD"),this.service.setValidatorOptions({fielddatetimeformat:e}),t=moment(this.state.value,e,!0).isValid()?moment(this.state.value,e).toDate():null,i=this.service.getLocale(),o=this.service.convertQGISDateTimeFormatToMoment(this.state.input.options.formats[0].displayformat),s=this.service.convertQGISDateTimeFormatToMoment(this.state.input.options.formats[0].fieldformat),$("#"+this.iddatetimepicker).datetimepicker({defaultDate:t,format:o,ignoreReadonly:!0,allowInputToggle:!0,toolbarPlacement:"top",widgetParent:$(this.$refs.datimewidget_container),widgetPositioning:{vertical:"top",horizontal:"left"},showClose:!0,locale:i}),$("#"+this.iddatetimepicker).on("dp.change",function(e){var t=$("#"+l.idinputdatetimepiker).val();l.state.value=_.isEmpty(_.trim(t))?null:moment(t,o).format(s),l.widgetChanged()}),$("#"+this.iddatetimepicker).on("dp.show",function(){var e=n(regeneratorRuntime.mark(function t(e){var r,n,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.$nextTick();case 2:r=l.$refs.datetimepicker_body.getBoundingClientRect(),n=r.top,i=r.left,a=r.width,l.widget_container.top=n,l.widget_container.left=i-a,l.$emit("datetimepickershow");case 6:case"end":return e.stop()}},t,l)}));return function(t){return e.apply(this,arguments)}}()),$("#"+this.iddatetimepicker).on("dp.hide",function(e){l.$emit("datetimepickershow")}),a["default"].ismobile&&setTimeout(function(){$("#"+l.idinputdatetimepiker).blur()});case 13:case"end":return r.stop()}},r,this)}));return e}()}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baseinput",{attrs:{state:e.state}},[r("div",{ref:"datetimepicker_body",attrs:{slot:"body"},slot:"body"},[r("div",{ref:"datimewidget_container",staticStyle:{position:"fixed","z-index":"10000"},style:{top:e.widget_container.top+"px",left:e.widget_container.left+"px"}}),e._v(" "),r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"}],staticClass:"input-group date",attrs:{id:e.iddatetimepicker}},[r("input",{staticClass:"form-control","class":{"input-error-validation":e.notvalid},attrs:{id:e.idinputdatetimepiker,readonly:!e.editable||e.isMobile()?"readonly":null,type:"text"}}),e._v(" "),r("span",{staticClass:"input-group-addon caret"},[r("span",{"class":[e.timeOnly()?e.g3wtemplate.getFontClass("time"):e.g3wtemplate.getFontClass("calendar")]})])])])])},n.staticRenderFns=[]},{"core/applicationstate":8,"core/utils/utils":92,"gui/inputs/input":159,"gui/vue/vue.mixins":227}],276:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("gui/inputs/input");r["default"]={mixins:[t]}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baseinput",{attrs:{state:e.state}},[r("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.value,expression:"state.value"}],staticClass:"form-control","class":{"input-error-validation":e.notvalid},staticStyle:{width:"100%"},attrs:{slot:"body",type:"number",step:e.state.step||1,placeholder:e.state["default"]},domProps:{value:e.state.value},on:{change:e.change,input:[function(t){t.target.composing||e.$set(e.state,"value",t.target.value)},e.change]},slot:"body"})])},n.staticRenderFns=[]},{"gui/inputs/input":159}],277:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},n=e("gui/inputs/inputs");r["default"]={name:"g3w-input",props:{state:{required:!0},addToValidate:{type:Function,required:!0},removeToValidate:{type:Function,required:!0},changeInput:{type:Function,required:!0}},components:t({},n),computed:{type:function(){if("child"!==this.state.type)return this.state.input.type?this.state.input.type+"_input":this.state.type+"_input"}},created:function(){"child"===this.state.type||this.state.input.options||(this.state.input.options={})}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",["child"!==e.state.type?r("div",[r(e.type,{tag:"component",attrs:{changeInput:e.changeInput,addToValidate:e.addToValidate,removeToValidate:e.removeToValidate,state:e.state},on:{changeinput:e.changeInput,addinput:e.addToValidate,removeinput:e.removeToValidate}}),e._v(" "),r("span",{staticClass:"divider"})],1):r("div",{staticClass:"skin-border-color field-child",staticStyle:{"border-top":"2px solid"}},[r("h4",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(e.state.label))]),e._v(" "),r("div",[e._v(" "+e._s(e.state.description)+" ")]),e._v(" "),e._l(e.state.fields,function(t){return r("g3w-input",{key:t.name,attrs:{state:t,changeInput:e.changeInput,addToValidate:e.addToValidate,removeToValidate:e.removeToValidate},on:{changeinput:e.changeInput,addinput:e.addToValidate,removeinput:e.removeToValidate}})})],2)])},n.staticRenderFns=[],n._scopeId="data-v-2bbb7c94"},{"gui/inputs/inputs":160}],278:[function(e,t,r){e("vueify/lib/insert-css").insert("#g3w-for-inputs-required-inputs-message[data-v-155589a3]{margin-bottom:5px;font-weight:700;text-align:center;display:flex;align-items:center;justify-content:center}.box-body[data-v-155589a3]{padding:5px}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("components/InputG3W.vue"),i=t(n);r["default"]={name:"g3w-form-inputs",props:{state:{type:Object,"default":{fields:[]}},addToValidate:{type:Function},changeInput:{type:Function},show_required_field_message:{type:Boolean,"default":!1}},components:{G3wInput:i["default"]}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("form",{staticClass:"form-horizontal g3w-form"},[r("div",{staticClass:"box-primary"},[r("div",{staticClass:"box-body"},[e._l(e.state.fields,function(t){return[r("g3w-input",{attrs:{state:t,addToValidate:e.addToValidate,changeInput:e.changeInput},on:{addToValidate:e.addToValidate,changeInput:e.changeInput}})]})],2),e._v(" "),e.show_required_field_message?r("div",{attrs:{id:"g3w-for-inputs-required-inputs-message"}},[r("span",{staticClass:"hide-cursor-caret-color"},[e._v("*")]),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.form.footer.required_fields",expression:"'sdk.form.footer.required_fields'"}],staticClass:"hide-cursor-caret-color"})]):e._e()])])},n.staticRenderFns=[],n._scopeId="data-v-155589a3"},{"components/InputG3W.vue":277,"vueify/lib/insert-css":2}],279:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("gui/inputs/input");r["default"]={mixins:[t]}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baseinput",{attrs:{state:e.state}},[r("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.value,expression:"state.value"}],staticClass:"form-control","class":{"input-error-validation":e.notvalid},staticStyle:{width:"100%"},attrs:{slot:"body",placeholder:e.state["default"],type:"number"},domProps:{value:e.state.value},on:{change:e.change,input:[function(t){t.target.composing||e.$set(e.state,"value",t.target.value)},e.change]},slot:"body"})])},n.staticRenderFns=[]},{"gui/inputs/input":159}],280:[function(e,t,r){!function(){function t(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("core/utils/utils"),i=n.getUniqueDomId,a=e("gui/inputs/input");r["default"]={mixins:[a],data:function(){return{lonId:i(),latId:i(),coordinatebutton:{active:!1}}},computed:{getCoordinateActive:function(){return this.service.state.getCoordinateActive}},methods:{toggleGetCoordinate:function(){this.service.toggleGetCoordinate()},changeLonLat:function(){this.change(),this.setValue()},setValue:function(){this.state.value=[[1*this.state.values.lon,1*this.state.values.lat]]}},created:function(){this.state.values=this.state.values||{lon:0,lat:0},this.setValue(),this.service.setCoordinateButtonReactiveObject(this.coordinatebutton)},mounted:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$nextTick();case 2:this.$nextTick(function(){$(e.$refs["g3w-input-lat-lon"]).tooltip({trigger:"hover"})});case 3:case"end":return t.stop()}},n,this)}));return e}(),destroyed:function(){this.service.clear()}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{position:"relative"}},[r("div",{staticStyle:{display:"flex","justify-content":"flex-end",height:"35px","margin-right":"12px","margin-bottom":"5px"}},[r("button",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.form.inputs.tooltips.lonlat",expression:"'sdk.form.inputs.tooltips.lonlat'"}],ref:"g3w-input-lat-lon",staticClass:"action skin-tooltip-left skin-color skin-border-color","class":e.g3wtemplate.font.crosshairs,staticStyle:{"border-radius":"5px","font-weight":"bold","font-size":"20px",cursor:"pointer"},style:{border:e.coordinatebutton.active?"2px solid":0},attrs:{"data-placement":"left","data-toggle":"tooltip"},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.toggleGetCoordinate(t)}}})]),e._v(" "),r("baseinput",{attrs:{state:e.state}},[r("label",{staticClass:"col-sm-4 control-label",attrs:{slot:"label","for":e.lonId},slot:"label"},[e._v(e._s(e.state.labels.lon)+"\n      "),e.state.validate&&e.state.validate.required?r("span",[e._v("*")]):e._e()]),e._v(" "),r("div",{attrs:{
slot:"body"},slot:"body"},[r("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.values.lon,expression:"state.values.lon"}],staticClass:"form-control","class":{"input-error-validation":e.notvalid},staticStyle:{width:"100%","margin-bottom":"5px"},attrs:{id:e.lonId,type:"number",min:"-180",max:"180",placeholder:"Lon"},domProps:{value:e.state.values.lon},on:{change:e.changeLonLat,input:function(t){t.target.composing||e.$set(e.state.values,"lon",t.target.value)}}})])]),e._v(" "),r("baseinput",{attrs:{state:e.state}},[r("label",{staticClass:"col-sm-4 control-label",attrs:{slot:"label","for":e.latId},slot:"label"},[e._v(e._s(e.state.labels.lat)+"\n      "),e.state.validate&&e.state.validate.required?r("span",[e._v("*")]):e._e()]),e._v(" "),r("div",{attrs:{slot:"body"},slot:"body"},[r("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.values.lat,expression:"state.values.lat"}],staticClass:"form-control","class":{"input-error-validation":e.notvalid},staticStyle:{width:"100%","margin-bottom":"5px"},attrs:{id:e.latId,type:"number",min:"-90",max:"90",placeholder:"Lon"},domProps:{value:e.state.values.lat},on:{change:e.changeLonLat,input:function(t){t.target.composing||e.$set(e.state.values,"lat",t.target.value)}}})])])],1)},n.staticRenderFns=[]},{"core/utils/utils":92,"gui/inputs/input":159}],281:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("gui/inputs/input"),n=e("core/utils/utils"),i=n.getUniqueDomId,a=e("core/i18n/i18n.service"),o=a.t,s=e("gui/fields/fields"),l=s.media_field,u=e("gui/gui");r["default"]={mixins:[t],components:{"g3w-media":l},data:function(){return{data:{value:null,mime_type:null},mediaid:"media_"+i(),loading:!1}},methods:{onClick:function(e){document.getElementById(this.mediaid).click()},createImage:function(e,t){var r=new FileReader;r.onload=function(e){t.value=e.target.result},r.readAsDataURL(e)},checkFileSrc:function(e){return _.isNil(e)&&(e=""),e},clearMedia:function(){this.data.value=this.data.mime_type=this.state.value=null}},created:function(){this.state.value&&(this.data.value=this.state.value.value,this.data.mime_type=this.state.value.mime_type)},mounted:function(){var e=this,t=this.state.name,r={name:t,csrfmiddlewaretoken:this.$cookie.get("csrftoken")};this.$nextTick(function(){$("#"+e.mediaid).fileupload({dataType:"json",formData:r,start:function(){e.loading=!0},done:function(r,n){var i=n.result[t];i&&(e.data.value=i.value,e.data.mime_type=i.mime_type,e.state.value=e.data,e.change())},fail:function(){u.notify.error(o("info.server_error"))},always:function(){e.loading=!1}})})},beforeDestroy:function(){$("#"+this.mediaid).fileupload("destroy")}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baseinput",{attrs:{state:e.state}},[r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"}],attrs:{slot:"body"},slot:"body"},[r("div",{staticClass:"g3w_input_button skin-border-color",staticStyle:{"border-style":"solid","border-width":"2px","border-radius":"4px",width:"100%",cursor:"pointer","text-align":"center"},on:{click:e.onClick}},[r("i",{staticClass:"fa-2x skin-color","class":e.g3wtemplate.getFontClass("file-upload"),staticStyle:{padding:"5px"}},[r("input",{"class":{"input-error-validation":e.notvalid},staticStyle:{display:"none"},attrs:{id:e.mediaid,name:e.state.name,"data-url":e.state.input.options.uploadurl,type:"file"}})])]),e._v(" "),r("bar-loader",{attrs:{loading:e.loading}}),e._v(" "),r("g3w-media",{attrs:{state:e.data}},[r("div",{staticClass:"clearmedia",on:{click:function(t){return e.clearMedia()}}},[r("i",{staticClass:"g3w-icon","class":e.g3wtemplate.font["trash-o"]})])])],1)])},n.staticRenderFns=[]},{"core/i18n/i18n.service":27,"core/utils/utils":92,"gui/fields/fields":145,"gui/gui":150,"gui/inputs/input":159}],282:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("gui/inputs/input"),n=e("gui/inputs/picklayer/service");r["default"]={mixins:[t],methods:{pickLayer:function(){var e=this;this.pickservice.pick().then(function(t){return e.state.value=t})["catch"](function(){})},unpick:function(){var e=this;setTimeout(function(){return!e.pickservice.isPicked()&&e.pickservice.unpick()},200)}},created:function(){this.pickservice=new n(this.state.input.options)},beforeDestroy:function(){this.pickservice.clear(),this.pickservice=null}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baseinput",{attrs:{state:e.state}},[r("div",{attrs:{slot:"body"},slot:"body"},[r("span",{staticClass:"skin-color","class":e.g3wtemplate.font.crosshairs,staticStyle:{left:"0",top:"7px",position:"absolute"}}),e._v(" "),r("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.value,expression:"state.value"}],staticClass:"form-control","class":{"input-error-validation":e.notvalid},staticStyle:{width:"100%"},style:{cursor:e.editable?"pointer":null},attrs:{readonly:"readonly"},domProps:{value:e.state.value},on:{input:[function(t){t.target.composing||e.$set(e.state,"value",t.target.value)},e.change],click:e.pickLayer,blur:e.unpick}})])])},n.staticRenderFns=[]},{"gui/inputs/input":159,"gui/inputs/picklayer/service":167}],283:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("gui/inputs/input"),n=e("core/utils/utils"),i=n.getUniqueDomId;r["default"]={mixins:[t],data:function(){return{ids:[i(),i()],name:"name_"+i(),radio_value:this.state.value}},watch:{radio_value:function(){this.state.value=this.radio_value,this.change()}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baseinput",{attrs:{state:e.state}},[r("div",{attrs:{slot:"body"},slot:"body"},e._l(e.state.input.options.values,function(t,n){return r("span",{key:t.key},[r("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.radio_value,expression:"radio_value"}],staticClass:"magic-radio","class":{"input-error-validation":e.notvalid},staticStyle:{width:"100%"},attrs:{id:e.ids[n],name:e.name,type:"radio"},domProps:{value:t.value,checked:e._q(e.radio_value,t.value)},on:{change:function(r){e.radio_value=t.value}}}),e._v(" "),r("label",{attrs:{"for":e.ids[n]}},[e._v(e._s(t.key))])])}),0)])},n.staticRenderFns=[]},{"core/utils/utils":92,"gui/inputs/input":159}],284:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("gui/inputs/input");r["default"]={mixins:[t],data:function(){var e=this.state.input.options.values[0],t=1*e.min,r=1*e.max,n=1*e.Step;return{max:r,min:t,step:n}},methods:{checkValue:function(){var e=!(this.state.validate.required||!_.isEmpty(_.trim(this.state.value)))||this.service.getValidator().validate(this.state.value);this.state.validate.valid=e,this.change()}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baseinput",{attrs:{state:e.state}},[r("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.value,expression:"state.value"}],staticClass:"form-control","class":{"input-error-validation":e.notvalid},staticStyle:{width:"100%","padding-right":"5px"},attrs:{slot:"body",type:"number",step:e.step},domProps:{value:e.state.value},on:{keydown:[function(e){return e.type.indexOf("key")||69===e.keyCode?void e.preventDefault():null},function(e){return e.type.indexOf("key")||13===e.keyCode?void e.stopPropagation():null}],change:e.checkValue,blur:e.checkValue,input:function(t){t.target.composing||e.$set(e.state,"value",t.target.value)}},slot:"body"})])},n.staticRenderFns=[]},{"gui/inputs/input":159}],285:[function(e,t,r){!function(){function t(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("gui/inputs/picklayer/service"),i=e("core/map/maplayersstoresregistry"),a=e("core/catalog/cataloglayersstoresregistry"),o=e("core/layers/layer"),s=e("gui/inputs/input"),l=e("gui/vue/vue.mixins"),u=l.selectMixin,c=l.select2Mixin,d=e("gui/gui"),p=null;r["default"]={mixins:[s,u,c],data:function(){return{showPickLayer:!1,picked:!1}},computed:{showNullOption:function(){return void 0===this.state.nullOption||this.state.nullOption===!0},select2NullValue:function(){return this.showNullOption&&p},disabled:function(){return!this.editable||"loading"===this.loadingState||"error"===this.loadingState}},watch:{"state.input.options.values":function(){function e(e){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(e){var t,r,i,a=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$nextTick();case 2:t=!1,this.autocomplete||(r=void 0,0===e.length?r=p:(i=e.find(function(e){return e.value==a.state.value}),r=i?i.value:p),t=r!=this.state.value,this.state.value=r,this.setValue()),t&&this.change();case 5:case"end":return n.stop()}},n,this)}));return e}()},methods:{pickLayerValue:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(){var e,t,r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,!this.picked){n.next=6;break}this.pickLayerInputService.unpick(),this.picked=!1,n.next=16;break;case 6:return this.picked=!0,n.next=9,this.pickLayerInputService.pick();case 9:e=n.sent,t=this.state.input.options.value,r=e[t],this.select2.val(r).trigger("change"),this.changeSelect(r),d.showUserMessage({type:"success",autoclose:!0}),this.picked=!1;case 16:n.next=22;break;case 18:n.prev=18,n.t0=n["catch"](0),d.showUserMessage({type:"warning",message:"sdk.form.inputs.messages.errors.picklayer",autoclose:!0}),this.picked=!1;case 22:case"end":return n.stop()}},n,this,[[0,18]])}));return e}(),setAndListenSelect2Change:function(){var e=this;this.select2.on("select2:select",function(t){var r=t.params.data.$value?t.params.data.$value:t.params.data.id;r=e.showNullOption&&r===p?null:r.toString(),e.changeSelect(r)})}},created:function(){if(this.open=!1,"select_autocomplete"===this.state.input.type){var e=this.state.input.options.layer_id;try{var t=i.getLayerById(e).getEditingLayer()||a.getLayerById(e);this.showPickLayer=!!t&&t.getType()!==o.LayerTypes.TABLE;var r=this.state.input.options,s=r.value,l=r.layer_id,u={layer_id:l,fields:[s],pick_type:t.isStarted&&t.isStarted()&&"map"||null};this.pickLayerInputService=this.showPickLayer&&new n(u)}catch(c){}}this.autocomplete&&this.state.value&&this.service.getKeyByValue({search:this.state.value})},mounted:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(){var e,t,r,i=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$nextTick();case 2:this.unwatch,e=$(this.$refs.select),t=this.getLanguage(),r=void 0===this.state.dropdownParent&&$("#g3w-view-content"),this.autocomplete?this.select2=e.select2({minimumInputLength:1,dropdownParent:r,allowClear:this.showNullOption,language:t,ajax:{delay:250,transport:function(e,t,r){var n=e.data.term;$(".select2-results__option.loading-results").siblings().hide(),i.resetValues(),i.service.getData({search:n}).then(function(e){return t(e)})["catch"](function(e){return r(e)})},processResults:function(e,t){return t.page=t.page||1,{results:e,pagination:{more:!1}}}}}):this.select2=e.select2({language:t,dropdownParent:r,minimumResultsForSearch:this.isMobile()?-1:null}),this.setAndListenSelect2Change(),this.setValue();case 9:case"end":return n.stop()}},n,this)}));return e}(),beforeDestroy:function(){this.pickLayerInputService&&(this.pickLayerInputService.clear(),this.pickLayerInputService=null),this.unwatch&&this.unwatch(),this.unwatch=null}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baseinput",{attrs:{state:e.state}},["loading"===e.loadingState?r("div",{staticStyle:{position:"relative",width:"100%"},attrs:{slot:"loading"},slot:"loading"},[r("bar-loader",{attrs:{loading:"true"}})],1):e._e(),e._v(" "),e.showPickLayer?r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.form.inputs.tooltips.picklayer",expression:"'sdk.form.inputs.tooltips.picklayer'"},{name:"disabled",rawName:"v-disabled",value:e.disabled,expression:"disabled"}],staticClass:"skin-color","class":e.g3wtemplate.font.crosshairs,staticStyle:{cursor:"pointer",position:"relative",top:"2px","font-size":"1.2em"},attrs:{slot:"label-action","data-placement":"top"},on:{click:e.pickLayerValue},slot:"label-action"}):e._e(),e._v(" "),r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.disabled,expression:"disabled"}],attrs:{slot:"body"},slot:"body"},[r("select",{ref:"select",staticClass:"form-control",staticStyle:{width:"100%"}},[e.showNullOption?r("option",{domProps:{value:e.select2NullValue}}):e._e(),e._v(" "),e._l(e.state.input.options.values,function(t){return r("option",{key:e.getValue(t.value),domProps:{value:e.getValue(t.value)}},[e._v(e._s(t.key))])})],2)]),e._v(" "),"error"===e.loadingState?r("p",{directives:[{name:"t",rawName:"v-t",value:"server_error",expression:"'server_error'"}],staticClass:"error-input-message",attrs:{slot:"message"},slot:"message"}):e._e()])},n.staticRenderFns=[]},{"core/catalog/cataloglayersstoresregistry":9,"core/layers/layer":52,"core/map/maplayersstoresregistry":76,"gui/gui":150,"gui/inputs/input":159,"gui/inputs/picklayer/service":167,"gui/vue/vue.mixins":227}],286:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("gui/inputs/input");r["default"]={mixins:[t],watch:{"state.input.options.min":function(){this.service.changeInfoMessage()},"state.input.options.max":function(){this.service.changeInfoMessage()}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baseinput",{attrs:{state:e.state}},[r("div",{attrs:{slot:"body"},slot:"body"},[r("span",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(e.state.value))]),e._v(" "),r("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.value,expression:"state.value"}],"class":{"input-error-validation":e.notvalid},staticStyle:{width:"100%","padding-right":"5px"},attrs:{slot:"body",min:e.state.input.options.min,max:e.state.input.options.max,type:"range",step:e.state.input.options.step},domProps:{value:e.state.value},on:{change:e.change,__r:function(t){return e.$set(e.state,"value",t.target.value)}},slot:"body"})])])},n.staticRenderFns=[]},{"gui/inputs/input":159}],287:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("gui/inputs/input");r["default"]={mixins:[t]}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baseinput",{attrs:{state:e.state}},[r("input",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.value,expression:"state.value"}],staticClass:"form-control","class":{"input-error-validation":e.notvalid},attrs:{slot:"body",placeholder:e.state["default"],field:e.state.name,id:e.state.name},domProps:{value:e.state.value},on:{keyup:function(t){e.isMobile()?e.mobileChange(t):e.change()},input:function(t){t.target.composing||e.$set(e.state,"value",t.target.value)}},slot:"body"})])},n.staticRenderFns=[]},{"gui/inputs/input":159}],288:[function(e,t,r){e("vueify/lib/insert-css").insert("textarea[data-v-baa98542]{resize:none;border:1px solid #ccc}");!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("gui/inputs/input");r["default"]={mixins:[t]}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baseinput",{attrs:{state:e.state}},[r("textarea",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"},{name:"model",rawName:"v-model",value:e.state.value,expression:"state.value"}],"class":{"input-error-validation":e.notvalid},staticStyle:{"max-width":"100%","min-width":"100%"},attrs:{slot:"body",placeholder:e.state["default"],rows:"3"},domProps:{value:e.state.value},on:{keydown:function(e){e.stopPropagation()},input:[function(t){t.target.composing||e.$set(e.state,"value",t.target.value)},e.change],change:e.change},slot:"body"})])},n.staticRenderFns=[],n._scopeId="data-v-baa98542"},{"gui/inputs/input":159,"vueify/lib/insert-css":2}],289:[function(e,t,r){!function(){function t(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("gui/inputs/input"),i=e("gui/vue/vue.mixins"),a=i.selectMixin,o=e("core/utils/utils"),s=o.getUniqueDomId;r["default"]={mixins:[n,a],data:function(){var e="unique_"+s();return{id:e}},watch:{"state.input.options.values":function(){function e(e){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.state.value=this.state.value?this.state.value:null,null!==this.state.value&&e.indexOf(this.state.value)===-1&&this.service.addValueToValues(this.state.value),t.next=4,this.$nextTick();case 4:this.state.value&&this.select2.val(this.state.value).trigger("change");case 5:case"end":return t.stop()}},n,this)}));return e}()},mounted:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$nextTick();case 2:this.state.input.options.editable&&(this.select2=$("#"+this.id).select2({dropdownParent:$("#g3w-view-content"),tags:!0,language:this.getLanguage()}),this.select2.val(this.state.value).trigger("change"),this.select2.on("select2:select",function(t){var r=t.params.data.$value?t.params.data.$value:t.params.data.id;e.changeSelect(r)}));case 3:case"end":return t.stop()}},n,this)}));return e}()}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baseinput",{attrs:{state:e.state}},[r("select",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.editable,expression:"!editable"}],staticClass:"form-control",staticStyle:{width:"100%"},attrs:{slot:"body",id:e.id},slot:"body"},[r("option",{attrs:{value:"null"}}),e._v(" "),e._l(e.state.input.options.values,function(t){return r("option",{key:t,domProps:{value:e.getValue(t)}},[e._v(e._s(e.getValue(t)))])})],2)])},n.staticRenderFns=[]},{"core/utils/utils":92,"gui/inputs/input":159,"gui/vue/vue.mixins":227}],290:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("components/MapAddLayer.vue"),a=t(i),o=e("./MapFooter.vue"),s=t(o);r["default"]={data:function(){var e=this.$options,t=e.service,r=e.target;return{target:r,maps_container:this.$options.maps_container,service:t,hidemaps:t.state.hidemaps,map_info:t.state.map_info}},components:{addlayer:a["default"],MapFooter:s["default"]},computed:{mapcontrolsalignement:function(){return this.service.state.mapcontrolsalignement},disableMapControls:function(){return this.service.state.mapControl.disabled}},methods:{showHideControls:function(){var e=this.service.getMapControls();e.forEach(function(e){return"scaleline"!==e.type&&e.control.showHide()})}},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.crs=this.service.getCrs(),t.next=3,this.$nextTick();case 3:this.service.setMapControlsContainer($(this.$refs["g3w-map-controls"])),this.service.onafter("addHideMap",n(regeneratorRuntime.mark(function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.ratio,i=t.layers,a=void 0===i?[]:i,o=t.mainview,s=void 0!==o&&o,l=t.switchable,u=void 0!==l&&l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$nextTick();case 2:e.service._addHideMap({ratio:n,layers:a,mainview:s,switchable:u});case 3:case"end":return t.stop()}},r,e)})));case 5:case"end":return t.stop()}},r,this)}));return e}(),destroyed:function(){this.service.clear()}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:e.maps_container}},[e._l(e.hidemaps,function(e){return r("div",{key:e.id,staticClass:"g3w-map hidemap",attrs:{id:e.id}})}),e._v(" "),r("div",{staticClass:"g3w-map",attrs:{id:e.target}},[r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.disableMapControls,expression:"disableMapControls"}],ref:"g3w-map-controls",staticClass:"g3w-map-controls","class":e.mapcontrolsalignement,staticStyle:{display:"flex"}}),e._v(" "),e.map_info.info?r("div",{ref:"g3w-map-info",style:e.map_info.style,attrs:{id:"g3w-map-info"}},[e._v("\n      "+e._s(e.map_info.info)+"\n    ")]):e._e(),e._v(" "),e._m(0),e._v(" "),r("addlayer",{attrs:{service:e.service}})],1),e._v(" "),r("map-footer",{attrs:{service:e.service}})],2)},n.staticRenderFns=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{display:"none"}},[r("div",{attrs:{id:"marker"}})])}]},{"./MapFooter.vue":292,"components/MapAddLayer.vue":291}],291:[function(e,t,r){!function(){function t(e){return Array.isArray(e)?e:Array.from(e)}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("app/constant"),a=e("core/utils/geo"),o=a.createVectorLayerFromFile,s=a.createStyleFunctionToVectorLayer,l=["zip","geojson","GEOJSON","kml","kmz","KMZ","KML","json","gpx","gml","csv"],u=[",",";"],c=VueColor.Chrome;c.mounted=n(regeneratorRuntime.mark(function d(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:$(".vue-color__chrome__toggle-btn").remove(),$(".vue-color__editable-input__label").remove(),$(".vue-color__chrome__saturation-wrap").css("padding-bottom","100px"),$(".vue-color__chrome").css({"box-shadow":"0 0 0 0",border:"1px solid #97A1A8"});case 6:case"end":return e.stop()}},d,this)})),r["default"]={props:["service"],data:function(){var e=this.service.getCrs();return void 0===i.EPSG.find(function(t){return t===e})&&i.EPSG.unshift(e),{vectorLayer:null,options:i.EPSG,error:!1,error_message:null,position:null,loading:!1,fields:[],field:null,accepted_extension:l.map(function(e){return"."+e}).join(","),csv:{valid:!1,loading:!1,headers:[],x:null,y:null,separators:u,separator:u[0]},layer:{name:null,type:null,crs:null,mapCrs:null,color:{hex:"#194d33",rgba:{r:25,g:77,b:51,a:1},a:1},data:null,visible:!0,title:null,id:null,external:!0}}},components:{"chrome-picker":c},methods:{setLayerMapPosition:function(e){this.position=e},setError:function(e){this.error_message="sdk.errors."+e,this.error=!0},clearError:function(){this.error=!1,this.error_message=null},onChangeColor:function(e){this.layer.color=e},onAddLayer:function(){function e(e){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function i(e){var r,n,a,o,s,u=this;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(this.csv.valid=!0,r=new FileReader,n=e.target.files[0].name,a=e.target.files[0].name.split("."),a=a[a.length-1].toLowerCase(),o=$(this.$refs.input_file),l.indexOf(a)===-1){i.next=33;break}if(this.clearError(),this.layer.mapCrs=this.service.getEpsg(),this.layer.name=n,this.layer.title=n,this.layer.id=n,this.layer.type=a,"csv"!==this.layer.type){i.next=18;break}r.onload=function(e){o.val(null);var r=e.target.result.split(/\r\n|\n/).filter(function(e){return e}),n=t(r),i=n[0],a=n.slice(1),s=function(e){var t=void 0;u.csv.loading=!0;var r=i.split(e),n=r.length;return n>1?(u.csv.headers=r,u.fields=r,u.csv.x=r[0],u.csv.y=r[1],t={headers:r,separator:e,x:u.csv.x,y:u.csv.y,values:a},u.csv.valid=!0):(u.csv.headers=u.fields=[],u.vectorLayer=null,u.csv.valid=!1,u.fields.splice(0)),u.csv.loading=!1,t};u.layer.data=s(u.csv.separator),u.$watch("csv.separator",function(e){return u.layer.data=s(e)})},r.readAsText(e.target.files[0]),i.next=31;break;case 18:return s=new Promise(function(t,n){if("zip"===u.layer.type||"kmz"===u.layer.type){var i=e.target.files[0];o.val(null),t(i)}else r.onload=function(e){var r=e.target.result;o.val(null),t(r)},r.readAsText(e.target.files[0])}),i.next=21,s;case 21:return this.layer.data=i.sent,i.prev=22,this.fields.splice(0),i.next=26,this.createVectorLayer();case 26:this.fields=this.vectorLayer.get("_fields"),i.next=31;break;case 29:i.prev=29,i.t0=i["catch"](22);case 31:i.next=34;break;case 33:this.setError("unsupported_format");case 34:case"end":return i.stop()}},i,this,[[22,29]])}));return e}(),createVectorLayer:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o(this.layer);case 3:return this.vectorLayer=e.sent,e.next=6,this.$nextTick();case 6:e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),this.setError("add_external_layer");case 11:case"end":return e.stop()}},r,this,[[0,8]])}));return e}(),addLayer:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.vectorLayer&&!this.csv.valid){e.next=17;break}return this.loading=!0,e.prev=2,e.next=5,o(this.layer);case 5:return this.vectorLayer=e.sent,this.vectorLayer.setStyle(s({color:this.layer.color,field:this.field})),e.next=9,this.service.addExternalLayer(this.vectorLayer,{crs:this.layer.crs,type:this.layer.type,position:this.position});case 9:$(this.$refs.modal_addlayer).modal("hide"),this.clearLayer(),e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](2),this.setError("add_external_layer");case 16:this.loading=!1;case 17:case"end":return e.stop()}},r,this,[[2,13]])}));return e}(),clearLayer:function(){this.clearError(),this.loading=!1,this.layer.name=null,this.layer.title=null,this.layer.id=null,this.layer.type=null,this.layer.crs=this.service.getCrs(),this.layer.color={hex:"#194d33",rgba:{r:25,g:77,b:51,a:1},a:1},this.layer.data=null,this.vectorLayer=null,this.fields=[],this.field=null}},computed:{csv_extension:function(){return"csv"===this.layer.type},add:function(){return this.vectorLayer||this.csv.valid}},watch:{"csv.x":function(e){e&&(this.layer.data.x=e)},"csv.y":function(e){e&&(this.layer.data.y=e)}},created:function(){var e=this;this.layer.crs=this.service.getCrs(),this.service.on("addexternallayer",function(){return e.modal.modal("show")})},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$nextTick();case 2:this.modal=$("#modal-addlayer").modal("hide"),this.modal.on("hidden.bs.modal",function(){return e.clearLayer()});case 4:case"end":return t.stop()}},r,this)}));return e}(),beforeDestroy:function(){this.clearLayer(),this.modal.modal("hide"),this.modal.remove()}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{ref:"modal_addlayer",staticClass:"modal fade",attrs:{id:"modal-addlayer",role:"dialog"}},[r("div",{staticClass:"modal-dialog"},[r("div",{staticClass:"modal-content"},[r("div",{staticClass:"modal-header"},[r("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal"}},[e._v("")]),e._v(" "),r("h4",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.header",expression:"'mapcontrols.add_layer_control.header'"}],staticClass:"modal-title",staticStyle:{"font-weight":"bold"}})]),e._v(" "),r("div",{staticClass:"modal-body"},[r("div",{staticClass:"form-group"},[r("label",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.select_projection",expression:"'mapcontrols.add_layer_control.select_projection'"}],attrs:{"for":"projection-layer"}}),e._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.layer.crs,expression:"layer.crs"}],staticClass:"form-control",attrs:{id:"projection-layer"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.layer,"crs",t.target.multiple?r:r[0])}}},e._l(e.options,function(t){return r("option",{domProps:{value:t}},[e._v(e._s(t))])}),0)]),e._v(" "),r("layerspositions",{on:{"layer-position-change":function(t){return e.setLayerMapPosition(t)}}}),e._v(" "),r("p",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.select_color",expression:"'mapcontrols.add_layer_control.select_color'"}],staticStyle:{"font-weight":"700"}}),e._v(" "),r("chrome-picker",{staticStyle:{width:"100%",margin:"auto"},on:{"change-color":e.onChangeColor},model:{value:e.layer.color,callback:function(t){e.$set(e.layer,"color",t)},expression:"layer.color"}}),e._v(" "),r("bar-loader",{attrs:{loading:e.loading}}),e._v(" "),r("form",{attrs:{id:"addcustomlayer"}},[r("input",{ref:"input_file",attrs:{type:"file",title:" ",accept:e.accepted_extension},on:{change:function(t){return e.onAddLayer(t)}}}),e._v(" "),r("h4",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.drag_layer",expression:"'mapcontrols.add_layer_control.drag_layer'"}]}),e._v(" "),e.layer.name?r("h4",{staticClass:"skin-color",staticStyle:{"font-weight":"bold"}},[e._v(e._s(e.layer.name))]):e._e(),e._v(" "),r("div",[r("i",{
staticClass:"fa-5x","class":e.g3wtemplate.getFontClass("cloud-upload"),attrs:{"aria-hidden":"true"}})]),e._v(" "),r("p",{staticStyle:{"font-weight":"bold"}},[e._v("[.gml, .geojson, .kml, .kmz ,.gpx, .csv, .zip(shapefile)]")])]),e._v(" "),e.csv_extension?r("div",{staticStyle:{padding:"15px",border:"1px solid grey","border-radius":"3px"}},[r("bar-loader",{attrs:{loading:e.csv.loading}}),e._v(" "),r("div",{staticClass:"select_field"},[r("label",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.select_csv_separator",expression:"'mapcontrols.add_layer_control.select_csv_separator'"}],attrs:{"for":"g3w-select-field-layer"}}),e._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.csv.separator,expression:"csv.separator"}],staticClass:"form-control",attrs:{id:"g3w-select-separator"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.csv,"separator",t.target.multiple?r:r[0])}}},e._l(e.csv.separators,function(t){return r("option",{key:t,domProps:{value:t}},[e._v(e._s(t))])}),0),e._v(" "),r("div",{staticClass:"select_field","class":{"g3w-disabled":!e.csv.headers||0===e.csv.headers.length}},[r("label",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.select_csv_x_field",expression:"'mapcontrols.add_layer_control.select_csv_x_field'"}],attrs:{"for":"g3w-select-x-field"}}),e._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.csv.x,expression:"csv.x"}],staticClass:"form-control",attrs:{id:"g3w-select-x-field"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.csv,"x",t.target.multiple?r:r[0])}}},e._l(e.csv.headers,function(t){return r("option",{key:t,domProps:{value:t}},[e._v(e._s(t))])}),0)]),e._v(" "),r("div",{staticClass:"select_field","class":{"g3w-disabled":!e.csv.headers||0===e.csv.headers.length}},[r("label",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.select_csv_y_field",expression:"'mapcontrols.add_layer_control.select_csv_y_field'"}],attrs:{"for":"g3w-select-y-field"}}),e._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.csv.y,expression:"csv.y"}],staticClass:"form-control",attrs:{id:"g3w-select-y-field"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.csv,"y",t.target.multiple?r:r[0])}}},e._l(e.csv.headers,function(t){return r("option",{key:t,domProps:{value:t}},[e._v(e._s(t))])}),0)])])],1):e._e(),e._v(" "),r("div",{staticClass:"select_field","class":{"g3w-disabled":!e.fields||0===e.fields.length}},[r("label",{directives:[{name:"t",rawName:"v-t",value:"mapcontrols.add_layer_control.select_field_to_show",expression:"'mapcontrols.add_layer_control.select_field_to_show'"}],attrs:{"for":"g3w-select-field-layer"}}),e._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.field,expression:"field"}],staticClass:"form-control",attrs:{id:"g3w-select-field-layer"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.field=t.target.multiple?r:r[0]}}},[r("option",{domProps:{value:null}},[e._v("---")]),e._v(" "),e._l(e.fields,function(t){return r("option",{key:t,domProps:{value:t}},[e._v(e._s(t))])})],2)]),e._v(" "),e.error?r("div",{directives:[{name:"t",rawName:"v-t",value:e.error_message,expression:"error_message"}],staticStyle:{"font-weight":"bold","font-size":"1.2em","background-color":"orange",padding:"10px","text-align":"center"}}):e._e(),e._v(" "),r("div",{staticClass:"modal-footer"},[r("button",{directives:[{name:"t",rawName:"v-t",value:"add",expression:"'add'"}],staticClass:"btn btn-success pull-left",attrs:{type:"button",disabled:!e.add},on:{click:e.addLayer}}),e._v(" "),r("button",{directives:[{name:"t",rawName:"v-t",value:"close",expression:"'close'"}],staticClass:"btn btn-default",attrs:{type:"button","data-dismiss":"modal"}})])],1)])])])},n.staticRenderFns=[]},{"app/constant":5,"core/utils/geo":89}],292:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("./MapFooterRight.vue"),i=t(n),a=e("./MapFooterLeft.vue"),o=t(a);r["default"]={name:"Mapfooter",props:{service:{type:Object}},components:{MapFooterRight:i["default"],MapFooterLeft:o["default"]}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"skin-border-color",attrs:{id:"map_footer"}},[r("map-footer-left"),e._v(" "),r("map-footer-right",{attrs:{service:e.service}})],1)},n.staticRenderFns=[]},{"./MapFooterLeft.vue":293,"./MapFooterRight.vue":294}],293:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"Mapfooter"}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement;e._self._c||t;return e._m(0)},n.staticRenderFns=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{display:"flex"},attrs:{id:"map_footer_left"}},[r("a",{staticStyle:{"margin-left":"5px","align-self":"center"},attrs:{href:"https://g3wsuite.it/",target:"_blank"}},[r("img",{attrs:{height:"15",src:"/static/client/images/g3wsuite_logo.png",alt:""}})])])}]},{}],294:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/applicationstate"),a=t(i);r["default"]={name:"Mapfooter",props:{service:{type:Object}},data:function(){return{mouse:{switch_icon:!1,epsg_4326:!1,tooltip:null},mapunit:a["default"].map.unit}},computed:{showmapunits:function(){return this.service.state.mapunits.length>1}},methods:{createCopyMapExtentUrl:function(){this.service.createCopyMapExtentUrl()},switchMapsCoordinateTo4326:function(){this.mouse.epsg_4326=!this.mouse.epsg_4326}},watch:{mapunit:function(e){a["default"].map.unit=e,this.service.changeScaleLineUnit(e)}},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.service.once("ready",function(){e.mouse.switch_icon="EPSG:4326"!==e.service.getEpsg(),e.mouse.tooltip="ESPG "+e.service.getCrs().split(":")[1]+" <--> WGS84"});case 1:case"end":return t.stop()}},r,this)}));return e}()}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{display:"flex"},attrs:{id:"map_footer_right"}},[r("div",{attrs:{id:"scale-control"}}),e._v(" "),e.mouse.switch_icon&&!e.isMobile()?r("div",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top.create",value:e.mouse.tooltip,expression:"mouse.tooltip",arg:"top",modifiers:{create:!0}}],attrs:{id:"switch-mouse-coordinate"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.switchMapsCoordinateTo4326(t)}}},[r("span",{staticClass:"skin-color hide-cursor-caret-color","class":e.g3wtemplate.getFontClass("mouse")})]):e._e(),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:!e.mouse.epsg_4326,expression:"!mouse.epsg_4326"}],attrs:{id:"mouse-position-control"}}),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.mouse.epsg_4326,expression:"mouse.epsg_4326"}],attrs:{id:"mouse-position-control-epsg-4326"}}),e._v(" "),e.showmapunits?r("div",{attrs:{id:"scale-line-units"}},[r("select",{directives:[{name:"model",rawName:"v-model",value:e.mapunit,expression:"mapunit"}],staticClass:"skin-color",staticStyle:{padding:"5px 2px","font-weight":"bold",border:"0",cursor:"pointer"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.mapunit=t.target.multiple?r:r[0]}}},e._l(e.service.state.mapunits,function(t){return r("option",{directives:[{name:"t",rawName:"v-t",value:"sdk.mapcontrols.scaleline.units."+t,expression:"`sdk.mapcontrols.scaleline.units.${unit}`"}],staticStyle:{"font-weight":"bold"},domProps:{value:t,selected:e.mapunit===t}})}),0)]):e._e(),e._v(" "),r("div",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top.create",value:"sdk.tooltips.copy_map_extent_url",expression:"'sdk.tooltips.copy_map_extent_url'",arg:"top",modifiers:{create:!0}}],staticStyle:{"background-color":"#eeeeee"},attrs:{id:"permalink"}},[r("span",{staticClass:"skin-color","class":e.g3wtemplate.getFontClass("link"),on:{click:function(t){return t.stopPropagation(),e.createCopyMapExtentUrl(t)}}})])])},n.staticRenderFns=[]},{"core/applicationstate":8}],295:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={data:function(){return{state:null}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div")},n.staticRenderFns=[]},{}],296:[function(e,t,r){e("vueify/lib/insert-css").insert('.layer_header[data-v-409d907d]{padding:5px;margin-bottom:0;margin-top:0;cursor:pointer}.layer-name[data-v-409d907d]{font-weight:700}.layer-header-icon[data-v-409d907d]{margin-right:10px;color:#999}.layer_header span.open-close[data-v-409d907d]{position:absolute;right:5px;color:#999}.metadata-label[data-v-409d907d]{font-weight:700;font-size:1.1em}.row[data-v-409d907d]{padding:10px;border-bottom:1px solid #e2e2e2}.nav-tabs[data-v-409d907d]{border-bottom:0 solid #ddd}.nav-tabs>li.active>a[data-v-409d907d],.nav-tabs>li.active>a[data-v-409d907d]:focus,.nav-tabs>li.active>a[data-v-409d907d]:hover{border-width:0}.nav-tabs>li>a[data-v-409d907d]{border:none;color:#aeaeae}.nav-tabs>li.active>a[data-v-409d907d],.nav-tabs>li>a[data-v-409d907d]:hover{border:none;background:transparent}.nav-tabs>li>a[data-v-409d907d]:after{content:"";height:2px;position:absolute;width:100%;left:0;bottom:-1px;transition:all .25s ease 0s;transform:scale(0)}.nav-tabs>li.active>a[data-v-409d907d]:after,.nav-tabs>li:hover>a[data-v-409d907d]:after{transform:scale(1)}.tab-nav>li>a[data-v-409d907d]:after{background:#21527d none repeat scroll 0 0;color:#fff}.tab-content[data-v-409d907d]{margin:10px;background-color:#eee;overflow:auto}.spatial-tab[data-v-409d907d]{font-weight:700}');!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("gui/metadata/vue/components/metadatamixin"),i=t(n);r["default"]={name:"layer",mixins:[i["default"]],props:{state:{}},data:function(){return{show:!1}},computed:{isSpatial:function(){return"NoGeometry"!=this.state.geometrytype}},methods:{showHideInfo:function(){this.show=!this.show}},mounted:function(){}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"row-info"},[r("h4",{staticClass:"layer_header",attrs:{"data-toggle":"collapse","data-target":"#"+e.state.id},on:{click:e.showHideInfo}},[r("i",{staticClass:"layer-header-icon action-button nohover","class":[e.isSpatial?e.g3wtemplate.font.map:e.g3wtemplate.font.table],attrs:{"aria-hidden":"true"}}),e._v(" "),r("span",{staticClass:"layer-name"},[e._v(e._s(e.state.name))]),e._v(" "),r("span",{staticClass:"action-button nohover open-close","class":[e.show?e.g3wtemplate.getFontClass("minus"):e.g3wtemplate.getFontClass("plus")]})]),e._v(" "),r("div",{staticClass:"collapse",attrs:{id:e.state.id}},[r("ul",{staticClass:"metadata-nav-tabs nav nav-tabs",attrs:{role:"tablist"}},[r("li",{staticClass:"active spatial-tab",attrs:{role:"presentation"}},[r("a",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.groups.general",expression:"'sdk.metadata.groups.layers.groups.general'"}],attrs:{href:"#layer_general_"+e.state.id,"aria-controls":"general",role:"tab","data-toggle":"tab"}})]),e._v(" "),e.isSpatial?r("li",{staticClass:"spatial-tab",attrs:{role:"presentation"}},[r("a",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.groups.spatial",expression:"'sdk.metadata.groups.layers.groups.spatial'"}],attrs:{href:"#layer_spatial_"+e.state.id,"aria-controls":"profile",role:"tab","data-toggle":"tab"}})]):e._e()]),e._v(" "),r("div",{staticClass:"tab-content"},[r("div",{staticClass:"tab-pane active",attrs:{role:"tabpanel",id:"layer_general_"+e.state.id}},[r("div",{staticClass:"container-fluid"},[e.findAttributeFormMetadataAttribute("title")?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.title",expression:"'sdk.metadata.groups.layers.fields.subfields.title'"}],staticClass:"col-md-2 col-sm-12 metadata-label"}),e._v(" "),r("div",{staticClass:"col-md-10 col-sm-12 value"},[e._v(e._s(e.state.metadata.title))])]):e._e(),e._v(" "),e.findMetadataAttribute("name")?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.name",expression:"'sdk.metadata.groups.layers.fields.subfields.name'"}],staticClass:"col-md-2 col-sm-12 metadata-label"}),e._v(" "),r("div",{staticClass:"col-md-10 col-sm-12 value"},[e._v(e._s(e.state.name))])]):e._e(),e._v(" "),e.findMetadataAttribute("source")?r("div",{staticClass:"row metadata-layer-source"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.source",expression:"'sdk.metadata.groups.layers.fields.subfields.source'"}],staticClass:"col-md-2 col-sm-12 metadata-label metadata-layer-source-value-key"}),e._v(" "),r("div",{staticClass:"col-md-10 col-sm-12 value metadata-layer-source-value"},[e._v(e._s(e.state.source.type))])]):e._e(),e._v(" "),e.findAttributeFormMetadataAttribute("abstract")?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.abstract",expression:"'sdk.metadata.groups.layers.fields.subfields.abstract'"}],staticClass:"col-md-2 col-sm-12 metadata-label"}),e._v(" "),r("div",{staticClass:"col-md-10 col-sm-12 value",domProps:{innerHTML:e._s(e.state.metadata["abstract"])}})]):e._e(),e._v(" "),e.findAttributeFormMetadataAttribute("keywords")?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.keywords",expression:"'sdk.metadata.groups.layers.fields.subfields.keywords'"}],staticClass:"col-md-2 col-sm-12 metadata-label"}),e._v(" "),r("div",{staticClass:"col-md-10 col-sm-12 value"},[r("div",[e._v(e._s(e.state.metadata.keywords.join(", ")))])])]):e._e(),e._v(" "),e.findAttributeFormMetadataAttribute("metadataurl")&&e.state.metadata.metadataurl.onlineresources?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.metadataurl",expression:"'sdk.metadata.groups.layers.fields.subfields.metadataurl'"}],staticClass:"col-md-2 col-sm-12 metadata-label"}),e._v(" "),r("div",{staticClass:"col-md-10 col-sm-12 value"},[r("a",{attrs:{href:e.state.metadata.metadataurl.onlineresources}},[e._v(e._s(e.state.metadata.metadataurl.onlineresources))])])]):e._e(),e._v(" "),e.findAttributeFormMetadataAttribute("dataurl")&&e.state.metadata.dataurl.onlineresources?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.dataurl",expression:"'sdk.metadata.groups.layers.fields.subfields.dataurl'"}],staticClass:"col-md-2 col-sm-12 metadata-label"}),e._v(" "),r("div",{staticClass:"col-md-10 col-sm-12 value"},[r("a",{attrs:{href:e.state.metadata.dataurl.onlineresources}},[e._v(e._s(e.state.metadata.dataurl.onlineresources))])])]):e._e(),e._v(" "),e.findAttributeFormMetadataAttribute("attributes")?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.attributes",expression:"'sdk.metadata.groups.layers.fields.subfields.attributes'"}],staticClass:"col-md-2 col-sm-12 metadata-label"}),e._v(" "),r("div",{staticClass:"col-md-10 col-sm-12 value",staticStyle:{overflow:"auto"}},[r("table",{staticClass:"table table-striped",staticStyle:{"background-color":"#eeeeee !important"}},[r("thead",[r("tr",e._l(e.state.metadata.attributes[0],function(t,n){return r("th",[e._v(e._s(n))])}),0)]),e._v(" "),r("tbody",e._l(e.state.metadata.attributes,function(t){return r("tr",e._l(t,function(t,n){return r("td",[e._v(e._s(t))])}),0)}),0)])])]):e._e()])]),e._v(" "),r("div",{staticClass:"tab-pane",attrs:{role:"tabpanel",id:"layer_spatial_"+e.state.id}},[r("div",{staticClass:"container-fluid"},[e.findMetadataAttribute("crs")?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.crs",expression:"'sdk.metadata.groups.layers.fields.subfields.crs'"}],staticClass:"col-sm-2 metadata-label"}),e._v(" "),r("div",{staticClass:"col-sm-10 value"},[e._v(e._s(e.state.crs.epsg))])]):e._e(),e._v(" "),e.findMetadataAttribute("geometrytype")?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.geometrytype",expression:"'sdk.metadata.groups.layers.fields.subfields.geometrytype'"}],staticClass:"col-sm-2 metadata-label"}),e._v(" "),r("div",{staticClass:"col-sm-10 value"},[e._v(e._s(e.state.geometrytype))])]):e._e(),e._v(" "),e.findMetadataAttribute("bbox")?r("div",{staticClass:"row"},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.fields.subfields.bbox",expression:"'sdk.metadata.groups.layers.fields.subfields.bbox'"}],staticClass:"col-sm-2 metadata-label"}),e._v(" "),r("div",{staticClass:"col-sm-10 value"},e._l(e.state.bbox,function(t,n){return r("p",[r("span",{staticStyle:{"font-weight":"bold","margin-right":"5px"}},[e._v(e._s(n))]),e._v(" "),r("span",[e._v(e._s(t))])])}),0)]):e._e(),e._v(" "),e.findAttributeFormMetadataAttribute("crs")?r("div",{staticClass:"row"},[r("div",{staticClass:"col-sm-2 metadata-label"},[e._v("CRS")]),e._v(" "),r("div",{staticClass:"col-sm-10 value"},e._l(e.state.metadata.crs,function(t){return r("div",[r("span",[e._v(e._s(t))])])}),0)]):e._e()])])])])])},n.staticRenderFns=[],n._scopeId="data-v-409d907d"},{"gui/metadata/vue/components/metadatamixin":189,"vueify/lib/insert-css":2}],297:[function(e,t,r){e("vueify/lib/insert-css").insert(".metadata-nav-bar li a[data-v-032bed45]{text-align:center}.metadata-nav-bar li a i[data-v-032bed45]{margin-right:5px}.metadata-item-tab[data-v-032bed45]{margin-right:10px;border-radius:3px;margin-bottom:10px}.metadata-body[data-v-032bed45]{overflow-y:auto;overflow-x:hidden;padding-left:0;padding-right:0}.tab-title[data-v-032bed45]{position:absolute;bottom:10px;right:auto}.row-info[data-v-032bed45]{margin:0!important;padding-top:10px;padding-bottom:10px;border-bottom:1px solid #eee}.row-info .label[data-v-032bed45]{font-weight:700}.h_90[data-v-032bed45]{height:90%}.h_100[data-v-032bed45]{height:100%}#project-catalog[data-v-032bed45]{position:relative;overflow:auto}.nav-tabs-wrapper[data-v-032bed45]{display:inline-block;margin-bottom:-6px;margin-left:1.25%;margin-right:1.25%;position:relative;width:100%}.nav-tabs[data-v-032bed45]{border-bottom:0 none}.nav-stacked[data-v-032bed45]{font-size:1.2em;font-weight:700;padding:10px 0}.nav-stacked li a[data-v-032bed45]{color:#fff}.left-vertical-tabs[data-v-032bed45]{padding-left:0!important}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("components/MetadataLayer.vue"),a=t(i),o=e("components/MetadataProjectTabContent.vue"),s=t(o),l=e("components/MetadataProjectBBoxContent.vue"),u=t(l),c=e("components/MetadataProjectContactsContent.vue"),d=t(c);r["default"]={name:"project",data:function(){return{state:this.$options.state,iconsClass:{info:this.g3wtemplate.getFontClass("info-circle"),globe:this.g3wtemplate.getFontClass("globe"),bars:this.g3wtemplate.getFontClass("bars")}}},components:{"metadata-layer":a["default"],"metadata-tab-content":s["default"],"metadata-bbox-content":u["default"],"metadata-contacts-content":d["default"]},methods:{isArrayorObject:function(e){return Array.isArray(e)||"object"===("undefined"==typeof e?"undefined":n(e))},setComponent:function(e){var t=void 0;switch(e){case"extent":t="metadata-bbox-content";break;case"contactinformation":t="metadata-contacts-content";break;default:t="metadata-tab-content"}return t}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"project-catalog"}},[r("div",{"class":e.isMobile()?"mobile":null,staticStyle:{padding:"0"},attrs:{id:"project-catalog-container"}},[r("ul",{staticClass:"nav nav-tabs metadata-nav-bar",attrs:{role:"tablist"}},[r("li",{staticClass:"active"},[r("a",{staticClass:"metadata-item-tab general",attrs:{"data-toggle":"tab",href:"#general"}},[r("i",{staticClass:"action-button nohover","class":e.g3wtemplate.getFontClass("info"),attrs:{"aria-hidden":"true"}}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.general.title",expression:"'sdk.metadata.groups.general.title'"}],staticStyle:{"font-weight":"bold"}})])]),e._v(" "),r("li",[r("a",{staticClass:"metadata-item-tab spatial",attrs:{"data-toggle":"tab",href:"#spatial"}},[r("i",{staticClass:"action-button nohover","class":e.iconsClass.globe,attrs:{"aria-hidden":"true"}}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.spatial.title",expression:"'sdk.metadata.groups.spatial.title'"}],staticStyle:{"font-weight":"bold"}})])]),e._v(" "),r("li",[r("a",{staticClass:"metadata-item-tab layers",attrs:{"data-toggle":"tab",href:"#metadata_layers"}},[r("i",{staticClass:"action-button nohover","class":e.iconsClass.bars,attrs:{"aria-hidden":"true"}}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.layers.title",expression:"'sdk.metadata.groups.layers.title'"}],staticStyle:{"font-weight":"bold"}})])])])]),e._v(" "),r("div",{staticClass:"col-sm-12 metadata-body tab-content"},[r("div",{staticClass:"tab-pane fade in active",attrs:{id:"general"}},[e._l(e.state.groups.general,function(t,n){return r("div",{staticClass:"row h_100 row-info"},[r(e.setComponent(n),{tag:"component",attrs:{data:t,fieldName:n}})],1)})],2),e._v(" "),r("div",{staticClass:"tab-pane fade",attrs:{id:"spatial"}},[r("div",[e._l(e.state.groups.spatial,function(t,n){return r("div",{staticClass:"row row-info"},[r(e.setComponent(n),{tag:"component",attrs:{data:t,fieldName:n}})],1)})],2)]),e._v(" "),r("div",{staticClass:"tab-pane fade",attrs:{id:"metadata_layers"}},e._l(e.state.groups.layers.layers.value,function(e){return r("metadata-layer",{attrs:{state:e}})}),1)])])},n.staticRenderFns=[],n._scopeId="data-v-032bed45"},{"components/MetadataLayer.vue":296,"components/MetadataProjectBBoxContent.vue":298,"components/MetadataProjectContactsContent.vue":299,"components/MetadataProjectTabContent.vue":300,"vueify/lib/insert-css":2}],298:[function(e,t,r){e("vueify/lib/insert-css").insert(".metadata-label[data-v-4f6ab04a]{font-weight:700;font-size:1.1em}.bbox-labels[data-v-4f6ab04a]{font-weight:700}");!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"metadatabbox",props:{data:{}},data:function(){return{bboxlabels:["MINX","MINY","MAXX","MAXY"]}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"wrap-content-tab"},[r("div",{directives:[{name:"t",rawName:"v-t",value:e.data.label,expression:"data.label"}],staticClass:"col-sm-2 metadata-label"}),e._v(" "),r("div",{staticClass:"col-sm-10 value",staticStyle:{"margin-top":"0"}},e._l(e.data.value,function(t,n){return r("div",[r("span",{staticClass:"bbox-labels"},[e._v(e._s(e.bboxlabels[n]))]),e._v(" "+e._s(t)+"\n      ")])}),0)])},n.staticRenderFns=[],n._scopeId="data-v-4f6ab04a"},{"vueify/lib/insert-css":2}],299:[function(e,t,r){e("vueify/lib/insert-css").insert(".metadata-label[data-v-734c25d1]{font-weight:700;font-size:1.1em}.metadata-contact-label[data-v-734c25d1]{font-weight:700}.contact-icon[data-v-734c25d1]{margin-right:3px}.row[data-v-734c25d1]{margin-bottom:5px}");!function(){Object.defineProperty(r,"__esModule",{value:!0});var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r["default"]={name:"metadatacontatcs",props:{data:{}},data:function(){return{iconsClass:{contactelectronicmailaddress:this.g3wtemplate.getFontClass("mail"),personprimary:this.g3wtemplate.getFontClass("user"),contactvoicetelephone:this.g3wtemplate.getFontClass("mobile")}}},methods:{sanitizeValue:function(t){return null!==t&&void 0!==t&&("object"===("undefined"==typeof t?"undefined":e(t))?t=Object.keys(t).length?t:"":Array.isArray(t)&&(t=t.length?t:"")),t},geti18n:function(e){}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"wrap-content-tab"},[r("div",{directives:[{name:"t",rawName:"v-t",value:e.data.label,expression:"data.label"}],staticClass:"col-sm-2 metadata-label"}),e._v(" "),r("div",{staticClass:"col-sm-10 value",staticStyle:{"margin-top":"0"}},e._l(e.data.value,function(t,n){return r("div",[r("div",{staticClass:"row"},[r("div",{staticClass:"col-sm-2 metadata-contact-label"},[r("i",{staticClass:"contact-icon","class":e.iconsClass[n],attrs:{"aria-hidden":"true"}}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.general.fields.subfields.contactinformation."+n,expression:"'sdk.metadata.groups.general.fields.subfields.contactinformation.' + key"}]})]),e._v(" "),r("div",{staticClass:"col-sm-10"},["personprimary"===n?e._l(t,function(t,n){return r("div",[r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.metadata.groups.general.fields.subfields.contactinformation."+n,expression:"'sdk.metadata.groups.general.fields.subfields.contactinformation.' + key"}],staticClass:"metadata-contact-label"}),e._v(" "),r("span",[e._v(e._s(t))])])}):r("div",["contactelectronicmailaddress"===n?[r("a",{staticStyle:{"font-weight":"bold"},attrs:{href:"mailto:"+e.sanitizeValue(t)}},[e._v(e._s(e.sanitizeValue(t)))])]:[e._v("\n              "+e._s(e.sanitizeValue(t))+"\n            ")]],2)],2)])])}),0)])},n.staticRenderFns=[],n._scopeId="data-v-734c25d1"},{"vueify/lib/insert-css":2}],300:[function(e,t,r){e("vueify/lib/insert-css").insert(".metadata-label[data-v-16751e49]{font-weight:700;font-size:1.1em}");!function(){Object.defineProperty(r,"__esModule",{value:!0});var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r["default"]={name:"metadatatabcontent",props:{data:{},fieldName:{}},computed:{arrayToString:function(){return this.data.value.join(", ")}},methods:{isArrayorObject:function(t){return Array.isArray(t)||"object"===("undefined"==typeof t?"undefined":e(t))}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"wrap-content-tab"},[r("div",{directives:[{name:"t",rawName:"v-t",value:e.data.label,expression:"data.label"}],staticClass:"col-sm-2 metadata-label"}),e._v(" "),"keywords"==e.fieldName?r("div",{staticClass:"col-sm-10 value"},[e._v("\n    "+e._s(e.arrayToString)+"\n  ")]):"wms_url"==e.fieldName?r("div",{staticClass:"col-sm-10 value",staticStyle:{"margin-top":"0"}},[r("span",[e._v(e._s(e.data.value))])]):e.isArrayorObject(e.data.value)?"abstract"==e.fieldName?r("div",{staticClass:"col-sm-10 value",staticStyle:{"margin-top":"0"}},[r("span",{domProps:{innerHTML:e._s(e.data.value)}})]):r("div",{staticClass:"col-sm-10 value",staticStyle:{"margin-top":"0"}},e._l(e.data.value,function(t,n){return r("div",[r("span",[e._v(e._s(t))])])}),0):r("div",{staticClass:"col-sm-10 value",staticStyle:{"margin-top":"0"}},[r("span",{domProps:{innerHTML:e._s(e.data.value)}})])])},n.staticRenderFns=[],n._scopeId="data-v-16751e49"},{"vueify/lib/insert-css":2}],301:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("services/navbaritems"),i=t(n);r["default"]={name:"NavbaritemLeft",data:function(){return{items:i["default"].state.items.right}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ul",{staticClass:"nav navbar-nav navbar-left"},e._l(e.items,function(e){return r(e,{key:e.id,tag:"li"})}),1)},n.staticRenderFns=[],n._scopeId="data-v-214afbb2"},{"services/navbaritems":393}],302:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("services/navbaritems"),i=t(n);r["default"]={name:"NavbaritemRight",data:function(){return{items:i["default"].state.items.right}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ul",{staticClass:"nav navbar-nav navbar-right"},e._l(e.items,function(e){return r(e,{key:e.id,tag:"li"})}),1)},n.staticRenderFns=[],n._scopeId="data-v-45599481"},{"services/navbaritems":393}],303:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"download-notify"}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"download",rawName:"v-download.show",modifiers:{show:!0}}],staticClass:"skin-color",attrs:{id:"download_notification",title:"DOWNLOAD"}},[r("bar-loader",{attrs:{loading:"true"}}),e._v(" "),r("i",{"class":e.g3wtemplate.getFontClass("download"),staticStyle:{padding:"3px"}})],1)},n.staticRenderFns=[]},{}],304:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"online-notify"}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{
name:"online",rawName:"v-online:hide",arg:"hide"}],staticStyle:{color:"#999"},attrs:{id:"offline_notification"}},[r("i",{"class":e.g3wtemplate.getFontClass("wifi")}),e._v(" "),r("div",{staticStyle:{"font-weight":"bold","font-size":"0.4em"}},[e._v("offline")])])},n.staticRenderFns=[]},{}],305:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"plugins-notify"}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"plugins",rawName:"v-plugins"}],staticStyle:{color:"#994b10"},attrs:{id:"plugins_notification"}},[r("bar-loader",{attrs:{loading:"true"}}),e._v(" "),r("i",{"class":e.g3wtemplate.getFontClass("plugin")})],1)},n.staticRenderFns=[]},{}],306:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("components/PrintSelectAtlasFieldValues.vue"),i=t(n),a=e("components/PrintFidAtlasValues.vue"),o=t(a);r["default"]={data:function(){return{state:null,button:{"class":"btn-success",type:"stampa",disabled:!1}}},components:{SelectAtlasFieldValues:i["default"],FidAtlasValues:o["default"]},computed:{disabled:function(){return this.state.output.loading||!!this.state.atlas&&0===this.state.atlasValues.length}},methods:{setDisabledPrintButton:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.button.disabled=e},setAtlasValues:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.state.atlasValues=e},onChangeTemplate:function(){this.$options.service.changeTemplate()},onChangeScale:function(){this.$options.service.changeScale()},onChangeFormat:function(){},onChangeDpi:function(){},onChangeRotation:function(e){this.state.rotation>=0&&!_.isNil(this.state.rotation)&&""!=this.state.rotation?(this.state.rotation=this.state.rotation>360?360:this.state.rotation,e.target.value=this.state.rotation):this.state.rotation<0?(this.state.rotation=this.state.rotation<-360?-360:this.state.rotation,e.target.value=this.state.rotation):this.state.rotation=0,this.$options.service.changeRotation()},print:function(){this.$options.service.print()}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ul",{staticClass:"treeview-menu",attrs:{id:"print"}},[r("li",[r("form",{staticClass:"g3w-search-form form-horizonal"},[r("div",{staticClass:"box-body"},[r("transition",{attrs:{duration:500,name:"fade"}},[r("bar-loader",{attrs:{loading:e.state.loading}})],1),e._v(" "),r("helpdiv",{attrs:{message:"sdk.print.help"}}),e._v(" "),r("label",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.template",expression:"'sdk.print.template'"}],attrs:{"for":"templates"}}),e._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.state.template,expression:"state.template"}],staticClass:"form-control",style:{marginBottom:this.state.atlas&&"10px"},attrs:{id:"templates"},on:{change:[function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.state,"template",t.target.multiple?r:r[0])},e.onChangeTemplate]}},e._l(e.state.print,function(t){return r("option",{domProps:{value:t.name}},[e._v(e._s(t.name))])}),0),e._v(" "),e.state.atlas?e.state.atlas.field_name?[r("select-atlas-field-values",{attrs:{atlas:e.state.atlas,reset:!e.state.isShow},on:{"disable-print-button":e.setDisabledPrintButton,"set-values":e.setAtlasValues}})]:[r("fid-atlas-values",{attrs:{atlas:e.state.atlas,reset:!e.state.isShow},on:{"disable-print-button":e.setDisabledPrintButton,"set-values":e.setAtlasValues}})]:[r("label",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.scale",expression:"'sdk.print.scale'"}],attrs:{"for":"scala"}}),e._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.state.scala,expression:"state.scala"}],staticClass:"form-control",attrs:{id:"scala"},on:{change:[function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.state,"scala",t.target.multiple?r:r[0])},e.onChangeScale]}},e._l(e.state.scale,function(t){return r("option",{domProps:{value:t.value}},[e._v(e._s(t.label))])}),0),e._v(" "),r("label",{attrs:{"for":"dpi"}},[e._v("dpi")]),e._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.state.dpi,expression:"state.dpi"}],staticClass:"form-control",attrs:{id:"dpi"},on:{change:[function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.state,"dpi",t.target.multiple?r:r[0])},e.onChangeDpi]}},e._l(e.state.dpis,function(t){return r("option",[e._v(e._s(t))])}),0),e._v(" "),r("label",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.rotation",expression:"'sdk.print.rotation'"}],attrs:{"for":"rotation"}}),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.state.rotation,expression:"state.rotation"}],staticClass:"form-control",attrs:{min:"-360",max:"360",id:"rotation",type:"number"},domProps:{value:e.state.rotation},on:{input:[function(t){t.target.composing||e.$set(e.state,"rotation",t.target.value)},e.onChangeRotation]}}),e._v(" "),r("label",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.format",expression:"'sdk.print.format'"}],attrs:{"for":"format"}}),e._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.state.output.format,expression:"state.output.format"}],staticClass:"form-control",attrs:{id:"format"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.state.output,"format",t.target.multiple?r:r[0])}}},e._l(e.state.formats,function(t){return r("option",{domProps:{value:t.value}},[e._v(e._s(t.label))])}),0)],e._v(" "),e.state.labels&&e.state.labels.length?[r("div",{staticClass:"print-labels-content",staticStyle:{"margin-top":"5px"}},[r("label",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.labels",expression:"'sdk.print.labels'"}],staticClass:"skin-color",staticStyle:{"font-weight":"bold","font-size":"1.1em",display:"block","border-bottom":"2px solid #ffffff","margin-bottom":"5px"}}),e._v(" "),r("div",{staticClass:"labels-input-content",staticStyle:{"max-height":"120px","overflow-y":"auto"}},e._l(e.state.labels,function(t){return r("span",{key:t.id},[r("label",{attrs:{"for":"g3w_label_id_input_"+t.id}},[e._v(e._s(t.id))]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"label.text"}],staticClass:"form-control",attrs:{id:"g3w_label_id_input_"+t.id},domProps:{value:t.text},on:{input:function(r){r.target.composing||e.$set(t,"text",r.target.value)}}})])}),0)])]:e._e()],2),e._v(" "),r("div",{staticClass:"box-footer",staticStyle:{"background-color":"transparent"}},[r("span",[r("button",{directives:[{name:"disabled",rawName:"v-disabled",value:e.button.disabled,expression:"button.disabled"},{name:"download",rawName:"v-download"},{name:"t",rawName:"v-t",value:"create_print",expression:"'create_print'"}],staticClass:"sidebar-button-run btn",staticStyle:{width:"100%","font-weight":"bold"},attrs:{id:"printbutton"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.print(t)}}})])])])])])},n.staticRenderFns=[]},{"components/PrintFidAtlasValues.vue":307,"components/PrintSelectAtlasFieldValues.vue":309}],307:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"fid-atlas-values",props:{atlas:{type:Object},reset:{type:Boolean,"default":!1}},data:function(){return{value:""}},methods:{validateValue:function(e){return e=e&&1*e,Number.isInteger(e)&&e>=0&&e<this.atlas.feature_count||null}},watch:{value:{immediate:!0,handler:function(e){var t=this;this.value=e;var r=new Set,n=function(e){return null!==t.validateValue(e)&&r.add(e)},i=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.length,n=1;n<t;n++)for(var i=e[n-1],a=e[n],o=i;o<a;o++)r.add(o+"");r.add(e[t-1])};e&&e.split(",").forEach(function(e){if(e)if(e.indexOf("-")!==-1){var r=e.split("-"),a=r.filter(function(e){return null!==t.validateValue(e)});if(a.length===r.length){var o=a.reduce(function(e,t,r){return e&&(0===r||a[r-1]<=t)},!0);o&&i(a)}}else n(e)}),this.$emit("set-values",Array.from(r)),this.$emit("disable-print-button",""===e.trim())}},reset:function(e){e&&(this.value="",this.$emit("set-values",[]),this.$emit("disable-print-button",!0))}},beforeDestroy:function(){this.value=null,this.$emit("disable-print-button",!1)}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"form-group",staticStyle:{width:"100%"}},[r("label",{staticStyle:{display:"block"},attrs:{"for":e.print_atlas_fid}},[r("span",[e._v("fids [max: "+e._s(e.atlas.feature_count-1)+"]")])]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],staticClass:"form-control",domProps:{value:e.value},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:void t.preventDefault()},input:function(t){t.target.composing||(e.value=t.target.value)}}}),e._v(" "),r("div",{staticStyle:{"margin-top":"5px",color:"#ffffff"},attrs:{id:"fid-print-atals-instruction"}},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.fids_instruction",expression:"'sdk.print.fids_instruction'"}],staticStyle:{"white-space":"pre-line"},attrs:{id:"fids_intruction"}}),e._v(" "),r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.fids_example",expression:"'sdk.print.fids_example'"}],staticStyle:{"margin-top":"3px","font-weight":"bold"},attrs:{id:"fids_examples_values"}})])])},n.staticRenderFns=[],n._scopeId="data-v-7c31f398"},{}],308:[function(e,t,r){!function(){function t(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("app/constant"),i=e("core/utils/utils"),a=i.imageToDataURL,o=e("gui/gui");r["default"]={data:function(){return{state:null,disableddownloadbutton:!0,downloadImageName:"",format:null}},computed:{loading:function(){return this.state.loading&&this.state.layers}},methods:{setLoading:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];o.disableSideBar(e),this.state.loading=e,this.disableddownloadbutton=e},downloadImage:function(){var e=this;this.setLoading(!0),"jpg"!==this.format&&"png"!==this.format||(this.downloadImageName="download."+this.state.format,a({src:this.state.url,type:"image/"+this.state.format,callback:function(t){return setTimeout(function(){return e.setLoading(!1)})}}))}},watch:{"state.url":function(){function e(e){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function i(e){var t,r=this;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!e){i.next=6;break}return this.format=this.state.format,i.next=4,this.$nextTick();case 4:t=setTimeout(function(){r.setLoading(!1),o.showUserMessage({type:"alert",message:"timeout"})},n.TIMEOUT),$(this.$refs.printoutput).load(e,function(e,n){r.$options.service.stopLoading(),"error"===n&&r.$options.service.showError(),clearTimeout(t),r.setLoading(!1)});case 6:case"end":return i.stop()}},i,this)}));return e}()},mounted:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.state.layers&&this.$options.service.startLoading();case 3:case"end":return e.stop()}},n,this)}));return e}(),beforeDestroy:function(){this.state.url&&"POST"===this.state.method&&window.URL.revokeObjectURL(this.state.url)}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{height:"100%",position:"relative"},attrs:{id:"print-output"}},[r("transition",{attrs:{duration:500,name:"fade"}},[r("bar-loader",{attrs:{loading:e.loading}})],1),e._v(" "),"pdf"===e.format?r("iframe",{ref:"printoutput",staticStyle:{border:"0",width:"100%",height:"100%"},attrs:{type:e.state.mime_type,src:e.state.url}}):"png"===e.format?r("div",{staticClass:"g3w-print-png-output",staticStyle:{display:"flex","flex-direction":"column",position:"relative",height:"100%"}},[r("div",{staticStyle:{display:"flex","justify-content":"flex-end","align-items":"flex-end","margin-top":"5px","margin-bottom":"5px"},attrs:{id:"g3w-print-header"}},[r("div",{"class":{"g3w-disabled":e.disableddownloadbutton}},[r("a",{attrs:{href:e.state.url,download:e.downloadImageName}},[r("button",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"sdk.print.download_image",expression:"'sdk.print.download_image'",modifiers:{create:!0}}],staticClass:"btn skin-button skin-tooltip-left","class":e.g3wtemplate.getFontClass("download"),staticStyle:{"font-weight":"bold"},attrs:{"data-placement":"left","data-toggle":"tooltip",role:"button"},on:{click:e.downloadImage}})])])]),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:"png"===e.format&&e.state.url,expression:"format==='png' && state.url"}],staticStyle:{height:"100%",width:"100%",position:"relative","overflow-y":"auto"}},[r("img",{ref:"printoutput",staticStyle:{height:"auto","max-width":"100%"},attrs:{src:e.state.url}})])]):e._e(),e._v(" "),e.state.layers?e._e():r("h4",{directives:[{name:"t",rawName:"v-t",value:"sdk.print.no_layers",expression:"'sdk.print.no_layers'"}],staticStyle:{"font-weight":"bold"}})],1)},n.staticRenderFns=[]},{"app/constant":5,"core/utils/utils":92,"gui/gui":150}],309:[function(e,t,r){!function(){function t(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=e("gui/external/select2/options/autocomplete"),a=e("gui/vue/vue.mixins"),o=a.autocompleteMixin,s=a.select2Mixin;r["default"]={name:"selectAtlasFieldValues",mixins:[o,s],props:{atlas:{type:Object,required:!0},reset:{type:Boolean,"default":!1}},methods:{emitValues:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.$emit("set-values",this.values);case 3:case"end":return e.stop()}},n,this)}));return e}()},data:function(){return{values:[]}},watch:{values:{immediate:!0,handler:function(e){this.$emit("disable-print-button",0===e.length)}},reset:function(e){e&&(this.select2&&this.select2.val(null).trigger("change"),this.values=[],this.emitValues())}},mounted:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function a(){var e,r,o,s=this;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.$nextTick();case 2:e=this.atlas,r=e.field_name,o=e.qgs_layer_id,setTimeout(function(){}),this.select2=$("#print_atlas_autocomplete").select2(n({width:"100%",multiple:!0,dropdownParent:$(this.$el),minimumInputLength:1,ajax:{delay:500,transport:function(){function e(e,t,r){return n.apply(this,arguments)}var n=t(regeneratorRuntime.mark(function i(e,t,n){var a,l=e.data.q;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.autocompleteRequest({layerId:o,field:r,value:l});case 3:a=e.sent,t({results:a}),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),n(e.t0);case 10:case"end":return e.stop()}},i,s,[[0,7]])}));return e}()}},i)),this.select2.on("select2:select",function(e){var t=e.params.data.id;s.values.push(t),s.emitValues()}),this.select2.on("select2:unselect",function(){var e=t(regeneratorRuntime.mark(function r(e){var t;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:t=e.params.data.id,s.values=s.values.filter(function(e){return e!==t}),s.emitValues();case 3:case"end":return r.stop()}},r,s)}));return function(t){return e.apply(this,arguments)}}());case 7:case"end":return a.stop()}},a,this)}));return e}(),beforeDestroy:function(){this.values=null,this.$emit("disable-print-button",!1)}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"form-group",staticStyle:{width:"100%"}},[r("label",{staticStyle:{display:"block"},attrs:{"for":e.print_atlas_autocomplete}},[r("span",[e._v(e._s(e.atlas.field_name))])]),e._v(" "),r("select",{staticClass:"form-control",attrs:{name:e.atlas.field_name,id:"print_atlas_autocomplete"}})])},n.staticRenderFns=[],n._scopeId="data-v-f0e3ed96"},{"gui/external/select2/options/autocomplete":144,"gui/vue/vue.mixins":227}],310:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("core/i18n/i18n.service").t,n=e("gui/gui"),i=e("core/project/projectsregistry"),a="/static/client/images/FakeProjectThumb.png";r["default"]={data:function(){return{state:null,loading:!1}},methods:{trigger:function(e){if(e.cbk){n.showFullModal({show:!0}),n.setLoadingContent(!0);var r=e.gid;e.cbk.call(e,{gid:r}).then(function(e){e.then(function(e){return document.title=e.state.html_page_title}).fail(function(){n.notify.error("<h4>"+t("error_map_loading")+"</h4><h5>"+t("check_internet_connection_or_server_admin")+"</h5>")}).always(function(){n.showFullModal({show:!1}),n.setLoadingContent(!1)})})}else e.href?window.open(e.href,"_blank"):e.route&&n["goto"](e.route)},logoSrc:function(e){var t=void 0;return t=e?e.indexOf(i.config.mediaurl)!==-1?e:e.indexOf("static")===-1&&e.indexOf("media")===-1?""+i.config.mediaurl+e:a:a,this.$options.host&&""+this.$options.host+t||t}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container",attrs:{id:"menu-projects"}},[r("div",{staticClass:"row row-equal"},[e._l(e.state.menuitems,function(t){return r("div",{key:t.title,staticClass:"col-xs-12 col-sm-4 project-menu",on:{click:function(r){return e.trigger(t)}}},[r("div",{staticClass:"project-menu-item-image"},[r("img",{staticClass:"img-responsive",attrs:{src:e.logoSrc(t.thumbnail)}})]),e._v(" "),r("div",{staticClass:"project-menu-item-content"},[r("div",{staticClass:"project-menu-item-text"},[r("h4",{staticClass:"project-menu-item-title"},[e._v(e._s(t.title))]),e._v(" "),r("div",{domProps:{innerHTML:e._s(t.description)}})])])])}),e._v(" "),e.state.menuitems.length?e._e():r("div",{staticStyle:{"margin-left":"15px"}},[r("h2",{directives:[{name:"t",rawName:"v-t",value:"no_other_projects",expression:"'no_other_projects'"}]})])],2)])},n.staticRenderFns=[]},{"core/i18n/i18n.service":27,"core/project/projectsregistry":83,"gui/gui":150}],311:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var a=e("gui/querybuilder/service"),o=t(a),s=e("core/layers/filter/operators"),l=e("core/project/projectsregistry"),u=Object.values(s.OPERATORS);r["default"]={data:function(){var e=this.$options.options,t=void 0!==e;return{edit:t,currentlayer:null,message:"",filter:t?e.filter:"",loading:{test:!1,values:!1},values:[],manual:!0,manualvalue:null,select:{field:null,value:null}}},computed:{fields:function(){return this.currentlayer?this.currentlayer.fields:[]},disabled:function(){return!this.filter}},watch:{"select.field":function(){this.values=[],this.manual=!0}},methods:{addToExpression:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.value,r=e.type;switch(r){case"operator":t=" "+t+" ";break;case"field":t='"'+t+'"';break;case"value":t="'"+t+"'"}t&&(this.filter=""+this.filter+t)},all:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading.values=!0,e.prev=1,e.next=4,o["default"].getValues({layerId:this.currentlayer.id,field:this.select.field});case 4:this.values=e.sent,e.next=9;break;case 7:e.prev=7,e.t0=e["catch"](1);case 9:return this.loading.values=!1,e.next=12,this.$nextTick();case 12:this.manualvalue=null,this.manual=!1;case 14:case"end":return e.stop()}},r,this,[[1,7]])}));return e}(),reset:function(){this.filter="",this.message="",this.filterElement.previous=null,this.filterElement.current=null,this.filterElement.operator=null},test:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function r(){var e,t;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=this.currentlayer.id,this.loading.test=!0,t=void 0,r.prev=3,r.next=6,o["default"].test({layerId:e,filter:this.filter});case 6:t=r.sent,this.message=void 0!==t?" "+t:"",r.next=13;break;case 10:r.prev=10,r.t0=r["catch"](3),this.message=r.t0;case 13:return this.loading.test=!1,r.next=16,this.$nextTick();case 16:case"end":return r.stop()}},r,this,[[3,10]])}));return e}(),run:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function r(){var e,t;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=this.currentlayer.id,this.loading.test=!0,r.prev=2,r.next=5,o["default"].run({layerId:e,filter:this.filter});case 5:t=r.sent,r.next=10;break;case 8:r.prev=8,r.t0=r["catch"](2);case 10:this.loading.test=!1;case 11:case"end":return r.stop()}},r,this,[[2,8]])}));return e}(),save:function(){o["default"].save({layerId:this.currentlayer.id,filter:this.filter,projectId:this.projectId,name:this.edit&&this.$options.options.name,id:this.edit&&this.$options.options.id})}},created:function(){var e=this;this.filterElement={current:null,previous:null,operator:null};var t=l.getCurrentProject();this.layers=t.getLayers().filter(function(e){return!e.baselayer&&e.geometrytype&&"NoGeometry"!==e.geometrytype&&Array.isArray(e.fields)}).map(function(e){var r=t.getRelationsByLayerId({layerId:e.id,type:"ONE"}),i=[];return r.forEach(function(e){var r=e.customPrefix,a=t.getLayerById(e.referencingLayer);r=void 0===r?a.getName()+"_":r;var o=a.getFields().map(function(e){return""+r+e.name});i=[].concat(n(i),n(o))}),{id:e.id,label:e.name,fields:e.fields.map(function(e){return{label:e.label,name:e.name}}).filter(function(e){return i.indexOf(e)===-1})}}),this.operators=u,this.currentlayer=this.edit?this.layers.find(function(t){return t.id===e.$options.options.layerId}):this.layers[0]},mounted:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function r(){var e,t=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.$nextTick();case 2:this.select2=$("#query_builder_layers_select").select2({width:"100%"}),this.edit&&(e=this.layers.indexOf(this.currentlayer),this.select2.val(e),this.select2.trigger("change")),this.select2.on("select2:select",function(e){t.currentlayer=t.layers[e.params.data.id],t.select.field=null,t.select.value=null,t.reset()});case 5:case"end":return r.stop()}},r,this)}));return e}(),beforeDestroy:function(){this.select2.select2("destroy"),this.select2=null}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"form-group",staticStyle:{"flex-wrap":"nowrap !important"},attrs:{id:"query_builder"}},[r("div",{attrs:{id:"query_builder_header"}}),e._v(" "),r("div",{staticClass:"margin-between-element",attrs:{id:"query_builder_layers"}},[r("label",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.layers",expression:"'sdk.querybuilder.panel.layers'"}],staticClass:"querybuilder-title"}),e._v(" "),r("select",{staticClass:"form-control",attrs:{id:"query_builder_layers_select"}},e._l(e.layers,function(t,n){return r("option",{key:t.label,staticClass:"bold",domProps:{value:n}},[e._v(e._s(t.label))])}),0)]),e._v(" "),r("div",{staticClass:"margin-between-element",attrs:{id:"query_builder_fields"}},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.fields",expression:"'sdk.querybuilder.panel.fields'"}],staticClass:"querybuilder-title",attrs:{id:"query_builder_fields_title"}}),e._v(" "),r("div",{staticClass:"querybuilder-content",attrs:{id:"query_builder_fields_content"}},[r("table",{staticClass:"table table-striped content-table"},[r("tbody",e._l(e.fields,function(t){var n=t.name,i=t.label;return r("tr",{key:n,"class":{"skin-background-color lighten":e.select.field===n},staticStyle:{cursor:"pointer"},on:{click:function(t){e.select.field=n},dblclick:function(t){return e.addToExpression({value:n,type:"field"})}}},[r("th",{attrs:{scope:"row"}},[e._v(e._s(i))])])}),0)])])]),e._v(" "),r("div",{staticClass:"margin-between-element",attrs:{id:"query_builder_values"}},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.values",expression:"'sdk.querybuilder.panel.values'"}],staticClass:"querybuilder-title",attrs:{id:"query_builder_values_title"}}),e._v(" "),e.manual?r("div",{staticClass:"margin-between-element",staticStyle:{display:"flex","justify-content":"space-between","align-items":"stretch"},attrs:{id:"querybuilder-manual"}},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.manualvalue,expression:"manualvalue"}],staticClass:"form-control",staticStyle:{border:"0"},attrs:{style:"border: 0;"},domProps:{value:e.manualvalue},on:{input:function(t){t.target.composing||(e.manualvalue=t.target.value)}}}),e._v(" "),r("span",{"class":e.g3wtemplate.getFontClass("plus"),staticStyle:{cursor:"pointer","font-size":"1.2em","background-color":"white",color:"#000000",padding:"9px"},on:{click:function(t){e.manualvalue&&e.addToExpression({value:e.manualvalue,type:"value"})}}})]):r("div",{staticClass:"querybuilder-content margin-between-element",attrs:{id:"query_builder_values_content"}},[r("bar-loader",{attrs:{loading:e.loading.values}}),e._v(" "),r("table",{staticClass:"table table-striped content-table"},[r("tbody",[e._l(e.values,function(t){return r("tr",{key:t,"class":{"skin-background-color lighten":e.select.value===t},staticStyle:{cursor:"pointer"},on:{click:function(r){e.select.value=t},dblclick:function(r){return e.addToExpression({value:t,type:"value"})}}},[r("th",{attrs:{scope:"row"}},[e._v(e._s(t))])])}),e._v(" "),e._m(0)],2)])],1),e._v(" "),r("div",{staticClass:"content-end skin-color",attrs:{id:"query_builder_values_buttons"}},[r("button",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.button.manual",expression:"'sdk.querybuilder.panel.button.manual'"}],staticClass:"query_builder_button btn btn-secondary bold ","class":{"skin-border-color":e.manual},attrs:{id:"query_builder_values_buttons_sample"},on:{click:function(t){e.manual=!0}}}),e._v(" "),r("button",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.button.all",expression:"'sdk.querybuilder.panel.button.all'"}],staticClass:"query_builder_button btn btn-secondary bold ","class":{"skin-border-color":!e.manual},attrs:{id:"query_builder_values_buttons_all",disabled:null===e.select.field},on:{click:e.all}})])]),e._v(" "),r("div",{staticClass:"margin-between-element",staticStyle:{"margin-top":"auto !important"},attrs:{id:"query_builder_operators"}},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.operators",expression:"'sdk.querybuilder.panel.operators'"}],staticClass:"querybuilder-title",attrs:{id:"query_builder_operators_title"}}),e._v(" "),r("div",{staticClass:"content-wrap",attrs:{id:"query_builder_operators_content"}},e._l(e.operators,function(t){return r("button",{key:t,staticClass:"query_builder_button btn btn-secondary skin-color bold",on:{click:function(r){return e.addToExpression({value:t,type:"operator"})}}},[e._v(e._s(t))])}),0)]),e._v(" "),r("div",{attrs:{id:"query_builder_footer"}},[r("div",{attrs:{id:"query_builder_expression"}},[r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.expression",expression:"'sdk.querybuilder.panel.expression'"}],staticClass:"querybuilder-title",attrs:{id:"query_builder_expression_title"}}),e._v(" "),r("div",{attrs:{id:"query_builder_expression_content"}},[r("textarea",{directives:[{name:"model",rawName:"v-model",value:e.filter,expression:"filter"}],staticStyle:{width:"100%",resize:"none",height:"100px",color:"#000000"},domProps:{value:e.filter},on:{input:function(t){t.target.composing||(e.filter=t.target.value)}}})])]),e._v(" "),r("div",{staticClass:"margin-between-element",attrs:{id:"query_builder_message"}},[r("bar-loader",{attrs:{loading:e.loading.test}}),e._v(" "),r("span",{directives:[{name:"show",rawName:"v-show",value:e.message,expression:"message"},{name:"t",rawName:"v-t",value:"sdk.querybuilder.messages.number_of_features",expression:"'sdk.querybuilder.messages.number_of_features'"}],staticClass:"bold skin-color"}),r("span",{staticClass:"bold skin-color"},[e._v(e._s(e.message))])],1),e._v(" "),r("div",{staticClass:"content-end margin-between-element",attrs:{id:"query_builder_footer_buttons"}},[r("button",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.button.test",expression:"'sdk.querybuilder.panel.button.test'"}],staticClass:"query_builder_button btn btn-secondary  bold",attrs:{disabled:e.disabled},on:{click:e.test}}),e._v(" "),r("button",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.button.clear",expression:"'sdk.querybuilder.panel.button.clear'"}],staticClass:"query_builder_button btn btn-secondary  bold",on:{click:e.reset}}),e._v(" "),r("button",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.button.run",expression:"'sdk.querybuilder.panel.button.run'"}],staticClass:"query_builder_button btn btn-secondary  bold",attrs:{disabled:e.disabled},on:{click:e.run}}),e._v(" "),r("button",{directives:[{name:"t",rawName:"v-t",value:"sdk.querybuilder.panel.button.save",expression:"'sdk.querybuilder.panel.button.save'"}],staticClass:"query_builder_button btn btn-secondary  bold",attrs:{disabled:e.disabled},on:{click:e.save}})])])])},n.staticRenderFns=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("tr",[r("th",{attrs:{scope:"row"}})])}]},{"core/layers/filter/operators":48,"core/project/projectsregistry":83,"gui/querybuilder/service":201}],312:[function(e,t,r){
!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("gui/querybuilder/service"),a=t(i),o=e("gui/querybuilder/querybuilderuifactory");r["default"]={name:"g3w-querybuilder-search",props:{querybuildersearch:{required:!0}},data:function(){return{loading:!1,showinfo:!1}},methods:{remove:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a["default"]["delete"](this.querybuildersearch);case 3:this.$emit("delete"),e.next=8;break;case 6:e.prev=6,e.t0=e["catch"](0);case 8:case"end":return e.stop()}},r,this,[[0,6]])}));return e}(),edit:function(){o.show({options:{id:this.querybuildersearch.id,name:this.querybuildersearch.name,layerId:this.querybuildersearch.layerId,filter:this.querybuildersearch.filter}})},run:function(){var e=this;this.loading=!0,a["default"].run({layerId:this.querybuildersearch.layerId,filter:this.querybuildersearch.filter})["finally"](function(){e.loading=!1})}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",[r("div",{staticStyle:{position:"relative"}},[r("bar-loader",{attrs:{loading:e.loading}}),e._v(" "),r("div",{staticClass:"querybuliserch-tools",staticStyle:{display:"flex","align-items":"baseline"}},[r("i",{"class":e.g3wtemplate.getFontClass("filter"),staticStyle:{"margin-right":"14px","margin-left":"1px"}}),e._v(" "),r("span",{staticStyle:{"white-space":"pre-wrap"}},[e._v(e._s(e.querybuildersearch.name))]),e._v(" "),r("div",{staticStyle:{"margin-left":"auto"}},[r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.querybuilder.search.run",expression:"'sdk.querybuilder.search.run'"}],staticClass:"icon-search-action skin-tooltip-bottom",attrs:{"data-placement":"bottom","data-toggle":"tooltip"}},[r("i",{"class":e.g3wtemplate.getFontClass("run"),staticStyle:{color:"green",padding:"3px","font-size":"1.3em"},on:{click:function(t){return t.stopPropagation(),e.run(t)}}})]),e._v(" "),r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.querybuilder.search.info",expression:"'sdk.querybuilder.search.info'"}],staticClass:"icon-search-action skin-tooltip-bottom",attrs:{"data-placement":"bottom","data-toggle":"tooltip"}},[r("i",{"class":e.g3wtemplate.getFontClass("info"),staticStyle:{color:"#FFFFFF",padding:"3px","font-size":"1.3em"},on:{click:function(t){t.stopPropagation(),e.showinfo=!e.showinfo}}})]),e._v(" "),r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.querybuilder.search.edit",expression:"'sdk.querybuilder.search.edit'"}],staticClass:"icon-search-action skin-tooltip-bottom",attrs:{"data-placement":"bottom","data-toggle":"tooltip"}},[r("i",{"class":e.g3wtemplate.getFontClass("pencil"),staticStyle:{color:"#307095",padding:"3px","font-size":"1.3em"},on:{click:function(t){return t.stopPropagation(),e.edit(t)}}})]),e._v(" "),r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"sdk.querybuilder.search.delete",expression:"'sdk.querybuilder.search.delete'"}],staticClass:"icon-search-action skin-tooltip-bottom",attrs:{"data-placement":"bottom","data-toggle":"tooltip"}},[r("i",{"class":e.g3wtemplate.getFontClass("trash"),staticStyle:{color:"red",padding:"3px","font-size":"1.3em"},on:{click:function(t){return t.stopPropagation(),e.remove(t)}}})])])]),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.showinfo,expression:"showinfo"}],staticClass:"querybuildsearch-info",staticStyle:{"margin-top":"5px"}},[r("div",[r("span",{staticStyle:{"font-weight":"bold","white-space":"pre"}},[e._v("LAYER: ")]),e._v(" "),r("span",{staticStyle:{"white-space":"pre-wrap"}},[e._v(e._s(e.querybuildersearch.layerName))])]),e._v(" "),r("div",[r("span",{staticStyle:{"font-weight":"bold"}},[e._v("EXPRESSION: ")]),e._v(" "),r("span",{staticStyle:{"white-space":"pre-wrap"}},[e._v(e._s(e.querybuildersearch.filter))])])])],1)])},n.staticRenderFns=[],n._scopeId="data-v-4f0104b0"},{"gui/querybuilder/querybuilderuifactory":200,"gui/querybuilder/service":201}],313:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=e("components/QueryResultsTableAttributeFieldValue.vue"),o=t(a),s=e("components/QueryResultsActionInfoFormats.vue"),l=t(s),u=e("components/QueryResultsHeaderFeatureBody.vue"),c=t(u),d=e("core/utils/utils"),p=d.throttle,f=e("gui/vue/vue.mixins"),h=f.fieldsMixin,v=3,g=10,m=10,y=["varchar","integer","float","date"];r["default"]={data:function(){return{state:this.$options.queryResultsService.state,headerExpandActionCellWidth:g,headerActionsCellWidth:m}},mixins:[h],components:{TableAttributeFieldValue:o["default"],infoformats:l["default"],"header-feature-body":c["default"]},computed:{layersFeaturesBoxes:function(){return this.state.layersFeaturesBoxes},onelayerresult:function(){return 1===this.state.layers.length},hasLayers:function(){return this.hasResults||!!this.state.components.length},hasResults:function(){return this.state.layers.length>0},info:function b(){var e=this,b={icon:null,message:null,action:null},t=this.state,r=t.query;t.search;return r&&("coordinates"===r.type?(b.icon="marker",b.message="  "+r.coordinates[0]+", "+r.coordinates[1],b.action=function(){return e.$options.queryResultsService.showCoordinates(r.coordinates)}):"bbox"===r.type?(b.icon="square",b.message="  ["+r.bbox.join(" , ")+"]",b.action=function(){return e.$options.queryResultsService.showBBOX(r.bbox)}):"polygon"===r.type&&(b.icon="draw",b.message=r.layer.getName()+" - Feature Id: "+r.fid,b.action=function(){return r.geometry&&e.$options.queryResultsService.showGeometry(r.geometry)})),b}},methods:{getLayerCustomComponents:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"feature",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"after";return this.state.layerscustomcomponents[e]&&this.state.layerscustomcomponents[e][t]&&this.state.layerscustomcomponents[e][t][r]||[]},getLayerField:function(e){var t=e.layer,r=e.feature,n=e.fieldName,a=t.attributes.find(function(e){return e.name===n}),o=i({},a,{label:null,value:r.attributes[n]});return o},getQueryFields:function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var s,l=e.formStructure.fields[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){var u=s.value,c=i({},u);c.query=!0,c.value=t.attributes[u.name],c.input={type:""+this.getFieldType(c)},r.push(c)}}catch(d){a=!0,o=d}finally{try{!n&&l["return"]&&l["return"]()}finally{if(a)throw o}}return r},getColSpan:function(e){return this.attributesSubsetLength(e)+(this.state.layersactions[e.id].length?1:0)+1*!this.hasLayerOneFeature(e)},getDownloadActions:function(e){return this.state.layersactions[e.id].find(function(e){return e.formats})},addLayerFeaturesToResults:function(e){this.$options.queryResultsService.addLayerFeaturesToResultsAction(e)},showDownloadAction:function(e){var t=e.target.children[0].style.display;e.target.children[0].style.display="none"===t?"inline-block":"none"},printAtlas:function(e){this.$options.queryResultsService.printAtlas(e)},showLayerDownloadFormats:function(e){this.$options.queryResultsService.showLayerDownloadFormats(e)},saveLayerResult:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"csv";this.$options.queryResultsService.saveLayerResult({layer:e,type:t})},hasLayerOneFeature:function(e){return 1===e.features.length},addRemoveFilter:function(e){this.$options.queryResultsService.addRemoveFilter(e)},getContainerFromFeatureLayer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layer,r=e.index;return $("#"+t.id+"_"+r+" > td")},hasOneLayerAndOneFeature:function(e){return this.hasLayerOneFeature(e)},hasFormStructure:function(e){return!!e.formStructure},layerHasFeatures:function(e){return!!(e.features&&e.features.length>0)},selectionFeaturesLayer:function(e){this.$options.queryResultsService.selectionFeaturesLayer(e)},layerHasActions:function(e){return this.state.layersactions[e.id].length>0},featureHasActions:function(e,t){return this.geometryAvailable(t)},geometryAvailable:function(e){return!!e.geometry},extractAttributesFromFirstTabOfFormStructureLayers:function(e){var t=this,r=new Set,n=function a(n){if(n.nodes)n.nodes.forEach(function(e){return a(e)});else{var o=e.formStructure.fields.find(function(e){return e.name===n.field_name});o&&("ows"===t.state.type&&(o=i({},o),o.name=o.name.replace(/ /g,"_")),r.add(o))}};return e.formStructure.structure.length&&e.formStructure.structure.forEach(function(e){return n(e)}),Array.from(r)},attributesSubset:function(e){var t=this.hasFormStructure(e)?this.extractAttributesFromFirstTabOfFormStructureLayers(e):e.attributes,r=t.filter(function(e){return e.show&&y.indexOf(e.type)!==-1}),n=Math.min(v,t.length);return r.slice(0,n)},relationsAttributesSubset:function(e){var t=[];_.forEach(e,function(e,r){Array.isArray(e)||t.push({label:r,value:e})});var r=Math.min(v,t.length);return t.slice(0,r)},relationsAttributes:function(e){var t=[];return _.forEach(e,function(e,r){t.push({label:r,value:e})}),t},attributesSubsetLength:function(e){return this.attributesSubset(e).length},cellWidth:function(e,t){var r=v+this.state.layersactions[t.id].length,n=this.attributesSubsetLength(t),i=r-n,a=t.hasgeometry?m:0,o=100-g-a,s=o/v;return e===n-1&&i>0?s*(i+1):s},featureBoxColspan:function(e){var t=this.attributesSubsetLength(e);return e.expandable&&(t+=1),e.hasgeometry&&(t+=1),t},relationsAttributesSubsetLength:function(e){return this.relationsAttributesSubset(e).length},getLayerFormStructure:function(e){return e.formStructure.structure},isAttributeOrTab:function(e,t){var r=void 0!==t.field_name;return{type:r&&"field"||"tab",item:r&&this.getLayerAttributeFromStructureItem(e,t.field_name)||[t]}},getLayerAttributeFromStructureItem:function(e,t){return e.attributes.find(function(e){return e.name===t})},getLayerFeatureBox:function(e,t,r){var n=this,i=this.getBoxId(e,t,r);return void 0===this.layersFeaturesBoxes[i]&&(this.layersFeaturesBoxes[i]=Vue.observable({collapsed:!0}),this.$watch(function(){return n.layersFeaturesBoxes[i].collapsed},function(r){var i=e.features.findIndex(function(e){return t.id===e.id}),a=n.getContainerFromFeatureLayer({layer:e,index:i});n.$options.queryResultsService.openCloseFeatureResult({open:!r,layer:e,feature:t,container:a})}),this.layersFeaturesBoxes[i].collapsed=e.features.length>1),this.layersFeaturesBoxes[i]},collapsedFeatureBox:function(e,t,r){var n=this.getBoxId(e,t,r);return!this.layersFeaturesBoxes[n]||this.layersFeaturesBoxes[n].collapsed},showFeatureInfo:function(e,t){this.$options.queryResultsService.emit("show-query-feature-info",{layer:e,tabs:this.hasFormStructure(e),show:!this.layersFeaturesBoxes[t].collapsed})},getBoxId:function(e,t,r){return this.$options.queryResultsService.getBoxId(e,t,r)},toggleFeatureBox:function(){function e(e,r,n){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e,t,n){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=this.getBoxId(e,t,n),this.layersFeaturesBoxes[i].collapsed=!this.layersFeaturesBoxes[i].collapsed,r.next=4,this.$nextTick();case 4:this.showFeatureInfo(e,i);case 5:case"end":return r.stop()}},r,this)}));return e}(),toggleFeatureBoxAndZoom:function(e,t,r){!this.hasLayerOneFeature(e)&&this.toggleFeatureBox(e,t,r)},trigger:function(){function e(e,r,n,i){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e,t,n,i){var a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!e.opened||"none"!==$("#"+t.id+"_"+i).css("display")){r.next=4;break}return this.toggleFeatureBox(t,n),r.next=4,this.$nextTick();case 4:return a=this.getContainerFromFeatureLayer({layer:t,index:i}),r.next=7,this.$options.queryResultsService.trigger(e.id,t,n,i,a);case 7:case"end":return r.stop()}},r,this)}));return e}(),showFullPhoto:function(e){this.$options.queryResultsService.showFullPhoto(e)},openLink:function(e){window.open(e,"_blank")}},watch:{"state.layers":function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){var t,n,i,a=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e.forEach(function(e){e.attributes.length<=v&&!e.hasImageField&&(e.expandable=!1),e.features.forEach(function(t){if(a.getLayerFeatureBox(e,t),t.attributes.relations){var r=t.attributes.relations;r.forEach(function(r){var n=e.id+"_"+t.id+"_"+r.name,i=r.elements;i.forEach(function(e,t){a.layersFeaturesBoxes[n+t]={collapsed:!0}})})}})}),this.onelayerresult=1===e.length,this.onelayerresult&&this.hasLayerOneFeature(e[0])&&(t=e[0],n=t.features[0],i=this.getBoxId(t,n),this.$options.queryResultsService.onceafter("postRender",function(){a.showFeatureInfo(t,i)})),requestAnimationFrame(function(){return a.$options.queryResultsService.postRender(a.$el)}),r.next=6,this.$nextTick();case 6:case"end":return r.stop()}},r,this)}));return e}(),onelayerresult:function(e){e&&this.$options.queryResultsService.highlightFeaturesPermanently(this.state.layers[0])}},created:function(){var e=this;this.zoomToLayerFeaturesExtent=p(function(t){e.$options.queryResultsService.zoomToLayerFeaturesExtent(t,{highlight:!0})})},beforeDestroy:function(){this.state.zoomToResult=!0,this.layersFeaturesBoxes=null},destroyed:function(){this.$options.queryResultsService.clear()}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"queryresults-wrapper",attrs:{id:"search-results"}},[e.info.message?r("div",{staticClass:"skin-color",staticStyle:{"font-weight":"bold","margin-bottom":"3px","font-size":"1.1em"}},[e.info.icon?r("span",{staticClass:"action-button skin-tooltip-bottom","class":e.g3wtemplate.getFontClass(e.info.icon),on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.info.action(t)}}}):e._e(),e._v(" "),r("span",[e._v(e._s(e.info.message))])]):e._e(),e._v(" "),r("div",{staticClass:"queryresults-container"},[e.state.layers.length?[e.hasLayers?r("ul",{staticClass:"queryresults",staticStyle:{position:"relative"},attrs:{id:"queryresults"}},[e._l(e.state.layers,function(t){return r("li",{directives:[{name:"show",rawName:"v-show",value:(e.layerHasFeatures(t)||t.rawdata)&&t.show,expression:"(layerHasFeatures(layer) || layer.rawdata) && layer.show"}]},[r("bar-loader",{attrs:{loading:t.loading}}),e._v(" "),r("div",{staticClass:"box box-primary"},[r("div",{staticClass:"box-header with-border","class":{mobile:e.isMobile()},attrs:{"data-widget":"collapse"}},[r("div",{staticClass:"box-title query-layer-title",style:{fontSize:e.isMobile()&&"1em !important"}},[e._v(e._s(t.title)+"\n                "),r("span",{directives:[{name:"show",rawName:"v-show",value:!t.rawdata,expression:"!layer.rawdata"}],staticClass:"query-layer-feature-count"},[e._v("("+e._s(t.features.length)+")")])]),e._v(" "),r("div",{staticClass:"box-features-action",on:{click:function(e){e.stopPropagation()}}},[r("infoformats",{attrs:{layer:t}}),e._v(" "),t.features.length>1?[t.hasgeometry?r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"sdk.mapcontrols.query.actions.zoom_to_features_extent.hint",expression:"'sdk.mapcontrols.query.actions.zoom_to_features_extent.hint'",arg:"left",modifiers:{create:!0}}],staticClass:"action-button",on:{click:function(r){return r.stopPropagation(),e.zoomToLayerFeaturesExtent(t)}}},[r("span",{staticClass:"action-button-icon","class":e.g3wtemplate.getFontClass("marker")})]):e._e(),e._v(" "),t.atlas.length?r("span",{directives:[{name:"download",rawName:"v-download"},{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"sdk.mapcontrols.query.actions.atlas.hint",expression:"'sdk.mapcontrols.query.actions.atlas.hint'",arg:"left",modifiers:{create:!0}}],staticClass:"action-button",on:{click:function(r){return r.stopPropagation(),e.printAtlas(t)}}},[r("span",{staticClass:"action-button-icon","class":e.g3wtemplate.getFontClass("print")})]):e._e(),e._v(" "),1===t.downloads.length?[r("span",{directives:[{name:"download",rawName:"v-download"},{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"sdk.mapcontrols.query.actions.download_features_"+t.downloads[0]+".hint",expression:"`sdk.mapcontrols.query.actions.download_features_${layer.downloads[0]}.hint`",arg:"left",modifiers:{create:!0}}],staticClass:"action-button","class":{toggled:t[t.downloads[0]].active}},[r("span",{staticClass:"action-button-icon","class":e.g3wtemplate.getFontClass("download"),on:{click:function(r){return r.stopPropagation(),e.saveLayerResult(t,t.downloads[0])}}})])]:t.downloads.length>1?[r("span",{directives:[{name:"download",rawName:"v-download"},{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"Downloads",expression:"'Downloads'",arg:"left",modifiers:{create:!0}}],staticClass:"action-button","class":{toggled:t.downloadformats.active}},[r("span",{staticClass:"action-button-icon","class":e.g3wtemplate.getFontClass("download"),on:{click:function(r){return r.stopPropagation(),e.showLayerDownloadFormats(t)}}})])]:e._e()]:e._e(),e._v(" "),t.source&&"wms"===t.source.type?e._e():r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"sdk.mapcontrols.query.actions.add_features_to_results.hint",expression:"'sdk.mapcontrols.query.actions.add_features_to_results.hint'",arg:"left",modifiers:{create:!0}}],staticClass:"action-button","class":{toggled:t.addfeaturesresults.active},on:{click:function(r){return r.stopPropagation(),e.addLayerFeaturesToResults(t)}}},[r("span",{staticClass:"action-button-icon","class":e.g3wtemplate.getFontClass("plus-square")})]),e._v(" "),t.features.length>1&&"wms"!==t.source.type?r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"sdk.mapcontrols.query.actions.add_selection.hint",expression:"'sdk.mapcontrols.query.actions.add_selection.hint'",arg:"left",modifiers:{create:!0}}],staticClass:"action-button skin-tooltip-left","class":{toggled:t.selection.active},on:{click:function(r){return r.stopPropagation(),e.selectionFeaturesLayer(t)}}},[r("span",{staticClass:"action-button-icon","class":e.g3wtemplate.getFontClass("success")})]):e._e(),e._v(" "),r("span",{directives:[{name:"show",rawName:"v-show",value:t.selection.active,expression:"layer.selection.active"},{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:"layer_selection_filter.tools.filter",expression:"'layer_selection_filter.tools.filter'",arg:"left",modifiers:{create:!0}}],staticClass:"action-button skin-tooltip-left","class":{toggled:t.filter.active},on:{click:function(r){return r.stopPropagation(),e.addRemoveFilter(t)}}},[r("span",{staticClass:"action-button-icon","class":e.g3wtemplate.getFontClass("filter")})])],2),e._v(" "),r("button",{staticClass:"btn btn-box-tool",attrs:{"data-widget":"collapse"}},[r("i",{staticClass:"btn-collapser skin-color","class":e.g3wtemplate.font.minus})])]),e._v(" "),e.state.layeractiontool[t.id].component?[r("div",{staticClass:"g3w-layer-action-tools with-border","class":{mobile:e.isMobile()},staticStyle:{padding:"5px"}},[r(e.state.layeractiontool[t.id].component,{tag:"component",attrs:{layer:t,config:e.state.layeractiontool[t.id].config}})],1)]:e._e(),e._v(" "),e._l(e.getLayerCustomComponents(t.id,"layer","before"),function(e){var n=e.component;return r(n,{tag:"component",attrs:{layer:t}})}),e._v(" "),r("div",{staticClass:"box-body","class":{mobile:e.isMobile()}},[t.rawdata?[r("div",{staticClass:"queryresults-text-html","class":{text:"text/plain"===t.infoformat},domProps:{innerHTML:e._s(t.rawdata)}})]:e.hasFormStructure(t)?[r("table",{staticClass:"table","class":{mobile:e.isMobile()}},[r("thead",[r("tr",[e.state.layersactions[t.id].length?r("th",{style:{width:26*e.state.layersactions[t.id].length+"px",maxWidth:26*e.state.layersactions[t.id].length+"px"}}):e._e(),e._v(" "),e._l(e.attributesSubset(t),function(t,n){return r("th",{staticClass:"centered"},[e._v(e._s(t.label))])}),e._v(" "),e.hasLayerOneFeature(t)?e._e():r("th",{staticClass:"collapsed"})],2)]),e._v(" "),r("tbody",[e._l(t.features,function(n,i){return n.show?[r("header-feature-body",{attrs:{actions:e.state.layersactions[t.id],layer:t,feature:n,index:i,onelayerresult:e.onelayerresult,trigger:e.trigger,toggleFeatureBoxAndZoom:e.toggleFeatureBoxAndZoom,hasLayerOneFeature:e.hasLayerOneFeature,boxLayerFeature:e.getLayerFeatureBox(t,n),attributesSubset:e.attributesSubset,getLayerField:e.getLayerField}}),e._v(" "),r("tr",{staticClass:"g3w-feature-result-action-tools"},[e.state.currentactiontools[t.id][i]?[r("td",{attrs:{colspan:e.getColSpan(t)}},[r(e.state.currentactiontools[t.id][i],{tag:"component",attrs:{colspan:e.getColSpan(t),layer:t,feature:n,featureIndex:i,config:e.state.actiontools[e.state.currentactiontools[t.id][i].name][t.id]}})],1)]:e._e()],2),e._v(" "),e._l(e.getLayerCustomComponents(t.id,"feature","before"),function(i){var a=i.component;return r("tr",[r("td",{attrs:{colspan:e.getColSpan(t)}},[r(a,{tag:"component",attrs:{layer:t,feature:n}})],1)])}),e._v(" "),r("tr",{directives:[{name:"show",rawName:"v-show",value:!e.collapsedFeatureBox(t,n)||e.hasOneLayerAndOneFeature(t),expression:"!collapsedFeatureBox(layer,feature) || hasOneLayerAndOneFeature(layer)"}],staticClass:"featurebox-body",attrs:{id:t.id+"_"+i}},[r("td",{attrs:{colspan:e.getColSpan(t)}},[r("tabs",{attrs:{fields:e.getQueryFields(t,n),layerid:t.id,feature:n,tabs:e.getLayerFormStructure(t)}})],1)]),e._v(" "),e._l(e.getLayerCustomComponents(t.id,"feature","after"),function(i){var a=i.component;return r("tr",[r("td",{attrs:{colspan:e.getColSpan(t)}},[r(a,{tag:"component",attrs:{layer:t,feature:n}})],1)])})]:e._e()})],2)])]:r("table",{staticClass:"table","class":{mobile:e.isMobile()}},[r("thead",[r("tr",[e.state.layersactions[t.id].length?r("th",{style:{width:26*e.state.layersactions[t.id].length+"px",maxWidth:26*e.state.layersactions[t.id].length+"px"}}):e._e(),e._v(" "),e._l(e.attributesSubset(t),function(t,n){return r("th",{staticClass:"centered"},[e._v(e._s(t.label))])}),e._v(" "),e.hasLayerOneFeature(t)?e._e():r("th",{staticClass:"collapsed"})],2)]),e._v(" "),e._l(t.features,function(n,i){return n.show?r("tbody",{key:n.id},[r("header-feature-body",{attrs:{actions:e.state.layersactions[t.id],layer:t,feature:n,index:i,onelayerresult:e.onelayerresult,trigger:e.trigger,toggleFeatureBoxAndZoom:e.toggleFeatureBoxAndZoom,hasLayerOneFeature:e.hasLayerOneFeature,boxLayerFeature:e.getLayerFeatureBox(t,n),attributesSubset:e.attributesSubset,getLayerField:e.getLayerField}}),e._v(" "),r("tr",{staticClass:"g3w-feature-result-action-tools"},[e.state.currentactiontools[t.id][i]?[r("td",{attrs:{colspan:e.getColSpan(t)}},[r(e.state.currentactiontools[t.id][i],{tag:"component",attrs:{colspan:e.getColSpan(t),layer:t,feature:n,featureIndex:i,config:e.state.actiontools[e.state.currentactiontools[t.id][i].name][t.id]}})],1)]:e._e()],2),e._v(" "),e._l(e.getLayerCustomComponents(t.id,"feature","before"),function(e){var i=e.component;return r("tr",[r("td",{attrs:{colspan:"getColSpan(layer)"}},[r(i,{tag:"component",staticClass:"box-body",attrs:{layer:t,feature:n}})],1)])}),e._v(" "),r("tr",{directives:[{name:"show",rawName:"v-show",value:!e.collapsedFeatureBox(t,n)||e.hasOneLayerAndOneFeature(t),expression:"!collapsedFeatureBox(layer,feature) || hasOneLayerAndOneFeature(layer)"}],staticClass:"featurebox-body",attrs:{id:t.id+"_"+i}},[r("td",{attrs:{colspan:e.getColSpan(t)}},[r("table",{staticClass:"feature_attributes"},e._l(t.attributes.filter(function(e){return e.show}),function(i){return r("tr",[r("td",{staticClass:"attr-label"},[e._v(e._s(i.label))]),e._v(" "),r("td",{staticClass:"attr-value",attrs:{attribute:i.name}},[r("table-attribute-field-value",{attrs:{feature:n,field:e.getLayerField({layer:t,feature:n,fieldName:i.name})}})],1)])}),0)])]),e._v(" "),e._l(e.getLayerCustomComponents(t.id,"feature","after"),function(e){var i=e.component;return r("tr",[r("td",{attrs:{colspan:"getColSpan(layer)"}},[r(i,{tag:"component",staticClass:"box-body",attrs:{layer:t,feature:n}})],1)])})],2):r("tbody")})],2)],2),e._v(" "),e._l(e.getLayerCustomComponents(t.id,"layer","after"),function(n){var i=n.component;return r("div",{staticClass:"box-body","class":{mobile:e.isMobile()}},[r(i,{tag:"component",attrs:{layer:t}})],1)})],2)],1)}),e._v(" "),e._l(e.state.components,function(t){return r("li",[r(t,{tag:"component",on:{showresults:function(t){return e.showResults()}}})],1)})],2):e._e()]:[e.state.changed?r("div",{staticClass:"query-results-not-found"},[r("h4",{directives:[{name:"t",rawName:"v-t",value:"info.no_results",expression:"'info.no_results'"}],staticClass:"skin-color",staticStyle:{"font-weight":"bold","text-align":"center"}})]):e._e()]],2)])},n.staticRenderFns=[]},{"components/QueryResultsActionInfoFormats.vue":316,"components/QueryResultsHeaderFeatureBody.vue":319,"components/QueryResultsTableAttributeFieldValue.vue":320,"core/utils/utils":92,"gui/vue/vue.mixins":227}],314:[function(e,t,r){!function(){function t(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("core/i18n/i18n.service"),i=n.t;r["default"]={name:"action",data:function(){return{show:!0}},props:{featureIndex:{type:Number},feature:{type:Object},layer:{type:Object},trigger:{type:Function},action:{type:Object,required:!0}},methods:{clickAction:function(){function e(e,t,n,i,a){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(e,t,r,a,o){var s,l;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.trigger(e,t,r,a);case 2:e.hint_change&&(s=$(o.target).parent(),l=s.attr("data-original-title"),s.attr("data-original-title",i(e.hint_change.hint)),s.tooltip("show"),setTimeout(function(){s.attr("data-original-title",l),s.tooltip("show")},e.hint_change.duration||600)),this.$emit("action-clicked",e);case 4:case"end":return n.stop()}},n,this)}));return e}()},created:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.action.init&&this.action.init({layer:this.layer,feature:this.feature,index:this.featureIndex,action:this.action}),"function"!=typeof this.action.condition){t.next=11;break}if(e=this.action.condition({layer:this.layer,feature:this.feature}),!(e instanceof Promise)){t.next=9;break}return t.next=6,e;case 6:t.t0=t.sent,t.next=10;break;case 9:t.t0=e;case 10:this.show=t.t0;case 11:case"end":return t.stop()}},n,this)}));return e}(),mounted:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:$('.action-button[data-toggle="tooltip"]').tooltip();case 3:case"end":return e.stop()}},n,this)}));return e}()}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.show?r("span",{directives:[{name:"download",rawName:"v-download",value:e.action.download,expression:"action.download"},{name:"t-title",rawName:"v-t-title",value:e.action.hint,expression:"action.hint"}],staticClass:"action-button skin-tooltip-right","class":{toggled:e.action.state&&e.action.state.toggled[e.featureIndex]},attrs:{"data-placement":"right","data-toggle":"tooltip"},on:{contextmenu:function(e){e.preventDefault(),e.stopPropagation()},click:function(t){return t.stopPropagation(),e.clickAction(e.action,e.layer,e.feature,e.featureIndex,t)}}},[r("span",{"class":"action-button-icon "+e.action["class"],staticStyle:{padding:"2px"},style:e.action.style})]):e._e()},n.staticRenderFns=[],n._scopeId="data-v-6e02064e"},{"core/i18n/i18n.service":27}],315:[function(e,t,r){!function(){function e(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"downloadformats",data:function(){var e=this.config.downloads[0].format;return{download_format:e}},props:{featureIndex:{type:Number},feature:{type:Object},layer:{type:Object},config:{type:Object,"default":null}},methods:{download:function(){function t(){return r.apply(this,arguments)}var r=e(regeneratorRuntime.mark(function n(){var e,t=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,e=this.config.downloads.find(function(e){return e.format===t.download_format}),r.next=4,e.cbk(this.layer,this.feature?this.feature:this.layer.features,e,this.featureIndex);case 4:r.next=8;break;case 6:r.prev=6,r.t0=r["catch"](0);case 8:case"end":return r.stop()}},n,this,[[0,6]])}));return t}()}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"g3w-download-formats-content",staticStyle:{width:"100%",display:"flex"},on:{click:function(e){e.preventDefault(),e.stopPropagation()}}},[r("select",{directives:[{name:"select2",rawName:"v-select2",value:"download_format",expression:"'download_format'"}],staticClass:"form-control",staticStyle:{"flex-grow":"1"},attrs:{search:!1}},e._l(e.config.downloads,function(t){return r("option",{directives:[{name:"download",rawName:"v-download"}],key:t.id,domProps:{value:t.format}},[r("span",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(t.format))])])}),0),e._v(" "),r("button",{directives:[{name:"download",rawName:"v-download"}],staticClass:"btn skin-button",staticStyle:{"border-radius":"0 3px 3px 0"},on:{click:function(t){return t.stopPropagation(),e.download(t)}}},[r("span",{"class":e.g3wtemplate.getFontClass("download")})])])},n.staticRenderFns=[],n._scopeId="data-v-12f80c6a"},{}],316:[function(e,t,r){!function(){function t(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;
if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=e("core/catalog/cataloglayersstoresregistry"),a=e("core/parsers/response/parser"),o=e("core/utils/geo"),s=o.getAlphanumericPropertiesFromFeature,l=(o.query,e("gui/gui"));r["default"]={name:"Infoformats",props:{layer:{type:Object,required:!0}},data:function(){return{infoformat:this.layer.infoformat}},computed:{infoformats:function(){return this.layer.infoformats||[]}},methods:{reloadLayerDataWithChangedContentType:function(){function e(e){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function i(e){var t,r,o,u,c,d=this;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=l.getService("queryresults"),this.layer.loading=!0,i.prev=2,i.next=5,this.projectLayer.changeProxyDataAndReloadFromServer("wms",{headers:{"Content-Type":e},params:{INFO_FORMAT:e}});case 5:if(r=i.sent,this.layer.infoformat=e,this.projectLayer.setInfoFormat(this.layer.infoformat),o=a.get(e)({layers:[this.projectLayer],response:r}),u=n(o,1),c=u[0],!c.features){i.next=14;break}this.layer.rawdata=null,c.features.forEach(function(e){var r=t.getFeaturePropertiesAndGeometry(e),n=r.id,i=r.geometry,a=r.properties;0===d.layer.attributes.length&&(d.layer.hasgeometry=!!i,t.setActionsForLayers([d.layer]),s(a).forEach(function(e){d.layer.attributes.push({name:e,label:e,show:!0})}));var o={id:n,attributes:a,geometry:i,show:!0};o.show=!0,d.layer.features.push(o)}),i.next=18;break;case 14:return this.layer.features.splice(0),i.next=17,this.$nextTick();case 17:this.layer.rawdata=c.rawdata;case 18:i.next=23;break;case 20:i.prev=20,i.t0=i["catch"](2);case 23:this.layer.loading=!1;case 24:case"end":return i.stop()}},i,this,[[2,20]])}));return e}()},watch:{infoformat:function(e){this.reloadLayerDataWithChangedContentType(e)}},created:function(){this.projectLayer=i.getLayerById(this.layer.id)},beforeDestroy:function(){this.projectLayer&&this.projectLayer.clearProxyData("wms"),this.projectLayer=null}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.infoformats.length?r("select",{directives:[{name:"select2",rawName:"v-select2",value:"infoformat",expression:"'infoformat'"}],staticClass:"skin-color",attrs:{select2_value:e.infoformat,search:!1}},e._l(e.infoformats,function(t){return r("option",{key:t,domProps:{value:t}},[e._v(e._s(t))])}),0):e._e()},n.staticRenderFns=[]},{"core/catalog/cataloglayersstoresregistry":9,"core/parsers/response/parser":77,"core/utils/geo":89,"gui/gui":150}],317:[function(e,t,r){e("vueify/lib/insert-css").insert(".g3w-polygonattributes-types-title[data-v-17e3cba2]{font-weight:700;padding:3px;color:#fff;margin:0 0 5px}.g3w-polygonattributes-types-content[data-v-17e3cba2]{display:flex;justify-content:space-between;padding:3px;border-radius:3px;border:1px solid #f4f4f4}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("core/applicationstate"),i=t(n),a=e("core/i18n/i18n.service"),o=a.t;r["default"]={name:"querypolygonaddattributes",props:{layer:{type:Object},config:{type:Object,"default":null}},data:function(){return{type:this.config.choices[0].type}},created:function(){var e=this;this.unwatch=this.$watch(function(){return i["default"].lng},function(){e.config.choices.forEach(function(t){return $(e.$refs[t.type]).text(o(t.label))}),$(e.$refs.g3w_select_feature_featurepolygon).select2().trigger("change")})},beforeDestroy:function(){this.unwatch&&this.unwatch(),this.unwatch=null}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{width:"100%"}},[r("h5",{directives:[{name:"t",rawName:"v-t",value:"sdk.mapcontrols.querybypolygon.download.title",expression:"'sdk.mapcontrols.querybypolygon.download.title'"}],staticClass:"skin-background-color g3w-polygonattributes-types-title"}),e._v(" "),r("div",{staticClass:"g3w-polygonattributes-types-content"},[r("select",{directives:[{name:"select2",rawName:"v-select2",value:"type",expression:"'type'"}],ref:"g3w_select_feature_featurepolygon",staticClass:"form-control",staticStyle:{width:"100%"},attrs:{search:!1}},e._l(e.config.choices,function(e){return r("option",{directives:[{name:"t",rawName:"v-t",value:e.label,expression:"choice.label"}],key:e.type,ref:e.type,refInFor:!0,domProps:{value:e.type}})}),0),e._v(" "),r("button",{staticClass:"btn skin-button",staticStyle:{"border-radius":"0 3px 3px 0"},on:{click:function(t){return t.stopPropagation(),e.config.download(e.type)}}},[r("span",{"class":e.g3wtemplate.getFontClass("download")})])])])},n.staticRenderFns=[],n._scopeId="data-v-17e3cba2"},{"core/applicationstate":8,"core/i18n/i18n.service":27,"vueify/lib/insert-css":2}],318:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("components/QueryResultsAction.vue"),i=t(n);r["default"]={name:"actions",props:{featureIndex:{type:Number},feature:{type:Object},layer:{type:Object},trigger:{type:Function},actions:{type:Array,"default":[]}},components:{action:i["default"]}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.actions.length?r("td",{staticClass:"g3w-feature-actions"},e._l(e.actions,function(t){return r("action",e._b({key:t.id,attrs:{action:t}},"action",e.$props,!1))}),1):e._e()},n.staticRenderFns=[],n._scopeId="data-v-5a8c3f6a"},{"components/QueryResultsAction.vue":314}],319:[function(e,t,r){e("vueify/lib/insert-css").insert(".noAttributes[data-v-18bc8218]{display:flex;justify-content:flex-end}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("components/QueryResultsActions.vue"),i=t(n),a=e("gui/vue/vue.mixins"),o=a.fieldsMixin;r["default"]={name:"headerfeaturebody",mixins:[o],props:{toggleFeatureBoxAndZoom:{type:Function},trigger:{type:Function},hasLayerOneFeature:{type:Function},boxLayerFeature:{type:Object},getLayerField:{type:Function},attributesSubset:{type:Function},layer:{type:Object},feature:{type:Object},index:{type:Number},actions:{type:Array}},components:{actions:i["default"]}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("tr",{staticClass:"featurebox-header","class":[e.boxLayerFeature.collapsed?"":"featurebox-header-open"],on:{click:function(t){return e.toggleFeatureBoxAndZoom(e.layer,e.feature)},mouseover:function(t){return e.trigger({id:"highlightgeometry"},e.layer,e.feature,e.index)},mouseout:function(t){return e.trigger({id:"clearHighlightGeometry"},e.layer,e.feature,e.index)}}},[r("actions",{attrs:{layer:e.layer,featureIndex:e.index,trigger:e.trigger,feature:e.feature,actions:e.actions}}),e._v(" "),e._l(e.attributesSubset(e.layer),function(t){return r("td",{staticClass:"attribute"},[e.isLink(e.getLayerField({layer:e.layer,feature:e.feature,fieldName:t.name}))?r("span",{staticClass:"skin-color","class":e.g3wtemplate.getFontClass("link")}):e.isPhoto(e.getLayerField({layer:e.layer,feature:e.feature,fieldName:t.name}))?r("span",{staticClass:"skin-color","class":e.g3wtemplate.getFontClass("image")}):e.isImage(e.getLayerField({layer:e.layer,feature:e.feature,fieldName:t.name}))?r("span",{staticClass:"skin-color","class":e.g3wtemplate.getFontClass("image")}):r("span",[e._v(e._s(e.feature.attributes[t.name]))])])}),e._v(" "),e.hasLayerOneFeature(e.layer)?e._e():r("td",{staticClass:"collapsed","class":{noAttributes:0===e.attributesSubset(e.layer).length}},[r("span",{staticClass:"fa link morelink skin-color","class":[e.boxLayerFeature.collapsed?e.g3wtemplate.font.plus:e.g3wtemplate.font.minus]})])],2)},n.staticRenderFns=[],n._scopeId="data-v-18bc8218"},{"components/QueryResultsActions.vue":318,"gui/vue/vue.mixins":227,"vueify/lib/insert-css":2}],320:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("components/FieldLink.vue"),i=t(n),a=e("components/FieldVue.vue"),o=t(a),s=e("gui/vue/vue.mixins"),l=s.fieldsMixin;r["default"]={name:"tableattributefieldvalue",props:{field:{type:Object},feature:{type:Object}},mixins:[l],components:{"g3w-link":i["default"],"g3w-vue":o["default"]}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.isVue(e.field)?r("g3w-vue",{attrs:{feature:e.feature,state:e.field}}):e.isSimple(e.field)?r("span",{domProps:{innerHTML:e._s(e.field.value)}}):e.isPhoto(e.field)?r("g3w-image",{attrs:{value:e.field.value}}):e.isImage(e.field)?r("g3w-image",{attrs:{value:e.field.value}}):e.isLink(e.field)?r("g3w-link",{attrs:{state:{value:e.field.value}}}):e._e()},n.staticRenderFns=[],n._scopeId="data-v-359d5ff0"},{"components/FieldLink.vue":247,"components/FieldVue.vue":250,"gui/vue/vue.mixins":227}],321:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("constant"),a=e("components/FieldG3W.vue"),o=t(a),s=e("components/QueryResultsActionDownloadFormats.vue"),l=t(s),u=e("core/catalog/cataloglayersstoresregistry"),c=e("gui/gui"),d=e("core/utils/utils"),p=d.throttle,f=e("gui/relations/vue/relationeventbus"),h=e("gui/vue/vue.mixins"),v=h.fieldsMixin,g=h.resizeMixin,m=void 0;r["default"]={props:["table","feature","relation","previousview","showChartButton","cardinality"],inject:["relationnoback"],mixins:[v,g],components:{Field:o["default"]},data:function(){return{feature:null,fields:null,chart:!1,headercomponent:null,downloadButton:null,downloadLayer:{state:null,config:{downloads:[]}}}},computed:{showrelationslist:function(){return"relations"===this.previousview&&!this.relationnoback},one:function(){return"ONE"===this.relation.type}},methods:{resize:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e,t=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.$nextTick();case 2:e=$(".content").height(),setTimeout(function(){var r=$(".query-relation div.dataTables_scrollBody").last(),n=$(".navbar-header").height()+$(".close-panel-block").height()+$(t.$refs["relation-header"]).height()+$(".dataTables_filter").last().height()+$(".dataTables_scrollHead").last().height()+(t.isMobile()?20:0);if(r.height(e-t.tableHeaderHeight-n),t.table.rowFormStructure){var i=r.width()-60;$(".row-wrap-tabs > .tabs-wrapper").width(i)}}),this.relationDataTable&&this.relationDataTable.columns.adjust();case 5:case"end":return r.stop()}},r,this)}));return e}(),saveRelation:function(e){this.$emit("save-relation",e),this.downloadButton.toggled=!1},showFormStructureRow:function(){function e(e,r){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e,t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.table.rowFormStructure=this.table.rowFormStructure===t?null:t,this.fields=this.getRowFields(t),this.resize(),e.next=5,this.$nextTick();case 5:$("#relationtable_wrapper div.dataTables_scrollBody").css("overflow-x",this.table.rowFormStructure?"hidden":"auto"),this.resize();case 7:case"end":return e.stop()}},r,this)}));return e}(),editFeature:function(e){var t=c.getService("queryresults");t.editFeature({layerId:this.table.layerId,featureId:e})},getRowFields:function(e){var t=this,r=this.table.fields.map(function(r,n){return r.value=e[n],r.query=!0,r.input={type:""+t.getFieldType(r)},r});return r},reloadLayout:function(){this.relationDataTable&&this.relationDataTable.columns.adjust()},back:function(){this.$parent.setRelationsList()},fieldIs:function(e,t){var r=this.getFieldType(t);return r===e},is:function(e,t){return this.fieldIs(e,t)},moveFnc:function(e){var t=$(".sidebar-collapse").length?0:m,r=e.pageX+2-t;this.$refs.tablecontent.style.width=r+"px",this.$refs.chartcontent.style.width=$(this.$refs.relationwrapper).width()-r-10+"px"}},watch:{chart:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.resize();case 3:case"end":return e.stop()}},r,this)}));return e}(),headercomponent:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.resize();case 3:case"end":return e.stop()}},r,this)}));return e}()},beforeCreate:function(){this.delayType="debounce"},created:function(){var e=this,t=u.getLayerById(this.table.layerId);this.isEditable=t.isEditable()&&!t.isInEditing();var r=t.isDownloadable()?t.getDownloadableFormats():[],a=r.length;a>0&&(this.downloadButton={toggled:!1,tooltip:a>1?"Downloads":"sdk.tooltips.download_"+r[0],handler:a>1?n(regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:e.downloadButton.toggled=!e.downloadButton.toggled,e.downloadLayer.state=e.downloadLayer.state||t.state,e.downloadLayer.config.downloads=e.downloadLayer.config.downloads.length?e.downloadLayer.config.downloads:r.map(function(r){return{id:r,format:r,cbk:function(){e.saveRelation(t.getDownloadUrl(r)),e.headercomponent=null},download:!0}}),e.headercomponent=e.downloadButton.toggled?l["default"]:null;case 4:case"end":return n.stop()}},o,e)})):function(){return e.saveRelation(t.getDownloadUrl(r[0]))}}),f.$on("reload",function(){e.reloadLayout()}),this.showChart=p(n(regeneratorRuntime.mark(function s(){var t;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e.chart=!e.chart,r.next=3,e.$nextTick();case 3:e.chartContainer=e.chartContainer||$("#chart_content"),t={relations:[e.relation],fid:e.feature.attributes[i.G3W_FID]},e.$emit(e.chart?"show-chart":"hide-chart",e.chartContainer,t);case 6:case"end":return r.stop()}},s,e)})))},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return m=c.getSize({element:"sidebar",what:"width"}),this.relation.title=this.relation.name,e.next=4,this.$nextTick();case 4:this.one||(this.relationDataTable=$(this.$refs.relationtable).DataTable({pageLength:10,bLengthChange:!0,scrollResize:!0,scrollCollapse:!0,scrollX:!0,responsive:!0,order:[this.table.formStructure?1:0,"asc"],columnDefs:[{orderable:!this.table.formStructure,targets:0}]}),$(".row-form").tooltip(),this.tableHeaderHeight=$(".query-relation  div.dataTables_scrollHeadInner").height(),this.resize());case 5:case"end":return e.stop()}},r,this)}));return e}(),beforeDestroy:function(){this.relationDataTable.destroy(),this.relationDataTable=null,this.chartContainer&&this.$emit("hide-chart",this.chartContainer),this.chartContainer=null,this.tableHeaderHeight=null}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"query-relation","class":e.isMobile()?"mobile":null},[r("div",{ref:"relation-header",staticClass:"header"},[r("div",{style:{fontSize:e.isMobile()?"1em":"1.3em",width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"}},[r("span",{staticClass:"relation-tile"},[e.isMobile()?e._e():r("span",{directives:[{name:"t",rawName:"v-t:pre",value:"sdk.relations.relation_data",expression:"'sdk.relations.relation_data'",arg:"pre"}]},[e._v(":")]),e._v(" "),r("b",{staticClass:"skin-color"},[e._v(" "+e._s(e.relation.name))])]),e._v(" "),e.table.rows.length?r("div",{staticClass:"relations-table-tools",staticStyle:{"font-size":"1.1em","margin-bottom":"3px"}},[e.showrelationslist?r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"sdk.relations.back_to_relations",expression:"'sdk.relations.back_to_relations'",modifiers:{create:!0}}],staticClass:"action-button-icon action-button skin-tooltip-left","class":e.g3wtemplate.getFontClass("arrow-left"),attrs:{"data-placement":"left","data-toggle":"tooltip"},on:{click:e.back}}):e._e(),e._v(" "),e.downloadButton?r("span",{directives:[{name:"download",rawName:"v-download"},{name:"t-tooltip",rawName:"v-t-tooltip.create",value:e.downloadButton.tooltip,expression:"downloadButton.tooltip",modifiers:{create:!0}}],staticClass:"action-button-icon action-button skin-tooltip-left","class":[e.g3wtemplate.getFontClass("download"),{"toggled-white":e.downloadButton.toggled}],staticStyle:{padding:"5px"},attrs:{"data-placement":"left","data-toggle":"tooltip"},on:{click:e.downloadButton.handler}}):e._e(),e._v(" "),e.showChartButton?r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"sdk.tooltips.show_chart",expression:"'sdk.tooltips.show_chart'",modifiers:{create:!0}}],staticClass:"action-button-icon action-button skin-tooltip-bottom","class":[e.g3wtemplate.getFontClass("chart"),e.chart?"toggled-white":""],staticStyle:{padding:"5px"},attrs:{"data-placement":"bottom","data-toggle":"tooltip"},on:{click:e.showChart}}):e._e()]):e._e()])]),e._v(" "),e.table.rows.length?r("div",{ref:"relationwrapper",staticStyle:{display:"flex","justify-content":"space-between","margin-bottom":"5px",height:"95%"}},[r("div",{ref:"tablecontent",style:{width:e.chart?"70%":"100%",marginRight:e.chart?"8px":"3px",position:"relative"},attrs:{id:"table_content"}},[e.headercomponent?[r("div",{staticStyle:{width:"100%",display:"flex","margin-left":"auto","margin-bottom":"5px","margin-right":"4px"}},[r(e.headercomponent,{tag:"component",attrs:{layer:e.downloadLayer.state,config:e.downloadLayer.config}})],1)]:e._e(),e._v(" "),r("table",{ref:"relationtable",staticClass:"relationtable table table-striped row-border",attrs:{width:"100%"}},[r("thead",[r("tr",{staticStyle:{height:"0! important"}},[e.table.formStructure||e.isEditable?r("th",{style:{minWidth:30*(1*!!e.table.formStructure+1*e.isEditable)+"px",padding:"0 !important"}}):e._e(),e._v(" "),e._l(e.table.columns,function(t){return r("th",[e._v(e._s(t))])})],2)]),e._v(" "),e._l(e.table.rows,function(t,n){return r("tbody",{key:e.table.rows_fid[n]},[r("tr",{"class":{selected:e.table.rowFormStructure===t}},[e.table.formStructure||e.isEditable?r("td",[e.table.formStructure?r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:e.table.rowFormStructure===t?"sdk.tooltips.relations.form_to_row":"sdk.tooltips.relations.row_to_form",expression:"table.rowFormStructure === row ? 'sdk.tooltips.relations.form_to_row': 'sdk.tooltips.relations.row_to_form'"}],staticClass:"action-button row-form skin-color skin-tooltip-right","class":[e.table.rowFormStructure===t?e.g3wtemplate.getFontClass("minus"):e.g3wtemplate.getFontClass("table")],staticStyle:{cursor:"pointer"},attrs:{"current-tooltip":e.table.rowFormStructure===t?"sdk.tooltips.relations.form_to_row":"sdk.tooltips.relations.row_to_form","data-placement":"right"},on:{click:function(r){return e.showFormStructureRow(r,t)}}}):e._e(),e._v(" "),e.isEditable?r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip",value:"Edit",expression:"'Edit'"}],staticClass:"action-button row-form skin-color skin-tooltip-right","class":e.g3wtemplate.getFontClass("pencil"),attrs:{"data-placement":"right"},on:{click:function(t){return e.editFeature(e.table.rows_fid[n])}}}):e._e()]):e._e(),e._v(" "),e.table.formStructure&&e.table.rowFormStructure===t?[r("td",{staticClass:"row-wrap-tabs",attrs:{colspan:e.table.columns.length}},[r("tabs",{attrs:{layerid:e.table.layerId,feature:e.table.features[n],fields:e.fields,tabs:e.table.formStructure}})],1)]:e._l(t,function(e){return r("td",[r("field",{attrs:{state:{value:e}}})],1)})],2)])})],2)],2),e._v(" "),r("g3w-resize",{staticClass:"skin-border-color lighten",staticStyle:{"border-style":"solid","border-width":"0 1px 0 1px"},attrs:{show:e.chart,moveFnc:e.moveFnc,where:"content"}}),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.chart,expression:"chart"}],ref:"chartcontent",style:{width:e.chart?"30%":"0",paddingBottom:"5px",marginBottom:"5px",marginLeft:"8px"},attrs:{id:"chart_content"}})],1):r("div",{directives:[{name:"t",rawName:"v-t",value:"sdk.relations.no_relations_found",expression:"'sdk.relations.no_relations_found'"}],staticClass:"dataTables_scrollBody",staticStyle:{"font-weight":"bold","margin-top":"10px","font-size":"1.1em","background-color":"#ffffff",padding:"10px"}})])},n.staticRenderFns=[]},{"components/FieldG3W.vue":244,"components/QueryResultsActionDownloadFormats.vue":315,constant:5,"core/catalog/cataloglayersstoresregistry":9,"core/utils/utils":92,"gui/gui":150,"gui/relations/vue/relationeventbus":207,"gui/vue/vue.mixins":227}],322:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var e=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();r["default"]={props:["relations","feature","loading"],methods:{showRelation:function(e){this.$parent.showRelation(e)},featureInfo:function(){var t=[],r=0;return Object.entries(this.feature.attributes).forEach(function(n){var i=e(n,2),a=i[0],o=i[1];return!(r>2)&&void(o&&_.isString(o)&&o.indexOf("/")===-1&&(t.push({key:a,value:o}),r+=1))}),t}},mounted:function(){if(1===this.relations.length){var e=this.relations[0];e.noback=!0,this.showRelation(e)}},beforeDestroy:function(){1===this.relations.length&&delete this.relations[0].noback}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"query-relations",staticStyle:{"overflow-y":"auto"}},[r("div",{staticClass:"header"},[r("div",[r("span",{directives:[{name:"t",rawName:"v-t:pre",value:"sdk.relations.list_of_relations_feature",expression:"'sdk.relations.list_of_relations_feature'",arg:"pre"}],staticStyle:{"font-size":"1.2em"}}),e._v(" "),e._l(e.featureInfo(),function(t){return r("span",[r("b",[e._v(e._s(t.key))]),e._v(": "+e._s(t.value)+" ")])})],2)]),e._v(" "),r("table",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],staticClass:"table table-striped table-hover relations-table"},[r("thead"),e._v(" "),r("tbody",e._l(e.relations,function(t){return r("tr",{staticStyle:{cursor:"pointer"},on:{click:function(r){return e.showRelation(t)}}},[r("td",{staticClass:"skin-color",staticStyle:{padding:"2px",display:"flex","justify-content":"space-between","align-items":"baseline"}},[r("span",[e._v(e._s(t.name))]),e._v(" "),r("span",{"class":e.g3wtemplate.getFontClass("arrow-right"),attrs:{"aria-hidden":"true"}})])])}),0)])])},n.staticRenderFns=[]},{}],323:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("components/Relations.vue"),a=t(i),o=e("components/Relation.vue"),s=t(o),l=e("constant"),u=e("gui/gui"),c=e("core/utils/geo"),d=c.getFeaturesFromResponseVectorApi,p=e("gui/relations/vue/relationeventbus");r["default"]={data:function(){return this.chartRelationIds=this.$options.chartRelationIds||[],{loading:!1,state:null,error:!1,table:this.$options.table?this.$options.service.buildRelationTable(this.$options.table):null,relation:this.$options.relation||null,relations:this.$options.relations,nmRelation:this.$options.nmRelation,showChartButton:!1,feature:this.$options.feature,currentview:this.$options.currentview,previousview:this.$options.currentview}},provide:function(){return{relationnoback:1===this.$options.relations.length}},components:{relations:a["default"],relation:s["default"]},methods:{saveRelations:function(e){this.$options.service.saveRelations(e)},reloadLayout:function(){p.$emit("reload")},showChart:function(e,t){var r=this.relation.referencingLayer;u.getService("queryresults").showChart([r],e,t)},hideChart:function(e){u.getService("queryresults").hideChart(e)},showRelation:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){var t,n,i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return u.setLoadingContent(!0),u.getCurrentContentTitle()===l.LIST_OF_RELATIONS_TITLE&&u.changeCurrentContentTitle(e.name),this.loading=!0,this.relation=e,t=e.referencingLayer,n=this.feature.attributes[l.G3W_FID],r.prev=6,r.next=9,this.$options.service.getRelations({layer:this.$options.layer,relation:e,fid:n});case 9:if(i=r.sent,a=d(i,{type:"result"}),!this.nmRelation){r.next=16;break}return t=this.nmRelation.referencedLayer,r.next=15,this.$options.service.getRelationsNM({nmRelation:this.nmRelation,features:a});case 15:a=r.sent;case 16:this.showChartButton=!!this.chartRelationIds.find(function(e){return e===t}),this.table=this.$options.service.buildRelationTable(a,t),this.currentview="relation",this.previousview="relations",r.next=24;break;case 22:r.prev=22,r.t0=r["catch"](6);case 24:u.setLoadingContent(!1),this.loading=!0;case 26:case"end":return r.stop()}},r,this,[[6,22]])}));return e}(),setRelationsList:function(){this.previousview="relation",this.currentview="relations",this.loading=!1}},beforeMount:function(){1===this.relations.length&&"ONE"===this.relations[0].type&&this.showRelation(this.relations[0])},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.error&&requestAnimationFrame(function(){u.popContent()}),this.error=!1;case 4:case"end":return e.stop()}},r,this)}));return e}()}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"query-relations-page"},[r(e.currentview,{ref:e.currentview,tag:"component",attrs:{loading:e.loading,previousview:e.previousview,showChartButton:e.showChartButton,relations:e.relations,relation:e.relation,nmRelation:e.nmRelation,feature:e.feature,table:e.table},on:{"save-relation":e.saveRelations,"show-chart":e.showChart,"hide-chart":e.hideChart}})],1)},n.staticRenderFns=[]},{"components/Relation.vue":321,"components/Relations.vue":322,constant:5,"core/utils/geo":89,"gui/gui":150,"gui/relations/vue/relationeventbus":207}],324:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("components/Tool.vue"),a=t(i),o=e("components/QueryBuilderSearch.vue"),s=t(o);r["default"]={data:function(){return{state:null}},components:{"g3w-tool":a["default"],"g3w-search-querybuilder":s["default"]},computed:{show:function(){return this.state.searches.length+this.state.searchtools.length+this.state.querybuildersearches.length>0}},methods:{showPanel:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$options.service.showPanel(e)},removeItem:function(e){var t=e.type,r=e.index;this.$options.service.removeItem({type:t,index:r})}},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:$(".icon-search-action").tooltip();case 3:case"end":return e.stop()}},r,this)}));return e}()}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.show?r("ul",{staticClass:"treeview-menu g3w-search g3w-tools menu-items",attrs:{id:"g3w-search"}},[e._l(e.state.searches,function(t){return r("li",{staticClass:"menu-item",on:{click:function(r){return e.showPanel(t)}}},[r("i",{"class":e.g3wtemplate.getFontClass("empty-circle")}),e._v(" "),r("span",[e._v(e._s(t.name))])])}),e._v(" "),e._l(e.state.searchtools,function(e){return r("li",[r("g3w-tool",{attrs:{tool:e}})],1)}),e._v(" "),e._l(e.state.querybuildersearches,function(t,n){return r("g3w-search-querybuilder",{key:t.id,attrs:{querybuildersearch:t},on:{"delete":function(t){return e.removeItem({type:"querybuilder",index:n})}}})})],2):e._e()},n.staticRenderFns=[]},{"components/QueryBuilderSearch.vue":312,"components/Tool.vue":336}],325:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("components/SearchSelect2.vue"),a=t(i),o=e("./SearchPanelLabel.vue"),s=t(o);r["default"]={components:{Select2:a["default"],SearchPanelLabel:s["default"]},data:function(){return{state:this.$options.service.state}},methods:{onFocus:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){var t;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!this.isMobile()){r.next=5;break}return t=$(e.target).position().top-10,r.next=4,this.$nextTick();case 4:setTimeout(function(){$(".sidebar").scrollTop(t)},500);case 5:case"end":return r.stop()}},r,this)}));return e}(),autocompleteRequest:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.$options.service.autocompleteRequest(e));case 1:case"end":return t.stop()}},r,this)}));return e}(),changeDependencyFields:function(e){var t=e.attribute,r=e.value,n=this.$options.service.getDependencies(t);return n.length?this.$options.service.fillDependencyInputs({field:t,subscribers:n,value:r}):Promise.resolve()},changeNumericInput:function(e){e.value=e.value||0===e.value?e.value:null,this.changeInput(e)},changeInput:function(e){var t=this,r=e.id,n=e.attribute,i=e.value,a=e.type;
try{i="textfield"===a||"textField"===a?i:i.trim()}catch(o){}this.$options.service.changeInput({id:r,value:i}),this.state.searching=!0,this.changeDependencyFields({attribute:n,value:i})["finally"](function(){t.state.searching=!1})},doSearch:function(e){e.preventDefault(),this.$options.service.run()}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.state.searching,expression:"state.searching"}],staticClass:"g3w-search-panel form-group"},[r("h4",{},[r("b",[e._v(e._s(e.state.title))])]),e._v(" "),e._t("tools"),e._v(" "),e._t("form",[r("form",{staticClass:"g3w-search-form"},[e._l(e.state.forminputs,function(t){return r("span",{key:t.id},["numberfield"===t.type?r("div",{staticClass:"form-group numeric"},[r("search-panel-label",{attrs:{forminput:t}}),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"forminput.value"}],staticClass:"form-control",attrs:{type:"number",min:"0",id:t.id},domProps:{value:t.value},on:{change:function(r){return e.changeNumericInput(t)},input:[function(r){r.target.composing||e.$set(t,"value",r.target.value)},function(r){return e.changeNumericInput(t)}]}})],1):"textfield"===t.type||"textField"===t.type?r("div",{staticClass:"form-group form-item-search  text"},[r("search-panel-label",{attrs:{forminput:t}}),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"forminput.value"}],staticClass:"form-control",attrs:{type:"text",id:t.id},domProps:{value:t.value},on:{focus:e.onFocus,change:function(r){return e.changeInput(t)},input:function(r){r.target.composing||e.$set(t,"value",r.target.value)}}})],1):"selectfield"===t.type||"autocompletefield"===t.type?r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.state.loading[t.options.dependance]||t.loading||t.options.disabled,expression:"state.loading[forminput.options.dependance] || (forminput.loading || forminput.options.disabled) "}],staticClass:"form-group text"},[r("search-panel-label",{attrs:{forminput:t}}),e._v(" "),t.options.dependance?r("bar-loader",{attrs:{loading:e.state.loading[t.options.dependance]||t.loading}}):e._e(),e._v(" "),r("select2",{attrs:{forminput:t,autocompleteRequest:e.autocompleteRequest},on:{"select-change":e.changeInput}})],1):e._e(),e._v(" "),t.logicop?r("div",{staticClass:"search-logicop skin-border-color"},[r("h4",[e._v(e._s(t.logicop))])]):e._e()])}),e._v(" "),r("div",{staticClass:"form-group"},[r("button",{directives:[{name:"t",rawName:"v-t",value:"dosearch",expression:"'dosearch'"}],staticClass:"sidebar-button-run btn btn-block pull-right",attrs:{id:"dosearch","data-i18n":"dosearch"},on:{click:function(t){return t.stopPropagation(),e.doSearch(t)}}})])],2)]),e._v(" "),e._t("footer")],2)},n.staticRenderFns=[]},{"./SearchPanelLabel.vue":326,"components/SearchSelect2.vue":327}],326:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("core/layers/filter/operators");r["default"]={name:"Searchpanellabel",props:{forminput:{type:Object,require:!0}},methods:{getLabelOperator:function(e){return"[ "+t.EXPRESSION_OPERATORS[e]+" ]"}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("label",{staticClass:"search-label",staticStyle:{width:"100%",display:"flex","justify-content":"space-between"},attrs:{"for":e.forminput.id}},[r("span",[e._v(e._s(e.forminput.label||e.forminput.attribute))]),e._v(" "),r("span",{staticClass:"skin-color"},[e._v(e._s(e.getLabelOperator(e.forminput.operator)))])])},n.staticRenderFns=[]},{"core/layers/filter/operators":48}],327:[function(e,t,r){!function(){function t(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=e("gui/search/constants"),a=e("gui/external/select2/options/autocomplete"),o=e("core/i18n/i18n.service"),s=(o.t,e("core/utils/utils")),l=(s.debounce,e("gui/vue/vue.mixins")),u=l.select2Mixin;r["default"]={name:"select2",props:["forminput","autocompleteRequest"],mixins:[u],methods:{emitChangeEvent:function(e){var t=$(e.target).attr("id"),r=$(e.target).attr("name"),n=e.params.data,a=n?n.id:i.ALLVALUE;this.$emit("select-change",{id:t,attribute:r,value:a,type:this.forminput.type})},_initSelect2Element:function(){var e=this,r=this.forminput,i=r.type,o=r.attribute,s=r.options,l=s.numdigaut&&!Number.isNaN(1*s.numdigaut)&&1*s.numdigaut>0&&1*s.numdigaut||2,u="autocompletefield"===i;this.select2=$(this.$el).select2(n({width:"100%",dropdownParent:$(".g3w-search-form:visible"),minimumInputLength:u&&l||0,allowClear:u,placeholder:u?"":null,ajax:u?{delay:500,transport:function(){function r(e,t,r){return n.apply(this,arguments)}var n=t(regeneratorRuntime.mark(function i(t,r,n){var a,s=t.data.q;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.autocompleteRequest({field:o,value:s});case 3:a=t.sent,r({results:a}),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),n(t.t0);case 10:case"end":return t.stop()}},i,e,[[0,7]])}));return r}()}:null},a)),this.select2.on("select2:select",function(t){e.emitChangeEvent(t)}),"autocompletefield"===this.forminput.type&&this.select2.on("select2:unselecting",function(t){e.emitChangeEvent(t)})}},watch:{"forminput.value":function(){function e(e){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$nextTick();case 2:e===i.ALLVALUE&&(this.select2.val(e),this.select2.trigger("change"));case 3:case"end":return t.stop()}},n,this)}));return e}()},created:function(){this.allvalue=i.ALLVALUE},mounted:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this._initSelect2Element();case 3:case"end":return e.stop()}},n,this)}));return e}()}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("select",{directives:[{name:"disabled",rawName:"v-disabled",value:e.forminput.options.disabled||e.forminput.loading,expression:"forminput.options.disabled || forminput.loading"}],staticClass:"form-control",attrs:{name:e.forminput.attribute,id:e.forminput.id}},e._l(e.forminput.options.values,function(t){return r("option",{key:t.value,domProps:{value:t.value}},[t.value===e.allvalue?r("span",{directives:[{name:"t",rawName:"v-t",value:"sdk.search.all",expression:"'sdk.search.all'"}]}):r("span",[e._v(e._s(t.key))])])}),0)},n.staticRenderFns=[],n._scopeId="data-v-1269cb09"},{"core/i18n/i18n.service":27,"core/utils/utils":92,"gui/external/select2/options/autocomplete":144,"gui/search/constants":209,"gui/vue/vue.mixins":227}],328:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("core/applicationstate"),i=t(n),a=e("gui/sidebar/eventbus"),o=t(a),s=e("services/sidebar"),l=t(s),u=e("core/i18n/i18n.service"),c=u.t;r["default"]={name:"Sidebar",data:function(){return{components:l["default"].state.components,panels:l["default"].stack.state.contentsdata,bOpen:!0,bPageMode:!1,header:c("main navigation"),state:l["default"].state}},computed:{disabled:function(){return i["default"].gui.sidebar.disabled},panelsinstack:function(){return this.panels.length>0},showmainpanel:function(){return this.components.length>0&&!this.panelsinstack},componentname:function(){return this.components.length?this.components.slice(-1)[0].getTitle():""},panelname:function(){var e="";return this.panels.length&&(e=this.panels.slice(-1)[0].content.getTitle()),e}},methods:{closePanel:function(){l["default"].closePanel()},closeAllPanels:function(){l["default"].closeAllPanels()}},created:function(){this.iframe=i["default"].iframe,o["default"].$on("sidebaritemclick",function(){return $(".sidebar-toggle").click()})}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("aside",{staticClass:"main-sidebar","class":{iframe:e.iframe,"g3w-disabled":e.disabled}},[e.isMobile()?e._e():r("a",{staticClass:"sidebar-aside-toggle",attrs:{href:"#","data-toggle":"offcanvas",role:"button"}},[r("i",{"class":e.g3wtemplate.getFontClass("bars")})]),e._v(" "),r("div",{staticClass:"sidebar",attrs:{id:"g3w-sidebar"}},[r("div",{attrs:{id:"disable-sidebar"}}),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.panelsinstack,expression:"panelsinstack"}],staticClass:"g3w-sidebarpanel"},[r("div",{staticStyle:{overflow:"hidden","line-height":"14px","font-size":"1.5em"},attrs:{id:"g3w-sidebarpanel-header-placeholder"}},[r("div",{staticStyle:{display:"flex"},style:{justifyContent:e.state.gui.title?"space-between":"flex-end"}},[e.state.gui.title?r("h4",{directives:[{name:"t",rawName:"v-t",value:e.state.gui.title,expression:"state.gui.title"}],staticStyle:{display:"inline-block","font-weight":"bold"}}):e._e(),e._v(" "),r("div",[e.panels.length>1?r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"back",expression:"'back'",modifiers:{create:!0}}],staticClass:"skin-tooltip-left g3w-span-button close-pane-button fa-stack",attrs:{"data-placement":"left","data-toggle":"tooltip"},on:{click:e.closePanel}},[r("i",{staticClass:"fa-stack-1x panel-button","class":e.g3wtemplate.getFontClass("circle")}),e._v(" "),r("i",{staticClass:"fa-stack-1x panel-icon","class":e.g3wtemplate.getFontClass("arrow-left")})]):e._e(),e._v(" "),r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"close",expression:"'close'",modifiers:{create:!0}}],staticClass:"skin-tooltip-left g3w-span-button close-pane-button fa-stack",attrs:{"data-placement":"left","data-toggle":"tooltip"},on:{click:e.closeAllPanels}},[r("i",{staticClass:"fa-stack-1x panel-button","class":e.g3wtemplate.getFontClass("circle")}),e._v(" "),r("i",{staticClass:"fa-stack-1x panel-icon","class":e.g3wtemplate.getFontClass("close")})])])])]),e._v(" "),r("div",{staticClass:"g3w-sidebarpanel-placeholder",attrs:{id:"g3w-sidebarpanel-placeholder"}})]),e._v(" "),r("div",{attrs:{id:"g3w-sidebarcomponents-content"}},[r("ul",{directives:[{name:"show",rawName:"v-show",value:e.showmainpanel,expression:"showmainpanel"}],staticClass:"sidebar-menu","class":{"g3w-disabled":e.state.disabled},attrs:{id:"g3w-sidebarcomponents"}})])])])},n.staticRenderFns=[],n._scopeId="data-v-42a39db7"},{"core/applicationstate":8,"core/i18n/i18n.service":27,"gui/sidebar/eventbus":214,"services/sidebar":397}],329:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("gui/sidebar/eventbus"),i=t(n),a=e("./SidebarItemAction.vue"),o=t(a);r["default"]={name:"SidebarItem",data:function(){return{info:this.$options.info||{state:null,style:null,"class":null},main:!0,component:this.$options.component,active:!1,title:"",open:!1,icon:null,iconColor:null,collapsible:null}},components:{SidebarItemAction:o["default"]},methods:{onClickItem:function(e){var t=this;this.component.isolate&&e.stopPropagation(),this.component.isolate||(this.$options.service.state.components.forEach(function(e){e!==t.component&&e.getOpen()&&e.click({open:e.isolate})}),!this.component.collapsible&&isMobile.any&&i["default"].$emit("sidebaritemclick")),this.component.setOpen(!this.component.state.open)}},created:function(){var e=this;this.component.openClose=function(){return e.$refs.anchor_click.click()}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",{directives:[{name:"show",rawName:"v-show",value:e.state.visible,expression:"state.visible"},{name:"disabled",rawName:"v-disabled",value:e.state.disabled,expression:"state.disabled"}],staticClass:"treeview sidebaritem","class":{active:e.open},attrs:{id:e.component.id}},[r("bar-loader",{attrs:{loading:e.state.loading}}),e._v(" "),r("a",{ref:"anchor_click",staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"},attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.onClickItem(t)}}},[r("div",[r("i",{"class":e.icon,style:{color:e.iconColor}}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:e.title,expression:"title"}],staticClass:"treeview-label"})]),e._v(" "),r("div",[e.info.state?r("span",{"class":e.info["class"],staticStyle:{position:"absolute",right:"5px","font-weight":"bold"},style:e.info.style,attrs:{title:e.info.tooltip}},[e._v(e._s(e.info.state))]):e._e(),e._v(" "),e._l(e.actions,function(e){return r("sidebar-item-action",{key:e.id,attrs:{action:e}})})],2),e._v(" "),e.collapsible?r("i",{staticClass:"pull-right","class":e.g3wtemplate.getFontClass("angle-left")}):e._e()]),e._v(" "),r("div",{attrs:{id:"g3w-sidebarcomponent-placeholder"}})],1)},n.staticRenderFns=[],n._scopeId="data-v-57cd13ea"},{"./SidebarItemAction.vue":330,"gui/sidebar/eventbus":214}],330:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={name:"Sidebaritemaction",props:{action:{type:Object,required:!0}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:left.create",value:e.action.tooltip,expression:"action.tooltip",arg:"left",modifiers:{create:!0}}],staticClass:"action skin-tooltip-left","class":e.action["class"],staticStyle:{"font-weight":"bold",padding:"3px"},style:e.action.style,on:{click:function(t){return t.stopPropagation(),e.action.fnc(t)}}})},n.staticRenderFns=[]},{}],331:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={data:function(){return{state:null}},mounted:function(){var e=this;this.$nextTick(function(){var t=e.$options.service.getPosition();e.$options.service.postRender(t)})}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"streetview"}})},n.staticRenderFns=[]},{}],332:[function(e,t,r){e("vueify/lib/insert-css").insert(".geometry[data-v-7c2ed9e9]{cursor:pointer}#noheaders[data-v-7c2ed9e9]{background-color:#fff;font-weight:700;margin-top:10px}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=e("components/TableBody.vue"),o=t(a),s=e("components/TableSelectRow.vue"),l=t(s),u=e("components/TableToolbar.vue"),c=t(u),d=e("components/FieldG3W.vue"),p=t(d),f=e("core/utils/utils"),h=f.debounce,v=e("gui/vue/vue.mixins"),g=v.resizeMixin,m=e("gui/gui"),y=void 0,_=[],b={pagination:{},nopagination:{}};r["default"]={name:"G3WTable",mixins:[g],data:function(){return{tableBodyComponent:null,state:null,table:null,selectedRow:null}},components:{TableBody:o["default"]},methods:{getDataFromBBOX:function(){this.$options.service.getDataFromBBOX()},toggleFilterToken:function(){this.$options.service.toggleFilterToken()},clearAllSelection:function(){this.$options.service.clearLayerSelection()},switchSelection:function(){this.$options.service.switchSelection()},selectAllRow:function(){this.state.features.length&&this.$options.service.selectAllFeatures()},_setLayout:function(){this.$options.service._setLayout()},zoomAndHighLightFeature:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!e.geometry){r.next=4;break}this.$options.service.zoomAndHighLightFeature(e,t),r.next=6;break;case 4:return r.next=6,this.$options.service.zoomAndHighLightGeometryRelationFeatures(e,t);case 6:case"end":return r.stop()}},r,this)}));return e}(),addRemoveSelectedFeature:function(e){this.$options.service.addRemoveSelectedFeature(e)},reloadLayout:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:y&&y.columns.adjust();case 3:case"end":return e.stop()}},r,this)}));return e}(),hasHeaders:function(){return!!this.state.headers.length},createdContentBody:function(){var e=this;_=_.filter(function(e){return e.$destroy(),!1});var t=y.rows().nodes();t.each(function(t,r){if($(t).css("cursor","pointer"),e.state.features.length){var n=e.state.features[r],i=!!n.geometry;$(t).addClass("feature_attribute"),n.selected&&$(t).addClass("selected"),$(t).on("click",function(){return i&&e.zoomAndHighLightFeature(n)}),$(t).on("mouseover",function(){return i&&e.zoomAndHighLightFeature(n,!1)}),$(t).children().each(function(r,i){var a=e.state.headers[r],o=void 0;if(null===a){var s=Vue.extend(l["default"]),u=new s({propsData:{feature:n}});u.$on("selected",function(t){return e.$options.service.addRemoveSelectedFeature(t)}),e.$watch(function(){return n.selected},function(e){e?$(t).addClass("selected"):$(t).removeClass("selected")}),o=u.$mount().$el}else{var c=Vue.extend(p["default"]),d=new c({propsData:{state:{value:n.attributes[a.name]}}});d.$mount(),_.push(d),o=d.$el}$(i).html(o)})}}),setTimeout(function(){return e.reloadLayout()},0)},resize:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e,t;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.$nextTick();case 2:e=$(".content").height(),t=$("#open_attribute_table  div.dataTables_scrollHeadInner").height(),$("#open_attribute_table  div.dataTables_scrollBody").height(e-t-130);case 5:case"end":return r.stop()}},r,this)}));return e}()},beforeCreate:function(){this.delayType="debounce"},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e,t,a,o,s,l=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return this.setContentKey=m.onafter("setContent",this.resize),e=function(){$(".dataTables_info, .dataTables_length").hide(),$(".dataTables_paginate").css({display:"flex","justify-content":"space-between","font-size":"0.8em","margin-top":"5px"}),$(".dataTables_filter").css("float","right"),$(".dataTables_paginate").css("margin","0")},r.next=4,this.$nextTick();case 4:this.first=!1,t={lengthMenu:this.state.pageLengths,pageLength:this.state.pageLength,scrollX:!0,processing:!1,scrollCollapse:!0,sSearch:!1,order:[1,"asc"],dom:'l<"#g3w-table-toolbar">frtip',columnDefs:[{targets:0,orderable:!1,searchable:!1,width:"1%"}]},this.state.pagination?(y=$("#open_attribute_table table").DataTable(i({},t,{columns:this.state.headers,ajax:h(function(t,r){var i=$("#open_attribute_table table tr");i.each(function(e){$(e).off("click"),$(e).off("mouseover")}),l.$options.service.getData(t).then(function(){var t=n(regeneratorRuntime.mark(function i(t){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r(t),n.next=3,l.$nextTick();case 3:l.createdContentBody(),l.isMobile()&&e();case 5:case"end":return n.stop()}},i,l)}));return function(e){return t.apply(this,arguments)}}())["catch"](function(e){})},800),serverSide:!0,deferLoading:this.state.allfeatures})),this.$options.service.on("ajax-reload",y.ajax.reload),this.changeColumn=h(function(){var e=n(regeneratorRuntime.mark(function t(e,r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:y.columns(r).search(e.target.value.trim()).draw();case 1:case"end":return t.stop()}},t,l)}));return function(t,r){return e.apply(this,arguments)}}())):(y=$("#open_attribute_table table").DataTable(i({},t,{searchDelay:600})),a=h(function(){l.$options.service.setFilteredFeature(y.rows({search:"applied"})[0])},600),b.nopagination["search.dt"]=a,y.on("search.dt",a),y.on("length.dt",function(e,t,r){l.$options.service.setAttributeTablePageLength(r)}),this.changeColumn=h(function(){var e=n(regeneratorRuntime.mark(function t(e,r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:y.columns(r).search(e.target.value.trim()).draw(),l.$options.service.setFilteredFeature(y.rows({search:"applied"})[0]);case 2:case"end":return t.stop()}},t,l)}));return function(t,r){return e.apply(this,arguments)}}())),this.isMobile()&&e(),o=Vue.extend(c["default"]),s=new o({propsData:{tools:this.state.tools,geolayer:this.state.geolayer,switchSelection:this.switchSelection,clearAllSelection:this.clearAllSelection,toggleFilterToken:this.toggleFilterToken,getDataFromBBOX:this.getDataFromBBOX}}),$("#g3w-table-toolbar").html(s.$mount().$el),this.$options.service.on("redraw",function(t){y.clear(),y.draw(!1),setTimeout(function(){y.rows.add(t),y.draw(!1),l.createdContentBody(),l.isMobile()&&e()})});case 12:case"end":return r.stop()}},r,this)}));return e}(),beforeDestroy:function(){this.$options.service.clear(),this.$options.service.off("ajax-reload"),this.$options.service.off("redraw"),m.un("setContent",this.setContentKey),y.destroy(!0),y=null}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{"margin-top":"5px"},attrs:{id:"open_attribute_table"}},[e.hasHeaders()?r("table",{ref:"attribute_table",staticClass:"table table-striped row-border compact nowrap",staticStyle:{width:"100%"},attrs:{id:"layer_attribute_table"}},[r("thead",[r("tr",[r("th"),e._v(" "),e._l(e.state.headers,function(t,n){return n>0?r("th",[r("input",{staticClass:"form-control column-search",staticStyle:{height:"25px","min-width":"40px",padding:"2px"},attrs:{type:"text",placeholder:t.name},on:{keyup:function(t){return e.changeColumn(t,n)}}})]):e._e()})],2),e._v(" "),r("tr",e._l(e.state.headers,function(t,n){return r("th",[0===n?r("span",[r("input",{staticClass:"magic-checkbox",attrs:{type:"checkbox",id:"attribute_table_select_all_rows",disabled:e.state.nofilteredrow||0===e.state.features.length},domProps:{checked:e.state.selectAll}}),e._v(" "),r("label",{staticStyle:{"margin-bottom":"0 !important"},attrs:{"for":"attribute_table_select_all_rows"},on:{"!click":function(t){return t.stopPropagation(),t.preventDefault(),e.selectAllRow(t)}}},[r("span",{staticStyle:{padding:"5px"}})])]):r("span",[e._v(e._s(t.label))])])}),0)]),e._v(" "),r("table-body",{attrs:{headers:e.state.headers,filter:e.state.tools.filter,features:e.state.features,addRemoveSelectedFeature:e.addRemoveSelectedFeature,zoomAndHighLightFeature:e.zoomAndHighLightFeature}})],1):r("div",{directives:[{name:"t",rawName:"v-t",value:"dataTable.no_data",expression:"'dataTable.no_data'"}],attrs:{id:"noheaders"}})])},n.staticRenderFns=[],n._scopeId="data-v-7c2ed9e9"},{"components/FieldG3W.vue":244,"components/TableBody.vue":333,"components/TableSelectRow.vue":334,"components/TableToolbar.vue":335,"core/utils/utils":92,"gui/gui":150,"gui/vue/vue.mixins":227,"vueify/lib/insert-css":2}],333:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("components/TableSelectRow.vue"),i=t(n),a=e("components/FieldG3W.vue"),o=t(a);r["default"]={name:"table-body",props:{headers:{required:!0,type:Array},features:{required:!0,type:Array},zoomAndHighLightFeature:{type:Function},addRemoveSelectedFeature:{type:Function},filter:{type:Object,"default":{active:!1}}},data:function(){return{selectedRow:null}},components:{Field:o["default"],SelectRow:i["default"]},methods:{getField:function(e,t){return{value:e.attributes[t.name],label:void 0}}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("tbody",{attrs:{id:"table_body_attributes"}},e._l(e.features,function(t,n){return r("tr",{key:t.id,staticClass:"feature_attribute","class":[n%2==1?"odd":"pair",{geometry:!!t.geometry},{selected:t.selected}],staticStyle:{cursor:"pointer"},attrs:{role:"row",selected:e.selectedRow===n},on:{mouseover:function(r){return e.zoomAndHighLightFeature(t,!1)},click:function(r){return e.zoomAndHighLightFeature(t,!0)}}},e._l(e.headers,function(n,i){return r("td",{attrs:{"tab-index":1}},[0===i?r("select-row",{attrs:{feature:t},on:{selected:e.addRemoveSelectedFeature}}):r("field",{attrs:{feature:t,state:e.getField(t,n)}})],1)}),0)}),0)},n.staticRenderFns=[],n._scopeId="data-v-4367c62b"},{"components/FieldG3W.vue":244,"components/TableSelectRow.vue":334}],334:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("core/utils/utils"),n=t.getUniqueDomId;r["default"]={name:"select-row",props:{feature:{required:!0}},data:function(){return{id:n()}},methods:{select:function(){this.$emit("selected",this.feature)}},destroyed:function(){this.$off("selected")}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("span",[r("input",{staticClass:"magic-checkbox",attrs:{type:"checkbox",id:e.id},domProps:{checked:e.feature.selected}}),e._v(" "),r("label",{attrs:{"for":e.id},on:{"!click":function(t){return t.stopPropagation(),t.preventDefault(),e.select(t)}}},[r("span")])])},n.staticRenderFns=[],n._scopeId="data-v-709a9af6"},{"core/utils/utils":92}],335:[function(e,t,r){e("vueify/lib/insert-css").insert(".action-button[data-v-3490dc02]{padding:4px}.action-button.toggled[data-v-3490dc02]{border:1px solid #ccc}");!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("core/applicationstate"),i=t(n);r["default"]={name:"g3w-table-toolbar",props:{tools:{type:Object},switchSelection:{type:Function},clearAllSelection:{type:Function},toggleFilterToken:{type:Function},getDataFromBBOX:{type:Function}},computed:{disableMapTool:function(){return!this.tools.geolayer.active&&i["default"].gui.layout[i["default"].gui.layout.__current].rightpanel.height_100}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{display:"flex","justify-content":"space-between",padding:"1px"}},[e.tools.geolayer.show?r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.disableMapTool,expression:"disableMapTool"},{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"layer_selection_filter.tools.show_features_on_map",expression:"'layer_selection_filter.tools.show_features_on_map'",modifiers:{create:!0}}],staticClass:"skin-color action-button skin-tooltip-right","class":[e.g3wtemplate.getFontClass("map"),e.tools.geolayer.active?"toggled":""],attrs:{"data-placement":"right","data-toggle":"tooltip"},on:{click:function(t){return t.stopPropagation(),e.getDataFromBBOX(t)}}}):e._e(),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.tools.show,expression:"tools.show"},{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"layer_selection_filter.tools.clear",expression:"'layer_selection_filter.tools.clear'",modifiers:{create:!0}}],staticClass:"skin-color action-button skin-tooltip-right","class":e.g3wtemplate.getFontClass("clear"),attrs:{"data-placement":"right","data-toggle":"tooltip"},on:{click:function(t){return t.stopPropagation(),e.clearAllSelection(t)}}}),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.tools.show,expression:"tools.show"},{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"layer_selection_filter.tools.invert",expression:"'layer_selection_filter.tools.invert'",modifiers:{create:!0}}],staticClass:"skin-color action-button skin-tooltip-right","class":[e.g3wtemplate.getFontClass("invert"),e.tools.filter.active?"g3w-disabled":""],attrs:{"data-placement":"right","data-toggle":"tooltip"},on:{click:function(t){return t.stopPropagation(),e.switchSelection(t)}}}),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.tools.show,expression:"tools.show"},{name:"t-tooltip",rawName:"v-t-tooltip.create",value:"layer_selection_filter.tools.filter",expression:"'layer_selection_filter.tools.filter'",modifiers:{create:!0}}],staticClass:"skin-color action-button skin-tooltip-right","class":[e.g3wtemplate.getFontClass("filter"),e.tools.filter.active?"toggled":""],attrs:{"data-placement":"right","data-toggle":"tooltip"},on:{click:function(t){return t.stopPropagation(),e.toggleFilterToken(t)}}})])},n.staticRenderFns=[],n._scopeId="data-v-3490dc02"},{"core/applicationstate":8,"vueify/lib/insert-css":2}],336:[function(e,t,r){e("vueify/lib/insert-css").insert(".tool_disabled[data-v-303c314d]{cursor:not-allowed}.tool_disabled>span[data-v-303c314d]{color:#777}");!function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e("core/applicationservice").getState(),n=e("gui/gui"),i={alert:{color:"red"},info:{color:"blue"},warning:{color:"orange"}};r["default"]={name:"g3w-tool",props:{tool:{required:!0}},data:function(){return{}},methods:{fireAction:function(e){this.tool.action(e)},showToolStateMessage:function(){n.showModalDialog({title:this.tool.state.type.toUpperCase(),message:this.tool.state.message})}},computed:{disabled:function(){return!this.tool.offline&&!t.online||this.tool.loading||this.tool.disabled},icon:function(){return this.tool.icon||"caret-right"},toolstatecolor:function(){return i[this.tool.state.type].color}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",["checkbox"===e.tool.type?r("div",{staticClass:"checkbox"},[r("label",[r("input",{directives:[{name:"model",rawName:"v-model",value:e.tool.isCheck,expression:"tool.isCheck"}],staticStyle:{cursor:"pointer"},attrs:{id:e.tool.layerName,type:"checkbox"},domProps:{value:e.tool.layerName,checked:Array.isArray(e.tool.isCheck)?e._i(e.tool.isCheck,e.tool.layerName)>-1:e.tool.isCheck},on:{click:function(t){return e.fireAction(e.tool)},change:function(t){var r=e.tool.isCheck,n=t.target,i=!!n.checked;if(Array.isArray(r)){var a=e.tool.layerName,o=e._i(r,a);n.checked?o<0&&e.$set(e.tool,"isCheck",r.concat([a])):o>-1&&e.$set(e.tool,"isCheck",r.slice(0,o).concat(r.slice(o+1)))}else e.$set(e.tool,"isCheck",i)}}}),e._v("\n      "+e._s(e.tool.name)+"\n    ")])]):r("div",{
staticClass:"tool","class":{tool_disabled:e.disabled},staticStyle:{position:"relative"},on:{click:function(t){e.disabled?null:e.fireAction(e.tool)}}},[r("bar-loader",{attrs:{loading:e.tool.loading}}),e._v(" "),r("i",{"class":e.g3wtemplate.getFontClass(e.icon)}),e._v(" "),e.tool.html?r("span",[r("i",{"class":e.tool.html.icon}),e._v("\n      "+e._s(e.tool.html.text||e.tool.name)+"\n    ")]):r("span",{directives:[{name:"t",rawName:"v-t",value:e.tool.name,expression:"tool.name"}]}),e._v(" "),e.tool.state.type?r("span",{staticStyle:{cursor:"pointer","vertical-align":"center",position:"absolute",right:"0",top:"0",padding:"5px"},style:{color:e.toolstatecolor},on:{click:function(t){return t.stopPropagation(),e.showToolStateMessage(t)}}},[r("i",{"class":e.g3wtemplate.getFontClass(e.tool.state.type)})]):e._e()],1)])},n.staticRenderFns=[],n._scopeId="data-v-303c314d"},{"core/applicationservice":7,"gui/gui":150,"vueify/lib/insert-css":2}],337:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("components/Tool.vue"),i=t(n);r["default"]={data:function(){return{state:null}},watch:{"state.toolsGroups":{handler:function(e){this.$emit("visible",e.length>0)}}},components:{G3wTool:i["default"]}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ul",{staticClass:"g3w-tools treeview-menu"},[r("bar-loader",{attrs:{loading:e.state.loading}}),e._v(" "),e._l(e.state.toolsGroups,function(t){return r("li",{key:t.name},[r("div",{staticClass:"tool-header"},[r("i",{"class":e.g3wtemplate.getFontClass("tool")}),e._v(" "),r("span",{},[e._v(e._s(t.name))])]),e._v(" "),r("div",{staticClass:"tool-box",attrs:{id:t.name+"-tools"}},e._l(t.tools,function(e){return r("g3w-tool",{key:e.name,attrs:{tool:e}})}),1)])})],2)},n.staticRenderFns=[]},{"components/Tool.vue":336}],338:[function(e,t,r){e("vueify/lib/insert-css").insert(".usermessage-content[data-v-ff9caad2]{color:#fff;z-index:1000;position:absolute;line-height:normal;padding:3px;min-width:250px;box-shadow:0 3px 5px rgba(0,0,0,.3);-moz-box-shadow:0 3px 5px rgba(0,0,0,.3)}.usermessage-content.mobile[data-v-ff9caad2]{padding:0;min-width:100%}.usermessage-header-content[data-v-ff9caad2]{display:flex;align-items:baseline;justify-content:space-between;width:100%}.usermessage-header-icontype[data-v-ff9caad2]{padding:10px 0 0 5px;font-weight:700;font-size:1.3em}.usermessage-content.mobile .usermessage-header-icontype[data-v-ff9caad2]{padding:0 0 0 5px;font-size:1.1em}.usermessage-header-title[data-v-ff9caad2],.usermessage-header-title h4[data-v-ff9caad2]{font-weight:700;text-align:center}.usermessage-content.mobile .usermessage-header-title h4[data-v-ff9caad2]{margin:3px}.usermessage-header-right[data-v-ff9caad2]{padding:5px}.usermessage-header-right-item[data-v-ff9caad2]{font-weight:700!important;font-size:1.2em;cursor:pointer}.usermessage-message[data-v-ff9caad2]{width:100%;padding:0 0 3px 10px;max-height:100px;font-size:1.1em;align-self:flex-start;overflow-y:auto}");!function(){function t(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(r,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=e("gui/gui"),s={success:{backgroundColor:"#62ac62",color:"#FFFFFF"},info:{backgroundColor:"#44a0bb",color:"#FFFFFF"},warning:{backgroundColor:"#f29e1d",color:"#FFFFFF"},alert:{backgroundColor:"#c34943",color:"#FFFFFF"},tool:{backgroundColor:"#FFFFFF",color:"#222d32"},loading:{backgroundColor:"#FFFFFF",color:"#222d32",fontWeight:"bold"}};r["default"]={name:"usermessage",props:{id:{},type:{type:String,"default":"info"},title:{type:String,"default":null},position:{type:String,"default":"top"},size:{type:"String","default":"fullpage"},message:{type:String,"default":""},textMessage:{type:Boolean,"default":!1},autoclose:{type:Boolean,"default":!1},draggable:{type:Boolean,"default":!1},duration:{type:Number,"default":2e3},closable:{type:Boolean,"default":!0}},computed:{showheader:function(){return"loading"!==this.type}},methods:{addClassMobile:function(){return this.isMobile()&&!o.isSidebarVisible()},closeUserMessage:function(){this.$emit("close-usermessage")},hideShow:function(){}},created:function(){var e=this.position.split("-"),t=a(e,2),r=t[0],o=t[1],l="100%";switch(this.size){case"small":l="25%";break;case"medium":l="50%";break;case"fullpage":default:l="100%"}r="center"===r?{top:0,bottom:0,maxHeight:"20%"}:n({},r,50);var u=i({},r,{width:l});if(o)switch(u.width="25%",o){case"center":u.left="0",u.right="0",u.margin="auto";break;case"right":u.right=0}this.style=i({},s[this.type],u)},mounted:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(){var e,t=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!this.autoclose){r.next=4;break}return r.next=3,this.$nextTick();case 3:e=setTimeout(function(){t.closeUserMessage(),clearTimeout(e)},this.duration);case 4:case"end":return r.stop()}},n,this)}));return e}()}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"usermessage-content","class":{mobile:e.addClassMobile()},style:e.style,attrs:{id:e.id}},[e.showheader?r("div",{staticClass:"usermessage-header-content"},[r("i",{staticClass:"usermessage-header-icontype","class":e.g3wtemplate.getFontClass(e.type)}),e._v(" "),r("div",{staticClass:"usermessage-header-title"},[e._t("header",[e.title?r("h4",{directives:[{name:"t",rawName:"v-t",value:e.title,expression:"title"}]}):r("h4",[e._v(" "+e._s(e.type.toUpperCase()))])])],2),e._v(" "),r("div",{staticClass:"usermessage-header-right"},[!e.autoclose&&e.closable?r("div",{on:{click:e.closeUserMessage}},[r("i",{staticClass:"usermessage-header-right-item","class":e.g3wtemplate.getFontClass("close")})]):e._e()])]):e._e(),e._v(" "),e._t("body",[e.textMessage?r("div",{staticClass:"usermessage-message"},[e._v(e._s(e.message))]):r("div",{directives:[{name:"t",rawName:"v-t",value:e.message,expression:"message"}],staticClass:"usermessage-message"})]),e._v(" "),e._t("footer")],2)},n.staticRenderFns=[],n._scopeId="data-v-ff9caad2"},{"gui/gui":150,"vueify/lib/insert-css":2}],339:[function(e,t,r){!function(){function t(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(r,"__esModule",{value:!0});var a=e("components/UserMessage.vue"),o=t(a),s=e("components/NotifyOnline.vue"),l=t(s),u=e("components/NotifyDownload.vue"),c=t(u),d=e("components/NotifyPlugins.vue"),p=t(d),f=e("gui/constraints"),h=e("services/viewport"),v=t(h),g=e("gui/gui");r["default"]={name:"Viewport",props:{appState:{type:Object}},components:{userMessage:o["default"],onlineNotify:l["default"],downloadNotify:c["default"],pluginsNotify:p["default"]},data:function(){return{state:v["default"].state,updatePreviousTitle:!1,media:{matches:!0}}},computed:{showresize:function(){var e=v["default"].getCurrentContentLayout()["h"===this.state.split?"width":"height"];return this.state.resized.start&&this.state.secondaryPerc>0&&this.state.secondaryPerc<100&&e<100&&e>0},showresizeicon:function(){return 100!==this.state.secondaryPerc},hooks:function(){return this.usermessage.hooks},usermessage:function(){return this.state.usermessage},showtitle:function m(){var m=!0,e=this.state.content.contentsdata;if(e.length){var t=e[e.length-1].options;_.isBoolean(t.showtitle)&&(m=t.showtitle)}return m},showContent:function(){return this.state.content.show},styles:function(){return{map:{width:this.state.map.sizes.width+"px",height:this.state.map.sizes.height+"px"},content:{width:this.state.content.sizes.width+"px",height:this.state.content.sizes.height+"px",minHeight:"v"===this.state.split?f.viewport.resize.content.min+"px":null}}},contentTitle:function(){var e=this.state.content.contentsdata;if(e.length){var t=e[e.length-1].options,r=t.title,n=t.post_title;return{title:r,post_title:n}}},backOrBackTo:function(){var e=this.state.content.contentsdata;return!!(e.length>1&&this.state.content.showgoback)&&(e[e.length-2].options.title?"backto":"back")},previousTitle:function(){var e=this,t=this.state.content.contentsdata,r=t.length>1&&this.state.content.showgoback?t[t.length-2].options.title:null;return this.updatePreviousTitle=!0,this.$nextTick(function(){return e.updatePreviousTitle=!1}),r}},methods:{closeContent:function(){g.closeContent()},closeMap:function(){v["default"].closeMap()},gotoPreviousContent:function(){v["default"].popContent()},closeUserMessage:function(){v["default"].closeUserMessage()},moveFnc:function(e){var t="h"===this.state.split?"width":"height";e.preventDefault();var r="width"===t?$(".sidebar-collapse").length?0:v["default"].SIDEBARWIDTH:$("#main-navbar").height(),n=$(this.$el)[t](),a=("width"===t?e.pageX+2:e.pageY+2)-r;a>n-f.viewport.resize.content.min?a=n-f.viewport.resize.content.min:a<f.viewport.resize.map.min&&(a=f.viewport.resize.map.min);var o=n-a,s=Math.round(a/n*100),l=100-s;v["default"].resizeViewComponents(this.state.split,{map:i({},t,a),content:i({},t,o)},l)}},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e,t,n=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=function(){n.state.resized.start=!0},r.next=3,this.$nextTick();case 3:t=window.matchMedia("(min-height: 300px)"),this.media.matches=t.matches,t.addListener(function(e){"change"===e.type&&(n.media.matches=e.currentTarget.matches)}),e();case 7:case"end":return r.stop()}},r,this)}));return e}()}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"g3w-viewport"},[r("transition",{attrs:{name:"fade",duration:{enter:500,leave:500}}},[e.usermessage.show?r("user-message",{attrs:{title:e.usermessage.title,id:e.usermessage.id,message:e.usermessage.message,draggable:e.usermessage.draggable,closable:e.usermessage.closable,duration:e.usermessage.duration,position:e.usermessage.position,autoclose:e.usermessage.autoclose,textMessage:e.usermessage.textMessage,size:e.usermessage.size,type:e.usermessage.type},on:{"close-usermessage":e.closeUserMessage}},[e.hooks.header?r("template",{slot:"header"},[r(e.hooks.header,{tag:"component"})],1):e._e(),e._v(" "),e.hooks.body?r("template",{slot:"body"},[r(e.hooks.body,{tag:"component"})],1):e._e(),e._v(" "),e.hooks.footer?r("template",{slot:"footer"},[r(e.usermessage.hooks.footer,{tag:"component"})],1):e._e()],2):e._e()],1),e._v(" "),r("div",{staticClass:"g3w-view map","class":"split-"+e.state.split,style:e.styles.map,attrs:{id:"g3w-view-map"}},[r("g3w-resize",{"class":"split-"+e.state.split,style:{backgroundColor:"transparent"},attrs:{id:"resize-map-and-content",show:e.showresize,moveFnc:e.moveFnc,orientation:e.state.split}}),e._v(" "),r("div",{attrs:{id:"application-notifications"}},[r("online-notify"),e._v(" "),r("download-notify"),e._v(" "),r("plugins-notify")],1)],1),e._v(" "),r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.state.content.disabled,expression:"state.content.disabled"}],staticClass:"g3w-view content","class":"split-"+e.state.split,style:e.styles.content,attrs:{id:"g3w-view-content"}},[e.showtitle&&e.contentTitle||e.previousTitle||e.state.content.closable&&e.state.content.aside?r("div",{staticClass:"close-panel-block",staticStyle:{display:"flex","justify-content":"space-between"}},[e.previousTitle?r("div",{staticClass:"g3w_contents_back"},["back"===e.backOrBackTo?r("div",{"class":e.backOrBackTo},[r("span",{staticClass:"action-button","class":e.g3wtemplate.getFontClass("back")}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"back",expression:"'back'"}]})]):r("div",{"class":e.backOrBackTo,on:{click:function(t){return e.gotoPreviousContent()}}},[r("span",{staticClass:"action-button","class":e.g3wtemplate.getFontClass("back")}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:"backto",expression:"'backto'"}]}),e._v(" "),e.updatePreviousTitle?e._e():r("span",{directives:[{name:"t",rawName:"v-t",value:e.previousTitle,expression:"previousTitle"}]})])]):e._e(),e._v(" "),!e.previousTitle&&e.showtitle&&e.contentTitle?r("div",{staticClass:"panel-title","class":{mobile:e.isMobile()},style:[e.state.content.style.title]},[r("span",{attrs:{id:"contenttitle"}},[r("span",{directives:[{name:"t",rawName:"v-t",value:e.contentTitle.title,expression:"contentTitle.title"}]}),e._v(" "),r("span",{directives:[{name:"t",rawName:"v-t",value:e.contentTitle.post_title,expression:"contentTitle.post_title"}]})])]):e._e(),e._v(" "),r("div",{staticClass:"g3-content-header-action-tools",staticStyle:{display:"flex"}},[e._l(e.state.content.headertools,function(e){return r(e,{tag:"component"})}),e._v(" "),e.showresizeicon?r("resize-icon",{staticStyle:{"font-size":"1em",padding:"0","align-self":"center","margin-left":"auto"},style:{marginRight:e.state.content.closable?"5px":"0px"},attrs:{type:e.state.split}}):e._e(),e._v(" "),e.state.content.closable&&e.state.content.aside?r("span",{staticClass:"action-button","class":{mobile:e.isMobile()},staticStyle:{display:"flex","justify-content":"center"},on:{click:e.closeContent}},[r("i",{staticClass:"skin-color-dark","class":e.g3wtemplate.getFontClass("close")})]):e._e()],2)]):e._e(),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.state.content.loading,expression:"state.content.loading"}],staticClass:"bar-loader"})])],1)},n.staticRenderFns=[],n._scopeId="data-v-209fb2db"},{"components/NotifyDownload.vue":303,"components/NotifyOnline.vue":304,"components/NotifyPlugins.vue":305,"components/UserMessage.vue":338,"gui/constraints":143,"gui/gui":150,"services/viewport":399}],340:[function(e,t,r){!function(){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={data:function(){return{state:null}}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"contents",attrs:{id:"contents"}})},n.staticRenderFns=[]},{}],341:[function(e,t,r){e("vueify/lib/insert-css").insert(".g3w-add-wms-url-message[data-v-438e4bb8]{font-weight:700;color:#000}.g3w-wmsurl-error[data-v-438e4bb8]{background-color:red}.g3w-wmsurl-already-added[data-v-438e4bb8]{background-color:orange}");!function(){function t(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("core/utils/utils"),i=n.isURL;r["default"]={name:"sidebaritem",data:function(){return{newwmsurl:null,loading:!1,status:{error:!1,added:!1}}},computed:{newwmsurlvalid:function(){return null!==this.newwmsurl&&this.newwmsurl.trim()&&i(this.newwmsurl)}},methods:{addNewWmsUrl:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(){var e,t,r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.loading=!0,n.next=3,this.$options.service.addNewWmsUrl(this.newwmsurl);case 3:e=n.sent,t=e.error,r=e.added,this.status.error=t,this.status.added=r,this.loading=!1;case 9:case"end":return n.stop()}},n,this)}));return e}(),deleteWmsUrl:function(e){this.$options.service.deleteWmsUrl(e)},showWmsLayersPanel:function(){function e(e){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(e){var t,r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,this.loading=!0,n.next=4,this.$options.service.loadWMSDataAndShowWmsLayersPanel(e);case 4:t=n.sent,r=t.error,i=t.added,this.status.error=r,this.status.added=i,this.loading=!1,n.next=15;break;case 12:n.prev=12,n.t0=n["catch"](0);case 15:case"end":return n.stop()}},n,this,[[0,12]])}));return e}()}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ul",{staticClass:"treeview-menu g3w-tools menu-items"},[e.loading?r("li",[r("bar-loader",{attrs:{loading:e.loading}})],1):e._e(),e._v(" "),r("li",{staticStyle:{display:"flex","justify-content":"space-between",background:"transparent !important","margin-bottom":"10px"}},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.newwmsurl,expression:"newwmsurl"}],staticClass:"form-control",staticStyle:{"flex-grow":"1",color:"#000000"},domProps:{value:e.newwmsurl},on:{input:function(t){t.target.composing||(e.newwmsurl=t.target.value)}}}),e._v(" "),r("button",{directives:[{name:"disabled",rawName:"v-disabled",value:!e.newwmsurlvalid,expression:"!newwmsurlvalid"}],staticClass:"btn btn-block skin-background-color",staticStyle:{width:"50px","border-radius":"0"},on:{click:function(t){return t.stopPropagation(),e.addNewWmsUrl(t)}}},[r("i",{"class":e.g3wtemplate.getFontClass("plus-square")})])]),e._v(" "),e.status.error?r("li",[r("div",{directives:[{name:"t",rawName:"v-t",value:"server_error",expression:"'server_error'"}],staticClass:"g3w-add-wms-url-message g3w-wmsurl-error"})]):e.status.added?r("li",[r("div",{directives:[{name:"t",rawName:"v-t",value:"sidebar.wms.url_already_added",expression:"'sidebar.wms.url_already_added'"}],staticClass:"g3w-add-wms-url-message g3w-wmsurl-already-added"})]):e._e(),e._v(" "),r("li",{staticStyle:{background:"transparent !important"}},[r("div",{staticStyle:{"max-height":"200px","overflow-y":"auto"}},[e._l(e.state.adminwmsurls,function(t){return r("div",{key:t,staticStyle:{display:"flex","justify-content":"space-between","align-items":"center","border-bottom":"1px solid #cccccc","padding-bottom":"3px"}},[r("span",{staticClass:"new_line_too_long_text",staticStyle:{"flex-grow":"1","margin-right":"15px"},attrs:{title:t}},[e._v(e._s(t))]),e._v(" "),r("span",{staticClass:"skin-color",staticStyle:{padding:"5px"},on:{click:function(r){return r.stopPropagation(),e.showWmsLayersPanel(t)}}},[r("i",{"class":e.g3wtemplate.getFontClass("plus-square"),staticStyle:{"font-weight":"bold","font-size":"1.3em"}})])])}),e._v(" "),e._l(e.state.localwmsurls,function(t){return r("div",{key:t,staticStyle:{display:"flex","justify-content":"space-between","align-items":"center","border-bottom":"1px solid #cccccc","padding-bottom":"3px"}},[r("span",{staticClass:"new_line_too_long_text",staticStyle:{"flex-grow":"1","margin-right":"15px"},attrs:{title:t}},[e._v(e._s(t))]),e._v(" "),r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top.create",value:"sidebar.wms.add_wms_layer",expression:"'sidebar.wms.add_wms_layer'",arg:"top",modifiers:{create:!0}}],staticClass:"skin-color",staticStyle:{padding:"5px"},on:{click:function(r){return r.stopPropagation(),e.showWmsLayersPanel(t)}}},[r("i",{"class":e.g3wtemplate.getFontClass("plus-square"),staticStyle:{"font-weight":"bold","font-size":"1.3em"}})]),e._v(" "),r("span",{directives:[{name:"t-tooltip",rawName:"v-t-tooltip:top.create",value:"sidebar.wms.delete_wms_url",expression:"'sidebar.wms.delete_wms_url'",arg:"top",modifiers:{create:!0}}],staticStyle:{color:"red",padding:"5px"},on:{click:function(r){return r.stopPropagation(),e.deleteWmsUrl(t)}}},[r("i",{"class":e.g3wtemplate.getFontClass("trash"),staticStyle:{"font-weight":"bold","font-size":"1.3em",color:"red"}})])])})],2)])])},n.staticRenderFns=[],n._scopeId="data-v-438e4bb8"},{"core/utils/utils":92,"vueify/lib/insert-css":2}],342:[function(e,t,r){e("vueify/lib/insert-css").insert(".g3w-wms-panel-title[data-v-0f3e5a3a]{font-size:1.2em;font-weight:700;margin-bottom:10px}button.wms-add-layer-buttom[data-v-0f3e5a3a]{width:100%;margin-top:10px}.g3w-wms-external-panel-layer-added-message[data-v-0f3e5a3a]{font-weight:700;color:red;margin:5px 0}");!function(){function t(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("g3w-ol/projection/projections");r["default"]={name:"wmpspanel",data:function(){return{loading:!1,position:void 0,name:void 0,title:null,"abstract":null,map_formats:[],info_formats:[],layers:[],selectedlayers:[],projections:[],epsg:null,added:!1}},methods:{addWMSlayer:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e={url:this.url,name:this.name&&this.name.trim()||void 0,layers:this.selectedlayers,epsg:this.epsg,position:this.position},this.added=this.$options.service.checkIfWMSAlreadyAdded(e),this.added){t.next=13;break}return this.loading=!0,t.prev=4,t.next=7,this.$options.service.addWMSlayer(e);case 7:t.next=11;break;case 9:t.prev=9,t.t0=t["catch"](4);case 11:this.loading=!1,this.clear();case 13:case"end":return t.stop()}},n,this,[[4,9]])}));return e}(),clear:function(){this.selectedlayers=[],this.name=null},filterLayerByCurrentEpsg:function(){var e=this;this.layers=null!==this.epsg?this.layers.filter(function(t){var r=t.name;return e.layerProjections[r].crss.indexOf(e.epsg)!==-1}):this.$options.config.layers}},watch:{selectedlayers:function(e){var t=this;if(e.length){var r=e[0];1===e.length?(this.epsg=this.layerProjections[r].crss[0],this.projections=this.layerProjections[r].crss):this.projections=this.projections.filter(function(r){return t.layerProjections[e[e.length-1]].crss.index(r)!==-1})}else this.epsg=null,this.projections=[]},epsg:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.filterLayerByCurrentEpsg();case 3:case"end":return e.stop()}},n,this)}));return e}()},created:function(){function e(){return r.apply(this,arguments)}var r=t(regeneratorRuntime.mark(function i(){var e,t,r,a,o,s=this;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:e=this.$options.config,t=e.layers,r=e.title,a=e["abstract"],o=e.wmsurl,this.layerProjections={},this.url=o,t.forEach(function(e){s.layerProjections[e.name]={crss:e.crss.map(function(e){return n.get(e),"EPSG:"+e.epsg}).sort(),title:e.title}}),this.layers=t,this.title=r,this["abstract"]=a;case 7:case"end":return i.stop()}},i,this)}));return e}(),beforeDestroy:function(){this.$data=null}}}(),t.exports.__esModule&&(t.exports=t.exports["default"]);var n="function"==typeof t.exports?t.exports.options:t.exports;n.render=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"disabled",rawName:"v-disabled",value:e.loading,expression:"loading"}]},[r("bar-loader",{attrs:{loading:e.loading}}),e._v(" "),r("h3",{staticClass:"skin-color g3w-wms-panel-title"},[e._v(e._s(e.title))]),e._v(" "),e["abstract"]?r("helpdiv",{attrs:{message:e["abstract"]}}):e._e(),e._v(" "),r("label",{directives:[{name:"t",rawName:"v-t",value:"sidebar.wms.panel.label.layers",expression:"'sidebar.wms.panel.label.layers'"}],attrs:{"for":"g3w-wms-layers"}}),e._v(" "),r("select",{directives:[{name:"select2",rawName:"v-select2",value:"selectedlayers",expression:"'selectedlayers'"}],attrs:{id:"g3w-wms-layers",multiple:"multiple",clear:"true"}},e._l(e.layers,function(t){return r("option",{key:t.name,domProps:{value:t.name}},[e._v(e._s(t.title))])}),0),e._v(" "),r("label",{directives:[{name:"t",rawName:"v-t",value:"sidebar.wms.panel.label.projections",expression:"'sidebar.wms.panel.label.projections'"}],attrs:{"for":"g3w-wms-projections"}}),e._v(" "),r("select",{directives:[{name:"select2",rawName:"v-select2",value:"epsg",expression:"'epsg'"}],attrs:{id:"g3w-wms-projections"}},e._l(e.projections,function(t){return r("option",{key:t,domProps:{value:t}},[e._v(e._s(t))])}),0),e._v(" "),r("label",{directives:[{name:"t",rawName:"v-t",value:"sidebar.wms.panel.label.name",expression:"'sidebar.wms.panel.label.name'"}],attrs:{"for":"g3w-wms-layer-name"}}),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],staticClass:"form-control",attrs:{id:"g3w-wms-layer-name"},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}}),e._v(" "),e.added?r("div",{directives:[{name:"t",rawName:"v-t",value:"sidebar.wms.layer_id_already_added",expression:"'sidebar.wms.layer_id_already_added'"}],staticClass:"g3w-wms-external-panel-layer-added-message"}):e._e(),e._v(" "),r("layerspositions",{attrs:{position:e.position},on:{"layer-position-change":function(t){e.position=t}}}),e._v(" "),r("button",{directives:[{name:"disabled",rawName:"v-disabled",value:0===e.selectedlayers.length,expression:"selectedlayers.length === 0"}],staticClass:"btn wms-add-layer-buttom sidebar-button skin-button",on:{click:function(t){return t.stopPropagation(),e.addWMSlayer(t)}}},[r("i",{"class":e.g3wtemplate.getFontClass("plus-square"),staticStyle:{"font-weight":"bold"}})])],1)},n.staticRenderFns=[],n._scopeId="data-v-0f3e5a3a"},{"g3w-ol/projection/projections":135,"vueify/lib/insert-css":2}],343:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("app/config"),a=n(i);r["default"]=a["default"]},{"app/config":4}],344:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("core/utils/utils"),i=n.uniqueId,a=new Vue,o={};r.watch=function(e){var t=e.el,r=e.attr,n=e.watcher,s=i();t.setAttribute(r,s);var l=o[s]={};return n&&(l.unwatch=a.$watch(n[0],n[1],n[2]||{immediate:!0}),l.handler=n[1]),s},r.unwatch=function(e){var t=e.el,r=e.attr,n=t.getAttribute(r);n&&(o[n].unwatch(),delete o[n])},r.trigger=function(e){var t=e.el,r=e.attr,n=e.data;return o[t.getAttribute(r)](n)}},{"core/utils/utils":92}],345:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=function(e,t){t.value?e.setAttribute("checked","checked"):e.removeAttribute("checked")}},{}],346:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=function(e,t){e.classList.toggle("g3w-disabled",t.value)}},{}],347:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/applicationstate"),a=n(i),o=e("directives/utils"),s="g3w-v-download-id";r["default"]={bind:function(e,t){("boolean"!=typeof t.value||t.value)&&(0,o.watch)({el:e,attr:s,watcher:[function(){return a["default"].download},function(r){var n=t.modifiers&&t.modifiers.show&&"hide"||"disabled";e.classList.toggle("g3w-"+n,"hide"===n?!r:r)}]})},unbind:function(e){return(0,o.unwatch)({el:e,attr:s})}}},{"core/applicationstate":8,"directives/utils":344}],348:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/applicationstate"),a=n(i),o=e("directives/utils"),s="g3w-v-offline-id";r["default"]={bind:function(e,t){(0,o.watch)({el:e,attr:s,watcher:[function(){return a["default"].online},function(r){r=t.arg&&"hide"===t.arg?!r:r,e.classList.toggle("g3w-hide",!r)}]})},unbind:function(e){return(0,o.unwatch)({el:e,attr:s})}}},{"core/applicationstate":8,"directives/utils":344}],349:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/applicationstate"),a=n(i),o=e("directives/utils"),s="g3w-v-plugins-id";r["default"]={bind:function(e){(0,o.watch)({el:e,attr:s,watcher:[function(){return a["default"].plugins},function(t){e.classList.toggle("g3w-hide",0===t.length)}]})},unbind:function(e){return(0,o.unwatch)({el:e,attr:s})}}},{"core/applicationstate":8,"directives/utils":344}],350:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={inserted:function(e,t,r){var n=r.data.attrs||{},i=n.templateResult,a=n.templateSelection,o=n.multiple,s=void 0!==o&&o,l=n.search,u=void 0===l||l,c=n.select2_value;$(e).select2({width:"100%",dropdownCssClass:"skin-color",templateResult:i,templateSelection:a,minimumResultsForSearch:u?void 0:-1}).on("select2:select",function(e){if(t.value){var n=e.params.data.id;s&&0===r.context[t.value].filter(function(e){return n===e}).length?r.context[t.value].push(n):r.context[t.value]=n}}).on("select2:unselect",function(e){t.value&&s&&(r.context[t.value]=r.context[t.value].filter(function(t){return e.params.data.id!==t}))}),t.value&&c&&$(e).val(c).trigger("change")},unbind:function(e){$(e).select2("destroy")}}},{}],351:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=function(e,t){e.toggleAttribute("selected",0===t.value)}},{}],352:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/applicationstate"),a=n(i),o=e("directives/utils"),s=e("core/i18n/i18n.service"),l=s.t,u="g3w-v-t-html-id";r["default"]={bind:function(e,t){(0,o.watch)({el:e,attr:u,watcher:[function(){return a["default"].lng},function(){e.innerHTML=""+l(t.value)}]})},unbind:function(e){return(0,o.unwatch)({el:e,attr:u})}}},{"core/applicationstate":8,"core/i18n/i18n.service":27,"directives/utils":344}],353:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/applicationstate"),a=n(i),o=e("directives/utils"),s=e("core/i18n/i18n.service"),l=s.t,u=s.tPlugin,c="g3w-v-t-placeholder-id";r["default"]={bind:function(e,t){(0,o.watch)({el:e,attr:c,watcher:[function(){return a["default"].lng},function(){e.setAttribute("placeholder",("plugin"===t.arg?u:l)(t.value))}]})},unbind:function(e){return(0,o.unwatch)({el:e,attr:c})}}},{"core/applicationstate":8,"core/i18n/i18n.service":27,"directives/utils":344}],354:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/applicationstate"),a=n(i),o=e("directives/utils"),s=e("core/i18n/i18n.service"),l=s.tPlugin,u="g3w-v-t-plugin-id";r["default"]={bind:function(e,t){var r=e.innerHTML;(0,o.watch)({el:e,attr:u,watcher:[function(){return a["default"].lng},function(){var n=null!==t.value?l(t.value):"";switch(t.arg?t.arg:"post"){case"pre":
e.innerHTML=n+" "+r;break;case"post":e.innerHTML=r+" "+n}}]})},unbind:function(e){return(0,o.unwatch)({el:e,attr:u})}}},{"core/applicationstate":8,"core/i18n/i18n.service":27,"directives/utils":344}],355:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/applicationstate"),a=n(i),o=e("directives/utils"),s=e("core/i18n/i18n.service"),l=s.t,u=s.tPlugin,c="g3w-v-t-title-id";r["default"]={bind:function(e,t){(0,o.watch)({el:e,attr:c,watcher:[function(){return a["default"].lng},function(){var r=("plugin"===t.arg?u:l)(t.value);e.setAttribute("title",r),e.setAttribute("data-original-title",r)}]})},unbind:function(e){return(0,o.unwatch)({el:e,attr:c})}}},{"core/applicationstate":8,"core/i18n/i18n.service":27,"directives/utils":344}],356:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/applicationstate"),a=n(i),o=e("directives/utils"),s=e("core/i18n/i18n.service"),l=s.t,u=s.tPlugin,c="g3w-v-t-tooltip-id";r["default"]={bind:function(e,t){t.modifiers.create&&(t.arg&&(e.setAttribute("data-placement",t.arg),e.classList.add("skin-color","skin-tooltip-"+t.arg)),$(e).tooltip({trigger:a["default"].ismobile?"click":"hover",html:!0}).on("shown.bs.tooltip",function(){a["default"].ismobile&&setTimeout(function(){return $(e).tooltip("hide")},600)})),(0,o.watch)({el:e,attr:c,watcher:[function(){return a["default"].lng},function(r){var n=r.el,i=void 0===n?e:n,a=i.getAttribute("current-tooltip");null===a&&(a=t.value),i.setAttribute("data-original-title",t.modifiers.text?a:("plugin"===t.arg?u:l)(a))}]})},componentUpdated:function(e,t){var r=e.getAttribute("current-tooltip");null!=r&&r!==t.oldValue&&(0,o.trigger)({el:e,attr:c,data:{el:e}})},unbind:function(e){$(e).tooltip("hide"),(0,o.unwatch)({el:e,attr:c})}}},{"core/applicationstate":8,"core/i18n/i18n.service":27,"directives/utils":344}],357:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/applicationstate"),a=n(i),o=e("directives/utils"),s=e("core/i18n/i18n.service"),l=s.t,u="g3w-v-t-id";r["default"]={bind:function(e,t){var r=e.innerHTML;(0,o.watch)({el:e,attr:u,watcher:[function(){return a["default"].lng},function(){var n=null!==t.value?l(t.value):"";switch(t.arg?t.arg:"post"){case"pre":e.innerHTML=n+" "+r;break;case"post":e.innerHTML=r+" "+n}}]})},unbind:function(e){return(0,o.unwatch)({el:e,attr:u})}}},{"core/applicationstate":8,"core/i18n/i18n.service":27,"directives/utils":344}],358:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={translation:{cookie_law:{message:"Diese Website verwendet Cookies, um Ihnen die bestmgliche Erfahrung auf unserer Website zu bieten.",buttonText:"Verstanden!"},"default":"default",sign_in:"Anmelden",layer_selection_filter:{tools:{filter:"Filter hinzufgen/entfernen",nofilter:"Filter entfernen",invert:"Auswahl umkehren",clear:"Auswahl lschen",show_features_on_map:"Auf der Karte sichtbare Features anzeigen"}},warning:{not_supported_format:"Nicht untersttztes Format"},layer_position:{top:"OBEN",bottom:"UNTEN",message:"Position relativ zu den Layern im TOC"},sdk:{search:{all:"ALLE",no_results:"Keine Ergebnisse",searching:"Suchen ...",error_loading:"Fehler beim Datenladen",layer_not_searchable:"Layer ist nicht durchsuchbar",layer_not_querable:"Layer ist nicht abfragbar",autocomplete:{inputshort:{pre:"Bitte",post:"oder mehrere Zeichen eingeben"}}},print:{no_layers:"Kein Layer zu drucken",template:"Template",labels:"Labels",scale:"Skala",format:"Format",rotation:"Drehung",download_image:"Bild herunterladen",fids_instruction:"Akzeptierte Werte: von 1 bis [max]. Es ist mglich, ein Intervall einzugeben, z. B. 4-6",fids_example:"Bsp. 1,4-6 druckt id 1,4,5,6",help:"Die im Druck angezeigten Layer knnen die im Projekt definierten sein und nicht die auf der Karte angezeigten"},querybuilder:{search:{run:"Ausfhren",info:"Information","delete":"Lschen",edit:"Bearbeiten"},messages:{changed:"Gespeichert",number_of_features:"Anzahl der Features"},panel:{button:{all:"ALLE",save:"SPEICHERN",test:"TEST",clear:"LSCHEN",run:"AUSFHREN",manual:"MANUELL"},layers:"LAYERS",fields:"FELDER",values:"WERTE",operators:"OPERATOREN",expression:"AUSDRUCK"},error_run:"Es ist ein Fehler aufgetreten. Bitte berprfen Sie die Abfrage",error_test:"Whrend der Ausfhrung der Abfrage ist ein Fehler aufgetreten","delete":"Soll es gelscht werden?",additem:"Geben Sie den Namen der neuen Suche ein"},errors:{layers:{load:"Einige Layer sind nicht verfgbar"},unsupported_format:"Nicht untersttztes Format",add_external_layer:"Fehler im Ladevorgang des Layers"},metadata:{title:"Metadaten",groups:{general:{title:"ALLGEMEIN",fields:{title:"TITEL",name:"NAME",description:"BESCHREIBUNG","abstract":"ABASTRACT",keywords:"SCHLSSELWRTER",fees:"GEBHREN",accessconstraints:"ZUGRIFFSBESCHRNKUNG",contactinformation:"KONTAKTE",subfields:{contactinformation:{contactelectronicmailaddress:"Email",personprimary:"Referenzen",contactvoicetelephone:"Telefon",contactorganization:"Firma",ContactOrganization:"Firma",contactposition:"Position",ContactPosition:"Position",contactperson:"Person",ContactPerson:"Person"}},wms_url:"WMS"}},spatial:{title:"SPATIAL",fields:{crs:"EPSG",extent:"BBOX"}},layers:{title:"LAYERS",fields:{layers:"LAYERS",subfields:{crs:"EPSG",bbox:"BBOX",title:"TITEL",name:"NAME",geometrytype:"GEOMETRIE",source:"QUELLE",attributes:"ATTRIBUTE","abstract":"ABSTRACT",attribution:"ATRIBUTION",keywords:"SCHLSSELWRTER",metadataurl:"METADATEN URL",dataurl:"DATEN URL"}},groups:{general:"ALLGEMEIN",spatial:"SPATIAL"}}}},tooltips:{relations:{form_to_row:"Zeilenansicht",row_to_form:"Formularansicht"},copy_map_extent_url:"Link zur Kartenansicht kopieren",download_shapefile:"Shapefile herunterladen",download_gpx:"DGPX herunterladen",download_gpkg:"GPKG herunterladen",download_csv:"CSV herunterladen",download_xls:"XLS herunterladen",show_chart:"Diagramm anzeigen",atlas:"Atlas drucken"},mapcontrols:{query:{tooltip:"Query layer",actions:{add_selection:{hint:"Auswahl hinzufgen/entfernen"},zoom_to_features_extent:{hint:"Zoom auf Feature-Ausdehnung"},add_features_to_results:{hint:"Hinzufgen/Entfernen von Features zu den Ergebnissen"},remove_feature_from_results:{hint:"Feature aus den Ergebnissen entfernen"},zoom_to_feature:{hint:"Zum Feature zoomen"},relations:{hint:"Relationen anzeigen"},relations_charts:{hint:"Relationship-Diagramm anzeigen"},download_features_shapefile:{hint:"Features Shapefile herunterladen"},download_shapefile:{hint:"Feature Shapefile herunterladen"},download_features_gpx:{hint:"Feature GPX herunterladen"},download_features_gpkg:{hint:"Feature GPKG herunterladen"},download_gpx:{hint:"Feature GPX herunterladen"},download_gpkg:{hint:"Feature GPKG herunterladen"},download_features_csv:{hint:"Features CSV herunterladen"},download_csv:{hint:"Feature CSV herunterladen"},download_features_xls:{hint:"Features XLS herunterladen"},download_xls:{hint:"Feature XLS herunterladen"},atlas:{hint:"Atlas drucken"},copy_zoom_to_fid_url:{hint:"Kopieren der Karten-URL mit dieser Geometrie-Feature-Erweiterung",hint_change:"Kopiert"}}},querybypolygon:{download:{title:"Attribute herunterladen",choiches:{feature:{label:"Nur Features"},feature_polygon:{label:"Features+Query Polygon"}}},tooltip:"Query nach Polygon",no_geometry:"Keine Geometrie in der Antwort",help:{title:"Hilfe - Abfrage nach Polygon",message:"\n                <ul>\n                  <li>Whlen Sie einen Polygon Layer auf TOC.</li>\n                  <li>Stellen Sie sicher, dass der Layer sichtbar ist.</li>\n                  <li>Klicken Sie auf ein Feature des ausgewhlten Layers.</li>\n                </ul>"}},querybybbox:{tooltip:"BBox Layer abfragen",nolayers_visible:"Es sind keine abfragbaren Layer sichtbar. Bitte setzen Sie mindestens einen sichtbaren wfs Layer, um die Abfrage zu starten",help:{title:"Hilfe - Abfrage des BBox Layers",message:"\n                 <ul>\n                  <li>Ein Quadrat auf der Karte ziehen, um unterstrichene Layer im TOC abzufragen</li>\n                 </ul>"}},addlayer:{messages:{csv:{warning:"Das Ergebnis in der Karte ist unvollstndig, da die unten stehende Liste fehlerhafter Eintrge enthlt:"}},tooltip:"Layer hinzufgen"},geolocation:{tooltip:"Geolokalisierung"},measures:{length:{tooltip:"Lnge",help:"Klicken Sie auf die Karte, um die Linie zu zeichnen. Drcken Sie <br>CANC, wenn Sie den letzten Eckpunkt lschen mchten."},area:{tooltip:"Flche",help:"Drcken Sie <br>CANC, wenn Sie den letzten Eckpunkt lschen wollen."}},scale:{no_valid_scale:"Ungltige Skala"},scaleline:{units:{metric:"Meter",nautical:"Nautische Meile"}}},relations:{relation_data:"Daten zur Relation",no_relations_found:"Keine Relationen gefunden",back_to_relations:"Zurck zu den Relationen",list_of_relations_feature:"Liste der Relationen des Features",error_missing_father_field:"Ein Feld fehlt"},workflow:{steps:{title:"Schritte"},next:"Weiter"},form:{loading:"Laden ...",inputs:{messages:{errors:{picklayer:"Kein Feature ausgewhlt. Prfen, ob der Layer in Bearbeitung oder im aktuellen Mastab sichtbar ist"}},tooltips:{picklayer:"Wert aus dem Layer abrufen",lonlat:"Zum Abrufen der Koordinaten auf die Karte klicken"},input_validation_mutually_exclusive:"Feld schliet sich gegenseitig aus mit ",input_validation_error:"Obligatorisches Feld oder falscher Datentyp",input_validation_min_field:"Der Wert muss grer/gleich sein als der Feldwert  ",input_validation_max_field:"Der Wert muss kleiner/gleich sein als der Feldwert ",input_validation_exclude_values:"Wert muss einmalig sein",integer:"integer",bigint:"integer",text:"text",varchar:"text",textarea:"text",string:"string",date:"date","float":"float",table:"table"},footer:{required_fields:"Erforderliche Felder"},messages:{qgis_input_widget_relation:"Spezifisches Relations-Formular verwenden, um mit Relationen zu arbeiten"}},catalog:{current_map_theme_prefix:"THEMA",choose_map_theme:"THEMA AUSWHLEN",menu:{layerposition:"Position des Layers",setwmsopacity:"Opazitt einstellen",wms:{title:"",copy:"Klicken Sie hier, um die Url zu kopieren",copied:"Kopiert"},download:{shp:"Shapefile herunterladen",gpx:"GPX herunterladen",gpkg:"GPKG herunterladen",csv:"CSV herunterladen",xls:"XLS herunterladen",geotiff:"GEOTIFF herunterladen",geotiff_map_extent:"GEOTIFF herunterladen (aktueller Ansichtsumfang)"}}},wps:{list_process:"Liste der Prozesse",tooltip:"Karte anklicken"}},credits:{g3wSuiteFramework:"Applikation basiert auf OS-Framework",g3wSuiteDescription:"Verffentlichen und verwalten Sie Ihre QGIS-Projekte im Internet",productOf:"Framework entwickelt von"},toggle_color_scheme:"Farbschema umschalten",logout:"Logout",no_other_projects:"Kein weiteres Projekt fr diese Gruppe",yes:"Ja",no:"No",back:"Zurck",backto:"Zurck zu ",changemap:"Karte ndern",component:"Allgemeine Komponente",search:"Suche",no_results:"Keine Ergebnisse gefunden",print:"Drucken",create_print:"Drucken erstellen",dosearch:"Suche",catalog:"Karte",data:"Daten",externalwms:"WMS",baselayers:"Base",tools:"Tools",tree:"Layers",legend:"Legende",nobaselayer:"Keine Basemap",street_search:"Adresse finden",show:"Anzeigen",hide:"Ausblenden",copy_form_data:"Daten kopieren",paste_form_data:"Einfgen",copy_form_data_from_feature:"Daten von der Karte kopieren",error_map_loading:"Fehler beim Laden der Karte",check_internet_connection_or_server_admin:"Internetverbindung prfen oder Admin kontaktieren",could_not_load_vector_layers:"Verbindungsfehler: Layers knnen geladen werden",server_saver_error:"Fehler beim Speichern auf dem Server",server_error:"Server-Verbindungsfehler",save:"Speichern",cancel:"Abbrechen",close:"Schlieen",enlange_reduce:"Vergrern/Verkleinern",reset_default:"Standardgre",add:"Hinzufgen",exitnosave:"Beenden ohne Speichern",annul:"Abbrechen",layer_is_added:"Layer mit gleichem Namen bereits hinzugefgt",sidebar:{wms:{panel:{title:"WMS Layer hinzufgen",label:{position:"Kartenposition",name:"Name",projections:"Projektion",layers:"Layers"}},add_wms_layer:"WMS Layer hinzufgen",delete_wms_url:"WMS Url lschen",layer_id_already_added:"WMS Layer bereits hinzugefgt",url_already_added:"WMS URL bereits hinzugefgt",layer_add_error:"WMS Layer nicht hinzugefgt. Bitte berprfen Sie alle WMS-Parameter oder Url"}},info:{title:"Ergebnisse",open_link:"Beigefgtes Dokument ffnen",server_error:"Auf dem Server ist ein Fehler aufgetreten",no_results:"Keine Ergebnisse fr diese Anfrage/Suche gefunden",link_button:"ffnen"},mapcontrols:{geolocations:{error:"Position kann nicht bestimmt werden"},nominatim:{placeholder:"Addresse ...",noresults:"Keine Ergebnisse",notresponseserver:"Keine Antwort vom Server"},add_layer_control:{header:"Layer hinzufgen",select_projection:"Layer Projektion auswhlen",select_field_to_show:"Feld auswhlen, das auf der Karte angezeigt werden soll",select_csv_separator:"Begrenzer auswhlen",select_csv_x_field:"X-Feld auswhlen",select_csv_y_field:"Y-Feld auswhlen",select_color:"Layer Farbe auswhlen",drag_layer:"Layer hierher ziehen und ablegen"},query:{input_relation:"Klicken, um Relationen anzuzeigen"},length:{tooltip:"Lnge"},area:{tooltip:"Area"},screenshot:{error:"Screenshot Fehlererstellung"}},catalog_items:{helptext:"Klicken Sie mit der rechten Maustaste auf einen einzelnen Layer, um auf zustzliche Funktionen zuzugreifen",contextmenu:{zoomtolayer:"Zoom auf Layer",open_attribute_table:"Attributtabelle ffnen",show_metadata:"Metadaten",styles:"Stile",vector_color_menu:"Farbe einstellen/ndern"}},dataTable:{previous:"Vorherige",next:"Weiter",lengthMenu:"_MEN_ anzeigen",info:"Anzeige von _START_ bis _END_ der _TOTAL_ Eintrge",no_data:"Keine Daten",nodatafilterd:"Keine passenden Datenstze gefunden",infoFiltered:"(gefiltert aus _MAX_ Gesamtstzen)"}}}},{}],359:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={translation:{cookie_law:{message:"This website uses cookies to ensure you get the best experience on our website.",buttonText:"Got It!"},"default":"default",sign_in:"Sign in",layer_selection_filter:{tools:{filter:"Add/Remove Filter",nofilter:"Remove Filter",invert:"Invert Selection",clear:"Clear Selection",show_features_on_map:"Show features visible on map"}},warning:{not_supported_format:"Not supported format"},layer_position:{top:"TOP",bottom:"BOTTOM",message:"Position relative to layers on TOC"},sdk:{search:{all:"ALL",no_results:"No results",searching:"Searching ...",error_loading:"Error Loading Data",layer_not_searchable:"Layer is not searchable",layer_not_querable:"Layer is not querable",autocomplete:{inputshort:{pre:"Please enter",post:"or more characters"}}},print:{no_layers:"No Layer to print",template:"Template",labels:"Labels",scale:"Scale",format:"Format",rotation:"Rotation",download_image:"Download Image",fids_instruction:"Values accepted: from 1 to value of [max]. Is possible to insert a range ex. 4-6",fids_example:"Ex. 1,4-6 will be printed id 1,4,5,6",help:"The layers shown in the print could be those defined on the project and not those displayed on the map"},querybuilder:{search:{run:"Run",info:"Information","delete":"Delete",edit:"Edit"},messages:{changed:"Saved",number_of_features:"Number of features"},panel:{button:{all:"ALL",save:"SAVE",test:"TEST",clear:"CLEAR",run:"RUN",manual:"MANUAL"},layers:"LAYERS",fields:"FIELDS",values:"VALUES",operators:"OPERATORS",expression:"EXPRESSION"},error_run:"An error occurs. Please check the query",error_test:"An error occur during query execution","delete":"Do you want delete it?",additem:"Insert the name of the new search"},errors:{layers:{load:"Some layers are not available"},unsupported_format:"Not supported format",add_external_layer:"Load layer error"},metadata:{title:"Metadata",groups:{general:{title:"GENERAL",fields:{title:"TITLE",name:"NAME",description:"DESCRIPTION","abstract":"ABSTRACT",keywords:"KEYWORDS",fees:"FEES",accessconstraints:"ACCESS CONSTRAINT",contactinformation:"CONTACTS",subfields:{contactinformation:{contactelectronicmailaddress:"Email",personprimary:"Refereces",contactvoicetelephone:"Phone",contactorganization:"Organization",ContactOrganization:"Organization",contactposition:"Position",ContactPosition:"Position",contactperson:"Person",ContactPerson:"Person"}},wms_url:"WMS"}},spatial:{title:"SPATIAL",fields:{crs:"EPSG",extent:"BBOX"}},layers:{title:"LAYERS",fields:{layers:"LAYERS",subfields:{crs:"EPSG",bbox:"BBOX",title:"TITLE",name:"NAME",geometrytype:"GEOMETRY",source:"SOURCE",attributes:"ATTRIBUTES","abstract":"ABSTRACT",attribution:"ATTRIBUTION",keywords:"PAROLE CHIAVE",metadataurl:"METADATA URL",dataurl:"DATA URL"}},groups:{general:"GENERAL",spatial:"SPATIAL"}}}},tooltips:{relations:{form_to_row:"Row View",row_to_form:"Form View"},copy_map_extent_url:"Copy map view link",download_shapefile:"Download Shapefile",download_gpx:"Download GPX",download_gpkg:"Download GPKG",download_csv:"Download CSV",download_xls:"Download XLS",show_chart:"Show Chart",atlas:"Print Atlas"},mapcontrols:{query:{tooltip:"Query layer",actions:{add_selection:{hint:"Add/Remove Selection"},zoom_to_features_extent:{hint:"Zoom to features extent"},add_features_to_results:{hint:"Add/Remove features to results"},remove_feature_from_results:{hint:"Remove feature from results"},zoom_to_feature:{hint:"Zoom to feature"},relations:{hint:"Show Relations"},relations_charts:{hint:"Show relations chart"},download_features_shapefile:{hint:"Download features Shapefile"},download_shapefile:{hint:"Download feature Shapefile"},download_features_gpx:{hint:"Download feature GPX"},download_features_gpkg:{hint:"Download features GPKG"},download_gpx:{hint:"Download feature GPX"},download_gpkg:{hint:"Download feature GPKG"},download_features_csv:{hint:"Download features CSV"},download_csv:{hint:"Download feature CSV"},download_features_xls:{hint:"Download features XLS"},download_xls:{hint:"Download feature XLS"},atlas:{hint:"Print Atlas"},copy_zoom_to_fid_url:{hint:"Copy map URL with this geometry feature extension",hint_change:"Copied"}}},querybypolygon:{download:{title:"Attributes download",choiches:{feature:{label:"Features only"},feature_polygon:{label:"Features+Query Polygon"}}},tooltip:"Query By Polygon",no_geometry:"No geometry on response",help:{title:"Guide - Query By Polygon",message:"\n                <ul>\n                  <li>Select a polygon layer on TOC.</li>\n                  <li>Be sure that layer is visible.</li>\n                  <li>Click on a feature of selected layer.</li>\n                </ul>"}},querybybbox:{tooltip:"Query BBox layer",nolayers_visible:"No querable layers are visible. Please set at least one visible wfs layer to run query",help:{title:"Guide - Query BBox layer",message:"\n                  <ul>\n                  <li>Draw a square on map to query underlined layers on TOC</li>\n                  </ul>"}},addlayer:{messages:{csv:{warning:"The result in the map is partial due to the presence of the below incorrect records list:"}},tooltip:"Add Layer"},geolocation:{tooltip:"Geolocation"},measures:{length:{tooltip:"Length",help:"Click on map to draw the line. Press <br>CANC if you want delete last vertex"},area:{tooltip:"Area",help:"Click to draw poligon.Press <br>CANC if you want delete last vertex"}},scale:{no_valid_scale:"Invalid Scale"},scaleline:{units:{metric:"Meters",nautical:"Nautical Mile"}}},relations:{relation_data:"Relation data",no_relations_found:"No relations found",back_to_relations:"Back to relations",list_of_relations_feature:"List of relations of feature",error_missing_father_field:"Field is missing"},workflow:{steps:{title:"Steps"},next:"Next"},form:{loading:"Loading ...",inputs:{messages:{errors:{picklayer:"No feature selected. Check if layer is on editing or visible at current scale"}},tooltips:{picklayer:"Get value from ma layer",lonlat:"Click on map to get coordinates"},input_validation_mutually_exclusive:"Field mutually exclusive with ",input_validation_error:"Mandatory Field or wrong data type",input_validation_min_field:"Value has to be more/equal to field value  ",input_validation_max_field:"Value has to be less/equal to field value ",input_validation_exclude_values:"Value has to be unique",integer:"integer",bigint:"integer",text:"text",varchar:"text",textarea:"text",string:"string",date:"date","float":"float",table:"table"},footer:{required_fields:"Required fields"},messages:{qgis_input_widget_relation:"Use relation specific form to work with relation"}},catalog:{current_map_theme_prefix:"THEME",choose_map_theme:"CHOOSE THEME",menu:{layerposition:"Layer Position",setwmsopacity:"Set Opacity",wms:{title:"",copy:"Click here to copy url",copied:"Copied"},download:{shp:"Download Shapefile",gpx:"Download GPX",gpkg:"Download GPKG",csv:"Download CSV",xls:"Download XLS",geotiff:"Download GEOTIFF",geotiff_map_extent:"Download GEOTIFF(current view extent)"}}},wps:{list_process:"List of process",tooltip:"Click on map"}},credits:{g3wSuiteFramework:"Application based on OS framework",g3wSuiteDescription:"Publish and manage your QGIS projects on the web",productOf:"Framework developed by"},toggle_color_scheme:"Toggle color scheme",logout:"Logout",no_other_projects:"No more project for this group",yes:"Yes",no:"No",back:"Back",backto:"Back to ",changemap:"Change Map",component:"Generic Component",search:"Search",no_results:"No results found",print:"Print",create_print:"Create Print",dosearch:"Search",catalog:"Map",data:"Data",externalwms:"WMS",baselayers:"Base",tools:"Tools",tree:"Layers",legend:"Legend",nobaselayer:"No basemap",street_search:"Find Address",show:"Show",hide:"Hide",copy_form_data:"Copy data",paste_form_data:"Paste",copy_form_data_from_feature:"Copy data from map",error_map_loading:"Error occurs loading map",check_internet_connection_or_server_admin:"Check internet connection or contact admin",could_not_load_vector_layers:"Connection error: Layers can be loaded",server_saver_error:"Error in server saving",server_error:"Server connection error",save:"Save",cancel:"Cancel",close:"Close",enlange_reduce:"Enlarge/Reduce",reset_default:"Default size",add:"Add",exitnosave:"Exit without save",annul:"Cancel",layer_is_added:"Layer with same name already added",sidebar:{wms:{panel:{title:"Add WMS Layer",label:{position:"Map Position",name:"Name",projections:"Projection",layers:"Layers"}},add_wms_layer:"Add WMS layer",delete_wms_url:"Delete WMS url",layer_id_already_added:"WMS Layer already added",url_already_added:"WMS URL already added",layer_add_error:"WMS Layer not added. Please check all wms parameter or url"}},info:{title:"Results",open_link:"Open attached document",server_error:"An error occurred from server",no_results:"No results found for this query/search",link_button:"Open"},mapcontrols:{geolocations:{error:"Can't get your position"},nominatim:{placeholder:"Address ...",noresults:"No results",notresponseserver:"No response from server"},add_layer_control:{header:"Add Layer",select_projection:"Select layer projection",select_field_to_show:"Select Field to show on map",select_csv_separator:"Select delimiter",select_csv_x_field:"Select X field",select_csv_y_field:"Select Y field",select_color:"Select Layer Color",drag_layer:"Drag and drop layer here"},query:{input_relation:"Click to show relations"},length:{tooltip:"Length"},area:{tooltip:"Area"},screenshot:{error:"Screenshot error creation"}},catalog_items:{helptext:"Right-click on individual layer to access additional features",contextmenu:{zoomtolayer:"Zoom to Layer",open_attribute_table:"Open Attribute Table",show_metadata:"Metadata",styles:"Styles",vector_color_menu:"Set/Change Color"}},dataTable:{previous:"Previous",next:"Next",lengthMenu:"Show _MENU_",info:"Showing _START_ to _END_ of _TOTAL_ entries",no_data:"No data",nodatafilterd:"No matching records found",infoFiltered:"(filtered from _MAX_ total records)"}}}},{}],360:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={translation:{cookie_law:{message:"This website uses cookies to ensure you get the best experience on our website.",buttonText:"Got It!"},"default":"oletuksena",sign_in:"Kirjaudu sisn",layer_selection_filter:{tools:{filter:"List/Poista Suodattaa",nofilter:"Poista Suodattaa",invert:"Knteinen Valinta",clear:"Peruuttaa Valinta",show_features_on_map:"Nyt kartalla nkyvt ominaisuudet"}},warning:{not_supported_format:"Not supported format"},layer_position:{top:"TOP",bottom:"BOTTOM",message:"Position relative to layers on TOC"},sdk:{search:{all:"KAIKKI",no_results:"Ei tuloksia",searching:"Haetaan ...",error_loading:"Virhe ladattaessa tietoja.",layer_not_searchable:"Taso ei ole haettavissa.",layer_not_querable:"Tasolle ei voi suorittaa kyselyit.",autocomplete:{inputshort:{pre:"Syt",post:"tai useampi merkki"}}},print:{no_layers:"Ei tulostettavia tasoja",template:"Template",labels:"Labels",scale:"Mittakaava",format:"Formaatti",rotation:"Kierto",download_image:"Lataa kuva",fids_instruction:"Hyvksytyt arvot: yhdest arvoon [max]. Salittua sytt mys vli, esim. 4-6.",fids_example:"Esimerkiksi 1,4-6 tulostuu id 1,4,5,6.",help:"Tulosteessa esiintyvt tasot voivat olla projektissa mriteltyj ei kartalla esiintyvi."},querybuilder:{search:{run:"Suorita",info:"Informaatio","delete":"Poista",edit:"Muokkaa"},messages:{changed:"Tallennettu",number_of_features:"Ominaisuuksien lukumr"},panel:{button:{all:"KAIKKI",save:"TALLENNA",test:"TESTI",clear:"TYHJENN",run:"SUORITA",manual:"MANUAALINEN"},layers:"TASOT",fields:"KENTT",values:"ARVOT",operators:"OPERAATTORIT",expression:"LAUSEKE"},error_run:"Tapahtui virhe. Tarkista kysely.",error_test:"Kysely suorittaessa tapahtui virhe.","delete":"Haluatko poistaa sen?",additem:"Anna nimi uudelle haulle."},errors:{layers:{load:"Jotkin tasot eivt ole saatavilla."},unsupported_format:"Ei tuettu formaatti",add_external_layer:"Tason latausvirhe"},metadata:{title:"Metatiedot",groups:{general:{title:"YLEINEN",fields:{title:"OTSIKKO",name:"NIMI",description:"KUVAUS","abstract":"TIIVISTELM",keywords:"AVAINSANAT",fees:"MAKSUT",accessconstraints:"PSYRAJOITUKSET",contactinformation:"YHTEYSTIEDOT",subfields:{contactinformation:{contactelectronicmailaddress:"Shkposti",personprimary:"Viitteet",contactvoicetelephone:"Puhelin",contactorganization:"Organisaatio",ContactOrganization:"Organisaatio",contactposition:"Asema",ContactPosition:"Asema",contactperson:"Yhteyshenkil",ContactPerson:"Yhteyshenkil"}},wms_url:"WMS"}},spatial:{title:"SPATIAL",fields:{crs:"EPSG",extent:"BBOX"}},layers:{title:"TASOT",fields:{layers:"TASOT",subfields:{crs:"EPSG",bbox:"BBOX",title:"OTSIKKO",name:"NIMI",geometrytype:"GEOMETRIA",source:"LHDE",attributes:"ATTRIBUUTIT","abstract":"TIIVISTELM",attribution:"ATTRIBUUTIO",keywords:"AVAINSANAT",metadataurl:"METATIEDON URL",dataurl:"DATA URL"}},groups:{general:"YLEINEN",spatial:"SPATIAL"}}}},tooltips:{relations:{form_to_row:"Rivinkym",row_to_form:"Taulukkonkym"},copy_map_extent_url:"Kopioi kartan katselulinkki",download_shapefile:"Lataa SHP-tiedosto",download_gpx:"Lataa GPX-tiedosto",download_gpkg:"Lataa GPKG-tiedosto",download_csv:"Lataa CSV-tiedosto",download_xls:"Lataa XLS-tiedosto",show_chart:"Nyt kaavio",atlas:"Tulosta Atlas"},mapcontrols:{query:{tooltip:"Kyselytaso",actions:{add_selection:{hint:"Lis/Poista valinta"},zoom_to_features_extent:{hint:"Tarkenna ominaisuuden laajuuteen"},add_features_to_results:{hint:"Add/Remove features to results"},remove_feature_from_results:{hint:"Remove feature from results"},zoom_to_feature:{hint:"Tarkenna ominaisuuteen"},relations:{hint:"Nyt relaatiot"},relations_charts:{hint:"Nyt relaatiokaavio"},download_features_shapefile:{hint:"Lataa ominaisuuden SHP-tiedosto"},download_shapefile:{hint:"Lataa ominaisuuden SHP-tiedosto"},download_features_gpx:{hint:"Lataa ominaisuuden GPX-tiedosto"},download_features_gpkg:{hint:"Lataa ominaisuuden GPKG-tiedosto"},download_gpx:{hint:"Lataa ominaisuuden GPX-tiedosto"},download_gpkg:{hint:"Lataa ominaisuuden GPKG-tiedosto"},download_features_csv:{hint:"Lataa ominaisuuden CSV-tiedosto"},download_csv:{hint:"Lataa ominaisuuden CSV-tiedosto"},download_features_xls:{hint:"Lataa ominaisuuden XLS-tiedosto"},download_xls:{hint:"Lataa ominaisuuden XLS-tiedosto"},atlas:{hint:"Tulosta Atlas"},copy_zoom_to_fid_url:{hint:"Copy map URL with this geometry feature extension",hint_change:"Copied"}}},querybypolygon:{download:{title:"Attributes download",choiches:{feature:{label:"Features only"},feature_polygon:{label:"Features+Query Polygon"}}},tooltip:"Kysely monikulmiolla",no_geometry:"No geometry on response",help:{title:"Ohje - Kysely monikulmiolla",message:"\n                <ul>\n                  <li>Valitse monikulmiotaso luettelosta.</li>\n                  <li>Tarkista, ett taso on nkyvill.</li>\n                  <li>Valitse ominaisuus valitulla tasolla.</li>\n                </ul>"}},querybybbox:{tooltip:"Tasoon kohdituva BBox-kysely",nolayers_visible:"Ei kyseltvi tasoja nkyvill. Aseta vhintn yksi WFS-taso nkyvksi suorittaaksesi haun.",help:{title:"Ohje - Tasoon kohdistuva BBox-kysely",message:"\n                 <ul>\n                  <li>Piirr suorakulmio kartalle suorittaaksesi kyselyn luettelossa alleviivatuille tasoille.</li>\n                 </ul>"}},addlayer:{messages:{csv:{warning:"The result in the map is partial due to the presence of the below incorrect records list:"}},tooltip:"Lis taso"},geolocation:{tooltip:"Maantieteellinen sijainti"},measures:{length:{tooltip:"Pituus",help:"Piirr murtoviiva kartalle. Paina <br>CANC, mikli haluat poistaa edellisen pisteen."},area:{tooltip:"Alue",help:"Piirr monikulmio kartalle. Paina <br>CANC, mikli haluat poistaa edellisen pisteen."}},scale:{no_valid_scale:"Vr mittakaava"},scaleline:{units:{metric:"Meters",nautical:"Nautical Mile"}}},relations:{relation_data:"Relaation tiedot",no_relations_found:"Relaatiota ei lytynyt.",back_to_relations:"Takaisin relaatioihin",list_of_relations_feature:"Lista ominaisuuden relaatioista",error_missing_father_field:"Kentt puuttu"},workflow:{steps:{title:"Vaiheet"},next:"Seuraava"},form:{loading:"Ladataan...",inputs:{messages:{errors:{picklayer:"Ominaisuuksia ei valiitu. Tarkista, ett taso on muokattavissa tai nkyviss nykyisell mittakaavalla."}},tooltips:{picklayer:"Valitse arvo karttatasolta",lonlat:"Click on map to get coordinates"},input_validation_mutually_exclusive:"Kentt toisensa poissulkeva.",input_validation_error:"Pakollinen kentt tai vr tietotyyppi.",input_validation_min_field:"Arvon tulee olla suurempi tai yhtsuuri kuin kentn arvo.",input_validation_max_field:"Arvon tulee olla pienempi tai yhtsuuri kuin kentn arvo.",input_validation_exclude_values:"Arvon tulee olla uniikki.",integer:"kokonaisluku",bigint:"kokonaisluku",text:"teksti",varchar:"teksti",textarea:"teksti",string:"merkkijono",date:"pivys","float":"liukuluku",table:"taulukko"},footer:{required_fields:"Vaaditut kentt"},messages:{qgis_input_widget_relation:"Kyt relaatioiden mrittmiseen thn tarkoitettua toimintoa"}},catalog:{current_map_theme_prefix:"THEME",choose_map_theme:"CHOOSE THEME",menu:{layerposition:"Layer Position",setwmsopacity:"Set Opacity",wms:{title:"",copy:"Paina tst kopioidaksesi url:n.",copied:"Kopioitu."},download:{shp:"Lataa SHP-tiedosto",gpx:"Lataa GPX-tiedosto",gpkg:"Lataa GPKG-tiedosto",csv:"Lataa CSV-tiedosto",xls:"Lataa XLS-tiedosto",geotiff:"Lataa GEOTIFF-tiedosto",geotiff_map_extent:"Lataa GEOTIFF-tiedosto(current view extent)"}}},wps:{list_process:"Lista prosesseista",tooltip:"Valitse kartalta"}},credits:{g3wSuiteFramework:"Sovellus perustuu OS framework",g3wSuiteDescription:"Julkaise ja hallinnoi QGIS-projekteja verkossa.",productOf:"Frameworkin on kehittnyt"},toggle_color_scheme:"Toggle color scheme",logout:"Kirjaudu ulos",no_other_projects:"Ei projekteja tlle ryhmlle",yes:"Kyll",no:"Ei",back:"Palaa",backto:"Takaisin ",changemap:"Vaihda karttaa",component:"Yleinen komponentti",
search:"Hae",no_results:"Ei hakutuloksia",print:"Tulosta",create_print:"Luo tuloste",dosearch:"Hae",catalog:"Kartta",data:"Data",externalwms:"WMS",baselayers:"Taustakartta",tools:"Tykalut",tree:"Tasot",legend:"Merkintjen selite",nobaselayer:"Ei taustakarttaa",street_search:"Hae osoite",show:"Nyt",hide:"Piilota",copy_form_data:"Kopioi tiedot",paste_form_data:"Liit",copy_form_data_from_feature:"Kopioi tiedot kartalta",error_map_loading:"Virhe ladattessa karttaa",check_internet_connection_or_server_admin:"Tarkista internetyhteys tai ota yhteytt yllpitjn.",could_not_load_vector_layers:"Yhteysvirhe, tasoja ei voida ladata.",server_saver_error:"Virhe tallentaessa palvelimelle.",server_error:"Yhteysvirhe palvelimeen",save:"Tallenna",cancel:"Peruuta",close:"Sulje",enlange_reduce:"Enlarge/Reduce",reset_default:"Default size",add:"Lis",exitnosave:"Poistu tallentamatta",annul:"Peruuta",layer_is_added:"Samanniminen taso on jo listty.",sidebar:{wms:{panel:{title:"Add WMS Layer",label:{position:"Map Position",name:"Name",projections:"Projection",layers:"Layers"}},add_wms_layer:"Aggiungi WMS layer",delete_wms_url:"Delete WMS url",layer_id_already_added:"WMS Taso on jo listty.",url_already_added:"WMS URL  on jo listty.",layer_add_error:"WMS Layer not added. Please check all wms parameter or url"}},info:{title:"Tulokset",open_link:"Avaa liitetiedosto",server_error:"Palvelimella tapahtui virhe.",no_results:"Ei tuloksia haulle/kyselylle.",link_button:"Avaa"},mapcontrols:{geolocations:{error:"Sijaintiasi ei saada"},nominatim:{placeholder:"Osoite ...",noresults:"Ei tuloksia",notresponseserver:"Ei vastausta palvelimelta"},add_layer_control:{header:"Lis taso",select_projection:"Valitse tason projektio",select_field_to_show:"Select Field to show on map",select_csv_separator:"Select delimiter",select_csv_x_field:"Select X field",select_csv_y_field:"Select Y field",select_color:"Valitse tason vri",drag_layer:"Ved ja pudota taso thn"},query:{input_relation:"Paina nyttksesi relaatiot"},length:{tooltip:"Pituus"},area:{tooltip:"Pinta-ala"},screenshot:{error:"Screenshot error creation"}},catalog_items:{helptext:"Napsauta hiiren kakkospainikkeella yksittist tasoa pstksesi lisominaisuuksiin.",contextmenu:{zoomtolayer:"Tarkenna tasoon",open_attribute_table:"Avaa attribuuttitaulu",show_metadata:"Metatiedot",styles:"Tyylej",vector_color_menu:"Aseta/muuta vri"}},dataTable:{previous:"Edellinen",next:"Seuraava",lengthMenu:"Show _MENU_ items",info:"Showing _START_ to _END_ of _TOTAL_ entries",no_data:"Ei tietoja",nodatafilterd:"Vastaavia tietueita ei lytynyt",infoFiltered:"(filtered from _MAX_ total records)"}}}},{}],361:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={translation:{cookie_law:{message:"Ce site utilise des cookies pour assurer une bonne convivialit pour l'utilisateur final.",buttonText:"Jai compris !"},"default":"par dfaut ",sign_in:"Se connecter ",layer_selection_filter:{tools:{filter:"Ajout/Suppression de filtre ",nofilter:"Supprimer le filtre ",invert:"Slection inverse ",clear:"Effacer la slection ",show_features_on_map:"Afficher les caractristiques visibles sur la carte"}},warning:{not_supported_format:"Not supported format"},layer_position:{top:"TOP",bottom:"BOTTOM",message:"Position relative to layers on TOC"},sdk:{search:{all:"TOUTES",no_results:"Aucune valeur trouve",searching:"Je cherche...",error_loading:"Erreur de chargement des valeurs",layer_not_searchable:"Le layer nest pas recherchable",layer_not_querable:"Le layer n'est pas interrogeable",autocomplete:{inputshort:{pre:"Tapez au moins",post:"caractres"}}},print:{no_layers:"Aucune layer visible",scale:"chelle",format:"Format",rotation:"Rotation",download_image:"Tlcharger l'image",fids_instruction:"Valeurs acceptes : de 1  la valeur maximale indique par [max]. Il est galement possible d'indiquer une fourchette de valeurs, par exemple 4-6",fids_example:"Par exemple 1,4-6 les ids 1,4,5,6 seront imprims",help:"Les layers montrs dans l'impression peuvent tre ceux dfinis dans le projet et non ceux montrs sur la carte"},querybuilder:{search:{run:"Lancer la recherche",info:"Information","delete":"Supprimer",edit:"Editer"},messages:{changed:"Enregistr correctement",number_of_features:"Nombre de fonctionnalits"},panel:{button:{all:"TOUTES",save:"SAUVEGARDER",test:"TESTER",clear:"NETTOYER",run:"EXECUTER",manual:"MANUEL"},layers:"LAYERS",fields:"CHAMPS",values:"VALEURS",operators:"OPERATEURS",expression:"EXPRESSION"},error_run:"Une erreur s'est produite. Vrifiez si la requte est correcte",error_test:"Erreur d'excution de la requte","delete":"Voulez-vous confirmer la suppression ?",additem:"Entrer le nom de la requte"},errors:{layers:{load:"Certaines layers du projet ne sont pas disponibles actuellement et n'apparaissent donc pas dans la vue actuelle"},unsupported_format:"Format non support",add_external_layer:"Erreur lors du chargement du layer"},metadata:{title:"Mtadonnes",groups:{general:{title:"GNRAL",fields:{title:"TITRE",name:"NOM",description:"DESCRIPTION","abstract":"ABREGE",keywords:"LISTE DE MOTS-CLS",fees:"DROITS D'INSCRIPTION",accessconstraints:"CONTRAINTES D'ACCS",contactinformation:"CONTACTS",subfields:{contactinformation:{contactelectronicmailaddress:"E-mail",personprimary:"Rfrences",contactvoicetelephone:"Tlphone",contactorganization:"Organisation",ContactOrganization:"Organisation",contactposition:"Localisation",ContactPosition:"Localisation",contactperson:"Personne",ContactPerson:"Personne"}},wms_url:"WMS"}},spatial:{title:"INFO ESPACE",fields:{crs:"EPSG",extent:"BBOX"}},layers:{title:"STRATES",groups:{general:"GENERALE",spatial:"INFO ESPACE"},fields:{layers:"STRATES",subfields:{crs:"EPSG",bbox:"BBOX",title:"TITRE",name:"NOM",geometrytype:"GOMTRIE",source:"SOURCE",attributes:"ATTRIBUTES","abstract":"ABRG",attribution:"ATTRIBUTION",keywords:"MOTS- CLS",metadataurl:"URL DE MTADONNES",dataurl:"URL DES DONNES"}}}}},tooltips:{relations:{form_to_row:"Afficher le format de la ligne",row_to_form:"Format du formulaire d'affichage"},zoom_to_features_extent:"Zoom sur les fonctionnalits",copy_map_extent_url:"Copier le lien de visualisation de la carte",download_shapefile:"Tlcharger le fichier Shapefile",download_gpx:"Tlcharger GPX",download_gpkg:"Tlcharger GPKG",download_csv:"Tlcharger CSV",download_xls:"Tlcharger XLS",show_chart:"Montrer graphique",atlas:"Imprimer l'Atlas"},mapcontrols:{query:{tooltip:"Interrogation layer",actions:{add_selection:{hint:"Ajouter/supprimer une slection"},zoom_to_features_extent:{hint:"Zoom sur les fonctionnalits"},add_features_to_results:{hint:"Ajouter des fonctionnalits aux rsultats"},remove_feature_from_results:{hint:"Supprimer la fonctionnalit des rsultats"},zoom_to_feature:{hint:"Zoom sur les fonctionnalits"},relations:{hint:"Voir les relations"},relations_charts:{hint:"Voir les graphiques de relations"},download_features_shapefile:{hint:"Tlcharger les fonctionnalits vers Shapefile"},download_shapefile:{hint:"Tlcharger le Shapefile"},download_features_gpx:{hint:"Tlcharger les fonctionnalits vers GPX"},download_features_gpkg:{hint:"Tlcharger les fonctionnalits vers GPKG"},download_gpx:{hint:"Tlcharger le GPX"},download_gpkg:{hint:"Tlcharger le GPKG"},download_features_csv:{hint:"Tlcharger les fonctionnalits vers CSV"},download_csv:{hint:"Tlcharger le CSV"},download_features_xls:{hint:"Tlcharger les fonctionnalits vers XLS"},download_xls:{hint:"Tlcharger le XLS"},atlas:{hint:"Imprimer l'Atlas"},copy_zoom_to_fid_url:{hint:"Copier l'URL de la carte avec l'extension vers cette gomtrie",hint_change:"Copi"}}},querybypolygon:{download:{title:"Tlchargement des attributs",choiches:{feature:{label:"Fonctionnalits seulement"},feature_polygon:{label:"Fonctionnalits+Requte Polygon "}}},tooltip:"Requte par polygone",no_geometry:"La rponse ne contient pas de gomtrie",help:{title:"Aide - Requte par polygone",message:'\n                <ul>\n                  <li">Slectionnez un layer de polygone dans la lgende.</li>\n                  <li>Vrifiez que le layer est visible dans la carte.</li>\n                  <li>Cliquez sur une gomtrie du layer slectionn.</li>\n                </ul>'}},querybybbox:{tooltip:"Requte pour BBOX",nolayers_visible:"Aucun layer requtable n'est visible. Assurez-vous qu'au moins un layer wfs est visible pour excuter la requte",help:{title:"Aide - Requte BBox",message:"\n                  <ul>\n                    <li>Dessinez un rectangle pour interroger les couches surlignes en jaune</li>\n                 </ul>\n            "}},addlayer:{messages:{csv:{warning:"Le rsultat de la carte est partiel en raison de la prsence des enregistrements incorrects suivants :"}},tooltip:"Ajouter un layer"},geolocation:{tooltip:"Golocalisation"},measures:{length:{tooltip:"Longueur",help:"Cliquez sur la carte pour continuer  dessiner la ligne.<br>CANC si vous voulez supprimer le dernier vertex insr"},area:{tooltip:"Zone",help:"Cliquez pour continuer  dessiner le polygone.<br>CANC si vous voulez supprimer le dernier vertex insr"}},scale:{no_valid_scale:"chelle invalide"},scaleline:{units:{metric:"Meters",nautical:"Nautical Mile"}}},relations:{relation_data:"Donnes relationnelles",no_relations_found:"Aucune relation trouve",back_to_relations:"Retour aux relations",list_of_relations_feature:"Liste des relations entre les caractristiques",error_missing_father_field:"Le champ concern n'existe pas"},workflow:{steps:{title:"tapes"},next:"Suivant"},form:{loading:"Chargement...",inputs:{messages:{errors:{picklayer:"Aucune fonction slectionne. Vrifier si le layer est en dition ou non visible  l'chelle actuelle"}},tooltips:{picklayer:"Obtenir la valeur de la carte",lonlat:"Cliquez sur la carte pour obtenir les coordonnes"},input_validation_mutually_exclusive:"Champ mutuellement exclusif avec ",input_validation_error:"Champ obligatoire ou type de valeur incorrect",input_validation_min_field:"La valeur doit tre suprieure ou gale au camp ",input_validation_max_field:"La valeur doit tre infrieure ou gale au champ ",input_validation_exclude_values:"Le champ doit contenir une valeur diffrente",integer:"entier",bigint:"entier",text:"textuel",varchar:"textuel",textarea:"textuel",string:"chane",date:"date","float":"float",table:"table"},footer:{required_fields:"Champs obligatoires"},messages:{qgis_input_widget_relation:"Grer les relations via un formulaire ddi"}},catalog:{current_map_theme_prefix:"THEME",choose_map_theme:"SLECTIONNEZ LE THME",menu:{layerposition:"Layer Position",setwmsopacity:"Set Opacity",wms:{title:"",copy:"Cliquez ici pour copier l'url",copied:"Copi"},download:{shp:"Tlcharger Shapefile",gpx:"Tlcharger GPX",gpkg:"Tlcharger GPKG",csv:"Tlcharger CSV",xls:"Tlcharger XLS",geotiff:"Tlcharger GEOTIFF",geotiff_map_extent:"Tlcharger GEOTIFF(current view extent)"}}},wps:{list_process:"Liste des processus",tooltip:"Cliquez sur la carte"}},credits:{g3wSuiteFramework:"Application construite avec le framework OS",g3wSuiteDescription:"Publiez et grez vos projets QGIS sur le Web",productOf:"Framework dvelopp par"},logout:"Quitter",no_other_projects:"Il n'y a pas d'autres projets dans ce groupe de cartes",yes:"Oui",no:"No",back:"Retour",backto:"Retour  ",changemap:"Changer de carte",component:"Composant gnrique",search:"Recherches",no_results:"Aucun rsultat trouv",print:"Imprimer",create_print:"Crer une impression",dosearch:"Recherche",catalog:"Carte",data:"Donnes",externalwms:"WMS",baselayers:"Bases",tools:"Outils",tree:"Strates",legend:"Lgende",nobaselayer:"Pas de carte de base",street_search:"Adresse de recherche",show:"Afficher",hide:"Cacher",copy_form_data:"Copier les donnes du formulaire",paste_form_data:"Coller",copy_form_data_from_feature:"Copier les donnes de la carte",error_map_loading:"Erreur de chargement de la nouvelle carte",check_internet_connection_or_server_admin:"Vrifiez la connexion internet ou contactez l'administrateur",could_not_load_vector_layers:"Erreur de connexion au serveur : il n'a pas t possible de charger les vecteurs demands",server_saver_error:"Erreur de sauvegarde sur le serveur",server_error:"Une erreur s'est produite dans la requte au serveur",save:"Sauvegarder",cancel:"Supprimer",close:"Fermer",enlange_reduce:"Enlarge/Reduce",reset_default:"Default size",add:"Ajouter",exitnosave:"Quitter sans sauvegarder",annul:"Annuler",layer_is_added:"Layer avec le mme nom dj ajout",wms_layer_id_already_added:"WMS Layer dj ajout",wms_url_already_added:"WMS URL dj ajout",sidebar:{wms:{panel:{title:"Add WMS Layer",label:{position:"Map Position",name:"Name",projections:"Projection",layers:"Layers"}},add_wms_layer:"Add WMS layer",delete_wms_url:"Delete WMS url",layer_id_already_added:"WMS Nivn har redan lagts till.",url_already_added:"WMS URL har redan lagts till.",layer_add_error:"WMS Layer not added. Please check all wms parameter or url"}},info:{title:"Rsultats",open_link:"Ouvrir le document joint",server_error:"Une erreur s'est produite dans la requte au serveur",no_results:"Aucun rsultat pour cette requte/recherche",link_button:"Ouvrir"},mapcontrols:{geolocations:{title:"",error:"Votre position ne peut tre calcule."},nominatim:{placeholder:"Adresse ...",noresults:"Aucun rsultat",notresponseserver:"Le serveur ne rpond pas"},add_layer_control:{header:"Ajouter un layer",select_projection:"Slectionnez le systme de projection de couches",select_field_to_show:"Slectionnez le champ  afficher sur la carte",select_csv_separator:"Slectionner le sparateur",select_csv_x_field:"Slectionnez le champ X",select_csv_y_field:"Slectionnez le champ Y",select_color:"Slectionnez la couleur du layer",drag_layer:"Faire glisser le layer vers cette zone"},query:{input_relation:"Cliquez pour voir les relations"},length:{tooltip:"Longueur"},area:{tooltip:"Zone"},screenshot:{error:"Erreur de cration de la capture d'cran"}},catalog_items:{helptext:"Cliquez avec le bouton droit de la souris sur les diffrents layers pour accder  des fonctionnalits supplmentaires",contextmenu:{zoomtolayer:"Zoom sur le layer",open_attribute_table:"Table d'attributs ouverte",show_metadata:"Mtadonnes",styles:"Styles",vector_color_menu:"Dfinir/changer la couleur"}},dataTable:{previous:"Prcdent",next:"Suivant",lengthMenu:"Afficher _MENU_",info:"Afficher _START_  _END_ sur _TOTAL_ lignes",nodatafilterd:"Aucun rsultat trouv",infoFiltered:"(Filtr par _MAX_ rangs totaux)"}}}},{}],362:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("./it"),a=n(i),o=e("./en"),s=n(o),l=e("./fi"),u=n(l),c=e("./se"),d=n(c),p=e("./fr"),f=n(p),h=e("./de"),v=n(h),g=e("./ro"),m=n(g),y={it:a["default"],en:s["default"],fi:u["default"],se:d["default"],fr:f["default"],de:v["default"],ro:m["default"]};r["default"]=y},{"./de":358,"./en":359,"./fi":360,"./fr":361,"./it":363,"./ro":364,"./se":365}],363:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={translation:{cookie_law:{message:"Questo sito utilizza i cookie per garantire una buona usabilit all'utilizzatore finale.",buttonText:"Ho capito!"},"default":"predefinito",sign_in:"Accedi",layer_selection_filter:{tools:{filter:"Aggiungi/Rimuovi Filtro",nofilter:"Rimuovi filtro",invert:"Inverti Selezione",clear:"Annulla selezione",show_features_on_map:"Mostra features visibili su mappa"}},warning:{not_supported_format:"Formato non supportato"},layer_position:{top:"SOPRA",bottom:"IN FONDO",message:"Posizione rispetto ai layers della TOC"},sdk:{search:{all:"TUTTE",no_results:"Nessun valore trovato",searching:"Sto cercando ..",error_loading:"Errore nel caricamento valori",layer_not_searchable:"Il layer non  ricercabile",layer_not_querable:"Il layer non  interrogabile",autocomplete:{inputshort:{pre:"Digita almeno",post:"caratteri"}}},print:{no_layers:"Nessun Layer visibile",template:"Template",labels:"Etichette",scale:"Scala",format:"Formato",rotation:"Rotazione",download_image:"Scarica Immagine",fids_instruction:"Valori accettati: da 1 al valore massimo indicato da [max]. Possibile indicare anche range di valori es. 4-6",fids_example:"Es. 1,4-6 verranno stampati gli id 1,4,5,6",help:"I layers mostrati nella stampa potrebbero essere quelli definiti sul progetto e non quelli visualizzati sulla mappa"},querybuilder:{search:{run:"Lancia ricerca",info:"Informazioni","delete":"Cancella",edit:"Modifica"},messages:{changed:"Salvato correttamente",number_of_features:"Numero di features"},panel:{button:{all:"TUTTI",save:"SALVA",test:"TEST",clear:"PULISCI",run:"ESEGUI",manual:"MANUALE"},layers:"LAYERS",fields:"CAMPI",values:"VALORI",operators:"OPERATORI",expression:"ESPRESSIONE"},error_run:"Si  verificato un errore. Verificare se la query  corretta",error_test:"Errore nell'esecuzione della query","delete":"Vuoi confermare la cancellazione?",additem:"Inserisci nome della ricerca"},errors:{layers:{load:"Alcuni layers presenti nel progetto non sono attualmente disponibili e quindi non compaiono nell'attuale visualizzazione"},unsupported_format:"Formato non supportato",add_external_layer:"Errore nel caricamento del layer"},metadata:{title:"Metadati",groups:{general:{title:"GENERALE",fields:{title:"TITOLO",name:"NOME",description:"DESCRIZIONE","abstract":"ABSTRACT",keywords:"LISTA DELLE PAROLE CHIAVE",fees:"CANONI",accessconstraints:"VINCOLI DI ACCESSO",contactinformation:"CONTATTI",subfields:{contactinformation:{contactelectronicmailaddress:"E-mail",personprimary:"Riferimenti",contactvoicetelephone:"Telefono",contactorganization:"Organizzazione",ContactOrganization:"Organizzazione",contactposition:"Posizione",ContactPosition:"Posizione",contactperson:"Persona",ContactPerson:"Persona"}},wms_url:"WMS"}},spatial:{title:"INFO SPAZIALI",fields:{crs:"EPSG",extent:"BBOX"}},layers:{title:"STRATI",groups:{general:"GENERALE",spatial:"INFO SPAZIALI"},fields:{layers:"STRATI",subfields:{crs:"EPSG",bbox:"BBOX",title:"TITOLO",name:"NOME",geometrytype:"GEOMETRIA",source:"SORGENTE",attributes:"ATTRIBUTI","abstract":"ABSTRACT",attribution:"ATTRIBUTION",keywords:"PAROLE CHIAVE",metadataurl:"METADATA URL",dataurl:"DATA URL"}}}}},tooltips:{relations:{form_to_row:"Visualizza formato Riga",row_to_form:"Visualizza formato Form"},zoom_to_features_extent:"Zoom sulle features",copy_map_extent_url:"Copia map view link",download_shapefile:"Scarica Shapefile",download_gpx:"Scarica GPX",download_gpkg:"Scarica GPKG",download_csv:"Scarica CSV",download_xls:"Scarica XLS",show_chart:"Mostra Grafico",atlas:"Stampa Atlas"},mapcontrols:{query:{tooltip:"Interroga Layer",actions:{add_selection:{hint:"Aggiungi/Rimuovi Selezione"},zoom_to_features_extent:{hint:"Zoom sulle features"},add_features_to_results:{hint:"Aggiungi features ai risultati"},remove_feature_from_results:{hint:"Rimuovi feature dai risultati"},zoom_to_feature:{hint:"Zoom sulla feature"},relations:{hint:"Visualizza Relazioni"},relations_charts:{hint:"Visualizza grafici relazioni"},download_features_shapefile:{hint:"Scarica features in Shapefile"},download_shapefile:{hint:"Scarica feature in Shapefile"},download_features_gpx:{hint:"Scarica features in GPX"},download_features_gpkg:{hint:"Scarica features in GPKG"},download_gpx:{hint:"Scarica feature in GPX"},download_gpkg:{hint:"Scarica feature in GPKG"},download_features_csv:{hint:"Scarica features in CSV"},download_csv:{hint:"Scarica feature in CSV"},download_features_xls:{hint:"Scarica features in XLS"},download_xls:{hint:"Scarica la feature in XLS"},atlas:{hint:"Stampa Atlas"},copy_zoom_to_fid_url:{hint:"Copia URL mappa con estensione a questa geometria",hint_change:"Copiato"}}},querybypolygon:{download:{title:"Download attributi",choiches:{feature:{label:"Solo features"},feature_polygon:{label:"Features+Poligono Interrogazione"}}},tooltip:"Interroga per poligono",no_geometry:"Non contiene la geometria nella risposta",help:{title:"Guida - Interrogazione con Poligono",message:'\n                <ul>\n                  <li">Seleziona uno strato poligonale in legenda.</li>\n                  <li>Assicurati che lo strato sia visibile in mappa.</li>\n                  <li>Clicca su una geometria dello strato selezionato.</li>\n                </ul>'}},querybybbox:{tooltip:"Interroga per BBOX",nolayers_visible:"Nessun layer interrogabile  visibile. Assicurarsi che almeno un layer wfs sia visibile per eseguire l'interrogazione",help:{title:"Guida - Interrogazione BBox",message:"\n                  <ul>\n                    <li>Disegna un rettangolo per interrogare gli strati evidenziati in giallo</li>\n                  </ul>\n            "}},addlayer:{messages:{csv:{warning:"Il risultato in mappa  parziale a causa della presenza dei seguenti records non corretti:"}},tooltip:"Aggiungi Layer"},geolocation:{tooltip:"Geolocalizzazione"},measures:{length:{tooltip:"Lunghezza",help:"Clicca sulla mappa per continuare a disegnare la linea.<br>CANC se si vuole cancellare l'ultimo vertice inserito"},area:{tooltip:"Area",help:"Clicca per continuare a disegnare il poligono.<br>CANC se si vuole cancellare l'ultimo vertice inserito"}},scale:{no_valid_scale:"Scala non valida"},scaleline:{units:{metric:"Metri",nautical:"Miglio Nautico"}}},relations:{relation_data:"Dati Relazione",no_relations_found:"Nessuna relazione trovata",back_to_relations:"Ritorna alle relazioni",list_of_relations_feature:"Lista delle relazioni della feature",error_missing_father_field:"Il campo relazionato non esiste"},workflow:{steps:{title:"Passi"},next:"Avanti"},form:{loading:"Caricamento ...",inputs:{messages:{errors:{picklayer:"Nessuna feature selezionata. Verificare se il layer  in editing o non visibile alla scala attuale"}},tooltips:{picklayer:"Prendi valore dalla mappa",lonlat:"Clicca sulla mappa per prendere le coordinate"},input_validation_mutually_exclusive:"Campo mutualmente esclusivo con ",input_validation_error:"Campo obbligatorio o tipo valore non corretto",input_validation_min_field:"Valore deve essere magiore uguale a quello del camp ",input_validation_max_field:"Valore deve essere minore uguale a quello del campo ",input_validation_exclude_values:"Campo deve contenere un valore diverso",integer:"intero",bigint:"intero",text:"testuale",varchar:"testuale",textarea:"testuale",string:"stringa",date:"data","float":"float",table:"table"},footer:{required_fields:"Campi obbligatori"},messages:{qgis_input_widget_relation:"Gestisci le relazioni tramite form dedicato"}},catalog:{current_map_theme_prefix:"TEMA",choose_map_theme:"SCEGLI TEMA",menu:{layerposition:"Posizione Layer",setwmsopacity:"Cambia opacit",wms:{title:"",copy:"Clicca qui per copiare url",copied:"Copiato"},download:{shp:"Scarica Shapefile",gpx:"Scarica GPX",gpkg:"Scarica GPKG",csv:"Scarica CSV",xls:"Scarica XLS",geotiff:"Scarica GEOTIFF",geotiff_map_extent:"Scarica GEOTIFF(estensione vista corrente)"}}},wps:{list_process:"Lista dei processi",tooltip:"Clicca sulla mappa"}},credits:{g3wSuiteFramework:"Applicativo realizzato con il framework OS",g3wSuiteDescription:"Pubblica e gestisci i tuoi progetti QGIS sul Web",productOf:"Framework sviluppato da"},toggle_color_scheme:"Cambia colore",logout:"Esci",no_other_projects:"Non ci sono altri progetti in questo gruppo cartografico",yes:"Si",no:"No",back:"Indietro",backto:"Torna a ",changemap:"Cambia Mappa",component:"Componente Generico",search:"Ricerche",no_results:"Nessun risultato trovato",print:"Stampa",create_print:"Crea Stampa",dosearch:"Cerca",catalog:"Mappa",data:"Dati",externalwms:"WMS",baselayers:"Basi",tools:"Strumenti",tree:"Strati",legend:"Legenda",nobaselayer:"Nessuna mappa di base",street_search:"Cerca indirizzo",show:"Mostra",hide:"Nascondi",copy_form_data:"Copia i dati del modulo",paste_form_data:"Incolla",copy_form_data_from_feature:"Copia i dati dalla mappa",error_map_loading:"Errore di caricamento della nuova mappa",check_internet_connection_or_server_admin:"Controllare la connessione internet o contattare l'amministratore",could_not_load_vector_layers:"Errore di connessione al server: non  stato possibile caricare i vettoriali richiesti",server_saver_error:"Errore nel salvataggio sul server",server_error:"Si  verificato un errore nella richiesta al server",save:"Salva",cancel:"Cancella",close:"Chiudi",enlange_reduce:"Allarga/Riduci",reset_default:"Dimensione Partenza",add:"Aggiungi",exitnosave:"Esci senza salvare",annul:"Annulla",layer_is_added:"Layer con stesso nome gi aggiunto",sidebar:{wms:{panel:{title:"Aggiungi WMS Layer",label:{position:"Posizione su Mappa",name:"Nome",projections:"Sistema di riferimento",layers:"Layers"}},add_wms_layer:"Aggiungi WMS layer",delete_wms_url:"Elimina WMS url",layer_id_already_added:"WMS Layer gi aggiunto",url_already_added:"WMS URL gi aggiunto",layer_add_error:"WMS Layer non aggiunto. Verificare i parametri o l'url"}},info:{title:"Risultati",open_link:"Apri documento allegato",server_error:"Si  verificato un errore nella richiesta al server",no_results:"Nessun risultato per questa interrogazione/ricerca ",link_button:"Apri"},mapcontrols:{geolocations:{title:"",error:"Non  possibile calcolare la tua posizione."},nominatim:{placeholder:"Indirizzo ...",noresults:"Nessun risultato",notresponseserver:"Il server non risponde"},add_layer_control:{header:"Aggiungi Layer",select_projection:"Seleziona il sistema di proiezione del layer",select_field_to_show:"Seleziona il campo da visualizzare sulla mappa",select_csv_separator:"Seleziona il separatore",select_csv_x_field:"Seleziona il campo X",select_csv_y_field:"Seleziona il campo Y",select_color:"Seleziona il colore del Layer",drag_layer:"Trascina il layer in questa area"},query:{input_relation:"Clicca per consultare le relazioni"},length:{tooltip:"Lunghezza"},area:{tooltip:"Area"},screenshot:{error:"Errore nella creazione dello screenshot"}},catalog_items:{helptext:"Tasto destro sui singoli layer per accedere alle funzionalit aggiuntive",contextmenu:{zoomtolayer:"Zoom to Layer",open_attribute_table:"Apri tabella attributi",show_metadata:"Metadati",styles:"Stili",vector_color_menu:"Setta/Cambia Colore"}},dataTable:{previous:"Precedente",next:"Successivo",lengthMenu:"Visualizza _MENU_",info:"Visualizzazione _START_ a _END_ su _TOTAL_ righe",nodatafilterd:"Nessun risultato trovato",infoFiltered:"(Filtrati da _MAX_ total righe)"}}}},{}],364:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={translation:{cookie_law:{message:"Acest website foloseste cookie-uri pentru a furniza vizitatorilor o experien mult mai bun de navigare",buttonText:"Am neles!"},"default":"Implicit",sign_in:"Logare",layer_selection_filter:{tools:{filter:"Adugare/Eliminare Filtrare",nofilter:"Eliminare Filtrare",invert:"Inversare Selecie",clear:"Elimin Selecia",show_features_on_map:"Arat entitile vizibile n cadrul hrii"}},warning:{not_supported_format:"Formatul nu este acceptat"},layer_position:{top:"SUS",bottom:"JOS",message:"Poziie relativ la straturile din TOC"},sdk:{search:{all:"Toate",no_results:"Fr rezultat",searching:"Cutare ...",error_loading:"ncrcarea a euat",layer_not_searchable:"Nu se poate cuta pe strat",layer_not_querable:"Stratul nu se poate interoga",autocomplete:{inputshort:{pre:"Te rog introdu",post:"sau mai multe caractere"}}},print:{no_layers:"Nu avem straturi de print",template:"ablon",labels:"Etichete",scale:"Scar",format:"Format",rotation:"Rotaie",download_image:"Descarc Imaginea",fids_instruction:"Valori acceptate: de la 1 la valoarea [max]. Este posibil inserarea de interval, de ex. 4-6",fids_example:"Ex. 1,4-6 vor fi tiprite id 1,4,5,6",help:"Straturile prezentate n print pot fi acelea definite n proiect i nu acelea prezentate n cadrul hrii"},querybuilder:{search:{run:"Execut",info:"Info","delete":"Elimin",edit:"Modific"},messages:{changed:"Salvat",number_of_features:"Numr de entiti"},panel:{button:{all:"TOATE",save:"SALVEAZ",test:"TEST",clear:"TERGE",run:"RUN",manual:"MANUAL"},layers:"STRATURI",fields:"CMPURI",values:"VALORI",operators:"OPERATORI",expression:"EXPRESII"},error_run:"A survenit o eroare. De verificat interogarea",error_test:"A survenit o eroare n timp ce se executa interogarea","delete":"Vrei s o tergi?",additem:"Introdu numele noii cutri"},errors:{layers:{load:"Cteva straturi nu sunt disponibile"},unsupported_format:"Formatul nu este acceptat",add_external_layer:"Eroare ncrcare strat"},metadata:{title:"Metadate",groups:{general:{title:"GENERALITI",fields:{title:"TITLU",name:"NUME",description:"DESCRIERE","abstract":"ABSTRACT",keywords:"CUVINTE CHEIE",fees:"TAXE",accessconstraints:"CONSTRNGERI DE ACCES",contactinformation:"CONTACTE",subfields:{contactinformation:{contactelectronicmailaddress:"Email",personprimary:"Referine",contactvoicetelephone:"Telefon",contactorganization:"Organizaie",ContactOrganization:"Organizaie",contactposition:"Poziie",ContactPosition:"Poziie",contactperson:"Persoana",ContactPerson:"Persoana"}},wms_url:"WMS"}},spatial:{title:"SPAIAL",fields:{crs:"EPSG",extent:"BBOX"}},layers:{title:"STRATURI",fields:{layers:"STRATURI",subfields:{crs:"EPSG",bbox:"BBOX",title:"TITLU",name:"NUME",geometrytype:"GEOMETRIE",source:"SURSA",attributes:"ATRIBUTE","abstract":"ABSTRACT",attribution:"ATRIBUIRE",keywords:"CUVINTE CHEIE",metadataurl:"URL METADATE",dataurl:"URL DATE"}},groups:{general:"GENERALITI",spatial:"SPAIAL"}}}},tooltips:{relations:{form_to_row:"Vizualizare pe rnduri",row_to_form:"Vizualizare formular"},copy_map_extent_url:"Copiaz linkul de vizualizare hart",download_shapefile:"Descarc Shapefile",download_gpx:"Descarc GPX",download_gpkg:"Descarc GPKG",download_csv:"Descarc CSV",download_xls:"Descarc XLS",show_chart:"Arat Diagrama",atlas:"Tiprire Atlas"},mapcontrols:{query:{tooltip:"Interogare strat",actions:{add_selection:{hint:"Adaug/Elimin Selecia"},zoom_to_features_extent:{hint:"Zoom la ncadrarea entitilor"},add_features_to_results:{hint:"Adaug/Elimin entiti rezultat"},remove_feature_from_results:{hint:"Elimin entitate din rezultat"},zoom_to_feature:{hint:"Zoom la entitate"},relations:{hint:"Arat Relaiile"},relations_charts:{hint:"Arat diagrama de relaii"},download_features_shapefile:{hint:"Descarc entiti n Shapefile"},download_shapefile:{hint:"Descarc entitate n Shapefile"},download_features_gpx:{hint:"Descarc entiti n GPX"},download_features_gpkg:{hint:"Descarc entiti n GPKG"},download_gpx:{hint:"Descarc entitate n GPX"},download_gpkg:{hint:"Descarc entitate n GPKG"},download_features_csv:{hint:"Descarc entiti n CSV"},download_csv:{hint:"Descarc entitate n CSV"},download_features_xls:{hint:"Descarc entiti n XLS"},download_xls:{hint:"Descarc entitate n XLS"},atlas:{hint:"Tiprire Atlas"},copy_zoom_to_fid_url:{hint:"Copiaz URL hart cu ntinderea geometriei entitii",hint_change:"Copiat"}}},querybypolygon:{download:{title:"Descrcare atribute",choiches:{feature:{label:"Doar entiti"},feature_polygon:{label:"Entiti+Poligon Interogare"}}},tooltip:"Interogare Dup Poligon",no_geometry:"Nu avem geometrii n rspuns",help:{title:"Ghid - Interogare Dup Poligon",message:"\n                <ul>\n                  <li>Selecteaz un strat poligon din TOC.</li>\n                  <li>Asigur-te c stratul este vizibil.</li>\n                  <li>Click pe o entitate a stratului selectat.</li>\n                </ul>"}},querybybbox:{tooltip:"Interogare BBox strat",nolayers_visible:"Nu este vizibil niciun strat de interogare. Trebuie setat cel puin un strat WFS vizibil pentru a efectua interogarea",help:{title:"Ghid - Interogare BBox strat",message:"\n                 <ul>\n                  <li>Deseneaz un ptrat pe hart pentru a interoga straturile din TOC de sub </li>\n                 </ul>"}},addlayer:{messages:{csv:{warning:"Rezultateul pe hart este parial datorit prezenei urmtoarei liste de rezultate incorecte:"}},tooltip:"Adaug Strat"},geolocation:{
tooltip:"Geolocalizare"},measures:{length:{tooltip:"Lungime",help:"Click pe hart pentru a desena linia. Apas <br>CANC dac doreti s tergi ultimul vertex"},area:{tooltip:"Aria",help:"Click pentru desen poligon. Apas <br>CANC dac doreti s tergi ultimul vertex"}},scale:{no_valid_scale:"Scar Invalid"},scaleline:{units:{metric:"Metri",nautical:"Mile Nautice"}}},relations:{relation_data:"Date Relaii",no_relations_found:"Nu am gsit nicio relaie",back_to_relations:"napoi la relaii",list_of_relations_feature:"Lista de relaii a entitii",error_missing_father_field:"Cmpul de legtur lipsete"},workflow:{steps:{title:"Pai"},next:"Urmtorul"},form:{loading:"Se ncarc ...",inputs:{messages:{errors:{picklayer:"Nu avem entitate selectat. Verific dac stratul este n editare sau vizibil la scara curent if layer is on editing or visible at current scale"}},tooltips:{picklayer:"Ia valoare din strat",lonlat:"Click pe hart pentru a prelua coordonate"},input_validation_mutually_exclusive:"Cmp ce se exclude mutual cu ",input_validation_error:"Cmp mandatoriu sau tip de date greit",input_validation_min_field:"Valoarea trebuie s fie mai mare/egal cu valoare cmpului ",input_validation_max_field:"Valoarea trebuie s fie mai mic/egal cu valoare cmpului ",input_validation_exclude_values:"Valoarea trebuie s fie unic",integer:"integer - nr. ntreg",bigint:"integer - nr. ntreg",text:"text",varchar:"text",textarea:"text",string:"string - text",date:"data","float":"float - nr. cu zecimale",table:"tabel"},footer:{required_fields:"Cmpuri necesare"},messages:{qgis_input_widget_relation:"Folosete formular specific de relaii pentru a lucra cu relaia"}},catalog:{current_map_theme_prefix:"TEMA",choose_map_theme:"ALEGE TEMA",menu:{layerposition:"Poziie Strat",setwmsopacity:"Alege Opacitatea",wms:{title:"Titlu",copy:"Click pentru copiere URL",copied:"Copiat"},download:{shp:"Descarc Shapefile",gpx:"Descarc GPX",gpkg:"Descarc GPKG",csv:"Descarc CSV",xls:"Descarc XLS",geotiff:"Descarc GEOTIFF",geotiff_map_extent:"Descarc GEOTIFF(ce se vede n cadrul hrii)"}}},wps:{list_process:"Lista de procese",tooltip:"Click pe hart"}},credits:{g3wSuiteFramework:"Aplicaie bazat pe frameworkul",g3wSuiteDescription:"Public i administreaz proiectele de QGIS pe WEB",productOf:"Framework dezvoltat de"},toggle_color_scheme:"Comutare schem de culori",logout:"Deconectare",no_other_projects:"No more project for this group",yes:"Da",no:"Nu",back:"napoi",backto:"napoi la ",changemap:"Schimbare Hart",component:"Component Generic",search:"Cutare",no_results:"Niciun rezultat gsit",print:"Tiprire",create_print:"Tiprete",dosearch:"Caut",catalog:"Hart",data:"Data",externalwms:"WMS",baselayers:"Straturi Baz",tools:"Instrumente",tree:"Straturi",legend:"Legend",nobaselayer:"Fr strat de baz",street_search:"Caut Adres",show:"Arat",hide:"Ascunde",copy_form_data:"Copiaz data",paste_form_data:"Lipete",copy_form_data_from_feature:"Copiaz data din hart",error_map_loading:"Sunt erori la ncrcarea hrii",check_internet_connection_or_server_admin:"Verificai conexiune de internet sau contactai administratorul de sistem",could_not_load_vector_layers:"Eroare de conexiune: Straturile nu pot fi ncrcate",server_saver_error:"Eroare la salvarea pe server",server_error:"Eroare de conexiune la server",save:"Salveaz",cancel:"Anuleaz",close:"nchide",enlange_reduce:"Mrete/Micoreaz",reset_default:"Mrimea implicit",add:"Adaug",exitnosave:"Ieire fr salvare",annul:"Anuleaz",layer_is_added:"Exist un strat cu acelai nume deja adugat",sidebar:{wms:{panel:{title:"Adaug strat WMS",label:{position:"Poziie Hart",name:"Nume",projections:"Proiecie",layers:"Straturi"}},add_wms_layer:"Adaug strat WMS",delete_wms_url:"terge URL WMS",layer_id_already_added:"Strat WMS deja adugat",url_already_added:"URL WMS deja adugat",layer_add_error:"Stratul WMS nu s-a adugat. Verificai URL-ul sau parametrii WMS"}},info:{title:"Rezultate",open_link:"Deschide document ataat",server_error:"Serverul a ntmpinat o eroare",no_results:"Niciun rezultat",link_button:"Deschide"},mapcontrols:{geolocations:{error:"Nu te-am putut localiza"},nominatim:{placeholder:"Adresa ...",noresults:"Niciun rezultat",notresponseserver:"Niciun rspuns de la server"},add_layer_control:{header:"Adugare Strat",select_projection:"Selecteaz proiecia strat",select_field_to_show:"Selecteaz cmpul de artat pe hart",select_csv_separator:"Selecteaz delimitatorul",select_csv_x_field:"Selecteaz cmpul X - Est",select_csv_y_field:"Selecteaz cmpul Y - Nord",select_color:"Selecteaz culoare strat",drag_layer:"Tragei stratul aici (Drag&Drop)"},query:{input_relation:"Click pentru a arta relaiile"},length:{tooltip:"Lungime"},area:{tooltip:"Arie"},screenshot:{error:"Eroare captur ecran"}},catalog_items:{helptext:"Click dreapta pe strat pentru a accesa opiuni",contextmenu:{zoomtolayer:"Zoom pe Strat",open_attribute_table:"Deschide Tabela Atribute",show_metadata:"Metadate",styles:"Stiluri",vector_color_menu:"Seteaz/Schimb Culoare"}},dataTable:{previous:"Anteriorul",next:"Urmtorul",lengthMenu:"Arat _MENU_",info:"Arat _START_ pn la _END_ din _TOTAL_ de intrri",no_data:"Fr date",nodatafilterd:"Niciun rezultat",infoFiltered:"(filtrat din _MAX_ de rezultate totale)"}}}},{}],365:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={translation:{cookie_law:{message:"This website uses cookies to ensure you get the best experience on our website.",buttonText:"Got It!"},"default":"standard",sign_in:"Logga in",layer_selection_filter:{tools:{filter:"Lgg till/Avlgsna Filtrera",nofilter:"Avlgsna Filtrera",invert:"Invertera Urval",clear:"Annullera Urval",show_features_on_map:"Visa funktioner som r synliga p kartan"}},warning:{not_supported_format:"Not supported format"},layer_position:{top:"TOP",bottom:"BOTTOM",message:"Position relative to layers on TOC"},sdk:{search:{all:"ALLA",no_results:"Inga resultat",searching:"Skning ...",error_loading:"Fel vid laddning av uppgifter.",layer_not_searchable:"Nivn kan inte skas.",layer_not_querable:"Frfrgningar kan inte gras p nivn.",autocomplete:{inputshort:{pre:"Mata in",post:"eller flera tecken"}}},print:{no_layers:"Inga niver att skriva ut",template:"Template",labels:"Labels",scale:"Skala",format:"Format",rotation:"Rotation",download_image:"Ladda ner bild",fids_instruction:"Godknda vrden: Frn ett till vrdet [max]. Mellanslag tillts, t.ex. 4-6.",fids_example:"Exempelvis 1,4-6 skriver ut id 1,4,5,6.",help:"Niverna p utskriften kan vara specificerade i ett projekt inte sdana som visas p karta."},querybuilder:{search:{run:"Utfr",info:"Information","delete":"Ta bort",edit:"Redigera"},messages:{changed:"Sparat",number_of_features:"Antal funktione"},panel:{button:{all:"ALLA",save:"SPARA",test:"TEST",clear:"TM",run:"UTFR",manual:"MANUELL"},layers:"NIVER",fields:"FLT",values:"VRDEN",operators:"OPERATRER",expression:"KLAUSUL"},error_run:"Ett fel intrffade. Kontrollera frfrgan.",error_test:"Ett fel intrffade nr frfrgan utfrdes.","delete":"Vill du ta bort den?",additem:"Ge den nya skningen ett namn."},errors:{layers:{load:"Vissa niver r inte tillgngliga."},unsupported_format:"Formatet stds inte",add_external_layer:"Fel vid laddning av nivn"},metadata:{title:"Metadata",groups:{general:{title:"ALLMN",fields:{title:"RUBRIK",name:"NAMN",description:"BESKRIVNING","abstract":"SAMMANDRAG",keywords:"NYCKELORD",fees:"AVGIFTER",accessconstraints:"TKOMSTBEGRNSNINGAR",contactinformation:"KONTAKTUPPGIFTER",subfields:{contactinformation:{contactelectronicmailaddress:"E-post",personprimary:"Referenser",contactvoicetelephone:"Telefon",contactorganization:"Organisation",ContactOrganization:"Organisation",contactposition:"Stllning",ContactPosition:"Stllning",contactperson:"Kontaktperson",ContactPerson:"Kontaktperson"}},wms_url:"WMS"}},spatial:{title:"SPATIAL",fields:{crs:"EPSG",extent:"BBOX"}},layers:{title:"NIVER",fields:{layers:"NIVER",subfields:{crs:"EPSG",bbox:"BBOX",title:"RUBRIK",name:"NAMN",geometrytype:"GEOMETRI",source:"KLLA",attributes:"ATTRIBUT","abstract":"SAMMANDRAG",attribution:"TILLSKRIVNING",keywords:"NYCKELORD",metadataurl:"METADATA URL",dataurl:"DATA URL"}},groups:{general:"ALLMN",spatial:"SPATIAL"}}}},tooltips:{relations:{form_to_row:"Radvy",row_to_form:"Tabellvy"},copy_map_extent_url:"Kopiera lnk till karta",download_shapefile:"Ladda SHP-fil",download_gpx:"Ladda GPX-fil",download_gpkg:"Ladda GPKG-fil",download_csv:"Ladda CSV-fil",download_xls:"Ladda XLS-fil",show_chart:"Visa diagram",atlas:"Skriv ut Atlas"},mapcontrols:{query:{tooltip:"Frfrgningsniv",actions:{add_selection:{hint:"Lgg till/Avlgsna Urval"},zoom_to_features_extent:{hint:"Zooma till egenskapens omfattning"},add_features_to_results:{hint:"Add/Remove features to results"},remove_feature_from_results:{hint:"Remove feature from results"},zoom_to_feature:{hint:"Zooma till egenskapen"},relations:{hint:"Visa relationerna"},relations_charts:{hint:"Visa relationsdiagrammet"},download_features_shapefile:{hint:"Ladda egenskapens SHP-fil"},download_shapefile:{hint:"Ladda egenskapens SHP-fil"},download_features_gpx:{hint:"Ladda egenskapens GPX-fil"},download_features_gpkg:{hint:"Ladda egenskapens GPKG-fil"},download_gpx:{hint:"Ladda egenskapens GPX-fil"},download_gpkg:{hint:"Ladda egenskapens GPKG-fil"},download_features_csv:{hint:"Ladda egenskapens CSV-fil"},download_csv:{hint:"Ladda egenskapens CSV-fil"},download_features_xls:{hint:"Ladda egenskapens XLS-fil"},download_xls:{hint:"Ladda egenskapens XLS-fil"},atlas:{hint:"Skriv ut Atlas"},copy_zoom_to_fid_url:{hint:"Copy map URL with this geometry feature extension",hint_change:"Copied"}}},querybypolygon:{download:{title:"Attributes download",choiches:{feature:{label:"Features only"},feature_polygon:{label:"Features+Query Polygon"}}},tooltip:"Frfrgan med polygon",no_geometry:"No geometry on response",help:{title:"Ohje - Frfrgan med polygon",message:"\n                <ul >\n                  <li>Vlj polygonniv i listan.</li>\n                  <li>Kontrollera att nivn r synlig.</li>\n                  <li>Vlj egenskap p nskad niv.</li>\n                </ul>"}},querybybbox:{tooltip:"BBox-frfrgan som riktar sig till en niv",nolayers_visible:"Inga niver som frfrgningar kan riktas till. Gr minst en WFS-niv synlig fr att kunna utfra skningen.",help:{title:"Ohje - BBox-frfrgan som riktar sig till nivn",message:"\n                 <ul>\n                  <li>Rita upp en rektangel p kartan fr att utfra frfrgan p de i listan understreckade niverna.</li>\n                 </ul>"}},addlayer:{messages:{csv:{warning:"The result in the map is partial due to the presence of the below incorrect records list:"}},tooltip:"Lgg till niv"},geolocation:{tooltip:"Geografiskt lge"},measures:{length:{tooltip:"Lngd",help:"Rita upp en bruten linje p kartan. Tryck <br>CANC, om du vill ta bort fregende punkt."},area:{tooltip:"Omrde",help:"Rita upp en polygon p kartan. Tryck <br>CANC, om du vill ta bort fregende punkt."}},scale:{no_valid_scale:"Fel skala"},scaleline:{units:{metric:"Meters",nautical:"Nautical Mile"}}},relations:{relation_data:"Relationsuppgifter",no_relations_found:"Inga relationer hittades.",back_to_relations:"Tillbaka till relationerna",list_of_relations_feature:"Lista p egenskapens relationer",error_missing_father_field:"Flt saknas"},workflow:{steps:{title:"Skeden"},next:"Nsta"},form:{loading:"Laddning...",inputs:{messages:{errors:{picklayer:"Inga egenskaper har valts. Kontroller att nivn kan redigeras eller att den syns med nuvarande skala."}},tooltips:{picklayer:"Vlj vrde p kartniv",lonlat:"Click on map to get coordinates"},input_validation_mutually_exclusive:"Flten utesluter varandra.",input_validation_error:"Obligatoriskt flt eller fel datatyp.",input_validation_min_field:"Vrdet ska vara strre eller lika stort som vrdet i fltet.",input_validation_max_field:"Vrdet ska vara mindre eller lika stort som vrdet i fltet.",input_validation_exclude_values:"Vrdet ska vara unikt.",integer:"heltal",bigint:"heltal",text:"text",varchar:"text",textarea:"text",string:"teckenstrng",date:"datum","float":"flyttal",table:"tabell"},footer:{required_fields:"Obligatoriska flt"},messages:{qgis_input_widget_relation:"Anvnd den specifika funktinen fr att bestmma relationer"}},catalog:{current_map_theme_prefix:"THEME",choose_map_theme:"CHOOSE THEME",menu:{layerposition:"Layer Position",setwmsopacity:"Set Opacity",wms:{title:"",copy:"Tryck hr fr att kopiera url.",copied:"Kopierad."},download:{shp:"Ladda SHP-fil",gpx:"Ladda GPX-fil",gpkg:"Ladda GPKG-fil",csv:"Ladda CSV-fil",xls:"Ladda XLS-fil",geotiff:"Ladda GEOTIFF-fil",geotiff_map_extent:"Ladda GEOTIFF-fil(current view extent)"}}},wps:{list_process:"Lista p processer",tooltip:"Vlj p kartan"}},credits:{g3wSuiteFramework:"Tillmpningen baserar p OS framework",g3wSuiteDescription:"Publicera och hantera QGIS-projekt p ntet.",productOf:"Framework har utvecklats av"},toggle_color_scheme:"Toggle color scheme",logout:"Logga ut",no_other_projects:"Inga projekt fr denna grupp",yes:"Ja",no:"Nej",back:"G tillbaka",backto:"Tillbaka ",changemap:"Byt karta",component:"Allmn komponent",search:"Sk",no_results:"Inga skresultat",print:"Skriv ut",create_print:"Skapa utskrift",dosearch:"Sk",catalog:"Karta",data:"Data",externalwms:"WMS",baselayers:"Bakgrundskarta",tools:"Verktyg",tree:"Niver",legend:"Frklaring till beteckningarna",nobaselayer:"Ingen bakgrundskarta",street_search:"Sk adress",show:"Visa",hide:"Dlj",copy_form_data:"Kopiera uppgifterna",paste_form_data:"Infoga",copy_form_data_from_feature:"Kopiera uppgifter frn kartan",error_map_loading:"Fel vid laddning av kartan",check_internet_connection_or_server_admin:"Kontrollera internetanslutningen eller kontakta administratren.",could_not_load_vector_layers:"Fel i anslutningen, niver kan inte laddas.",server_saver_error:"Fel vid lagring p servern.",server_error:"Fel p anslutningen till servern",save:"Spara",cancel:"nga",close:"Stng",enlange_reduce:"Enlarge/Reduce",reset_default:"Default size",add:"Lgg till",exitnosave:"Lmna programmet utan att spara",annul:"ngra",layer_is_added:"Lagret med samma namn har redan lagts till.",sidebar:{wms:{panel:{title:"Add WMS Layer",label:{position:"Map Position",name:"Name",projections:"Projection",layers:"Layers"}},add_wms_layer:"Aggiungi WMS layer",delete_wms_url:"Delete WMS url",layer_id_already_added:"WMS Nivn har redan lagts till.",url_already_added:"WMS URL har redan lagts till.",layer_add_error:"WMS Layer not added. Please check all wms parameter or url"}},info:{title:"Resultat",open_link:"ppna filbilaga",server_error:"Ett fel uppstod p servern.",no_results:"Inga resultat fr skningen/frfrgan.",link_button:"ppna"},mapcontrols:{geolocations:{error:"Du kan inte lokaliseras"},nominatim:{placeholder:"Adress ...",noresults:"Inga resultat",notresponseserver:"Inget svar frn servern"},add_layer_control:{header:"Lgg till niv",select_projection:"Vlj projektion fr nivn",select_field_to_show:"Select Field to show on map",select_csv_separator:"Select delimiter",select_csv_x_field:"Select X field",select_csv_y_field:"Select Y field",select_color:"Vlj frg p nivn",drag_layer:"Dra och slpp nivn hit"},query:{input_relation:"Tryck fr att visa relationerna"},length:{tooltip:"Lngd"},area:{tooltip:"Areal"},screenshot:{error:"Screenshot error creation"}},catalog_items:{helptext:"Hgerklicka p en enskild niv fr att komma till tillggsegenskaperna.",contextmenu:{zoomtolayer:"Zooma till niv",open_attribute_table:"ppna attributtabellen",show_metadata:"Metadata",styles:"Stilar",vector_color_menu:"Stll in/ndra frg"}},dataTable:{previous:"Fregende",next:"Nsta",lengthMenu:"Show _MENU_ items",info:"Showing _START_ to _END_ of _TOTAL_ entries",no_data:"Inga uppgifter",nodatafilterd:"Inga motsvarande poster hittades",infoFiltered:"(filtered from _MAX_ total records)"}}}},{}],366:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/catalog/cataloglayersstoresregistry");r["default"]={methods:{autocompleteRequest:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=n.layerId,o=n.field,s=n.value;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=[],t=i.getLayerById(a),r.prev=2,r.next=5,t.getFilterData({suggest:o+"|"+s,unique:o});case 5:e=r.sent,r.next=10;break;case 8:r.prev=8,r.t0=r["catch"](2);case 10:return r.abrupt("return",e.map(function(e){return{id:e,text:e}}));case 11:case"end":return r.stop()}},r,this,[[2,8]])}));return e}()}}},{"core/catalog/cataloglayersstoresregistry":9}],367:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={computed:{notvalid:function(){return this.state.validate.valid===!1},editable:function(){return this.state.editable},showhelpicon:function(){return this.state.help&&this.state.help.message.trim()}},methods:{showHideHelp:function(){this.state.help.visible=!this.state.help.visible},mobileChange:function(e){this.state.value=e.target.value,this.change()},change:function(){this.service.setEmpty(),this.state.validate.required&&this.service.validate(),this.$emit("changeinput",this.state)},isVisible:function(){}},mounted:function(){this.service&&this.service.has_default_value&&this.$emit("changeinput",this.state)}}},{}],368:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={methods:{getFieldService:function(){return void 0===this._fieldsService&&(this._fieldsService=e("gui/fields/fieldsservice")),this._fieldsService},getFieldType:function(e){return this.getFieldService().getType(e)},isSimple:function(e){return this.getFieldService().isSimple(e)},isLink:function(e){return this.getFieldService().isLink(e)},isImage:function(e){return this.getFieldService().isImage(e)},isPhoto:function(e){return this.getFieldService().isPhoto(e)},isVue:function(e){return this.getFieldService().isVue(e)},sanitizeFieldValue:function(e){return Array.isArray(e)&&!e.length?"":e}}}},{"gui/fields/fieldsservice":146}],369:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={data:function(){return{valid:!1}},methods:{addToValidate:function(e){this.tovalidate.push(e)},changeInput:function(e){this.isValid(e)},isValid:function(e){var t=this;if(e)if(e.validate.mutually){if(!e.validate.required)if(e.validate.empty){e.value=null,e.validate.mutually_valid=!0,e.validate.valid=!0,e.validate._valid=!0;for(var r=[],n=e.validate.mutually.length;n--;){var i=e.validate.mutually[n];!this.tovalidate[i].validate.empty&&r.push(i)}r.length<2&&r.forEach(function(e){t.tovalidate[e].validate.mutually_valid=!0,t.tovalidate[e].validate.valid=!0,setTimeout(function(){t.tovalidate[e].validate.valid=t.tovalidate[e].validate._valid,t.state.valid=t.state.valid&&t.tovalidate[e].validate.valid})})}else e.validate._valid=e.validate.valid,e.validate.mutually_valid=e.validate.mutually.reduce(function(e,r){return e&&t.tovalidate[r].validate.empty},!0),e.validate.valid=e.validate.mutually_valid&&e.validate.valid}else if(!e.validate.empty&&(e.validate.min_field||e.validate.max_field)){var a=e.validate.min_field||e.validate.max_field;e.validate.valid=e.validate.min_field?this.tovalidate[e.validate.min_field].validate.empty||1*e.value>1*this.tovalidate[e.validate.min_field].value:this.tovalidate[e.validate.max_field].validate.empty||1*e.value<1*this.tovalidate[e.validate.max_field].value,e.validate.valid&&(this.tovalidate[a].validate.valid=!0)}this.valid=Object.values(this.tovalidate).reduce(function(e,t){return e&&t.validate.valid},!0)}},created:function(){this.tovalidate=[]},destroyed:function(){this.tovalidate=null}}},{}],370:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("gui/gui");r["default"]={methods:{showLayer:function(){this.visible=!this.visible,this.layer.setVisible(this.visible)}},created:function(){var e=this.data,t=n.getComponent("map").getService(),r=t.getProjection().getCode(),i=void 0;switch(e.type){case"Point":case"MultiPoint":i=[new ol.style.Style({image:new ol.style.Circle({radius:6,fill:new ol.style.Fill({color:[255,255,255,1]}),stroke:new ol.style.Stroke({color:[0,0,0,1],width:2})})}),new ol.style.Style({image:new ol.style.Circle({radius:2,fill:new ol.style.Fill({color:[255,255,255,1]}),stroke:new ol.style.Stroke({color:[0,0,0,1],width:2})})})];break;case"Line":case"MultiLineString":case"Polygon":case"MultiPolygon":i=new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.3)"}),stroke:new ol.style.Stroke({color:[0,0,0,1],width:2})})}this.layer=new ol.layer.Vector({source:new ol.source.Vector({features:(new ol.format.GeoJSON).readFeatures(e,{featureProjection:r})}),visible:!!this.visible,style:i}),t.getMap().addLayer(this.layer)},beforeDestroy:function(){var e=n.getComponent("map").getService();e.getMap().removeLayer(this.layer)}}},{"gui/gui":150}],371:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0}),r.mixins=void 0;var i=e("mixins/autocomplete"),a=n(i),o=e("mixins/fields"),s=n(o),l=e("mixins/media"),u=n(l),c=e("mixins/geo"),d=n(c),p=e("mixins/resize"),f=n(p),h=e("mixins/select"),v=n(h),g=e("mixins/select2"),m=n(g),y=e("mixins/form-inputs"),_=n(y),b=e("mixins/widget"),w=n(b),x=e("mixins/metadata"),S=n(x),C=e("mixins/base-input"),L=n(C),k={autocompleteMixin:a["default"],fieldsMixin:s["default"],mediaMixin:u["default"],geoMixin:d["default"],resizeMixin:f["default"],selectMixin:v["default"],select2Mixin:m["default"],formInputsMixins:_["default"],widgetMixins:w["default"],metadataMixin:S["default"],baseInputMixin:L["default"]};r.mixins=k,r["default"]=k},{"mixins/autocomplete":366,"mixins/base-input":367,"mixins/fields":368,"mixins/form-inputs":369,"mixins/geo":370,"mixins/media":372,"mixins/metadata":373,"mixins/resize":374,"mixins/select":375,"mixins/select2":376,"mixins/widget":377}],372:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r["default"]={computed:{filename:function(){return this.value?this.value.split("/").pop():this.value}},methods:{isMedia:function(e){return!(!e||"object"!==("undefined"==typeof e?"undefined":n(e))||e.constructor!==Object)&&!!e.mime_type},getMediaType:function(e){var t={type:null,options:{}};switch(e){case"image/gif":case"image/png":case"image/jpeg":case"image/bmp":t.type="image";break;case"application/pdf":t.type="pdf";break;case"video/mp4":case"video/ogg":case"video/x-ms-wmv":case"video/x-msvideo":case"video/quicktime":t.type="video",t.options.format=e;break;case"application/gzip":case"application/zip":t.type="zip";break;case"application/msword":case"application/vnd.oasis.opendocument.text":t.type="text";break;case"application/vnd.ms-office":case"application/vnd.oasis.opendocument.spreadsheet":t.type="excel";break;case"application/vnd.openxmlformats-officedocument.presentationml.presentation":case"application/vnd.ms-powerpoint":case"application/vnd.oasis.opendocument.presentation":t.type="ppt";break;default:t.type="unknow"}return t}}}},{}],373:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={methods:{findAttributeFormMetadataAttribute:function(e){return!!this.state.metadata&&void 0!==this.state.metadata[e]},findMetadataAttribute:function(e){return void 0!==this.state[e]}}}},{}],374:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("gui/gui"),a=e("core/utils/utils"),o=a.throttle,s=a.debounce,l={throttle:o,debounce:s};r["default"]={created:function(){var e=this.delayType&&l[this.delayType]||l.throttle;this.delayResize=this.resize?e(this.resize.bind(this),this.delayTime):null,i.on("resize",this.delayResize)},mounted:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:this.resize&&this.resize();case 3:case"end":return e.stop()}},r,this)}));return e}(),beforeDestroy:function(){i.off("resize",this.delayResize),this.delayResize=null,this.delayTime=null}}},{"core/utils/utils":92,"gui/gui":150}],375:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/i18n/i18n.service"),a=i.getAppLanguage;r["default"]={methods:{getLanguage:function(){return a()},changeSelect:function(e){this.state.value="null"===e?null:e,this.change()},getValue:function(e){return null===e?"null":e},resetValues:function(){this.state.input.options.values.splice(0)}},computed:{autocomplete:function(){return"select_autocomplete"===this.state.input.type&&this.state.input.options.usecompleter},loadingState:function(){return this.state.input.options.loading?this.state.input.options.loading.state:null}},watch:{notvalid:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$nextTick();case 2:this.select2&&(e?this.select2.data("select2").$container.addClass("input-error-validation"):this.select2.data("select2").$container.removeClass("input-error-validation"));case 3:case"end":return t.stop()}},r,this)}));return e}()}}},{"core/i18n/i18n.service":27}],376:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/applicationstate"),a=n(i),o=e("mixins/resize"),s=n(o);r["default"]={mixins:[s["default"]],methods:{setValue:function(){this.select2.val(this.state.value).trigger("change")},resize:function(){this.select2&&!a["default"].ismobile&&this.select2.select2("close")}},beforeDestroy:function(){this.select2&&this.select2.select2("destroy"),this.select2.off(),this.select2=null}}},{"core/applicationstate":8,"mixins/resize":374}],377:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]={data:function(){return{changed:!1}},methods:{widgetChanged:function(){this.changed=!0,this.change()},stateValueChanged:function(e){}},watch:{"state.value":function(e){this.changed?this.changed=!1:this.stateValueChanged(e)}}}},{}],378:[function(e,t,r){function n(){this._config=null,this._baseUrl=null,this.init=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=$.Deferred();return this._config=e,this._baseUrl=e.urls.api,this._apiEndpoints=e.urls.apiEndpoints,t.resolve(),t.promise()};var e=0;this._incrementLoaders=function(){0===e&&this.emit("apiquerystart"),e+=1},this._decrementLoaders=function(){e-=1,0===e&&this.emit("apiqueryend")},this.get=function(e,t){var r=this,n=this._apiEndpoints[e];if(n){var i=this._baseUrl+"/"+n;t.request&&(i=i+"/"+t.request);var a=t.params||{};return this.emit(e+"querystart"),this._incrementLoaders(),$.get(i,a).done(function(t){return r.emit(e+"queryend",t),t}).fail(function(t){return r.emit(e+"queryfail",t),t}).always(function(){return r._decrementLoaders()})}return s()},a(this)}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=i.reject,l=e("core/g3wobject");o(n,l),r["default"]=new n},{"core/g3wobject":26,"core/utils/utils":92}],379:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}Object.defineProperty(r,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("config"),s=n(o),l=e("app/constant"),u=e("core/applicationstate"),c=n(u),d=e("core/i18n/i18n.service"),p=d.init,f=d.changeLanguage,h=e("core/utils/utils"),v=h.base,g=h.inherit,m=h.XHR,y=h.uniqueId,_=e("core/g3wobject"),b=e("core/apiservice"),w=e("core/router"),x=e("core/data/routerservice"),S=e("core/project/projectsregistry"),C=e("core/plugin/pluginsregistry"),L=e("core/clipboardservice"),k=e("gui/gui"),M=function(){var t=this;this.version=l.APP_VERSION,c["default"].iframe=window.top!==window.self,c["default"].online=navigator.onLine,c["default"].ismobile=isMobile.any,this.complete=!1,this.baseurl="/",this.download_caller_id=null,this._applicationServices={},this.config={},this._initConfigUrl=null,this._initConfig=null,this._groupId=null,this._gid=null,this.setters={changeProject:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.gid,r=e.host;return this._changeProject({gid:t,host:r})},online:function(){this.setOnline()},offline:function(){this.setOffline()},setFilterToken:function(e){this._setFilterToken(e)}},v(this),this.on("initconfig",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.user;t.setApplicationUser(r)}),this.init=i(regeneratorRuntime.mark(function r(){var e,t,n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,this.createApplicationConfig();case 3:return e=r.sent,this.setConfig(e),this.setLayout("app",e.layout),r.next=8,this.bootstrap();case 8:return r.abrupt("return",r.sent);case 11:return r.prev=11,r.t0=r["catch"](0),t=navigator&&navigator.language||"en",n=s["default"].supportedLng.find(function(e){return t.indexOf(e)!==-1}),r.abrupt("return",Promise.reject({error:r.t0,language:n}));case 16:case"end":return r.stop()}},r,this,[[0,11]])})),this.setupI18n=function(){var e=this._config._i18n;e.appLanguages=this._config.i18n.map(function(e){return e[0]}),this.setApplicationLanguage(e.lng),p(e),this._groupId=this._config.group.slug||this._config.group.name.replace(/\s+/g,"-").toLowerCase();var t=this._config.user.i18n||"en";$.ajaxSetup({beforeSend:function(e){e.setRequestHeader("Accept-Language",t)}})},this.getCurrentProject=function(){return S.getCurrentProject()},this.setDownload=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments[1];return t?!e&&t&&this.download_caller_id===t?(c["default"].download=!1,this.download_caller_id=null):e&&null===this.download_caller_id&&(c["default"].download=e,this.download_caller_id=y()):c["default"].download=e,this.download_caller_id},this.getDownload=function(){return c["default"].download},this.loadingPlugin=function(e){c["default"].plugins.push(e)},this.loadedPlugin=function(e){c["default"].plugins=c["default"].plugins.filter(function(t){return t!==e})},this._setFilterToken=function(e){c["default"].tokens.filtertoken=e},this.getFilterToken=function(){return c["default"].tokens.filtertoken},this.changeLanguage=function(e){f(e),c["default"].lng=e;var t=window.location.pathname,r=t.split("/");r[1]=e,history.replaceState(null,null,r.join("/"));
},this.registerOnlineOfflineEvent=function(){var e=this;this.registerWindowEvent({evt:"online",cb:function(){return e.online()}}),this.registerWindowEvent({evt:"offline",cb:function(){return e.offline()}})},this.getBaseLayerId=function(){return c["default"].baseLayerId},this.setBaseLayerId=function(e){c["default"].baseLayerId=e},this.registerLeavePage=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.bool,r=void 0!==t&&t,n=(e.message,r?r:void 0);window.onbeforeunload=function(e){return n}},this.unregisterOnlineOfflineEvent=function(){window.removeEventListener("online"),window.removeEventListener("offline")},this.getState=function(){return c["default"]},this.disableApplication=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];c["default"].gui.app.disabled=e},this.setApplicationLanguage=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en";c["default"].lng=e},this.getApplicationLanguage=function(){return c["default"].lng},this.setOnline=function(){c["default"].online=!0},this.setOffline=function(){c["default"].online=!1},this.isOnline=function(){return c["default"].online},this.setOfflineItem=function(){var e=i(regeneratorRuntime.mark(function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.setLocalItem({id:e,data:r});case 1:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),this.setLocalItem=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,r=e.data;try{var n=JSON.stringify(r);window.localStorage.setItem(t,n)}catch(i){return i}},this.removeLocalItem=function(e){window.localStorage.removeItem(e)},this.getLocalItem=function(e){var t=window.localStorage.getItem(e);return t?JSON.parse(t):void 0},this.getOfflineItem=function(e){return this.getLocalItem(e)},this.removeOfflineItem=function(e){this.removeLocalItem(e)},this.isIframe=function(){return c["default"].iframe},this.getConfig=function(){return this._config},this.setConfig=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._config=e},this.getRouterService=function(){return w},this.getProxyUrl=function(){return""+this._initConfig.proxyurl},this.getInterfaceOwsUrl=function(){return""+this._initConfig.interfaceowsurl},this.getClipboardService=function(){return L},this.createApplicationConfig=function(){var e=i(regeneratorRuntime.mark(function t(e){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=a({},s["default"]),t.prev=1,!e){t.next=6;break}t.t0=e,t.next=9;break;case 6:return t.next=8,this.obtainInitConfig({initConfigUrl:""+s["default"].server.urls.initconfig});case 8:t.t0=t.sent;case 9:return e=t.t0,this.baseurl=e.baseurl,r.server.urls.baseurl=e.baseurl,r.server.urls.frontendurl=e.frontendurl,r.server.urls.staticurl=e.staticurl,r.server.urls.clienturl=e.staticurl+e.client,r.server.urls.mediaurl=e.mediaurl,r.server.urls.vectorurl=e.vectorurl,r.server.urls.proxyurl=e.proxyurl,r.server.urls.rasterurl=e.rasterurl,r.server.urls.interfaceowsurl=e.interfaceowsurl,r.main_map_title=e.main_map_title,r.group=e.group,r.user=e.user,r.credits=e.credits,r.i18n=e.i18n,r._i18n.lng=r.user.i18n,r.group.layout.iframe=window.top!==window.self,t.abrupt("return",{apptitle:r.apptitle||"",logo_img:r.group.header_logo_img,logo_link:r.group.header_logo_link,terms_of_use_text:r.group.header_terms_of_use_text,terms_of_use_link:r.group.terms_of_use_link,header_custom_links:r.group.header_custom_links,debug:r.client.debug||!1,group:r.group,urls:r.server.urls,mediaurl:r.server.urls.mediaurl,resourcesurl:r.server.urls.clienturl,vectorurl:r.server.urls.vectorurl,rasterurl:r.server.urls.rasterurl,interfaceowsurl:r.server.urls.interfaceowsurl,projects:r.group.projects,initproject:r.group.initproject,overviewproject:r.group.overviewproject&&r.group.overviewproject.gid?r.group.overviewproject:null,baselayers:r.group.baselayers,mapcontrols:r.group.mapcontrols,background_color:r.group.background_color,crs:r.group.crs,minscale:r.group.minscale,maxscale:r.group.maxscale,main_map_title:r.main_map_title,credits:r.credits,_i18n:r._i18n,i18n:r.i18n,layout:r.group.layout||{},getWmsUrl:function(e){return r.server.urls.baseurl+r.server.urls.ows+"/"+r.group.id+"/"+e.type+"/"+e.id+"/"},getProjectConfigUrl:function(e){return r.server.urls.baseurl+r.server.urls.config+"/"+r.group.id+"/"+e.type+"/"+e.id+"?_t="+e.modified},plugins:r.group.plugins,tools:r.tools,views:r.views||{},user:r.user||null});case 30:return t.prev=30,t.t1=t["catch"](1),t.abrupt("return",Promise.reject(t.t1));case 33:case"end":return t.stop()}},t,this,[[1,30]])}));return function(t){return e.apply(this,arguments)}}(),this.obtainInitConfig=i(regeneratorRuntime.mark(function n(){var t,r,i,a,o,s,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=l.initConfigUrl,c=l.url,d=l.host;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(this._initConfigUrl?this.clearInitConfig():this._initConfigUrl=u,!window.initConfig){n.next=8;break}return this._initConfig=window.initConfig,this.setInitVendorKeys(initConfig),this.emit("initconfig",initConfig),n.abrupt("return",window.initConfig);case 8:if(e("app/dev/index"),t=void 0,r=void 0,i=c?c.split("?")[1]:location.search?location.search.substring(1):null,i?(r=i.split("&"),r.forEach(function(e){e.indexOf("project")>-1&&(t=e.split("=")[1])})):(a=this._gid.split(":").join("/"),t=this._groupId+"/"+a),!t){n.next=33;break}return o=""+(d||"")+this.baseurl+this._initConfigUrl+"/"+t,n.prev=15,n.next=18,this.getInitConfig(o);case 18:return s=n.sent,s.staticurl="../dist/",s.clienturl="../dist/",this._initConfig=s,window.initConfig=s,this.setInitVendorKeys(s),n.abrupt("return",s);case 27:return n.prev=27,n.t0=n["catch"](15),n.abrupt("return",Promise.reject(n.t0));case 30:return n.prev=30,this.emit("initconfig",initConfig),n.finish(30);case 33:case"end":return n.stop()}},n,this,[[15,27,30,33]])})),this.getInitConfig=function(e){var t=this;return new Promise(function(r,n){t._initConfig?r(t._initConfig):m.get({url:e}).then(function(e){return r(e)})["catch"](function(e){return n(e)})})},this.getInitConfigUrl=function(){return this._initConfigUrl},this.setInitConfigUrl=function(e){this._initConfigUrl=e},this.postBootstrap=i(regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.complete){e.next=13;break}return e.prev=1,w.init(),e.next=5,this._bootstrapPlugins();case 5:e.next=9;break;case 7:e.prev=7,e.t0=e["catch"](1);case 9:return e.prev=9,this.complete=!0,this.emit("complete"),e.finish(9);case 13:case"end":return e.stop()}},o,this,[[1,7,9,13]])})),this._bootstrapPlugins=function(){return C.init({pluginsBaseUrl:this._config.urls.staticurl,pluginsConfigs:this._config.plugins,otherPluginsConfig:S.getCurrentProject().getState()})},this.setEPSGApplication=function(e){c["default"].map.epsg=e.state.crs.epsg},this.setApplicationUser=function(e){c["default"].user=e},this.getApplicationUser=function(){return c["default"].user},this.bootstrap=function(){var e=this;return new Promise(function(t,r){e.setupI18n();var n=setTimeout(function(){r("Timeout")},l.TIMEOUT);c["default"].ready||$.when(S.init(e._config),b.init(e._config)).then(function(){clearTimeout(n),e.registerOnlineOfflineEvent(),e.emit("ready"),c["default"].ready=e.initialized=!0;var r=S.getCurrentProject();e._gid=r.getGid(),e.setEPSGApplication(r),c["default"].iframe&&e.startIFrameService({project:r}),x.init(),t(!0)}).fail(function(e){return r(e)})})},this.startIFrameService=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.project,n=e("core/iframe/routerservice");n.init({project:r})},this.registerWindowEvent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.evt,r=e.cb;window.addEventListener(t,r)},this.unregisterWindowEvent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.evt,r=e.cb;window.removeEventListener(t,r)},this.registerService=function(e,t){this._applicationServices[e]=t},this.unregisterService=function(e){delete this._applicationServices[e]},this.getApplicationService=function(e){return this._applicationServices[e]},this.getService=function(e){return this._applicationServices[e]},this.errorHandler=function(e){},this.clearInitConfig=function(){window.initConfig=this._initConfig=null},this.setInitVendorKeys=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.group.vendorkeys||{};e.group.baselayers.forEach(function(e){if(e.apikey){var r=e.servertype?e.servertype.toLowerCase():null;t[r]=e.apikey}}),this.setVendorKeys(t)},this.setVendorKeys=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.keys(e).forEach(function(t){return c["default"].keys.vendorkeys[t]=e[t]})},this.changeProjectView=function(e){c["default"].changeProjectview=e},this.isProjectViewChanging=function(){return c["default"].changeProjectview},this.reloadCurrentProject=function(){return this.changeProject({gid:S.getCurrentProject().getGid()})},this._changeProject=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.gid,r=(e.host,$.Deferred());this._gid=t;var n=S.getProjectUrl(t),i=k.getService("map").addMapExtentUrlParameterToUrl(n);return history.replaceState(null,null,i),location.replace(i),r.resolve(),r.promise()},this.setLayout=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"app",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.rightpanel?(t.rightpanel.width=t.rightpanel.width||50,t.rightpanel.height=t.rightpanel.height||50,t.rightpanel.width_default=t.rightpanel.width,t.rightpanel.height_default=t.rightpanel.height,t.rightpanel.width_100=!1,t.rightpanel.height_100=!1):t.rightpanel={width:50,height:50,width_default:50,height_default:50,width_100:!1,height_100:!1},c["default"].gui.layout[e]=t},this.removeLayout=function(e){e&&delete c["default"].gui.layout[e]},this.setCurrentLayout=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"app";c["default"].gui.layout.__current=e},this.getCurrentLayout=function(){return c["default"].gui.layout[c["default"].gui.layout.__current]},this.getCurrentLayoutName=function(){return c["default"].gui.layout.__current},this.cloneLayout=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"app";return JSON.parse(JSON.stringify(c["default"].gui.layout[e]))},this.clear=function(){this.unregisterOnlineOfflineEvent()}};g(M,_),r["default"]=new M},{"app/constant":5,"app/dev/index":1,config:343,"core/apiservice":6,"core/applicationstate":8,"core/clipboardservice":10,"core/data/routerservice":15,"core/g3wobject":26,"core/i18n/i18n.service":27,"core/iframe/routerservice":28,"core/plugin/pluginsregistry":80,"core/project/projectsregistry":83,"core/router":87,"core/utils/utils":92,"gui/gui":150}],380:[function(e,t,r){function n(){this._data={},this.set=function(e,t){var r=e.split("form")[0];this._data[r]=t},this.get=function(e){var t=this._data[e]||{};return this._data[e]={},t}}Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=new n},{}],381:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function i(){o(this),this.expression=function(){var e=n(regeneratorRuntime.mark(function t(e){var r,n,i,a=e.qgs_layer_id,o=e.layer_id,s=e.form_data,l=e.expression,u=e.formatter,c=void 0===u?1:u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=""+this.project.getUrl("vector_data")+o+"/",e.next=3,this.handleRequest({url:r,params:{qgs_layer_id:a,form_data:s,expression:l,formatter:c}});case 3:return n=e.sent,i=this.handleResponse(n),e.abrupt("return",i);case 6:case"end":return e.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),this.expression_eval=n(regeneratorRuntime.mark(function e(){var t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.qgs_layer_id,a=n.form_data,o=n.expression,s=n.formatter,l=void 0===s?1:s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.project.getUrl("expression_eval"),e.next=3,this.handleRequest({url:t,params:{qgs_layer_id:i,form_data:a,expression:o,formatter:l}});case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)})),this.handleRequest=n(regeneratorRuntime.mark(function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.url,i=r.params,a=void 0===i?{}:i,o=r.contentType,s=void 0===o?"application/json":o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=void 0,t.prev=1,t.next=4,c.post({url:n,contentType:s,data:JSON.stringify(a)});case 4:e=t.sent,t.next=9;break;case 7:t.prev=7,t.t0=t["catch"](1);case 9:return t.abrupt("return",e);case 10:case"end":return t.stop()}},t,this,[[1,7]])})),this.handleResponse=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return p(e)}}Object.defineProperty(r,"__esModule",{value:!0});var a=e("core/utils/utils"),o=a.base,s=a.inherit,l=e("core/data/service"),u=e("core/utils/utils"),c=u.XHR,d=e("core/utils/geo"),p=d.getFeaturesFromResponseVectorApi;s(i,l),r["default"]=new i},{"core/data/service":17,"core/utils/geo":89,"core/utils/utils":92}],382:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function i(){o(this),this.wmsCapabilities=n(regeneratorRuntime.mark(function t(){var r,n,i,a,o,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=s.url;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e("core/applicationservice"),n=""+r.getInterfaceOwsUrl(),t.prev=2,i={url:l,service:"wms"},a=JSON.stringify(i),t.next=7,c.post({url:n,contentType:"application/json",data:a});case 7:return o=t.sent,t.abrupt("return",o);case 11:return t.prev=11,t.t0=t["catch"](2),t.abrupt("return");case 14:case"end":return t.stop()}},t,this,[[2,11]])}))}Object.defineProperty(r,"__esModule",{value:!0});var a=e("core/utils/utils"),o=a.base,s=a.inherit,l=e("core/data/service"),u=e("core/utils/utils"),c=u.XHR;s(i,l),r["default"]=new i},{"core/applicationservice":7,"core/data/service":17,"core/utils/utils":92}],383:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function i(){o(this),this.wms=n(regeneratorRuntime.mark(function t(){var r,n,i,a,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=o.url,l=o.method,u=void 0===l?"GET":l,d=o.params,p=void 0===d?{}:d,f=o.headers,h=void 0===f?{}:f;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e("core/applicationservice"),n=""+r.getProxyUrl(),"GET"===u&&(s=new URL(s),Object.keys(p).forEach(function(e){return s.searchParams.set(e,p[e])}),s=s.toString()),t.prev=3,i=JSON.stringify({url:s,params:p,headers:h,method:u}),t.next=7,c.post({url:n,contentType:"application/json",data:i});case 7:return a=t.sent,t.abrupt("return",{response:a,data:i});case 11:return t.prev=11,t.t0=t["catch"](3),t.abrupt("return");case 14:case"end":return t.stop()}},t,this,[[3,11]])})),this.data=function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}}}Object.defineProperty(r,"__esModule",{value:!0});var a=e("core/utils/utils"),o=a.base,s=a.inherit,l=e("core/data/service"),u=e("core/utils/utils"),c=u.XHR;s(i,l),r["default"]=new i},{"core/applicationservice":7,"core/data/service":17,"core/utils/utils":92}],384:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function i(){s(this),this.condition={filtrable:{ows:"WFS"}},this.polygon=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.feature,r=e.feature_count,n=void 0===r?this.project.getQueryFeatureCount():r,i=e.filterConfig,o=void 0===i?{}:i,s=e.multilayers,l=void 0!==s&&s,u=e.condition,d=void 0===u?this.condition:u,p=e.excludeLayers,f=void 0===p?[]:p,v=f[0],m=t.get(a.G3W_FID),y=t.getGeometry();if(!y)return this.returnExceptionResponse({usermessage:{type:"warning",message:v.getName()+" - "+c("sdk.mapcontrols.querybypolygon.no_geometry"),messagetext:!0,autoclose:!1}});var _={SELECTED:!1,FILTERABLE:!0,VISIBLE:!0},b=g(_,d).filter(function(e){return f.indexOf(e)===-1}),w=h(b,{geometry:y,multilayers:l,feature_count:n,filterConfig:o,projection:this.project.getProjection()});return this.handleRequest(w,{fid:m,geometry:y,layer:v,type:"polygon"})},this.bbox=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.bbox,r=e.feature_count,n=void 0===r?this.project.getQueryFeatureCount():r,i=e.filterConfig,a=void 0===i?{}:i,o=e.multilayers,s=void 0!==o&&o,l=e.condition,u=void 0===l?this.condition:l,c=e.layersFilterObject,d=void 0===c?{SELECTEDORALL:!0,FILTERABLE:!0,VISIBLE:!0}:c,p=g(d,u),f=v(p,{bbox:t,feature_count:n,filterConfig:a,multilayers:s});return this.handleRequest(f,{bbox:t,type:"bbox"})},this.coordinates=n(regeneratorRuntime.mark(function e(){var t,r,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=i.coordinates,s=i.layerIds,l=void 0===s?[]:s,u=i.multilayers,c=void 0!==u&&u,d=i.query_point_tolerance,p=void 0===d?a.QUERY_POINT_TOLERANCE:d,h=i.feature_count;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={QUERYABLE:!0,SELECTEDORALL:0===l.length,VISIBLE:!0},Array.isArray(l)&&l.forEach(function(e){t.IDS||(t.IDS=[]),t.IDS.push(e)}),r=g(t),n=f(r,{multilayers:c,feature_count:h,query_point_tolerance:p,coordinates:o}),e.abrupt("return",this.handleRequest(n,{coordinates:o,type:"coordinates"}));case 5:case"end":return e.stop()}},e,this)})),this.handleRequest=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(n,i){e.then(function(e){var i=t.handleResponse(e,r);n(i)}).fail(i)})},this.handleResponse=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e,n={query:t,type:"ows",data:[],result:!0};return r.forEach(function(e){return e.data&&e.data.forEach(function(e){return n.data.push(e)})}),n},this.returnExceptionResponse=function(){var e=n(regeneratorRuntime.mark(function t(e){var r=e.usermessage;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{data:[],usermessage:r,result:!0,error:!0});case 1:case"end":return e.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}()}Object.defineProperty(r,"__esModule",{value:!0});var a=e("constant"),o=e("core/utils/utils"),s=o.base,l=o.inherit,u=e("core/i18n/i18n.service"),c=u.t,d=e("core/data/service"),p=e("core/utils/geo"),f=p.getQueryLayersPromisesByCoordinates,h=p.getQueryLayersPromisesByGeometry,v=p.getQueryLayersPromisesByBBOX,g=p.getMapLayersByFilter;l(i,d),r["default"]=new i},{constant:5,"core/data/service":17,"core/i18n/i18n.service":27,"core/utils/geo":89,"core/utils/utils":92}],385:[function(e,t,r){function n(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(){l(this),this.features=i(regeneratorRuntime.mark(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{layer:layer,search_endpoint:search_endpoint,filter:filter,raw:!1,queryUrl:queryUrl,feature_count:feature_count,ordering:ordering};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i(regeneratorRuntime.mark(function r(){var e,i,a,s,l,u,c,d,p,f,h;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=[],i=t.layer,a=n(t,["layer"]),s=t.raw,l=void 0!==s&&s,u=t.filter,c={data:[],query:{type:"search",search:u},type:a.search_endpoint},d=Array.isArray(i)?i:[i],a.filter=Array.isArray(a.filter)?a.filter:[a.filter],"api"===a.search_endpoint?d.forEach(function(t,r){return e.push(t.searchFeatures(o({},a,{filter:a.filter[r]})))}):(p=d[0].getProvider("search"),f=new Promise(function(e,t){p.query(o({},a,{layers:d},d[0].getSearchParams())).then(function(t){e({data:t})}).fail(t)}),e.push(f)),r.next=9,Promise.allSettled(e);case 9:return h=r.sent,h.forEach(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.status,r=e.value;if("fulfilled"===t)if(l)c.data.push("api"===a.search_endpoint?{data:r}:r);else{var n=r.data,i=void 0===n?[]:n;"api"===a.search_endpoint?i.length&&c.data.push(i[0]):c.data=i}}),r.abrupt("return",c);case 12:case"end":return r.stop()}},r,this)}))());case 1:case"end":return e.stop()}},e,this)})),this.fids=i(regeneratorRuntime.mark(function t(){var e,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.layer,a=n.formatter,o=void 0===a?0:a,s=n.fids,l=void 0===s?[]:s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e={data:[{layer:i,features:[]}],query:{type:"search"}},t.prev=1,t.t0=i,!t.t0){t.next=7;break}return t.next=6,i.getFeatureByFids({fids:l,formatter:o});case 6:t.t0=t.sent;case 7:r=t.t0,r&&r.forEach(function(t){return e.data[0].features.push(d(t))}),t.next=13;break;case 11:t.prev=11,t.t1=t["catch"](1);case 13:return t.abrupt("return",e);case 14:case"end":return t.stop()}},t,this,[[1,11]])})),this.layersfids=i(regeneratorRuntime.mark(function r(){var e,t,n,i=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=a.layers,s=void 0===o?[]:o,l=a.fids,u=void 0===l?[]:l,c=a.formatter,d=void 0===c?0:c;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=[],t={data:[],query:{type:"search"}},s.forEach(function(t,r){e.push(i.fids({layer:t,fids:u[r],formatter:d}))}),r.prev=3,r.next=6,Promise.all(e);case 6:n=r.sent,n.forEach(function(e){return t.data.push(e.data)}),r.next=13;break;case 10:r.prev=10,r.t0=r["catch"](3);case 13:return r.abrupt("return",t);case 14:case"end":return r.stop()}},r,this,[[3,10]])}))}Object.defineProperty(r,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=e("core/utils/utils"),l=s.base,u=s.inherit,c=e("core/utils/geo"),d=c.createOlFeatureFromApiResponseFeature,p=e("core/data/service");u(a,p),r["default"]=new a},{"core/data/service":17,"core/utils/geo":89,"core/utils/utils":92}],386:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function i(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function a(){this.defaultoutputplaces=["gui"],this.currentoutputplaces=[].concat(i(this.defaultoutputplaces)),this.ouputplaces={gui:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return h.setLoadingContent(!0),r.prev=1,h.outputDataPlace(e,t),r.next=5,e;case 5:r.next=9;break;case 7:r.prev=7,r.t0=r["catch"](1);case 9:h.setLoadingContent(!1);case 10:case"end":return r.stop()}},r,this,[[1,7]])}));return e}(),iframe:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:d.outputDataPlace(e,t);case 1:case"end":return r.stop()}},r,this)}));return e}()},this.init=n(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.services={query:o,search:s,expression:l,proxy:u,ows:c};case 1:case"end":return e.stop()}},e,this)})),this.getData=function(){var e=n(regeneratorRuntime.mark(function t(e){var r,n,i,a,o,s,l,u,c,d,p=this,h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=f(e),n=r.context,i=r.method,a=this.getService(n),o=h.inputs,s=void 0===o?{}:o,l=h.outputs,u=void 0===l?{}:l,c=a[i](s),u&&this.currentoutputplaces.forEach(function(e){p.ouputplaces[e](c,u)}),t.next=7,c;case 7:return d=t.sent,t.next=10,d;case 10:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),this.showEmptyOutputs=function(){var e=this,t=Promise.resolve({data:[]});this.currentoutputplaces.forEach(function(r){e.ouputplaces[r](t)})},this.showCustomOutputDataPromise=function(e){var t=this;this.currentoutputplaces.forEach(function(r){t.ouputplaces[r](e,{})})},this.getService=function(e){return this.services[e]},this.setOutputPlaces=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.currentoutputplaces=e},this.addCurrentOutputPlace=function(e){e&&this.currentoutputplaces.indexOf(e)===-1&&this.currentoutputplaces.push(e)},this.addNewOutputPlace=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.place,r=e.method,n=void 0===r?function(){}:r,i=!1;return void 0===this.ouputplaces[t]&&(this.ouputplaces[t]=n,i=!0),i},this.resetDefaultOutput=function(){this.currentoutputplaces=[].concat(i(this.defaultoutputplaces))}}Object.defineProperty(r,"__esModule",{value:!0});var o=e("core/data/query/service"),s=e("core/data/search/service"),l=e("core/data/expression/service"),u=e("core/data/proxy/service"),c=e("core/data/ows/service"),d=e("core/iframe/routerservice"),p=e("core/utils/utils"),f=p.splitContextAndMethod,h=e("gui/gui");r["default"]=new a},{"core/data/expression/service":11,"core/data/ows/service":12,"core/data/proxy/service":13,"core/data/query/service":14,"core/data/search/service":16,"core/iframe/routerservice":28,"core/utils/utils":92,"gui/gui":150}],387:[function(e,t,r){function n(){this.execute=function(e,t,r){var i=void 0,a=void 0;t.forEach(function(t){a=t.feature,r&&a[n.Actions[a.getState()].opposite](),i=n.Actions[a.getState()].fnc,e[i](a)})}}Object.defineProperty(r,"__esModule",{value:!0}),n.Actions={add:{fnc:"addFeature",opposite:"delete"},"delete":{fnc:"removeFeature",opposite:"add"},update:{fnc:"updateFeature",opposite:"update"}},r["default"]=new n},{}],388:[function(e,t,r){function n(){this.stack=new a,this.init=function(e){this.layout=e,this.sidebarEl=$(this.layout.options.controlSidebarOptions.selector),this._zindex=this.sidebarEl.css("z-index"),this._modalOverlay=null,this._modal=!1,this._isopen=!1},this.isOpen=function(){return this._isopen},this.open=function(){this.layout.floatBar.open(this.sidebarEl,!0),this._isopen=!0},this.close=function(){this.layout.floatBar.close(this.sidebarEl,!0),this._isopen=!1},this.showPanel=function(e,t){t=t||{};t.append||!1,t.modal||!1;t.parent="#g3w-floatbarpanel-placeholder",this.stack.push(e,t),this._isopen||this.open()},this.closePanel=function(e){e?this.stack.remove(e):this.stack.pop(),this.stack.getLength()||(this._modal?(o.setModal(!1),this.close(),$(".control-sidebar-bg").toggleClass("control-sidebar-bg-shadow"),this.sidebarEl.css("z-index",""),this.sidebarEl.css("padding-top","50px"),$(".control-sidebar-bg").css("z-index",""),this._modal=!1):this.close())},this.hidePanel=function(){this.close()}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("gui/utils/utils"),a=i.barstack,o=e("gui/gui");r["default"]=new n},{"gui/gui":150,"gui/utils/utils":224}],389:[function(e,t,r){function n(){this.setters={setContent:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.emit("opencontent",!0),this._setContent(e)}},this.isready=!1,this.getResourcesUrl=s,this.showForm=s,this.closeForm=s,this.showListing=s,this.closeListing=s,this.hideListing=s,this.setModal=s,this.showFullModal=s,this.showQueryResults=s,this.hideQueryResults=s,this.showPanel=s,this.hidePanel=s,this.reloadComponents=s,this.showUserMessage=s,this.closeUserMessage=s,this.showModalDialog=s,this._closeUserMessageBeforeSetContent=!0,this.setComponent=function(e){c.registerComponent(e)},this.getComponent=function(e){return c.getComponent(e)},this.getComponents=function(){return c.getComponents()},this["goto"]=function(e){u["goto"](e)},this.ready=function(){this.emit("ready"),this.isready=!0},this.guiResized=function(){this.emit("guiresized")},this.isReady=function(){var e=this;return new Promise(function(t){return e.isready?t():e.once("ready",t)})},this.getService=function(e){var t=this.getComponent(e);return t&&t.getService()},this.showSpinner=function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}},this.hideSpinner=function(e){},this.notify=s,this.dialog=s,this.isMobile=s,a(this)}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=i.noop,l=e("core/g3wobject"),u=e("core/router"),c=e("gui/component/componentsregistry");o(n,l),r["default"]=new n},{"core/g3wobject":26,"core/router":87,"core/utils/utils":92,"gui/component/componentsregistry":142}],390:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function i(){o(this),this.mapControls={screenshot:{control:null},changeMap:{control:null}},this.init=function(){var e=this;return new Promise(function(t,r){e.mapService.once("ready",function(){e._map=e.mapService.getMap(),e._mapCrs=e.mapService.getCrs(),e.mapControls.screenshot.control=e.mapService.getMapControlByType({type:"screenshot"}),e.setReady(!0),t()})})},this.results=function(){var e=n(regeneratorRuntime.mark(function t(e){var r=e.capture,n=void 0===r||r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n?u.setOutputPlaces(["iframe"]):u.resetDefaultOutput(),e.abrupt("return",[]);case 2:case"end":return e.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),this.screenshot=function(){var e=n(regeneratorRuntime.mark(function t(e){var r,i=this,a=e.capture,o=void 0===a||a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r="app:screenshot",o?this.mapControls.screenshot.control.overwriteOnClickEvent(n(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i.mapService.createMapImage();case 3:e=t.sent,i.emit("response",{action:r,response:{result:!0,data:e}}),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),i.emit("response",{action:r,response:{result:!1,data:t.t0}});case 10:case"end":return t.stop();
}},t,i,[[0,7]])}))):this.mapControls.screenshot.control.resetOriginalOnClickEvent();case 2:case"end":return e.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),this.getcenter=n(regeneratorRuntime.mark(function e(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.mapService.getCenter());case 1:case"end":return e.stop()}},e,this)})),this.zoomtocoordinates=n(regeneratorRuntime.mark(function t(){var e,r,n,i,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=a.coordinates,r=void 0===e?[]:e,n=a.highlight,i=void 0!==n&&n,!r||!Array.isArray(r)||2!==r.length){t.next=6;break}return this.mapService.zoomTo(r),t.abrupt("return",r);case 6:return t.abrupt("return",Promise.reject(r));case 7:case"end":return t.stop()}},t,this)})),this.getextent=n(regeneratorRuntime.mark(function r(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.mapService.getMapExtent());case 1:case"end":return e.stop()}},r,this)})),this.zoomtoextent=n(regeneratorRuntime.mark(function i(){var e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e=r.extent,t=void 0===e?[]:e,!t||!Array.isArray(t)||4!==t.length){n.next=6;break}return this.mapService.goToBBox(t),n.abrupt("return",t);case 6:return n.abrupt("return",Promise.reject(t));case 7:case"end":return n.stop()}},i,this)})),this.zoomtofeature=n(regeneratorRuntime.mark(function a(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise(function(){var r=n(regeneratorRuntime.mark(function i(r,n){var a,o,s,l,u;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=t.qgs_layer_id,o=t.feature,s=t.highlight,l=void 0!==s&&s,a=e.getQgsLayerId({qgs_layer_id:a}),n.next=4,e.findFeaturesWithGeometry({qgs_layer_id:a,feature:o,zoom:!0,highlight:l});case 4:u=n.sent,r(u.qgs_layer_id);case 6:case"end":return n.stop()}},i,e)}));return function(e,t){return r.apply(this,arguments)}}()));case 1:case"end":return r.stop()}},a,this)}))}Object.defineProperty(r,"__esModule",{value:!0});var a=e("core/utils/utils"),o=a.base,s=a.inherit,l=e("core/iframe/services/baseservice"),u=e("core/data/routerservice");s(i,l),r["default"]=new i},{"core/data/routerservice":15,"core/iframe/services/baseservice":30,"core/utils/utils":92}],391:[function(e,t,r){function n(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(){var e=this;l(this),this.pluginName="editing",this.subscribevents=[],this.isRunning=!1,this.responseObject={cb:null,qgs_layer_id:null,error:null},this.config={tools:{add:{disabled:[{id:"deletefeature"},{id:"copyfeatures"},{id:"editmultiattributes"},{id:"deletePart"},{id:"splitfeature"},{id:"mergefeatures"}]},update:{disabled:[{id:"addfeature"},{id:"copyfeatures"},{id:"deletefeature"},{id:"editmultiattributes"},{id:"deletePart"},{id:"splitfeature"},{id:"mergefeatures"}]},"delete":{enabled:[{id:"deletefeature",options:{active:!0}}]}}},this.startAction=function(){var e=i(regeneratorRuntime.mark(function t(e){var r=this,n=e.toolboxes,i=e.resolve,a=e.reject;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.responseObject.cb=a,this.dependencyApi.setSaveConfig({cb:{done:function(e){r.responseObject.cb=i,r.responseObject.qgs_layer_id=e.getId(),r.responseObject.error=null,r.dependencyApi.hidePanel()},error:function(e,t){r.responseObject.cb=a,r.responseObject.qgs_layer_id=e.getId(),r.responseObject.error=t}}}),this.dependencyApi.showPanel({toolboxes:n}),this.isRunning=!0;case 4:case"end":return e.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),this.stopAction=i(regeneratorRuntime.mark(function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=r.qgs_layer_id,t.t0=e,!t.t0){t.next=5;break}return t.next=5,this.stopEditing(e);case 5:case"end":return t.stop()}},t,this)})),this.subscribersHandlers={canUndo:function(t){var r=t.activeTool,n=t.disableToolboxes,i=void 0===n?[]:n;return function(t){t===!1&&(e.responseObject.qgs_layer_id=null,e.responseObject.error=null),r.setEnabled(!t),i.forEach(function(e){return e.setEditing(!t)})}},canRedo:function(){},cancelform:function(e){return function(){e()}},addfeature:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.properties,n=t.toolboxes;return function(t){Object.keys(r).forEach(function(e){return t.set(e,r[e])});var i=void 0,a=[];if(n.forEach(function(e){var t=e.getToolById("addfeature");t.isActive()?(t.setEnabled(!1),i=t):(e.setEditing(!1),a.push(e))}),e.subscribevents.find(function(e){return"canUndo"!==e.event})){var o=e.addSubscribeEvents("canUndo",{activeTool:i,disableToolboxes:a});e.addSubscribeEvents("cancelform",o)}}},closeeditingpanel:function(t){var r=t.qgs_layer_id;return function(){e.responseObject.cb({qgs_layer_id:e.responseObject.qgs_layer_id,error:e.responseObject.error}),e.stopAction({qgs_layer_id:r})}}},this.addSubscribeEvents=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.subscribersHandlers[e](t);return this.dependencyApi.subscribe(e,r),this.subscribevents.push({event:e,handler:r}),r},this.resetSubscribeEvents=function(){var e=this;this.subscribevents.forEach(function(t){var r=t.event,n=t.handler;e.dependencyApi.unsubscribe(r,n)})},this.add=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise(function(){var r=i(regeneratorRuntime.mark(function a(r,i){var o,s,l,u,d,p,f;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!e.isRunning){a.next=4;break}i(),a.next=19;break;case 4:return o=t.qgs_layer_id,s=n(t,["qgs_layer_id"]),l=s.properties,u=e.getQgsLayerId({qgs_layer_id:o,noValue:e.dependencyApi.getEditableLayersId()}),a.next=9,e.startAction({toolboxes:u,resolve:r,reject:i});case 9:return d={tools:e.config.tools.add,startstopediting:!1,action:"add",selected:1===u.length},a.next=12,e.startEditing(u,d);case 12:p=a.sent,p=p.filter(function(e){return"fulfilled"===e.status}).map(function(e){return e.value}),!c.isSidebarVisible()&&c.showSidebar(),f=1===p.length&&p[0],f&&f.setActiveTool(f.getToolById("addfeature")),e.addSubscribeEvents("addfeature",{properties:l,toolboxes:p}),e.addSubscribeEvents("closeeditingpanel",{qgs_layer_id:u});case 19:case"end":return a.stop()}},a,e)}));return function(e,t){return r.apply(this,arguments)}}())},this.update=i(regeneratorRuntime.mark(function r(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise(function(){var r=i(regeneratorRuntime.mark(function a(r,i){var o,s,l,u,d,p,f;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!e.isRunning){a.next=4;break}i(),a.next=22;break;case 4:return o=t.qgs_layer_id,s=n(t,["qgs_layer_id"]),l=s.feature,u=e.getQgsLayerId({qgs_layer_id:o,noValue:e.dependencyApi.getEditableLayersId()}),a.next=9,e.findFeaturesWithGeometry({qgs_layer_id:u,feature:l,zoom:!0,highlight:!0,selected:1===u.length});case 9:if(d=a.sent,p=d.found,!p){a.next=21;break}return a.next=14,e.startAction({toolboxes:[d.qgs_layer_id],resolve:r,reject:i});case 14:return f={feature:l,tools:e.config.tools.update,startstopediting:!1,action:"update"},a.next=17,e.startEditing([d.qgs_layer_id],f);case 17:!c.isSidebarVisible()&&c.showSidebar(),e.addSubscribeEvents("closeeditingpanel",{qgs_layer_id:[d.qgs_layer_id]}),a.next=22;break;case 21:i();case 22:case"end":return a.stop()}},a,e)}));return function(e,t){return r.apply(this,arguments)}}()));case 1:case"end":return r.stop()}},r,this)})),this["delete"]=function(){},this.startEditing=i(regeneratorRuntime.mark(function a(){var e,t,r,n,i,o=this,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:e=l.action,t=void 0===e?"add":e,r=l.feature,n={},l.filter=n,a.t0=t,a.next="add"===a.t0?6:"update"===a.t0?8:10;break;case 6:return n.nofeatures=!0,a.abrupt("break",10);case 8:return n.field=r.field+"|eq|"+r.value,a.abrupt("break",10);case 10:return i=[],s.forEach(function(e){i.push(o.dependencyApi.startEditing(e,l))}),a.next=14,Promise.allSettled(i);case 14:return a.abrupt("return",a.sent);case 15:case"end":return a.stop()}},a,this)})),this.stopEditing=function(){var e=i(regeneratorRuntime.mark(function t(e){var r,n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=[],e.forEach(function(e){r.push(n.dependencyApi.stopEditing(e))}),t.next=4,Promise.allSettled(r);case 4:this.clear();case 5:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),this.stop=function(){var e=this;return new Promise(function(t,r){e.dependencyApi.hidePanel(),c.hideSidebar(),e.once("clear",t)})},this.clear=function(){this.dependencyApi.resetDefault(),this.isRunning=!1,this.responseObject={cb:null,qgs_layer_id:null,error:null},this.resetSubscribeEvents(),this.emit("clear")}}Object.defineProperty(r,"__esModule",{value:!0});var o=e("core/iframe/services/plugins/service"),s=g3wsdk.core.utils,l=s.base,u=s.inherit,c=e("gui/gui");u(a,o),r["default"]=new a},{"core/iframe/services/plugins/service":34,"gui/gui":150}],392:[function(e,t,r){function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function a(){var t=this;arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pendingactions={},this.init=i(regeneratorRuntime.mark(function r(){var t,n,i,a,o=this,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=s.project;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,u.isReady();case 2:this.services=e("core/iframe/services/index"),this.eventResponseServiceHandler=function(e){var t=e.action,r=e.response;o.postMessage({id:null,action:t,response:r})},t=l.state.layers.map(function(e){return{id:e.id,name:e.name}}),n=Object.keys(this.services),i=0;case 7:if(!(i<n.length)){r.next=16;break}return a=this.services[n[i]],void 0===a.getLayers()&&a.setLayers(t),r.next=12,a.init();case 12:a.on("response",this.eventResponseServiceHandler);case 13:i++,r.next=7;break;case 16:this.postMessage({id:null,action:"app:ready",response:{result:!0,data:{layers:t}}}),window.addEventListener?window.addEventListener("message",this.getMessage,!1):window.attachEvent("onmessage",this.getMessage);case 18:case"end":return r.stop()}},r,this)})),this.outputDataPlace=function(){var e=i(regeneratorRuntime.mark(function t(e){var r,i,a,o,s,l,u,c,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=d.action,i=void 0===r?"app:results":r,t.next=3,e;case 3:a=t.sent,o=a.result,s=a.data,l=void 0===s?[]:s,u=new ol.format.GeoJSON,c=[];try{c=l.map(function(e){var t=e.layer,r=e.features;return n({},t.getId(),{features:u.writeFeatures(r)})})}catch(p){}this.postMessage({id:null,action:i,response:{result:o,data:c}});case 11:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),this.postMessage=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};window.parent&&window.parent.postMessage(e,"*")},this.stopPendingActions=i(regeneratorRuntime.mark(function a(){var e,t=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=[],Object.keys(this.pendingactions).forEach(function(r){var n=t.pendingactions[r].context;e.push(t.services[n].stop()),delete t.pendingactions[r]}),r.abrupt("return",Promise.allSettled(e));case 3:case"end":return r.stop()}},a,this)})),this.getMessage=function(){var e=i(regeneratorRuntime.mark(function r(e){var n,i,a,o,u,c,d,p,f,h,v,g;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!e||!e.data){r.next=24;break}if(n=e.data,i=n.id,a=void 0===i?l():i,o=n.single,u=void 0===o||o,c=n.action,d=n.data,p=s(c),f=p.context,h=p.method,v=!1,g=void 0,r.prev=5,!t.services[f].getReady()){r.next=16;break}if(r.t0=u,!r.t0){r.next=11;break}return r.next=11,t.stopPendingActions();case 11:return t.pendingactions[a]={context:f},r.next=14,t.services[f][h](d);case 14:g=r.sent,v=!0;case 16:r.next=22;break;case 18:r.prev=18,r.t1=r["catch"](5),v=!1,g=r.t1;case 22:t.postMessage({id:a,action:c,response:{result:v,data:g}}),delete t.pendingactions[a];case 24:case"end":return r.stop()}},r,t,[[5,18]])}));return function(t){return e.apply(this,arguments)}}(),this.clear=function(){for(var e=Object.keys(this.services),t=0;t<e.length;t++){var r=this.services[e[t]];r.off("response",this.eventResponseServiceHandler)}this.stopPendingActions(),window.removeEventListener?window.removeEventListener("message",this.getMessage,!1):window.detachEvent("onmessage",this.getMessage)}}Object.defineProperty(r,"__esModule",{value:!0});var o=e("core/utils/utils"),s=o.splitContextAndMethod,l=o.uniqueId,u=e("gui/gui");r["default"]=new a},{"core/iframe/services/index":31,"core/utils/utils":92,"gui/gui":150}],393:[function(e,t,r){function n(){this.state={items:{left:[],right:[]}},this.addItem=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"right";this.state.items[t].push(e)},a(this)}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("core/g3wobject");o(n,s),r["default"]=new n},{"core/g3wobject":26,"core/utils/utils":92}],394:[function(e,t,r){function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function o(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._cacheValues={},this._items=v.getLocalItem(y)||{}}Object.defineProperty(r,"__esModule",{value:!0});var s=e("core/data/routerservice"),l=e("core/i18n/i18n.service"),u=l.t,c=e("core/utils/utils"),d=c.uniqueId,p=c.createFilterFromString,f=c.XHR,h=e("core/catalog/cataloglayersstoresregistry"),v=e("core/applicationservice"),g=e("core/project/projectsregistry"),m=e("gui/gui"),y="QUERYBUILDERSEARCHES",_=o.prototype;_.getCurrentProjectItems=function(){var e=g.getCurrentProject().getId();return this._items[e]=this._items[e]||[],this._items[e]},_.getItems=function(e){var t=v.getLocalItem(y);return e=e||g.getCurrentProject().getId(),t?t[e]||[]:[]},_._getLayerById=function(e){return h.getLayerById(e)},_.getValues=a(regeneratorRuntime.mark(function b(){var e,t,r,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=i.layerId,o=i.field;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(this._cacheValues[a]=this._cacheValues[a]||{},e=this._cacheValues[a][o],void 0!==e){i.next=18;break}return i.prev=3,t=this._getLayerById(a),r=t.getUrl("data"),i.next=8,f.get({url:r,params:{ordering:o,unique:o}});case 8:return n=i.sent,n.result&&(this._cacheValues[a][o]=this._cacheValues[a][o]||n.data),i.abrupt("return",this._cacheValues[a][o]||[]);case 13:i.prev=13,i.t0=i["catch"](3),reject();case 16:i.next=19;break;case 18:return i.abrupt("return",e);case 19:case"end":return i.stop()}},b,this,[[3,13]])})),_.run=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.layerId,n=t.filter,i=t.showResult,o=void 0===i||i;return new Promise(function(){var t=a(regeneratorRuntime.mark(function i(t,a){var l,u,c,d,f;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return l=e._getLayerById(r),u=l.getSearchEndPoint(),c=p({layer:l,search_endpoint:u,filter:n}),i.prev=3,i.next=6,s.getData("search:features",{inputs:{layer:l,filter:c,search_endpoint:u,feature_count:100},outputs:o});case 6:d=i.sent,f=d.data,t(f),i.next=15;break;case 11:i.prev=11,i.t0=i["catch"](3),m.showUserMessage({type:"alert",message:"sdk.querybuilder.error_run",autoclose:!0}),a(i.t0);case 15:case"end":return i.stop()}},i,e,[[3,11]])}));return function(e,r){return t.apply(this,arguments)}}())},_.test=a(regeneratorRuntime.mark(function w(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.layerId,n=t.filter;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.run({layerId:r,filter:n,showResult:!1});case 3:return e=t.sent,t.abrupt("return",e.length&&e[0].features.length);case 7:return t.prev=7,t.t0=t["catch"](0),t.t0=u("sdk.querybuilder.error_test"),t.abrupt("return",Promise.reject(t.t0));case 11:case"end":return t.stop()}},w,this,[[0,7]])})),_["delete"]=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.id;return new Promise(function(t,n){m.dialog.confirm(u("sdk.querybuilder.delete"),function(i){if(i){var a=e.getItems().filter(function(e){return e.id!==r}),o=g.getCurrentProject().getId(),s=v.getLocalItem(y);a.length?s[o]=a:delete s[o],Object.keys(s).length?v.setLocalItem({id:y,data:s}):v.removeLocalItem(y),t()}else n()})})},_.editLocalItem=function(e,t){e=e||g.getCurrentProject().getId();var r=v.getLocalItem(y);r[e].find(function(n,i){if(n.id===t.id)return r[e][i]=t,!0}),v.setLocalItem({id:y,data:r}),this._resetItems(e,r[e])},_._resetItems=function(e,t){var r=this;setTimeout(function(){t.forEach(function(t){return r._items[e].push(t)})},0),this._items[e].splice(0)},_.addLocalItem=function(e,t){t.id=d(),e=e||g.getCurrentProject().getId();var r=v.getLocalItem(y);if(void 0===r){var a=[t];v.setLocalItem({id:y,data:i({},e,a)}),this._resetItems(e,a)}else r[e]=r[e]?[].concat(n(r[e]),[t]):[t],v.setLocalItem({id:y,data:r}),this._resetItems(e,r[e])},_.save=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.id,n=t.name,i=t.layerId,a=t.filter,o=t.projectId,s=this._getLayerById(i).getName(),l={layerId:i,filter:a,layerName:s};return r?(l.name=n,l.id=r,this.editLocalItem(o,l),void m.showUserMessage({type:"success",message:u("sdk.querybuilder.messages.changed"),autoclose:!0})):void m.dialog.prompt(u("sdk.querybuilder.additem"),function(t){if(t){var r=m.getComponent("search").getService();l.name=t,r.addQueryBuilderSearch(l),e.addLocalItem(o,l),m.showUserMessage({type:"success",message:u("sdk.querybuilder.messages.changed"),autoclose:!0})}})},_.all=function(){},_.sample=function(){},_.clear=function(){this._cacheValues={}},_.add=function(){},r["default"]=new o},{"core/applicationservice":7,"core/catalog/cataloglayersstoresregistry":9,"core/data/routerservice":15,"core/i18n/i18n.service":27,"core/project/projectsregistry":83,"core/utils/utils":92,"gui/gui":150}],395:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function i(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l(this)}Object.defineProperty(r,"__esModule",{value:!0});var a=e("core/utils/utils"),o=a.inherit,s=a.XHR,l=a.base,u=a.createSingleFieldParameter,c=e("core/utils/geo"),d=c.sanitizeFidFeature,p=(c.getFeaturesFromResponseVectorApi,c.covertVectorFeaturesToResultFeatures,c.getAlphanumericPropertiesFromFeature),f=e("core/g3wobject"),h=e("core/catalog/cataloglayersstoresregistry");o(i,f);var v=i.prototype;v.createUrl=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e("core/project/projectsregistry"),n=r.getCurrentProject(),i=t.layer,a=void 0===i?{}:i,o=t.relation,s=void 0===o?{}:o,l=t.fid,u=t.type,c=void 0===u?"data":u,p=void 0,f=s.father,h=s.child,v=s.referencedLayer,g=s.referencingLayer,m=s.id;p=void 0!==f?a.id===f?h:f:a.id===v?g:v;var y=n.getLayerById(p).getUrl(c),_=d(l);return y+"?relationonetomany="+m+"|"+_+"&formatter=1"},v.getRelations=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.createUrl(e);return s.get({url:t})},v.getRelationsNM=n(regeneratorRuntime.mark(function g(){var t,r,n,i,a,o,s,l,c,d=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},f=d.nmRelation,v=d.features,m=void 0===v?[]:v;return regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(t=e("core/data/routerservice"),r=f.referencedLayer,n=f.referencingLayer,i=f.fieldRef,a=i.referencingField,o=i.referencedField,s=[],!m.length){d.next=9;break}return l=m.map(function(e){return e.attributes[a]}),d.next=7,t.getData("search:features",{inputs:{layer:h.getLayerById(r),filter:""+u({field:o,value:l,logicop:"OR"}),formatter:1,search_endpoint:"api"},outputs:null});case 7:c=d.sent,c.data&&c.data[0]&&Array.isArray(c.data[0].features)&&(s=c.data[0].features.map(function(e){var t=p(e.getProperties()).reduce(function(t,r){return t[r]=e.get(r),t},{});return{id:e.getId(),attributes:t,geometry:e.getGeometry()}}));case 9:return d.abrupt("return",s);case 10:case"end":return d.stop()}},g,this)})),v.save=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.createUrl(e);return s.fileDownload({url:t,httpMethod:"GET"})},r["default"]=new i},{"core/catalog/cataloglayersstoresregistry":9,"core/data/routerservice":15,"core/g3wobject":26,"core/project/projectsregistry":83,"core/utils/geo":89,"core/utils/utils":92}],396:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("core/utils/utils"),i=n.base,a=n.inherit,o=(n.Base64,e("core/g3wobject"));crossroads.ignoreState=!0,crossroads.greedy=!0;var s=function(){this._initialLocationQuery,this._routeQuery="",this.setters={setRouteQuery:function(e){this._routeQuery=e,crossroads.parse(e)}},i(this)};a(s,o);var l=s.prototype;l.init=function(){var e=window.location.search;this._setRouteQueryFromLocationQuery(e)},l.addRoute=function(e,t,r){return crossroads.addRoute(e,t,r)},l.removeRoute=function(e){return crossroads.removeRoute(e)},l.removeAllRoutes=function(){return crossroads.removeAllRoutes()},l.parse=function(e,t){return crossroads.parse(e,t)},l["goto"]=function(e){this._initialQuery||(this._initialLocationQuery=this._stripInitialQuery(location.search.substring(1))),e&&this.setRouteQuery(e)},l.makePermalink=function(e){this._initialQuery||(this._initialLocationQuery=this._stripInitialQuery(location.search.substring(1)));this._encodeRouteQuery(e);return"?"+this._initialLocationQuery+"&q="+this._encodeRouteQuery(e)},l.makeQueryString=function(e){},l.slicePath=function(e){return e.split("?")[0].split("/")},l.sliceFirst=function(e){var t=e.split("?"),r=t[1],n=t[0].split("/"),i=n[0];return e=n.slice(1).join("/"),e=[e,r].join("?"),[i,e]},l.getQueryParams=function(e){e=e.replace("?","");var t={},r=[];r=""!=e&&e.indexOf("&")==-1?[e]:e.split("&");try{_.forEach(r,function(e){var r=e.split("="),n=r[0],i=r[1];t[n]=i})}catch(n){}return t},l.getQueryString=function(e){return e.split("?")[1]},l._getQueryPortion=function(e,t){var r;try{var n=e.split("&");_.forEach(n,function(e){var n=e.split("="),i=n[0];i==t&&(r=e)})}catch(i){}return r},l._encodeRouteQuery=function(e){return e=e.replace("?","@"),e=e.replace("&","|"),e=e.replace("=","!")},l._decodeRouteQuery=function(e){return e=e.replace("@","?"),e=e.replace("|","&"),e=e.replace("!","=")},l._setRouteQueryFromLocationQuery=function(e){var t=this._getRouteQueryFromLocationQuery(e);if(t){var r=this._decodeRouteQuery(t);this.setRouteQuery(r)}},l._getRouteQueryFromLocationQuery=function(e){return this.getQueryParams(e).q},l._stripInitialQuery=function(e){var t=this._getQueryPortion(e,"q");if(t){var r=t.length,n=e.indexOf(t);queryPrefix=_.trimEnd(e.substring(0,n),"&"),querySuffix=e.substring(n+r),querySuffix=""!=queryPrefix?querySuffix:_.trimStart(querySuffix,"&"),e=queryPrefix+querySuffix}return e},r["default"]=new s},{"core/g3wobject":26,"core/utils/utils":92}],397:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}function i(){this.stack=new p,this.setters={closeSidebarPanel:function(){},openCloseItem:function(e){}},this.state={components:[],gui:{title:""},disabled:!1},this.init=function(e){this.layout=e},this.addComponents=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.forEach(function(e){return t.addComponent(e,r)}),!0},this.addComponent=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.position,n=t.before,i=void 0===n||n,a=t.info;if(isMobile.any&&!e.mobile)return!1;var o=new h({service:this,info:a,component:e});o.title=e.title||o.title,o.info=e.info||o.info,o.actions=e.actions||o.actions,o.open=e.state.open,o.icon=e.icon||o.icon,o.iconColor=e.iconColor,o.state=e.state||!0,o.collapsible="boolean"!=typeof e.collapsible||e.collapsible,o.isolate="boolean"==typeof e.isolate&&e.isolate;var s=o.$mount().$el;this.state.components.push(e);var l=$(".g3w-sidebarpanel").is(":visible"),u="#g3w-sidebarcomponents"+(l?":hidden":""),c=$(u).children().filter(function(){return"none"!==this.style.display}),d=c.length;return null===r||void 0===r||r<0||r>=d?$(u).append(s):c.each(function(e,t){var n=Number.isInteger(r)?r===e:t.id===r;n&&$(s)["insert"+(i?"Before":"After")](t)}),e.mount("#g3w-sidebarcomponent-placeholder"),e.initService&&e.initService(),this.setComponentClickHandler(e),!0},this.setComponentClickHandler=function(e){e.click=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.open,n=void 0!==r&&r;n=n||!1,$(e.getInternalComponent().$el).siblings("a").click(),e.setOpen(n)}},this.getComponent=function(e){return this.state.components.find(function(t){return t.getId()===e})},this.getComponents=function(){return this.state.components},this.closeOpenComponents=function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.getComponents().forEach(function(e){return e.closeWhenViewportContentIsOpen()&&e.collapsible&&e.click({open:!1})})},this.reloadComponent=function(e){var t=this.getComponent(e);t&&t.reload()},this.reloadComponents=function(){this.closePanel(),this.state.components.forEach(function(e){e.collapsible&&e.state.open&&e.click({open:!1}),e.reload()})},this.removeComponent=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.position;this.state.components.forEach(function(r,i){if(e===r)return e.unmount(),t.state.components.splice(i,1),void 0!==n&&Number.isInteger(n)?$("#g3w-sidebarcomponents").children(":visible")[n].remove():$("#g3w-sidebarcomponents").children("#"+e.id).remove(),!1})},this.showPanel=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(n,i){t.state.gui.title=e.title;var o="#g3w-sidebarpanel-placeholder";t.stack.getCurrentContentData()&&$(t.stack.getCurrentContentData().content.internalPanel.$el).hide(),t.stack.push(e,a({parent:o},r)).then(function(e){return n(e)})})},this.closePanel=function(){var e=this;this.state.gui.title=null,this.closeSidebarPanel(),this.stack.pop().then(function(t){t=null,e.stack.getCurrentContentData()&&$(e.stack.getCurrentContentData().content.internalPanel.$el).show()})},this.closeAllPanels=function(){this.state.gui.title=null,this.closeSidebarPanel(),this.stack.clear()},u(this)}Object.defineProperty(r,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("components/SidebarItem.vue"),s=n(o),l=e("core/utils/utils"),u=l.base,c=l.inherit,d=e("gui/utils/utils"),p=d.barstack,f=e("core/g3wobject"),h=Vue.extend(s["default"]);c(i,f),r["default"]=new i},{"components/SidebarItem.vue":329,"core/g3wobject":26,"core/utils/utils":92,"gui/utils/utils":224}],398:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function i(){var e=[];this.runTask=n(regeneratorRuntime.mark(function t(){var r,i,a,s,l,u,c,d,p,f,h,v,g,m,y,_,b=this,w=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=w.method,i=void 0===r?"GET":r,a=w.params,s=void 0===a?{}:a,l=w.url,u=w.taskUrl,c=w.interval,d=void 0===c?1e3:c,p=w.timeout,f=void 0===p?1/0:p,h=w.listener,v=void 0===h?function(){}:h,t.prev=1,"GET"!==i){t.next=8;break}return t.next=5,o.get({url:l,params:s});case 5:t.t0=t.sent,t.next=11;break;case 8:return t.next=10,o.post({url:l,data:s.data||{},contentType:s.contentType||"application/json"});case 10:t.t0=t.sent;case 11:if(g=t.t0,m=g.result,y=g.task_id,!m){t.next=19;break}_=setInterval(n(regeneratorRuntime.mark(function x(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(f-=d,!(f>0)){t.next=15;break}return e=void 0,t.prev=3,t.next=6,o.get({url:""+u+y});case 6:e=t.sent,t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](3),e=t.t0;case 12:v({task_id:y,timeout:!1,response:e}),t.next=17;break;case 15:v({timeout:!0}),b.stopTask({task_id:y});case 17:case"end":return t.stop()}},x,b,[[3,9]])})),d),e.push({task_id:y,intervalId:_}),v({task_id:y,response:g}),t.next=20;break;case 19:return t.abrupt("return",Promise.reject(g));case 20:t.next=25;break;case 22:return t.prev=22,t.t1=t["catch"](1),t.abrupt("return",Promise.reject(t.t1));case 25:case"end":return t.stop()}},t,this,[[1,22]])})),this.stopTask=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.task_id,n=e.find(function(e){return e.task_id===r});n&&clearInterval(n.intervalId)},this.clear=function(){var t=this;e.forEach(function(e){var r=e.taskId;t.stopTask({taskId:r})}),e.splice(0)}}Object.defineProperty(r,"__esModule",{value:!0});var a=e("core/utils/utils"),o=a.XHR;r["default"]=new i},{"core/utils/utils":92}],399:[function(e,t,r){function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=e("core/applicationstate"),o=n(a),s=e("gui/constraints"),l=e("core/utils/utils"),u=l.base,c=l.inherit,d=l.uniqueId,p=e("core/g3wobject"),f=e("gui/gui"),h=function(){
this.state={primaryView:"map",secondaryPerc:0,resized:{start:!1,h:!1,v:!1},split:"h",map:{sizes:{width:0,height:0},aside:!1},content:{loading:!1,disabled:!1,sizes:{width:0,height:0},resize:{h:{perc:0},v:{perc:0}},aside:!0,showgoback:!0,stack:[],closable:!0,backonclose:!1,contentsdata:[]},usermessage:{id:null,show:!1,title:null,message:null,position:null,type:null,draggable:null,cloasable:null,autoclose:null,textMessage:!1,hooks:{header:null,body:null,footer:null}}},this._components={map:null,content:null},this._defaultMapComponent,this._contextualMapComponent,this._secondaryViewMinWidth=s.viewport.resize.content.min,this._secondaryViewMinHeight=s.viewport.resize.content.min,this._immediateComponentsLayout=!0,this.init=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.primaryview,r=void 0===t?"map":t,n=e.split,i=void 0===n?"h":n,a=e.components;this.state.primaryView=r,this.state.split=i,this._addComponents(a)},this.setResized=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.state.resized[e]=t},this.showUserMessage=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.title,n=t.message,i=t.type,a=t.position,o=t.size,s=t.draggable,l=t.duration,u=t.textMessage,c=void 0!==u&&u,p=t.closable,f=t.autoclose,h=t.hooks,v=void 0===h?{}:h;return this.closeUserMessage(),setTimeout(function(){e.state.usermessage.id=d(),e.state.usermessage.show=!0,e.state.usermessage.message=n,e.state.usermessage.textMessage=c,e.state.usermessage.title=r,e.state.usermessage.position=a,e.state.usermessage.duration=l,e.state.usermessage.type=i,e.state.usermessage.show=!0,e.state.usermessage.size=o,e.state.usermessage.autoclose=f,e.state.usermessage.closable=p,e.state.usermessage.draggable=s,e.state.usermessage.hooks.header=v.header,e.state.usermessage.hooks.body=v.body,e.state.usermessage.hooks.footer=v.footer}),this.state.usermessage},this.closeUserMessage=function(){this.state.usermessage.id=null,this.state.usermessage.show=!1,this.state.usermessage.textMessage=!1,this.state.usermessage.message=""},this.getState=function(){return this.state},this.getMapState=function(){return this.state.map},this.getContentState=function(){return this.state.content},this.setLoadingContent=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state.content.loading=e},this._addComponents=function(e){var t=this;Object.entries(e).forEach(function(e){var r=i(e,2),n=r[0],a=r[1];Object.keys(t._components).indexOf(n)>-1&&a.mount("#g3w-view-"+n,!0).then(function(){t._components[n]=a,"map"===n&&(t._defaultMapComponent=a)}).fail(function(e){})})},this.showMap=function(){this._toggleMapComponentVisibility(this._defaultMapComponent,!0),this._components.map=this._defaultMapComponent,this._showView("map")},this.showContextualMap=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._contextualMapComponent||(this._contextualMapComponent=this._defaultMapComponent),this._contextualMapComponent!=this._defaultMapComponent&&this._toggleMapComponentVisibility(this._defaultMapComponent,!1),this._contextualMapComponent.ismount())this._components.map=this._contextualMapComponent,this._toggleMapComponentVisibility(this._contextualMapComponent,!0);else{var r=this._contextualMapComponent;r.mount("#g3w-view-map",!0).then(function(){return e._components.map=r})}this._showView("map",t)},this.recoverDefaultMap=function(){return this._components.map!==this._defaultMapComponent&&(this._components.map=this._defaultMapComponent,this._toggleMapComponentVisibility(this._contextualMapComponent,!1),this._toggleMapComponentVisibility(this._defaultMapComponent,!0)),this._components.map},this.setContextualMapComponent=function(e){e!==this._defaultMapComponent&&(this._contextualMapComponent&&this._contextualMapComponent.unmount(),this._contextualMapComponent=e)},this.resetContextualMapComponent=function(){this._contextualMapComponent&&this._contextualMapComponent.unmount(),this._contextualMapComponent=this._defaultMapComponent},this._toggleMapComponentVisibility=function(e,t){e.internalComponent.$el.style.display=t?"block":"none"},this.closeMap=function(){this.state.secondaryPerc="map"===this.state.primaryView?100:0,this.recoverDefaultMap(),this._layout()},this.showContent=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.perc=void 0!==t.perc?t.perc:this.getContentPercentageFromCurrentLayout(),t.push=t.push||!1;var r=100===t.perc?"show-content-full":"show-content";this._prepareContentView(t),this._immediateComponentsLayout=!1,this._showView("content",t),this._components.content.setContent(t).then(function(){e._immediateComponentsLayout=!0,e._layoutComponents(r)})},this.hideContent=function(e){var t=this.getContentPercentageFromCurrentLayout(this.state.split);return this.state.secondaryVisible=!e,this._layout("hide-content"),t},this.resetToDefaultContentPercentage=function(){var e=this.getCurrentContentLayout();e[""+("h"===this.state.split?"width":"height")]=e[("h"===this.state.split?"width":"height")+"_default"],e[("h"===this.state.split?"width":"height")+"_100"]=!1,this._layoutComponents()},this.toggleFullViewContent=function(){o["default"].gui.layout[o["default"].gui.layout.__current].rightpanel[("h"===this.state.split?"width":"height")+"_100"]=!o["default"].gui.layout[o["default"].gui.layout.__current].rightpanel[("h"===this.state.split?"width":"height")+"_100"],this._layoutComponents()},this.isFullViewContent=function(){return o["default"].gui.layout[o["default"].gui.layout.__current].rightpanel[("h"===this.state.split?"width":"height")+"_100"]},this.contentLength=function(){return this.state.content.contentsdata.length},this.popContent=function(){var e=this,t=$.Deferred();if(this.state.content.contentsdata.length){this.recoverDefaultMap();var r=this._components.content.getPreviousContentData();this._prepareContentView(r.options),this._immediateComponentsLayout=!1,this._showView("content",r.options),this._components.content.popContent().then(function(){e.state.secondaryPerc=r.options.perc,e._immediateComponentsLayout=!0,e._layout("pop-content"),t.resolve(e._components.contentgetCurrentContentData)})}else t.reject();return t.promise()},this.getCurrentContent=function(){return this.contentLength()?this.state.content.contentsdata[this.contentLength()-1]:null},this.getCurrentContentTitle=function(){var e=this.getCurrentContent();return e&&e.options.title},this.changeCurrentContentTitle=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.getCurrentContent();t&&(t.options.title=e)},this.isContentOpen=function(){return!!this.state.content.contentsdata.length},this.closeContent=function(){var e=this,t=$.Deferred();if(this.isContentOpen())this._components.content.removeContent(),this.closeSecondaryView("close-content").then(function(){var r=e.recoverDefaultMap();t.resolve(r)});else{var r=this.recoverDefaultMap();t.resolve(r)}return t.promise()},this.disableContent=function(e){this.state.content.disabled=e},this.removeContent=function(){return this.state.content.backonclose&&this.state.content.contentsdata.length>1?void this.popContent():this.closeContent()},this.isPrimaryView=function(e){return this.state.primaryView==e},this.setPrimaryView=function(e){this.state.primaryView!==e&&(this.state.primaryView=e),this._layout()},this.showPrimaryView=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e&&this.state.secondaryVisible&&100===this.state.secondaryPerc&&(this.state.secondaryPerc=100-e,this._layout())},this.showSecondaryView=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.split,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state.perc;this.state.secondaryVisible=!0,this.state.split=e,this.state.secondaryPerc=t,this._layout()},this.closeSecondaryView=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=$.Deferred(),n=this._components[this._otherView(this.state.primaryView)];return n.clearContents?n.clearContents().then(function(){e.state.secondaryVisible=!1,e.state.secondaryPerc=0,e._layout(t),Vue.nextTick(function(){return r.resolve()})}):(this.state.secondaryVisible=!1,this._layout(t),Vue.nextTick(function(){return r.resolve()})),r.promise()},this.getDefaultViewPerc=function(e){return this.isPrimaryView(e)?100:50},this._otherView=function(e){return"map"===e?"content":"map"},this._isSecondary=function(e){return this.state.primaryView!==e},this._setPrimaryView=function(e){this.state.primaryView!==e&&(this.state.primaryView=e)},this._prepareContentView=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.title,r=e.split,n=void 0===r?null:r,i=e.closable,a=void 0===i||i,o=e.backonclose,s=void 0===o||o,l=e.style,u=void 0===l?{}:l,c=e.showgoback,d=void 0===c||c,p=e.headertools,f=void 0===p?[]:p;this.state.content.title=t,this.state.content.split=n,this.state.content.closable=a,this.state.content.backonclose=s,this.state.content.contentsdata=this._components.content.contentsdata,this.state.content.style=u,this.state.content.headertools=f,this.state.content.showgoback=d},this._showView=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.perc,n=void 0===r?this.getDefaultViewPerc(e):r,i=t.split,a=void 0===i?"h":i,o=void 0;o=!this.isPrimaryView(e)||"undefined"!=typeof t.aside&&t.aside,this.state[e].aside=o;var s=this.isPrimaryView(e)?100-n:n;return s>0?void this.showSecondaryView(a,s):this.closeSecondaryView()},this._getReducedSizes=function(){var e=$(".content"),t=0,r=0,n=$(".sidebar-aside-toggle");if(e&&this.state.secondaryVisible&&this.isFullViewContent()){if(n&&n.is(":visible")){var i=n.outerWidth();e.css("padding-left",i+5),t=i-5}}else{var a=n.outerWidth();e.css("padding-left",100===this.state.secondaryPerc?a+5:15)}return{reducedWidth:t,reducedHeight:r}},this._layout=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this._getReducedSizes();this._setViewSizes(t.reducedWidth,t.reducedHeight),this._immediateComponentsLayout&&this._layoutComponents(e)},this._setViewSizes=function(){var e=this.state.primaryView,t=this._otherView(e),r=this.getViewportSize(),n=r.width,i=r.height,a=void 0,o=void 0,s=void 0,l=void 0,u=(100===this.state.secondaryPerc||this.isFullViewContent()?100:this.getContentPercentageFromCurrentLayout(this.state.split))/100;"h"===this.state.split?(s=this.state.secondaryVisible?Math.max(n*u,this._secondaryViewMinWidth):0,l=i,a=n-s,o=i):(s=n,l=this.state.secondaryVisible?Math.max(i*u,this._secondaryViewMinHeight):0,a=this.state.secondaryVisible&&1===u?0:n,o=i-l),this.state[e].sizes.width=a,this.state[e].sizes.height=o,this.state[t].sizes.width=s,this.state[t].sizes.height=l},this.getViewportSize=function(){return{width:this._viewportWidth(),height:this._viewportHeight()}},this._viewportHeight=function(){var e=$(".navbar-header").innerHeight();return $(document).innerHeight()-e},this._viewportWidth=function(){var e=$(".main-sidebar"),t=e.length&&e.offset().left,r=e.length&&e[0].getBoundingClientRect().width,n=r+t;return $("#app")[0].getBoundingClientRect().width-n},this.resizeViewComponents=function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments[2]);this.setResized(e,!0),this.setContentPercentageFromCurrentLayout(e,t),this._layout("resize")},this.setContentPercentageFromCurrentLayout=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.split,t=arguments[1];this.getCurrentContentLayout()["h"===e?"width":"height"]=t},this.getContentPercentageFromCurrentLayout=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.split;return this.getCurrentContentLayout()["h"===e?"width":"height"]},this.getCurrentContentLayout=function(){return o["default"].gui.layout[o["default"].gui.layout.__current].rightpanel},this._layoutComponents=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;requestAnimationFrame(function(){var r=e._getReducedSizes(),n=r.reducedWidth||0,a=r.reducedHeight||0;e._setViewSizes(),Object.entries(e._components).forEach(function(t){var r=i(t,2),o=r[0],s=r[1],l=e.state[o].sizes.width-n,u=e.state[o].sizes.height-a;s.layout(l,u)}),t&&setTimeout(function(){e.emit(t),f.emit(t)})})},this._firstLayout=function(){function e(){n=!0,i()}var t=this,r=!1,n=!1,i=function a(){n===!0?(n=!1,r=!0,t._layout("resize"),requestAnimationFrame(a)):r=!1};f.on("ready",function(){t.SIDEBARWIDTH=f.getSize({element:"sidebar",what:"width"}),t._layout(),f.on("guiresized",function(){return e()}),$(window).resize(function(){r===!1&&e()}),$(".main-sidebar").on("webkitTransitionEnd transitionend msTransitionEnd oTransitionEnd",function(t){t.target===this&&($(this).trigger("trans-end"),e())})})},this._firstLayout(),u(this)};c(h,p),r["default"]=new h},{"core/applicationstate":8,"core/g3wobject":26,"core/utils/utils":92,"gui/constraints":143,"gui/gui":150}],400:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=function(){this._workflows=[],this.push=function(e){return this._workflows.indexOf(e)===-1?this._workflows.push(e)-1:this._workflows.indexOf(e)},this.getParent=function(){var e=this._getCurrentIndex();return e>0&&this._workflows[e-1]},this.pop=function(){return this._workflows.pop()},this.getLength=function(){return this._workflows.length},this._getCurrentIndex=function(){var e=this.getCurrent();return this._workflows.findIndex(function(t){return t===e})},this.getCurrent=function(){return this.getLast()},this.getLast=function(){var e=this._workflows.length;return e?this._workflows[e-1]:null},this.getFirst=function(){return this._workflows[0]},this.removeAt=function(e){this._workflows.splice(e,1)},this.getAt=function(e){return this._workflows[e]},this.insertAt=function(e,t){this._workflows[e]=t},this.clear=function(){for(;this._workflows.length;){var e=this.pop();e.stop()}}};r["default"]=new n},{}],401:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=Vue.observable({ready:!1,iframe:!1,online:!1,ismobile:!1,download:!1,upload:!1,baseLayerId:null,lng:"en",changeProjectview:!1,plugins:[],user:null,map:{epsg:"",unit:"metric"},gui:{app:{disabled:!1},sidebar:{disabled:!1},layout:{__current:"app",app:{}}},keys:{vendorkeys:{google:void 0,bing:void 0}},tokens:{filtertoken:void 0}});r.STATE_METHODS={};r["default"]=n},{}],402:[function(e,t,r){function n(){a(this)}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("core/layers/layersstoresregistry");o(n,s),r["default"]=new n},{"core/layers/layersstoresregistry":55,"core/utils/utils":92}],403:[function(e,t,r){function n(){this.components={},this.registerComponent=function(e){var t=e.getId();this.components[t]||(this.components[t]=e,this.emit("componentregistered",e))},this.getComponent=function(e){return this.components[e]},this.getComponents=function(){return this.components},this.unregisterComponent=function(e){var t=this.components[e];return t&&("function"==typeof t.destroy&&t.destroy(),this.components[e]=null),t},o(this)}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/g3wobject"),a=e("core/utils/utils"),o=a.base,s=a.inherit;s(n,i),r["default"]=new n},{"core/g3wobject":26,"core/utils/utils":92}],404:[function(e,t,r){function n(){var e=this;this._controls={},this._offlineids=[],i.onbefore("offline",function(){e._offlineids.forEach(function(t){var r=t.id,n=e._controls[r];t.enable=n.getEnable(),n.setEnable(!1)})}),i.onbefore("online",function(){e._offlineids.forEach(function(t){var r=t.id,n=t.enable;e._controls[r].setEnable(n)})}),this.setters={registerControl:function(e,t){this._registerControl(e,t)}},this._registerControl=function(e,t){this._controls[e]=t,t.offline===!1&&(this._offlineids.push({id:e,enable:t.getEnable()}),t.getEnable()&&t.setEnable(i.isOnline()))},this.getControl=function(e){return this._controls[e]},this.getControls=function(){return this._controls},this.unregisterControl=function(e){var t=this.getControl(e),r=u.getService("map"),n=r.getMap();return!!t&&(n.removeControl(t),delete this._controls[e],this._offlineids=this._offlineids.filter(function(t){return t!==e}),!0)},o(this)}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/applicationservice"),a=e("core/utils/utils"),o=a.base,s=a.inherit,l=e("core/g3wobject"),u=e("gui/gui");s(n,l),r["default"]=new n},{"core/applicationservice":7,"core/g3wobject":26,"core/utils/utils":92,"gui/gui":150}],405:[function(e,t,r){function n(){o(this)}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/utils/utils"),a=i.inherit,o=i.base,s=e("core/layers/layersstoresregistry");a(n,s),r["default"]=new n},{"core/layers/layersstoresregistry":55,"core/utils/utils":92}],406:[function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,a){try{var o=t[i](a),s=o.value}catch(l){return void r(l)}return o.done?void e(s):Promise.resolve(s).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}}function i(){var t=this;this.config=null,this._plugins={},this._configurationPlugins=[],this.pluginsConfigs={},this._loadedPluginUrls=[],this.setters={registerPlugin:function(e){this._plugins[e.name]||(this._plugins[e.name]=e)}},c.onafter("setCurrentProject",function(e){t.gidProject=e.getGid()}),l(this),this.init=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise(function(){var r=n(regeneratorRuntime.mark(function i(r,n){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return e.pluginsBaseUrl=t.pluginsBaseUrl,e.setPluginsConfig(t.pluginsConfigs),Object.keys(e.pluginsConfigs).forEach(function(t){return e._configurationPlugins.push(t)}),e.addLoadingPlugins(),e.otherPluginsConfig=t.otherPluginsConfig,e.setOtherPlugins(),e.setDependencyPluginConfig(),i.prev=7,i.next=10,e._loadPlugins();case 10:a=i.sent,r(a),i.next=17;break;case 14:i.prev=14,i.t0=i["catch"](7),n(i.t0);case 17:case"end":return i.stop()}},i,e,[[7,14]])}));return function(e,t){return r.apply(this,arguments)}}())},this.addLoadingPlugins=function(){var t=e("core/applicationservice");Object.keys(this.pluginsConfigs).forEach(function(e){return t.loadingPlugin(e)})},this.removeLoadingPlugin=function(t,r){var n=e("core/applicationservice");n.loadedPlugin(t,r)},this._loadPlugins=function(){var e=this,t=Object.entries(this.pluginsConfigs).map(function(t){var r=o(t,2),n=r[0],i=r[1];return e._setup(n,i)});return Promise.allSettled(t)},this.setDependencyPluginConfig=function(){var e=this,t=function(t){var r=e.pluginsConfigs[t].plugins;r&&Object.keys(r).forEach(function(t){e.pluginsConfigs[t]=a({},e.pluginsConfigs[t],r[t])})};for(var r in this.pluginsConfigs)t(r)},this.setOtherPlugins=function(){var e=p[0];this.otherPluginsConfig&&this.otherPluginsConfig[e]&&this.otherPluginsConfig[e].length?(this.pluginsConfigs[e]=this.otherPluginsConfig[e],this.pluginsConfigs[e].gid=this.otherPluginsConfig.gid):delete this.pluginsConfigs[e]},this.reloadPlugins=function(e,t){var r=this;return new Promise(function(){var i=n(regeneratorRuntime.mark(function a(n,i){var o,s,l,u,c;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:o=$("script"),s=r.getPlugins(),l=function(e){var t=s[e];t.unload(),delete r._plugins[e],o.each(function(t,n){r._loadedPluginUrls.forEach(function(t,i){if(n.getAttribute("src")===t&&t.indexOf(e)!==-1)return n.parentNode.removeChild(n),r._loadedPluginUrls.splice(i,1),!1})})};for(u in s)l(u);return r._loadedPluginUrls=[],r.otherPluginsConfig=t.getState(),r.setPluginsConfig(e.group.plugins),r.addLoadingPlugins(),r.setOtherPlugins(),a.prev=9,a.next=12,r._loadPlugins();case 12:c=a.sent,n(c),a.next=19;break;case 16:a.prev=16,a.t0=a["catch"](9),i(a.t0);case 19:case"end":return a.stop()}},a,r,[[9,16]])}));return function(e,t){return i.apply(this,arguments)}}())},this.setPluginsConfig=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r={};Object.entries(t).filter(function(t){var r=o(t,2),n=r[1];return n.gid===e.gidProject}).forEach(function(e){var t=o(e,2),n=t[0],i=t[1];return r[n]=i}),this.pluginsConfigs=r},this._loadScript=function(e){return $.getScript(e)},this._setup=function(e,t){var r=this;return new Promise(function(){var i=n(regeneratorRuntime.mark(function a(n,i){var o,s,l,u,c,d,p,f,h,v,g,m;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(_.isNull(t)){a.next=38;break}for(o=t.jsscripts,s=void 0===o?[]:o,l=[],u=function(e){l.push(new Promise(function(t,n){r._loadScript(e).done(function(){return t()}).fail(function(){return n()})}))},c=!0,d=!1,p=void 0,a.prev=7,f=s[Symbol.iterator]();!(c=(h=f.next()).done);c=!0)v=h.value,u(v);a.next=15;break;case 11:a.prev=11,a.t0=a["catch"](7),d=!0,p=a.t0;case 15:a.prev=15,a.prev=16,!c&&f["return"]&&f["return"]();case 18:if(a.prev=18,!d){a.next=21;break}throw p;case 21:return a.finish(18);case 22:return a.finish(15);case 23:return a.prev=23,a.next=26,Promise.all(l);case 26:g=""+r.pluginsBaseUrl+e,m=g+"/js/plugin.js?"+Date.now(),t.baseUrl=r.pluginsBaseUrl,r._loadScript(m).done(function(){r._loadedPluginUrls.push(m),n()}).fail(function(){r.removeLoadingPlugin(e,!1),i()}),a.next=36;break;case 32:a.prev=32,a.t1=a["catch"](23),r.removeLoadingPlugin(e,!1),i();case 36:a.next=39;break;case 38:n();case 39:case"end":return a.stop()}},a,r,[[7,11,15,23],[16,,18,22],[23,32]])}));return function(e,t){return i.apply(this,arguments)}}())},this.getPluginConfig=function(e){return this.pluginsConfigs[e]},this.getPlugins=function(){return this._plugins},this.getPlugin=function(e){return this._plugins[e]},this.isPluginInConfiguration=function(e){return this._configurationPlugins.indexOf(e)!==-1},this.isTherePlugin=function(e){return this.pluginsConfigs[e]}}Object.defineProperty(r,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(l){i=!0,a=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=e("core/utils/utils"),l=s.base,u=s.inherit,c=e("core/project/projectsregistry"),d=e("core/g3wobject"),p=["law"];u(i,d),r["default"]=new i},{"core/applicationservice":7,"core/g3wobject":26,"core/project/projectsregistry":83,"core/utils/utils":92}],407:[function(e,t,r){function n(){this.config=null,this.initialized=!1,this.projectType=null,this.overviewproject,this.setters={createProject:function(e){},setCurrentProject:function(e){this.state.currentProject!==e&&(u.removeLayersStores(),c.removeLayersStores()),this.state.currentProject=e,this.state.qgis_version=e.getQgisVersion(),this.setProjectType(e.state.type);var t=e.getLayersStore();u.addLayersStore(t,0),c.addLayersStore(t,0)}},this.state={baseLayers:{},minScale:null,maxscale:null,currentProject:null,qgis_version:null},this._groupProjects=[],this._projectConfigs={},a(this)}Object.defineProperty(r,"__esModule",{value:!0});var i=e("core/utils/utils"),a=i.base,o=i.inherit,s=e("core/g3wobject"),l=e("core/project/project"),u=e("core/catalog/cataloglayersstoresregistry"),c=e("core/map/maplayersstoresregistry");o(n,s);var d=n.prototype;d.init=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=$.Deferred();if(this.initialized){var n=this.getCurrentProject();r.resolve(n)}else{this.config=t,this.overviewproject=t.overviewproject,this.setupState();var i=new URLSearchParams(location.search),a=i.get("map_theme");this.getProject(t.initproject,{map_theme:a}).then(function(t){e.setCurrentProject(t),e.initialized=!0,r.resolve(t)}).fail(function(e){return r.reject(e)})}return r.promise()},d.clear=function(){this.config=null,this.initialized=!1,this.projectType=null,this.overviewproject,this.initialized=!1,this._groupProjects=[],this._projectConfigs={},this.state={baseLayers:{},minScale:null,maxscale:null,currentProject:null,qgis_version:null}},d.setProjectType=function(e){this.projectType=e},d.getConfig=function(){return this.config},d.getState=function(){return this.state},d.setupState=function(){this.state.baseLayers=this.config.baselayers,this.state.minScale=this.config.minscale,this.state.maxScale=this.config.maxscale,this.state.crs=this.config.crs,this.setProjects(this.config.projects)},d.getProjectType=function(){return this.projectType},d.getProjects=function(){return this._groupProjects},d.setProjects=function(e){var t=this;this.clearProjects(),e.forEach(function(e){t.state.qgis_version=e.qgis_version||t.state.qgis_version,e.baselayers=t.config.baselayers,e.minscale=t.config.minscale,e.maxscale=t.config.maxscale,e.crs=t.config.crs,e.vectorurl=t.config.vectorurl,e.rasterurl=t.config.rasterurl,e.overviewprojectgid=t.overviewproject?t.overviewproject.gid:null,t._groupProjects.push(e)})},d.clearProjects=function(){this._groupProjects=[]},d.getListableProjects=function(){var e=this.getCurrentProject().getId();return _.sortBy(this.getProjects().filter(function(t){return _.isNil(t.listable)?!(t.id===e||t.overviewprojectgid&&t.gid===t.overviewprojectgid)&&t:t.listable}),"title")},d.getCurrentProject=function(){return this.state.currentProject},d.getProject=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{reload:!1},n=r.reload,i=r.map_theme,a=$.Deferred(),o=this._groupProjects.find(function(t){return t.gid===e});if(!o)return a.reject("Project doesn't exist"),a.promise();var s=!n&&this._projectConfigs[e];if(s){var u=new l(s);a.resolve(u)}else this._getProjectFullConfig(o,{map_theme:i}).then(function(e){var r=_.merge(o,e);r.WMSUrl=t.config.getWmsUrl(r),r.relations=t._setProjectRelations(r),t._projectConfigs[r.gid]=r,t.createProject(r);var n=new l(r);a.resolve(n)}).fail(function(e){return a.reject(e)});return a.promise()},d._setProjectRelations=function(e){return e.relations=e.relations?e.relations:[],e.relations=e.relations.map(function(t){return"ONE"===t.type&&e.layers.find(function(e){if(e.id===t.referencingLayer)return t.name=e.name,t.origname=e.origname,!0}),t}),e.relations},d.getProjectConfigByGid=function(e){return this._groupProjects.find(function(t){return t.gid===e})},d.setProjectAliasUrl=function(e){var t=e.gid,r=e.url,n=e.host,i=this.config.projects.find(function(e){return e.gid===t});i&&(i.url=i&&""+(n?n:"")+r)},d.getProjectUrl=function(e){var t=this.config.urls.baseurl,r=this.getProjectConfigByGid(e),n=r.url,i=location,a=i.origin;return""+a+t+n},d._getProjectFullConfig=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.map_theme,n=$.Deferred(),i=this.config.getProjectConfigUrl(e);return $.get(i).done(function(t){if(r){var i=e.type,a=e.id,o=t.map_themes,s=o.find(function(e){var t=e.theme;return t===r});if(s){var l="/"+i+"/api/prjtheme/"+a+"/"+r;$.get(l).done(function(e){var r=e.result,n=e.data;r&&(t.layerstree=n,s.layetstree=n,s["default"]=!0)}).always(function(){n.resolve(t)})}}else n.resolve(t)}).fail(function(e){return n.reject(e)}),n.promise()},r["default"]=new n},{"core/catalog/cataloglayersstoresregistry":9,"core/g3wobject":26,"core/map/maplayersstoresregistry":76,"core/project/project":82,"core/utils/utils":92}],408:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=function(){this._sessions={},this.register=function(e){var t=e.getId();this._sessions[t]=e},this.unregister=function(e){delete this._sessions[e]},this.getSession=function(e){return this._sessions[e]},this.setSession=function(e,t){this._sessions[e]=t},this.getSessions=function(){return this._sessions},this.clear=function(){this._sessions={}}};r["default"]=new n},{}],409:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r["default"]="3.7.0-alpha.1"},{}]},{},[232]);