!function(){function e(t,n,i){function s(r,o){if(!n[r]){if(!t[r]){var u="function"==typeof require&&require;if(!o&&u)return u(r,!0);if(a)return a(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[r]={exports:{}};t[r][0].call(c.exports,function(e){var n=t[r][1][e];return s(n||e)},c,c.exports,e,t,n,i)}return n[r].exports}for(var a="function"==typeof require&&require,r=0;r<i.length;r++)s(i[r]);return s}return e}()({1:[function(e,t,n){t.exports='<ul id="g3w_raster_timeseries_content" class="treeview-menu" style="position:relative; padding: 10px;color:#FFFFFF">\n  <li>\n    <form v-disabled="formDisabled">\n      <label style="display: block">Layer</label>\n      <select id="timeserieslayer" class="form-control" ref="select-layers"\n          :multiple="layers.length > 0"\n          v-select2="\'current_layers_index\'"\n          :search="false">\n          <option v-for="(layer, index) in layers" :value="index" :key="layer.id"\n            :selected="current_layers_index.indexOf(index.toString()) > -1">{{layer.name}}\n          </option>\n        </select>\n        <div v-if="!changed_layer">\n          <datetime :label="\'plugins.qtimeseries.startdate\'" :format="format" :minDate="min_date" :maxDate="end_date" :type="\'datetime\'" :value="start_date" @change="changeStartDateTime"></datetime>\n          <datetime :label="\'plugins.qtimeseries.enddate\'" :format="format" :minDate="start_date" :maxDate="max_date" :type="\'datetime\'" :value="end_date" @change="changeEndDateTime"></datetime>\n          <label  v-if="!change_step_unit"  v-t-plugin:pre="\'qtimeseries.step\'">[<span v-t-plugin="`qtimeseries.stepsunit.${current_step_unit_label}`"></span> ]</label>\n          <input class="form-control" type="number" :min="range.min" :max="range.max" :step="stepunitmultiplier" v-model="step">\n          <range v-disabled="range.max === range.min " label="plugins.qtimeseries.steps" :max="range.max" :value="range.value" :min="range.min" ref="rangecomponent" @change-range="changeRangeStep"></range>\n          <label style="display: block"></label>\n          <select class="form-control" id="g3w-timeseries-select-unit" v-select2="\'current_step_unit\'" :search="false">\n            <option v-for="step_unit in step_units" :value="step_unit.moment" :selected="current_step_unit == step_unit.moment"\n              :key="step_unit.moment" v-t-plugin="`qtimeseries.stepsunit.${step_unit.label}`"></option>\n          </select>\n        </div>\n      </form>\n      <div style="display: flex; justify-content: space-between; margin-top: 10px" >\n        <button class="sidebar-button skin-button btn btn-block" v-disabled="!validRangeDates || range.value === 0" style="margin: 2px;" @click.stop="fastBackwardForward(-1)">\n          <span :class="g3wtemplate.getFontClass(\'fast-backward\')"></span>\n        </button>\n        <button class="sidebar-button skin-button btn btn-block"  v-disabled="!validRangeDates || range.value <= 0" style="margin: 2px;" @click.stop="stepBackwardForward(-1)">\n          <span :class="g3wtemplate.getFontClass(\'step-backward\')"></span>\n        </button>\n        <button class="sidebar-button skin-button btn btn-block" :class="{toggled: status === -1}" v-disabled="!validRangeDates || range.value <= 0"  style="margin: 2px; transform: rotate(180deg)" @click.stop="run(-1)">\n          <span :class="g3wtemplate.getFontClass(\'run\')"></span>\n        </button>\n        <button class="sidebar-button skin-button btn btn-block" :class="{toggled: status === 0}" style="margin: 2px;" @click.stop="pause">\n          <span :class="g3wtemplate.getFontClass(\'pause\')"></span>\n        </button>\n        <button class="sidebar-button skin-button btn btn-block"  :class="{toggled: status === 1}" v-disabled="!validRangeDates || range.value >= range.max" style="margin: 2px;" @click.stop="run(1)">\n          <span :class="g3wtemplate.getFontClass(\'run\')"></span>\n        </button>\n        <button class="sidebar-button skin-button btn btn-block" v-disabled="!validRangeDates || range.value >= range.max" style="margin: 2px;" @click.stop="stepBackwardForward(1)">\n          <span :class="g3wtemplate.getFontClass(\'step-forward\')"></span>\n        </button>\n        <button class="sidebar-button skin-button btn btn-block" v-disabled="!validRangeDates || range.value === range.max" style="margin: 2px;" @click.stop="fastBackwardForward(1)">\n          <span :class="g3wtemplate.getFontClass(\'fast-forward\')"></span>\n        </button>\n      </div>\n  </li>\n</ul>\n\n'},{}],2:[function(e,t,n){function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(s,a){try{var r=t[s](a),o=r.value}catch(u){return void n(u)}return r.done?void e(o):Promise.resolve(o).then(function(e){i("next",e)},function(e){i("throw",e)})}return i("next")})}}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.service;e.options;return{name:"timeseries",template:r,data:function(){var e=t.state,n=e.layers,i=void 0===n?[]:n,s=e.panel;return{layers:i,panel:s,step:i[0].options.step,start_date:i[0].start_date,end_date:i[0].end_date,stepunitmultiplier:i[0].options.stepunitmultiplier,format:"YYYY-MM-DD HH:mm:ss",min_date:i[0].start_date,max_date:i[0].end_date,step_units:a.STEP_UNITS,current_step_unit:i[0].options.stepunit,change_step_unit:!1,current_step_unit_label:a.STEP_UNITS.find(function(e){return e.moment===i[0].options.stepunit}).label,range:{value:0,min:0,max:0},changed_layer:!1,current_layers_index:i.map(function(e,t){return t.toString()}),currentLayerDateTimeIndex:null,status:0}},computed:{formDisabled:function(){return 0!==this.status},select_layers:function(){var e=this;return this.changed_layer=!0,setTimeout(function(){return e.changed_layer=!1}),this.current_layers_index.map(function(t){return e.layers[t]})},disablerun:function(){return!(0!==this.status||this.start_date&&this.end_date)},validRangeDates:function(){var e=this.getMultiplierAndStepUnit(),t=e.multiplier,n=e.step_unit;return this.validateStartDateEndDate()&&moment(this.end_date).diff(moment(this.start_date),n)/t>=this.getStepValue()}},methods:{initLayerTimeseries:function(){this.status=0,this.setDates(),this.min_date=this.start_date,this.currentLayerDateTimeIndex=this.start_date,this.range.value=0,this.range.min=0,this.resetRangeInputData(),this.currentLayerDateTimeIndex&&this.getTimeLayer(),this.showCharts=!1},setDates:function(){if(this.select_layers.length>1)this.start_date=moment.min(this.select_layers.map(function(e){return e.start_date})),this.end_date=moment.max(this.select_layers.map(function(e){return e.end_date}));else{var e=this.layers[this.current_layers_index[0]],t=e.start_date,n=e.end_date;this.start_date=t,this.end_date=n}},resetRangeInputData:function(){this.range.value=0;var e=this.getMultiplierAndStepUnit(),t=e.multiplier,n=e.step_unit;this.range.max=this.validateStartDateEndDate()?Number.parseInt(moment(this.end_date).diff(moment(this.start_date),n)/t*this.stepunitmultiplier):0},changeRangeInputOnChangeStepUnit:function(){this.range.value=0;var e=this.getMultiplierAndStepUnit(),t=e.multiplier,n=e.step_unit;this.range.max=this.validateStartDateEndDate()?Number.parseInt(moment(this.end_date).diff(moment(this.start_date),n)/t*this.stepunitmultiplier):0},getMultiplierAndStepUnit:function(){return t.getMultiplierAndStepUnit(this.current_step_unit)},resetTimeLayer:function(){function e(){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.select_layers;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.pause(),n.next=3,t.resetTimeLayer(e);case 3:e.forEach(function(e){return e.timed=!1});case 4:case"end":return n.stop()}},s,this)}));return e}(),getTimeLayer:function(){function e(){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function s(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick();case 2:return e.prev=2,e.next=5,t.getTimeLayer({layers:this.select_layers,step:this.step,date:this.currentLayerDateTimeIndex,end_date:this.end_date,stepunit:this.current_step_unit});case 5:e.next=9;break;case 7:e.prev=7,e.t0=e["catch"](2);case 9:this.select_layers.forEach(function(e){return e.timed=!0});case 10:case"end":return e.stop()}},s,this,[[2,7]])}));return e}(),changeRangeStep:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function n(e){var t,i,s,a=e.value;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.range.value=1*a,t=this.getMultiplierAndStepUnit(),i=t.mutltiplier,s=t.step_unit,this.currentLayerDateTimeIndex=moment(this.start_date).add(this.range.value*i,s),e.next=5,this.getTimeLayer();case 5:case"end":return e.stop()}},n,this)}));return e}(),changeStartDateTime:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e=moment(e).isValid()?e:null,this.start_date=e,this.currentLayerDateTimeIndex=e,this.resetRangeInputData(),moment(e).isValid()?this.getTimeLayer():this.resetTimeLayer()},changeEndDateTime:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function n(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.end_date=e,this.resetRangeInputData();case 2:case"end":return t.stop()}},n,this)}));return e}(),validateStartDateEndDate:function(){var e=!1;return this.start_date&&this.end_date&&(e=moment(this.start_date).isValid()&&moment(this.end_date).isValid()),e},setStatus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.status=e},setCurrentDateTime:function(e){var t=1*this.getStepValue(),n=this.getMultiplierAndStepUnit(),i=n.multiplier,s=n.step_unit;this.currentLayerDateTimeIndex=moment(this.currentLayerDateTimeIndex)[1===e?"add":"subtract"](t*i,s)},getStepValue:function(){return 1*this.step*this.stepunitmultiplier},run:function(e){var t=this;if(this.status!==e){var n=!1;clearInterval(this.intervalEventHandler),this.intervalEventHandler=setInterval(i(regeneratorRuntime.mark(function s(){var i;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(n){s.next=26;break}if(s.prev=1,i=1*t.step,t.range.value=1===e?t.range.value+i:t.range.value-i,!(t.range.value>t.range.max||t.range.value<0)){s.next=10;break}t.resetRangeInputData(),t.pause(),t.fastBackwardForward(-1),s.next=21;break;case 10:return t.setCurrentDateTime(e),n=!0,s.prev=12,s.next=15,t.getTimeLayer();case 15:s.next=20;break;case 17:s.prev=17,s.t0=s["catch"](12);case 20:n=!1;case 21:s.next=26;break;case 23:s.prev=23,s.t1=s["catch"](1),t.pause();case 26:case"end":return s.stop()}},s,t,[[1,23],[12,17]])})),1e3),this.setStatus(e)}else this.pause()},pause:function(){clearInterval(this.intervalEventHandler),this.intervalEventHandler=null,this.setStatus()},stepBackwardForward:function(e){var t=this.getStepValue();this.range.value=1===e?this.range.value+t:this.range.value-t,this.setCurrentDateTime(e),this.getTimeLayer()},fastBackwardForward:function(e){1===e?(this.range.value=this.range.max,this.currentLayerDateTimeIndex=this.end_date,this.getTimeLayer()):(this.range.value=this.range.min,this.currentLayerDateTimeIndex=this.start_date,this.getTimeLayer())},hideSingleLayerSelectionClear:function(){$(this.$refs["select-layers"]).siblings(".select2-container").find(".select2-selection__choice__remove").hide()}},watch:{step:function(){this.getTimeLayer()},current_step_unit:{handler:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function n(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.change_step_unit=!0,this.select_layers.forEach(function(t){return t.options.stepunit=e}),this.current_step_unit_label=a.STEP_UNITS.find(function(t){return t.moment===e}).label,this.initLayerTimeseries(),t.next=6,this.$nextTick();case 6:this.change_step_unit=!1;case 7:case"end":return t.stop()}},n,this)}));return e}(),immediate:!1},current_layers_index:{immediate:!1,handler:function(){function e(e,n){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function n(e,t){var i,s=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$nextTick();case 2:1===e.length&&this.hideSingleLayerSelectionClear(),i=t.map(function(e){return s.layers[e]}),this.resetTimeLayer(i),this.initLayerTimeseries();case 6:case"end":return n.stop()}},n,this)}));return e}()},"panel.open":function(e){e?this.initLayerTimeseries():this.resetTimeLayer()},validRangeDates:function(e){!e&&this.changeStartDateTime(this.start_date)}},created:function(){this.intervalEventHandler=null},mounted:function(){function e(){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function s(){var e=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.disabledSingleLayerClickUnSelect=function(){setTimeout(function(){1===e.select_layers.length?$('.select2-results__options li[aria-selected="true"]').addClass("g3w-disabled"):$(".select2-results__options li").removeClass("g3w-disabled")})},n.next=3,this.$nextTick();case 3:t.onafter("open",function(){$("#timeserieslayer").on("select2:open",e.disabledSingleLayerClickUnSelect)}),t.onafter("close",function(){$("#timeserieslayer").off("select2:open",e.disabledSingleLayerClickUnSelect)});case 5:case"end":return n.stop()}},s,this)}));return e}(),beforeDestroy:function(){t.clear()}}}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=s;var a=e("../../constant"),r=e("./sidebaritem.html")},{"../../constant":5,"./sidebaritem.html":1}],3:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n["default"]={it:{title:"Serie Temporali",current_date:"Data Corrente",steps:"Passi",step:"Passo",startdate:"Data Inizio",enddate:"Data Fine",stepsunit:{label:"Unità di passo",centuries:"Secoli",decades:"Decadi",years:"Anni",months:"Mesi",weeks:"Settimane",days:"Giorni",hours:"Ore",minutes:"Minuti",seconds:"Secondi",milliseconds:"Millisecondi"},tooltips:{showcharts:"Visualizza Grafici"}},en:{title:"Time Series",current_date:"Current Date",steps:"Steps",step:"Step",startdate:"Start Date",enddate:"End Date",stepsunit:{label:"Step Unit",centuries:"Centuries",decades:"Decades",years:"Years",months:"Months",weeks:"Weeks",days:"Days",hours:"Hours",minutes:"Minutes",seconds:"Seconds",milliseconds:"Milliseconds"},tooltips:{showcharts:"Show Charts"}},fi:{title:"Time Series",current_date:"Current Date",steps:"Steps",step:"Step",startdate:"Start Date",enddate:"End Date",stepsunit:{label:"Step Unit",centuries:"Centuries",decades:"Decades",years:"Years",months:"Months",weeks:"Weeks",days:"Days",hours:"Hours",minutes:"Minutes",seconds:"Seconds",milliseconds:"Milliseconds"},tooltips:{showcharts:"Show Charts"}},se:{title:"Time Series",current_date:"Current Date",steps:"Steps",step:"Step",startdate:"Start Date",enddate:"End Date",stepsunit:{label:"Step Unit",centuries:"Centuries",decades:"Decades",years:"Years",months:"Months",weeks:"Weeks",days:"Days",hours:"Hours",minutes:"Minutes",seconds:"Seconds",milliseconds:"Milliseconds"},tooltips:{showcharts:"Show Charts"}},fr:{title:"Time Series",current_date:"Current Date",steps:"Steps",step:"Step",startdate:"Start Date",enddate:"End Date",stepsunit:{label:"Step Unit",centuries:"Centuries",decades:"Decades",years:"Years",months:"Months",weeks:"Weeks",days:"Days",hours:"Hours",minutes:"Minutes",seconds:"Seconds",milliseconds:"Milliseconds"},tooltips:{showcharts:"Show Charts"}},de:{title:"Zeitreihen",current_date:"Aktuelles Datum",steps:"Stufen",step:"Stufe",startdate:"Anfangsdatum",enddate:"Enddatum",stepsunit:{label:"Stufeneinheit",centuries:"Jahrhunderte",decades:"Jahrzehnte",years:"Jahre",months:"Monate",weeks:"Wochen",days:"Tage",hours:"Stunden",minutes:"Minuten",seconds:"Sekunden",milliseconds:"Millisekunden"},tooltips:{showcharts:"Diagramme zeigen"}},ro:{title:"Intervale de timp",current_date:"Data Curentă",steps:"Pași",step:"Pas",startdate:"Data Început",enddate:"Data Sfârșit",stepsunit:{label:"Unitatea de pas",centuries:"Secole",decades:"Decenii",years:"Ani",months:"Luni",weeks:"Săptămâni",days:"Zile",hours:"Ore",minutes:"Minute",seconds:"Secunde",milliseconds:"Milisecunde"},tooltips:{showcharts:"Arată Graficele"}}}},{}],4:[function(e,t,n){function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var s=e("./i18n"),a=i(s);n["default"]={i18n:a["default"],name:"qtimeseries"}},{"./i18n":3}],5:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.STEP_UNITS=[{moment:"100:years",label:"centuries",qgis:"c"},{moment:"10:years",label:"decades",qgis:"dec"},{moment:"years",label:"years",qgis:"y"},{moment:"months",label:"months",qgis:"mon"},{moment:"7:days",label:"weeks",qgis:"wk"},{moment:"days",label:"days",qgis:"d"},{moment:"hours",label:"hours",qgis:"h"},{moment:"minutes",label:"minutes",qgis:"min"},{moment:"seconds",label:"seconds",qgis:"s"},{moment:"milliseconds",label:"milliseconds",qgis:"ms"}]},{}],6:[function(e,t,n){function i(e){return e&&e.__esModule?e:{"default":e}}function s(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(s,a){try{var r=t[s](a),o=r.value}catch(u){return void n(u)}return r.done?void e(o):Promise.resolve(o).then(function(e){i("next",e)},function(e){i("throw",e)})}return i("next")})}}var a=e("./config"),r=i(a),o=e("./service"),u=i(o),l=e("./components/sidebar/sidebaritem"),c=i(l),d=g3wsdk.core.utils,p=d.base,m=d.inherit,h=g3wsdk.core.plugin.Plugin,f=g3wsdk.gui.GUI,g=g3wsdk.core.i18n.addI18nPlugin,v=function(){p(this);({position:0,title:r["default"].title});this.name=r["default"].name,this.panel,this.setReady(!0),this.onAfterRegisterPluginKey,this.init=function(){var e=this;this.config=this.getConfig();var t=this.registerPlugin(this.config.gid);this.setService(u["default"]),g({name:this.name,config:r["default"].i18n}),this.service.loadPlugin()&&(this.service.once("ready",function(n){t&&n&&(f.isready?e.setupGui():f.on("ready",function(){return e.setupGui.bind(e)}))}),this.service.init(this.config))},this.setupGui=function(){var e=this,t=this.getService(),n=(0,c["default"])({service:t});this.createSideBarComponent(n,{id:r["default"].name,title:"plugins."+r["default"].name+".title",open:!1,collapsible:!0,closewhenshowviewportcontent:!1,iconConfig:{color:"#25bce9",icon:"time"},mobile:!0,sidebarOptions:{position:"catalog"},events:{open:{when:"before",cb:function(){function n(e){return i.apply(this,arguments)}var i=s(regeneratorRuntime.mark(function a(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n?t.open():t.close();case 1:case"end":return e.stop()}},a,e)}));return n}()}}})},this.load=function(){this.init()},this.unload=function(){this.emit("unload"),this.service.clear()}};m(v,h),function(e){e.init()}(new v)},{"./components/sidebar/sidebaritem":2,"./config":4,"./service":7}],7:[function(e,t,n){function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(s,a){try{var r=t[s](a),o=r.value}catch(u){return void n(u)}return r.done?void e(o):Promise.resolve(o).then(function(e){i("next",e)},function(e){i("throw",e)})}return i("next")})}}function a(){this.setters={open:function(){this._open()},close:function(){this._close()}},u(this),this.init=s(regeneratorRuntime.mark(function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.project=this.getCurrentProject(),this.config=n,this.mapService=d.getService("map"),this.getChartConfig={interaction:null,keyListener:null,indexcolor:0,chart:null,layer:new ol.layer.Vector({source:new ol.source.Vector})},this.addProjectLayerFromConfigProject(),t=this.config.layers.length>0,t&&(this.state={loading:!1,layers:this.config.layers,panel:{open:!1}}),this.emit("ready",t);case 8:case"end":return e.stop()}},e,this)})),this.addProjectLayerFromConfigProject=function(){var e=this;this.project.getConfigLayers().forEach(function(t){if("Object"===c(t.qtimeseries)){var n=t.qtimeseries,i=n.field,s=n.step,a=void 0===s?1:s,o=n.units,u=void 0===o?"d":o,l=n.start_date,d=void 0===l?null:l,p=n.end_date,m=void 0===p?null:p,h=new Date(d).getTimezoneOffset(),f=new Date(m).getTimezoneOffset();d=moment(d).add(h,"minutes"),m=moment(m).add(f,"minutes");var g=r.STEP_UNITS.find(function(e){return e.qgis===u}).moment.split(":"),v=g.length>1?g[1]:g[0],y=g.length>1?1*g[0]:1,_=t.id,b=e.project.getLayerById(_),S=b.getName(),w=b.getWMSLayerName();e.config.layers.push({id:_,name:S,wmsname:w,start_date:d,end_date:m,options:{range_max:moment(m).diff(moment(d),v)-1,format:format,step:a,stepunit:v,stepunitmultiplier:y,field:i}})}})},this.getTimeLayer=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.layers,s=t.date,a=t.step,r=t.end_date,o=t.stepunit;return new Promise(function(t,u){var l=void 0,c=void 0,d=n.map(function(e){return e.id}),p=d.map(function(t){return e.project.getLayerById(t)});p.forEach(function(e){return e.setChecked(!0)});var f=d.map(function(t){return e.mapService.getMapLayerByLayerId(t)}),g=e.getMultiplierAndStepUnit(o),v=g.multiplier,y=g.step_unit,_=new Date(s).getTimezoneOffset();l=moment(s).add(Math.abs(_),"minutes").toISOString(),c=moment(l).add(a*v,y).toISOString();var b=moment(r).add(Math.abs(_),"minutes").toISOString(),S=moment(c).isAfter(b);S&&(c=b);var w=l+"/"+c,x=f.length;f.forEach(function(n){n.once("loadend",function(){var n=c?l+" - "+c:l;e.mapService.showMapInfo({info:n,style:{fontSize:"1.2em",color:"grey",border:"1px solid grey",padding:"10px"}}),x-=1,0===x&&t()}),n.once("loaderror",function(){var t=c?l+" - "+c:l;e.mapService.showMapInfo({info:t,style:{fontSize:"1.2em",color:"red",border:"1px solid red",padding:"10px"}}),x-=1,0===x&&u()}),e.mapService.updateMapLayer(n,i({force:!0},m,w),h)})})},this.getMultiplierAndStepUnit=function(e){var t=e.split(":");return{multiplier:t.length>1?1*t[0]:1,step_unit:t.length>1?t[1]:e}},this.resetTimeLayer=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise(function(s,a){var r=e.length;e.forEach(function(e){if(e.timed){var a=t.mapService.getMapLayerByLayerId(e.id);n&&a.once("loadend",function(){t.mapService.showMapInfo(),r-=1,0===r&&s()}),t.mapService.updateMapLayer(a,i({force:!0},m,void 0))}else s()})})},this._open=function(){this.state.panel.open=!0},this._close=function(){var e=this.state.layers.filter(function(e){return e.timed});e&&this.resetTimeLayer(e,!0),this.state.panel.open=!1},this.clear=function(){this.close()}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./constant"),o=g3wsdk.core.utils,u=o.base,l=o.inherit,c=o.toRawType,d=g3wsdk.gui.GUI,p=g3wsdk.core.plugin.PluginService,m="TIME",h={showSpinner:!1};l(a,p),n["default"]=new a},{"./constant":5}]},{},[6]);